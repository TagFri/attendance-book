function xb(s,e){for(var n=0;n<e.length;n++){const o=e[n];if(typeof o!="string"&&!Array.isArray(o)){for(const h in o)if(h!=="default"&&!(h in s)){const g=Object.getOwnPropertyDescriptor(o,h);g&&Object.defineProperty(s,h,g.get?g:{enumerable:!0,get:()=>o[h]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))o(h);new MutationObserver(h=>{for(const g of h)if(g.type==="childList")for(const E of g.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&o(E)}).observe(document,{childList:!0,subtree:!0});function n(h){const g={};return h.integrity&&(g.integrity=h.integrity),h.referrerPolicy&&(g.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?g.credentials="include":h.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function o(h){if(h.ep)return;h.ep=!0;const g=n(h);fetch(h.href,g)}})();var Wh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tg(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var t1={exports:{}},eu={};var ly;function _b(){if(ly)return eu;ly=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(o,h,g){var E=null;if(g!==void 0&&(E=""+g),h.key!==void 0&&(E=""+h.key),"key"in h){g={};for(var v in h)v!=="key"&&(g[v]=h[v])}else g=h;return h=g.ref,{$$typeof:s,type:o,key:E,ref:h!==void 0?h:null,props:g}}return eu.Fragment=e,eu.jsx=n,eu.jsxs=n,eu}var cy;function Ab(){return cy||(cy=1,t1.exports=_b()),t1.exports}var D=Ab(),n1={exports:{}},zt={};var uy;function wb(){if(uy)return zt;uy=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),g=Symbol.for("react.consumer"),E=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),P=Symbol.iterator;function X(K){return K===null||typeof K!="object"?null:(K=P&&K[P]||K["@@iterator"],typeof K=="function"?K:null)}var te={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oe=Object.assign,ue={};function Ye(K,pe,De){this.props=K,this.context=pe,this.refs=ue,this.updater=De||te}Ye.prototype.isReactComponent={},Ye.prototype.setState=function(K,pe){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,pe,"setState")},Ye.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function ke(){}ke.prototype=Ye.prototype;function de(K,pe,De){this.props=K,this.context=pe,this.refs=ue,this.updater=De||te}var Pe=de.prototype=new ke;Pe.constructor=de,oe(Pe,Ye.prototype),Pe.isPureReactComponent=!0;var ft=Array.isArray;function qe(){}var F={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function V(K,pe,De){var Ve=De.ref;return{$$typeof:s,type:K,key:pe,ref:Ve!==void 0?Ve:null,props:De}}function Z(K,pe){return V(K.type,pe,K.props)}function q(K){return typeof K=="object"&&K!==null&&K.$$typeof===s}function Y(K){var pe={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(De){return pe[De]})}var H=/\/+/g;function rt(K,pe){return typeof K=="object"&&K!==null&&K.key!=null?Y(""+K.key):pe.toString(36)}function ae(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(qe,qe):(K.status="pending",K.then(function(pe){K.status==="pending"&&(K.status="fulfilled",K.value=pe)},function(pe){K.status==="pending"&&(K.status="rejected",K.reason=pe)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function ce(K,pe,De,Ve,Le){var we=typeof K;(we==="undefined"||we==="boolean")&&(K=null);var ut=!1;if(K===null)ut=!0;else switch(we){case"bigint":case"string":case"number":ut=!0;break;case"object":switch(K.$$typeof){case s:case e:ut=!0;break;case S:return ut=K._init,ce(ut(K._payload),pe,De,Ve,Le)}}if(ut)return Le=Le(K),ut=Ve===""?"."+rt(K,0):Ve,ft(Le)?(De="",ut!=null&&(De=ut.replace(H,"$&/")+"/"),ce(Le,pe,De,"",function(Mn){return Mn})):Le!=null&&(q(Le)&&(Le=Z(Le,De+(Le.key==null||K&&K.key===Le.key?"":(""+Le.key).replace(H,"$&/")+"/")+ut)),pe.push(Le)),1;ut=0;var xt=Ve===""?".":Ve+":";if(ft(K))for(var Mt=0;Mt<K.length;Mt++)Ve=K[Mt],we=xt+rt(Ve,Mt),ut+=ce(Ve,pe,De,we,Le);else if(Mt=X(K),typeof Mt=="function")for(K=Mt.call(K),Mt=0;!(Ve=K.next()).done;)Ve=Ve.value,we=xt+rt(Ve,Mt++),ut+=ce(Ve,pe,De,we,Le);else if(we==="object"){if(typeof K.then=="function")return ce(ae(K),pe,De,Ve,Le);throw pe=String(K),Error("Objects are not valid as a React child (found: "+(pe==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":pe)+"). If you meant to render a collection of children, use an array instead.")}return ut}function ne(K,pe,De){if(K==null)return K;var Ve=[],Le=0;return ce(K,Ve,"","",function(we){return pe.call(De,we,Le++)}),Ve}function ze(K){if(K._status===-1){var pe=K._result;pe=pe(),pe.then(function(De){(K._status===0||K._status===-1)&&(K._status=1,K._result=De)},function(De){(K._status===0||K._status===-1)&&(K._status=2,K._result=De)}),K._status===-1&&(K._status=0,K._result=pe)}if(K._status===1)return K._result.default;throw K._result}var pt=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(pe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},ct={map:ne,forEach:function(K,pe,De){ne(K,function(){pe.apply(this,arguments)},De)},count:function(K){var pe=0;return ne(K,function(){pe++}),pe},toArray:function(K){return ne(K,function(pe){return pe})||[]},only:function(K){if(!q(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return zt.Activity=N,zt.Children=ct,zt.Component=Ye,zt.Fragment=n,zt.Profiler=h,zt.PureComponent=de,zt.StrictMode=o,zt.Suspense=b,zt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,zt.__COMPILER_RUNTIME={__proto__:null,c:function(K){return F.H.useMemoCache(K)}},zt.cache=function(K){return function(){return K.apply(null,arguments)}},zt.cacheSignal=function(){return null},zt.cloneElement=function(K,pe,De){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var Ve=oe({},K.props),Le=K.key;if(pe!=null)for(we in pe.key!==void 0&&(Le=""+pe.key),pe)!j.call(pe,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&pe.ref===void 0||(Ve[we]=pe[we]);var we=arguments.length-2;if(we===1)Ve.children=De;else if(1<we){for(var ut=Array(we),xt=0;xt<we;xt++)ut[xt]=arguments[xt+2];Ve.children=ut}return V(K.type,Le,Ve)},zt.createContext=function(K){return K={$$typeof:E,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:g,_context:K},K},zt.createElement=function(K,pe,De){var Ve,Le={},we=null;if(pe!=null)for(Ve in pe.key!==void 0&&(we=""+pe.key),pe)j.call(pe,Ve)&&Ve!=="key"&&Ve!=="__self"&&Ve!=="__source"&&(Le[Ve]=pe[Ve]);var ut=arguments.length-2;if(ut===1)Le.children=De;else if(1<ut){for(var xt=Array(ut),Mt=0;Mt<ut;Mt++)xt[Mt]=arguments[Mt+2];Le.children=xt}if(K&&K.defaultProps)for(Ve in ut=K.defaultProps,ut)Le[Ve]===void 0&&(Le[Ve]=ut[Ve]);return V(K,we,Le)},zt.createRef=function(){return{current:null}},zt.forwardRef=function(K){return{$$typeof:v,render:K}},zt.isValidElement=q,zt.lazy=function(K){return{$$typeof:S,_payload:{_status:-1,_result:K},_init:ze}},zt.memo=function(K,pe){return{$$typeof:_,type:K,compare:pe===void 0?null:pe}},zt.startTransition=function(K){var pe=F.T,De={};F.T=De;try{var Ve=K(),Le=F.S;Le!==null&&Le(De,Ve),typeof Ve=="object"&&Ve!==null&&typeof Ve.then=="function"&&Ve.then(qe,pt)}catch(we){pt(we)}finally{pe!==null&&De.types!==null&&(pe.types=De.types),F.T=pe}},zt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},zt.use=function(K){return F.H.use(K)},zt.useActionState=function(K,pe,De){return F.H.useActionState(K,pe,De)},zt.useCallback=function(K,pe){return F.H.useCallback(K,pe)},zt.useContext=function(K){return F.H.useContext(K)},zt.useDebugValue=function(){},zt.useDeferredValue=function(K,pe){return F.H.useDeferredValue(K,pe)},zt.useEffect=function(K,pe){return F.H.useEffect(K,pe)},zt.useEffectEvent=function(K){return F.H.useEffectEvent(K)},zt.useId=function(){return F.H.useId()},zt.useImperativeHandle=function(K,pe,De){return F.H.useImperativeHandle(K,pe,De)},zt.useInsertionEffect=function(K,pe){return F.H.useInsertionEffect(K,pe)},zt.useLayoutEffect=function(K,pe){return F.H.useLayoutEffect(K,pe)},zt.useMemo=function(K,pe){return F.H.useMemo(K,pe)},zt.useOptimistic=function(K,pe){return F.H.useOptimistic(K,pe)},zt.useReducer=function(K,pe,De){return F.H.useReducer(K,pe,De)},zt.useRef=function(K){return F.H.useRef(K)},zt.useState=function(K){return F.H.useState(K)},zt.useSyncExternalStore=function(K,pe,De){return F.H.useSyncExternalStore(K,pe,De)},zt.useTransition=function(){return F.H.useTransition()},zt.version="19.2.0",zt}var hy;function ng(){return hy||(hy=1,n1.exports=wb()),n1.exports}var _e=ng();const Nr=tg(_e);var r1={exports:{}},tu={},i1={exports:{}},s1={};var fy;function bb(){return fy||(fy=1,(function(s){function e(ce,ne){var ze=ce.length;ce.push(ne);e:for(;0<ze;){var pt=ze-1>>>1,ct=ce[pt];if(0<h(ct,ne))ce[pt]=ne,ce[ze]=ct,ze=pt;else break e}}function n(ce){return ce.length===0?null:ce[0]}function o(ce){if(ce.length===0)return null;var ne=ce[0],ze=ce.pop();if(ze!==ne){ce[0]=ze;e:for(var pt=0,ct=ce.length,K=ct>>>1;pt<K;){var pe=2*(pt+1)-1,De=ce[pe],Ve=pe+1,Le=ce[Ve];if(0>h(De,ze))Ve<ct&&0>h(Le,De)?(ce[pt]=Le,ce[Ve]=ze,pt=Ve):(ce[pt]=De,ce[pe]=ze,pt=pe);else if(Ve<ct&&0>h(Le,ze))ce[pt]=Le,ce[Ve]=ze,pt=Ve;else break e}}return ne}function h(ce,ne){var ze=ce.sortIndex-ne.sortIndex;return ze!==0?ze:ce.id-ne.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var g=performance;s.unstable_now=function(){return g.now()}}else{var E=Date,v=E.now();s.unstable_now=function(){return E.now()-v}}var b=[],_=[],S=1,N=null,P=3,X=!1,te=!1,oe=!1,ue=!1,Ye=typeof setTimeout=="function"?setTimeout:null,ke=typeof clearTimeout=="function"?clearTimeout:null,de=typeof setImmediate<"u"?setImmediate:null;function Pe(ce){for(var ne=n(_);ne!==null;){if(ne.callback===null)o(_);else if(ne.startTime<=ce)o(_),ne.sortIndex=ne.expirationTime,e(b,ne);else break;ne=n(_)}}function ft(ce){if(oe=!1,Pe(ce),!te)if(n(b)!==null)te=!0,qe||(qe=!0,Y());else{var ne=n(_);ne!==null&&ae(ft,ne.startTime-ce)}}var qe=!1,F=-1,j=5,V=-1;function Z(){return ue?!0:!(s.unstable_now()-V<j)}function q(){if(ue=!1,qe){var ce=s.unstable_now();V=ce;var ne=!0;try{e:{te=!1,oe&&(oe=!1,ke(F),F=-1),X=!0;var ze=P;try{t:{for(Pe(ce),N=n(b);N!==null&&!(N.expirationTime>ce&&Z());){var pt=N.callback;if(typeof pt=="function"){N.callback=null,P=N.priorityLevel;var ct=pt(N.expirationTime<=ce);if(ce=s.unstable_now(),typeof ct=="function"){N.callback=ct,Pe(ce),ne=!0;break t}N===n(b)&&o(b),Pe(ce)}else o(b);N=n(b)}if(N!==null)ne=!0;else{var K=n(_);K!==null&&ae(ft,K.startTime-ce),ne=!1}}break e}finally{N=null,P=ze,X=!1}ne=void 0}}finally{ne?Y():qe=!1}}}var Y;if(typeof de=="function")Y=function(){de(q)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,rt=H.port2;H.port1.onmessage=q,Y=function(){rt.postMessage(null)}}else Y=function(){Ye(q,0)};function ae(ce,ne){F=Ye(function(){ce(s.unstable_now())},ne)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(ce){ce.callback=null},s.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<ce?Math.floor(1e3/ce):5},s.unstable_getCurrentPriorityLevel=function(){return P},s.unstable_next=function(ce){switch(P){case 1:case 2:case 3:var ne=3;break;default:ne=P}var ze=P;P=ne;try{return ce()}finally{P=ze}},s.unstable_requestPaint=function(){ue=!0},s.unstable_runWithPriority=function(ce,ne){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var ze=P;P=ce;try{return ne()}finally{P=ze}},s.unstable_scheduleCallback=function(ce,ne,ze){var pt=s.unstable_now();switch(typeof ze=="object"&&ze!==null?(ze=ze.delay,ze=typeof ze=="number"&&0<ze?pt+ze:pt):ze=pt,ce){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=ze+ct,ce={id:S++,callback:ne,priorityLevel:ce,startTime:ze,expirationTime:ct,sortIndex:-1},ze>pt?(ce.sortIndex=ze,e(_,ce),n(b)===null&&ce===n(_)&&(oe?(ke(F),F=-1):oe=!0,ae(ft,ze-pt))):(ce.sortIndex=ct,e(b,ce),te||X||(te=!0,qe||(qe=!0,Y()))),ce},s.unstable_shouldYield=Z,s.unstable_wrapCallback=function(ce){var ne=P;return function(){var ze=P;P=ne;try{return ce.apply(this,arguments)}finally{P=ze}}}})(s1)),s1}var dy;function Tb(){return dy||(dy=1,i1.exports=bb()),i1.exports}var a1={exports:{}},ui={};var gy;function vb(){if(gy)return ui;gy=1;var s=ng();function e(b){var _="https://react.dev/errors/"+b;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)_+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+b+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var o={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},h=Symbol.for("react.portal");function g(b,_,S){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:N==null?null:""+N,children:b,containerInfo:_,implementation:S}}var E=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function v(b,_){if(b==="font")return"";if(typeof _=="string")return _==="use-credentials"?_:""}return ui.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,ui.createPortal=function(b,_){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)throw Error(e(299));return g(b,_,null,S)},ui.flushSync=function(b){var _=E.T,S=o.p;try{if(E.T=null,o.p=2,b)return b()}finally{E.T=_,o.p=S,o.d.f()}},ui.preconnect=function(b,_){typeof b=="string"&&(_?(_=_.crossOrigin,_=typeof _=="string"?_==="use-credentials"?_:"":void 0):_=null,o.d.C(b,_))},ui.prefetchDNS=function(b){typeof b=="string"&&o.d.D(b)},ui.preinit=function(b,_){if(typeof b=="string"&&_&&typeof _.as=="string"){var S=_.as,N=v(S,_.crossOrigin),P=typeof _.integrity=="string"?_.integrity:void 0,X=typeof _.fetchPriority=="string"?_.fetchPriority:void 0;S==="style"?o.d.S(b,typeof _.precedence=="string"?_.precedence:void 0,{crossOrigin:N,integrity:P,fetchPriority:X}):S==="script"&&o.d.X(b,{crossOrigin:N,integrity:P,fetchPriority:X,nonce:typeof _.nonce=="string"?_.nonce:void 0})}},ui.preinitModule=function(b,_){if(typeof b=="string")if(typeof _=="object"&&_!==null){if(_.as==null||_.as==="script"){var S=v(_.as,_.crossOrigin);o.d.M(b,{crossOrigin:S,integrity:typeof _.integrity=="string"?_.integrity:void 0,nonce:typeof _.nonce=="string"?_.nonce:void 0})}}else _==null&&o.d.M(b)},ui.preload=function(b,_){if(typeof b=="string"&&typeof _=="object"&&_!==null&&typeof _.as=="string"){var S=_.as,N=v(S,_.crossOrigin);o.d.L(b,S,{crossOrigin:N,integrity:typeof _.integrity=="string"?_.integrity:void 0,nonce:typeof _.nonce=="string"?_.nonce:void 0,type:typeof _.type=="string"?_.type:void 0,fetchPriority:typeof _.fetchPriority=="string"?_.fetchPriority:void 0,referrerPolicy:typeof _.referrerPolicy=="string"?_.referrerPolicy:void 0,imageSrcSet:typeof _.imageSrcSet=="string"?_.imageSrcSet:void 0,imageSizes:typeof _.imageSizes=="string"?_.imageSizes:void 0,media:typeof _.media=="string"?_.media:void 0})}},ui.preloadModule=function(b,_){if(typeof b=="string")if(_){var S=v(_.as,_.crossOrigin);o.d.m(b,{as:typeof _.as=="string"&&_.as!=="script"?_.as:void 0,crossOrigin:S,integrity:typeof _.integrity=="string"?_.integrity:void 0})}else o.d.m(b)},ui.requestFormReset=function(b){o.d.r(b)},ui.unstable_batchedUpdates=function(b,_){return b(_)},ui.useFormState=function(b,_,S){return E.H.useFormState(b,_,S)},ui.useFormStatus=function(){return E.H.useHostTransitionStatus()},ui.version="19.2.0",ui}var my;function Cb(){if(my)return a1.exports;my=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),a1.exports=vb(),a1.exports}var py;function Sb(){if(py)return tu;py=1;var s=Tb(),e=ng(),n=Cb();function o(t){var i="https://react.dev/errors/"+t;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function g(t){var i=t,c=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(c=i.return),t=i.return;while(t)}return i.tag===3?c:null}function E(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function v(t){if(t.tag===31){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function b(t){if(g(t)!==t)throw Error(o(188))}function _(t){var i=t.alternate;if(!i){if(i=g(t),i===null)throw Error(o(188));return i!==t?null:t}for(var c=t,d=i;;){var x=c.return;if(x===null)break;var w=x.alternate;if(w===null){if(d=x.return,d!==null){c=d;continue}break}if(x.child===w.child){for(w=x.child;w;){if(w===c)return b(x),t;if(w===d)return b(x),i;w=w.sibling}throw Error(o(188))}if(c.return!==d.return)c=x,d=w;else{for(var R=!1,B=x.child;B;){if(B===c){R=!0,c=x,d=w;break}if(B===d){R=!0,d=x,c=w;break}B=B.sibling}if(!R){for(B=w.child;B;){if(B===c){R=!0,c=w,d=x;break}if(B===d){R=!0,d=w,c=x;break}B=B.sibling}if(!R)throw Error(o(189))}}if(c.alternate!==d)throw Error(o(190))}if(c.tag!==3)throw Error(o(188));return c.stateNode.current===c?t:i}function S(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t;for(t=t.child;t!==null;){if(i=S(t),i!==null)return i;t=t.sibling}return null}var N=Object.assign,P=Symbol.for("react.element"),X=Symbol.for("react.transitional.element"),te=Symbol.for("react.portal"),oe=Symbol.for("react.fragment"),ue=Symbol.for("react.strict_mode"),Ye=Symbol.for("react.profiler"),ke=Symbol.for("react.consumer"),de=Symbol.for("react.context"),Pe=Symbol.for("react.forward_ref"),ft=Symbol.for("react.suspense"),qe=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function Y(t){return t===null||typeof t!="object"?null:(t=q&&t[q]||t["@@iterator"],typeof t=="function"?t:null)}var H=Symbol.for("react.client.reference");function rt(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===H?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case oe:return"Fragment";case Ye:return"Profiler";case ue:return"StrictMode";case ft:return"Suspense";case qe:return"SuspenseList";case V:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case te:return"Portal";case de:return t.displayName||"Context";case ke:return(t._context.displayName||"Context")+".Consumer";case Pe:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case F:return i=t.displayName||null,i!==null?i:rt(t.type)||"Memo";case j:i=t._payload,t=t._init;try{return rt(t(i))}catch{}}return null}var ae=Array.isArray,ce=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ze={pending:!1,data:null,method:null,action:null},pt=[],ct=-1;function K(t){return{current:t}}function pe(t){0>ct||(t.current=pt[ct],pt[ct]=null,ct--)}function De(t,i){ct++,pt[ct]=t.current,t.current=i}var Ve=K(null),Le=K(null),we=K(null),ut=K(null);function xt(t,i){switch(De(we,i),De(Le,t),De(Ve,null),i.nodeType){case 9:case 11:t=(t=i.documentElement)&&(t=t.namespaceURI)?O2(t):0;break;default:if(t=i.tagName,i=i.namespaceURI)i=O2(i),t=D2(i,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}pe(Ve),De(Ve,t)}function Mt(){pe(Ve),pe(Le),pe(we)}function Mn(t){t.memoizedState!==null&&De(ut,t);var i=Ve.current,c=D2(i,t.type);i!==c&&(De(Le,t),De(Ve,c))}function Ie(t){Le.current===t&&(pe(Ve),pe(Le)),ut.current===t&&(pe(ut),Qc._currentValue=ze)}var $e,He;function bt(t){if($e===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);$e=i&&i[1]||"",He=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$e+t+He}var yt=!1;function Ct(t,i){if(!t||yt)return"";yt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(xe){var ge=xe}Reflect.construct(t,[],Se)}else{try{Se.call()}catch(xe){ge=xe}t.call(Se.prototype)}}else{try{throw Error()}catch(xe){ge=xe}(Se=t())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(xe){if(xe&&ge&&typeof xe.stack=="string")return[xe.stack,ge.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=d.DetermineComponentFrameRoot(),R=w[0],B=w[1];if(R&&B){var W=R.split(`
`),fe=B.split(`
`);for(x=d=0;d<W.length&&!W[d].includes("DetermineComponentFrameRoot");)d++;for(;x<fe.length&&!fe[x].includes("DetermineComponentFrameRoot");)x++;if(d===W.length||x===fe.length)for(d=W.length-1,x=fe.length-1;1<=d&&0<=x&&W[d]!==fe[x];)x--;for(;1<=d&&0<=x;d--,x--)if(W[d]!==fe[x]){if(d!==1||x!==1)do if(d--,x--,0>x||W[d]!==fe[x]){var be=`
`+W[d].replace(" at new "," at ");return t.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",t.displayName)),be}while(1<=d&&0<=x);break}}}finally{yt=!1,Error.prepareStackTrace=c}return(c=t?t.displayName||t.name:"")?bt(c):""}function gt(t,i){switch(t.tag){case 26:case 27:case 5:return bt(t.type);case 16:return bt("Lazy");case 13:return t.child!==i&&i!==null?bt("Suspense Fallback"):bt("Suspense");case 19:return bt("SuspenseList");case 0:case 15:return Ct(t.type,!1);case 11:return Ct(t.type.render,!1);case 1:return Ct(t.type,!0);case 31:return bt("Activity");default:return""}}function ht(t){try{var i="",c=null;do i+=gt(t,c),c=t,t=t.return;while(t);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Qe=Object.prototype.hasOwnProperty,en=s.unstable_scheduleCallback,Xe=s.unstable_cancelCallback,Ur=s.unstable_shouldYield,St=s.unstable_requestPaint,Tt=s.unstable_now,Ae=s.unstable_getCurrentPriorityLevel,Re=s.unstable_ImmediatePriority,Ge=s.unstable_UserBlockingPriority,Je=s.unstable_NormalPriority,nt=s.unstable_LowPriority,kn=s.unstable_IdlePriority,st=s.log,Xt=s.unstable_setDisableYieldValue,et=null,Te=null;function kt(t){if(typeof st=="function"&&Xt(t),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(et,t)}catch{}}var mt=Math.clz32?Math.clz32:ri,Yt=Math.log,Xn=Math.LN2;function ri(t){return t>>>=0,t===0?32:31-(Yt(t)/Xn|0)|0}var Er=256,Bt=262144,An=4194304;function mi(t){var i=t&42;if(i!==0)return i;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Gr(t,i,c){var d=t.pendingLanes;if(d===0)return 0;var x=0,w=t.suspendedLanes,R=t.pingedLanes;t=t.warmLanes;var B=d&134217727;return B!==0?(d=B&~w,d!==0?x=mi(d):(R&=B,R!==0?x=mi(R):c||(c=B&~t,c!==0&&(x=mi(c))))):(B=d&~w,B!==0?x=mi(B):R!==0?x=mi(R):c||(c=d&~t,c!==0&&(x=mi(c)))),x===0?0:i!==0&&i!==x&&(i&w)===0&&(w=x&-x,c=i&-i,w>=c||w===32&&(c&4194048)!==0)?i:x}function Yn(t,i){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&i)===0}function Js(t,i){switch(t){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ar(){var t=An;return An<<=1,(An&62914560)===0&&(An=4194304),t}function Mr(t){for(var i=[],c=0;31>c;c++)i.push(t);return i}function vi(t,i){t.pendingLanes|=i,i!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function ii(t,i,c,d,x,w){var R=t.pendingLanes;t.pendingLanes=c,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=c,t.entangledLanes&=c,t.errorRecoveryDisabledLanes&=c,t.shellSuspendCounter=0;var B=t.entanglements,W=t.expirationTimes,fe=t.hiddenUpdates;for(c=R&~c;0<c;){var be=31-mt(c),Se=1<<be;B[be]=0,W[be]=-1;var ge=fe[be];if(ge!==null)for(fe[be]=null,be=0;be<ge.length;be++){var xe=ge[be];xe!==null&&(xe.lane&=-536870913)}c&=~Se}d!==0&&ys(t,d,0),w!==0&&x===0&&t.tag!==0&&(t.suspendedLanes|=w&~(R&~i))}function ys(t,i,c){t.pendingLanes|=i,t.suspendedLanes&=~i;var d=31-mt(i);t.entangledLanes|=i,t.entanglements[d]=t.entanglements[d]|1073741824|c&261930}function pi(t,i){var c=t.entangledLanes|=i;for(t=t.entanglements;c;){var d=31-mt(c),x=1<<d;x&i|t[d]&i&&(t[d]|=i),c&=~x}}function Es(t,i){var c=i&-i;return c=(c&42)!==0?1:$n(c),(c&(t.suspendedLanes|i))!==0?0:c}function $n(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function kr(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Lr(){var t=ne.p;return t!==0?t:(t=window.event,t===void 0?32:ty(t.type))}function We(t,i){var c=ne.p;try{return ne.p=t,i()}finally{ne.p=c}}var Tr=Math.random().toString(36).slice(2),Hn="__reactFiber$"+Tr,gn="__reactProps$"+Tr,ee="__reactContainer$"+Tr,je="__reactEvents$"+Tr,tt="__reactListeners$"+Tr,Ke="__reactHandles$"+Tr,Vt="__reactResources$"+Tr,Gt="__reactMarker$"+Tr;function Ln(t){delete t[Hn],delete t[gn],delete t[je],delete t[tt],delete t[Ke]}function yn(t){var i=t[Hn];if(i)return i;for(var c=t.parentNode;c;){if(i=c[ee]||c[Hn]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(t=U2(t);t!==null;){if(c=t[Hn])return c;t=U2(t)}return i}t=c,c=t.parentNode}return null}function Lt(t){if(t=t[Hn]||t[ee]){var i=t.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return t}return null}function hr(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t.stateNode;throw Error(o(33))}function Wn(t){var i=t[Vt];return i||(i=t[Vt]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function er(t){t[Gt]=!0}var Ne=new Set,Lo={};function _n(t,i){qr(t,i),qr(t+"Capture",i)}function qr(t,i){for(Lo[t]=i,t=0;t<i.length;t++)Ne.add(i[t])}var Po=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),on={},tn={};function Qt(t){return Qe.call(tn,t)?!0:Qe.call(on,t)?!1:Po.test(t)?tn[t]=!0:(on[t]=!0,!1)}function Rs(t,i,c){if(Qt(i))if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":t.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){t.removeAttribute(i);return}}t.setAttribute(i,""+c)}}function Xr(t,i,c){if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttribute(i,""+c)}}function tr(t,i,c,d){if(d===null)t.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(c);return}t.setAttributeNS(i,c,""+d)}}function Jt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Yr(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Bo(t,i,c){var d=Object.getOwnPropertyDescriptor(t.constructor.prototype,i);if(!t.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,w=d.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return x.call(this)},set:function(R){c=""+R,w.call(this,R)}}),Object.defineProperty(t,i,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(R){c=""+R},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function It(t){if(!t._valueTracker){var i=Yr(t)?"checked":"value";t._valueTracker=Bo(t,i,""+t[i])}}function si(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return t&&(d=Yr(t)?t.checked?"true":"false":t.value),t=d,t!==c?(i.setValue(t),!0):!1}function ts(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Ci=/[\n"\\]/g;function Wt(t){return t.replace(Ci,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function or(t,i,c,d,x,w,R,B){t.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?t.type=R:t.removeAttribute("type"),i!=null?R==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+Jt(i)):t.value!==""+Jt(i)&&(t.value=""+Jt(i)):R!=="submit"&&R!=="reset"||t.removeAttribute("value"),i!=null?z(t,R,Jt(i)):c!=null?z(t,R,Jt(c)):d!=null&&t.removeAttribute("value"),x==null&&w!=null&&(t.defaultChecked=!!w),x!=null&&(t.checked=x&&typeof x!="function"&&typeof x!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?t.name=""+Jt(B):t.removeAttribute("name")}function le(t,i,c,d,x,w,R,B){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(t.type=w),i!=null||c!=null){if(!(w!=="submit"&&w!=="reset"||i!=null)){It(t);return}c=c!=null?""+Jt(c):"",i=i!=null?""+Jt(i):c,B||i===t.value||(t.value=i),t.defaultValue=i}d=d??x,d=typeof d!="function"&&typeof d!="symbol"&&!!d,t.checked=B?t.checked:!!d,t.defaultChecked=!!d,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(t.name=R),It(t)}function z(t,i,c){i==="number"&&ts(t.ownerDocument)===t||t.defaultValue===""+c||(t.defaultValue=""+c)}function ot(t,i,c,d){if(t=t.options,i){i={};for(var x=0;x<c.length;x++)i["$"+c[x]]=!0;for(c=0;c<t.length;c++)x=i.hasOwnProperty("$"+t[c].value),t[c].selected!==x&&(t[c].selected=x),x&&d&&(t[c].defaultSelected=!0)}else{for(c=""+Jt(c),i=null,x=0;x<t.length;x++){if(t[x].value===c){t[x].selected=!0,d&&(t[x].defaultSelected=!0);return}i!==null||t[x].disabled||(i=t[x])}i!==null&&(i.selected=!0)}}function lr(t,i,c){if(i!=null&&(i=""+Jt(i),i!==t.value&&(t.value=i),c==null)){t.defaultValue!==i&&(t.defaultValue=i);return}t.defaultValue=c!=null?""+Jt(c):""}function xr(t,i,c,d){if(i==null){if(d!=null){if(c!=null)throw Error(o(92));if(ae(d)){if(1<d.length)throw Error(o(93));d=d[0]}c=d}c==null&&(c=""),i=c}c=Jt(i),t.defaultValue=c,d=t.textContent,d===c&&d!==""&&d!==null&&(t.value=d),It(t)}function ai(t,i){if(i){var c=t.firstChild;if(c&&c===t.lastChild&&c.nodeType===3){c.nodeValue=i;return}}t.textContent=i}var Pa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fr(t,i,c){var d=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="":d?t.setProperty(i,c):typeof c!="number"||c===0||Pa.has(i)?i==="float"?t.cssFloat=c:t[i]=(""+c).trim():t[i]=c+"px"}function Et(t,i,c){if(i!=null&&typeof i!="object")throw Error(o(62));if(t=t.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?t.setProperty(d,""):d==="float"?t.cssFloat="":t[d]="");for(var x in i)d=i[x],i.hasOwnProperty(x)&&c[x]!==d&&Fr(t,x,d)}else for(var w in i)i.hasOwnProperty(w)&&Fr(t,w,i[w])}function Cn(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ns=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Os(t){return Ns.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function oi(){}var $s=null;function Si(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fn=null,li=null;function ci(t){var i=Lt(t);if(i&&(t=i.stateNode)){var c=t[gn]||null;e:switch(t=i.stateNode,i.type){case"input":if(or(t,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=t;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Wt(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==t&&d.form===t.form){var x=d[gn]||null;if(!x)throw Error(o(90));or(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(i=0;i<c.length;i++)d=c[i],d.form===t.form&&si(d)}break e;case"textarea":lr(t,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&ot(t,!!c.multiple,i,!1)}}}var _t=!1;function Ds(t,i,c){if(_t)return t(i,c);_t=!0;try{var d=t(i);return d}finally{if(_t=!1,(Fn!==null||li!==null)&&(Ch(),Fn&&(i=Fn,t=li,li=Fn=null,ci(i),t)))for(i=0;i<t.length;i++)ci(t[i])}}function vt(t,i){var c=t.stateNode;if(c===null)return null;var d=c[gn]||null;if(d===null)return null;c=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(t=t.type,d=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!d;break e;default:t=!1}if(t)return null;if(c&&typeof c!="function")throw Error(o(231,i,typeof c));return c}var Sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ea=!1;if(Sn)try{var wn={};Object.defineProperty(wn,"passive",{get:function(){ea=!0}}),window.addEventListener("test",wn,wn),window.removeEventListener("test",wn,wn)}catch{ea=!1}var Fi=null,ji=null,ta=null;function xs(){if(ta)return ta;var t,i=ji,c=i.length,d,x="value"in Fi?Fi.value:Fi.textContent,w=x.length;for(t=0;t<c&&i[t]===x[t];t++);var R=c-t;for(d=1;d<=R&&i[c-d]===x[w-d];d++);return ta=x.slice(t,1<d?1-d:void 0)}function zi(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function yi(){return!0}function Ii(){return!1}function cr(t){function i(c,d,x,w,R){this._reactName=c,this._targetInst=x,this.type=d,this.nativeEvent=w,this.target=R,this.currentTarget=null;for(var B in t)t.hasOwnProperty(B)&&(c=t[B],this[B]=c?c(w):w[B]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?yi:Ii,this.isPropagationStopped=Ii,this}return N(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=yi)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=yi)},persist:function(){},isPersistent:yi}),i}var Ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kn=cr(Ei),_s=N({},Ei,{view:0,detail:0}),Ba=cr(_s),As,Va,ns,Ua=N({},_s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:is,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ns&&(ns&&t.type==="mousemove"?(As=t.screenX-ns.screenX,Va=t.screenY-ns.screenY):Va=As=0,ns=t),As)},movementY:function(t){return"movementY"in t?t.movementY:Va}}),En=cr(Ua),Ms=N({},Ua,{dataTransfer:0}),na=cr(Ms),Hi=N({},_s,{relatedTarget:0}),ra=cr(Hi),me=N({},Ei,{animationName:0,elapsedTime:0,pseudoElement:0}),jt=cr(me),nr=N({},Ei,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ia=cr(nr),Uo=N({},Ei,{data:0}),rs=cr(Uo),xl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_l={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rr(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=Fa[t])?!!i[t]:!1}function is(){return rr}var $t=N({},_s,{key:function(t){if(t.key){var i=xl[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=zi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_l[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:is,charCode:function(t){return t.type==="keypress"?zi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sa=cr($t),ss=N({},Ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nn=cr(ss),p=N({},_s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:is}),C=cr(p),O=N({},Ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),U=cr(O),ie=N({},Ua,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ee=cr(ie),Fe=N({},Ei,{newState:0,oldState:0}),Pt=cr(Fe),ir=[9,13,27,32],mn=Sn&&"CompositionEvent"in window,jn=null;Sn&&"documentMode"in document&&(jn=document.documentMode);var xi=Sn&&"TextEvent"in window&&!jn,as=Sn&&(!mn||jn&&8<jn&&11>=jn),jr=" ",_i=!1;function aa(t,i){switch(t){case"keyup":return ir.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function os(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ja=!1;function ks(t,i){switch(t){case"compositionend":return os(i);case"keypress":return i.which!==32?null:(_i=!0,jr);case"textInput":return t=i.data,t===jr&&_i?null:t;default:return null}}function Al(t,i){if(ja)return t==="compositionend"||!mn&&aa(t,i)?(t=xs(),ta=ji=Fi=null,ja=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return as&&i.locale!=="ko"?null:i.data;default:return null}}var Ri={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _c(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!Ri[t.type]:i==="textarea"}function Gi(t,i,c,d){Fn?li?li.push(d):li=[d]:Fn=d,i=Mh(i,"onChange"),0<i.length&&(c=new Kn("onChange","change",null,c,d),t.push({event:c,listeners:i}))}var Fo=null,oa=null;function gd(t){v2(t,0)}function jo(t){var i=hr(t);if(si(i))return t}function qi(t,i){if(t==="change")return i}var Gu=!1;if(Sn){var zo;if(Sn){var la="oninput"in document;if(!la){var ln=document.createElement("div");ln.setAttribute("oninput","return;"),la=typeof ln.oninput=="function"}zo=la}else zo=!1;Gu=zo&&(!document.documentMode||9<document.documentMode)}function Ho(){Fo&&(Fo.detachEvent("onpropertychange",M),oa=Fo=null)}function M(t){if(t.propertyName==="value"&&jo(oa)){var i=[];Gi(i,oa,t,Si(t)),Ds(gd,i)}}function r(t,i,c){t==="focusin"?(Ho(),Fo=i,oa=c,Fo.attachEvent("onpropertychange",M)):t==="focusout"&&Ho()}function a(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jo(oa)}function l(t,i){if(t==="click")return jo(i)}function u(t,i){if(t==="input"||t==="change")return jo(i)}function f(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var m=typeof Object.is=="function"?Object.is:f;function y(t,i){if(m(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var c=Object.keys(t),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var x=c[d];if(!Qe.call(i,x)||!m(t[x],i[x]))return!1}return!0}function A(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function T(t,i){var c=A(t);t=0;for(var d;c;){if(c.nodeType===3){if(d=t+c.textContent.length,t<=i&&d>=i)return{node:c,offset:i-t};t=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=A(c)}}function I(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?I(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function k(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var i=ts(t.document);i instanceof t.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)t=i.contentWindow;else break;i=ts(t.document)}return i}function L(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}var G=Sn&&"documentMode"in document&&11>=document.documentMode,Q=null,J=null,se=null,ye=!1;function Ue(t,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;ye||Q==null||Q!==ts(d)||(d=Q,"selectionStart"in d&&L(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),se&&y(se,d)||(se=d,d=Mh(J,"onSelect"),0<d.length&&(i=new Kn("onSelect","select",null,i,c),t.push({event:i,listeners:d}),i.target=Q)))}function Be(t,i){var c={};return c[t.toLowerCase()]=i.toLowerCase(),c["Webkit"+t]="webkit"+i,c["Moz"+t]="moz"+i,c}var Me={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionrun:Be("Transition","TransitionRun"),transitionstart:Be("Transition","TransitionStart"),transitioncancel:Be("Transition","TransitionCancel"),transitionend:Be("Transition","TransitionEnd")},Zt={},Ut={};Sn&&(Ut=document.createElement("div").style,"AnimationEvent"in window||(delete Me.animationend.animation,delete Me.animationiteration.animation,delete Me.animationstart.animation),"TransitionEvent"in window||delete Me.transitionend.transition);function fr(t){if(Zt[t])return Zt[t];if(!Me[t])return t;var i=Me[t],c;for(c in i)if(i.hasOwnProperty(c)&&c in Ut)return Zt[t]=i[c];return t}var Ni=fr("animationend"),Wr=fr("animationiteration"),In=fr("animationstart"),Pr=fr("transitionrun"),Ai=fr("transitionstart"),za=fr("transitioncancel"),ca=fr("transitionend"),qu=new Map,Ac="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ac.push("scrollEnd");function ws(t,i){qu.set(t,i),_n(i,[t])}var Xu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ls=[],wl=0,md=0;function Yu(){for(var t=wl,i=md=wl=0;i<t;){var c=ls[i];ls[i++]=null;var d=ls[i];ls[i++]=null;var x=ls[i];ls[i++]=null;var w=ls[i];if(ls[i++]=null,d!==null&&x!==null){var R=d.pending;R===null?x.next=x:(x.next=R.next,R.next=x),d.pending=x}w!==0&&am(c,x,w)}}function Wu(t,i,c,d){ls[wl++]=t,ls[wl++]=i,ls[wl++]=c,ls[wl++]=d,md|=d,t.lanes|=d,t=t.alternate,t!==null&&(t.lanes|=d)}function pd(t,i,c,d){return Wu(t,i,c,d),Ku(t)}function Go(t,i){return Wu(t,null,null,i),Ku(t)}function am(t,i,c){t.lanes|=c;var d=t.alternate;d!==null&&(d.lanes|=c);for(var x=!1,w=t.return;w!==null;)w.childLanes|=c,d=w.alternate,d!==null&&(d.childLanes|=c),w.tag===22&&(t=w.stateNode,t===null||t._visibility&1||(x=!0)),t=w,w=w.return;return t.tag===3?(w=t.stateNode,x&&i!==null&&(x=31-mt(c),t=w.hiddenUpdates,d=t[x],d===null?t[x]=[i]:d.push(i),i.lane=c|536870912),w):null}function Ku(t){if(50<Hc)throw Hc=0,v0=null,Error(o(185));for(var i=t.return;i!==null;)t=i,i=t.return;return t.tag===3?t.stateNode:null}var bl={};function nw(t,i,c,d){this.tag=t,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xi(t,i,c,d){return new nw(t,i,c,d)}function yd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ua(t,i){var c=t.alternate;return c===null?(c=Xi(t.tag,i,t.key,t.mode),c.elementType=t.elementType,c.type=t.type,c.stateNode=t.stateNode,c.alternate=t,t.alternate=c):(c.pendingProps=i,c.type=t.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=t.flags&65011712,c.childLanes=t.childLanes,c.lanes=t.lanes,c.child=t.child,c.memoizedProps=t.memoizedProps,c.memoizedState=t.memoizedState,c.updateQueue=t.updateQueue,i=t.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=t.sibling,c.index=t.index,c.ref=t.ref,c.refCleanup=t.refCleanup,c}function om(t,i){t.flags&=65011714;var c=t.alternate;return c===null?(t.childLanes=0,t.lanes=i,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=c.childLanes,t.lanes=c.lanes,t.child=c.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=c.memoizedProps,t.memoizedState=c.memoizedState,t.updateQueue=c.updateQueue,t.type=c.type,i=c.dependencies,t.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t}function Qu(t,i,c,d,x,w){var R=0;if(d=t,typeof t=="function")yd(t)&&(R=1);else if(typeof t=="string")R=ob(t,c,Ve.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case V:return t=Xi(31,c,i,x),t.elementType=V,t.lanes=w,t;case oe:return qo(c.children,x,w,i);case ue:R=8,x|=24;break;case Ye:return t=Xi(12,c,i,x|2),t.elementType=Ye,t.lanes=w,t;case ft:return t=Xi(13,c,i,x),t.elementType=ft,t.lanes=w,t;case qe:return t=Xi(19,c,i,x),t.elementType=qe,t.lanes=w,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case de:R=10;break e;case ke:R=9;break e;case Pe:R=11;break e;case F:R=14;break e;case j:R=16,d=null;break e}R=29,c=Error(o(130,t===null?"null":typeof t,"")),d=null}return i=Xi(R,c,i,x),i.elementType=t,i.type=d,i.lanes=w,i}function qo(t,i,c,d){return t=Xi(7,t,d,i),t.lanes=c,t}function Ed(t,i,c){return t=Xi(6,t,null,i),t.lanes=c,t}function lm(t){var i=Xi(18,null,null,0);return i.stateNode=t,i}function xd(t,i,c){return i=Xi(4,t.children!==null?t.children:[],t.key,i),i.lanes=c,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}var cm=new WeakMap;function cs(t,i){if(typeof t=="object"&&t!==null){var c=cm.get(t);return c!==void 0?c:(i={value:t,source:i,stack:ht(i)},cm.set(t,i),i)}return{value:t,source:i,stack:ht(i)}}var Tl=[],vl=0,Zu=null,wc=0,us=[],hs=0,Ha=null,Ls=1,Ps="";function ha(t,i){Tl[vl++]=wc,Tl[vl++]=Zu,Zu=t,wc=i}function um(t,i,c){us[hs++]=Ls,us[hs++]=Ps,us[hs++]=Ha,Ha=t;var d=Ls;t=Ps;var x=32-mt(d)-1;d&=~(1<<x),c+=1;var w=32-mt(i)+x;if(30<w){var R=x-x%5;w=(d&(1<<R)-1).toString(32),d>>=R,x-=R,Ls=1<<32-mt(i)+x|c<<x|d,Ps=w+t}else Ls=1<<w|c<<x|d,Ps=t}function _d(t){t.return!==null&&(ha(t,1),um(t,1,0))}function Ad(t){for(;t===Zu;)Zu=Tl[--vl],Tl[vl]=null,wc=Tl[--vl],Tl[vl]=null;for(;t===Ha;)Ha=us[--hs],us[hs]=null,Ps=us[--hs],us[hs]=null,Ls=us[--hs],us[hs]=null}function hm(t,i){us[hs++]=Ls,us[hs++]=Ps,us[hs++]=Ha,Ls=i.id,Ps=i.overflow,Ha=t}var Kr=null,Qn=null,pn=!1,Ga=null,fs=!1,wd=Error(o(519));function qa(t){var i=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bc(cs(i,t)),wd}function fm(t){var i=t.stateNode,c=t.type,d=t.memoizedProps;switch(i[Hn]=t,i[gn]=d,c){case"dialog":sn("cancel",i),sn("close",i);break;case"iframe":case"object":case"embed":sn("load",i);break;case"video":case"audio":for(c=0;c<qc.length;c++)sn(qc[c],i);break;case"source":sn("error",i);break;case"img":case"image":case"link":sn("error",i),sn("load",i);break;case"details":sn("toggle",i);break;case"input":sn("invalid",i),le(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":sn("invalid",i);break;case"textarea":sn("invalid",i),xr(i,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||d.suppressHydrationWarning===!0||R2(i.textContent,c)?(d.popover!=null&&(sn("beforetoggle",i),sn("toggle",i)),d.onScroll!=null&&sn("scroll",i),d.onScrollEnd!=null&&sn("scrollend",i),d.onClick!=null&&(i.onclick=oi),i=!0):i=!1,i||qa(t,!0)}function dm(t){for(Kr=t.return;Kr;)switch(Kr.tag){case 5:case 31:case 13:fs=!1;return;case 27:case 3:fs=!0;return;default:Kr=Kr.return}}function Cl(t){if(t!==Kr)return!1;if(!pn)return dm(t),pn=!0,!1;var i=t.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=t.type,c=!(c!=="form"&&c!=="button")||F0(t.type,t.memoizedProps)),c=!c),c&&Qn&&qa(t),dm(t),i===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Qn=V2(t)}else if(i===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Qn=V2(t)}else i===27?(i=Qn,so(t.type)?(t=q0,q0=null,Qn=t):Qn=i):Qn=Kr?gs(t.stateNode.nextSibling):null;return!0}function Xo(){Qn=Kr=null,pn=!1}function bd(){var t=Ga;return t!==null&&(ki===null?ki=t:ki.push.apply(ki,t),Ga=null),t}function bc(t){Ga===null?Ga=[t]:Ga.push(t)}var Td=K(null),Yo=null,fa=null;function Xa(t,i,c){De(Td,i._currentValue),i._currentValue=c}function da(t){t._currentValue=Td.current,pe(Td)}function vd(t,i,c){for(;t!==null;){var d=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),t===c)break;t=t.return}}function Cd(t,i,c,d){var x=t.child;for(x!==null&&(x.return=t);x!==null;){var w=x.dependencies;if(w!==null){var R=x.child;w=w.firstContext;e:for(;w!==null;){var B=w;w=x;for(var W=0;W<i.length;W++)if(B.context===i[W]){w.lanes|=c,B=w.alternate,B!==null&&(B.lanes|=c),vd(w.return,c,t),d||(R=null);break e}w=B.next}}else if(x.tag===18){if(R=x.return,R===null)throw Error(o(341));R.lanes|=c,w=R.alternate,w!==null&&(w.lanes|=c),vd(R,c,t),R=null}else R=x.child;if(R!==null)R.return=x;else for(R=x;R!==null;){if(R===t){R=null;break}if(x=R.sibling,x!==null){x.return=R.return,R=x;break}R=R.return}x=R}}function Sl(t,i,c,d){t=null;for(var x=i,w=!1;x!==null;){if(!w){if((x.flags&524288)!==0)w=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var R=x.alternate;if(R===null)throw Error(o(387));if(R=R.memoizedProps,R!==null){var B=x.type;m(x.pendingProps.value,R.value)||(t!==null?t.push(B):t=[B])}}else if(x===ut.current){if(R=x.alternate,R===null)throw Error(o(387));R.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(t!==null?t.push(Qc):t=[Qc])}x=x.return}t!==null&&Cd(i,t,c,d),i.flags|=262144}function Ju(t){for(t=t.firstContext;t!==null;){if(!m(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Wo(t){Yo=t,fa=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Qr(t){return gm(Yo,t)}function $u(t,i){return Yo===null&&Wo(t),gm(t,i)}function gm(t,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},fa===null){if(t===null)throw Error(o(308));fa=i,t.dependencies={lanes:0,firstContext:i},t.flags|=524288}else fa=fa.next=i;return c}var rw=typeof AbortController<"u"?AbortController:function(){var t=[],i=this.signal={aborted:!1,addEventListener:function(c,d){t.push(d)}};this.abort=function(){i.aborted=!0,t.forEach(function(c){return c()})}},iw=s.unstable_scheduleCallback,sw=s.unstable_NormalPriority,vr={$$typeof:de,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sd(){return{controller:new rw,data:new Map,refCount:0}}function Tc(t){t.refCount--,t.refCount===0&&iw(sw,function(){t.controller.abort()})}var vc=null,Id=0,Il=0,Rl=null;function aw(t,i){if(vc===null){var c=vc=[];Id=0,Il=O0(),Rl={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Id++,i.then(mm,mm),i}function mm(){if(--Id===0&&vc!==null){Rl!==null&&(Rl.status="fulfilled");var t=vc;vc=null,Il=0,Rl=null;for(var i=0;i<t.length;i++)(0,t[i])()}}function ow(t,i){var c=[],d={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return t.then(function(){d.status="fulfilled",d.value=i;for(var x=0;x<c.length;x++)(0,c[x])(i)},function(x){for(d.status="rejected",d.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),d}var pm=ce.S;ce.S=function(t,i){$p=Tt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&aw(t,i),pm!==null&&pm(t,i)};var Ko=K(null);function Rd(){var t=Ko.current;return t!==null?t:zn.pooledCache}function eh(t,i){i===null?De(Ko,Ko.current):De(Ko,i.pool)}function ym(){var t=Rd();return t===null?null:{parent:vr._currentValue,pool:t}}var Nl=Error(o(460)),Nd=Error(o(474)),th=Error(o(542)),nh={then:function(){}};function Em(t){return t=t.status,t==="fulfilled"||t==="rejected"}function xm(t,i,c){switch(c=t[c],c===void 0?t.push(i):c!==i&&(i.then(oi,oi),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,Am(t),t;default:if(typeof i.status=="string")i.then(oi,oi);else{if(t=zn,t!==null&&100<t.shellSuspendCounter)throw Error(o(482));t=i,t.status="pending",t.then(function(d){if(i.status==="pending"){var x=i;x.status="fulfilled",x.value=d}},function(d){if(i.status==="pending"){var x=i;x.status="rejected",x.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,Am(t),t}throw Zo=i,Nl}}function Qo(t){try{var i=t._init;return i(t._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Zo=c,Nl):c}}var Zo=null;function _m(){if(Zo===null)throw Error(o(459));var t=Zo;return Zo=null,t}function Am(t){if(t===Nl||t===th)throw Error(o(483))}var Ol=null,Cc=0;function rh(t){var i=Cc;return Cc+=1,Ol===null&&(Ol=[]),xm(Ol,t,i)}function Sc(t,i){i=i.props.ref,t.ref=i!==void 0?i:null}function ih(t,i){throw i.$$typeof===P?Error(o(525)):(t=Object.prototype.toString.call(i),Error(o(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t)))}function wm(t){function i(re,$){if(t){var he=re.deletions;he===null?(re.deletions=[$],re.flags|=16):he.push($)}}function c(re,$){if(!t)return null;for(;$!==null;)i(re,$),$=$.sibling;return null}function d(re){for(var $=new Map;re!==null;)re.key!==null?$.set(re.key,re):$.set(re.index,re),re=re.sibling;return $}function x(re,$){return re=ua(re,$),re.index=0,re.sibling=null,re}function w(re,$,he){return re.index=he,t?(he=re.alternate,he!==null?(he=he.index,he<$?(re.flags|=67108866,$):he):(re.flags|=67108866,$)):(re.flags|=1048576,$)}function R(re){return t&&re.alternate===null&&(re.flags|=67108866),re}function B(re,$,he,ve){return $===null||$.tag!==6?($=Ed(he,re.mode,ve),$.return=re,$):($=x($,he),$.return=re,$)}function W(re,$,he,ve){var At=he.type;return At===oe?be(re,$,he.props.children,ve,he.key):$!==null&&($.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===j&&Qo(At)===$.type)?($=x($,he.props),Sc($,he),$.return=re,$):($=Qu(he.type,he.key,he.props,null,re.mode,ve),Sc($,he),$.return=re,$)}function fe(re,$,he,ve){return $===null||$.tag!==4||$.stateNode.containerInfo!==he.containerInfo||$.stateNode.implementation!==he.implementation?($=xd(he,re.mode,ve),$.return=re,$):($=x($,he.children||[]),$.return=re,$)}function be(re,$,he,ve,At){return $===null||$.tag!==7?($=qo(he,re.mode,ve,At),$.return=re,$):($=x($,he),$.return=re,$)}function Se(re,$,he){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Ed(""+$,re.mode,he),$.return=re,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case X:return he=Qu($.type,$.key,$.props,null,re.mode,he),Sc(he,$),he.return=re,he;case te:return $=xd($,re.mode,he),$.return=re,$;case j:return $=Qo($),Se(re,$,he)}if(ae($)||Y($))return $=qo($,re.mode,he,null),$.return=re,$;if(typeof $.then=="function")return Se(re,rh($),he);if($.$$typeof===de)return Se(re,$u(re,$),he);ih(re,$)}return null}function ge(re,$,he,ve){var At=$!==null?$.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return At!==null?null:B(re,$,""+he,ve);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case X:return he.key===At?W(re,$,he,ve):null;case te:return he.key===At?fe(re,$,he,ve):null;case j:return he=Qo(he),ge(re,$,he,ve)}if(ae(he)||Y(he))return At!==null?null:be(re,$,he,ve,null);if(typeof he.then=="function")return ge(re,$,rh(he),ve);if(he.$$typeof===de)return ge(re,$,$u(re,he),ve);ih(re,he)}return null}function xe(re,$,he,ve,At){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return re=re.get(he)||null,B($,re,""+ve,At);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case X:return re=re.get(ve.key===null?he:ve.key)||null,W($,re,ve,At);case te:return re=re.get(ve.key===null?he:ve.key)||null,fe($,re,ve,At);case j:return ve=Qo(ve),xe(re,$,he,ve,At)}if(ae(ve)||Y(ve))return re=re.get(he)||null,be($,re,ve,At,null);if(typeof ve.then=="function")return xe(re,$,he,rh(ve),At);if(ve.$$typeof===de)return xe(re,$,he,$u($,ve),At);ih($,ve)}return null}function lt(re,$,he,ve){for(var At=null,bn=null,dt=$,Kt=$=0,un=null;dt!==null&&Kt<he.length;Kt++){dt.index>Kt?(un=dt,dt=null):un=dt.sibling;var Tn=ge(re,dt,he[Kt],ve);if(Tn===null){dt===null&&(dt=un);break}t&&dt&&Tn.alternate===null&&i(re,dt),$=w(Tn,$,Kt),bn===null?At=Tn:bn.sibling=Tn,bn=Tn,dt=un}if(Kt===he.length)return c(re,dt),pn&&ha(re,Kt),At;if(dt===null){for(;Kt<he.length;Kt++)dt=Se(re,he[Kt],ve),dt!==null&&($=w(dt,$,Kt),bn===null?At=dt:bn.sibling=dt,bn=dt);return pn&&ha(re,Kt),At}for(dt=d(dt);Kt<he.length;Kt++)un=xe(dt,re,Kt,he[Kt],ve),un!==null&&(t&&un.alternate!==null&&dt.delete(un.key===null?Kt:un.key),$=w(un,$,Kt),bn===null?At=un:bn.sibling=un,bn=un);return t&&dt.forEach(function(uo){return i(re,uo)}),pn&&ha(re,Kt),At}function Rt(re,$,he,ve){if(he==null)throw Error(o(151));for(var At=null,bn=null,dt=$,Kt=$=0,un=null,Tn=he.next();dt!==null&&!Tn.done;Kt++,Tn=he.next()){dt.index>Kt?(un=dt,dt=null):un=dt.sibling;var uo=ge(re,dt,Tn.value,ve);if(uo===null){dt===null&&(dt=un);break}t&&dt&&uo.alternate===null&&i(re,dt),$=w(uo,$,Kt),bn===null?At=uo:bn.sibling=uo,bn=uo,dt=un}if(Tn.done)return c(re,dt),pn&&ha(re,Kt),At;if(dt===null){for(;!Tn.done;Kt++,Tn=he.next())Tn=Se(re,Tn.value,ve),Tn!==null&&($=w(Tn,$,Kt),bn===null?At=Tn:bn.sibling=Tn,bn=Tn);return pn&&ha(re,Kt),At}for(dt=d(dt);!Tn.done;Kt++,Tn=he.next())Tn=xe(dt,re,Kt,Tn.value,ve),Tn!==null&&(t&&Tn.alternate!==null&&dt.delete(Tn.key===null?Kt:Tn.key),$=w(Tn,$,Kt),bn===null?At=Tn:bn.sibling=Tn,bn=Tn);return t&&dt.forEach(function(Eb){return i(re,Eb)}),pn&&ha(re,Kt),At}function Vn(re,$,he,ve){if(typeof he=="object"&&he!==null&&he.type===oe&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case X:e:{for(var At=he.key;$!==null;){if($.key===At){if(At=he.type,At===oe){if($.tag===7){c(re,$.sibling),ve=x($,he.props.children),ve.return=re,re=ve;break e}}else if($.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===j&&Qo(At)===$.type){c(re,$.sibling),ve=x($,he.props),Sc(ve,he),ve.return=re,re=ve;break e}c(re,$);break}else i(re,$);$=$.sibling}he.type===oe?(ve=qo(he.props.children,re.mode,ve,he.key),ve.return=re,re=ve):(ve=Qu(he.type,he.key,he.props,null,re.mode,ve),Sc(ve,he),ve.return=re,re=ve)}return R(re);case te:e:{for(At=he.key;$!==null;){if($.key===At)if($.tag===4&&$.stateNode.containerInfo===he.containerInfo&&$.stateNode.implementation===he.implementation){c(re,$.sibling),ve=x($,he.children||[]),ve.return=re,re=ve;break e}else{c(re,$);break}else i(re,$);$=$.sibling}ve=xd(he,re.mode,ve),ve.return=re,re=ve}return R(re);case j:return he=Qo(he),Vn(re,$,he,ve)}if(ae(he))return lt(re,$,he,ve);if(Y(he)){if(At=Y(he),typeof At!="function")throw Error(o(150));return he=At.call(he),Rt(re,$,he,ve)}if(typeof he.then=="function")return Vn(re,$,rh(he),ve);if(he.$$typeof===de)return Vn(re,$,$u(re,he),ve);ih(re,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,$!==null&&$.tag===6?(c(re,$.sibling),ve=x($,he),ve.return=re,re=ve):(c(re,$),ve=Ed(he,re.mode,ve),ve.return=re,re=ve),R(re)):c(re,$)}return function(re,$,he,ve){try{Cc=0;var At=Vn(re,$,he,ve);return Ol=null,At}catch(dt){if(dt===Nl||dt===th)throw dt;var bn=Xi(29,dt,null,re.mode);return bn.lanes=ve,bn.return=re,bn}finally{}}}var Jo=wm(!0),bm=wm(!1),Ya=!1;function Od(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dd(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Wa(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Ka(t,i,c){var d=t.updateQueue;if(d===null)return null;if(d=d.shared,(vn&2)!==0){var x=d.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),d.pending=i,i=Ku(t),am(t,null,c),i}return Wu(t,d,i,c),Ku(t)}function Ic(t,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var d=i.lanes;d&=t.pendingLanes,c|=d,i.lanes=c,pi(t,c)}}function Md(t,i){var c=t.updateQueue,d=t.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var x=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var R={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};w===null?x=w=R:w=w.next=R,c=c.next}while(c!==null);w===null?x=w=i:w=w.next=i}else x=w=i;c={baseState:d.baseState,firstBaseUpdate:x,lastBaseUpdate:w,shared:d.shared,callbacks:d.callbacks},t.updateQueue=c;return}t=c.lastBaseUpdate,t===null?c.firstBaseUpdate=i:t.next=i,c.lastBaseUpdate=i}var kd=!1;function Rc(){if(kd){var t=Rl;if(t!==null)throw t}}function Nc(t,i,c,d){kd=!1;var x=t.updateQueue;Ya=!1;var w=x.firstBaseUpdate,R=x.lastBaseUpdate,B=x.shared.pending;if(B!==null){x.shared.pending=null;var W=B,fe=W.next;W.next=null,R===null?w=fe:R.next=fe,R=W;var be=t.alternate;be!==null&&(be=be.updateQueue,B=be.lastBaseUpdate,B!==R&&(B===null?be.firstBaseUpdate=fe:B.next=fe,be.lastBaseUpdate=W))}if(w!==null){var Se=x.baseState;R=0,be=fe=W=null,B=w;do{var ge=B.lane&-536870913,xe=ge!==B.lane;if(xe?(cn&ge)===ge:(d&ge)===ge){ge!==0&&ge===Il&&(kd=!0),be!==null&&(be=be.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var lt=t,Rt=B;ge=i;var Vn=c;switch(Rt.tag){case 1:if(lt=Rt.payload,typeof lt=="function"){Se=lt.call(Vn,Se,ge);break e}Se=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=Rt.payload,ge=typeof lt=="function"?lt.call(Vn,Se,ge):lt,ge==null)break e;Se=N({},Se,ge);break e;case 2:Ya=!0}}ge=B.callback,ge!==null&&(t.flags|=64,xe&&(t.flags|=8192),xe=x.callbacks,xe===null?x.callbacks=[ge]:xe.push(ge))}else xe={lane:ge,tag:B.tag,payload:B.payload,callback:B.callback,next:null},be===null?(fe=be=xe,W=Se):be=be.next=xe,R|=ge;if(B=B.next,B===null){if(B=x.shared.pending,B===null)break;xe=B,B=xe.next,xe.next=null,x.lastBaseUpdate=xe,x.shared.pending=null}}while(!0);be===null&&(W=Se),x.baseState=W,x.firstBaseUpdate=fe,x.lastBaseUpdate=be,w===null&&(x.shared.lanes=0),eo|=R,t.lanes=R,t.memoizedState=Se}}function Tm(t,i){if(typeof t!="function")throw Error(o(191,t));t.call(i)}function vm(t,i){var c=t.callbacks;if(c!==null)for(t.callbacks=null,t=0;t<c.length;t++)Tm(c[t],i)}var Dl=K(null),sh=K(0);function Cm(t,i){t=wa,De(sh,t),De(Dl,i),wa=t|i.baseLanes}function Ld(){De(sh,wa),De(Dl,Dl.current)}function Pd(){wa=sh.current,pe(Dl),pe(sh)}var Yi=K(null),ds=null;function Qa(t){var i=t.alternate;De(_r,_r.current&1),De(Yi,t),ds===null&&(i===null||Dl.current!==null||i.memoizedState!==null)&&(ds=t)}function Bd(t){De(_r,_r.current),De(Yi,t),ds===null&&(ds=t)}function Sm(t){t.tag===22?(De(_r,_r.current),De(Yi,t),ds===null&&(ds=t)):Za()}function Za(){De(_r,_r.current),De(Yi,Yi.current)}function Wi(t){pe(Yi),ds===t&&(ds=null),pe(_r)}var _r=K(0);function ah(t){for(var i=t;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||H0(c)||G0(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var ga=0,qt=null,Pn=null,Cr=null,oh=!1,Ml=!1,$o=!1,lh=0,Oc=0,kl=null,lw=0;function dr(){throw Error(o(321))}function Vd(t,i){if(i===null)return!1;for(var c=0;c<i.length&&c<t.length;c++)if(!m(t[c],i[c]))return!1;return!0}function Ud(t,i,c,d,x,w){return ga=w,qt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ce.H=t===null||t.memoizedState===null?up:e0,$o=!1,w=c(d,x),$o=!1,Ml&&(w=Rm(i,c,d,x)),Im(t),w}function Im(t){ce.H=kc;var i=Pn!==null&&Pn.next!==null;if(ga=0,Cr=Pn=qt=null,oh=!1,Oc=0,kl=null,i)throw Error(o(300));t===null||Sr||(t=t.dependencies,t!==null&&Ju(t)&&(Sr=!0))}function Rm(t,i,c,d){qt=t;var x=0;do{if(Ml&&(kl=null),Oc=0,Ml=!1,25<=x)throw Error(o(301));if(x+=1,Cr=Pn=null,t.updateQueue!=null){var w=t.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}ce.H=hp,w=i(c,d)}while(Ml);return w}function cw(){var t=ce.H,i=t.useState()[0];return i=typeof i.then=="function"?Dc(i):i,t=t.useState()[0],(Pn!==null?Pn.memoizedState:null)!==t&&(qt.flags|=1024),i}function Fd(){var t=lh!==0;return lh=0,t}function jd(t,i,c){i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~c}function zd(t){if(oh){for(t=t.memoizedState;t!==null;){var i=t.queue;i!==null&&(i.pending=null),t=t.next}oh=!1}ga=0,Cr=Pn=qt=null,Ml=!1,Oc=lh=0,kl=null}function wi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cr===null?qt.memoizedState=Cr=t:Cr=Cr.next=t,Cr}function Ar(){if(Pn===null){var t=qt.alternate;t=t!==null?t.memoizedState:null}else t=Pn.next;var i=Cr===null?qt.memoizedState:Cr.next;if(i!==null)Cr=i,Pn=t;else{if(t===null)throw qt.alternate===null?Error(o(467)):Error(o(310));Pn=t,t={memoizedState:Pn.memoizedState,baseState:Pn.baseState,baseQueue:Pn.baseQueue,queue:Pn.queue,next:null},Cr===null?qt.memoizedState=Cr=t:Cr=Cr.next=t}return Cr}function ch(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dc(t){var i=Oc;return Oc+=1,kl===null&&(kl=[]),t=xm(kl,t,i),i=qt,(Cr===null?i.memoizedState:Cr.next)===null&&(i=i.alternate,ce.H=i===null||i.memoizedState===null?up:e0),t}function uh(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Dc(t);if(t.$$typeof===de)return Qr(t)}throw Error(o(438,String(t)))}function Hd(t){var i=null,c=qt.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var d=qt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(x){return x.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=ch(),qt.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(t),d=0;d<t;d++)c[d]=Z;return i.index++,c}function ma(t,i){return typeof i=="function"?i(t):i}function hh(t){var i=Ar();return Gd(i,Pn,t)}function Gd(t,i,c){var d=t.queue;if(d===null)throw Error(o(311));d.lastRenderedReducer=c;var x=t.baseQueue,w=d.pending;if(w!==null){if(x!==null){var R=x.next;x.next=w.next,w.next=R}i.baseQueue=x=w,d.pending=null}if(w=t.baseState,x===null)t.memoizedState=w;else{i=x.next;var B=R=null,W=null,fe=i,be=!1;do{var Se=fe.lane&-536870913;if(Se!==fe.lane?(cn&Se)===Se:(ga&Se)===Se){var ge=fe.revertLane;if(ge===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),Se===Il&&(be=!0);else if((ga&ge)===ge){fe=fe.next,ge===Il&&(be=!0);continue}else Se={lane:0,revertLane:fe.revertLane,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},W===null?(B=W=Se,R=w):W=W.next=Se,qt.lanes|=ge,eo|=ge;Se=fe.action,$o&&c(w,Se),w=fe.hasEagerState?fe.eagerState:c(w,Se)}else ge={lane:Se,revertLane:fe.revertLane,gesture:fe.gesture,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},W===null?(B=W=ge,R=w):W=W.next=ge,qt.lanes|=Se,eo|=Se;fe=fe.next}while(fe!==null&&fe!==i);if(W===null?R=w:W.next=B,!m(w,t.memoizedState)&&(Sr=!0,be&&(c=Rl,c!==null)))throw c;t.memoizedState=w,t.baseState=R,t.baseQueue=W,d.lastRenderedState=w}return x===null&&(d.lanes=0),[t.memoizedState,d.dispatch]}function qd(t){var i=Ar(),c=i.queue;if(c===null)throw Error(o(311));c.lastRenderedReducer=t;var d=c.dispatch,x=c.pending,w=i.memoizedState;if(x!==null){c.pending=null;var R=x=x.next;do w=t(w,R.action),R=R.next;while(R!==x);m(w,i.memoizedState)||(Sr=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),c.lastRenderedState=w}return[w,d]}function Nm(t,i,c){var d=qt,x=Ar(),w=pn;if(w){if(c===void 0)throw Error(o(407));c=c()}else c=i();var R=!m((Pn||x).memoizedState,c);if(R&&(x.memoizedState=c,Sr=!0),x=x.queue,Wd(Mm.bind(null,d,x,t),[t]),x.getSnapshot!==i||R||Cr!==null&&Cr.memoizedState.tag&1){if(d.flags|=2048,Ll(9,{destroy:void 0},Dm.bind(null,d,x,c,i),null),zn===null)throw Error(o(349));w||(ga&127)!==0||Om(d,i,c)}return c}function Om(t,i,c){t.flags|=16384,t={getSnapshot:i,value:c},i=qt.updateQueue,i===null?(i=ch(),qt.updateQueue=i,i.stores=[t]):(c=i.stores,c===null?i.stores=[t]:c.push(t))}function Dm(t,i,c,d){i.value=c,i.getSnapshot=d,km(i)&&Lm(t)}function Mm(t,i,c){return c(function(){km(i)&&Lm(t)})}function km(t){var i=t.getSnapshot;t=t.value;try{var c=i();return!m(t,c)}catch{return!0}}function Lm(t){var i=Go(t,2);i!==null&&Li(i,t,2)}function Xd(t){var i=wi();if(typeof t=="function"){var c=t;if(t=c(),$o){kt(!0);try{c()}finally{kt(!1)}}}return i.memoizedState=i.baseState=t,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:t},i}function Pm(t,i,c,d){return t.baseState=c,Gd(t,Pn,typeof d=="function"?d:ma)}function uw(t,i,c,d,x){if(gh(t))throw Error(o(485));if(t=i.action,t!==null){var w={payload:x,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){w.listeners.push(R)}};ce.T!==null?c(!0):w.isTransition=!1,d(w),c=i.pending,c===null?(w.next=i.pending=w,Bm(i,w)):(w.next=c.next,i.pending=c.next=w)}}function Bm(t,i){var c=i.action,d=i.payload,x=t.state;if(i.isTransition){var w=ce.T,R={};ce.T=R;try{var B=c(x,d),W=ce.S;W!==null&&W(R,B),Vm(t,i,B)}catch(fe){Yd(t,i,fe)}finally{w!==null&&R.types!==null&&(w.types=R.types),ce.T=w}}else try{w=c(x,d),Vm(t,i,w)}catch(fe){Yd(t,i,fe)}}function Vm(t,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){Um(t,i,d)},function(d){return Yd(t,i,d)}):Um(t,i,c)}function Um(t,i,c){i.status="fulfilled",i.value=c,Fm(i),t.state=c,i=t.pending,i!==null&&(c=i.next,c===i?t.pending=null:(c=c.next,i.next=c,Bm(t,c)))}function Yd(t,i,c){var d=t.pending;if(t.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=c,Fm(i),i=i.next;while(i!==d)}t.action=null}function Fm(t){t=t.listeners;for(var i=0;i<t.length;i++)(0,t[i])()}function jm(t,i){return i}function zm(t,i){if(pn){var c=zn.formState;if(c!==null){e:{var d=qt;if(pn){if(Qn){t:{for(var x=Qn,w=fs;x.nodeType!==8;){if(!w){x=null;break t}if(x=gs(x.nextSibling),x===null){x=null;break t}}w=x.data,x=w==="F!"||w==="F"?x:null}if(x){Qn=gs(x.nextSibling),d=x.data==="F!";break e}}qa(d)}d=!1}d&&(i=c[0])}}return c=wi(),c.memoizedState=c.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jm,lastRenderedState:i},c.queue=d,c=op.bind(null,qt,d),d.dispatch=c,d=Xd(!1),w=$d.bind(null,qt,!1,d.queue),d=wi(),x={state:i,dispatch:null,action:t,pending:null},d.queue=x,c=uw.bind(null,qt,x,w,c),x.dispatch=c,d.memoizedState=t,[i,c,!1]}function Hm(t){var i=Ar();return Gm(i,Pn,t)}function Gm(t,i,c){if(i=Gd(t,i,jm)[0],t=hh(ma)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=Dc(i)}catch(R){throw R===Nl?th:R}else d=i;i=Ar();var x=i.queue,w=x.dispatch;return c!==i.memoizedState&&(qt.flags|=2048,Ll(9,{destroy:void 0},hw.bind(null,x,c),null)),[d,w,t]}function hw(t,i){t.action=i}function qm(t){var i=Ar(),c=Pn;if(c!==null)return Gm(i,c,t);Ar(),i=i.memoizedState,c=Ar();var d=c.queue.dispatch;return c.memoizedState=t,[i,d,!1]}function Ll(t,i,c,d){return t={tag:t,create:c,deps:d,inst:i,next:null},i=qt.updateQueue,i===null&&(i=ch(),qt.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=t.next=t:(d=c.next,c.next=t,t.next=d,i.lastEffect=t),t}function Xm(){return Ar().memoizedState}function fh(t,i,c,d){var x=wi();qt.flags|=t,x.memoizedState=Ll(1|i,{destroy:void 0},c,d===void 0?null:d)}function dh(t,i,c,d){var x=Ar();d=d===void 0?null:d;var w=x.memoizedState.inst;Pn!==null&&d!==null&&Vd(d,Pn.memoizedState.deps)?x.memoizedState=Ll(i,w,c,d):(qt.flags|=t,x.memoizedState=Ll(1|i,w,c,d))}function Ym(t,i){fh(8390656,8,t,i)}function Wd(t,i){dh(2048,8,t,i)}function fw(t){qt.flags|=4;var i=qt.updateQueue;if(i===null)i=ch(),qt.updateQueue=i,i.events=[t];else{var c=i.events;c===null?i.events=[t]:c.push(t)}}function Wm(t){var i=Ar().memoizedState;return fw({ref:i,nextImpl:t}),function(){if((vn&2)!==0)throw Error(o(440));return i.impl.apply(void 0,arguments)}}function Km(t,i){return dh(4,2,t,i)}function Qm(t,i){return dh(4,4,t,i)}function Zm(t,i){if(typeof i=="function"){t=t();var c=i(t);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function Jm(t,i,c){c=c!=null?c.concat([t]):null,dh(4,4,Zm.bind(null,i,t),c)}function Kd(){}function $m(t,i){var c=Ar();i=i===void 0?null:i;var d=c.memoizedState;return i!==null&&Vd(i,d[1])?d[0]:(c.memoizedState=[t,i],t)}function ep(t,i){var c=Ar();i=i===void 0?null:i;var d=c.memoizedState;if(i!==null&&Vd(i,d[1]))return d[0];if(d=t(),$o){kt(!0);try{t()}finally{kt(!1)}}return c.memoizedState=[d,i],d}function Qd(t,i,c){return c===void 0||(ga&1073741824)!==0&&(cn&261930)===0?t.memoizedState=i:(t.memoizedState=c,t=t2(),qt.lanes|=t,eo|=t,c)}function tp(t,i,c,d){return m(c,i)?c:Dl.current!==null?(t=Qd(t,c,d),m(t,i)||(Sr=!0),t):(ga&42)===0||(ga&1073741824)!==0&&(cn&261930)===0?(Sr=!0,t.memoizedState=c):(t=t2(),qt.lanes|=t,eo|=t,i)}function np(t,i,c,d,x){var w=ne.p;ne.p=w!==0&&8>w?w:8;var R=ce.T,B={};ce.T=B,$d(t,!1,i,c);try{var W=x(),fe=ce.S;if(fe!==null&&fe(B,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var be=ow(W,d);Mc(t,i,be,Zi(t))}else Mc(t,i,d,Zi(t))}catch(Se){Mc(t,i,{then:function(){},status:"rejected",reason:Se},Zi())}finally{ne.p=w,R!==null&&B.types!==null&&(R.types=B.types),ce.T=R}}function dw(){}function Zd(t,i,c,d){if(t.tag!==5)throw Error(o(476));var x=rp(t).queue;np(t,x,i,ze,c===null?dw:function(){return ip(t),c(d)})}function rp(t){var i=t.memoizedState;if(i!==null)return i;i={memoizedState:ze,baseState:ze,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:ze},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:c},next:null},t.memoizedState=i,t=t.alternate,t!==null&&(t.memoizedState=i),i}function ip(t){var i=rp(t);i.next===null&&(i=t.alternate.memoizedState),Mc(t,i.next.queue,{},Zi())}function Jd(){return Qr(Qc)}function sp(){return Ar().memoizedState}function ap(){return Ar().memoizedState}function gw(t){for(var i=t.return;i!==null;){switch(i.tag){case 24:case 3:var c=Zi();t=Wa(c);var d=Ka(i,t,c);d!==null&&(Li(d,i,c),Ic(d,i,c)),i={cache:Sd()},t.payload=i;return}i=i.return}}function mw(t,i,c){var d=Zi();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},gh(t)?lp(i,c):(c=pd(t,i,c,d),c!==null&&(Li(c,t,d),cp(c,i,d)))}function op(t,i,c){var d=Zi();Mc(t,i,c,d)}function Mc(t,i,c,d){var x={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(gh(t))lp(i,x);else{var w=t.alternate;if(t.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var R=i.lastRenderedState,B=w(R,c);if(x.hasEagerState=!0,x.eagerState=B,m(B,R))return Wu(t,i,x,0),zn===null&&Yu(),!1}catch{}finally{}if(c=pd(t,i,x,d),c!==null)return Li(c,t,d),cp(c,i,d),!0}return!1}function $d(t,i,c,d){if(d={lane:2,revertLane:O0(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},gh(t)){if(i)throw Error(o(479))}else i=pd(t,c,d,2),i!==null&&Li(i,t,2)}function gh(t){var i=t.alternate;return t===qt||i!==null&&i===qt}function lp(t,i){Ml=oh=!0;var c=t.pending;c===null?i.next=i:(i.next=c.next,c.next=i),t.pending=i}function cp(t,i,c){if((c&4194048)!==0){var d=i.lanes;d&=t.pendingLanes,c|=d,i.lanes=c,pi(t,c)}}var kc={readContext:Qr,use:uh,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useLayoutEffect:dr,useInsertionEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useSyncExternalStore:dr,useId:dr,useHostTransitionStatus:dr,useFormState:dr,useActionState:dr,useOptimistic:dr,useMemoCache:dr,useCacheRefresh:dr};kc.useEffectEvent=dr;var up={readContext:Qr,use:uh,useCallback:function(t,i){return wi().memoizedState=[t,i===void 0?null:i],t},useContext:Qr,useEffect:Ym,useImperativeHandle:function(t,i,c){c=c!=null?c.concat([t]):null,fh(4194308,4,Zm.bind(null,i,t),c)},useLayoutEffect:function(t,i){return fh(4194308,4,t,i)},useInsertionEffect:function(t,i){fh(4,2,t,i)},useMemo:function(t,i){var c=wi();i=i===void 0?null:i;var d=t();if($o){kt(!0);try{t()}finally{kt(!1)}}return c.memoizedState=[d,i],d},useReducer:function(t,i,c){var d=wi();if(c!==void 0){var x=c(i);if($o){kt(!0);try{c(i)}finally{kt(!1)}}}else x=i;return d.memoizedState=d.baseState=x,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:x},d.queue=t,t=t.dispatch=mw.bind(null,qt,t),[d.memoizedState,t]},useRef:function(t){var i=wi();return t={current:t},i.memoizedState=t},useState:function(t){t=Xd(t);var i=t.queue,c=op.bind(null,qt,i);return i.dispatch=c,[t.memoizedState,c]},useDebugValue:Kd,useDeferredValue:function(t,i){var c=wi();return Qd(c,t,i)},useTransition:function(){var t=Xd(!1);return t=np.bind(null,qt,t.queue,!0,!1),wi().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,i,c){var d=qt,x=wi();if(pn){if(c===void 0)throw Error(o(407));c=c()}else{if(c=i(),zn===null)throw Error(o(349));(cn&127)!==0||Om(d,i,c)}x.memoizedState=c;var w={value:c,getSnapshot:i};return x.queue=w,Ym(Mm.bind(null,d,w,t),[t]),d.flags|=2048,Ll(9,{destroy:void 0},Dm.bind(null,d,w,c,i),null),c},useId:function(){var t=wi(),i=zn.identifierPrefix;if(pn){var c=Ps,d=Ls;c=(d&~(1<<32-mt(d)-1)).toString(32)+c,i="_"+i+"R_"+c,c=lh++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=lw++,i="_"+i+"r_"+c.toString(32)+"_";return t.memoizedState=i},useHostTransitionStatus:Jd,useFormState:zm,useActionState:zm,useOptimistic:function(t){var i=wi();i.memoizedState=i.baseState=t;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=$d.bind(null,qt,!0,c),c.dispatch=i,[t,i]},useMemoCache:Hd,useCacheRefresh:function(){return wi().memoizedState=gw.bind(null,qt)},useEffectEvent:function(t){var i=wi(),c={impl:t};return i.memoizedState=c,function(){if((vn&2)!==0)throw Error(o(440));return c.impl.apply(void 0,arguments)}}},e0={readContext:Qr,use:uh,useCallback:$m,useContext:Qr,useEffect:Wd,useImperativeHandle:Jm,useInsertionEffect:Km,useLayoutEffect:Qm,useMemo:ep,useReducer:hh,useRef:Xm,useState:function(){return hh(ma)},useDebugValue:Kd,useDeferredValue:function(t,i){var c=Ar();return tp(c,Pn.memoizedState,t,i)},useTransition:function(){var t=hh(ma)[0],i=Ar().memoizedState;return[typeof t=="boolean"?t:Dc(t),i]},useSyncExternalStore:Nm,useId:sp,useHostTransitionStatus:Jd,useFormState:Hm,useActionState:Hm,useOptimistic:function(t,i){var c=Ar();return Pm(c,Pn,t,i)},useMemoCache:Hd,useCacheRefresh:ap};e0.useEffectEvent=Wm;var hp={readContext:Qr,use:uh,useCallback:$m,useContext:Qr,useEffect:Wd,useImperativeHandle:Jm,useInsertionEffect:Km,useLayoutEffect:Qm,useMemo:ep,useReducer:qd,useRef:Xm,useState:function(){return qd(ma)},useDebugValue:Kd,useDeferredValue:function(t,i){var c=Ar();return Pn===null?Qd(c,t,i):tp(c,Pn.memoizedState,t,i)},useTransition:function(){var t=qd(ma)[0],i=Ar().memoizedState;return[typeof t=="boolean"?t:Dc(t),i]},useSyncExternalStore:Nm,useId:sp,useHostTransitionStatus:Jd,useFormState:qm,useActionState:qm,useOptimistic:function(t,i){var c=Ar();return Pn!==null?Pm(c,Pn,t,i):(c.baseState=t,[t,c.queue.dispatch])},useMemoCache:Hd,useCacheRefresh:ap};hp.useEffectEvent=Wm;function t0(t,i,c,d){i=t.memoizedState,c=c(d,i),c=c==null?i:N({},i,c),t.memoizedState=c,t.lanes===0&&(t.updateQueue.baseState=c)}var n0={enqueueSetState:function(t,i,c){t=t._reactInternals;var d=Zi(),x=Wa(d);x.payload=i,c!=null&&(x.callback=c),i=Ka(t,x,d),i!==null&&(Li(i,t,d),Ic(i,t,d))},enqueueReplaceState:function(t,i,c){t=t._reactInternals;var d=Zi(),x=Wa(d);x.tag=1,x.payload=i,c!=null&&(x.callback=c),i=Ka(t,x,d),i!==null&&(Li(i,t,d),Ic(i,t,d))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var c=Zi(),d=Wa(c);d.tag=2,i!=null&&(d.callback=i),i=Ka(t,d,c),i!==null&&(Li(i,t,c),Ic(i,t,c))}};function fp(t,i,c,d,x,w,R){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(d,w,R):i.prototype&&i.prototype.isPureReactComponent?!y(c,d)||!y(x,w):!0}function dp(t,i,c,d){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==t&&n0.enqueueReplaceState(i,i.state,null)}function el(t,i){var c=i;if("ref"in i){c={};for(var d in i)d!=="ref"&&(c[d]=i[d])}if(t=t.defaultProps){c===i&&(c=N({},c));for(var x in t)c[x]===void 0&&(c[x]=t[x])}return c}function gp(t){Xu(t)}function mp(t){console.error(t)}function pp(t){Xu(t)}function mh(t,i){try{var c=t.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function yp(t,i,c){try{var d=t.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function r0(t,i,c){return c=Wa(c),c.tag=3,c.payload={element:null},c.callback=function(){mh(t,i)},c}function Ep(t){return t=Wa(t),t.tag=3,t}function xp(t,i,c,d){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var w=d.value;t.payload=function(){return x(w)},t.callback=function(){yp(i,c,d)}}var R=c.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(t.callback=function(){yp(i,c,d),typeof x!="function"&&(to===null?to=new Set([this]):to.add(this));var B=d.stack;this.componentDidCatch(d.value,{componentStack:B!==null?B:""})})}function pw(t,i,c,d,x){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=c.alternate,i!==null&&Sl(i,c,x,!0),c=Yi.current,c!==null){switch(c.tag){case 31:case 13:return ds===null?Sh():c.alternate===null&&gr===0&&(gr=3),c.flags&=-257,c.flags|=65536,c.lanes=x,d===nh?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([d]):i.add(d),I0(t,d,x)),!1;case 22:return c.flags|=65536,d===nh?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([d]):c.add(d)),I0(t,d,x)),!1}throw Error(o(435,c.tag))}return I0(t,d,x),Sh(),!1}if(pn)return i=Yi.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=x,d!==wd&&(t=Error(o(422),{cause:d}),bc(cs(t,c)))):(d!==wd&&(i=Error(o(423),{cause:d}),bc(cs(i,c))),t=t.current.alternate,t.flags|=65536,x&=-x,t.lanes|=x,d=cs(d,c),x=r0(t.stateNode,d,x),Md(t,x),gr!==4&&(gr=2)),!1;var w=Error(o(520),{cause:d});if(w=cs(w,c),zc===null?zc=[w]:zc.push(w),gr!==4&&(gr=2),i===null)return!0;d=cs(d,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,t=x&-x,c.lanes|=t,t=r0(c.stateNode,d,t),Md(c,t),!1;case 1:if(i=c.type,w=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(to===null||!to.has(w))))return c.flags|=65536,x&=-x,c.lanes|=x,x=Ep(x),xp(x,t,c,d),Md(c,x),!1}c=c.return}while(c!==null);return!1}var i0=Error(o(461)),Sr=!1;function Zr(t,i,c,d){i.child=t===null?bm(i,null,c,d):Jo(i,t.child,c,d)}function _p(t,i,c,d,x){c=c.render;var w=i.ref;if("ref"in d){var R={};for(var B in d)B!=="ref"&&(R[B]=d[B])}else R=d;return Wo(i),d=Ud(t,i,c,R,w,x),B=Fd(),t!==null&&!Sr?(jd(t,i,x),pa(t,i,x)):(pn&&B&&_d(i),i.flags|=1,Zr(t,i,d,x),i.child)}function Ap(t,i,c,d,x){if(t===null){var w=c.type;return typeof w=="function"&&!yd(w)&&w.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=w,wp(t,i,w,d,x)):(t=Qu(c.type,null,d,i,i.mode,x),t.ref=i.ref,t.return=i,i.child=t)}if(w=t.child,!f0(t,x)){var R=w.memoizedProps;if(c=c.compare,c=c!==null?c:y,c(R,d)&&t.ref===i.ref)return pa(t,i,x)}return i.flags|=1,t=ua(w,d),t.ref=i.ref,t.return=i,i.child=t}function wp(t,i,c,d,x){if(t!==null){var w=t.memoizedProps;if(y(w,d)&&t.ref===i.ref)if(Sr=!1,i.pendingProps=d=w,f0(t,x))(t.flags&131072)!==0&&(Sr=!0);else return i.lanes=t.lanes,pa(t,i,x)}return s0(t,i,c,d,x)}function bp(t,i,c,d){var x=d.children,w=t!==null?t.memoizedState:null;if(t===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((i.flags&128)!==0){if(w=w!==null?w.baseLanes|c:c,t!==null){for(d=i.child=t.child,x=0;d!==null;)x=x|d.lanes|d.childLanes,d=d.sibling;d=x&~w}else d=0,i.child=null;return Tp(t,i,w,c,d)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},t!==null&&eh(i,w!==null?w.cachePool:null),w!==null?Cm(i,w):Ld(),Sm(i);else return d=i.lanes=536870912,Tp(t,i,w!==null?w.baseLanes|c:c,c,d)}else w!==null?(eh(i,w.cachePool),Cm(i,w),Za(),i.memoizedState=null):(t!==null&&eh(i,null),Ld(),Za());return Zr(t,i,x,c),i.child}function Lc(t,i){return t!==null&&t.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Tp(t,i,c,d,x){var w=Rd();return w=w===null?null:{parent:vr._currentValue,pool:w},i.memoizedState={baseLanes:c,cachePool:w},t!==null&&eh(i,null),Ld(),Sm(i),t!==null&&Sl(t,i,d,!0),i.childLanes=x,null}function ph(t,i){return i=Eh({mode:i.mode,children:i.children},t.mode),i.ref=t.ref,t.child=i,i.return=t,i}function vp(t,i,c){return Jo(i,t.child,null,c),t=ph(i,i.pendingProps),t.flags|=2,Wi(i),i.memoizedState=null,t}function yw(t,i,c){var d=i.pendingProps,x=(i.flags&128)!==0;if(i.flags&=-129,t===null){if(pn){if(d.mode==="hidden")return t=ph(i,d),i.lanes=536870912,Lc(null,t);if(Bd(i),(t=Qn)?(t=B2(t,fs),t=t!==null&&t.data==="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:Ha!==null?{id:Ls,overflow:Ps}:null,retryLane:536870912,hydrationErrors:null},c=lm(t),c.return=i,i.child=c,Kr=i,Qn=null)):t=null,t===null)throw qa(i);return i.lanes=536870912,null}return ph(i,d)}var w=t.memoizedState;if(w!==null){var R=w.dehydrated;if(Bd(i),x)if(i.flags&256)i.flags&=-257,i=vp(t,i,c);else if(i.memoizedState!==null)i.child=t.child,i.flags|=128,i=null;else throw Error(o(558));else if(Sr||Sl(t,i,c,!1),x=(c&t.childLanes)!==0,Sr||x){if(d=zn,d!==null&&(R=Es(d,c),R!==0&&R!==w.retryLane))throw w.retryLane=R,Go(t,R),Li(d,t,R),i0;Sh(),i=vp(t,i,c)}else t=w.treeContext,Qn=gs(R.nextSibling),Kr=i,pn=!0,Ga=null,fs=!1,t!==null&&hm(i,t),i=ph(i,d),i.flags|=4096;return i}return t=ua(t.child,{mode:d.mode,children:d.children}),t.ref=i.ref,i.child=t,t.return=i,t}function yh(t,i){var c=i.ref;if(c===null)t!==null&&t.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(o(284));(t===null||t.ref!==c)&&(i.flags|=4194816)}}function s0(t,i,c,d,x){return Wo(i),c=Ud(t,i,c,d,void 0,x),d=Fd(),t!==null&&!Sr?(jd(t,i,x),pa(t,i,x)):(pn&&d&&_d(i),i.flags|=1,Zr(t,i,c,x),i.child)}function Cp(t,i,c,d,x,w){return Wo(i),i.updateQueue=null,c=Rm(i,d,c,x),Im(t),d=Fd(),t!==null&&!Sr?(jd(t,i,w),pa(t,i,w)):(pn&&d&&_d(i),i.flags|=1,Zr(t,i,c,w),i.child)}function Sp(t,i,c,d,x){if(Wo(i),i.stateNode===null){var w=bl,R=c.contextType;typeof R=="object"&&R!==null&&(w=Qr(R)),w=new c(d,w),i.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=n0,i.stateNode=w,w._reactInternals=i,w=i.stateNode,w.props=d,w.state=i.memoizedState,w.refs={},Od(i),R=c.contextType,w.context=typeof R=="object"&&R!==null?Qr(R):bl,w.state=i.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(t0(i,c,R,d),w.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(R=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),R!==w.state&&n0.enqueueReplaceState(w,w.state,null),Nc(i,d,w,x),Rc(),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(t===null){w=i.stateNode;var B=i.memoizedProps,W=el(c,B);w.props=W;var fe=w.context,be=c.contextType;R=bl,typeof be=="object"&&be!==null&&(R=Qr(be));var Se=c.getDerivedStateFromProps;be=typeof Se=="function"||typeof w.getSnapshotBeforeUpdate=="function",B=i.pendingProps!==B,be||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(B||fe!==R)&&dp(i,w,d,R),Ya=!1;var ge=i.memoizedState;w.state=ge,Nc(i,d,w,x),Rc(),fe=i.memoizedState,B||ge!==fe||Ya?(typeof Se=="function"&&(t0(i,c,Se,d),fe=i.memoizedState),(W=Ya||fp(i,c,W,d,ge,fe,R))?(be||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(i.flags|=4194308)):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=fe),w.props=d,w.state=fe,w.context=R,d=W):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{w=i.stateNode,Dd(t,i),R=i.memoizedProps,be=el(c,R),w.props=be,Se=i.pendingProps,ge=w.context,fe=c.contextType,W=bl,typeof fe=="object"&&fe!==null&&(W=Qr(fe)),B=c.getDerivedStateFromProps,(fe=typeof B=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(R!==Se||ge!==W)&&dp(i,w,d,W),Ya=!1,ge=i.memoizedState,w.state=ge,Nc(i,d,w,x),Rc();var xe=i.memoizedState;R!==Se||ge!==xe||Ya||t!==null&&t.dependencies!==null&&Ju(t.dependencies)?(typeof B=="function"&&(t0(i,c,B,d),xe=i.memoizedState),(be=Ya||fp(i,c,be,d,ge,xe,W)||t!==null&&t.dependencies!==null&&Ju(t.dependencies))?(fe||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(d,xe,W),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(d,xe,W)),typeof w.componentDidUpdate=="function"&&(i.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof w.componentDidUpdate!="function"||R===t.memoizedProps&&ge===t.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||R===t.memoizedProps&&ge===t.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=xe),w.props=d,w.state=xe,w.context=W,d=be):(typeof w.componentDidUpdate!="function"||R===t.memoizedProps&&ge===t.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||R===t.memoizedProps&&ge===t.memoizedState||(i.flags|=1024),d=!1)}return w=d,yh(t,i),d=(i.flags&128)!==0,w||d?(w=i.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:w.render(),i.flags|=1,t!==null&&d?(i.child=Jo(i,t.child,null,x),i.child=Jo(i,null,c,x)):Zr(t,i,c,x),i.memoizedState=w.state,t=i.child):t=pa(t,i,x),t}function Ip(t,i,c,d){return Xo(),i.flags|=256,Zr(t,i,c,d),i.child}var a0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function o0(t){return{baseLanes:t,cachePool:ym()}}function l0(t,i,c){return t=t!==null?t.childLanes&~c:0,i&&(t|=Qi),t}function Rp(t,i,c){var d=i.pendingProps,x=!1,w=(i.flags&128)!==0,R;if((R=w)||(R=t!==null&&t.memoizedState===null?!1:(_r.current&2)!==0),R&&(x=!0,i.flags&=-129),R=(i.flags&32)!==0,i.flags&=-33,t===null){if(pn){if(x?Qa(i):Za(),(t=Qn)?(t=B2(t,fs),t=t!==null&&t.data!=="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:Ha!==null?{id:Ls,overflow:Ps}:null,retryLane:536870912,hydrationErrors:null},c=lm(t),c.return=i,i.child=c,Kr=i,Qn=null)):t=null,t===null)throw qa(i);return G0(t)?i.lanes=32:i.lanes=536870912,null}var B=d.children;return d=d.fallback,x?(Za(),x=i.mode,B=Eh({mode:"hidden",children:B},x),d=qo(d,x,c,null),B.return=i,d.return=i,B.sibling=d,i.child=B,d=i.child,d.memoizedState=o0(c),d.childLanes=l0(t,R,c),i.memoizedState=a0,Lc(null,d)):(Qa(i),c0(i,B))}var W=t.memoizedState;if(W!==null&&(B=W.dehydrated,B!==null)){if(w)i.flags&256?(Qa(i),i.flags&=-257,i=u0(t,i,c)):i.memoizedState!==null?(Za(),i.child=t.child,i.flags|=128,i=null):(Za(),B=d.fallback,x=i.mode,d=Eh({mode:"visible",children:d.children},x),B=qo(B,x,c,null),B.flags|=2,d.return=i,B.return=i,d.sibling=B,i.child=d,Jo(i,t.child,null,c),d=i.child,d.memoizedState=o0(c),d.childLanes=l0(t,R,c),i.memoizedState=a0,i=Lc(null,d));else if(Qa(i),G0(B)){if(R=B.nextSibling&&B.nextSibling.dataset,R)var fe=R.dgst;R=fe,d=Error(o(419)),d.stack="",d.digest=R,bc({value:d,source:null,stack:null}),i=u0(t,i,c)}else if(Sr||Sl(t,i,c,!1),R=(c&t.childLanes)!==0,Sr||R){if(R=zn,R!==null&&(d=Es(R,c),d!==0&&d!==W.retryLane))throw W.retryLane=d,Go(t,d),Li(R,t,d),i0;H0(B)||Sh(),i=u0(t,i,c)}else H0(B)?(i.flags|=192,i.child=t.child,i=null):(t=W.treeContext,Qn=gs(B.nextSibling),Kr=i,pn=!0,Ga=null,fs=!1,t!==null&&hm(i,t),i=c0(i,d.children),i.flags|=4096);return i}return x?(Za(),B=d.fallback,x=i.mode,W=t.child,fe=W.sibling,d=ua(W,{mode:"hidden",children:d.children}),d.subtreeFlags=W.subtreeFlags&65011712,fe!==null?B=ua(fe,B):(B=qo(B,x,c,null),B.flags|=2),B.return=i,d.return=i,d.sibling=B,i.child=d,Lc(null,d),d=i.child,B=t.child.memoizedState,B===null?B=o0(c):(x=B.cachePool,x!==null?(W=vr._currentValue,x=x.parent!==W?{parent:W,pool:W}:x):x=ym(),B={baseLanes:B.baseLanes|c,cachePool:x}),d.memoizedState=B,d.childLanes=l0(t,R,c),i.memoizedState=a0,Lc(t.child,d)):(Qa(i),c=t.child,t=c.sibling,c=ua(c,{mode:"visible",children:d.children}),c.return=i,c.sibling=null,t!==null&&(R=i.deletions,R===null?(i.deletions=[t],i.flags|=16):R.push(t)),i.child=c,i.memoizedState=null,c)}function c0(t,i){return i=Eh({mode:"visible",children:i},t.mode),i.return=t,t.child=i}function Eh(t,i){return t=Xi(22,t,null,i),t.lanes=0,t}function u0(t,i,c){return Jo(i,t.child,null,c),t=c0(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function Np(t,i,c){t.lanes|=i;var d=t.alternate;d!==null&&(d.lanes|=i),vd(t.return,i,c)}function h0(t,i,c,d,x,w){var R=t.memoizedState;R===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:x,treeForkCount:w}:(R.isBackwards=i,R.rendering=null,R.renderingStartTime=0,R.last=d,R.tail=c,R.tailMode=x,R.treeForkCount=w)}function Op(t,i,c){var d=i.pendingProps,x=d.revealOrder,w=d.tail;d=d.children;var R=_r.current,B=(R&2)!==0;if(B?(R=R&1|2,i.flags|=128):R&=1,De(_r,R),Zr(t,i,d,c),d=pn?wc:0,!B&&t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Np(t,c,i);else if(t.tag===19)Np(t,c,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(x){case"forwards":for(c=i.child,x=null;c!==null;)t=c.alternate,t!==null&&ah(t)===null&&(x=c),c=c.sibling;c=x,c===null?(x=i.child,i.child=null):(x=c.sibling,c.sibling=null),h0(i,!1,x,c,w,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,x=i.child,i.child=null;x!==null;){if(t=x.alternate,t!==null&&ah(t)===null){i.child=x;break}t=x.sibling,x.sibling=c,c=x,x=t}h0(i,!0,c,null,w,d);break;case"together":h0(i,!1,null,null,void 0,d);break;default:i.memoizedState=null}return i.child}function pa(t,i,c){if(t!==null&&(i.dependencies=t.dependencies),eo|=i.lanes,(c&i.childLanes)===0)if(t!==null){if(Sl(t,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(t!==null&&i.child!==t.child)throw Error(o(153));if(i.child!==null){for(t=i.child,c=ua(t,t.pendingProps),i.child=c,c.return=i;t.sibling!==null;)t=t.sibling,c=c.sibling=ua(t,t.pendingProps),c.return=i;c.sibling=null}return i.child}function f0(t,i){return(t.lanes&i)!==0?!0:(t=t.dependencies,!!(t!==null&&Ju(t)))}function Ew(t,i,c){switch(i.tag){case 3:xt(i,i.stateNode.containerInfo),Xa(i,vr,t.memoizedState.cache),Xo();break;case 27:case 5:Mn(i);break;case 4:xt(i,i.stateNode.containerInfo);break;case 10:Xa(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Bd(i),null;break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(Qa(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Rp(t,i,c):(Qa(i),t=pa(t,i,c),t!==null?t.sibling:null);Qa(i);break;case 19:var x=(t.flags&128)!==0;if(d=(c&i.childLanes)!==0,d||(Sl(t,i,c,!1),d=(c&i.childLanes)!==0),x){if(d)return Op(t,i,c);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),De(_r,_r.current),d)break;return null;case 22:return i.lanes=0,bp(t,i,c,i.pendingProps);case 24:Xa(i,vr,t.memoizedState.cache)}return pa(t,i,c)}function Dp(t,i,c){if(t!==null)if(t.memoizedProps!==i.pendingProps)Sr=!0;else{if(!f0(t,c)&&(i.flags&128)===0)return Sr=!1,Ew(t,i,c);Sr=(t.flags&131072)!==0}else Sr=!1,pn&&(i.flags&1048576)!==0&&um(i,wc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var d=i.pendingProps;if(t=Qo(i.elementType),i.type=t,typeof t=="function")yd(t)?(d=el(t,d),i.tag=1,i=Sp(null,i,t,d,c)):(i.tag=0,i=s0(null,i,t,d,c));else{if(t!=null){var x=t.$$typeof;if(x===Pe){i.tag=11,i=_p(null,i,t,d,c);break e}else if(x===F){i.tag=14,i=Ap(null,i,t,d,c);break e}}throw i=rt(t)||t,Error(o(306,i,""))}}return i;case 0:return s0(t,i,i.type,i.pendingProps,c);case 1:return d=i.type,x=el(d,i.pendingProps),Sp(t,i,d,x,c);case 3:e:{if(xt(i,i.stateNode.containerInfo),t===null)throw Error(o(387));d=i.pendingProps;var w=i.memoizedState;x=w.element,Dd(t,i),Nc(i,d,null,c);var R=i.memoizedState;if(d=R.cache,Xa(i,vr,d),d!==w.cache&&Cd(i,[vr],c,!0),Rc(),d=R.element,w.isDehydrated)if(w={element:d,isDehydrated:!1,cache:R.cache},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){i=Ip(t,i,d,c);break e}else if(d!==x){x=cs(Error(o(424)),i),bc(x),i=Ip(t,i,d,c);break e}else{switch(t=i.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Qn=gs(t.firstChild),Kr=i,pn=!0,Ga=null,fs=!0,c=bm(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Xo(),d===x){i=pa(t,i,c);break e}Zr(t,i,d,c)}i=i.child}return i;case 26:return yh(t,i),t===null?(c=H2(i.type,null,i.pendingProps,null))?i.memoizedState=c:pn||(c=i.type,t=i.pendingProps,d=kh(we.current).createElement(c),d[Hn]=i,d[gn]=t,Jr(d,c,t),er(d),i.stateNode=d):i.memoizedState=H2(i.type,t.memoizedProps,i.pendingProps,t.memoizedState),null;case 27:return Mn(i),t===null&&pn&&(d=i.stateNode=F2(i.type,i.pendingProps,we.current),Kr=i,fs=!0,x=Qn,so(i.type)?(q0=x,Qn=gs(d.firstChild)):Qn=x),Zr(t,i,i.pendingProps.children,c),yh(t,i),t===null&&(i.flags|=4194304),i.child;case 5:return t===null&&pn&&((x=d=Qn)&&(d=Ww(d,i.type,i.pendingProps,fs),d!==null?(i.stateNode=d,Kr=i,Qn=gs(d.firstChild),fs=!1,x=!0):x=!1),x||qa(i)),Mn(i),x=i.type,w=i.pendingProps,R=t!==null?t.memoizedProps:null,d=w.children,F0(x,w)?d=null:R!==null&&F0(x,R)&&(i.flags|=32),i.memoizedState!==null&&(x=Ud(t,i,cw,null,null,c),Qc._currentValue=x),yh(t,i),Zr(t,i,d,c),i.child;case 6:return t===null&&pn&&((t=c=Qn)&&(c=Kw(c,i.pendingProps,fs),c!==null?(i.stateNode=c,Kr=i,Qn=null,t=!0):t=!1),t||qa(i)),null;case 13:return Rp(t,i,c);case 4:return xt(i,i.stateNode.containerInfo),d=i.pendingProps,t===null?i.child=Jo(i,null,d,c):Zr(t,i,d,c),i.child;case 11:return _p(t,i,i.type,i.pendingProps,c);case 7:return Zr(t,i,i.pendingProps,c),i.child;case 8:return Zr(t,i,i.pendingProps.children,c),i.child;case 12:return Zr(t,i,i.pendingProps.children,c),i.child;case 10:return d=i.pendingProps,Xa(i,i.type,d.value),Zr(t,i,d.children,c),i.child;case 9:return x=i.type._context,d=i.pendingProps.children,Wo(i),x=Qr(x),d=d(x),i.flags|=1,Zr(t,i,d,c),i.child;case 14:return Ap(t,i,i.type,i.pendingProps,c);case 15:return wp(t,i,i.type,i.pendingProps,c);case 19:return Op(t,i,c);case 31:return yw(t,i,c);case 22:return bp(t,i,c,i.pendingProps);case 24:return Wo(i),d=Qr(vr),t===null?(x=Rd(),x===null&&(x=zn,w=Sd(),x.pooledCache=w,w.refCount++,w!==null&&(x.pooledCacheLanes|=c),x=w),i.memoizedState={parent:d,cache:x},Od(i),Xa(i,vr,x)):((t.lanes&c)!==0&&(Dd(t,i),Nc(i,null,null,c),Rc()),x=t.memoizedState,w=i.memoizedState,x.parent!==d?(x={parent:d,cache:d},i.memoizedState=x,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=x),Xa(i,vr,d)):(d=w.cache,Xa(i,vr,d),d!==x.cache&&Cd(i,[vr],c,!0))),Zr(t,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(o(156,i.tag))}function ya(t){t.flags|=4}function d0(t,i,c,d,x){if((i=(t.mode&32)!==0)&&(i=!1),i){if(t.flags|=16777216,(x&335544128)===x)if(t.stateNode.complete)t.flags|=8192;else if(s2())t.flags|=8192;else throw Zo=nh,Nd}else t.flags&=-16777217}function Mp(t,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!W2(i))if(s2())t.flags|=8192;else throw Zo=nh,Nd}function xh(t,i){i!==null&&(t.flags|=4),t.flags&16384&&(i=t.tag!==22?ar():536870912,t.lanes|=i,Ul|=i)}function Pc(t,i){if(!pn)switch(t.tailMode){case"hidden":i=t.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?t.tail=null:c.sibling=null;break;case"collapsed":c=t.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:d.sibling=null}}function Zn(t){var i=t.alternate!==null&&t.alternate.child===t.child,c=0,d=0;if(i)for(var x=t.child;x!==null;)c|=x.lanes|x.childLanes,d|=x.subtreeFlags&65011712,d|=x.flags&65011712,x.return=t,x=x.sibling;else for(x=t.child;x!==null;)c|=x.lanes|x.childLanes,d|=x.subtreeFlags,d|=x.flags,x.return=t,x=x.sibling;return t.subtreeFlags|=d,t.childLanes=c,i}function xw(t,i,c){var d=i.pendingProps;switch(Ad(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(i),null;case 1:return Zn(i),null;case 3:return c=i.stateNode,d=null,t!==null&&(d=t.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),da(vr),Mt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(t===null||t.child===null)&&(Cl(i)?ya(i):t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,bd())),Zn(i),null;case 26:var x=i.type,w=i.memoizedState;return t===null?(ya(i),w!==null?(Zn(i),Mp(i,w)):(Zn(i),d0(i,x,null,d,c))):w?w!==t.memoizedState?(ya(i),Zn(i),Mp(i,w)):(Zn(i),i.flags&=-16777217):(t=t.memoizedProps,t!==d&&ya(i),Zn(i),d0(i,x,t,d,c)),null;case 27:if(Ie(i),c=we.current,x=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==d&&ya(i);else{if(!d){if(i.stateNode===null)throw Error(o(166));return Zn(i),null}t=Ve.current,Cl(i)?fm(i):(t=F2(x,d,c),i.stateNode=t,ya(i))}return Zn(i),null;case 5:if(Ie(i),x=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==d&&ya(i);else{if(!d){if(i.stateNode===null)throw Error(o(166));return Zn(i),null}if(w=Ve.current,Cl(i))fm(i);else{var R=kh(we.current);switch(w){case 1:w=R.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:w=R.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":w=R.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":w=R.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":w=R.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof d.is=="string"?R.createElement("select",{is:d.is}):R.createElement("select"),d.multiple?w.multiple=!0:d.size&&(w.size=d.size);break;default:w=typeof d.is=="string"?R.createElement(x,{is:d.is}):R.createElement(x)}}w[Hn]=i,w[gn]=d;e:for(R=i.child;R!==null;){if(R.tag===5||R.tag===6)w.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===i)break e;for(;R.sibling===null;){if(R.return===null||R.return===i)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}i.stateNode=w;e:switch(Jr(w,x,d),x){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&ya(i)}}return Zn(i),d0(i,i.type,t===null?null:t.memoizedProps,i.pendingProps,c),null;case 6:if(t&&i.stateNode!=null)t.memoizedProps!==d&&ya(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(o(166));if(t=we.current,Cl(i)){if(t=i.stateNode,c=i.memoizedProps,d=null,x=Kr,x!==null)switch(x.tag){case 27:case 5:d=x.memoizedProps}t[Hn]=i,t=!!(t.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||R2(t.nodeValue,c)),t||qa(i,!0)}else t=kh(t).createTextNode(d),t[Hn]=i,i.stateNode=t}return Zn(i),null;case 31:if(c=i.memoizedState,t===null||t.memoizedState!==null){if(d=Cl(i),c!==null){if(t===null){if(!d)throw Error(o(318));if(t=i.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(557));t[Hn]=i}else Xo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Zn(i),t=!1}else c=bd(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=c),t=!0;if(!t)return i.flags&256?(Wi(i),i):(Wi(i),null);if((i.flags&128)!==0)throw Error(o(558))}return Zn(i),null;case 13:if(d=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(x=Cl(i),d!==null&&d.dehydrated!==null){if(t===null){if(!x)throw Error(o(318));if(x=i.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));x[Hn]=i}else Xo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Zn(i),x=!1}else x=bd(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=x),x=!0;if(!x)return i.flags&256?(Wi(i),i):(Wi(i),null)}return Wi(i),(i.flags&128)!==0?(i.lanes=c,i):(c=d!==null,t=t!==null&&t.memoizedState!==null,c&&(d=i.child,x=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(x=d.alternate.memoizedState.cachePool.pool),w=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(w=d.memoizedState.cachePool.pool),w!==x&&(d.flags|=2048)),c!==t&&c&&(i.child.flags|=8192),xh(i,i.updateQueue),Zn(i),null);case 4:return Mt(),t===null&&L0(i.stateNode.containerInfo),Zn(i),null;case 10:return da(i.type),Zn(i),null;case 19:if(pe(_r),d=i.memoizedState,d===null)return Zn(i),null;if(x=(i.flags&128)!==0,w=d.rendering,w===null)if(x)Pc(d,!1);else{if(gr!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(w=ah(t),w!==null){for(i.flags|=128,Pc(d,!1),t=w.updateQueue,i.updateQueue=t,xh(i,t),i.subtreeFlags=0,t=c,c=i.child;c!==null;)om(c,t),c=c.sibling;return De(_r,_r.current&1|2),pn&&ha(i,d.treeForkCount),i.child}t=t.sibling}d.tail!==null&&Tt()>Th&&(i.flags|=128,x=!0,Pc(d,!1),i.lanes=4194304)}else{if(!x)if(t=ah(w),t!==null){if(i.flags|=128,x=!0,t=t.updateQueue,i.updateQueue=t,xh(i,t),Pc(d,!0),d.tail===null&&d.tailMode==="hidden"&&!w.alternate&&!pn)return Zn(i),null}else 2*Tt()-d.renderingStartTime>Th&&c!==536870912&&(i.flags|=128,x=!0,Pc(d,!1),i.lanes=4194304);d.isBackwards?(w.sibling=i.child,i.child=w):(t=d.last,t!==null?t.sibling=w:i.child=w,d.last=w)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=Tt(),t.sibling=null,c=_r.current,De(_r,x?c&1|2:c&1),pn&&ha(i,d.treeForkCount),t):(Zn(i),null);case 22:case 23:return Wi(i),Pd(),d=i.memoizedState!==null,t!==null?t.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(c&536870912)!==0&&(i.flags&128)===0&&(Zn(i),i.subtreeFlags&6&&(i.flags|=8192)):Zn(i),c=i.updateQueue,c!==null&&xh(i,c.retryQueue),c=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(c=t.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==c&&(i.flags|=2048),t!==null&&pe(Ko),null;case 24:return c=null,t!==null&&(c=t.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),da(vr),Zn(i),null;case 25:return null;case 30:return null}throw Error(o(156,i.tag))}function _w(t,i){switch(Ad(i),i.tag){case 1:return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return da(vr),Mt(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 26:case 27:case 5:return Ie(i),null;case 31:if(i.memoizedState!==null){if(Wi(i),i.alternate===null)throw Error(o(340));Xo()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 13:if(Wi(i),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(o(340));Xo()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return pe(_r),null;case 4:return Mt(),null;case 10:return da(i.type),null;case 22:case 23:return Wi(i),Pd(),t!==null&&pe(Ko),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 24:return da(vr),null;case 25:return null;default:return null}}function kp(t,i){switch(Ad(i),i.tag){case 3:da(vr),Mt();break;case 26:case 27:case 5:Ie(i);break;case 4:Mt();break;case 31:i.memoizedState!==null&&Wi(i);break;case 13:Wi(i);break;case 19:pe(_r);break;case 10:da(i.type);break;case 22:case 23:Wi(i),Pd(),t!==null&&pe(Ko);break;case 24:da(vr)}}function Bc(t,i){try{var c=i.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var x=d.next;c=x;do{if((c.tag&t)===t){d=void 0;var w=c.create,R=c.inst;d=w(),R.destroy=d}c=c.next}while(c!==x)}}catch(B){Dn(i,i.return,B)}}function Ja(t,i,c){try{var d=i.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var w=x.next;d=w;do{if((d.tag&t)===t){var R=d.inst,B=R.destroy;if(B!==void 0){R.destroy=void 0,x=i;var W=c,fe=B;try{fe()}catch(be){Dn(x,W,be)}}}d=d.next}while(d!==w)}}catch(be){Dn(i,i.return,be)}}function Lp(t){var i=t.updateQueue;if(i!==null){var c=t.stateNode;try{vm(i,c)}catch(d){Dn(t,t.return,d)}}}function Pp(t,i,c){c.props=el(t.type,t.memoizedProps),c.state=t.memoizedState;try{c.componentWillUnmount()}catch(d){Dn(t,i,d)}}function Vc(t,i){try{var c=t.ref;if(c!==null){switch(t.tag){case 26:case 27:case 5:var d=t.stateNode;break;case 30:d=t.stateNode;break;default:d=t.stateNode}typeof c=="function"?t.refCleanup=c(d):c.current=d}}catch(x){Dn(t,i,x)}}function Bs(t,i){var c=t.ref,d=t.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(x){Dn(t,i,x)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){Dn(t,i,x)}else c.current=null}function Bp(t){var i=t.type,c=t.memoizedProps,d=t.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(x){Dn(t,t.return,x)}}function g0(t,i,c){try{var d=t.stateNode;zw(d,t.type,c,i),d[gn]=i}catch(x){Dn(t,t.return,x)}}function Vp(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&so(t.type)||t.tag===4}function m0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Vp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&so(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function p0(t,i,c){var d=t.tag;if(d===5||d===6)t=t.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(t,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(t),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=oi));else if(d!==4&&(d===27&&so(t.type)&&(c=t.stateNode,i=null),t=t.child,t!==null))for(p0(t,i,c),t=t.sibling;t!==null;)p0(t,i,c),t=t.sibling}function _h(t,i,c){var d=t.tag;if(d===5||d===6)t=t.stateNode,i?c.insertBefore(t,i):c.appendChild(t);else if(d!==4&&(d===27&&so(t.type)&&(c=t.stateNode),t=t.child,t!==null))for(_h(t,i,c),t=t.sibling;t!==null;)_h(t,i,c),t=t.sibling}function Up(t){var i=t.stateNode,c=t.memoizedProps;try{for(var d=t.type,x=i.attributes;x.length;)i.removeAttributeNode(x[0]);Jr(i,d,c),i[Hn]=t,i[gn]=c}catch(w){Dn(t,t.return,w)}}var Ea=!1,Ir=!1,y0=!1,Fp=typeof WeakSet=="function"?WeakSet:Set,zr=null;function Aw(t,i){if(t=t.containerInfo,V0=jh,t=k(t),L(t)){if("selectionStart"in t)var c={start:t.selectionStart,end:t.selectionEnd};else e:{c=(c=t.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var x=d.anchorOffset,w=d.focusNode;d=d.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var R=0,B=-1,W=-1,fe=0,be=0,Se=t,ge=null;t:for(;;){for(var xe;Se!==c||x!==0&&Se.nodeType!==3||(B=R+x),Se!==w||d!==0&&Se.nodeType!==3||(W=R+d),Se.nodeType===3&&(R+=Se.nodeValue.length),(xe=Se.firstChild)!==null;)ge=Se,Se=xe;for(;;){if(Se===t)break t;if(ge===c&&++fe===x&&(B=R),ge===w&&++be===d&&(W=R),(xe=Se.nextSibling)!==null)break;Se=ge,ge=Se.parentNode}Se=xe}c=B===-1||W===-1?null:{start:B,end:W}}else c=null}c=c||{start:0,end:0}}else c=null;for(U0={focusedElem:t,selectionRange:c},jh=!1,zr=i;zr!==null;)if(i=zr,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,zr=t;else for(;zr!==null;){switch(i=zr,w=i.alternate,t=i.flags,i.tag){case 0:if((t&4)!==0&&(t=i.updateQueue,t=t!==null?t.events:null,t!==null))for(c=0;c<t.length;c++)x=t[c],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&w!==null){t=void 0,c=i,x=w.memoizedProps,w=w.memoizedState,d=c.stateNode;try{var lt=el(c.type,x);t=d.getSnapshotBeforeUpdate(lt,w),d.__reactInternalSnapshotBeforeUpdate=t}catch(Rt){Dn(c,c.return,Rt)}}break;case 3:if((t&1024)!==0){if(t=i.stateNode.containerInfo,c=t.nodeType,c===9)z0(t);else if(c===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":z0(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(o(163))}if(t=i.sibling,t!==null){t.return=i.return,zr=t;break}zr=i.return}}function jp(t,i,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:_a(t,c),d&4&&Bc(5,c);break;case 1:if(_a(t,c),d&4)if(t=c.stateNode,i===null)try{t.componentDidMount()}catch(R){Dn(c,c.return,R)}else{var x=el(c.type,i.memoizedProps);i=i.memoizedState;try{t.componentDidUpdate(x,i,t.__reactInternalSnapshotBeforeUpdate)}catch(R){Dn(c,c.return,R)}}d&64&&Lp(c),d&512&&Vc(c,c.return);break;case 3:if(_a(t,c),d&64&&(t=c.updateQueue,t!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{vm(t,i)}catch(R){Dn(c,c.return,R)}}break;case 27:i===null&&d&4&&Up(c);case 26:case 5:_a(t,c),i===null&&d&4&&Bp(c),d&512&&Vc(c,c.return);break;case 12:_a(t,c);break;case 31:_a(t,c),d&4&&Gp(t,c);break;case 13:_a(t,c),d&4&&qp(t,c),d&64&&(t=c.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(c=Nw.bind(null,c),Qw(t,c))));break;case 22:if(d=c.memoizedState!==null||Ea,!d){i=i!==null&&i.memoizedState!==null||Ir,x=Ea;var w=Ir;Ea=d,(Ir=i)&&!w?Aa(t,c,(c.subtreeFlags&8772)!==0):_a(t,c),Ea=x,Ir=w}break;case 30:break;default:_a(t,c)}}function zp(t){var i=t.alternate;i!==null&&(t.alternate=null,zp(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&Ln(i)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var sr=null,Oi=!1;function xa(t,i,c){for(c=c.child;c!==null;)Hp(t,i,c),c=c.sibling}function Hp(t,i,c){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(et,c)}catch{}switch(c.tag){case 26:Ir||Bs(c,i),xa(t,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ir||Bs(c,i);var d=sr,x=Oi;so(c.type)&&(sr=c.stateNode,Oi=!1),xa(t,i,c),Yc(c.stateNode),sr=d,Oi=x;break;case 5:Ir||Bs(c,i);case 6:if(d=sr,x=Oi,sr=null,xa(t,i,c),sr=d,Oi=x,sr!==null)if(Oi)try{(sr.nodeType===9?sr.body:sr.nodeName==="HTML"?sr.ownerDocument.body:sr).removeChild(c.stateNode)}catch(w){Dn(c,i,w)}else try{sr.removeChild(c.stateNode)}catch(w){Dn(c,i,w)}break;case 18:sr!==null&&(Oi?(t=sr,L2(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,c.stateNode),Yl(t)):L2(sr,c.stateNode));break;case 4:d=sr,x=Oi,sr=c.stateNode.containerInfo,Oi=!0,xa(t,i,c),sr=d,Oi=x;break;case 0:case 11:case 14:case 15:Ja(2,c,i),Ir||Ja(4,c,i),xa(t,i,c);break;case 1:Ir||(Bs(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"&&Pp(c,i,d)),xa(t,i,c);break;case 21:xa(t,i,c);break;case 22:Ir=(d=Ir)||c.memoizedState!==null,xa(t,i,c),Ir=d;break;default:xa(t,i,c)}}function Gp(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Yl(t)}catch(c){Dn(i,i.return,c)}}}function qp(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Yl(t)}catch(c){Dn(i,i.return,c)}}function ww(t){switch(t.tag){case 31:case 13:case 19:var i=t.stateNode;return i===null&&(i=t.stateNode=new Fp),i;case 22:return t=t.stateNode,i=t._retryCache,i===null&&(i=t._retryCache=new Fp),i;default:throw Error(o(435,t.tag))}}function Ah(t,i){var c=ww(t);i.forEach(function(d){if(!c.has(d)){c.add(d);var x=Ow.bind(null,t,d);d.then(x,x)}})}function Di(t,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var x=c[d],w=t,R=i,B=R;e:for(;B!==null;){switch(B.tag){case 27:if(so(B.type)){sr=B.stateNode,Oi=!1;break e}break;case 5:sr=B.stateNode,Oi=!1;break e;case 3:case 4:sr=B.stateNode.containerInfo,Oi=!0;break e}B=B.return}if(sr===null)throw Error(o(160));Hp(w,R,x),sr=null,Oi=!1,w=x.alternate,w!==null&&(w.return=null),x.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Xp(i,t),i=i.sibling}var bs=null;function Xp(t,i){var c=t.alternate,d=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Di(i,t),Mi(t),d&4&&(Ja(3,t,t.return),Bc(3,t),Ja(5,t,t.return));break;case 1:Di(i,t),Mi(t),d&512&&(Ir||c===null||Bs(c,c.return)),d&64&&Ea&&(t=t.updateQueue,t!==null&&(d=t.callbacks,d!==null&&(c=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var x=bs;if(Di(i,t),Mi(t),d&512&&(Ir||c===null||Bs(c,c.return)),d&4){var w=c!==null?c.memoizedState:null;if(d=t.memoizedState,c===null)if(d===null)if(t.stateNode===null){e:{d=t.type,c=t.memoizedProps,x=x.ownerDocument||x;t:switch(d){case"title":w=x.getElementsByTagName("title")[0],(!w||w[Gt]||w[Hn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=x.createElement(d),x.head.insertBefore(w,x.querySelector("head > title"))),Jr(w,d,c),w[Hn]=t,er(w),d=w;break e;case"link":var R=X2("link","href",x).get(d+(c.href||""));if(R){for(var B=0;B<R.length;B++)if(w=R[B],w.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&w.getAttribute("rel")===(c.rel==null?null:c.rel)&&w.getAttribute("title")===(c.title==null?null:c.title)&&w.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){R.splice(B,1);break t}}w=x.createElement(d),Jr(w,d,c),x.head.appendChild(w);break;case"meta":if(R=X2("meta","content",x).get(d+(c.content||""))){for(B=0;B<R.length;B++)if(w=R[B],w.getAttribute("content")===(c.content==null?null:""+c.content)&&w.getAttribute("name")===(c.name==null?null:c.name)&&w.getAttribute("property")===(c.property==null?null:c.property)&&w.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&w.getAttribute("charset")===(c.charSet==null?null:c.charSet)){R.splice(B,1);break t}}w=x.createElement(d),Jr(w,d,c),x.head.appendChild(w);break;default:throw Error(o(468,d))}w[Hn]=t,er(w),d=w}t.stateNode=d}else Y2(x,t.type,t.stateNode);else t.stateNode=q2(x,d,t.memoizedProps);else w!==d?(w===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):w.count--,d===null?Y2(x,t.type,t.stateNode):q2(x,d,t.memoizedProps)):d===null&&t.stateNode!==null&&g0(t,t.memoizedProps,c.memoizedProps)}break;case 27:Di(i,t),Mi(t),d&512&&(Ir||c===null||Bs(c,c.return)),c!==null&&d&4&&g0(t,t.memoizedProps,c.memoizedProps);break;case 5:if(Di(i,t),Mi(t),d&512&&(Ir||c===null||Bs(c,c.return)),t.flags&32){x=t.stateNode;try{ai(x,"")}catch(lt){Dn(t,t.return,lt)}}d&4&&t.stateNode!=null&&(x=t.memoizedProps,g0(t,x,c!==null?c.memoizedProps:x)),d&1024&&(y0=!0);break;case 6:if(Di(i,t),Mi(t),d&4){if(t.stateNode===null)throw Error(o(162));d=t.memoizedProps,c=t.stateNode;try{c.nodeValue=d}catch(lt){Dn(t,t.return,lt)}}break;case 3:if(Bh=null,x=bs,bs=Lh(i.containerInfo),Di(i,t),bs=x,Mi(t),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Yl(i.containerInfo)}catch(lt){Dn(t,t.return,lt)}y0&&(y0=!1,Yp(t));break;case 4:d=bs,bs=Lh(t.stateNode.containerInfo),Di(i,t),Mi(t),bs=d;break;case 12:Di(i,t),Mi(t);break;case 31:Di(i,t),Mi(t),d&4&&(d=t.updateQueue,d!==null&&(t.updateQueue=null,Ah(t,d)));break;case 13:Di(i,t),Mi(t),t.child.flags&8192&&t.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(bh=Tt()),d&4&&(d=t.updateQueue,d!==null&&(t.updateQueue=null,Ah(t,d)));break;case 22:x=t.memoizedState!==null;var W=c!==null&&c.memoizedState!==null,fe=Ea,be=Ir;if(Ea=fe||x,Ir=be||W,Di(i,t),Ir=be,Ea=fe,Mi(t),d&8192)e:for(i=t.stateNode,i._visibility=x?i._visibility&-2:i._visibility|1,x&&(c===null||W||Ea||Ir||tl(t)),c=null,i=t;;){if(i.tag===5||i.tag===26){if(c===null){W=c=i;try{if(w=W.stateNode,x)R=w.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{B=W.stateNode;var Se=W.memoizedProps.style,ge=Se!=null&&Se.hasOwnProperty("display")?Se.display:null;B.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(lt){Dn(W,W.return,lt)}}}else if(i.tag===6){if(c===null){W=i;try{W.stateNode.nodeValue=x?"":W.memoizedProps}catch(lt){Dn(W,W.return,lt)}}}else if(i.tag===18){if(c===null){W=i;try{var xe=W.stateNode;x?P2(xe,!0):P2(W.stateNode,!1)}catch(lt){Dn(W,W.return,lt)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===t)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;i.sibling===null;){if(i.return===null||i.return===t)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=t.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Ah(t,c))));break;case 19:Di(i,t),Mi(t),d&4&&(d=t.updateQueue,d!==null&&(t.updateQueue=null,Ah(t,d)));break;case 30:break;case 21:break;default:Di(i,t),Mi(t)}}function Mi(t){var i=t.flags;if(i&2){try{for(var c,d=t.return;d!==null;){if(Vp(d)){c=d;break}d=d.return}if(c==null)throw Error(o(160));switch(c.tag){case 27:var x=c.stateNode,w=m0(t);_h(t,w,x);break;case 5:var R=c.stateNode;c.flags&32&&(ai(R,""),c.flags&=-33);var B=m0(t);_h(t,B,R);break;case 3:case 4:var W=c.stateNode.containerInfo,fe=m0(t);p0(t,fe,W);break;default:throw Error(o(161))}}catch(be){Dn(t,t.return,be)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function Yp(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var i=t;Yp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),t=t.sibling}}function _a(t,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)jp(t,i.alternate,i),i=i.sibling}function tl(t){for(t=t.child;t!==null;){var i=t;switch(i.tag){case 0:case 11:case 14:case 15:Ja(4,i,i.return),tl(i);break;case 1:Bs(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&Pp(i,i.return,c),tl(i);break;case 27:Yc(i.stateNode);case 26:case 5:Bs(i,i.return),tl(i);break;case 22:i.memoizedState===null&&tl(i);break;case 30:tl(i);break;default:tl(i)}t=t.sibling}}function Aa(t,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,x=t,w=i,R=w.flags;switch(w.tag){case 0:case 11:case 15:Aa(x,w,c),Bc(4,w);break;case 1:if(Aa(x,w,c),d=w,x=d.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(fe){Dn(d,d.return,fe)}if(d=w,x=d.updateQueue,x!==null){var B=d.stateNode;try{var W=x.shared.hiddenCallbacks;if(W!==null)for(x.shared.hiddenCallbacks=null,x=0;x<W.length;x++)Tm(W[x],B)}catch(fe){Dn(d,d.return,fe)}}c&&R&64&&Lp(w),Vc(w,w.return);break;case 27:Up(w);case 26:case 5:Aa(x,w,c),c&&d===null&&R&4&&Bp(w),Vc(w,w.return);break;case 12:Aa(x,w,c);break;case 31:Aa(x,w,c),c&&R&4&&Gp(x,w);break;case 13:Aa(x,w,c),c&&R&4&&qp(x,w);break;case 22:w.memoizedState===null&&Aa(x,w,c),Vc(w,w.return);break;case 30:break;default:Aa(x,w,c)}i=i.sibling}}function E0(t,i){var c=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(c=t.memoizedState.cachePool.pool),t=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(t=i.memoizedState.cachePool.pool),t!==c&&(t!=null&&t.refCount++,c!=null&&Tc(c))}function x0(t,i){t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&Tc(t))}function Ts(t,i,c,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Wp(t,i,c,d),i=i.sibling}function Wp(t,i,c,d){var x=i.flags;switch(i.tag){case 0:case 11:case 15:Ts(t,i,c,d),x&2048&&Bc(9,i);break;case 1:Ts(t,i,c,d);break;case 3:Ts(t,i,c,d),x&2048&&(t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&Tc(t)));break;case 12:if(x&2048){Ts(t,i,c,d),t=i.stateNode;try{var w=i.memoizedProps,R=w.id,B=w.onPostCommit;typeof B=="function"&&B(R,i.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(W){Dn(i,i.return,W)}}else Ts(t,i,c,d);break;case 31:Ts(t,i,c,d);break;case 13:Ts(t,i,c,d);break;case 23:break;case 22:w=i.stateNode,R=i.alternate,i.memoizedState!==null?w._visibility&2?Ts(t,i,c,d):Uc(t,i):w._visibility&2?Ts(t,i,c,d):(w._visibility|=2,Pl(t,i,c,d,(i.subtreeFlags&10256)!==0||!1)),x&2048&&E0(R,i);break;case 24:Ts(t,i,c,d),x&2048&&x0(i.alternate,i);break;default:Ts(t,i,c,d)}}function Pl(t,i,c,d,x){for(x=x&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var w=t,R=i,B=c,W=d,fe=R.flags;switch(R.tag){case 0:case 11:case 15:Pl(w,R,B,W,x),Bc(8,R);break;case 23:break;case 22:var be=R.stateNode;R.memoizedState!==null?be._visibility&2?Pl(w,R,B,W,x):Uc(w,R):(be._visibility|=2,Pl(w,R,B,W,x)),x&&fe&2048&&E0(R.alternate,R);break;case 24:Pl(w,R,B,W,x),x&&fe&2048&&x0(R.alternate,R);break;default:Pl(w,R,B,W,x)}i=i.sibling}}function Uc(t,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=t,d=i,x=d.flags;switch(d.tag){case 22:Uc(c,d),x&2048&&E0(d.alternate,d);break;case 24:Uc(c,d),x&2048&&x0(d.alternate,d);break;default:Uc(c,d)}i=i.sibling}}var Fc=8192;function Bl(t,i,c){if(t.subtreeFlags&Fc)for(t=t.child;t!==null;)Kp(t,i,c),t=t.sibling}function Kp(t,i,c){switch(t.tag){case 26:Bl(t,i,c),t.flags&Fc&&t.memoizedState!==null&&lb(c,bs,t.memoizedState,t.memoizedProps);break;case 5:Bl(t,i,c);break;case 3:case 4:var d=bs;bs=Lh(t.stateNode.containerInfo),Bl(t,i,c),bs=d;break;case 22:t.memoizedState===null&&(d=t.alternate,d!==null&&d.memoizedState!==null?(d=Fc,Fc=16777216,Bl(t,i,c),Fc=d):Bl(t,i,c));break;default:Bl(t,i,c)}}function Qp(t){var i=t.alternate;if(i!==null&&(t=i.child,t!==null)){i.child=null;do i=t.sibling,t.sibling=null,t=i;while(t!==null)}}function jc(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];zr=d,Jp(d,t)}Qp(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Zp(t),t=t.sibling}function Zp(t){switch(t.tag){case 0:case 11:case 15:jc(t),t.flags&2048&&Ja(9,t,t.return);break;case 3:jc(t);break;case 12:jc(t);break;case 22:var i=t.stateNode;t.memoizedState!==null&&i._visibility&2&&(t.return===null||t.return.tag!==13)?(i._visibility&=-3,wh(t)):jc(t);break;default:jc(t)}}function wh(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];zr=d,Jp(d,t)}Qp(t)}for(t=t.child;t!==null;){switch(i=t,i.tag){case 0:case 11:case 15:Ja(8,i,i.return),wh(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,wh(i));break;default:wh(i)}t=t.sibling}}function Jp(t,i){for(;zr!==null;){var c=zr;switch(c.tag){case 0:case 11:case 15:Ja(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Tc(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,zr=d;else e:for(c=t;zr!==null;){d=zr;var x=d.sibling,w=d.return;if(zp(d),d===c){zr=null;break e}if(x!==null){x.return=w,zr=x;break e}zr=w}}}var bw={getCacheForType:function(t){var i=Qr(vr),c=i.data.get(t);return c===void 0&&(c=t(),i.data.set(t,c)),c},cacheSignal:function(){return Qr(vr).controller.signal}},Tw=typeof WeakMap=="function"?WeakMap:Map,vn=0,zn=null,rn=null,cn=0,On=0,Ki=null,$a=!1,Vl=!1,_0=!1,wa=0,gr=0,eo=0,nl=0,A0=0,Qi=0,Ul=0,zc=null,ki=null,w0=!1,bh=0,$p=0,Th=1/0,vh=null,to=null,Br=0,no=null,Fl=null,ba=0,b0=0,T0=null,e2=null,Hc=0,v0=null;function Zi(){return(vn&2)!==0&&cn!==0?cn&-cn:ce.T!==null?O0():Lr()}function t2(){if(Qi===0)if((cn&536870912)===0||pn){var t=Bt;Bt<<=1,(Bt&3932160)===0&&(Bt=262144),Qi=t}else Qi=536870912;return t=Yi.current,t!==null&&(t.flags|=32),Qi}function Li(t,i,c){(t===zn&&(On===2||On===9)||t.cancelPendingCommit!==null)&&(jl(t,0),ro(t,cn,Qi,!1)),vi(t,c),((vn&2)===0||t!==zn)&&(t===zn&&((vn&2)===0&&(nl|=c),gr===4&&ro(t,cn,Qi,!1)),Vs(t))}function n2(t,i,c){if((vn&6)!==0)throw Error(o(327));var d=!c&&(i&127)===0&&(i&t.expiredLanes)===0||Yn(t,i),x=d?Sw(t,i):S0(t,i,!0),w=d;do{if(x===0){Vl&&!d&&ro(t,i,0,!1);break}else{if(c=t.current.alternate,w&&!vw(c)){x=S0(t,i,!1),w=!1;continue}if(x===2){if(w=i,t.errorRecoveryDisabledLanes&w)var R=0;else R=t.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){i=R;e:{var B=t;x=zc;var W=B.current.memoizedState.isDehydrated;if(W&&(jl(B,R).flags|=256),R=S0(B,R,!1),R!==2){if(_0&&!W){B.errorRecoveryDisabledLanes|=w,nl|=w,x=4;break e}w=ki,ki=x,w!==null&&(ki===null?ki=w:ki.push.apply(ki,w))}x=R}if(w=!1,x!==2)continue}}if(x===1){jl(t,0),ro(t,i,0,!0);break}e:{switch(d=t,w=x,w){case 0:case 1:throw Error(o(345));case 4:if((i&4194048)!==i)break;case 6:ro(d,i,Qi,!$a);break e;case 2:ki=null;break;case 3:case 5:break;default:throw Error(o(329))}if((i&62914560)===i&&(x=bh+300-Tt(),10<x)){if(ro(d,i,Qi,!$a),Gr(d,0,!0)!==0)break e;ba=i,d.timeoutHandle=M2(r2.bind(null,d,c,ki,vh,w0,i,Qi,nl,Ul,$a,w,"Throttled",-0,0),x);break e}r2(d,c,ki,vh,w0,i,Qi,nl,Ul,$a,w,null,-0,0)}}break}while(!0);Vs(t)}function r2(t,i,c,d,x,w,R,B,W,fe,be,Se,ge,xe){if(t.timeoutHandle=-1,Se=i.subtreeFlags,Se&8192||(Se&16785408)===16785408){Se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:oi},Kp(i,w,Se);var lt=(w&62914560)===w?bh-Tt():(w&4194048)===w?$p-Tt():0;if(lt=cb(Se,lt),lt!==null){ba=w,t.cancelPendingCommit=lt(h2.bind(null,t,i,w,c,d,x,R,B,W,be,Se,null,ge,xe)),ro(t,w,R,!fe);return}}h2(t,i,w,c,d,x,R,B,W)}function vw(t){for(var i=t;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var x=c[d],w=x.getSnapshot;x=x.value;try{if(!m(w(),x))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ro(t,i,c,d){i&=~A0,i&=~nl,t.suspendedLanes|=i,t.pingedLanes&=~i,d&&(t.warmLanes|=i),d=t.expirationTimes;for(var x=i;0<x;){var w=31-mt(x),R=1<<w;d[w]=-1,x&=~R}c!==0&&ys(t,c,i)}function Ch(){return(vn&6)===0?(Gc(0),!1):!0}function C0(){if(rn!==null){if(On===0)var t=rn.return;else t=rn,fa=Yo=null,zd(t),Ol=null,Cc=0,t=rn;for(;t!==null;)kp(t.alternate,t),t=t.return;rn=null}}function jl(t,i){var c=t.timeoutHandle;c!==-1&&(t.timeoutHandle=-1,qw(c)),c=t.cancelPendingCommit,c!==null&&(t.cancelPendingCommit=null,c()),ba=0,C0(),zn=t,rn=c=ua(t.current,null),cn=i,On=0,Ki=null,$a=!1,Vl=Yn(t,i),_0=!1,Ul=Qi=A0=nl=eo=gr=0,ki=zc=null,w0=!1,(i&8)!==0&&(i|=i&32);var d=t.entangledLanes;if(d!==0)for(t=t.entanglements,d&=i;0<d;){var x=31-mt(d),w=1<<x;i|=t[x],d&=~w}return wa=i,Yu(),c}function i2(t,i){qt=null,ce.H=kc,i===Nl||i===th?(i=_m(),On=3):i===Nd?(i=_m(),On=4):On=i===i0?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Ki=i,rn===null&&(gr=1,mh(t,cs(i,t.current)))}function s2(){var t=Yi.current;return t===null?!0:(cn&4194048)===cn?ds===null:(cn&62914560)===cn||(cn&536870912)!==0?t===ds:!1}function a2(){var t=ce.H;return ce.H=kc,t===null?kc:t}function o2(){var t=ce.A;return ce.A=bw,t}function Sh(){gr=4,$a||(cn&4194048)!==cn&&Yi.current!==null||(Vl=!0),(eo&134217727)===0&&(nl&134217727)===0||zn===null||ro(zn,cn,Qi,!1)}function S0(t,i,c){var d=vn;vn|=2;var x=a2(),w=o2();(zn!==t||cn!==i)&&(vh=null,jl(t,i)),i=!1;var R=gr;e:do try{if(On!==0&&rn!==null){var B=rn,W=Ki;switch(On){case 8:C0(),R=6;break e;case 3:case 2:case 9:case 6:Yi.current===null&&(i=!0);var fe=On;if(On=0,Ki=null,zl(t,B,W,fe),c&&Vl){R=0;break e}break;default:fe=On,On=0,Ki=null,zl(t,B,W,fe)}}Cw(),R=gr;break}catch(be){i2(t,be)}while(!0);return i&&t.shellSuspendCounter++,fa=Yo=null,vn=d,ce.H=x,ce.A=w,rn===null&&(zn=null,cn=0,Yu()),R}function Cw(){for(;rn!==null;)l2(rn)}function Sw(t,i){var c=vn;vn|=2;var d=a2(),x=o2();zn!==t||cn!==i?(vh=null,Th=Tt()+500,jl(t,i)):Vl=Yn(t,i);e:do try{if(On!==0&&rn!==null){i=rn;var w=Ki;t:switch(On){case 1:On=0,Ki=null,zl(t,i,w,1);break;case 2:case 9:if(Em(w)){On=0,Ki=null,c2(i);break}i=function(){On!==2&&On!==9||zn!==t||(On=7),Vs(t)},w.then(i,i);break e;case 3:On=7;break e;case 4:On=5;break e;case 7:Em(w)?(On=0,Ki=null,c2(i)):(On=0,Ki=null,zl(t,i,w,7));break;case 5:var R=null;switch(rn.tag){case 26:R=rn.memoizedState;case 5:case 27:var B=rn;if(R?W2(R):B.stateNode.complete){On=0,Ki=null;var W=B.sibling;if(W!==null)rn=W;else{var fe=B.return;fe!==null?(rn=fe,Ih(fe)):rn=null}break t}}On=0,Ki=null,zl(t,i,w,5);break;case 6:On=0,Ki=null,zl(t,i,w,6);break;case 8:C0(),gr=6;break e;default:throw Error(o(462))}}Iw();break}catch(be){i2(t,be)}while(!0);return fa=Yo=null,ce.H=d,ce.A=x,vn=c,rn!==null?0:(zn=null,cn=0,Yu(),gr)}function Iw(){for(;rn!==null&&!Ur();)l2(rn)}function l2(t){var i=Dp(t.alternate,t,wa);t.memoizedProps=t.pendingProps,i===null?Ih(t):rn=i}function c2(t){var i=t,c=i.alternate;switch(i.tag){case 15:case 0:i=Cp(c,i,i.pendingProps,i.type,void 0,cn);break;case 11:i=Cp(c,i,i.pendingProps,i.type.render,i.ref,cn);break;case 5:zd(i);default:kp(c,i),i=rn=om(i,wa),i=Dp(c,i,wa)}t.memoizedProps=t.pendingProps,i===null?Ih(t):rn=i}function zl(t,i,c,d){fa=Yo=null,zd(i),Ol=null,Cc=0;var x=i.return;try{if(pw(t,x,i,c,cn)){gr=1,mh(t,cs(c,t.current)),rn=null;return}}catch(w){if(x!==null)throw rn=x,w;gr=1,mh(t,cs(c,t.current)),rn=null;return}i.flags&32768?(pn||d===1?t=!0:Vl||(cn&536870912)!==0?t=!1:($a=t=!0,(d===2||d===9||d===3||d===6)&&(d=Yi.current,d!==null&&d.tag===13&&(d.flags|=16384))),u2(i,t)):Ih(i)}function Ih(t){var i=t;do{if((i.flags&32768)!==0){u2(i,$a);return}t=i.return;var c=xw(i.alternate,i,wa);if(c!==null){rn=c;return}if(i=i.sibling,i!==null){rn=i;return}rn=i=t}while(i!==null);gr===0&&(gr=5)}function u2(t,i){do{var c=_w(t.alternate,t);if(c!==null){c.flags&=32767,rn=c;return}if(c=t.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(t=t.sibling,t!==null)){rn=t;return}rn=t=c}while(t!==null);gr=6,rn=null}function h2(t,i,c,d,x,w,R,B,W){t.cancelPendingCommit=null;do Rh();while(Br!==0);if((vn&6)!==0)throw Error(o(327));if(i!==null){if(i===t.current)throw Error(o(177));if(w=i.lanes|i.childLanes,w|=md,ii(t,c,w,R,B,W),t===zn&&(rn=zn=null,cn=0),Fl=i,no=t,ba=c,b0=w,T0=x,e2=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Dw(Je,function(){return p2(),null})):(t.callbackNode=null,t.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=ce.T,ce.T=null,x=ne.p,ne.p=2,R=vn,vn|=4;try{Aw(t,i,c)}finally{vn=R,ne.p=x,ce.T=d}}Br=1,f2(),d2(),g2()}}function f2(){if(Br===1){Br=0;var t=no,i=Fl,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=ce.T,ce.T=null;var d=ne.p;ne.p=2;var x=vn;vn|=4;try{Xp(i,t);var w=U0,R=k(t.containerInfo),B=w.focusedElem,W=w.selectionRange;if(R!==B&&B&&B.ownerDocument&&I(B.ownerDocument.documentElement,B)){if(W!==null&&L(B)){var fe=W.start,be=W.end;if(be===void 0&&(be=fe),"selectionStart"in B)B.selectionStart=fe,B.selectionEnd=Math.min(be,B.value.length);else{var Se=B.ownerDocument||document,ge=Se&&Se.defaultView||window;if(ge.getSelection){var xe=ge.getSelection(),lt=B.textContent.length,Rt=Math.min(W.start,lt),Vn=W.end===void 0?Rt:Math.min(W.end,lt);!xe.extend&&Rt>Vn&&(R=Vn,Vn=Rt,Rt=R);var re=T(B,Rt),$=T(B,Vn);if(re&&$&&(xe.rangeCount!==1||xe.anchorNode!==re.node||xe.anchorOffset!==re.offset||xe.focusNode!==$.node||xe.focusOffset!==$.offset)){var he=Se.createRange();he.setStart(re.node,re.offset),xe.removeAllRanges(),Rt>Vn?(xe.addRange(he),xe.extend($.node,$.offset)):(he.setEnd($.node,$.offset),xe.addRange(he))}}}}for(Se=[],xe=B;xe=xe.parentNode;)xe.nodeType===1&&Se.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Se.length;B++){var ve=Se[B];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}jh=!!V0,U0=V0=null}finally{vn=x,ne.p=d,ce.T=c}}t.current=i,Br=2}}function d2(){if(Br===2){Br=0;var t=no,i=Fl,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=ce.T,ce.T=null;var d=ne.p;ne.p=2;var x=vn;vn|=4;try{jp(t,i.alternate,i)}finally{vn=x,ne.p=d,ce.T=c}}Br=3}}function g2(){if(Br===4||Br===3){Br=0,St();var t=no,i=Fl,c=ba,d=e2;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Br=5:(Br=0,Fl=no=null,m2(t,t.pendingLanes));var x=t.pendingLanes;if(x===0&&(to=null),kr(c),i=i.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(et,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=ce.T,x=ne.p,ne.p=2,ce.T=null;try{for(var w=t.onRecoverableError,R=0;R<d.length;R++){var B=d[R];w(B.value,{componentStack:B.stack})}}finally{ce.T=i,ne.p=x}}(ba&3)!==0&&Rh(),Vs(t),x=t.pendingLanes,(c&261930)!==0&&(x&42)!==0?t===v0?Hc++:(Hc=0,v0=t):Hc=0,Gc(0)}}function m2(t,i){(t.pooledCacheLanes&=i)===0&&(i=t.pooledCache,i!=null&&(t.pooledCache=null,Tc(i)))}function Rh(){return f2(),d2(),g2(),p2()}function p2(){if(Br!==5)return!1;var t=no,i=b0;b0=0;var c=kr(ba),d=ce.T,x=ne.p;try{ne.p=32>c?32:c,ce.T=null,c=T0,T0=null;var w=no,R=ba;if(Br=0,Fl=no=null,ba=0,(vn&6)!==0)throw Error(o(331));var B=vn;if(vn|=4,Zp(w.current),Wp(w,w.current,R,c),vn=B,Gc(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(et,w)}catch{}return!0}finally{ne.p=x,ce.T=d,m2(t,i)}}function y2(t,i,c){i=cs(c,i),i=r0(t.stateNode,i,2),t=Ka(t,i,2),t!==null&&(vi(t,2),Vs(t))}function Dn(t,i,c){if(t.tag===3)y2(t,t,c);else for(;i!==null;){if(i.tag===3){y2(i,t,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(to===null||!to.has(d))){t=cs(c,t),c=Ep(2),d=Ka(i,c,2),d!==null&&(xp(c,d,i,t),vi(d,2),Vs(d));break}}i=i.return}}function I0(t,i,c){var d=t.pingCache;if(d===null){d=t.pingCache=new Tw;var x=new Set;d.set(i,x)}else x=d.get(i),x===void 0&&(x=new Set,d.set(i,x));x.has(c)||(_0=!0,x.add(c),t=Rw.bind(null,t,i,c),i.then(t,t))}function Rw(t,i,c){var d=t.pingCache;d!==null&&d.delete(i),t.pingedLanes|=t.suspendedLanes&c,t.warmLanes&=~c,zn===t&&(cn&c)===c&&(gr===4||gr===3&&(cn&62914560)===cn&&300>Tt()-bh?(vn&2)===0&&jl(t,0):A0|=c,Ul===cn&&(Ul=0)),Vs(t)}function E2(t,i){i===0&&(i=ar()),t=Go(t,i),t!==null&&(vi(t,i),Vs(t))}function Nw(t){var i=t.memoizedState,c=0;i!==null&&(c=i.retryLane),E2(t,c)}function Ow(t,i){var c=0;switch(t.tag){case 31:case 13:var d=t.stateNode,x=t.memoizedState;x!==null&&(c=x.retryLane);break;case 19:d=t.stateNode;break;case 22:d=t.stateNode._retryCache;break;default:throw Error(o(314))}d!==null&&d.delete(i),E2(t,c)}function Dw(t,i){return en(t,i)}var Nh=null,Hl=null,R0=!1,Oh=!1,N0=!1,io=0;function Vs(t){t!==Hl&&t.next===null&&(Hl===null?Nh=Hl=t:Hl=Hl.next=t),Oh=!0,R0||(R0=!0,kw())}function Gc(t,i){if(!N0&&Oh){N0=!0;do for(var c=!1,d=Nh;d!==null;){if(t!==0){var x=d.pendingLanes;if(x===0)var w=0;else{var R=d.suspendedLanes,B=d.pingedLanes;w=(1<<31-mt(42|t)+1)-1,w&=x&~(R&~B),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(c=!0,w2(d,w))}else w=cn,w=Gr(d,d===zn?w:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(w&3)===0||Yn(d,w)||(c=!0,w2(d,w));d=d.next}while(c);N0=!1}}function Mw(){x2()}function x2(){Oh=R0=!1;var t=0;io!==0&&Gw()&&(t=io);for(var i=Tt(),c=null,d=Nh;d!==null;){var x=d.next,w=_2(d,i);w===0?(d.next=null,c===null?Nh=x:c.next=x,x===null&&(Hl=c)):(c=d,(t!==0||(w&3)!==0)&&(Oh=!0)),d=x}Br!==0&&Br!==5||Gc(t),io!==0&&(io=0)}function _2(t,i){for(var c=t.suspendedLanes,d=t.pingedLanes,x=t.expirationTimes,w=t.pendingLanes&-62914561;0<w;){var R=31-mt(w),B=1<<R,W=x[R];W===-1?((B&c)===0||(B&d)!==0)&&(x[R]=Js(B,i)):W<=i&&(t.expiredLanes|=B),w&=~B}if(i=zn,c=cn,c=Gr(t,t===i?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),d=t.callbackNode,c===0||t===i&&(On===2||On===9)||t.cancelPendingCommit!==null)return d!==null&&d!==null&&Xe(d),t.callbackNode=null,t.callbackPriority=0;if((c&3)===0||Yn(t,c)){if(i=c&-c,i===t.callbackPriority)return i;switch(d!==null&&Xe(d),kr(c)){case 2:case 8:c=Ge;break;case 32:c=Je;break;case 268435456:c=kn;break;default:c=Je}return d=A2.bind(null,t),c=en(c,d),t.callbackPriority=i,t.callbackNode=c,i}return d!==null&&d!==null&&Xe(d),t.callbackPriority=2,t.callbackNode=null,2}function A2(t,i){if(Br!==0&&Br!==5)return t.callbackNode=null,t.callbackPriority=0,null;var c=t.callbackNode;if(Rh()&&t.callbackNode!==c)return null;var d=cn;return d=Gr(t,t===zn?d:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),d===0?null:(n2(t,d,i),_2(t,Tt()),t.callbackNode!=null&&t.callbackNode===c?A2.bind(null,t):null)}function w2(t,i){if(Rh())return null;n2(t,i,!0)}function kw(){Xw(function(){(vn&6)!==0?en(Re,Mw):x2()})}function O0(){if(io===0){var t=Il;t===0&&(t=Er,Er<<=1,(Er&261888)===0&&(Er=256)),io=t}return io}function b2(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Os(""+t)}function T2(t,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,t.id&&c.setAttribute("form",t.id),i.parentNode.insertBefore(c,i),t=new FormData(t),c.parentNode.removeChild(c),t}function Lw(t,i,c,d,x){if(i==="submit"&&c&&c.stateNode===x){var w=b2((x[gn]||null).action),R=d.submitter;R&&(i=(i=R[gn]||null)?b2(i.formAction):R.getAttribute("formAction"),i!==null&&(w=i,R=null));var B=new Kn("action","action",null,d,x);t.push({event:B,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(io!==0){var W=R?T2(x,R):new FormData(x);Zd(c,{pending:!0,data:W,method:x.method,action:w},null,W)}}else typeof w=="function"&&(B.preventDefault(),W=R?T2(x,R):new FormData(x),Zd(c,{pending:!0,data:W,method:x.method,action:w},w,W))},currentTarget:x}]})}}for(var D0=0;D0<Ac.length;D0++){var M0=Ac[D0],Pw=M0.toLowerCase(),Bw=M0[0].toUpperCase()+M0.slice(1);ws(Pw,"on"+Bw)}ws(Ni,"onAnimationEnd"),ws(Wr,"onAnimationIteration"),ws(In,"onAnimationStart"),ws("dblclick","onDoubleClick"),ws("focusin","onFocus"),ws("focusout","onBlur"),ws(Pr,"onTransitionRun"),ws(Ai,"onTransitionStart"),ws(za,"onTransitionCancel"),ws(ca,"onTransitionEnd"),qr("onMouseEnter",["mouseout","mouseover"]),qr("onMouseLeave",["mouseout","mouseover"]),qr("onPointerEnter",["pointerout","pointerover"]),qr("onPointerLeave",["pointerout","pointerover"]),_n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_n("onBeforeInput",["compositionend","keypress","textInput","paste"]),_n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qc));function v2(t,i){i=(i&4)!==0;for(var c=0;c<t.length;c++){var d=t[c],x=d.event;d=d.listeners;e:{var w=void 0;if(i)for(var R=d.length-1;0<=R;R--){var B=d[R],W=B.instance,fe=B.currentTarget;if(B=B.listener,W!==w&&x.isPropagationStopped())break e;w=B,x.currentTarget=fe;try{w(x)}catch(be){Xu(be)}x.currentTarget=null,w=W}else for(R=0;R<d.length;R++){if(B=d[R],W=B.instance,fe=B.currentTarget,B=B.listener,W!==w&&x.isPropagationStopped())break e;w=B,x.currentTarget=fe;try{w(x)}catch(be){Xu(be)}x.currentTarget=null,w=W}}}}function sn(t,i){var c=i[je];c===void 0&&(c=i[je]=new Set);var d=t+"__bubble";c.has(d)||(C2(i,t,2,!1),c.add(d))}function k0(t,i,c){var d=0;i&&(d|=4),C2(c,t,d,i)}var Dh="_reactListening"+Math.random().toString(36).slice(2);function L0(t){if(!t[Dh]){t[Dh]=!0,Ne.forEach(function(c){c!=="selectionchange"&&(Vw.has(c)||k0(c,!1,t),k0(c,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Dh]||(i[Dh]=!0,k0("selectionchange",!1,i))}}function C2(t,i,c,d){switch(ty(i)){case 2:var x=fb;break;case 8:x=db;break;default:x=Q0}c=x.bind(null,i,c,t),x=void 0,!ea||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),d?x!==void 0?t.addEventListener(i,c,{capture:!0,passive:x}):t.addEventListener(i,c,!0):x!==void 0?t.addEventListener(i,c,{passive:x}):t.addEventListener(i,c,!1)}function P0(t,i,c,d,x){var w=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var R=d.tag;if(R===3||R===4){var B=d.stateNode.containerInfo;if(B===x)break;if(R===4)for(R=d.return;R!==null;){var W=R.tag;if((W===3||W===4)&&R.stateNode.containerInfo===x)return;R=R.return}for(;B!==null;){if(R=yn(B),R===null)return;if(W=R.tag,W===5||W===6||W===26||W===27){d=w=R;continue e}B=B.parentNode}}d=d.return}Ds(function(){var fe=w,be=Si(c),Se=[];e:{var ge=qu.get(t);if(ge!==void 0){var xe=Kn,lt=t;switch(t){case"keypress":if(zi(c)===0)break e;case"keydown":case"keyup":xe=sa;break;case"focusin":lt="focus",xe=ra;break;case"focusout":lt="blur",xe=ra;break;case"beforeblur":case"afterblur":xe=ra;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=En;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=na;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=C;break;case Ni:case Wr:case In:xe=jt;break;case ca:xe=U;break;case"scroll":case"scrollend":xe=Ba;break;case"wheel":xe=Ee;break;case"copy":case"cut":case"paste":xe=ia;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=nn;break;case"toggle":case"beforetoggle":xe=Pt}var Rt=(i&4)!==0,Vn=!Rt&&(t==="scroll"||t==="scrollend"),re=Rt?ge!==null?ge+"Capture":null:ge;Rt=[];for(var $=fe,he;$!==null;){var ve=$;if(he=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||he===null||re===null||(ve=vt($,re),ve!=null&&Rt.push(Xc($,ve,he))),Vn)break;$=$.return}0<Rt.length&&(ge=new xe(ge,lt,null,c,be),Se.push({event:ge,listeners:Rt}))}}if((i&7)===0){e:{if(ge=t==="mouseover"||t==="pointerover",xe=t==="mouseout"||t==="pointerout",ge&&c!==$s&&(lt=c.relatedTarget||c.fromElement)&&(yn(lt)||lt[ee]))break e;if((xe||ge)&&(ge=be.window===be?be:(ge=be.ownerDocument)?ge.defaultView||ge.parentWindow:window,xe?(lt=c.relatedTarget||c.toElement,xe=fe,lt=lt?yn(lt):null,lt!==null&&(Vn=g(lt),Rt=lt.tag,lt!==Vn||Rt!==5&&Rt!==27&&Rt!==6)&&(lt=null)):(xe=null,lt=fe),xe!==lt)){if(Rt=En,ve="onMouseLeave",re="onMouseEnter",$="mouse",(t==="pointerout"||t==="pointerover")&&(Rt=nn,ve="onPointerLeave",re="onPointerEnter",$="pointer"),Vn=xe==null?ge:hr(xe),he=lt==null?ge:hr(lt),ge=new Rt(ve,$+"leave",xe,c,be),ge.target=Vn,ge.relatedTarget=he,ve=null,yn(be)===fe&&(Rt=new Rt(re,$+"enter",lt,c,be),Rt.target=he,Rt.relatedTarget=Vn,ve=Rt),Vn=ve,xe&&lt)t:{for(Rt=Uw,re=xe,$=lt,he=0,ve=re;ve;ve=Rt(ve))he++;ve=0;for(var At=$;At;At=Rt(At))ve++;for(;0<he-ve;)re=Rt(re),he--;for(;0<ve-he;)$=Rt($),ve--;for(;he--;){if(re===$||$!==null&&re===$.alternate){Rt=re;break t}re=Rt(re),$=Rt($)}Rt=null}else Rt=null;xe!==null&&S2(Se,ge,xe,Rt,!1),lt!==null&&Vn!==null&&S2(Se,Vn,lt,Rt,!0)}}e:{if(ge=fe?hr(fe):window,xe=ge.nodeName&&ge.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ge.type==="file")var bn=qi;else if(_c(ge))if(Gu)bn=u;else{bn=a;var dt=r}else xe=ge.nodeName,!xe||xe.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?fe&&Cn(fe.elementType)&&(bn=qi):bn=l;if(bn&&(bn=bn(t,fe))){Gi(Se,bn,c,be);break e}dt&&dt(t,ge,fe),t==="focusout"&&fe&&ge.type==="number"&&fe.memoizedProps.value!=null&&z(ge,"number",ge.value)}switch(dt=fe?hr(fe):window,t){case"focusin":(_c(dt)||dt.contentEditable==="true")&&(Q=dt,J=fe,se=null);break;case"focusout":se=J=Q=null;break;case"mousedown":ye=!0;break;case"contextmenu":case"mouseup":case"dragend":ye=!1,Ue(Se,c,be);break;case"selectionchange":if(G)break;case"keydown":case"keyup":Ue(Se,c,be)}var Kt;if(mn)e:{switch(t){case"compositionstart":var un="onCompositionStart";break e;case"compositionend":un="onCompositionEnd";break e;case"compositionupdate":un="onCompositionUpdate";break e}un=void 0}else ja?aa(t,c)&&(un="onCompositionEnd"):t==="keydown"&&c.keyCode===229&&(un="onCompositionStart");un&&(as&&c.locale!=="ko"&&(ja||un!=="onCompositionStart"?un==="onCompositionEnd"&&ja&&(Kt=xs()):(Fi=be,ji="value"in Fi?Fi.value:Fi.textContent,ja=!0)),dt=Mh(fe,un),0<dt.length&&(un=new rs(un,t,null,c,be),Se.push({event:un,listeners:dt}),Kt?un.data=Kt:(Kt=os(c),Kt!==null&&(un.data=Kt)))),(Kt=xi?ks(t,c):Al(t,c))&&(un=Mh(fe,"onBeforeInput"),0<un.length&&(dt=new rs("onBeforeInput","beforeinput",null,c,be),Se.push({event:dt,listeners:un}),dt.data=Kt)),Lw(Se,t,fe,c,be)}v2(Se,i)})}function Xc(t,i,c){return{instance:t,listener:i,currentTarget:c}}function Mh(t,i){for(var c=i+"Capture",d=[];t!==null;){var x=t,w=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||w===null||(x=vt(t,c),x!=null&&d.unshift(Xc(t,x,w)),x=vt(t,i),x!=null&&d.push(Xc(t,x,w))),t.tag===3)return d;t=t.return}return[]}function Uw(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function S2(t,i,c,d,x){for(var w=i._reactName,R=[];c!==null&&c!==d;){var B=c,W=B.alternate,fe=B.stateNode;if(B=B.tag,W!==null&&W===d)break;B!==5&&B!==26&&B!==27||fe===null||(W=fe,x?(fe=vt(c,w),fe!=null&&R.unshift(Xc(c,fe,W))):x||(fe=vt(c,w),fe!=null&&R.push(Xc(c,fe,W)))),c=c.return}R.length!==0&&t.push({event:i,listeners:R})}var Fw=/\r\n?/g,jw=/\u0000|\uFFFD/g;function I2(t){return(typeof t=="string"?t:""+t).replace(Fw,`
`).replace(jw,"")}function R2(t,i){return i=I2(i),I2(t)===i}function Bn(t,i,c,d,x,w){switch(c){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||ai(t,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&ai(t,""+d);break;case"className":Xr(t,"class",d);break;case"tabIndex":Xr(t,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Xr(t,c,d);break;case"style":Et(t,d,w);break;case"data":if(i!=="object"){Xr(t,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||c!=="href")){t.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){t.removeAttribute(c);break}d=Os(""+d),t.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){t.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(c==="formAction"?(i!=="input"&&Bn(t,i,"name",x.name,x,null),Bn(t,i,"formEncType",x.formEncType,x,null),Bn(t,i,"formMethod",x.formMethod,x,null),Bn(t,i,"formTarget",x.formTarget,x,null)):(Bn(t,i,"encType",x.encType,x,null),Bn(t,i,"method",x.method,x,null),Bn(t,i,"target",x.target,x,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){t.removeAttribute(c);break}d=Os(""+d),t.setAttribute(c,d);break;case"onClick":d!=null&&(t.onclick=oi);break;case"onScroll":d!=null&&sn("scroll",t);break;case"onScrollEnd":d!=null&&sn("scrollend",t);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(o(61));if(c=d.__html,c!=null){if(x.children!=null)throw Error(o(60));t.innerHTML=c}}break;case"multiple":t.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":t.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){t.removeAttribute("xlink:href");break}c=Os(""+d),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?t.setAttribute(c,""+d):t.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?t.setAttribute(c,""):t.removeAttribute(c);break;case"capture":case"download":d===!0?t.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?t.setAttribute(c,d):t.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?t.setAttribute(c,d):t.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?t.removeAttribute(c):t.setAttribute(c,d);break;case"popover":sn("beforetoggle",t),sn("toggle",t),Rs(t,"popover",d);break;case"xlinkActuate":tr(t,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":tr(t,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":tr(t,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":tr(t,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":tr(t,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":tr(t,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":tr(t,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":tr(t,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":tr(t,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Rs(t,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Vo.get(c)||c,Rs(t,c,d))}}function B0(t,i,c,d,x,w){switch(c){case"style":Et(t,d,w);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(o(61));if(c=d.__html,c!=null){if(x.children!=null)throw Error(o(60));t.innerHTML=c}}break;case"children":typeof d=="string"?ai(t,d):(typeof d=="number"||typeof d=="bigint")&&ai(t,""+d);break;case"onScroll":d!=null&&sn("scroll",t);break;case"onScrollEnd":d!=null&&sn("scrollend",t);break;case"onClick":d!=null&&(t.onclick=oi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lo.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),i=c.slice(2,x?c.length-7:void 0),w=t[gn]||null,w=w!=null?w[c]:null,typeof w=="function"&&t.removeEventListener(i,w,x),typeof d=="function")){typeof w!="function"&&w!==null&&(c in t?t[c]=null:t.hasAttribute(c)&&t.removeAttribute(c)),t.addEventListener(i,d,x);break e}c in t?t[c]=d:d===!0?t.setAttribute(c,""):Rs(t,c,d)}}}function Jr(t,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":sn("error",t),sn("load",t);var d=!1,x=!1,w;for(w in c)if(c.hasOwnProperty(w)){var R=c[w];if(R!=null)switch(w){case"src":d=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:Bn(t,i,w,R,c,null)}}x&&Bn(t,i,"srcSet",c.srcSet,c,null),d&&Bn(t,i,"src",c.src,c,null);return;case"input":sn("invalid",t);var B=w=R=x=null,W=null,fe=null;for(d in c)if(c.hasOwnProperty(d)){var be=c[d];if(be!=null)switch(d){case"name":x=be;break;case"type":R=be;break;case"checked":W=be;break;case"defaultChecked":fe=be;break;case"value":w=be;break;case"defaultValue":B=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(o(137,i));break;default:Bn(t,i,d,be,c,null)}}le(t,w,B,W,fe,R,x,!1);return;case"select":sn("invalid",t),d=R=w=null;for(x in c)if(c.hasOwnProperty(x)&&(B=c[x],B!=null))switch(x){case"value":w=B;break;case"defaultValue":R=B;break;case"multiple":d=B;default:Bn(t,i,x,B,c,null)}i=w,c=R,t.multiple=!!d,i!=null?ot(t,!!d,i,!1):c!=null&&ot(t,!!d,c,!0);return;case"textarea":sn("invalid",t),w=x=d=null;for(R in c)if(c.hasOwnProperty(R)&&(B=c[R],B!=null))switch(R){case"value":d=B;break;case"defaultValue":x=B;break;case"children":w=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(o(91));break;default:Bn(t,i,R,B,c,null)}xr(t,d,x,w);return;case"option":for(W in c)if(c.hasOwnProperty(W)&&(d=c[W],d!=null))switch(W){case"selected":t.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Bn(t,i,W,d,c,null)}return;case"dialog":sn("beforetoggle",t),sn("toggle",t),sn("cancel",t),sn("close",t);break;case"iframe":case"object":sn("load",t);break;case"video":case"audio":for(d=0;d<qc.length;d++)sn(qc[d],t);break;case"image":sn("error",t),sn("load",t);break;case"details":sn("toggle",t);break;case"embed":case"source":case"link":sn("error",t),sn("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in c)if(c.hasOwnProperty(fe)&&(d=c[fe],d!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:Bn(t,i,fe,d,c,null)}return;default:if(Cn(i)){for(be in c)c.hasOwnProperty(be)&&(d=c[be],d!==void 0&&B0(t,i,be,d,c,void 0));return}}for(B in c)c.hasOwnProperty(B)&&(d=c[B],d!=null&&Bn(t,i,B,d,c,null))}function zw(t,i,c,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,w=null,R=null,B=null,W=null,fe=null,be=null;for(xe in c){var Se=c[xe];if(c.hasOwnProperty(xe)&&Se!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":W=Se;default:d.hasOwnProperty(xe)||Bn(t,i,xe,null,d,Se)}}for(var ge in d){var xe=d[ge];if(Se=c[ge],d.hasOwnProperty(ge)&&(xe!=null||Se!=null))switch(ge){case"type":w=xe;break;case"name":x=xe;break;case"checked":fe=xe;break;case"defaultChecked":be=xe;break;case"value":R=xe;break;case"defaultValue":B=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(o(137,i));break;default:xe!==Se&&Bn(t,i,ge,xe,d,Se)}}or(t,R,B,W,fe,be,w,x);return;case"select":xe=R=B=ge=null;for(w in c)if(W=c[w],c.hasOwnProperty(w)&&W!=null)switch(w){case"value":break;case"multiple":xe=W;default:d.hasOwnProperty(w)||Bn(t,i,w,null,d,W)}for(x in d)if(w=d[x],W=c[x],d.hasOwnProperty(x)&&(w!=null||W!=null))switch(x){case"value":ge=w;break;case"defaultValue":B=w;break;case"multiple":R=w;default:w!==W&&Bn(t,i,x,w,d,W)}i=B,c=R,d=xe,ge!=null?ot(t,!!c,ge,!1):!!d!=!!c&&(i!=null?ot(t,!!c,i,!0):ot(t,!!c,c?[]:"",!1));return;case"textarea":xe=ge=null;for(B in c)if(x=c[B],c.hasOwnProperty(B)&&x!=null&&!d.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:Bn(t,i,B,null,d,x)}for(R in d)if(x=d[R],w=c[R],d.hasOwnProperty(R)&&(x!=null||w!=null))switch(R){case"value":ge=x;break;case"defaultValue":xe=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(o(91));break;default:x!==w&&Bn(t,i,R,x,d,w)}lr(t,ge,xe);return;case"option":for(var lt in c)if(ge=c[lt],c.hasOwnProperty(lt)&&ge!=null&&!d.hasOwnProperty(lt))switch(lt){case"selected":t.selected=!1;break;default:Bn(t,i,lt,null,d,ge)}for(W in d)if(ge=d[W],xe=c[W],d.hasOwnProperty(W)&&ge!==xe&&(ge!=null||xe!=null))switch(W){case"selected":t.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Bn(t,i,W,ge,d,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rt in c)ge=c[Rt],c.hasOwnProperty(Rt)&&ge!=null&&!d.hasOwnProperty(Rt)&&Bn(t,i,Rt,null,d,ge);for(fe in d)if(ge=d[fe],xe=c[fe],d.hasOwnProperty(fe)&&ge!==xe&&(ge!=null||xe!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(o(137,i));break;default:Bn(t,i,fe,ge,d,xe)}return;default:if(Cn(i)){for(var Vn in c)ge=c[Vn],c.hasOwnProperty(Vn)&&ge!==void 0&&!d.hasOwnProperty(Vn)&&B0(t,i,Vn,void 0,d,ge);for(be in d)ge=d[be],xe=c[be],!d.hasOwnProperty(be)||ge===xe||ge===void 0&&xe===void 0||B0(t,i,be,ge,d,xe);return}}for(var re in c)ge=c[re],c.hasOwnProperty(re)&&ge!=null&&!d.hasOwnProperty(re)&&Bn(t,i,re,null,d,ge);for(Se in d)ge=d[Se],xe=c[Se],!d.hasOwnProperty(Se)||ge===xe||ge==null&&xe==null||Bn(t,i,Se,ge,d,xe)}function N2(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hw(){if(typeof performance.getEntriesByType=="function"){for(var t=0,i=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var x=c[d],w=x.transferSize,R=x.initiatorType,B=x.duration;if(w&&B&&N2(R)){for(R=0,B=x.responseEnd,d+=1;d<c.length;d++){var W=c[d],fe=W.startTime;if(fe>B)break;var be=W.transferSize,Se=W.initiatorType;be&&N2(Se)&&(W=W.responseEnd,R+=be*(W<B?1:(B-fe)/(W-fe)))}if(--d,i+=8*(w+R)/(x.duration/1e3),t++,10<t)break}}if(0<t)return i/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var V0=null,U0=null;function kh(t){return t.nodeType===9?t:t.ownerDocument}function O2(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function D2(t,i){if(t===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&i==="foreignObject"?0:t}function F0(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var j0=null;function Gw(){var t=window.event;return t&&t.type==="popstate"?t===j0?!1:(j0=t,!0):(j0=null,!1)}var M2=typeof setTimeout=="function"?setTimeout:void 0,qw=typeof clearTimeout=="function"?clearTimeout:void 0,k2=typeof Promise=="function"?Promise:void 0,Xw=typeof queueMicrotask=="function"?queueMicrotask:typeof k2<"u"?function(t){return k2.resolve(null).then(t).catch(Yw)}:M2;function Yw(t){setTimeout(function(){throw t})}function so(t){return t==="head"}function L2(t,i){var c=i,d=0;do{var x=c.nextSibling;if(t.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"||c==="/&"){if(d===0){t.removeChild(x),Yl(i);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Yc(t.ownerDocument.documentElement);else if(c==="head"){c=t.ownerDocument.head,Yc(c);for(var w=c.firstChild;w;){var R=w.nextSibling,B=w.nodeName;w[Gt]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&w.rel.toLowerCase()==="stylesheet"||c.removeChild(w),w=R}}else c==="body"&&Yc(t.ownerDocument.body);c=x}while(c);Yl(i)}function P2(t,i){var c=t;t=0;do{var d=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(t===0)break;t--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||t++;c=d}while(c)}function z0(t){var i=t.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":z0(c),Ln(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}t.removeChild(c)}}function Ww(t,i,c,d){for(;t.nodeType===1;){var x=c;if(t.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(d){if(!t[Gt])switch(i){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(w=t.getAttribute("rel"),w==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(w!==x.rel||t.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||t.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||t.getAttribute("title")!==(x.title==null?null:x.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(w=t.getAttribute("src"),(w!==(x.src==null?null:x.src)||t.getAttribute("type")!==(x.type==null?null:x.type)||t.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&w&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(i==="input"&&t.type==="hidden"){var w=x.name==null?null:""+x.name;if(x.type==="hidden"&&t.getAttribute("name")===w)return t}else return t;if(t=gs(t.nextSibling),t===null)break}return null}function Kw(t,i,c){if(i==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!c||(t=gs(t.nextSibling),t===null))return null;return t}function B2(t,i){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=gs(t.nextSibling),t===null))return null;return t}function H0(t){return t.data==="$?"||t.data==="$~"}function G0(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function Qw(t,i){var c=t.ownerDocument;if(t.data==="$~")t._reactRetry=i;else if(t.data!=="$?"||c.readyState!=="loading")i();else{var d=function(){i(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),t._reactRetry=d}}function gs(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return t}var q0=null;function V2(t){t=t.nextSibling;for(var i=0;t;){if(t.nodeType===8){var c=t.data;if(c==="/$"||c==="/&"){if(i===0)return gs(t.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}t=t.nextSibling}return null}function U2(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var c=t.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return t;i--}else c!=="/$"&&c!=="/&"||i++}t=t.previousSibling}return null}function F2(t,i,c){switch(i=kh(c),t){case"html":if(t=i.documentElement,!t)throw Error(o(452));return t;case"head":if(t=i.head,!t)throw Error(o(453));return t;case"body":if(t=i.body,!t)throw Error(o(454));return t;default:throw Error(o(451))}}function Yc(t){for(var i=t.attributes;i.length;)t.removeAttributeNode(i[0]);Ln(t)}var ms=new Map,j2=new Set;function Lh(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Ta=ne.d;ne.d={f:Zw,r:Jw,D:$w,C:eb,L:tb,m:nb,X:ib,S:rb,M:sb};function Zw(){var t=Ta.f(),i=Ch();return t||i}function Jw(t){var i=Lt(t);i!==null&&i.tag===5&&i.type==="form"?ip(i):Ta.r(t)}var Gl=typeof document>"u"?null:document;function z2(t,i,c){var d=Gl;if(d&&typeof i=="string"&&i){var x=Wt(i);x='link[rel="'+t+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),j2.has(x)||(j2.add(x),t={rel:t,crossOrigin:c,href:i},d.querySelector(x)===null&&(i=d.createElement("link"),Jr(i,"link",t),er(i),d.head.appendChild(i)))}}function $w(t){Ta.D(t),z2("dns-prefetch",t,null)}function eb(t,i){Ta.C(t,i),z2("preconnect",t,i)}function tb(t,i,c){Ta.L(t,i,c);var d=Gl;if(d&&t&&i){var x='link[rel="preload"][as="'+Wt(i)+'"]';i==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+Wt(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+Wt(c.imageSizes)+'"]')):x+='[href="'+Wt(t)+'"]';var w=x;switch(i){case"style":w=ql(t);break;case"script":w=Xl(t)}ms.has(w)||(t=N({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:t,as:i},c),ms.set(w,t),d.querySelector(x)!==null||i==="style"&&d.querySelector(Wc(w))||i==="script"&&d.querySelector(Kc(w))||(i=d.createElement("link"),Jr(i,"link",t),er(i),d.head.appendChild(i)))}}function nb(t,i){Ta.m(t,i);var c=Gl;if(c&&t){var d=i&&typeof i.as=="string"?i.as:"script",x='link[rel="modulepreload"][as="'+Wt(d)+'"][href="'+Wt(t)+'"]',w=x;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Xl(t)}if(!ms.has(w)&&(t=N({rel:"modulepreload",href:t},i),ms.set(w,t),c.querySelector(x)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Kc(w)))return}d=c.createElement("link"),Jr(d,"link",t),er(d),c.head.appendChild(d)}}}function rb(t,i,c){Ta.S(t,i,c);var d=Gl;if(d&&t){var x=Wn(d).hoistableStyles,w=ql(t);i=i||"default";var R=x.get(w);if(!R){var B={loading:0,preload:null};if(R=d.querySelector(Wc(w)))B.loading=5;else{t=N({rel:"stylesheet",href:t,"data-precedence":i},c),(c=ms.get(w))&&X0(t,c);var W=R=d.createElement("link");er(W),Jr(W,"link",t),W._p=new Promise(function(fe,be){W.onload=fe,W.onerror=be}),W.addEventListener("load",function(){B.loading|=1}),W.addEventListener("error",function(){B.loading|=2}),B.loading|=4,Ph(R,i,d)}R={type:"stylesheet",instance:R,count:1,state:B},x.set(w,R)}}}function ib(t,i){Ta.X(t,i);var c=Gl;if(c&&t){var d=Wn(c).hoistableScripts,x=Xl(t),w=d.get(x);w||(w=c.querySelector(Kc(x)),w||(t=N({src:t,async:!0},i),(i=ms.get(x))&&Y0(t,i),w=c.createElement("script"),er(w),Jr(w,"link",t),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},d.set(x,w))}}function sb(t,i){Ta.M(t,i);var c=Gl;if(c&&t){var d=Wn(c).hoistableScripts,x=Xl(t),w=d.get(x);w||(w=c.querySelector(Kc(x)),w||(t=N({src:t,async:!0,type:"module"},i),(i=ms.get(x))&&Y0(t,i),w=c.createElement("script"),er(w),Jr(w,"link",t),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},d.set(x,w))}}function H2(t,i,c,d){var x=(x=we.current)?Lh(x):null;if(!x)throw Error(o(446));switch(t){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=ql(c.href),c=Wn(x).hoistableStyles,d=c.get(i),d||(d={type:"style",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){t=ql(c.href);var w=Wn(x).hoistableStyles,R=w.get(t);if(R||(x=x.ownerDocument||x,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(t,R),(w=x.querySelector(Wc(t)))&&!w._p&&(R.instance=w,R.state.loading=5),ms.has(t)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},ms.set(t,c),w||ab(x,t,c,R.state))),i&&d===null)throw Error(o(528,""));return R}if(i&&d!==null)throw Error(o(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Xl(c),c=Wn(x).hoistableScripts,d=c.get(i),d||(d={type:"script",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,t))}}function ql(t){return'href="'+Wt(t)+'"'}function Wc(t){return'link[rel="stylesheet"]['+t+"]"}function G2(t){return N({},t,{"data-precedence":t.precedence,precedence:null})}function ab(t,i,c,d){t.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=t.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),Jr(i,"link",c),er(i),t.head.appendChild(i))}function Xl(t){return'[src="'+Wt(t)+'"]'}function Kc(t){return"script[async]"+t}function q2(t,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var d=t.querySelector('style[data-href~="'+Wt(c.href)+'"]');if(d)return i.instance=d,er(d),d;var x=N({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(t.ownerDocument||t).createElement("style"),er(d),Jr(d,"style",x),Ph(d,c.precedence,t),i.instance=d;case"stylesheet":x=ql(c.href);var w=t.querySelector(Wc(x));if(w)return i.state.loading|=4,i.instance=w,er(w),w;d=G2(c),(x=ms.get(x))&&X0(d,x),w=(t.ownerDocument||t).createElement("link"),er(w);var R=w;return R._p=new Promise(function(B,W){R.onload=B,R.onerror=W}),Jr(w,"link",d),i.state.loading|=4,Ph(w,c.precedence,t),i.instance=w;case"script":return w=Xl(c.src),(x=t.querySelector(Kc(w)))?(i.instance=x,er(x),x):(d=c,(x=ms.get(w))&&(d=N({},c),Y0(d,x)),t=t.ownerDocument||t,x=t.createElement("script"),er(x),Jr(x,"link",d),t.head.appendChild(x),i.instance=x);case"void":return null;default:throw Error(o(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,Ph(d,c.precedence,t));return i.instance}function Ph(t,i,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=d.length?d[d.length-1]:null,w=x,R=0;R<d.length;R++){var B=d[R];if(B.dataset.precedence===i)w=B;else if(w!==x)break}w?w.parentNode.insertBefore(t,w.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(t,i.firstChild))}function X0(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.title==null&&(t.title=i.title)}function Y0(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.integrity==null&&(t.integrity=i.integrity)}var Bh=null;function X2(t,i,c){if(Bh===null){var d=new Map,x=Bh=new Map;x.set(c,d)}else x=Bh,d=x.get(c),d||(d=new Map,x.set(c,d));if(d.has(t))return d;for(d.set(t,null),c=c.getElementsByTagName(t),x=0;x<c.length;x++){var w=c[x];if(!(w[Gt]||w[Hn]||t==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var R=w.getAttribute(i)||"";R=t+R;var B=d.get(R);B?B.push(w):d.set(R,[w])}}return d}function Y2(t,i,c){t=t.ownerDocument||t,t.head.insertBefore(c,i==="title"?t.querySelector("head > title"):null)}function ob(t,i,c){if(c===1||i.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return t=i.disabled,typeof i.precedence=="string"&&t==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function W2(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function lb(t,i,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var x=ql(d.href),w=i.querySelector(Wc(x));if(w){i=w._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(t.count++,t=Vh.bind(t),i.then(t,t)),c.state.loading|=4,c.instance=w,er(w);return}w=i.ownerDocument||i,d=G2(d),(x=ms.get(x))&&X0(d,x),w=w.createElement("link"),er(w);var R=w;R._p=new Promise(function(B,W){R.onload=B,R.onerror=W}),Jr(w,"link",d),c.instance=w}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(t.count++,c=Vh.bind(t),i.addEventListener("load",c),i.addEventListener("error",c))}}var W0=0;function cb(t,i){return t.stylesheets&&t.count===0&&Fh(t,t.stylesheets),0<t.count||0<t.imgCount?function(c){var d=setTimeout(function(){if(t.stylesheets&&Fh(t,t.stylesheets),t.unsuspend){var w=t.unsuspend;t.unsuspend=null,w()}},6e4+i);0<t.imgBytes&&W0===0&&(W0=62500*Hw());var x=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Fh(t,t.stylesheets),t.unsuspend)){var w=t.unsuspend;t.unsuspend=null,w()}},(t.imgBytes>W0?50:800)+i);return t.unsuspend=c,function(){t.unsuspend=null,clearTimeout(d),clearTimeout(x)}}:null}function Vh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fh(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Uh=null;function Fh(t,i){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Uh=new Map,i.forEach(ub,t),Uh=null,Vh.call(t))}function ub(t,i){if(!(i.state.loading&4)){var c=Uh.get(t);if(c)var d=c.get(null);else{c=new Map,Uh.set(t,c);for(var x=t.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<x.length;w++){var R=x[w];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(c.set(R.dataset.precedence,R),d=R)}d&&c.set(null,d)}x=i.instance,R=x.getAttribute("data-precedence"),w=c.get(R)||d,w===d&&c.set(null,x),c.set(R,x),this.count++,d=Vh.bind(this),x.addEventListener("load",d),x.addEventListener("error",d),w?w.parentNode.insertBefore(x,w.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(x,t.firstChild)),i.state.loading|=4}}var Qc={$$typeof:de,Provider:null,Consumer:null,_currentValue:ze,_currentValue2:ze,_threadCount:0};function hb(t,i,c,d,x,w,R,B,W){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mr(0),this.hiddenUpdates=Mr(null),this.identifierPrefix=d,this.onUncaughtError=x,this.onCaughtError=w,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function K2(t,i,c,d,x,w,R,B,W,fe,be,Se){return t=new hb(t,i,c,R,W,fe,be,Se,B),i=1,w===!0&&(i|=24),w=Xi(3,null,null,i),t.current=w,w.stateNode=t,i=Sd(),i.refCount++,t.pooledCache=i,i.refCount++,w.memoizedState={element:d,isDehydrated:c,cache:i},Od(w),t}function Q2(t){return t?(t=bl,t):bl}function Z2(t,i,c,d,x,w){x=Q2(x),d.context===null?d.context=x:d.pendingContext=x,d=Wa(i),d.payload={element:c},w=w===void 0?null:w,w!==null&&(d.callback=w),c=Ka(t,d,i),c!==null&&(Li(c,t,i),Ic(c,t,i))}function J2(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var c=t.retryLane;t.retryLane=c!==0&&c<i?c:i}}function K0(t,i){J2(t,i),(t=t.alternate)&&J2(t,i)}function $2(t){if(t.tag===13||t.tag===31){var i=Go(t,67108864);i!==null&&Li(i,t,67108864),K0(t,67108864)}}function ey(t){if(t.tag===13||t.tag===31){var i=Zi();i=$n(i);var c=Go(t,i);c!==null&&Li(c,t,i),K0(t,i)}}var jh=!0;function fb(t,i,c,d){var x=ce.T;ce.T=null;var w=ne.p;try{ne.p=2,Q0(t,i,c,d)}finally{ne.p=w,ce.T=x}}function db(t,i,c,d){var x=ce.T;ce.T=null;var w=ne.p;try{ne.p=8,Q0(t,i,c,d)}finally{ne.p=w,ce.T=x}}function Q0(t,i,c,d){if(jh){var x=Z0(d);if(x===null)P0(t,i,d,zh,c),ny(t,d);else if(mb(x,t,i,c,d))d.stopPropagation();else if(ny(t,d),i&4&&-1<gb.indexOf(t)){for(;x!==null;){var w=Lt(x);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var R=mi(w.pendingLanes);if(R!==0){var B=w;for(B.pendingLanes|=2,B.entangledLanes|=2;R;){var W=1<<31-mt(R);B.entanglements[1]|=W,R&=~W}Vs(w),(vn&6)===0&&(Th=Tt()+500,Gc(0))}}break;case 31:case 13:B=Go(w,2),B!==null&&Li(B,w,2),Ch(),K0(w,2)}if(w=Z0(d),w===null&&P0(t,i,d,zh,c),w===x)break;x=w}x!==null&&d.stopPropagation()}else P0(t,i,d,null,c)}}function Z0(t){return t=Si(t),J0(t)}var zh=null;function J0(t){if(zh=null,t=yn(t),t!==null){var i=g(t);if(i===null)t=null;else{var c=i.tag;if(c===13){if(t=E(i),t!==null)return t;t=null}else if(c===31){if(t=v(i),t!==null)return t;t=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null)}}return zh=t,null}function ty(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ae()){case Re:return 2;case Ge:return 8;case Je:case nt:return 32;case kn:return 268435456;default:return 32}default:return 32}}var $0=!1,ao=null,oo=null,lo=null,Zc=new Map,Jc=new Map,co=[],gb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ny(t,i){switch(t){case"focusin":case"focusout":ao=null;break;case"dragenter":case"dragleave":oo=null;break;case"mouseover":case"mouseout":lo=null;break;case"pointerover":case"pointerout":Zc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jc.delete(i.pointerId)}}function $c(t,i,c,d,x,w){return t===null||t.nativeEvent!==w?(t={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:w,targetContainers:[x]},i!==null&&(i=Lt(i),i!==null&&$2(i)),t):(t.eventSystemFlags|=d,i=t.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),t)}function mb(t,i,c,d,x){switch(i){case"focusin":return ao=$c(ao,t,i,c,d,x),!0;case"dragenter":return oo=$c(oo,t,i,c,d,x),!0;case"mouseover":return lo=$c(lo,t,i,c,d,x),!0;case"pointerover":var w=x.pointerId;return Zc.set(w,$c(Zc.get(w)||null,t,i,c,d,x)),!0;case"gotpointercapture":return w=x.pointerId,Jc.set(w,$c(Jc.get(w)||null,t,i,c,d,x)),!0}return!1}function ry(t){var i=yn(t.target);if(i!==null){var c=g(i);if(c!==null){if(i=c.tag,i===13){if(i=E(c),i!==null){t.blockedOn=i,We(t.priority,function(){ey(c)});return}}else if(i===31){if(i=v(c),i!==null){t.blockedOn=i,We(t.priority,function(){ey(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){t.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hh(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var c=Z0(t.nativeEvent);if(c===null){c=t.nativeEvent;var d=new c.constructor(c.type,c);$s=d,c.target.dispatchEvent(d),$s=null}else return i=Lt(c),i!==null&&$2(i),t.blockedOn=c,!1;i.shift()}return!0}function iy(t,i,c){Hh(t)&&c.delete(i)}function pb(){$0=!1,ao!==null&&Hh(ao)&&(ao=null),oo!==null&&Hh(oo)&&(oo=null),lo!==null&&Hh(lo)&&(lo=null),Zc.forEach(iy),Jc.forEach(iy)}function Gh(t,i){t.blockedOn===i&&(t.blockedOn=null,$0||($0=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,pb)))}var qh=null;function sy(t){qh!==t&&(qh=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){qh===t&&(qh=null);for(var i=0;i<t.length;i+=3){var c=t[i],d=t[i+1],x=t[i+2];if(typeof d!="function"){if(J0(d||c)===null)continue;break}var w=Lt(c);w!==null&&(t.splice(i,3),i-=3,Zd(w,{pending:!0,data:x,method:c.method,action:d},d,x))}}))}function Yl(t){function i(W){return Gh(W,t)}ao!==null&&Gh(ao,t),oo!==null&&Gh(oo,t),lo!==null&&Gh(lo,t),Zc.forEach(i),Jc.forEach(i);for(var c=0;c<co.length;c++){var d=co[c];d.blockedOn===t&&(d.blockedOn=null)}for(;0<co.length&&(c=co[0],c.blockedOn===null);)ry(c),c.blockedOn===null&&co.shift();if(c=(t.ownerDocument||t).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var x=c[d],w=c[d+1],R=x[gn]||null;if(typeof w=="function")R||sy(c);else if(R){var B=null;if(w&&w.hasAttribute("formAction")){if(x=w,R=w[gn]||null)B=R.formAction;else if(J0(x)!==null)continue}else B=R.action;typeof B=="function"?c[d+1]=B:(c.splice(d,3),d-=3),sy(c)}}}function ay(){function t(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(R){return x=R})},focusReset:"manual",scroll:"manual"})}function i(){x!==null&&(x(),x=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,x=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),x!==null&&(x(),x=null)}}}function e1(t){this._internalRoot=t}Xh.prototype.render=e1.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(o(409));var c=i.current,d=Zi();Z2(c,d,t,i,null,null)},Xh.prototype.unmount=e1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;Z2(t.current,2,null,t,null,null),Ch(),i[ee]=null}};function Xh(t){this._internalRoot=t}Xh.prototype.unstable_scheduleHydration=function(t){if(t){var i=Lr();t={blockedOn:null,target:t,priority:i};for(var c=0;c<co.length&&i!==0&&i<co[c].priority;c++);co.splice(c,0,t),c===0&&ry(t)}};var oy=e.version;if(oy!=="19.2.0")throw Error(o(527,oy,"19.2.0"));ne.findDOMNode=function(t){var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(o(188)):(t=Object.keys(t).join(","),Error(o(268,t)));return t=_(i),t=t!==null?S(t):null,t=t===null?null:t.stateNode,t};var yb={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ce,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yh.isDisabled&&Yh.supportsFiber)try{et=Yh.inject(yb),Te=Yh}catch{}}return tu.createRoot=function(t,i){if(!h(t))throw Error(o(299));var c=!1,d="",x=gp,w=mp,R=pp;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(x=i.onUncaughtError),i.onCaughtError!==void 0&&(w=i.onCaughtError),i.onRecoverableError!==void 0&&(R=i.onRecoverableError)),i=K2(t,1,!1,null,null,c,d,null,x,w,R,ay),t[ee]=i.current,L0(t),new e1(i)},tu.hydrateRoot=function(t,i,c){if(!h(t))throw Error(o(299));var d=!1,x="",w=gp,R=mp,B=pp,W=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.formState!==void 0&&(W=c.formState)),i=K2(t,1,!0,i,c??null,d,x,W,w,R,B,ay),i.context=Q2(null),c=i.current,d=Zi(),d=$n(d),x=Wa(d),x.callback=null,Ka(c,x,d),c=d,i.current.lanes=c,vi(i,c),Vs(i),t[ee]=i.current,L0(t),new Xh(i)},tu.version="19.2.0",tu}var yy;function Ib(){if(yy)return r1.exports;yy=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),r1.exports=Sb(),r1.exports}var Rb=Ib();const Nb=tg(Rb),bo=()=>D.jsxs("div",{style:{padding:"1.5rem 0",display:"flex",justifyContent:"center",alignItems:"center"},children:[D.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",border:"3px solid #e5e7eb",borderTopColor:"#2EC483",animation:"spin 1s linear infinite"}}),D.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]}),Ob=()=>{};var Ey={};const dx=function(s){const e=[];let n=0;for(let o=0;o<s.length;o++){let h=s.charCodeAt(o);h<128?e[n++]=h:h<2048?(e[n++]=h>>6|192,e[n++]=h&63|128):(h&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(h=65536+((h&1023)<<10)+(s.charCodeAt(++o)&1023),e[n++]=h>>18|240,e[n++]=h>>12&63|128,e[n++]=h>>6&63|128,e[n++]=h&63|128):(e[n++]=h>>12|224,e[n++]=h>>6&63|128,e[n++]=h&63|128)}return e},Db=function(s){const e=[];let n=0,o=0;for(;n<s.length;){const h=s[n++];if(h<128)e[o++]=String.fromCharCode(h);else if(h>191&&h<224){const g=s[n++];e[o++]=String.fromCharCode((h&31)<<6|g&63)}else if(h>239&&h<365){const g=s[n++],E=s[n++],v=s[n++],b=((h&7)<<18|(g&63)<<12|(E&63)<<6|v&63)-65536;e[o++]=String.fromCharCode(55296+(b>>10)),e[o++]=String.fromCharCode(56320+(b&1023))}else{const g=s[n++],E=s[n++];e[o++]=String.fromCharCode((h&15)<<12|(g&63)<<6|E&63)}}return e.join("")},gx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let h=0;h<s.length;h+=3){const g=s[h],E=h+1<s.length,v=E?s[h+1]:0,b=h+2<s.length,_=b?s[h+2]:0,S=g>>2,N=(g&3)<<4|v>>4;let P=(v&15)<<2|_>>6,X=_&63;b||(X=64,E||(P=64)),o.push(n[S],n[N],n[P],n[X])}return o.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(dx(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Db(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let h=0;h<s.length;){const g=n[s.charAt(h++)],v=h<s.length?n[s.charAt(h)]:0;++h;const _=h<s.length?n[s.charAt(h)]:64;++h;const N=h<s.length?n[s.charAt(h)]:64;if(++h,g==null||v==null||_==null||N==null)throw new Mb;const P=g<<2|v>>4;if(o.push(P),_!==64){const X=v<<4&240|_>>2;if(o.push(X),N!==64){const te=_<<6&192|N;o.push(te)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Mb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kb=function(s){const e=dx(s);return gx.encodeByteArray(e,!0)},pf=function(s){return kb(s).replace(/\./g,"")},mx=function(s){try{return gx.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Lb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Pb=()=>Lb().__FIREBASE_DEFAULTS__,Bb=()=>{if(typeof process>"u"||typeof Ey>"u")return;const s=Ey.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Vb=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&mx(s[1]);return e&&JSON.parse(e)},zf=()=>{try{return Ob()||Pb()||Bb()||Vb()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},px=s=>zf()?.emulatorHosts?.[s],yx=s=>{const e=px(s);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),o]:[e.substring(0,n),o]},Ex=()=>zf()?.config,xx=s=>zf()?.[`_${s}`];class Ub{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,o)=>{n?this.reject(n):this.resolve(o),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,o))}}}function Oo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function rg(s){return(await fetch(s,{credentials:"include"})).ok}function Fb(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},o=e||"demo-project",h=s.iat||0,g=s.sub||s.user_id;if(!g)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const E={iss:`https://securetoken.google.com/${o}`,aud:o,iat:h,exp:h+3600,auth_time:h,sub:g,user_id:g,firebase:{sign_in_provider:"custom",identities:{}},...s};return[pf(JSON.stringify(n)),pf(JSON.stringify(E)),""].join(".")}const hu={};function jb(){const s={prod:[],emulator:[]};for(const e of Object.keys(hu))hu[e]?s.emulator.push(e):s.prod.push(e);return s}function zb(s){let e=document.getElementById(s),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),n=!0),{created:n,element:e}}let xy=!1;function ig(s,e){if(typeof window>"u"||typeof document>"u"||!Oo(window.location.host)||hu[s]===e||hu[s]||xy)return;hu[s]=e;function n(P){return`__firebase__banner__${P}`}const o="__firebase__banner",g=jb().prod.length>0;function E(){const P=document.getElementById(o);P&&P.remove()}function v(P){P.style.display="flex",P.style.background="#7faaf0",P.style.position="fixed",P.style.bottom="5px",P.style.left="5px",P.style.padding=".5em",P.style.borderRadius="5px",P.style.alignItems="center"}function b(P,X){P.setAttribute("width","24"),P.setAttribute("id",X),P.setAttribute("height","24"),P.setAttribute("viewBox","0 0 24 24"),P.setAttribute("fill","none"),P.style.marginLeft="-6px"}function _(){const P=document.createElement("span");return P.style.cursor="pointer",P.style.marginLeft="16px",P.style.fontSize="24px",P.innerHTML=" &times;",P.onclick=()=>{xy=!0,E()},P}function S(P,X){P.setAttribute("id",X),P.innerText="Learn more",P.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",P.setAttribute("target","__blank"),P.style.paddingLeft="5px",P.style.textDecoration="underline"}function N(){const P=zb(o),X=n("text"),te=document.getElementById(X)||document.createElement("span"),oe=n("learnmore"),ue=document.getElementById(oe)||document.createElement("a"),Ye=n("preprendIcon"),ke=document.getElementById(Ye)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(P.created){const de=P.element;v(de),S(ue,oe);const Pe=_();b(ke,Ye),de.append(ke,te,ue,Pe),document.body.appendChild(de)}g?(te.innerText="Preview backend disconnected.",ke.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ke.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,te.innerText="Preview backend running in this workspace."),te.setAttribute("id",X)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}function gi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Hb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gi())}function Gb(){const s=zf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Xb(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Yb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Wb(){const s=gi();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function Kb(){return!Gb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Qb(){try{return typeof indexedDB=="object"}catch{return!1}}function Zb(){return new Promise((s,e)=>{try{let n=!0;const o="validate-browser-context-for-indexeddb-analytics-module",h=self.indexedDB.open(o);h.onsuccess=()=>{h.result.close(),n||self.indexedDB.deleteDatabase(o),s(!0)},h.onupgradeneeded=()=>{n=!1},h.onerror=()=>{e(h.error?.message||"")}}catch(n){e(n)}})}const Jb="FirebaseError";class Qs extends Error{constructor(e,n,o){super(n),this.code=e,this.customData=o,this.name=Jb,Object.setPrototypeOf(this,Qs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Iu.prototype.create)}}class Iu{constructor(e,n,o){this.service=e,this.serviceName=n,this.errors=o}create(e,...n){const o=n[0]||{},h=`${this.service}/${e}`,g=this.errors[e],E=g?$b(g,o):"Error",v=`${this.serviceName}: ${E} (${h}).`;return new Qs(h,v,o)}}function $b(s,e){return s.replace(eT,(n,o)=>{const h=e[o];return h!=null?String(h):`<${o}?>`})}const eT=/\{\$([^}]+)}/g;function tT(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ll(s,e){if(s===e)return!0;const n=Object.keys(s),o=Object.keys(e);for(const h of n){if(!o.includes(h))return!1;const g=s[h],E=e[h];if(_y(g)&&_y(E)){if(!ll(g,E))return!1}else if(g!==E)return!1}for(const h of o)if(!n.includes(h))return!1;return!0}function _y(s){return s!==null&&typeof s=="object"}function Ru(s){const e=[];for(const[n,o]of Object.entries(s))Array.isArray(o)?o.forEach(h=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(h))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function iu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(o=>{if(o){const[h,g]=o.split("=");e[decodeURIComponent(h)]=decodeURIComponent(g)}}),e}function su(s){const e=s.indexOf("?");if(!e)return"";const n=s.indexOf("#",e);return s.substring(e,n>0?n:void 0)}function nT(s,e){const n=new rT(s,e);return n.subscribe.bind(n)}class rT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(o=>{this.error(o)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,o){let h;if(e===void 0&&n===void 0&&o===void 0)throw new Error("Missing Observer.");iT(e,["next","error","complete"])?h=e:h={next:e,error:n,complete:o},h.next===void 0&&(h.next=o1),h.error===void 0&&(h.error=o1),h.complete===void 0&&(h.complete=o1);const g=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?h.error(this.finalError):h.complete()}catch{}}),this.observers.push(h),g}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function iT(s,e){if(typeof s!="object"||s===null)return!1;for(const n of e)if(n in s&&typeof s[n]=="function")return!0;return!1}function o1(){}function qn(s){return s&&s._delegate?s._delegate:s}class To{constructor(e,n,o){this.name=e,this.instanceFactory=n,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const rl="[DEFAULT]";class sT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const o=new Ub;if(this.instancesDeferred.set(n,o),this.isInitialized(n)||this.shouldAutoInitialize())try{const h=this.getOrInitializeService({instanceIdentifier:n});h&&o.resolve(h)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),o=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(h){if(o)return null;throw h}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(oT(e))try{this.getOrInitializeService({instanceIdentifier:rl})}catch{}for(const[n,o]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(n);try{const g=this.getOrInitializeService({instanceIdentifier:h});o.resolve(g)}catch{}}}}clearInstance(e=rl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rl){return this.instances.has(e)}getOptions(e=rl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const h=this.getOrInitializeService({instanceIdentifier:o,options:n});for(const[g,E]of this.instancesDeferred.entries()){const v=this.normalizeInstanceIdentifier(g);o===v&&E.resolve(h)}return h}onInit(e,n){const o=this.normalizeInstanceIdentifier(n),h=this.onInitCallbacks.get(o)??new Set;h.add(e),this.onInitCallbacks.set(o,h);const g=this.instances.get(o);return g&&e(g,o),()=>{h.delete(e)}}invokeOnInitCallbacks(e,n){const o=this.onInitCallbacks.get(n);if(o)for(const h of o)try{h(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let o=this.instances.get(e);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:aT(e),options:n}),this.instances.set(e,o),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(o,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,o)}catch{}return o||null}normalizeInstanceIdentifier(e=rl){return this.component?this.component.multipleInstances?e:rl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aT(s){return s===rl?void 0:s}function oT(s){return s.instantiationMode==="EAGER"}class lT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new sT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var hn;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(hn||(hn={}));const cT={debug:hn.DEBUG,verbose:hn.VERBOSE,info:hn.INFO,warn:hn.WARN,error:hn.ERROR,silent:hn.SILENT},uT=hn.INFO,hT={[hn.DEBUG]:"log",[hn.VERBOSE]:"log",[hn.INFO]:"info",[hn.WARN]:"warn",[hn.ERROR]:"error"},fT=(s,e,...n)=>{if(e<s.logLevel)return;const o=new Date().toISOString(),h=hT[e];if(h)console[h](`[${o}]  ${s.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class sg{constructor(e){this.name=e,this._logLevel=uT,this._logHandler=fT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in hn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,hn.DEBUG,...e),this._logHandler(this,hn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,hn.VERBOSE,...e),this._logHandler(this,hn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,hn.INFO,...e),this._logHandler(this,hn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,hn.WARN,...e),this._logHandler(this,hn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,hn.ERROR,...e),this._logHandler(this,hn.ERROR,...e)}}const dT=(s,e)=>e.some(n=>s instanceof n);let Ay,wy;function gT(){return Ay||(Ay=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mT(){return wy||(wy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _x=new WeakMap,C1=new WeakMap,Ax=new WeakMap,l1=new WeakMap,ag=new WeakMap;function pT(s){const e=new Promise((n,o)=>{const h=()=>{s.removeEventListener("success",g),s.removeEventListener("error",E)},g=()=>{n(xo(s.result)),h()},E=()=>{o(s.error),h()};s.addEventListener("success",g),s.addEventListener("error",E)});return e.then(n=>{n instanceof IDBCursor&&_x.set(n,s)}).catch(()=>{}),ag.set(e,s),e}function yT(s){if(C1.has(s))return;const e=new Promise((n,o)=>{const h=()=>{s.removeEventListener("complete",g),s.removeEventListener("error",E),s.removeEventListener("abort",E)},g=()=>{n(),h()},E=()=>{o(s.error||new DOMException("AbortError","AbortError")),h()};s.addEventListener("complete",g),s.addEventListener("error",E),s.addEventListener("abort",E)});C1.set(s,e)}let S1={get(s,e,n){if(s instanceof IDBTransaction){if(e==="done")return C1.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Ax.get(s);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xo(s[e])},set(s,e,n){return s[e]=n,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function ET(s){S1=s(S1)}function xT(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const o=s.call(c1(this),e,...n);return Ax.set(o,e.sort?e.sort():[e]),xo(o)}:mT().includes(s)?function(...e){return s.apply(c1(this),e),xo(_x.get(this))}:function(...e){return xo(s.apply(c1(this),e))}}function _T(s){return typeof s=="function"?xT(s):(s instanceof IDBTransaction&&yT(s),dT(s,gT())?new Proxy(s,S1):s)}function xo(s){if(s instanceof IDBRequest)return pT(s);if(l1.has(s))return l1.get(s);const e=_T(s);return e!==s&&(l1.set(s,e),ag.set(e,s)),e}const c1=s=>ag.get(s);function AT(s,e,{blocked:n,upgrade:o,blocking:h,terminated:g}={}){const E=indexedDB.open(s,e),v=xo(E);return o&&E.addEventListener("upgradeneeded",b=>{o(xo(E.result),b.oldVersion,b.newVersion,xo(E.transaction),b)}),n&&E.addEventListener("blocked",b=>n(b.oldVersion,b.newVersion,b)),v.then(b=>{g&&b.addEventListener("close",()=>g()),h&&b.addEventListener("versionchange",_=>h(_.oldVersion,_.newVersion,_))}).catch(()=>{}),v}const wT=["get","getKey","getAll","getAllKeys","count"],bT=["put","add","delete","clear"],u1=new Map;function by(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(u1.get(e))return u1.get(e);const n=e.replace(/FromIndex$/,""),o=e!==n,h=bT.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!(h||wT.includes(n)))return;const g=async function(E,...v){const b=this.transaction(E,h?"readwrite":"readonly");let _=b.store;return o&&(_=_.index(v.shift())),(await Promise.all([_[n](...v),h&&b.done]))[0]};return u1.set(e,g),g}ET(s=>({...s,get:(e,n,o)=>by(e,n)||s.get(e,n,o),has:(e,n)=>!!by(e,n)||s.has(e,n)}));class TT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(vT(n)){const o=n.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(n=>n).join(" ")}}function vT(s){return s.getComponent()?.type==="VERSION"}const I1="@firebase/app",Ty="0.14.6";const Na=new sg("@firebase/app"),CT="@firebase/app-compat",ST="@firebase/analytics-compat",IT="@firebase/analytics",RT="@firebase/app-check-compat",NT="@firebase/app-check",OT="@firebase/auth",DT="@firebase/auth-compat",MT="@firebase/database",kT="@firebase/data-connect",LT="@firebase/database-compat",PT="@firebase/functions",BT="@firebase/functions-compat",VT="@firebase/installations",UT="@firebase/installations-compat",FT="@firebase/messaging",jT="@firebase/messaging-compat",zT="@firebase/performance",HT="@firebase/performance-compat",GT="@firebase/remote-config",qT="@firebase/remote-config-compat",XT="@firebase/storage",YT="@firebase/storage-compat",WT="@firebase/firestore",KT="@firebase/ai",QT="@firebase/firestore-compat",ZT="firebase",JT="12.6.0";const R1="[DEFAULT]",$T={[I1]:"fire-core",[CT]:"fire-core-compat",[IT]:"fire-analytics",[ST]:"fire-analytics-compat",[NT]:"fire-app-check",[RT]:"fire-app-check-compat",[OT]:"fire-auth",[DT]:"fire-auth-compat",[MT]:"fire-rtdb",[kT]:"fire-data-connect",[LT]:"fire-rtdb-compat",[PT]:"fire-fn",[BT]:"fire-fn-compat",[VT]:"fire-iid",[UT]:"fire-iid-compat",[FT]:"fire-fcm",[jT]:"fire-fcm-compat",[zT]:"fire-perf",[HT]:"fire-perf-compat",[GT]:"fire-rc",[qT]:"fire-rc-compat",[XT]:"fire-gcs",[YT]:"fire-gcs-compat",[WT]:"fire-fst",[QT]:"fire-fst-compat",[KT]:"fire-vertex","fire-js":"fire-js",[ZT]:"fire-js-all"};const yu=new Map,ev=new Map,N1=new Map;function vy(s,e){try{s.container.addComponent(e)}catch(n){Na.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,n)}}function cl(s){const e=s.name;if(N1.has(e))return Na.debug(`There were multiple attempts to register component ${e}.`),!1;N1.set(e,s);for(const n of yu.values())vy(n,s);for(const n of ev.values())vy(n,s);return!0}function Hf(s,e){const n=s.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),s.container.getProvider(e)}function Bi(s){return s==null?!1:s.settings!==void 0}const tv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_o=new Iu("app","Firebase",tv);class nv{constructor(e,n,o){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new To("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _o.create("app-deleted",{appName:this._name})}}const dc=JT;function og(s,e={}){let n=s;typeof e!="object"&&(e={name:e});const o={name:R1,automaticDataCollectionEnabled:!0,...e},h=o.name;if(typeof h!="string"||!h)throw _o.create("bad-app-name",{appName:String(h)});if(n||(n=Ex()),!n)throw _o.create("no-options");const g=yu.get(h);if(g){if(ll(n,g.options)&&ll(o,g.config))return g;throw _o.create("duplicate-app",{appName:h})}const E=new lT(h);for(const b of N1.values())E.addComponent(b);const v=new nv(n,o,E);return yu.set(h,v),v}function Gf(s=R1){const e=yu.get(s);if(!e&&s===R1&&Ex())return og();if(!e)throw _o.create("no-app",{appName:s});return e}function wx(){return Array.from(yu.values())}function Fs(s,e,n){let o=$T[s]??s;n&&(o+=`-${n}`);const h=o.match(/\s|\//),g=e.match(/\s|\//);if(h||g){const E=[`Unable to register library "${o}" with version "${e}":`];h&&E.push(`library name "${o}" contains illegal characters (whitespace or "/")`),h&&g&&E.push("and"),g&&E.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Na.warn(E.join(" "));return}cl(new To(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}const rv="firebase-heartbeat-database",iv=1,Eu="firebase-heartbeat-store";let h1=null;function bx(){return h1||(h1=AT(rv,iv,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Eu)}catch(n){console.warn(n)}}}}).catch(s=>{throw _o.create("idb-open",{originalErrorMessage:s.message})})),h1}async function sv(s){try{const n=(await bx()).transaction(Eu),o=await n.objectStore(Eu).get(Tx(s));return await n.done,o}catch(e){if(e instanceof Qs)Na.warn(e.message);else{const n=_o.create("idb-get",{originalErrorMessage:e?.message});Na.warn(n.message)}}}async function Cy(s,e){try{const o=(await bx()).transaction(Eu,"readwrite");await o.objectStore(Eu).put(e,Tx(s)),await o.done}catch(n){if(n instanceof Qs)Na.warn(n.message);else{const o=_o.create("idb-set",{originalErrorMessage:n?.message});Na.warn(o.message)}}}function Tx(s){return`${s.name}!${s.options.appId}`}const av=1024,ov=30;class lv{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new uv(n),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Sy();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(h=>h.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:n}),this._heartbeatsCache.heartbeats.length>ov){const h=hv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(h,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Na.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Sy(),{heartbeatsToSend:n,unsentEntries:o}=cv(this._heartbeatsCache.heartbeats),h=pf(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),h}catch(e){return Na.warn(e),""}}}function Sy(){return new Date().toISOString().substring(0,10)}function cv(s,e=av){const n=[];let o=s.slice();for(const h of s){const g=n.find(E=>E.agent===h.agent);if(g){if(g.dates.push(h.date),Iy(n)>e){g.dates.pop();break}}else if(n.push({agent:h.agent,dates:[h.date]}),Iy(n)>e){n.pop();break}o=o.slice(1)}return{heartbeatsToSend:n,unsentEntries:o}}class uv{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Qb()?Zb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await sv(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const o=await this.read();return Cy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const o=await this.read();return Cy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function Iy(s){return pf(JSON.stringify({version:2,heartbeats:s})).length}function hv(s){if(s.length===0)return-1;let e=0,n=s[0].date;for(let o=1;o<s.length;o++)s[o].date<n&&(n=s[o].date,e=o);return e}function fv(s){cl(new To("platform-logger",e=>new TT(e),"PRIVATE")),cl(new To("heartbeat",e=>new lv(e),"PRIVATE")),Fs(I1,Ty,s),Fs(I1,Ty,"esm2020"),Fs("fire-js","")}fv("");var dv="firebase",gv="12.6.0";Fs(dv,gv,"app");function vx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mv=vx,Cx=new Iu("auth","Firebase",vx());const yf=new sg("@firebase/auth");function pv(s,...e){yf.logLevel<=hn.WARN&&yf.warn(`Auth (${dc}): ${s}`,...e)}function nf(s,...e){yf.logLevel<=hn.ERROR&&yf.error(`Auth (${dc}): ${s}`,...e)}function Ss(s,...e){throw lg(s,...e)}function js(s,...e){return lg(s,...e)}function Sx(s,e,n){const o={...mv(),[e]:n};return new Iu("auth","Firebase",o).create(e,{appName:s.name})}function zs(s){return Sx(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lg(s,...e){if(typeof s!="string"){const n=e[0],o=[...e.slice(1)];return o[0]&&(o[0].appName=s.name),s._errorFactory.create(n,...o)}return Cx.create(s,...e)}function Ot(s,e,...n){if(!s)throw lg(e,...n)}function Ca(s){const e="INTERNAL ASSERTION FAILED: "+s;throw nf(e),new Error(e)}function Oa(s,e){s||Ca(e)}function O1(){return typeof self<"u"&&self.location?.href||""}function yv(){return Ry()==="http:"||Ry()==="https:"}function Ry(){return typeof self<"u"&&self.location?.protocol||null}function Ev(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yv()||Xb()||"connection"in navigator)?navigator.onLine:!0}function xv(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Nu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Oa(n>e,"Short delay should be less than long delay!"),this.isMobile=Hb()||Yb()}get(){return Ev()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cg(s,e){Oa(s.emulator,"Emulator should always be set here");const{url:n}=s.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Ix{static initialize(e,n,o){this.fetchImpl=e,n&&(this.headersImpl=n),o&&(this.responseImpl=o)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ca("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ca("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ca("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _v={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Av=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],wv=new Nu(3e4,6e4);function ka(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function Zs(s,e,n,o,h={}){return Rx(s,h,async()=>{let g={},E={};o&&(e==="GET"?E=o:g={body:JSON.stringify(o)});const v=Ru({key:s.config.apiKey,...E}).slice(1),b=await s._getAdditionalHeaders();b["Content-Type"]="application/json",s.languageCode&&(b["X-Firebase-Locale"]=s.languageCode);const _={method:e,headers:b,...g};return qb()||(_.referrerPolicy="no-referrer"),s.emulatorConfig&&Oo(s.emulatorConfig.host)&&(_.credentials="include"),Ix.fetch()(await Nx(s,s.config.apiHost,n,v),_)})}async function Rx(s,e,n){s._canInitEmulator=!1;const o={..._v,...e};try{const h=new Tv(s),g=await Promise.race([n(),h.promise]);h.clearNetworkTimeout();const E=await g.json();if("needConfirmation"in E)throw Kh(s,"account-exists-with-different-credential",E);if(g.ok&&!("errorMessage"in E))return E;{const v=g.ok?E.errorMessage:E.error.message,[b,_]=v.split(" : ");if(b==="FEDERATED_USER_ID_ALREADY_LINKED")throw Kh(s,"credential-already-in-use",E);if(b==="EMAIL_EXISTS")throw Kh(s,"email-already-in-use",E);if(b==="USER_DISABLED")throw Kh(s,"user-disabled",E);const S=o[b]||b.toLowerCase().replace(/[_\s]+/g,"-");if(_)throw Sx(s,S,_);Ss(s,S)}}catch(h){if(h instanceof Qs)throw h;Ss(s,"network-request-failed",{message:String(h)})}}async function Ou(s,e,n,o,h={}){const g=await Zs(s,e,n,o,h);return"mfaPendingCredential"in g&&Ss(s,"multi-factor-auth-required",{_serverResponse:g}),g}async function Nx(s,e,n,o){const h=`${e}${n}?${o}`,g=s,E=g.config.emulator?cg(s.config,h):`${s.config.apiScheme}://${h}`;return Av.includes(n)&&(await g._persistenceManagerAvailable,g._getPersistenceType()==="COOKIE")?g._getPersistence()._getFinalTarget(E).toString():E}function bv(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Tv{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,o)=>{this.timer=setTimeout(()=>o(js(this.auth,"network-request-failed")),wv.get())})}}function Kh(s,e,n){const o={appName:s.name};n.email&&(o.email=n.email),n.phoneNumber&&(o.phoneNumber=n.phoneNumber);const h=js(s,e,o);return h.customData._tokenResponse=n,h}function Ny(s){return s!==void 0&&s.enterprise!==void 0}class vv{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return bv(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Cv(s,e){return Zs(s,"GET","/v2/recaptchaConfig",ka(s,e))}async function Sv(s,e){return Zs(s,"POST","/v1/accounts:delete",e)}async function Ef(s,e){return Zs(s,"POST","/v1/accounts:lookup",e)}function fu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Iv(s,e=!1){const n=qn(s),o=await n.getIdToken(e),h=ug(o);Ot(h&&h.exp&&h.auth_time&&h.iat,n.auth,"internal-error");const g=typeof h.firebase=="object"?h.firebase:void 0,E=g?.sign_in_provider;return{claims:h,token:o,authTime:fu(f1(h.auth_time)),issuedAtTime:fu(f1(h.iat)),expirationTime:fu(f1(h.exp)),signInProvider:E||null,signInSecondFactor:g?.sign_in_second_factor||null}}function f1(s){return Number(s)*1e3}function ug(s){const[e,n,o]=s.split(".");if(e===void 0||n===void 0||o===void 0)return nf("JWT malformed, contained fewer than 3 sections"),null;try{const h=mx(n);return h?JSON.parse(h):(nf("Failed to decode base64 JWT payload"),null)}catch(h){return nf("Caught error parsing JWT payload as JSON",h?.toString()),null}}function Oy(s){const e=ug(s);return Ot(e,"internal-error"),Ot(typeof e.exp<"u","internal-error"),Ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function sc(s,e,n=!1){if(n)return e;try{return await e}catch(o){throw o instanceof Qs&&Rv(o)&&s.auth.currentUser===s&&await s.auth.signOut(),o}}function Rv({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class Nv{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const o=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class D1{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function xf(s){const e=s.auth,n=await s.getIdToken(),o=await sc(s,Ef(e,{idToken:n}));Ot(o?.users.length,e,"internal-error");const h=o.users[0];s._notifyReloadListener(h);const g=h.providerUserInfo?.length?Ox(h.providerUserInfo):[],E=Dv(s.providerData,g),v=s.isAnonymous,b=!(s.email&&h.passwordHash)&&!E?.length,_=v?b:!1,S={uid:h.localId,displayName:h.displayName||null,photoURL:h.photoUrl||null,email:h.email||null,emailVerified:h.emailVerified||!1,phoneNumber:h.phoneNumber||null,tenantId:h.tenantId||null,providerData:E,metadata:new D1(h.createdAt,h.lastLoginAt),isAnonymous:_};Object.assign(s,S)}async function Ov(s){const e=qn(s);await xf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Dv(s,e){return[...s.filter(o=>!e.some(h=>h.providerId===o.providerId)),...e]}function Ox(s){return s.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function Mv(s,e){const n=await Rx(s,{},async()=>{const o=Ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:h,apiKey:g}=s.config,E=await Nx(s,h,"/v1/token",`key=${g}`),v=await s._getAdditionalHeaders();v["Content-Type"]="application/x-www-form-urlencoded";const b={method:"POST",headers:v,body:o};return s.emulatorConfig&&Oo(s.emulatorConfig.host)&&(b.credentials="include"),Ix.fetch()(E,b)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function kv(s,e){return Zs(s,"POST","/v2/accounts:revokeToken",ka(s,e))}class tc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ot(e.idToken,"internal-error"),Ot(typeof e.idToken<"u","internal-error"),Ot(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Oy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ot(e.length!==0,"internal-error");const n=Oy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:o,refreshToken:h,expiresIn:g}=await Mv(e,n);this.updateTokensAndExpiration(o,h,Number(g))}updateTokensAndExpiration(e,n,o){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+o*1e3}static fromJSON(e,n){const{refreshToken:o,accessToken:h,expirationTime:g}=n,E=new tc;return o&&(Ot(typeof o=="string","internal-error",{appName:e}),E.refreshToken=o),h&&(Ot(typeof h=="string","internal-error",{appName:e}),E.accessToken=h),g&&(Ot(typeof g=="number","internal-error",{appName:e}),E.expirationTime=g),E}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tc,this.toJSON())}_performRefresh(){return Ca("not implemented")}}function ho(s,e){Ot(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class vs{constructor({uid:e,auth:n,stsTokenManager:o,...h}){this.providerId="firebase",this.proactiveRefresh=new Nv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=h.displayName||null,this.email=h.email||null,this.emailVerified=h.emailVerified||!1,this.phoneNumber=h.phoneNumber||null,this.photoURL=h.photoURL||null,this.isAnonymous=h.isAnonymous||!1,this.tenantId=h.tenantId||null,this.providerData=h.providerData?[...h.providerData]:[],this.metadata=new D1(h.createdAt||void 0,h.lastLoginAt||void 0)}async getIdToken(e){const n=await sc(this,this.stsTokenManager.getToken(this.auth,e));return Ot(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Iv(this,e)}reload(){return Ov(this)}_assign(e){this!==e&&(Ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new vs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let o=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),o=!0),n&&await xf(this),await this.auth._persistUserIfCurrent(this),o&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bi(this.auth.app))return Promise.reject(zs(this.auth));const e=await this.getIdToken();return await sc(this,Sv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const o=n.displayName??void 0,h=n.email??void 0,g=n.phoneNumber??void 0,E=n.photoURL??void 0,v=n.tenantId??void 0,b=n._redirectEventId??void 0,_=n.createdAt??void 0,S=n.lastLoginAt??void 0,{uid:N,emailVerified:P,isAnonymous:X,providerData:te,stsTokenManager:oe}=n;Ot(N&&oe,e,"internal-error");const ue=tc.fromJSON(this.name,oe);Ot(typeof N=="string",e,"internal-error"),ho(o,e.name),ho(h,e.name),Ot(typeof P=="boolean",e,"internal-error"),Ot(typeof X=="boolean",e,"internal-error"),ho(g,e.name),ho(E,e.name),ho(v,e.name),ho(b,e.name),ho(_,e.name),ho(S,e.name);const Ye=new vs({uid:N,auth:e,email:h,emailVerified:P,displayName:o,isAnonymous:X,photoURL:E,phoneNumber:g,tenantId:v,stsTokenManager:ue,createdAt:_,lastLoginAt:S});return te&&Array.isArray(te)&&(Ye.providerData=te.map(ke=>({...ke}))),b&&(Ye._redirectEventId=b),Ye}static async _fromIdTokenResponse(e,n,o=!1){const h=new tc;h.updateFromServerResponse(n);const g=new vs({uid:n.localId,auth:e,stsTokenManager:h,isAnonymous:o});return await xf(g),g}static async _fromGetAccountInfoResponse(e,n,o){const h=n.users[0];Ot(h.localId!==void 0,"internal-error");const g=h.providerUserInfo!==void 0?Ox(h.providerUserInfo):[],E=!(h.email&&h.passwordHash)&&!g?.length,v=new tc;v.updateFromIdToken(o);const b=new vs({uid:h.localId,auth:e,stsTokenManager:v,isAnonymous:E}),_={uid:h.localId,displayName:h.displayName||null,photoURL:h.photoUrl||null,email:h.email||null,emailVerified:h.emailVerified||!1,phoneNumber:h.phoneNumber||null,tenantId:h.tenantId||null,providerData:g,metadata:new D1(h.createdAt,h.lastLoginAt),isAnonymous:!(h.email&&h.passwordHash)&&!g?.length};return Object.assign(b,_),b}}const Dy=new Map;function Sa(s){Oa(s instanceof Function,"Expected a class definition");let e=Dy.get(s);return e?(Oa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,Dy.set(s,e),e)}class Dx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Dx.type="NONE";const My=Dx;function rf(s,e,n){return`firebase:${s}:${e}:${n}`}class nc{constructor(e,n,o){this.persistence=e,this.auth=n,this.userKey=o;const{config:h,name:g}=this.auth;this.fullUserKey=rf(this.userKey,h.apiKey,g),this.fullPersistenceKey=rf("persistence",h.apiKey,g),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Ef(this.auth,{idToken:e}).catch(()=>{});return n?vs._fromGetAccountInfoResponse(this.auth,n,e):null}return vs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,o="authUser"){if(!n.length)return new nc(Sa(My),e,o);const h=(await Promise.all(n.map(async _=>{if(await _._isAvailable())return _}))).filter(_=>_);let g=h[0]||Sa(My);const E=rf(o,e.config.apiKey,e.name);let v=null;for(const _ of n)try{const S=await _._get(E);if(S){let N;if(typeof S=="string"){const P=await Ef(e,{idToken:S}).catch(()=>{});if(!P)break;N=await vs._fromGetAccountInfoResponse(e,P,S)}else N=vs._fromJSON(e,S);_!==g&&(v=N),g=_;break}}catch{}const b=h.filter(_=>_._shouldAllowMigration);return!g._shouldAllowMigration||!b.length?new nc(g,e,o):(g=b[0],v&&await g._set(E,v.toJSON()),await Promise.all(n.map(async _=>{if(_!==g)try{await _._remove(E)}catch{}})),new nc(g,e,o))}}function ky(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Px(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Mx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Vx(e))return"Blackberry";if(Ux(e))return"Webos";if(kx(e))return"Safari";if((e.includes("chrome/")||Lx(e))&&!e.includes("edge/"))return"Chrome";if(Bx(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,o=s.match(n);if(o?.length===2)return o[1]}return"Other"}function Mx(s=gi()){return/firefox\//i.test(s)}function kx(s=gi()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Lx(s=gi()){return/crios\//i.test(s)}function Px(s=gi()){return/iemobile/i.test(s)}function Bx(s=gi()){return/android/i.test(s)}function Vx(s=gi()){return/blackberry/i.test(s)}function Ux(s=gi()){return/webos/i.test(s)}function hg(s=gi()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function Lv(s=gi()){return hg(s)&&!!window.navigator?.standalone}function Pv(){return Wb()&&document.documentMode===10}function Fx(s=gi()){return hg(s)||Bx(s)||Ux(s)||Vx(s)||/windows phone/i.test(s)||Px(s)}function jx(s,e=[]){let n;switch(s){case"Browser":n=ky(gi());break;case"Worker":n=`${ky(gi())}-${s}`;break;default:n=s}const o=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${dc}/${o}`}class Bv{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const o=g=>new Promise((E,v)=>{try{const b=e(g);E(b)}catch(b){v(b)}});o.onAbort=n,this.queue.push(o);const h=this.queue.length-1;return()=>{this.queue[h]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const o of this.queue)await o(e),o.onAbort&&n.push(o.onAbort)}catch(o){n.reverse();for(const h of n)try{h()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:o?.message})}}}async function Vv(s,e={}){return Zs(s,"GET","/v2/passwordPolicy",ka(s,e))}const Uv=6;class Fv{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Uv,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const o=this.customStrengthOptions.minPasswordLength,h=this.customStrengthOptions.maxPasswordLength;o&&(n.meetsMinPasswordLength=e.length>=o),h&&(n.meetsMaxPasswordLength=e.length<=h)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let o;for(let h=0;h<e.length;h++)o=e.charAt(h),this.updatePasswordCharacterOptionsStatuses(n,o>="a"&&o<="z",o>="A"&&o<="Z",o>="0"&&o<="9",this.allowedNonAlphanumericCharacters.includes(o))}updatePasswordCharacterOptionsStatuses(e,n,o,h,g){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=o)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=h)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=g))}}class jv{constructor(e,n,o,h){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=o,this.config=h,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ly(this),this.idTokenSubscription=new Ly(this),this.beforeStateQueue=new Bv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Cx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=h.sdkClientVersion,this._persistenceManagerAvailable=new Promise(g=>this._resolvePersistenceManagerAvailable=g)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Sa(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ef(this,{idToken:e}),o=await vs._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(o)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Bi(this.app)){const g=this.app.settings.authIdToken;return g?new Promise(E=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(g).then(E,E))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let o=n,h=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const g=this.redirectUser?._redirectEventId,E=o?._redirectEventId,v=await this.tryRedirectSignIn(e);(!g||g===E)&&v?.user&&(o=v.user,h=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(h)try{await this.beforeStateQueue.runMiddleware(o)}catch(g){o=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(g))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await xf(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xv()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bi(this.app))return Promise.reject(zs(this));const n=e?qn(e):null;return n&&Ot(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bi(this.app)?Promise.reject(zs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bi(this.app)?Promise.reject(zs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Vv(this),n=new Fv(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Iu("auth","Firebase",e())}onAuthStateChanged(e,n,o){return this.registerStateListener(this.authStateSubscription,e,n,o)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,o){return this.registerStateListener(this.idTokenSubscription,e,n,o)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const o=this.onAuthStateChanged(()=>{o(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),o={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(o.tenantId=this.tenantId),await kv(this,o)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const o=await this.getOrInitRedirectPersistenceManager(n);return e===null?o.removeCurrentUser():o.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Sa(e)||this._popupRedirectResolver;Ot(n,this,"argument-error"),this.redirectPersistenceManager=await nc.create(this,[Sa(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,o,h){if(this._deleted)return()=>{};const g=typeof n=="function"?n:n.next.bind(n);let E=!1;const v=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ot(v,this,"internal-error"),v.then(()=>{E||g(this.currentUser)}),typeof n=="function"){const b=e.addObserver(n,o,h);return()=>{E=!0,b()}}else{const b=e.addObserver(n);return()=>{E=!0,b()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const o=await this._getAppCheckToken();return o&&(e["X-Firebase-AppCheck"]=o),e}async _getAppCheckToken(){if(Bi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&pv(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Do(s){return qn(s)}class Ly{constructor(e){this.auth=e,this.observer=null,this.addObserver=nT(n=>this.observer=n)}get next(){return Ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let qf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zv(s){qf=s}function zx(s){return qf.loadJS(s)}function Hv(){return qf.recaptchaEnterpriseScript}function Gv(){return qf.gapiScript}function qv(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class Xv{constructor(){this.enterprise=new Yv}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Yv{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Wv="recaptcha-enterprise",Hx="NO_RECAPTCHA";class Kv{constructor(e){this.type=Wv,this.auth=Do(e)}async verify(e="verify",n=!1){async function o(g){if(!n){if(g.tenantId==null&&g._agentRecaptchaConfig!=null)return g._agentRecaptchaConfig.siteKey;if(g.tenantId!=null&&g._tenantRecaptchaConfigs[g.tenantId]!==void 0)return g._tenantRecaptchaConfigs[g.tenantId].siteKey}return new Promise(async(E,v)=>{Cv(g,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(b=>{if(b.recaptchaKey===void 0)v(new Error("recaptcha Enterprise site key undefined"));else{const _=new vv(b);return g.tenantId==null?g._agentRecaptchaConfig=_:g._tenantRecaptchaConfigs[g.tenantId]=_,E(_.siteKey)}}).catch(b=>{v(b)})})}function h(g,E,v){const b=window.grecaptcha;Ny(b)?b.enterprise.ready(()=>{b.enterprise.execute(g,{action:e}).then(_=>{E(_)}).catch(()=>{E(Hx)})}):v(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Xv().execute("siteKey",{action:"verify"}):new Promise((g,E)=>{o(this.auth).then(v=>{if(!n&&Ny(window.grecaptcha))h(v,g,E);else{if(typeof window>"u"){E(new Error("RecaptchaVerifier is only supported in browser"));return}let b=Hv();b.length!==0&&(b+=v),zx(b).then(()=>{h(v,g,E)}).catch(_=>{E(_)})}}).catch(v=>{E(v)})})}}async function Py(s,e,n,o=!1,h=!1){const g=new Kv(s);let E;if(h)E=Hx;else try{E=await g.verify(n)}catch{E=await g.verify(n,!0)}const v={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in v){const b=v.phoneEnrollmentInfo.phoneNumber,_=v.phoneEnrollmentInfo.recaptchaToken;Object.assign(v,{phoneEnrollmentInfo:{phoneNumber:b,recaptchaToken:_,captchaResponse:E,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in v){const b=v.phoneSignInInfo.recaptchaToken;Object.assign(v,{phoneSignInInfo:{recaptchaToken:b,captchaResponse:E,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return v}return o?Object.assign(v,{captchaResp:E}):Object.assign(v,{captchaResponse:E}),Object.assign(v,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(v,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),v}async function _f(s,e,n,o,h){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const g=await Py(s,e,n,n==="getOobCode");return o(s,g)}else return o(s,e).catch(async g=>{if(g.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const E=await Py(s,e,n,n==="getOobCode");return o(s,E)}else return Promise.reject(g)})}function Qv(s,e){const n=Hf(s,"auth");if(n.isInitialized()){const h=n.getImmediate(),g=n.getOptions();if(ll(g,e??{}))return h;Ss(h,"already-initialized")}return n.initialize({options:e})}function Zv(s,e){const n=e?.persistence||[],o=(Array.isArray(n)?n:[n]).map(Sa);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(o,e?.popupRedirectResolver)}function Jv(s,e,n){const o=Do(s);Ot(/^https?:\/\//.test(e),o,"invalid-emulator-scheme");const h=!1,g=Gx(e),{host:E,port:v}=$v(e),b=v===null?"":`:${v}`,_={url:`${g}//${E}${b}/`},S=Object.freeze({host:E,port:v,protocol:g.replace(":",""),options:Object.freeze({disableWarnings:h})});if(!o._canInitEmulator){Ot(o.config.emulator&&o.emulatorConfig,o,"emulator-config-failed"),Ot(ll(_,o.config.emulator)&&ll(S,o.emulatorConfig),o,"emulator-config-failed");return}o.config.emulator=_,o.emulatorConfig=S,o.settings.appVerificationDisabledForTesting=!0,Oo(E)?(rg(`${g}//${E}${b}`),ig("Auth",!0)):eC()}function Gx(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function $v(s){const e=Gx(s),n=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!n)return{host:"",port:null};const o=n[2].split("@").pop()||"",h=/^(\[[^\]]+\])(:|$)/.exec(o);if(h){const g=h[1];return{host:g,port:By(o.substr(g.length+1))}}else{const[g,E]=o.split(":");return{host:g,port:By(E)}}}function By(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function eC(){function s(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class fg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ca("not implemented")}_getIdTokenResponse(e){return Ca("not implemented")}_linkToIdToken(e,n){return Ca("not implemented")}_getReauthenticationResolver(e){return Ca("not implemented")}}async function tC(s,e){return Zs(s,"POST","/v1/accounts:update",e)}async function nC(s,e){return Zs(s,"POST","/v1/accounts:signUp",e)}async function rC(s,e){return Ou(s,"POST","/v1/accounts:signInWithPassword",ka(s,e))}async function iC(s,e){return Zs(s,"POST","/v1/accounts:sendOobCode",ka(s,e))}async function sC(s,e){return iC(s,e)}async function aC(s,e){return Ou(s,"POST","/v1/accounts:signInWithEmailLink",ka(s,e))}async function oC(s,e){return Ou(s,"POST","/v1/accounts:signInWithEmailLink",ka(s,e))}class xu extends fg{constructor(e,n,o,h=null){super("password",o),this._email=e,this._password=n,this._tenantId=h}static _fromEmailAndPassword(e,n){return new xu(e,n,"password")}static _fromEmailAndCode(e,n,o=null){return new xu(e,n,"emailLink",o)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _f(e,n,"signInWithPassword",rC);case"emailLink":return aC(e,{email:this._email,oobCode:this._password});default:Ss(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const o={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _f(e,o,"signUpPassword",nC);case"emailLink":return oC(e,{idToken:n,email:this._email,oobCode:this._password});default:Ss(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function rc(s,e){return Ou(s,"POST","/v1/accounts:signInWithIdp",ka(s,e))}const lC="http://localhost";class ul extends fg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ul(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ss("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:o,signInMethod:h,...g}=n;if(!o||!h)return null;const E=new ul(o,h);return E.idToken=g.idToken||void 0,E.accessToken=g.accessToken||void 0,E.secret=g.secret,E.nonce=g.nonce,E.pendingToken=g.pendingToken||null,E}_getIdTokenResponse(e){const n=this.buildRequest();return rc(e,n)}_linkToIdToken(e,n){const o=this.buildRequest();return o.idToken=n,rc(e,o)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,rc(e,n)}buildRequest(){const e={requestUri:lC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ru(n)}return e}}function cC(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uC(s){const e=iu(su(s)).link,n=e?iu(su(e)).deep_link_id:null,o=iu(su(s)).deep_link_id;return(o?iu(su(o)).link:null)||o||n||e||s}class dg{constructor(e){const n=iu(su(e)),o=n.apiKey??null,h=n.oobCode??null,g=cC(n.mode??null);Ot(o&&h&&g,"argument-error"),this.apiKey=o,this.operation=g,this.code=h,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=uC(e);try{return new dg(n)}catch{return null}}}class gc{constructor(){this.providerId=gc.PROVIDER_ID}static credential(e,n){return xu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const o=dg.parseLink(n);return Ot(o,"argument-error"),xu._fromEmailAndCode(e,o.code,o.tenantId)}}gc.PROVIDER_ID="password";gc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";gc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class qx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Du extends qx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class fo extends Du{constructor(){super("facebook.com")}static credential(e){return ul._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fo.credential(e.oauthAccessToken)}catch{return null}}}fo.FACEBOOK_SIGN_IN_METHOD="facebook.com";fo.PROVIDER_ID="facebook.com";class go extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ul._fromParams({providerId:go.PROVIDER_ID,signInMethod:go.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return go.credentialFromTaggedObject(e)}static credentialFromError(e){return go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:o}=e;if(!n&&!o)return null;try{return go.credential(n,o)}catch{return null}}}go.GOOGLE_SIGN_IN_METHOD="google.com";go.PROVIDER_ID="google.com";class mo extends Du{constructor(){super("github.com")}static credential(e){return ul._fromParams({providerId:mo.PROVIDER_ID,signInMethod:mo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mo.credentialFromTaggedObject(e)}static credentialFromError(e){return mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mo.credential(e.oauthAccessToken)}catch{return null}}}mo.GITHUB_SIGN_IN_METHOD="github.com";mo.PROVIDER_ID="github.com";class po extends Du{constructor(){super("twitter.com")}static credential(e,n){return ul._fromParams({providerId:po.PROVIDER_ID,signInMethod:po.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return po.credentialFromTaggedObject(e)}static credentialFromError(e){return po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:o}=e;if(!n||!o)return null;try{return po.credential(n,o)}catch{return null}}}po.TWITTER_SIGN_IN_METHOD="twitter.com";po.PROVIDER_ID="twitter.com";async function hC(s,e){return Ou(s,"POST","/v1/accounts:signUp",ka(s,e))}class hl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,o,h=!1){const g=await vs._fromIdTokenResponse(e,o,h),E=Vy(o);return new hl({user:g,providerId:E,_tokenResponse:o,operationType:n})}static async _forOperation(e,n,o){await e._updateTokensIfNecessary(o,!0);const h=Vy(o);return new hl({user:e,providerId:h,_tokenResponse:o,operationType:n})}}function Vy(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Af extends Qs{constructor(e,n,o,h){super(n.code,n.message),this.operationType=o,this.user=h,Object.setPrototypeOf(this,Af.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:o}}static _fromErrorAndOperation(e,n,o,h){return new Af(e,n,o,h)}}function Xx(s,e,n,o){return(e==="reauthenticate"?n._getReauthenticationResolver(s):n._getIdTokenResponse(s)).catch(g=>{throw g.code==="auth/multi-factor-auth-required"?Af._fromErrorAndOperation(s,g,e,o):g})}async function fC(s,e,n=!1){const o=await sc(s,e._linkToIdToken(s.auth,await s.getIdToken()),n);return hl._forOperation(s,"link",o)}async function dC(s,e,n=!1){const{auth:o}=s;if(Bi(o.app))return Promise.reject(zs(o));const h="reauthenticate";try{const g=await sc(s,Xx(o,h,e,s),n);Ot(g.idToken,o,"internal-error");const E=ug(g.idToken);Ot(E,o,"internal-error");const{sub:v}=E;return Ot(s.uid===v,o,"user-mismatch"),hl._forOperation(s,h,g)}catch(g){throw g?.code==="auth/user-not-found"&&Ss(o,"user-mismatch"),g}}async function Yx(s,e,n=!1){if(Bi(s.app))return Promise.reject(zs(s));const o="signIn",h=await Xx(s,o,e),g=await hl._fromIdTokenResponse(s,o,h);return n||await s._updateCurrentUser(g.user),g}async function gC(s,e){return Yx(Do(s),e)}async function Wx(s){const e=Do(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Uy(s,e,n){const o=Do(s);await _f(o,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",sC)}async function sf(s,e,n){if(Bi(s.app))return Promise.reject(zs(s));const o=Do(s),E=await _f(o,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",hC).catch(b=>{throw b.code==="auth/password-does-not-meet-requirements"&&Wx(s),b}),v=await hl._fromIdTokenResponse(o,"signIn",E);return await o._updateCurrentUser(v.user),v}function mC(s,e,n){return Bi(s.app)?Promise.reject(zs(s)):gC(qn(s),gc.credential(e,n)).catch(async o=>{throw o.code==="auth/password-does-not-meet-requirements"&&Wx(s),o})}function pC(s,e){const n=qn(s);return Bi(n.auth.app)?Promise.reject(zs(n.auth)):Kx(n,e,null)}function yC(s,e){return Kx(qn(s),null,e)}async function Kx(s,e,n){const{auth:o}=s,g={idToken:await s.getIdToken(),returnSecureToken:!0};e&&(g.email=e),n&&(g.password=n);const E=await sc(s,tC(o,g));await s._updateTokensIfNecessary(E,!0)}function EC(s,e,n,o){return qn(s).onIdTokenChanged(e,n,o)}function xC(s,e,n){return qn(s).beforeAuthStateChanged(e,n)}function _C(s,e,n,o){return qn(s).onAuthStateChanged(e,n,o)}function AC(s){return qn(s).signOut()}const wf="__sak";class Qx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(wf,"1"),this.storage.removeItem(wf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const wC=1e3,bC=10;class Zx extends Qx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Fx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const o=this.storage.getItem(n),h=this.localCache[n];o!==h&&e(n,h,o)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((E,v,b)=>{this.notifyListeners(E,b)});return}const o=e.key;n?this.detachListener():this.stopPolling();const h=()=>{const E=this.storage.getItem(o);!n&&this.localCache[o]===E||this.notifyListeners(o,E)},g=this.storage.getItem(o);Pv()&&g!==e.newValue&&e.newValue!==e.oldValue?setTimeout(h,bC):h()}notifyListeners(e,n){this.localCache[e]=n;const o=this.listeners[e];if(o)for(const h of Array.from(o))h(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,o)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:o}),!0)})},wC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Zx.type="LOCAL";const TC=Zx;class Jx extends Qx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Jx.type="SESSION";const $x=Jx;function vC(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Xf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(h=>h.isListeningto(e));if(n)return n;const o=new Xf(e);return this.receivers.push(o),o}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:o,eventType:h,data:g}=n.data,E=this.handlersMap[h];if(!E?.size)return;n.ports[0].postMessage({status:"ack",eventId:o,eventType:h});const v=Array.from(E).map(async _=>_(n.origin,g)),b=await vC(v);n.ports[0].postMessage({status:"done",eventId:o,eventType:h,response:b})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xf.receivers=[];function gg(s="",e=10){let n="";for(let o=0;o<e;o++)n+=Math.floor(Math.random()*10);return s+n}class CC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,o=50){const h=typeof MessageChannel<"u"?new MessageChannel:null;if(!h)throw new Error("connection_unavailable");let g,E;return new Promise((v,b)=>{const _=gg("",20);h.port1.start();const S=setTimeout(()=>{b(new Error("unsupported_event"))},o);E={messageChannel:h,onMessage(N){const P=N;if(P.data.eventId===_)switch(P.data.status){case"ack":clearTimeout(S),g=setTimeout(()=>{b(new Error("timeout"))},3e3);break;case"done":clearTimeout(g),v(P.data.response);break;default:clearTimeout(S),clearTimeout(g),b(new Error("invalid_response"));break}}},this.handlers.add(E),h.port1.addEventListener("message",E.onMessage),this.target.postMessage({eventType:e,eventId:_,data:n},[h.port2])}).finally(()=>{E&&this.removeMessageHandler(E)})}}function Hs(){return window}function SC(s){Hs().location.href=s}function e_(){return typeof Hs().WorkerGlobalScope<"u"&&typeof Hs().importScripts=="function"}async function IC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RC(){return navigator?.serviceWorker?.controller||null}function NC(){return e_()?self:null}const t_="firebaseLocalStorageDb",OC=1,bf="firebaseLocalStorage",n_="fbase_key";class Mu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Yf(s,e){return s.transaction([bf],e?"readwrite":"readonly").objectStore(bf)}function DC(){const s=indexedDB.deleteDatabase(t_);return new Mu(s).toPromise()}function M1(){const s=indexedDB.open(t_,OC);return new Promise((e,n)=>{s.addEventListener("error",()=>{n(s.error)}),s.addEventListener("upgradeneeded",()=>{const o=s.result;try{o.createObjectStore(bf,{keyPath:n_})}catch(h){n(h)}}),s.addEventListener("success",async()=>{const o=s.result;o.objectStoreNames.contains(bf)?e(o):(o.close(),await DC(),e(await M1()))})})}async function Fy(s,e,n){const o=Yf(s,!0).put({[n_]:e,value:n});return new Mu(o).toPromise()}async function MC(s,e){const n=Yf(s,!1).get(e),o=await new Mu(n).toPromise();return o===void 0?null:o.value}function jy(s,e){const n=Yf(s,!0).delete(e);return new Mu(n).toPromise()}const kC=800,LC=3;class r_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await M1(),this.db)}async _withRetries(e){let n=0;for(;;)try{const o=await this._openDb();return await e(o)}catch(o){if(n++>LC)throw o;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return e_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xf._getInstance(NC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await IC(),!this.activeServiceWorker)return;this.sender=new CC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await M1();return await Fy(e,wf,"1"),await jy(e,wf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(o=>Fy(o,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(o=>MC(o,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>jy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(h=>{const g=Yf(h,!1).getAll();return new Mu(g).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],o=new Set;if(e.length!==0)for(const{fbase_key:h,value:g}of e)o.add(h),JSON.stringify(this.localCache[h])!==JSON.stringify(g)&&(this.notifyListeners(h,g),n.push(h));for(const h of Object.keys(this.localCache))this.localCache[h]&&!o.has(h)&&(this.notifyListeners(h,null),n.push(h));return n}notifyListeners(e,n){this.localCache[e]=n;const o=this.listeners[e];if(o)for(const h of Array.from(o))h(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}r_.type="LOCAL";const PC=r_;new Nu(3e4,6e4);function BC(s,e){return e?Sa(e):(Ot(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class mg extends fg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return rc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return rc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function VC(s){return Yx(s.auth,new mg(s),s.bypassAuthState)}function UC(s){const{auth:e,user:n}=s;return Ot(n,e,"internal-error"),dC(n,new mg(s),s.bypassAuthState)}async function FC(s){const{auth:e,user:n}=s;return Ot(n,e,"internal-error"),fC(n,new mg(s),s.bypassAuthState)}class i_{constructor(e,n,o,h,g=!1){this.auth=e,this.resolver=o,this.user=h,this.bypassAuthState=g,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(o){this.reject(o)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:o,postBody:h,tenantId:g,error:E,type:v}=e;if(E){this.reject(E);return}const b={auth:this.auth,requestUri:n,sessionId:o,tenantId:g||void 0,postBody:h||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(v)(b))}catch(_){this.reject(_)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return VC;case"linkViaPopup":case"linkViaRedirect":return FC;case"reauthViaPopup":case"reauthViaRedirect":return UC;default:Ss(this.auth,"internal-error")}}resolve(e){Oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jC=new Nu(2e3,1e4);class Jl extends i_{constructor(e,n,o,h,g){super(e,n,h,g),this.provider=o,this.authWindow=null,this.pollId=null,Jl.currentPopupAction&&Jl.currentPopupAction.cancel(),Jl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ot(e,this.auth,"internal-error"),e}async onExecution(){Oa(this.filter.length===1,"Popup operations only handle one event");const e=gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(js(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(js(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(js(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jC.get())};e()}}Jl.currentPopupAction=null;const zC="pendingRedirect",af=new Map;class HC extends i_{constructor(e,n,o=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,o),this.eventId=null}async execute(){let e=af.get(this.auth._key());if(!e){try{const o=await GC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(o)}catch(n){e=()=>Promise.reject(n)}af.set(this.auth._key(),e)}return this.bypassAuthState||af.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GC(s,e){const n=YC(e),o=XC(s);if(!await o._isAvailable())return!1;const h=await o._get(n)==="true";return await o._remove(n),h}function qC(s,e){af.set(s._key(),e)}function XC(s){return Sa(s._redirectPersistence)}function YC(s){return rf(zC,s.config.apiKey,s.name)}async function WC(s,e,n=!1){if(Bi(s.app))return Promise.reject(zs(s));const o=Do(s),h=BC(o,e),E=await new HC(o,h,n).execute();return E&&!n&&(delete E.user._redirectEventId,await o._persistUserIfCurrent(E.user),await o._setRedirectUser(null,e)),E}const KC=600*1e3;class QC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(o=>{this.isEventForConsumer(e,o)&&(n=!0,this.sendToConsumer(e,o),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ZC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!s_(e)){const o=e.error.code?.split("auth/")[1]||"internal-error";n.onError(js(this.auth,o))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const o=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&o}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=KC&&this.cachedEventUids.clear(),this.cachedEventUids.has(zy(e))}saveEventToCache(e){this.cachedEventUids.add(zy(e)),this.lastProcessedEventTime=Date.now()}}function zy(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function s_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function ZC(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return s_(s);default:return!1}}async function JC(s,e={}){return Zs(s,"GET","/v1/projects",e)}const $C=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,e3=/^https?/;async function t3(s){if(s.config.emulator)return;const{authorizedDomains:e}=await JC(s);for(const n of e)try{if(n3(n))return}catch{}Ss(s,"unauthorized-domain")}function n3(s){const e=O1(),{protocol:n,hostname:o}=new URL(e);if(s.startsWith("chrome-extension://")){const E=new URL(s);return E.hostname===""&&o===""?n==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&E.hostname===o}if(!e3.test(n))return!1;if($C.test(s))return o===s;const h=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+h+"|"+h+")$","i").test(o)}const r3=new Nu(3e4,6e4);function Hy(){const s=Hs().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let n=0;n<s.CP.length;n++)s.CP[n]=null}}function i3(s){return new Promise((e,n)=>{function o(){Hy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Hy(),n(js(s,"network-request-failed"))},timeout:r3.get()})}if(Hs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Hs().gapi?.load)o();else{const h=qv("iframefcb");return Hs()[h]=()=>{gapi.load?o():n(js(s,"network-request-failed"))},zx(`${Gv()}?onload=${h}`).catch(g=>n(g))}}).catch(e=>{throw of=null,e})}let of=null;function s3(s){return of=of||i3(s),of}const a3=new Nu(5e3,15e3),o3="__/auth/iframe",l3="emulator/auth/iframe",c3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},u3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function h3(s){const e=s.config;Ot(e.authDomain,s,"auth-domain-config-required");const n=e.emulator?cg(e,l3):`https://${s.config.authDomain}/${o3}`,o={apiKey:e.apiKey,appName:s.name,v:dc},h=u3.get(s.config.apiHost);h&&(o.eid=h);const g=s._getFrameworks();return g.length&&(o.fw=g.join(",")),`${n}?${Ru(o).slice(1)}`}async function f3(s){const e=await s3(s),n=Hs().gapi;return Ot(n,s,"internal-error"),e.open({where:document.body,url:h3(s),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:c3,dontclear:!0},o=>new Promise(async(h,g)=>{await o.restyle({setHideOnLeave:!1});const E=js(s,"network-request-failed"),v=Hs().setTimeout(()=>{g(E)},a3.get());function b(){Hs().clearTimeout(v),h(o)}o.ping(b).then(b,()=>{g(E)})}))}const d3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},g3=500,m3=600,p3="_blank",y3="http://localhost";class Gy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function E3(s,e,n,o=g3,h=m3){const g=Math.max((window.screen.availHeight-h)/2,0).toString(),E=Math.max((window.screen.availWidth-o)/2,0).toString();let v="";const b={...d3,width:o.toString(),height:h.toString(),top:g,left:E},_=gi().toLowerCase();n&&(v=Lx(_)?p3:n),Mx(_)&&(e=e||y3,b.scrollbars="yes");const S=Object.entries(b).reduce((P,[X,te])=>`${P}${X}=${te},`,"");if(Lv(_)&&v!=="_self")return x3(e||"",v),new Gy(null);const N=window.open(e||"",v,S);Ot(N,s,"popup-blocked");try{N.focus()}catch{}return new Gy(N)}function x3(s,e){const n=document.createElement("a");n.href=s,n.target=e;const o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(o)}const _3="__/auth/handler",A3="emulator/auth/handler",w3=encodeURIComponent("fac");async function qy(s,e,n,o,h,g){Ot(s.config.authDomain,s,"auth-domain-config-required"),Ot(s.config.apiKey,s,"invalid-api-key");const E={apiKey:s.config.apiKey,appName:s.name,authType:n,redirectUrl:o,v:dc,eventId:h};if(e instanceof qx){e.setDefaultLanguage(s.languageCode),E.providerId=e.providerId||"",tT(e.getCustomParameters())||(E.customParameters=JSON.stringify(e.getCustomParameters()));for(const[S,N]of Object.entries({}))E[S]=N}if(e instanceof Du){const S=e.getScopes().filter(N=>N!=="");S.length>0&&(E.scopes=S.join(","))}s.tenantId&&(E.tid=s.tenantId);const v=E;for(const S of Object.keys(v))v[S]===void 0&&delete v[S];const b=await s._getAppCheckToken(),_=b?`#${w3}=${encodeURIComponent(b)}`:"";return`${b3(s)}?${Ru(v).slice(1)}${_}`}function b3({config:s}){return s.emulator?cg(s,A3):`https://${s.authDomain}/${_3}`}const d1="webStorageSupport";class T3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$x,this._completeRedirectFn=WC,this._overrideRedirectResult=qC}async _openPopup(e,n,o,h){Oa(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const g=await qy(e,n,o,O1(),h);return E3(e,g,gg())}async _openRedirect(e,n,o,h){await this._originValidation(e);const g=await qy(e,n,o,O1(),h);return SC(g),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:h,promise:g}=this.eventManagers[n];return h?Promise.resolve(h):(Oa(g,"If manager is not set, promise should be"),g)}const o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(()=>{delete this.eventManagers[n]}),o}async initAndGetManager(e){const n=await f3(e),o=new QC(e);return n.register("authEvent",h=>(Ot(h?.authEvent,e,"invalid-auth-event"),{status:o.onEvent(h.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:o},this.iframes[e._key()]=n,o}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(d1,{type:d1},h=>{const g=h?.[0]?.[d1];g!==void 0&&n(!!g),Ss(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=t3(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Fx()||kx()||hg()}}const v3=T3;var Xy="@firebase/auth",Yy="1.11.1";class C3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(o=>{e(o?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function S3(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function I3(s){cl(new To("auth",(e,{options:n})=>{const o=e.getProvider("app").getImmediate(),h=e.getProvider("heartbeat"),g=e.getProvider("app-check-internal"),{apiKey:E,authDomain:v}=o.options;Ot(E&&!E.includes(":"),"invalid-api-key",{appName:o.name});const b={apiKey:E,authDomain:v,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jx(s)},_=new jv(o,h,g,b);return Zv(_,n),_},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,o)=>{e.getProvider("auth-internal").initialize()})),cl(new To("auth-internal",e=>{const n=Do(e.getProvider("auth").getImmediate());return(o=>new C3(o))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fs(Xy,Yy,S3(s)),Fs(Xy,Yy,"esm2020")}const R3=300,N3=xx("authIdTokenMaxAge")||R3;let Wy=null;const O3=s=>async e=>{const n=e&&await e.getIdTokenResult(),o=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(o&&o>N3)return;const h=n?.token;Wy!==h&&(Wy=h,await fetch(s,{method:h?"POST":"DELETE",headers:h?{Authorization:`Bearer ${h}`}:{}}))};function a_(s=Gf()){const e=Hf(s,"auth");if(e.isInitialized())return e.getImmediate();const n=Qv(s,{popupRedirectResolver:v3,persistence:[PC,TC,$x]}),o=xx("authTokenSyncURL");if(o&&typeof isSecureContext=="boolean"&&isSecureContext){const g=new URL(o,location.origin);if(location.origin===g.origin){const E=O3(g.toString());xC(n,E,()=>E(n.currentUser)),EC(n,v=>E(v))}}const h=px("auth");return h&&Jv(n,`http://${h}`),n}function D3(){return document.getElementsByTagName("head")?.[0]??document}zv({loadJS(s){return new Promise((e,n)=>{const o=document.createElement("script");o.setAttribute("src",s),o.onload=e,o.onerror=h=>{const g=js("internal-error");g.customData=h,n(g)},o.type="text/javascript",o.charset="UTF-8",D3().appendChild(o)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});I3("Browser");var Ky=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ao,o_;(function(){var s;function e(F,j){function V(){}V.prototype=j.prototype,F.F=j.prototype,F.prototype=new V,F.prototype.constructor=F,F.D=function(Z,q,Y){for(var H=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)H[rt-2]=arguments[rt];return j.prototype[q].apply(Z,H)}}function n(){this.blockSize=-1}function o(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(o,n),o.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function h(F,j,V){V||(V=0);const Z=Array(16);if(typeof j=="string")for(var q=0;q<16;++q)Z[q]=j.charCodeAt(V++)|j.charCodeAt(V++)<<8|j.charCodeAt(V++)<<16|j.charCodeAt(V++)<<24;else for(q=0;q<16;++q)Z[q]=j[V++]|j[V++]<<8|j[V++]<<16|j[V++]<<24;j=F.g[0],V=F.g[1],q=F.g[2];let Y=F.g[3],H;H=j+(Y^V&(q^Y))+Z[0]+3614090360&4294967295,j=V+(H<<7&4294967295|H>>>25),H=Y+(q^j&(V^q))+Z[1]+3905402710&4294967295,Y=j+(H<<12&4294967295|H>>>20),H=q+(V^Y&(j^V))+Z[2]+606105819&4294967295,q=Y+(H<<17&4294967295|H>>>15),H=V+(j^q&(Y^j))+Z[3]+3250441966&4294967295,V=q+(H<<22&4294967295|H>>>10),H=j+(Y^V&(q^Y))+Z[4]+4118548399&4294967295,j=V+(H<<7&4294967295|H>>>25),H=Y+(q^j&(V^q))+Z[5]+1200080426&4294967295,Y=j+(H<<12&4294967295|H>>>20),H=q+(V^Y&(j^V))+Z[6]+2821735955&4294967295,q=Y+(H<<17&4294967295|H>>>15),H=V+(j^q&(Y^j))+Z[7]+4249261313&4294967295,V=q+(H<<22&4294967295|H>>>10),H=j+(Y^V&(q^Y))+Z[8]+1770035416&4294967295,j=V+(H<<7&4294967295|H>>>25),H=Y+(q^j&(V^q))+Z[9]+2336552879&4294967295,Y=j+(H<<12&4294967295|H>>>20),H=q+(V^Y&(j^V))+Z[10]+4294925233&4294967295,q=Y+(H<<17&4294967295|H>>>15),H=V+(j^q&(Y^j))+Z[11]+2304563134&4294967295,V=q+(H<<22&4294967295|H>>>10),H=j+(Y^V&(q^Y))+Z[12]+1804603682&4294967295,j=V+(H<<7&4294967295|H>>>25),H=Y+(q^j&(V^q))+Z[13]+4254626195&4294967295,Y=j+(H<<12&4294967295|H>>>20),H=q+(V^Y&(j^V))+Z[14]+2792965006&4294967295,q=Y+(H<<17&4294967295|H>>>15),H=V+(j^q&(Y^j))+Z[15]+1236535329&4294967295,V=q+(H<<22&4294967295|H>>>10),H=j+(q^Y&(V^q))+Z[1]+4129170786&4294967295,j=V+(H<<5&4294967295|H>>>27),H=Y+(V^q&(j^V))+Z[6]+3225465664&4294967295,Y=j+(H<<9&4294967295|H>>>23),H=q+(j^V&(Y^j))+Z[11]+643717713&4294967295,q=Y+(H<<14&4294967295|H>>>18),H=V+(Y^j&(q^Y))+Z[0]+3921069994&4294967295,V=q+(H<<20&4294967295|H>>>12),H=j+(q^Y&(V^q))+Z[5]+3593408605&4294967295,j=V+(H<<5&4294967295|H>>>27),H=Y+(V^q&(j^V))+Z[10]+38016083&4294967295,Y=j+(H<<9&4294967295|H>>>23),H=q+(j^V&(Y^j))+Z[15]+3634488961&4294967295,q=Y+(H<<14&4294967295|H>>>18),H=V+(Y^j&(q^Y))+Z[4]+3889429448&4294967295,V=q+(H<<20&4294967295|H>>>12),H=j+(q^Y&(V^q))+Z[9]+568446438&4294967295,j=V+(H<<5&4294967295|H>>>27),H=Y+(V^q&(j^V))+Z[14]+3275163606&4294967295,Y=j+(H<<9&4294967295|H>>>23),H=q+(j^V&(Y^j))+Z[3]+4107603335&4294967295,q=Y+(H<<14&4294967295|H>>>18),H=V+(Y^j&(q^Y))+Z[8]+1163531501&4294967295,V=q+(H<<20&4294967295|H>>>12),H=j+(q^Y&(V^q))+Z[13]+2850285829&4294967295,j=V+(H<<5&4294967295|H>>>27),H=Y+(V^q&(j^V))+Z[2]+4243563512&4294967295,Y=j+(H<<9&4294967295|H>>>23),H=q+(j^V&(Y^j))+Z[7]+1735328473&4294967295,q=Y+(H<<14&4294967295|H>>>18),H=V+(Y^j&(q^Y))+Z[12]+2368359562&4294967295,V=q+(H<<20&4294967295|H>>>12),H=j+(V^q^Y)+Z[5]+4294588738&4294967295,j=V+(H<<4&4294967295|H>>>28),H=Y+(j^V^q)+Z[8]+2272392833&4294967295,Y=j+(H<<11&4294967295|H>>>21),H=q+(Y^j^V)+Z[11]+1839030562&4294967295,q=Y+(H<<16&4294967295|H>>>16),H=V+(q^Y^j)+Z[14]+4259657740&4294967295,V=q+(H<<23&4294967295|H>>>9),H=j+(V^q^Y)+Z[1]+2763975236&4294967295,j=V+(H<<4&4294967295|H>>>28),H=Y+(j^V^q)+Z[4]+1272893353&4294967295,Y=j+(H<<11&4294967295|H>>>21),H=q+(Y^j^V)+Z[7]+4139469664&4294967295,q=Y+(H<<16&4294967295|H>>>16),H=V+(q^Y^j)+Z[10]+3200236656&4294967295,V=q+(H<<23&4294967295|H>>>9),H=j+(V^q^Y)+Z[13]+681279174&4294967295,j=V+(H<<4&4294967295|H>>>28),H=Y+(j^V^q)+Z[0]+3936430074&4294967295,Y=j+(H<<11&4294967295|H>>>21),H=q+(Y^j^V)+Z[3]+3572445317&4294967295,q=Y+(H<<16&4294967295|H>>>16),H=V+(q^Y^j)+Z[6]+76029189&4294967295,V=q+(H<<23&4294967295|H>>>9),H=j+(V^q^Y)+Z[9]+3654602809&4294967295,j=V+(H<<4&4294967295|H>>>28),H=Y+(j^V^q)+Z[12]+3873151461&4294967295,Y=j+(H<<11&4294967295|H>>>21),H=q+(Y^j^V)+Z[15]+530742520&4294967295,q=Y+(H<<16&4294967295|H>>>16),H=V+(q^Y^j)+Z[2]+3299628645&4294967295,V=q+(H<<23&4294967295|H>>>9),H=j+(q^(V|~Y))+Z[0]+4096336452&4294967295,j=V+(H<<6&4294967295|H>>>26),H=Y+(V^(j|~q))+Z[7]+1126891415&4294967295,Y=j+(H<<10&4294967295|H>>>22),H=q+(j^(Y|~V))+Z[14]+2878612391&4294967295,q=Y+(H<<15&4294967295|H>>>17),H=V+(Y^(q|~j))+Z[5]+4237533241&4294967295,V=q+(H<<21&4294967295|H>>>11),H=j+(q^(V|~Y))+Z[12]+1700485571&4294967295,j=V+(H<<6&4294967295|H>>>26),H=Y+(V^(j|~q))+Z[3]+2399980690&4294967295,Y=j+(H<<10&4294967295|H>>>22),H=q+(j^(Y|~V))+Z[10]+4293915773&4294967295,q=Y+(H<<15&4294967295|H>>>17),H=V+(Y^(q|~j))+Z[1]+2240044497&4294967295,V=q+(H<<21&4294967295|H>>>11),H=j+(q^(V|~Y))+Z[8]+1873313359&4294967295,j=V+(H<<6&4294967295|H>>>26),H=Y+(V^(j|~q))+Z[15]+4264355552&4294967295,Y=j+(H<<10&4294967295|H>>>22),H=q+(j^(Y|~V))+Z[6]+2734768916&4294967295,q=Y+(H<<15&4294967295|H>>>17),H=V+(Y^(q|~j))+Z[13]+1309151649&4294967295,V=q+(H<<21&4294967295|H>>>11),H=j+(q^(V|~Y))+Z[4]+4149444226&4294967295,j=V+(H<<6&4294967295|H>>>26),H=Y+(V^(j|~q))+Z[11]+3174756917&4294967295,Y=j+(H<<10&4294967295|H>>>22),H=q+(j^(Y|~V))+Z[2]+718787259&4294967295,q=Y+(H<<15&4294967295|H>>>17),H=V+(Y^(q|~j))+Z[9]+3951481745&4294967295,F.g[0]=F.g[0]+j&4294967295,F.g[1]=F.g[1]+(q+(H<<21&4294967295|H>>>11))&4294967295,F.g[2]=F.g[2]+q&4294967295,F.g[3]=F.g[3]+Y&4294967295}o.prototype.v=function(F,j){j===void 0&&(j=F.length);const V=j-this.blockSize,Z=this.C;let q=this.h,Y=0;for(;Y<j;){if(q==0)for(;Y<=V;)h(this,F,Y),Y+=this.blockSize;if(typeof F=="string"){for(;Y<j;)if(Z[q++]=F.charCodeAt(Y++),q==this.blockSize){h(this,Z),q=0;break}}else for(;Y<j;)if(Z[q++]=F[Y++],q==this.blockSize){h(this,Z),q=0;break}}this.h=q,this.o+=j},o.prototype.A=function(){var F=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);F[0]=128;for(var j=1;j<F.length-8;++j)F[j]=0;j=this.o*8;for(var V=F.length-8;V<F.length;++V)F[V]=j&255,j/=256;for(this.v(F),F=Array(16),j=0,V=0;V<4;++V)for(let Z=0;Z<32;Z+=8)F[j++]=this.g[V]>>>Z&255;return F};function g(F,j){var V=v;return Object.prototype.hasOwnProperty.call(V,F)?V[F]:V[F]=j(F)}function E(F,j){this.h=j;const V=[];let Z=!0;for(let q=F.length-1;q>=0;q--){const Y=F[q]|0;Z&&Y==j||(V[q]=Y,Z=!1)}this.g=V}var v={};function b(F){return-128<=F&&F<128?g(F,function(j){return new E([j|0],j<0?-1:0)}):new E([F|0],F<0?-1:0)}function _(F){if(isNaN(F)||!isFinite(F))return N;if(F<0)return ue(_(-F));const j=[];let V=1;for(let Z=0;F>=V;Z++)j[Z]=F/V|0,V*=4294967296;return new E(j,0)}function S(F,j){if(F.length==0)throw Error("number format error: empty string");if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(F.charAt(0)=="-")return ue(S(F.substring(1),j));if(F.indexOf("-")>=0)throw Error('number format error: interior "-" character');const V=_(Math.pow(j,8));let Z=N;for(let Y=0;Y<F.length;Y+=8){var q=Math.min(8,F.length-Y);const H=parseInt(F.substring(Y,Y+q),j);q<8?(q=_(Math.pow(j,q)),Z=Z.j(q).add(_(H))):(Z=Z.j(V),Z=Z.add(_(H)))}return Z}var N=b(0),P=b(1),X=b(16777216);s=E.prototype,s.m=function(){if(oe(this))return-ue(this).m();let F=0,j=1;for(let V=0;V<this.g.length;V++){const Z=this.i(V);F+=(Z>=0?Z:4294967296+Z)*j,j*=4294967296}return F},s.toString=function(F){if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(te(this))return"0";if(oe(this))return"-"+ue(this).toString(F);const j=_(Math.pow(F,6));var V=this;let Z="";for(;;){const q=Pe(V,j).g;V=Ye(V,q.j(j));let Y=((V.g.length>0?V.g[0]:V.h)>>>0).toString(F);if(V=q,te(V))return Y+Z;for(;Y.length<6;)Y="0"+Y;Z=Y+Z}},s.i=function(F){return F<0?0:F<this.g.length?this.g[F]:this.h};function te(F){if(F.h!=0)return!1;for(let j=0;j<F.g.length;j++)if(F.g[j]!=0)return!1;return!0}function oe(F){return F.h==-1}s.l=function(F){return F=Ye(this,F),oe(F)?-1:te(F)?0:1};function ue(F){const j=F.g.length,V=[];for(let Z=0;Z<j;Z++)V[Z]=~F.g[Z];return new E(V,~F.h).add(P)}s.abs=function(){return oe(this)?ue(this):this},s.add=function(F){const j=Math.max(this.g.length,F.g.length),V=[];let Z=0;for(let q=0;q<=j;q++){let Y=Z+(this.i(q)&65535)+(F.i(q)&65535),H=(Y>>>16)+(this.i(q)>>>16)+(F.i(q)>>>16);Z=H>>>16,Y&=65535,H&=65535,V[q]=H<<16|Y}return new E(V,V[V.length-1]&-2147483648?-1:0)};function Ye(F,j){return F.add(ue(j))}s.j=function(F){if(te(this)||te(F))return N;if(oe(this))return oe(F)?ue(this).j(ue(F)):ue(ue(this).j(F));if(oe(F))return ue(this.j(ue(F)));if(this.l(X)<0&&F.l(X)<0)return _(this.m()*F.m());const j=this.g.length+F.g.length,V=[];for(var Z=0;Z<2*j;Z++)V[Z]=0;for(Z=0;Z<this.g.length;Z++)for(let q=0;q<F.g.length;q++){const Y=this.i(Z)>>>16,H=this.i(Z)&65535,rt=F.i(q)>>>16,ae=F.i(q)&65535;V[2*Z+2*q]+=H*ae,ke(V,2*Z+2*q),V[2*Z+2*q+1]+=Y*ae,ke(V,2*Z+2*q+1),V[2*Z+2*q+1]+=H*rt,ke(V,2*Z+2*q+1),V[2*Z+2*q+2]+=Y*rt,ke(V,2*Z+2*q+2)}for(F=0;F<j;F++)V[F]=V[2*F+1]<<16|V[2*F];for(F=j;F<2*j;F++)V[F]=0;return new E(V,0)};function ke(F,j){for(;(F[j]&65535)!=F[j];)F[j+1]+=F[j]>>>16,F[j]&=65535,j++}function de(F,j){this.g=F,this.h=j}function Pe(F,j){if(te(j))throw Error("division by zero");if(te(F))return new de(N,N);if(oe(F))return j=Pe(ue(F),j),new de(ue(j.g),ue(j.h));if(oe(j))return j=Pe(F,ue(j)),new de(ue(j.g),j.h);if(F.g.length>30){if(oe(F)||oe(j))throw Error("slowDivide_ only works with positive integers.");for(var V=P,Z=j;Z.l(F)<=0;)V=ft(V),Z=ft(Z);var q=qe(V,1),Y=qe(Z,1);for(Z=qe(Z,2),V=qe(V,2);!te(Z);){var H=Y.add(Z);H.l(F)<=0&&(q=q.add(V),Y=H),Z=qe(Z,1),V=qe(V,1)}return j=Ye(F,q.j(j)),new de(q,j)}for(q=N;F.l(j)>=0;){for(V=Math.max(1,Math.floor(F.m()/j.m())),Z=Math.ceil(Math.log(V)/Math.LN2),Z=Z<=48?1:Math.pow(2,Z-48),Y=_(V),H=Y.j(j);oe(H)||H.l(F)>0;)V-=Z,Y=_(V),H=Y.j(j);te(Y)&&(Y=P),q=q.add(Y),F=Ye(F,H)}return new de(q,F)}s.B=function(F){return Pe(this,F).h},s.and=function(F){const j=Math.max(this.g.length,F.g.length),V=[];for(let Z=0;Z<j;Z++)V[Z]=this.i(Z)&F.i(Z);return new E(V,this.h&F.h)},s.or=function(F){const j=Math.max(this.g.length,F.g.length),V=[];for(let Z=0;Z<j;Z++)V[Z]=this.i(Z)|F.i(Z);return new E(V,this.h|F.h)},s.xor=function(F){const j=Math.max(this.g.length,F.g.length),V=[];for(let Z=0;Z<j;Z++)V[Z]=this.i(Z)^F.i(Z);return new E(V,this.h^F.h)};function ft(F){const j=F.g.length+1,V=[];for(let Z=0;Z<j;Z++)V[Z]=F.i(Z)<<1|F.i(Z-1)>>>31;return new E(V,F.h)}function qe(F,j){const V=j>>5;j%=32;const Z=F.g.length-V,q=[];for(let Y=0;Y<Z;Y++)q[Y]=j>0?F.i(Y+V)>>>j|F.i(Y+V+1)<<32-j:F.i(Y+V);return new E(q,F.h)}o.prototype.digest=o.prototype.A,o.prototype.reset=o.prototype.u,o.prototype.update=o.prototype.v,o_=o,E.prototype.add=E.prototype.add,E.prototype.multiply=E.prototype.j,E.prototype.modulo=E.prototype.B,E.prototype.compare=E.prototype.l,E.prototype.toNumber=E.prototype.m,E.prototype.toString=E.prototype.toString,E.prototype.getBits=E.prototype.i,E.fromNumber=_,E.fromString=S,Ao=E}).apply(typeof Ky<"u"?Ky:typeof self<"u"?self:typeof window<"u"?window:{});var Qh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var l_,au,c_,lf,k1,u_,h_,f_;(function(){var s,e=Object.defineProperty;function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qh=="object"&&Qh];for(var C=0;C<p.length;++C){var O=p[C];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var o=n(this);function h(p,C){if(C)e:{var O=o;p=p.split(".");for(var U=0;U<p.length-1;U++){var ie=p[U];if(!(ie in O))break e;O=O[ie]}p=p[p.length-1],U=O[p],C=C(U),C!=U&&C!=null&&e(O,p,{configurable:!0,writable:!0,value:C})}}h("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),h("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),h("Object.entries",function(p){return p||function(C){var O=[],U;for(U in C)Object.prototype.hasOwnProperty.call(C,U)&&O.push([U,C[U]]);return O}});var g=g||{},E=this||self;function v(p){var C=typeof p;return C=="object"&&p!=null||C=="function"}function b(p,C,O){return p.call.apply(p.bind,arguments)}function _(p,C,O){return _=b,_.apply(null,arguments)}function S(p,C){var O=Array.prototype.slice.call(arguments,1);return function(){var U=O.slice();return U.push.apply(U,arguments),p.apply(this,U)}}function N(p,C){function O(){}O.prototype=C.prototype,p.Z=C.prototype,p.prototype=new O,p.prototype.constructor=p,p.Ob=function(U,ie,Ee){for(var Fe=Array(arguments.length-2),Pt=2;Pt<arguments.length;Pt++)Fe[Pt-2]=arguments[Pt];return C.prototype[ie].apply(U,Fe)}}var P=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function X(p){const C=p.length;if(C>0){const O=Array(C);for(let U=0;U<C;U++)O[U]=p[U];return O}return[]}function te(p,C){for(let U=1;U<arguments.length;U++){const ie=arguments[U];var O=typeof ie;if(O=O!="object"?O:ie?Array.isArray(ie)?"array":O:"null",O=="array"||O=="object"&&typeof ie.length=="number"){O=p.length||0;const Ee=ie.length||0;p.length=O+Ee;for(let Fe=0;Fe<Ee;Fe++)p[O+Fe]=ie[Fe]}else p.push(ie)}}class oe{constructor(C,O){this.i=C,this.j=O,this.h=0,this.g=null}get(){let C;return this.h>0?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function ue(p){E.setTimeout(()=>{throw p},0)}function Ye(){var p=F;let C=null;return p.g&&(C=p.g,p.g=p.g.next,p.g||(p.h=null),C.next=null),C}class ke{constructor(){this.h=this.g=null}add(C,O){const U=de.get();U.set(C,O),this.h?this.h.next=U:this.g=U,this.h=U}}var de=new oe(()=>new Pe,p=>p.reset());class Pe{constructor(){this.next=this.g=this.h=null}set(C,O){this.h=C,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let ft,qe=!1,F=new ke,j=()=>{const p=Promise.resolve(void 0);ft=()=>{p.then(V)}};function V(){for(var p;p=Ye();){try{p.h.call(p.g)}catch(O){ue(O)}var C=de;C.j(p),C.h<100&&(C.h++,p.next=C.g,C.g=p)}qe=!1}function Z(){this.u=this.u,this.C=this.C}Z.prototype.u=!1,Z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},Z.prototype[Symbol.dispose]=function(){this.dispose()},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(p,C){this.type=p,this.g=this.target=C,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var Y=(function(){if(!E.addEventListener||!Object.defineProperty)return!1;var p=!1,C=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const O=()=>{};E.addEventListener("test",O,C),E.removeEventListener("test",O,C)}catch{}return p})();function H(p){return/^[\s\xa0]*$/.test(p)}function rt(p,C){q.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,C)}N(rt,q),rt.prototype.init=function(p,C){const O=this.type=p.type,U=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=C,C=p.relatedTarget,C||(O=="mouseover"?C=p.fromElement:O=="mouseout"&&(C=p.toElement)),this.relatedTarget=C,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&rt.Z.h.call(this)},rt.prototype.h=function(){rt.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var ae="closure_listenable_"+(Math.random()*1e6|0),ce=0;function ne(p,C,O,U,ie){this.listener=p,this.proxy=null,this.src=C,this.type=O,this.capture=!!U,this.ha=ie,this.key=++ce,this.da=this.fa=!1}function ze(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function pt(p,C,O){for(const U in p)C.call(O,p[U],U,p)}function ct(p,C){for(const O in p)C.call(void 0,p[O],O,p)}function K(p){const C={};for(const O in p)C[O]=p[O];return C}const pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function De(p,C){let O,U;for(let ie=1;ie<arguments.length;ie++){U=arguments[ie];for(O in U)p[O]=U[O];for(let Ee=0;Ee<pe.length;Ee++)O=pe[Ee],Object.prototype.hasOwnProperty.call(U,O)&&(p[O]=U[O])}}function Ve(p){this.src=p,this.g={},this.h=0}Ve.prototype.add=function(p,C,O,U,ie){const Ee=p.toString();p=this.g[Ee],p||(p=this.g[Ee]=[],this.h++);const Fe=we(p,C,U,ie);return Fe>-1?(C=p[Fe],O||(C.fa=!1)):(C=new ne(C,this.src,Ee,!!U,ie),C.fa=O,p.push(C)),C};function Le(p,C){const O=C.type;if(O in p.g){var U=p.g[O],ie=Array.prototype.indexOf.call(U,C,void 0),Ee;(Ee=ie>=0)&&Array.prototype.splice.call(U,ie,1),Ee&&(ze(C),p.g[O].length==0&&(delete p.g[O],p.h--))}}function we(p,C,O,U){for(let ie=0;ie<p.length;++ie){const Ee=p[ie];if(!Ee.da&&Ee.listener==C&&Ee.capture==!!O&&Ee.ha==U)return ie}return-1}var ut="closure_lm_"+(Math.random()*1e6|0),xt={};function Mt(p,C,O,U,ie){if(Array.isArray(C)){for(let Ee=0;Ee<C.length;Ee++)Mt(p,C[Ee],O,U,ie);return null}return O=ht(O),p&&p[ae]?p.J(C,O,v(U)?!!U.capture:!1,ie):Mn(p,C,O,!1,U,ie)}function Mn(p,C,O,U,ie,Ee){if(!C)throw Error("Invalid event type");const Fe=v(ie)?!!ie.capture:!!ie;let Pt=Ct(p);if(Pt||(p[ut]=Pt=new Ve(p)),O=Pt.add(C,O,U,Fe,Ee),O.proxy)return O;if(U=Ie(),O.proxy=U,U.src=p,U.listener=O,p.addEventListener)Y||(ie=Fe),ie===void 0&&(ie=!1),p.addEventListener(C.toString(),U,ie);else if(p.attachEvent)p.attachEvent(bt(C.toString()),U);else if(p.addListener&&p.removeListener)p.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return O}function Ie(){function p(O){return C.call(p.src,p.listener,O)}const C=yt;return p}function $e(p,C,O,U,ie){if(Array.isArray(C))for(var Ee=0;Ee<C.length;Ee++)$e(p,C[Ee],O,U,ie);else U=v(U)?!!U.capture:!!U,O=ht(O),p&&p[ae]?(p=p.i,Ee=String(C).toString(),Ee in p.g&&(C=p.g[Ee],O=we(C,O,U,ie),O>-1&&(ze(C[O]),Array.prototype.splice.call(C,O,1),C.length==0&&(delete p.g[Ee],p.h--)))):p&&(p=Ct(p))&&(C=p.g[C.toString()],p=-1,C&&(p=we(C,O,U,ie)),(O=p>-1?C[p]:null)&&He(O))}function He(p){if(typeof p!="number"&&p&&!p.da){var C=p.src;if(C&&C[ae])Le(C.i,p);else{var O=p.type,U=p.proxy;C.removeEventListener?C.removeEventListener(O,U,p.capture):C.detachEvent?C.detachEvent(bt(O),U):C.addListener&&C.removeListener&&C.removeListener(U),(O=Ct(C))?(Le(O,p),O.h==0&&(O.src=null,C[ut]=null)):ze(p)}}}function bt(p){return p in xt?xt[p]:xt[p]="on"+p}function yt(p,C){if(p.da)p=!0;else{C=new rt(C,this);const O=p.listener,U=p.ha||p.src;p.fa&&He(p),p=O.call(U,C)}return p}function Ct(p){return p=p[ut],p instanceof Ve?p:null}var gt="__closure_events_fn_"+(Math.random()*1e9>>>0);function ht(p){return typeof p=="function"?p:(p[gt]||(p[gt]=function(C){return p.handleEvent(C)}),p[gt])}function Qe(){Z.call(this),this.i=new Ve(this),this.M=this,this.G=null}N(Qe,Z),Qe.prototype[ae]=!0,Qe.prototype.removeEventListener=function(p,C,O,U){$e(this,p,C,O,U)};function en(p,C){var O,U=p.G;if(U)for(O=[];U;U=U.G)O.push(U);if(p=p.M,U=C.type||C,typeof C=="string")C=new q(C,p);else if(C instanceof q)C.target=C.target||p;else{var ie=C;C=new q(U,p),De(C,ie)}ie=!0;let Ee,Fe;if(O)for(Fe=O.length-1;Fe>=0;Fe--)Ee=C.g=O[Fe],ie=Xe(Ee,U,!0,C)&&ie;if(Ee=C.g=p,ie=Xe(Ee,U,!0,C)&&ie,ie=Xe(Ee,U,!1,C)&&ie,O)for(Fe=0;Fe<O.length;Fe++)Ee=C.g=O[Fe],ie=Xe(Ee,U,!1,C)&&ie}Qe.prototype.N=function(){if(Qe.Z.N.call(this),this.i){var p=this.i;for(const C in p.g){const O=p.g[C];for(let U=0;U<O.length;U++)ze(O[U]);delete p.g[C],p.h--}}this.G=null},Qe.prototype.J=function(p,C,O,U){return this.i.add(String(p),C,!1,O,U)},Qe.prototype.K=function(p,C,O,U){return this.i.add(String(p),C,!0,O,U)};function Xe(p,C,O,U){if(C=p.i.g[String(C)],!C)return!0;C=C.concat();let ie=!0;for(let Ee=0;Ee<C.length;++Ee){const Fe=C[Ee];if(Fe&&!Fe.da&&Fe.capture==O){const Pt=Fe.listener,ir=Fe.ha||Fe.src;Fe.fa&&Le(p.i,Fe),ie=Pt.call(ir,U)!==!1&&ie}}return ie&&!U.defaultPrevented}function Ur(p,C){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=_(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(C)>2147483647?-1:E.setTimeout(p,C||0)}function St(p){p.g=Ur(()=>{p.g=null,p.i&&(p.i=!1,St(p))},p.l);const C=p.h;p.h=null,p.m.apply(null,C)}class Tt extends Z{constructor(C,O){super(),this.m=C,this.l=O,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:St(this)}N(){super.N(),this.g&&(E.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ae(p){Z.call(this),this.h=p,this.g={}}N(Ae,Z);var Re=[];function Ge(p){pt(p.g,function(C,O){this.g.hasOwnProperty(O)&&He(C)},p),p.g={}}Ae.prototype.N=function(){Ae.Z.N.call(this),Ge(this)},Ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Je=E.JSON.stringify,nt=E.JSON.parse,kn=class{stringify(p){return E.JSON.stringify(p,void 0)}parse(p){return E.JSON.parse(p,void 0)}};function st(){}function Xt(){}var et={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Te(){q.call(this,"d")}N(Te,q);function kt(){q.call(this,"c")}N(kt,q);var mt={},Yt=null;function Xn(){return Yt=Yt||new Qe}mt.Ia="serverreachability";function ri(p){q.call(this,mt.Ia,p)}N(ri,q);function Er(p){const C=Xn();en(C,new ri(C))}mt.STAT_EVENT="statevent";function Bt(p,C){q.call(this,mt.STAT_EVENT,p),this.stat=C}N(Bt,q);function An(p){const C=Xn();en(C,new Bt(C,p))}mt.Ja="timingevent";function mi(p,C){q.call(this,mt.Ja,p),this.size=C}N(mi,q);function Gr(p,C){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return E.setTimeout(function(){p()},C)}function Yn(){this.g=!0}Yn.prototype.ua=function(){this.g=!1};function Js(p,C,O,U,ie,Ee){p.info(function(){if(p.g)if(Ee){var Fe="",Pt=Ee.split("&");for(let mn=0;mn<Pt.length;mn++){var ir=Pt[mn].split("=");if(ir.length>1){const jn=ir[0];ir=ir[1];const xi=jn.split("_");Fe=xi.length>=2&&xi[1]=="type"?Fe+(jn+"="+ir+"&"):Fe+(jn+"=redacted&")}}}else Fe=null;else Fe=Ee;return"XMLHTTP REQ ("+U+") [attempt "+ie+"]: "+C+`
`+O+`
`+Fe})}function ar(p,C,O,U,ie,Ee,Fe){p.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+ie+"]: "+C+`
`+O+`
`+Ee+" "+Fe})}function Mr(p,C,O,U){p.info(function(){return"XMLHTTP TEXT ("+C+"): "+ii(p,O)+(U?" "+U:"")})}function vi(p,C){p.info(function(){return"TIMEOUT: "+C})}Yn.prototype.info=function(){};function ii(p,C){if(!p.g)return C;if(!C)return null;try{const Ee=JSON.parse(C);if(Ee){for(p=0;p<Ee.length;p++)if(Array.isArray(Ee[p])){var O=Ee[p];if(!(O.length<2)){var U=O[1];if(Array.isArray(U)&&!(U.length<1)){var ie=U[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let Fe=1;Fe<U.length;Fe++)U[Fe]=""}}}}return Je(Ee)}catch{return C}}var ys={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Es;function $n(){}N($n,st),$n.prototype.g=function(){return new XMLHttpRequest},Es=new $n;function kr(p){return encodeURIComponent(String(p))}function Lr(p){var C=1;p=p.split(":");const O=[];for(;C>0&&p.length;)O.push(p.shift()),C--;return p.length&&O.push(p.join(":")),O}function We(p,C,O,U){this.j=p,this.i=C,this.l=O,this.S=U||1,this.V=new Ae(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Tr}function Tr(){this.i=null,this.g="",this.h=!1}var Hn={},gn={};function ee(p,C,O){p.M=1,p.A=si(tr(C)),p.u=O,p.R=!0,je(p,null)}function je(p,C){p.F=Date.now(),Gt(p),p.B=tr(p.A);var O=p.B,U=p.S;Array.isArray(U)||(U=[String(U)]),Cn(O.i,"t",U),p.C=0,O=p.j.L,p.h=new Tr,p.g=Fa(p.j,O?C:null,!p.u),p.P>0&&(p.O=new Tt(_(p.Y,p,p.g),p.P)),C=p.V,O=p.g,U=p.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(Re[0]=ie.toString()),ie=Re);for(let Ee=0;Ee<ie.length;Ee++){const Fe=Mt(O,ie[Ee],U||C.handleEvent,!1,C.h||C);if(!Fe)break;C.g[Fe.key]=Fe}C=p.J?K(p.J):{},p.u?(p.v||(p.v="POST"),C["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,C)):(p.v="GET",p.g.ea(p.B,p.v,null,C)),Er(),Js(p.i,p.v,p.B,p.l,p.S,p.u)}We.prototype.ba=function(p){p=p.target;const C=this.O;C&&Ii(p)==3?C.j():this.Y(p)},We.prototype.Y=function(p){try{if(p==this.g)e:{const Pt=Ii(this.g),ir=this.g.ya(),mn=this.g.ca();if(!(Pt<3)&&(Pt!=3||this.g&&(this.h.h||this.g.la()||cr(this.g)))){this.K||Pt!=4||ir==7||(ir==8||mn<=0?Er(3):Er(2)),yn(this);var C=this.g.ca();this.X=C;var O=tt(this);if(this.o=C==200,ar(this.i,this.v,this.B,this.l,this.S,Pt,C),this.o){if(this.U&&!this.L){t:{if(this.g){var U,ie=this.g;if((U=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(U)){var Ee=U;break t}}Ee=null}if(p=Ee)Mr(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Wn(this,p);else{this.o=!1,this.m=3,An(12),hr(this),Lt(this);break e}}if(this.R){p=!0;let jn;for(;!this.K&&this.C<O.length;)if(jn=Vt(this,O),jn==gn){Pt==4&&(this.m=4,An(14),p=!1),Mr(this.i,this.l,null,"[Incomplete Response]");break}else if(jn==Hn){this.m=4,An(15),Mr(this.i,this.l,O,"[Invalid Chunk]"),p=!1;break}else Mr(this.i,this.l,jn,null),Wn(this,jn);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pt!=4||O.length!=0||this.h.h||(this.m=1,An(16),p=!1),this.o=this.o&&p,!p)Mr(this.i,this.l,O,"[Invalid Chunked Response]"),hr(this),Lt(this);else if(O.length>0&&!this.W){this.W=!0;var Fe=this.j;Fe.g==this&&Fe.aa&&!Fe.P&&(Fe.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),me(Fe),Fe.P=!0,An(11))}}else Mr(this.i,this.l,O,null),Wn(this,O);Pt==4&&hr(this),this.o&&!this.K&&(Pt==4?ia(this.j,this):(this.o=!1,Gt(this)))}else Ei(this.g),C==400&&O.indexOf("Unknown SID")>0?(this.m=3,An(12)):(this.m=0,An(13)),hr(this),Lt(this)}}}catch{}finally{}};function tt(p){if(!Ke(p))return p.g.la();const C=cr(p.g);if(C==="")return"";let O="";const U=C.length,ie=Ii(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return hr(p),Lt(p),"";p.h.i=new E.TextDecoder}for(let Ee=0;Ee<U;Ee++)p.h.h=!0,O+=p.h.i.decode(C[Ee],{stream:!(ie&&Ee==U-1)});return C.length=0,p.h.g+=O,p.C=0,p.h.g}function Ke(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Vt(p,C){var O=p.C,U=C.indexOf(`
`,O);return U==-1?gn:(O=Number(C.substring(O,U)),isNaN(O)?Hn:(U+=1,U+O>C.length?gn:(C=C.slice(U,U+O),p.C=U+O,C)))}We.prototype.cancel=function(){this.K=!0,hr(this)};function Gt(p){p.T=Date.now()+p.H,Ln(p,p.H)}function Ln(p,C){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Gr(_(p.aa,p),C)}function yn(p){p.D&&(E.clearTimeout(p.D),p.D=null)}We.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(vi(this.i,this.B),this.M!=2&&(Er(),An(17)),hr(this),this.m=2,Lt(this)):Ln(this,this.T-p)};function Lt(p){p.j.I==0||p.K||ia(p.j,p)}function hr(p){yn(p);var C=p.O;C&&typeof C.dispose=="function"&&C.dispose(),p.O=null,Ge(p.V),p.g&&(C=p.g,p.g=null,C.abort(),C.dispose())}function Wn(p,C){try{var O=p.j;if(O.I!=0&&(O.g==p||qr(O.h,p))){if(!p.L&&qr(O.h,p)&&O.I==3){try{var U=O.Ba.g.parse(C)}catch{U=null}if(Array.isArray(U)&&U.length==3){var ie=U;if(ie[0]==0){e:if(!O.v){if(O.g)if(O.g.F+3e3<p.F)nr(O),As(O);else break e;ra(O),An(18)}}else O.xa=ie[1],0<O.xa-O.K&&ie[2]<37500&&O.F&&O.A==0&&!O.C&&(O.C=Gr(_(O.Va,O),6e3));_n(O.h)<=1&&O.ta&&(O.ta=void 0)}else rs(O,11)}else if((p.L||O.g==p)&&nr(O),!H(C))for(ie=O.Ba.g.parse(C),C=0;C<ie.length;C++){let mn=ie[C];const jn=mn[0];if(!(jn<=O.K))if(O.K=jn,mn=mn[1],O.I==2)if(mn[0]=="c"){O.M=mn[1],O.ba=mn[2];const xi=mn[3];xi!=null&&(O.ka=xi,O.j.info("VER="+O.ka));const as=mn[4];as!=null&&(O.za=as,O.j.info("SVER="+O.za));const jr=mn[5];jr!=null&&typeof jr=="number"&&jr>0&&(U=1.5*jr,O.O=U,O.j.info("backChannelRequestTimeoutMs_="+U)),U=O;const _i=p.g;if(_i){const aa=_i.g?_i.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(aa){var Ee=U.h;Ee.g||aa.indexOf("spdy")==-1&&aa.indexOf("quic")==-1&&aa.indexOf("h2")==-1||(Ee.j=Ee.l,Ee.g=new Set,Ee.h&&(Po(Ee,Ee.h),Ee.h=null))}if(U.G){const os=_i.g?_i.g.getResponseHeader("X-HTTP-Session-Id"):null;os&&(U.wa=os,It(U.J,U.G,os))}}O.I=3,O.l&&O.l.ra(),O.aa&&(O.T=Date.now()-p.F,O.j.info("Handshake RTT: "+O.T+"ms")),U=O;var Fe=p;if(U.na=_l(U,U.L?U.ba:null,U.W),Fe.L){on(U.h,Fe);var Pt=Fe,ir=U.O;ir&&(Pt.H=ir),Pt.D&&(yn(Pt),Gt(Pt)),U.g=Fe}else Hi(U);O.i.length>0&&ns(O)}else mn[0]!="stop"&&mn[0]!="close"||rs(O,7);else O.I==3&&(mn[0]=="stop"||mn[0]=="close"?mn[0]=="stop"?rs(O,7):Ba(O):mn[0]!="noop"&&O.l&&O.l.qa(mn),O.A=0)}}Er(4)}catch{}}var er=class{constructor(p,C){this.g=p,this.map=C}};function Ne(p){this.l=p||10,E.PerformanceNavigationTiming?(p=E.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(E.chrome&&E.chrome.loadTimes&&E.chrome.loadTimes()&&E.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Lo(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function _n(p){return p.h?1:p.g?p.g.size:0}function qr(p,C){return p.h?p.h==C:p.g?p.g.has(C):!1}function Po(p,C){p.g?p.g.add(C):p.h=C}function on(p,C){p.h&&p.h==C?p.h=null:p.g&&p.g.has(C)&&p.g.delete(C)}Ne.prototype.cancel=function(){if(this.i=tn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function tn(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let C=p.i;for(const O of p.g.values())C=C.concat(O.G);return C}return X(p.i)}var Qt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Rs(p,C){if(p){p=p.split("&");for(let O=0;O<p.length;O++){const U=p[O].indexOf("=");let ie,Ee=null;U>=0?(ie=p[O].substring(0,U),Ee=p[O].substring(U+1)):ie=p[O],C(ie,Ee?decodeURIComponent(Ee.replace(/\+/g," ")):"")}}}function Xr(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let C;p instanceof Xr?(this.l=p.l,Jt(this,p.j),this.o=p.o,this.g=p.g,Yr(this,p.u),this.h=p.h,Bo(this,Vo(p.i)),this.m=p.m):p&&(C=String(p).match(Qt))?(this.l=!1,Jt(this,C[1]||"",!0),this.o=ts(C[2]||""),this.g=ts(C[3]||"",!0),Yr(this,C[4]),this.h=ts(C[5]||"",!0),Bo(this,C[6]||"",!0),this.m=ts(C[7]||"")):(this.l=!1,this.i=new xr(null,this.l))}Xr.prototype.toString=function(){const p=[];var C=this.j;C&&p.push(Ci(C,or,!0),":");var O=this.g;return(O||C=="file")&&(p.push("//"),(C=this.o)&&p.push(Ci(C,or,!0),"@"),p.push(kr(O).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.u,O!=null&&p.push(":",String(O))),(O=this.h)&&(this.g&&O.charAt(0)!="/"&&p.push("/"),p.push(Ci(O,O.charAt(0)=="/"?z:le,!0))),(O=this.i.toString())&&p.push("?",O),(O=this.m)&&p.push("#",Ci(O,lr)),p.join("")},Xr.prototype.resolve=function(p){const C=tr(this);let O=!!p.j;O?Jt(C,p.j):O=!!p.o,O?C.o=p.o:O=!!p.g,O?C.g=p.g:O=p.u!=null;var U=p.h;if(O)Yr(C,p.u);else if(O=!!p.h){if(U.charAt(0)!="/")if(this.g&&!this.h)U="/"+U;else{var ie=C.h.lastIndexOf("/");ie!=-1&&(U=C.h.slice(0,ie+1)+U)}if(ie=U,ie==".."||ie==".")U="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){U=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const Ee=[];for(let Fe=0;Fe<ie.length;){const Pt=ie[Fe++];Pt=="."?U&&Fe==ie.length&&Ee.push(""):Pt==".."?((Ee.length>1||Ee.length==1&&Ee[0]!="")&&Ee.pop(),U&&Fe==ie.length&&Ee.push("")):(Ee.push(Pt),U=!0)}U=Ee.join("/")}else U=ie}return O?C.h=U:O=p.i.toString()!=="",O?Bo(C,Vo(p.i)):O=!!p.m,O&&(C.m=p.m),C};function tr(p){return new Xr(p)}function Jt(p,C,O){p.j=O?ts(C,!0):C,p.j&&(p.j=p.j.replace(/:$/,""))}function Yr(p,C){if(C){if(C=Number(C),isNaN(C)||C<0)throw Error("Bad port number "+C);p.u=C}else p.u=null}function Bo(p,C,O){C instanceof xr?(p.i=C,Os(p.i,p.l)):(O||(C=Ci(C,ot)),p.i=new xr(C,p.l))}function It(p,C,O){p.i.set(C,O)}function si(p){return It(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function ts(p,C){return p?C?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Ci(p,C,O){return typeof p=="string"?(p=encodeURI(p).replace(C,Wt),O&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Wt(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var or=/[#\/\?@]/g,le=/[#\?:]/g,z=/[#\?]/g,ot=/[#\?@]/g,lr=/#/g;function xr(p,C){this.h=this.g=null,this.i=p||null,this.j=!!C}function ai(p){p.g||(p.g=new Map,p.h=0,p.i&&Rs(p.i,function(C,O){p.add(decodeURIComponent(C.replace(/\+/g," ")),O)}))}s=xr.prototype,s.add=function(p,C){ai(this),this.i=null,p=Ns(this,p);let O=this.g.get(p);return O||this.g.set(p,O=[]),O.push(C),this.h+=1,this};function Pa(p,C){ai(p),C=Ns(p,C),p.g.has(C)&&(p.i=null,p.h-=p.g.get(C).length,p.g.delete(C))}function Fr(p,C){return ai(p),C=Ns(p,C),p.g.has(C)}s.forEach=function(p,C){ai(this),this.g.forEach(function(O,U){O.forEach(function(ie){p.call(C,ie,U,this)},this)},this)};function Et(p,C){ai(p);let O=[];if(typeof C=="string")Fr(p,C)&&(O=O.concat(p.g.get(Ns(p,C))));else for(p=Array.from(p.g.values()),C=0;C<p.length;C++)O=O.concat(p[C]);return O}s.set=function(p,C){return ai(this),this.i=null,p=Ns(this,p),Fr(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[C]),this.h+=1,this},s.get=function(p,C){return p?(p=Et(this,p),p.length>0?String(p[0]):C):C};function Cn(p,C,O){Pa(p,C),O.length>0&&(p.i=null,p.g.set(Ns(p,C),X(O)),p.h+=O.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],C=Array.from(this.g.keys());for(let U=0;U<C.length;U++){var O=C[U];const ie=kr(O);O=Et(this,O);for(let Ee=0;Ee<O.length;Ee++){let Fe=ie;O[Ee]!==""&&(Fe+="="+kr(O[Ee])),p.push(Fe)}}return this.i=p.join("&")};function Vo(p){const C=new xr;return C.i=p.i,p.g&&(C.g=new Map(p.g),C.h=p.h),C}function Ns(p,C){return C=String(C),p.j&&(C=C.toLowerCase()),C}function Os(p,C){C&&!p.j&&(ai(p),p.i=null,p.g.forEach(function(O,U){const ie=U.toLowerCase();U!=ie&&(Pa(this,U),Cn(this,ie,O))},p)),p.j=C}function oi(p,C){const O=new Yn;if(E.Image){const U=new Image;U.onload=S(Si,O,"TestLoadImage: loaded",!0,C,U),U.onerror=S(Si,O,"TestLoadImage: error",!1,C,U),U.onabort=S(Si,O,"TestLoadImage: abort",!1,C,U),U.ontimeout=S(Si,O,"TestLoadImage: timeout",!1,C,U),E.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=p}else C(!1)}function $s(p,C){const O=new Yn,U=new AbortController,ie=setTimeout(()=>{U.abort(),Si(O,"TestPingServer: timeout",!1,C)},1e4);fetch(p,{signal:U.signal}).then(Ee=>{clearTimeout(ie),Ee.ok?Si(O,"TestPingServer: ok",!0,C):Si(O,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(ie),Si(O,"TestPingServer: error",!1,C)})}function Si(p,C,O,U,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),U(O)}catch{}}function Fn(){this.g=new kn}function li(p){this.i=p.Sb||null,this.h=p.ab||!1}N(li,st),li.prototype.g=function(){return new ci(this.i,this.h)};function ci(p,C){Qe.call(this),this.H=p,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}N(ci,Qe),s=ci.prototype,s.open=function(p,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=C,this.readyState=1,vt(this)},s.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const C={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(C.body=p),(this.H||E).fetch(new Request(this.D,C)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ds(this)),this.readyState=0},s.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,vt(this)),this.g&&(this.readyState=3,vt(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof E.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;_t(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function _t(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}s.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var C=p.value?p.value:new Uint8Array(0);(C=this.B.decode(C,{stream:!p.done}))&&(this.response=this.responseText+=C)}p.done?Ds(this):vt(this),this.readyState==3&&_t(this)}},s.Oa=function(p){this.g&&(this.response=this.responseText=p,Ds(this))},s.Na=function(p){this.g&&(this.response=p,Ds(this))},s.ga=function(){this.g&&Ds(this)};function Ds(p){p.readyState=4,p.l=null,p.j=null,p.B=null,vt(p)}s.setRequestHeader=function(p,C){this.A.append(p,C)},s.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],C=this.h.entries();for(var O=C.next();!O.done;)O=O.value,p.push(O[0]+": "+O[1]),O=C.next();return p.join(`\r
`)};function vt(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(ci.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Sn(p){let C="";return pt(p,function(O,U){C+=U,C+=":",C+=O,C+=`\r
`}),C}function ea(p,C,O){e:{for(U in O){var U=!1;break e}U=!0}U||(O=Sn(O),typeof p=="string"?O!=null&&kr(O):It(p,C,O))}function wn(p){Qe.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}N(wn,Qe);var Fi=/^https?$/i,ji=["POST","PUT"];s=wn.prototype,s.Fa=function(p){this.H=p},s.ea=function(p,C,O,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);C=C?C.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Es.g(),this.g.onreadystatechange=P(_(this.Ca,this));try{this.B=!0,this.g.open(C,String(p),!0),this.B=!1}catch(Ee){ta(this,Ee);return}if(p=O||"",O=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var ie in U)O.set(ie,U[ie]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const Ee of U.keys())O.set(Ee,U.get(Ee));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(O.keys()).find(Ee=>Ee.toLowerCase()=="content-type"),ie=E.FormData&&p instanceof E.FormData,!(Array.prototype.indexOf.call(ji,C,void 0)>=0)||U||ie||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ee,Fe]of O)this.g.setRequestHeader(Ee,Fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Ee){ta(this,Ee)}};function ta(p,C){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=C,p.o=5,xs(p),yi(p)}function xs(p){p.A||(p.A=!0,en(p,"complete"),en(p,"error"))}s.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,en(this,"complete"),en(this,"abort"),yi(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yi(this,!0)),wn.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?zi(this):this.Xa())},s.Xa=function(){zi(this)};function zi(p){if(p.h&&typeof g<"u"){if(p.v&&Ii(p)==4)setTimeout(p.Ca.bind(p),0);else if(en(p,"readystatechange"),Ii(p)==4){p.h=!1;try{const Ee=p.ca();e:switch(Ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var O;if(!(O=C)){var U;if(U=Ee===0){let Fe=String(p.D).match(Qt)[1]||null;!Fe&&E.self&&E.self.location&&(Fe=E.self.location.protocol.slice(0,-1)),U=!Fi.test(Fe?Fe.toLowerCase():"")}O=U}if(O)en(p,"complete"),en(p,"success");else{p.o=6;try{var ie=Ii(p)>2?p.g.statusText:""}catch{ie=""}p.l=ie+" ["+p.ca()+"]",xs(p)}}finally{yi(p)}}}}function yi(p,C){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const O=p.g;p.g=null,C||en(p,"ready");try{O.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Ii(p){return p.g?p.g.readyState:0}s.ca=function(){try{return Ii(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(p){if(this.g){var C=this.g.responseText;return p&&C.indexOf(p)==0&&(C=C.substring(p.length)),nt(C)}};function cr(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Ei(p){const C={};p=(p.g&&Ii(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<p.length;U++){if(H(p[U]))continue;var O=Lr(p[U]);const ie=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const Ee=C[ie]||[];C[ie]=Ee,Ee.push(O)}ct(C,function(U){return U.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kn(p,C,O){return O&&O.internalChannelParams&&O.internalChannelParams[p]||C}function _s(p){this.za=0,this.i=[],this.j=new Yn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Kn("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Kn("baseRetryDelayMs",5e3,p),this.Za=Kn("retryDelaySeedMs",1e4,p),this.Ta=Kn("forwardChannelMaxRetries",2,p),this.va=Kn("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Ne(p&&p.concurrentRequestLimit),this.Ba=new Fn,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=_s.prototype,s.ka=8,s.I=1,s.connect=function(p,C,O,U){An(0),this.W=p,this.H=C||{},O&&U!==void 0&&(this.H.OSID=O,this.H.OAID=U),this.F=this.X,this.J=_l(this,null,this.W),ns(this)};function Ba(p){if(Va(p),p.I==3){var C=p.V++,O=tr(p.J);if(It(O,"SID",p.M),It(O,"RID",C),It(O,"TYPE","terminate"),Ms(p,O),C=new We(p,p.j,C),C.M=2,C.A=si(tr(O)),O=!1,E.navigator&&E.navigator.sendBeacon)try{O=E.navigator.sendBeacon(C.A.toString(),"")}catch{}!O&&E.Image&&(new Image().src=C.A,O=!0),O||(C.g=Fa(C.j,null),C.g.ea(C.A)),C.F=Date.now(),Gt(C)}xl(p)}function As(p){p.g&&(me(p),p.g.cancel(),p.g=null)}function Va(p){As(p),p.v&&(E.clearTimeout(p.v),p.v=null),nr(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&E.clearTimeout(p.m),p.m=null)}function ns(p){if(!Lo(p.h)&&!p.m){p.m=!0;var C=p.Ea;ft||j(),qe||(ft(),qe=!0),F.add(C,p),p.D=0}}function Ua(p,C){return _n(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=C.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Gr(_(p.Ea,p,C),Uo(p,p.D)),p.D++,!0)}s.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ie=new We(this,this.j,p);let Ee=this.o;if(this.U&&(Ee?(Ee=K(Ee),De(Ee,this.U)):Ee=this.U),this.u!==null||this.R||(ie.J=Ee,Ee=null),this.S)e:{for(var C=0,O=0;O<this.i.length;O++){t:{var U=this.i[O];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(C+=U,C>4096){C=O;break e}if(C===4096||O===this.i.length-1){C=O+1;break e}}C=1e3}else C=1e3;C=na(this,ie,C),O=tr(this.J),It(O,"RID",p),It(O,"CVER",22),this.G&&It(O,"X-HTTP-Session-Id",this.G),Ms(this,O),Ee&&(this.R?C="headers="+kr(Sn(Ee))+"&"+C:this.u&&ea(O,this.u,Ee)),Po(this.h,ie),this.Ra&&It(O,"TYPE","init"),this.S?(It(O,"$req",C),It(O,"SID","null"),ie.U=!0,ee(ie,O,null)):ee(ie,O,C),this.I=2}}else this.I==3&&(p?En(this,p):this.i.length==0||Lo(this.h)||En(this))};function En(p,C){var O;C?O=C.l:O=p.V++;const U=tr(p.J);It(U,"SID",p.M),It(U,"RID",O),It(U,"AID",p.K),Ms(p,U),p.u&&p.o&&ea(U,p.u,p.o),O=new We(p,p.j,O,p.D+1),p.u===null&&(O.J=p.o),C&&(p.i=C.G.concat(p.i)),C=na(p,O,1e3),O.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Po(p.h,O),ee(O,U,C)}function Ms(p,C){p.H&&pt(p.H,function(O,U){It(C,U,O)}),p.l&&pt({},function(O,U){It(C,U,O)})}function na(p,C,O){O=Math.min(p.i.length,O);const U=p.l?_(p.l.Ka,p.l,p):null;e:{var ie=p.i;let Pt=-1;for(;;){const ir=["count="+O];Pt==-1?O>0?(Pt=ie[0].g,ir.push("ofs="+Pt)):Pt=0:ir.push("ofs="+Pt);let mn=!0;for(let jn=0;jn<O;jn++){var Ee=ie[jn].g;const xi=ie[jn].map;if(Ee-=Pt,Ee<0)Pt=Math.max(0,ie[jn].g-100),mn=!1;else try{Ee="req"+Ee+"_"||"";try{var Fe=xi instanceof Map?xi:Object.entries(xi);for(const[as,jr]of Fe){let _i=jr;v(jr)&&(_i=Je(jr)),ir.push(Ee+as+"="+encodeURIComponent(_i))}}catch(as){throw ir.push(Ee+"type="+encodeURIComponent("_badmap")),as}}catch{U&&U(xi)}}if(mn){Fe=ir.join("&");break e}}Fe=void 0}return p=p.i.splice(0,O),C.G=p,Fe}function Hi(p){if(!p.g&&!p.v){p.Y=1;var C=p.Da;ft||j(),qe||(ft(),qe=!0),F.add(C,p),p.A=0}}function ra(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Gr(_(p.Da,p),Uo(p,p.A)),p.A++,!0)}s.Da=function(){if(this.v=null,jt(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Gr(_(this.Wa,this),p)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,An(10),As(this),jt(this))};function me(p){p.B!=null&&(E.clearTimeout(p.B),p.B=null)}function jt(p){p.g=new We(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var C=tr(p.na);It(C,"RID","rpc"),It(C,"SID",p.M),It(C,"AID",p.K),It(C,"CI",p.F?"0":"1"),!p.F&&p.ia&&It(C,"TO",p.ia),It(C,"TYPE","xmlhttp"),Ms(p,C),p.u&&p.o&&ea(C,p.u,p.o),p.O&&(p.g.H=p.O);var O=p.g;p=p.ba,O.M=1,O.A=si(tr(C)),O.u=null,O.R=!0,je(O,p)}s.Va=function(){this.C!=null&&(this.C=null,As(this),ra(this),An(19))};function nr(p){p.C!=null&&(E.clearTimeout(p.C),p.C=null)}function ia(p,C){var O=null;if(p.g==C){nr(p),me(p),p.g=null;var U=2}else if(qr(p.h,C))O=C.G,on(p.h,C),U=1;else return;if(p.I!=0){if(C.o)if(U==1){O=C.u?C.u.length:0,C=Date.now()-C.F;var ie=p.D;U=Xn(),en(U,new mi(U,O)),ns(p)}else Hi(p);else if(ie=C.m,ie==3||ie==0&&C.X>0||!(U==1&&Ua(p,C)||U==2&&ra(p)))switch(O&&O.length>0&&(C=p.h,C.i=C.i.concat(O)),ie){case 1:rs(p,5);break;case 4:rs(p,10);break;case 3:rs(p,6);break;default:rs(p,2)}}}function Uo(p,C){let O=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(O*=2),O*C}function rs(p,C){if(p.j.info("Error code "+C),C==2){var O=_(p.bb,p),U=p.Ua;const ie=!U;U=new Xr(U||"//www.google.com/images/cleardot.gif"),E.location&&E.location.protocol=="http"||Jt(U,"https"),si(U),ie?oi(U.toString(),O):$s(U.toString(),O)}else An(2);p.I=0,p.l&&p.l.pa(C),xl(p),Va(p)}s.bb=function(p){p?(this.j.info("Successfully pinged google.com"),An(2)):(this.j.info("Failed to ping google.com"),An(1))};function xl(p){if(p.I=0,p.ja=[],p.l){const C=tn(p.h);(C.length!=0||p.i.length!=0)&&(te(p.ja,C),te(p.ja,p.i),p.h.i.length=0,X(p.i),p.i.length=0),p.l.oa()}}function _l(p,C,O){var U=O instanceof Xr?tr(O):new Xr(O);if(U.g!="")C&&(U.g=C+"."+U.g),Yr(U,U.u);else{var ie=E.location;U=ie.protocol,C=C?C+"."+ie.hostname:ie.hostname,ie=+ie.port;const Ee=new Xr(null);U&&Jt(Ee,U),C&&(Ee.g=C),ie&&Yr(Ee,ie),O&&(Ee.h=O),U=Ee}return O=p.G,C=p.wa,O&&C&&It(U,O,C),It(U,"VER",p.ka),Ms(p,U),U}function Fa(p,C,O){if(C&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return C=p.Aa&&!p.ma?new wn(new li({ab:O})):new wn(p.ma),C.Fa(p.L),C}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function rr(){}s=rr.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function is(){}is.prototype.g=function(p,C){return new $t(p,C)};function $t(p,C){Qe.call(this),this.g=new _s(C),this.l=p,this.h=C&&C.messageUrlParams||null,p=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(p?p["X-WebChannel-Content-Type"]=C.messageContentType:p={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.sa&&(p?p["X-WebChannel-Client-Profile"]=C.sa:p={"X-WebChannel-Client-Profile":C.sa}),this.g.U=p,(p=C&&C.Qb)&&!H(p)&&(this.g.u=p),this.A=C&&C.supportsCrossDomainXhr||!1,this.v=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!H(C)&&(this.g.G=C,p=this.h,p!==null&&C in p&&(p=this.h,C in p&&delete p[C])),this.j=new nn(this)}N($t,Qe),$t.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},$t.prototype.close=function(){Ba(this.g)},$t.prototype.o=function(p){var C=this.g;if(typeof p=="string"){var O={};O.__data__=p,p=O}else this.v&&(O={},O.__data__=Je(p),p=O);C.i.push(new er(C.Ya++,p)),C.I==3&&ns(C)},$t.prototype.N=function(){this.g.l=null,delete this.j,Ba(this.g),delete this.g,$t.Z.N.call(this)};function sa(p){Te.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var C=p.__sm__;if(C){e:{for(const O in C){p=O;break e}p=void 0}(this.i=p)&&(p=this.i,C=C!==null&&p in C?C[p]:void 0),this.data=C}else this.data=p}N(sa,Te);function ss(){kt.call(this),this.status=1}N(ss,kt);function nn(p){this.g=p}N(nn,rr),nn.prototype.ra=function(){en(this.g,"a")},nn.prototype.qa=function(p){en(this.g,new sa(p))},nn.prototype.pa=function(p){en(this.g,new ss)},nn.prototype.oa=function(){en(this.g,"b")},is.prototype.createWebChannel=is.prototype.g,$t.prototype.send=$t.prototype.o,$t.prototype.open=$t.prototype.m,$t.prototype.close=$t.prototype.close,f_=function(){return new is},h_=function(){return Xn()},u_=mt,k1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ys.NO_ERROR=0,ys.TIMEOUT=8,ys.HTTP_ERROR=6,lf=ys,pi.COMPLETE="complete",c_=pi,Xt.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",Qe.prototype.listen=Qe.prototype.J,au=Xt,wn.prototype.listenOnce=wn.prototype.K,wn.prototype.getLastError=wn.prototype.Ha,wn.prototype.getLastErrorCode=wn.prototype.ya,wn.prototype.getStatus=wn.prototype.ca,wn.prototype.getResponseJson=wn.prototype.La,wn.prototype.getResponseText=wn.prototype.la,wn.prototype.send=wn.prototype.ea,wn.prototype.setWithCredentials=wn.prototype.Fa,l_=wn}).apply(typeof Qh<"u"?Qh:typeof self<"u"?self:typeof window<"u"?window:{});const Qy="@firebase/firestore",Zy="4.9.2";class fi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fi.UNAUTHENTICATED=new fi(null),fi.GOOGLE_CREDENTIALS=new fi("google-credentials-uid"),fi.FIRST_PARTY=new fi("first-party-uid"),fi.MOCK_USER=new fi("mock-user");let mc="12.3.0";const fl=new sg("@firebase/firestore");function Wl(){return fl.logLevel}function it(s,...e){if(fl.logLevel<=hn.DEBUG){const n=e.map(pg);fl.debug(`Firestore (${mc}): ${s}`,...n)}}function Da(s,...e){if(fl.logLevel<=hn.ERROR){const n=e.map(pg);fl.error(`Firestore (${mc}): ${s}`,...n)}}function ac(s,...e){if(fl.logLevel<=hn.WARN){const n=e.map(pg);fl.warn(`Firestore (${mc}): ${s}`,...n)}}function pg(s){if(typeof s=="string")return s;try{return(function(n){return JSON.stringify(n)})(s)}catch{return s}}function Dt(s,e,n){let o="Unexpected state";typeof e=="string"?o=e:n=e,d_(s,o,n)}function d_(s,e,n){let o=`FIRESTORE (${mc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(n!==void 0)try{o+=" CONTEXT: "+JSON.stringify(n)}catch{o+=" CONTEXT: "+n}throw Da(o),new Error(o)}function Nn(s,e,n,o){let h="Unexpected state";typeof n=="string"?h=n:o=n,s||d_(e,h,o)}function Ht(s,e){return s}const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ze extends Qs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ra{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class g_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class M3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(fi.UNAUTHENTICATED)))}shutdown(){}}class k3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class L3{constructor(e){this.t=e,this.currentUser=fi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Nn(this.o===void 0,42304);let o=this.i;const h=b=>this.i!==o?(o=this.i,n(b)):Promise.resolve();let g=new Ra;this.o=()=>{this.i++,this.currentUser=this.u(),g.resolve(),g=new Ra,e.enqueueRetryable((()=>h(this.currentUser)))};const E=()=>{const b=g;e.enqueueRetryable((async()=>{await b.promise,await h(this.currentUser)}))},v=b=>{it("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=b,this.o&&(this.auth.addAuthTokenListener(this.o),E())};this.t.onInit((b=>v(b))),setTimeout((()=>{if(!this.auth){const b=this.t.getImmediate({optional:!0});b?v(b):(it("FirebaseAuthCredentialsProvider","Auth not yet detected"),g.resolve(),g=new Ra)}}),0),E()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((o=>this.i!==e?(it("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(Nn(typeof o.accessToken=="string",31837,{l:o}),new g_(o.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Nn(e===null||typeof e=="string",2055,{h:e}),new fi(e)}}class P3{constructor(e,n,o){this.P=e,this.T=n,this.I=o,this.type="FirstParty",this.user=fi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class B3{constructor(e,n,o){this.P=e,this.T=n,this.I=o}getToken(){return Promise.resolve(new P3(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(fi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Jy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class V3{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Bi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Nn(this.o===void 0,3512);const o=g=>{g.error!=null&&it("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${g.error.message}`);const E=g.token!==this.m;return this.m=g.token,it("FirebaseAppCheckTokenProvider",`Received ${E?"new":"existing"} token.`),E?n(g.token):Promise.resolve()};this.o=g=>{e.enqueueRetryable((()=>o(g)))};const h=g=>{it("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=g,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((g=>h(g))),setTimeout((()=>{if(!this.appCheck){const g=this.V.getImmediate({optional:!0});g?h(g):it("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Jy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Nn(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Jy(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function U3(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let o=0;o<s;o++)n[o]=Math.floor(256*Math.random());return n}class yg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let o="";for(;o.length<20;){const h=U3(40);for(let g=0;g<h.length;++g)o.length<20&&h[g]<n&&(o+=e.charAt(h[g]%62))}return o}}function fn(s,e){return s<e?-1:s>e?1:0}function L1(s,e){const n=Math.min(s.length,e.length);for(let o=0;o<n;o++){const h=s.charAt(o),g=e.charAt(o);if(h!==g)return g1(h)===g1(g)?fn(h,g):g1(h)?1:-1}return fn(s.length,e.length)}const F3=55296,j3=57343;function g1(s){const e=s.charCodeAt(0);return e>=F3&&e<=j3}function oc(s,e,n){return s.length===e.length&&s.every(((o,h)=>n(o,e[h])))}const $y="__name__";class Us{constructor(e,n,o){n===void 0?n=0:n>e.length&&Dt(637,{offset:n,range:e.length}),o===void 0?o=e.length-n:o>e.length-n&&Dt(1746,{length:o,range:e.length-n}),this.segments=e,this.offset=n,this.len=o}get length(){return this.len}isEqual(e){return Us.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Us?e.forEach((o=>{n.push(o)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,o=this.limit();n<o;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const o=Math.min(e.length,n.length);for(let h=0;h<o;h++){const g=Us.compareSegments(e.get(h),n.get(h));if(g!==0)return g}return fn(e.length,n.length)}static compareSegments(e,n){const o=Us.isNumericId(e),h=Us.isNumericId(n);return o&&!h?-1:!o&&h?1:o&&h?Us.extractNumericId(e).compare(Us.extractNumericId(n)):L1(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ao.fromString(e.substring(4,e.length-2))}}class Gn extends Us{construct(e,n,o){return new Gn(e,n,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const o of e){if(o.indexOf("//")>=0)throw new Ze(Ce.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);n.push(...o.split("/").filter((h=>h.length>0)))}return new Gn(n)}static emptyPath(){return new Gn([])}}const z3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ti extends Us{construct(e,n,o){return new ti(e,n,o)}static isValidIdentifier(e){return z3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ti.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$y}static keyField(){return new ti([$y])}static fromServerFormat(e){const n=[];let o="",h=0;const g=()=>{if(o.length===0)throw new Ze(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(o),o=""};let E=!1;for(;h<e.length;){const v=e[h];if(v==="\\"){if(h+1===e.length)throw new Ze(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const b=e[h+1];if(b!=="\\"&&b!=="."&&b!=="`")throw new Ze(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);o+=b,h+=2}else v==="`"?(E=!E,h++):v!=="."||E?(o+=v,h++):(g(),h++)}if(g(),E)throw new Ze(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ti(n)}static emptyPath(){return new ti([])}}class wt{constructor(e){this.path=e}static fromPath(e){return new wt(Gn.fromString(e))}static fromName(e){return new wt(Gn.fromString(e).popFirst(5))}static empty(){return new wt(Gn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Gn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Gn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new wt(new Gn(e.slice()))}}function m_(s,e,n){if(!n)throw new Ze(Ce.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function H3(s,e,n,o){if(e===!0&&o===!0)throw new Ze(Ce.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function eE(s){if(!wt.isDocumentKey(s))throw new Ze(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function tE(s){if(wt.isDocumentKey(s))throw new Ze(Ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function p_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Wf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(o){return o.constructor?o.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Dt(12329,{type:typeof s})}function bi(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ze(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wf(s);throw new Ze(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function Dr(s,e){const n={typeString:s};return e&&(n.value=e),n}function ku(s,e){if(!p_(s))throw new Ze(Ce.INVALID_ARGUMENT,"JSON must be an object");let n;for(const o in e)if(e[o]){const h=e[o].typeString,g="value"in e[o]?{value:e[o].value}:void 0;if(!(o in s)){n=`JSON missing required field: '${o}'`;break}const E=s[o];if(h&&typeof E!==h){n=`JSON field '${o}' must be a ${h}.`;break}if(g!==void 0&&E!==g.value){n=`Expected '${o}' field to equal '${g.value}'`;break}}if(n)throw new Ze(Ce.INVALID_ARGUMENT,n);return!0}const nE=-62135596800,rE=1e6;class Rn{static now(){return Rn.fromMillis(Date.now())}static fromDate(e){return Rn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),o=Math.floor((e-1e3*n)*rE);return new Rn(n,o)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ze(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ze(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<nE)throw new Ze(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ze(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rE}_compareTo(e){return this.seconds===e.seconds?fn(this.nanoseconds,e.nanoseconds):fn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Rn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ku(e,Rn._jsonSchema))return new Rn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-nE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Rn._jsonSchemaVersion="firestore/timestamp/1.0",Rn._jsonSchema={type:Dr("string",Rn._jsonSchemaVersion),seconds:Dr("number"),nanoseconds:Dr("number")};class Ft{static fromTimestamp(e){return new Ft(e)}static min(){return new Ft(new Rn(0,0))}static max(){return new Ft(new Rn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const _u=-1;function G3(s,e){const n=s.toTimestamp().seconds,o=s.toTimestamp().nanoseconds+1,h=Ft.fromTimestamp(o===1e9?new Rn(n+1,0):new Rn(n,o));return new vo(h,wt.empty(),e)}function q3(s){return new vo(s.readTime,s.key,_u)}class vo{constructor(e,n,o){this.readTime=e,this.documentKey=n,this.largestBatchId=o}static min(){return new vo(Ft.min(),wt.empty(),_u)}static max(){return new vo(Ft.max(),wt.empty(),_u)}}function X3(s,e){let n=s.readTime.compareTo(e.readTime);return n!==0?n:(n=wt.comparator(s.documentKey,e.documentKey),n!==0?n:fn(s.largestBatchId,e.largestBatchId))}const Y3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class W3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function pc(s){if(s.code!==Ce.FAILED_PRECONDITION||s.message!==Y3)throw s;it("LocalStore","Unexpectedly lost primary lease")}class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Dt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Oe(((o,h)=>{this.nextCallback=g=>{this.wrapSuccess(e,g).next(o,h)},this.catchCallback=g=>{this.wrapFailure(n,g).next(o,h)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof Oe?n:Oe.resolve(n)}catch(n){return Oe.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):Oe.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):Oe.reject(n)}static resolve(e){return new Oe(((n,o)=>{n(e)}))}static reject(e){return new Oe(((n,o)=>{o(e)}))}static waitFor(e){return new Oe(((n,o)=>{let h=0,g=0,E=!1;e.forEach((v=>{++h,v.next((()=>{++g,E&&g===h&&n()}),(b=>o(b)))})),E=!0,g===h&&n()}))}static or(e){let n=Oe.resolve(!1);for(const o of e)n=n.next((h=>h?Oe.resolve(h):o()));return n}static forEach(e,n){const o=[];return e.forEach(((h,g)=>{o.push(n.call(this,h,g))})),this.waitFor(o)}static mapArray(e,n){return new Oe(((o,h)=>{const g=e.length,E=new Array(g);let v=0;for(let b=0;b<g;b++){const _=b;n(e[_]).next((S=>{E[_]=S,++v,v===g&&o(E)}),(S=>h(S)))}}))}static doWhile(e,n){return new Oe(((o,h)=>{const g=()=>{e()===!0?n().next((()=>{g()}),h):o()};g()}))}}function K3(s){const e=s.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function yc(s){return s.name==="IndexedDbTransactionError"}class Kf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=o=>this.ae(o),this.ue=o=>n.writeSequenceNumber(o))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kf.ce=-1;const Eg=-1;function Qf(s){return s==null}function Tf(s){return s===0&&1/s==-1/0}function Q3(s){return typeof s=="number"&&Number.isInteger(s)&&!Tf(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const y_="";function Z3(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=iE(e)),e=J3(s.get(n),e);return iE(e)}function J3(s,e){let n=e;const o=s.length;for(let h=0;h<o;h++){const g=s.charAt(h);switch(g){case"\0":n+="";break;case y_:n+="";break;default:n+=g}}return n}function iE(s){return s+y_+""}function sE(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function Mo(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function E_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class ur{constructor(e,n){this.comparator=e,this.root=n||$r.EMPTY}insert(e,n){return new ur(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$r.BLACK,null,null))}remove(e){return new ur(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$r.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return n.value;o<0?n=n.left:o>0&&(n=n.right)}return null}indexOf(e){let n=0,o=this.root;for(;!o.isEmpty();){const h=this.comparator(e,o.key);if(h===0)return n+o.left.size;h<0?o=o.left:(n+=o.left.size+1,o=o.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,o)=>(e(n,o),!1)))}toString(){const e=[];return this.inorderTraversal(((n,o)=>(e.push(`${n}:${o}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zh(this.root,e,this.comparator,!0)}}class Zh{constructor(e,n,o,h){this.isReverse=h,this.nodeStack=[];let g=1;for(;!e.isEmpty();)if(g=n?o(e.key,n):1,n&&h&&(g*=-1),g<0)e=this.isReverse?e.left:e.right;else{if(g===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $r{constructor(e,n,o,h,g){this.key=e,this.value=n,this.color=o??$r.RED,this.left=h??$r.EMPTY,this.right=g??$r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,o,h,g){return new $r(e??this.key,n??this.value,o??this.color,h??this.left,g??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,o){let h=this;const g=o(e,h.key);return h=g<0?h.copy(null,null,null,h.left.insert(e,n,o),null):g===0?h.copy(null,n,null,null,null):h.copy(null,null,null,null,h.right.insert(e,n,o)),h.fixUp()}removeMin(){if(this.left.isEmpty())return $r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let o,h=this;if(n(e,h.key)<0)h.left.isEmpty()||h.left.isRed()||h.left.left.isRed()||(h=h.moveRedLeft()),h=h.copy(null,null,null,h.left.remove(e,n),null);else{if(h.left.isRed()&&(h=h.rotateRight()),h.right.isEmpty()||h.right.isRed()||h.right.left.isRed()||(h=h.moveRedRight()),n(e,h.key)===0){if(h.right.isEmpty())return $r.EMPTY;o=h.right.min(),h=h.copy(o.key,o.value,null,null,h.right.removeMin())}h=h.copy(null,null,null,null,h.right.remove(e,n))}return h.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Dt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Dt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Dt(27949);return e+(this.isRed()?0:1)}}$r.EMPTY=null,$r.RED=!0,$r.BLACK=!1;$r.EMPTY=new class{constructor(){this.size=0}get key(){throw Dt(57766)}get value(){throw Dt(16141)}get color(){throw Dt(16727)}get left(){throw Dt(29726)}get right(){throw Dt(36894)}copy(e,n,o,h,g){return this}insert(e,n,o){return new $r(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Vr{constructor(e){this.comparator=e,this.data=new ur(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,o)=>(e(n),!1)))}forEachInRange(e,n){const o=this.data.getIteratorFrom(e[0]);for(;o.hasNext();){const h=o.getNext();if(this.comparator(h.key,e[1])>=0)return;n(h.key)}}forEachWhile(e,n){let o;for(o=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();o.hasNext();)if(!e(o.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new aE(this.data.getIterator())}getIteratorFrom(e){return new aE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((o=>{n=n.add(o)})),n}isEqual(e){if(!(e instanceof Vr)||this.size!==e.size)return!1;const n=this.data.getIterator(),o=e.data.getIterator();for(;n.hasNext();){const h=n.getNext().key,g=o.getNext().key;if(this.comparator(h,g)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Vr(this.comparator);return n.data=e,n}}class aE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class es{constructor(e){this.fields=e,e.sort(ti.comparator)}static empty(){return new es([])}unionWith(e){let n=new Vr(ti.comparator);for(const o of this.fields)n=n.add(o);for(const o of e)n=n.add(o);return new es(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return oc(this.fields,e.fields,((n,o)=>n.isEqual(o)))}}class x_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ni{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(h){try{return atob(h)}catch(g){throw typeof DOMException<"u"&&g instanceof DOMException?new x_("Invalid base64 string: "+g):g}})(e);return new ni(n)}static fromUint8Array(e){const n=(function(h){let g="";for(let E=0;E<h.length;++E)g+=String.fromCharCode(h[E]);return g})(e);return new ni(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const o=new Uint8Array(n.length);for(let h=0;h<n.length;h++)o[h]=n.charCodeAt(h);return o})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ni.EMPTY_BYTE_STRING=new ni("");const $3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Co(s){if(Nn(!!s,39018),typeof s=="string"){let e=0;const n=$3.exec(s);if(Nn(!!n,46558,{timestamp:s}),n[1]){let h=n[1];h=(h+"000000000").substr(0,9),e=Number(h)}const o=new Date(s);return{seconds:Math.floor(o.getTime()/1e3),nanos:e}}return{seconds:br(s.seconds),nanos:br(s.nanos)}}function br(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function So(s){return typeof s=="string"?ni.fromBase64String(s):ni.fromUint8Array(s)}const __="server_timestamp",A_="__type__",w_="__previous_value__",b_="__local_write_time__";function xg(s){return(s?.mapValue?.fields||{})[A_]?.stringValue===__}function Zf(s){const e=s.mapValue.fields[w_];return xg(e)?Zf(e):e}function Au(s){const e=Co(s.mapValue.fields[b_].timestampValue);return new Rn(e.seconds,e.nanos)}class eS{constructor(e,n,o,h,g,E,v,b,_,S){this.databaseId=e,this.appId=n,this.persistenceKey=o,this.host=h,this.ssl=g,this.forceLongPolling=E,this.autoDetectLongPolling=v,this.longPollingOptions=b,this.useFetchStreams=_,this.isUsingEmulator=S}}const vf="(default)";class wu{constructor(e,n){this.projectId=e,this.database=n||vf}static empty(){return new wu("","")}get isDefaultDatabase(){return this.database===vf}isEqual(e){return e instanceof wu&&e.projectId===this.projectId&&e.database===this.database}}const T_="__type__",tS="__max__",Jh={mapValue:{}},v_="__vector__",Cf="value";function Io(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?xg(s)?4:rS(s)?9007199254740991:nS(s)?10:11:Dt(28295,{value:s})}function Ws(s,e){if(s===e)return!0;const n=Io(s);if(n!==Io(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Au(s).isEqual(Au(e));case 3:return(function(h,g){if(typeof h.timestampValue=="string"&&typeof g.timestampValue=="string"&&h.timestampValue.length===g.timestampValue.length)return h.timestampValue===g.timestampValue;const E=Co(h.timestampValue),v=Co(g.timestampValue);return E.seconds===v.seconds&&E.nanos===v.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(h,g){return So(h.bytesValue).isEqual(So(g.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(h,g){return br(h.geoPointValue.latitude)===br(g.geoPointValue.latitude)&&br(h.geoPointValue.longitude)===br(g.geoPointValue.longitude)})(s,e);case 2:return(function(h,g){if("integerValue"in h&&"integerValue"in g)return br(h.integerValue)===br(g.integerValue);if("doubleValue"in h&&"doubleValue"in g){const E=br(h.doubleValue),v=br(g.doubleValue);return E===v?Tf(E)===Tf(v):isNaN(E)&&isNaN(v)}return!1})(s,e);case 9:return oc(s.arrayValue.values||[],e.arrayValue.values||[],Ws);case 10:case 11:return(function(h,g){const E=h.mapValue.fields||{},v=g.mapValue.fields||{};if(sE(E)!==sE(v))return!1;for(const b in E)if(E.hasOwnProperty(b)&&(v[b]===void 0||!Ws(E[b],v[b])))return!1;return!0})(s,e);default:return Dt(52216,{left:s})}}function bu(s,e){return(s.values||[]).find((n=>Ws(n,e)))!==void 0}function lc(s,e){if(s===e)return 0;const n=Io(s),o=Io(e);if(n!==o)return fn(n,o);switch(n){case 0:case 9007199254740991:return 0;case 1:return fn(s.booleanValue,e.booleanValue);case 2:return(function(g,E){const v=br(g.integerValue||g.doubleValue),b=br(E.integerValue||E.doubleValue);return v<b?-1:v>b?1:v===b?0:isNaN(v)?isNaN(b)?0:-1:1})(s,e);case 3:return oE(s.timestampValue,e.timestampValue);case 4:return oE(Au(s),Au(e));case 5:return L1(s.stringValue,e.stringValue);case 6:return(function(g,E){const v=So(g),b=So(E);return v.compareTo(b)})(s.bytesValue,e.bytesValue);case 7:return(function(g,E){const v=g.split("/"),b=E.split("/");for(let _=0;_<v.length&&_<b.length;_++){const S=fn(v[_],b[_]);if(S!==0)return S}return fn(v.length,b.length)})(s.referenceValue,e.referenceValue);case 8:return(function(g,E){const v=fn(br(g.latitude),br(E.latitude));return v!==0?v:fn(br(g.longitude),br(E.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return lE(s.arrayValue,e.arrayValue);case 10:return(function(g,E){const v=g.fields||{},b=E.fields||{},_=v[Cf]?.arrayValue,S=b[Cf]?.arrayValue,N=fn(_?.values?.length||0,S?.values?.length||0);return N!==0?N:lE(_,S)})(s.mapValue,e.mapValue);case 11:return(function(g,E){if(g===Jh.mapValue&&E===Jh.mapValue)return 0;if(g===Jh.mapValue)return 1;if(E===Jh.mapValue)return-1;const v=g.fields||{},b=Object.keys(v),_=E.fields||{},S=Object.keys(_);b.sort(),S.sort();for(let N=0;N<b.length&&N<S.length;++N){const P=L1(b[N],S[N]);if(P!==0)return P;const X=lc(v[b[N]],_[S[N]]);if(X!==0)return X}return fn(b.length,S.length)})(s.mapValue,e.mapValue);default:throw Dt(23264,{he:n})}}function oE(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return fn(s,e);const n=Co(s),o=Co(e),h=fn(n.seconds,o.seconds);return h!==0?h:fn(n.nanos,o.nanos)}function lE(s,e){const n=s.values||[],o=e.values||[];for(let h=0;h<n.length&&h<o.length;++h){const g=lc(n[h],o[h]);if(g)return g}return fn(n.length,o.length)}function cc(s){return P1(s)}function P1(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(n){const o=Co(n);return`time(${o.seconds},${o.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(n){return So(n).toBase64()})(s.bytesValue):"referenceValue"in s?(function(n){return wt.fromName(n).toString()})(s.referenceValue):"geoPointValue"in s?(function(n){return`geo(${n.latitude},${n.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(n){let o="[",h=!0;for(const g of n.values||[])h?h=!1:o+=",",o+=P1(g);return o+"]"})(s.arrayValue):"mapValue"in s?(function(n){const o=Object.keys(n.fields||{}).sort();let h="{",g=!0;for(const E of o)g?g=!1:h+=",",h+=`${E}:${P1(n.fields[E])}`;return h+"}"})(s.mapValue):Dt(61005,{value:s})}function cf(s){switch(Io(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Zf(s);return e?16+cf(e):16;case 5:return 2*s.stringValue.length;case 6:return So(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(o){return(o.values||[]).reduce(((h,g)=>h+cf(g)),0)})(s.arrayValue);case 10:case 11:return(function(o){let h=0;return Mo(o.fields,((g,E)=>{h+=g.length+cf(E)})),h})(s.mapValue);default:throw Dt(13486,{value:s})}}function cE(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function B1(s){return!!s&&"integerValue"in s}function _g(s){return!!s&&"arrayValue"in s}function uE(s){return!!s&&"nullValue"in s}function hE(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function uf(s){return!!s&&"mapValue"in s}function nS(s){return(s?.mapValue?.fields||{})[T_]?.stringValue===v_}function du(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Mo(s.mapValue.fields,((n,o)=>e.mapValue.fields[n]=du(o))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=du(s.arrayValue.values[n]);return e}return{...s}}function rS(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===tS}class Vi{constructor(e){this.value=e}static empty(){return new Vi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let o=0;o<e.length-1;++o)if(n=(n.mapValue.fields||{})[e.get(o)],!uf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=du(n)}setAll(e){let n=ti.emptyPath(),o={},h=[];e.forEach(((E,v)=>{if(!n.isImmediateParentOf(v)){const b=this.getFieldsMap(n);this.applyChanges(b,o,h),o={},h=[],n=v.popLast()}E?o[v.lastSegment()]=du(E):h.push(v.lastSegment())}));const g=this.getFieldsMap(n);this.applyChanges(g,o,h)}delete(e){const n=this.field(e.popLast());uf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ws(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let o=0;o<e.length;++o){let h=n.mapValue.fields[e.get(o)];uf(h)&&h.mapValue.fields||(h={mapValue:{fields:{}}},n.mapValue.fields[e.get(o)]=h),n=h}return n.mapValue.fields}applyChanges(e,n,o){Mo(n,((h,g)=>e[h]=g));for(const h of o)delete e[h]}clone(){return new Vi(du(this.value))}}function C_(s){const e=[];return Mo(s.fields,((n,o)=>{const h=new ti([n]);if(uf(o)){const g=C_(o.mapValue).fields;if(g.length===0)e.push(h);else for(const E of g)e.push(h.child(E))}else e.push(h)})),new es(e)}class di{constructor(e,n,o,h,g,E,v){this.key=e,this.documentType=n,this.version=o,this.readTime=h,this.createTime=g,this.data=E,this.documentState=v}static newInvalidDocument(e){return new di(e,0,Ft.min(),Ft.min(),Ft.min(),Vi.empty(),0)}static newFoundDocument(e,n,o,h){return new di(e,1,n,Ft.min(),o,h,0)}static newNoDocument(e,n){return new di(e,2,n,Ft.min(),Ft.min(),Vi.empty(),0)}static newUnknownDocument(e,n){return new di(e,3,n,Ft.min(),Ft.min(),Vi.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ft.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof di&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new di(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Sf{constructor(e,n){this.position=e,this.inclusive=n}}function fE(s,e,n){let o=0;for(let h=0;h<s.position.length;h++){const g=e[h],E=s.position[h];if(g.field.isKeyField()?o=wt.comparator(wt.fromName(E.referenceValue),n.key):o=lc(E,n.data.field(g.field)),g.dir==="desc"&&(o*=-1),o!==0)break}return o}function dE(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!Ws(s.position[n],e.position[n]))return!1;return!0}class Tu{constructor(e,n="asc"){this.field=e,this.dir=n}}function iS(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class S_{}class Or extends S_{constructor(e,n,o){super(),this.field=e,this.op=n,this.value=o}static create(e,n,o){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,o):new aS(e,n,o):n==="array-contains"?new cS(e,o):n==="in"?new uS(e,o):n==="not-in"?new hS(e,o):n==="array-contains-any"?new fS(e,o):new Or(e,n,o)}static createKeyFieldInFilter(e,n,o){return n==="in"?new oS(e,o):new lS(e,o)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(lc(n,this.value)):n!==null&&Io(this.value)===Io(n)&&this.matchesComparison(lc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Dt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Is extends S_{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Is(e,n)}matches(e){return I_(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function I_(s){return s.op==="and"}function R_(s){return sS(s)&&I_(s)}function sS(s){for(const e of s.filters)if(e instanceof Is)return!1;return!0}function V1(s){if(s instanceof Or)return s.field.canonicalString()+s.op.toString()+cc(s.value);if(R_(s))return s.filters.map((e=>V1(e))).join(",");{const e=s.filters.map((n=>V1(n))).join(",");return`${s.op}(${e})`}}function N_(s,e){return s instanceof Or?(function(o,h){return h instanceof Or&&o.op===h.op&&o.field.isEqual(h.field)&&Ws(o.value,h.value)})(s,e):s instanceof Is?(function(o,h){return h instanceof Is&&o.op===h.op&&o.filters.length===h.filters.length?o.filters.reduce(((g,E,v)=>g&&N_(E,h.filters[v])),!0):!1})(s,e):void Dt(19439)}function O_(s){return s instanceof Or?(function(n){return`${n.field.canonicalString()} ${n.op} ${cc(n.value)}`})(s):s instanceof Is?(function(n){return n.op.toString()+" {"+n.getFilters().map(O_).join(" ,")+"}"})(s):"Filter"}class aS extends Or{constructor(e,n,o){super(e,n,o),this.key=wt.fromName(o.referenceValue)}matches(e){const n=wt.comparator(e.key,this.key);return this.matchesComparison(n)}}class oS extends Or{constructor(e,n){super(e,"in",n),this.keys=D_("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class lS extends Or{constructor(e,n){super(e,"not-in",n),this.keys=D_("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function D_(s,e){return(e.arrayValue?.values||[]).map((n=>wt.fromName(n.referenceValue)))}class cS extends Or{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return _g(n)&&bu(n.arrayValue,this.value)}}class uS extends Or{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&bu(this.value.arrayValue,n)}}class hS extends Or{constructor(e,n){super(e,"not-in",n)}matches(e){if(bu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!bu(this.value.arrayValue,n)}}class fS extends Or{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!_g(n)||!n.arrayValue.values)&&n.arrayValue.values.some((o=>bu(this.value.arrayValue,o)))}}class dS{constructor(e,n=null,o=[],h=[],g=null,E=null,v=null){this.path=e,this.collectionGroup=n,this.orderBy=o,this.filters=h,this.limit=g,this.startAt=E,this.endAt=v,this.Te=null}}function gE(s,e=null,n=[],o=[],h=null,g=null,E=null){return new dS(s,e,n,o,h,g,E)}function Ag(s){const e=Ht(s);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((o=>V1(o))).join(","),n+="|ob:",n+=e.orderBy.map((o=>(function(g){return g.field.canonicalString()+g.dir})(o))).join(","),Qf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((o=>cc(o))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((o=>cc(o))).join(",")),e.Te=n}return e.Te}function wg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<s.orderBy.length;n++)if(!iS(s.orderBy[n],e.orderBy[n]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let n=0;n<s.filters.length;n++)if(!N_(s.filters[n],e.filters[n]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!dE(s.startAt,e.startAt)&&dE(s.endAt,e.endAt)}function U1(s){return wt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class Ec{constructor(e,n=null,o=[],h=[],g=null,E="F",v=null,b=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=o,this.filters=h,this.limit=g,this.limitType=E,this.startAt=v,this.endAt=b,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function gS(s,e,n,o,h,g,E,v){return new Ec(s,e,n,o,h,g,E,v)}function Jf(s){return new Ec(s)}function mE(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function M_(s){return s.collectionGroup!==null}function gu(s){const e=Ht(s);if(e.Ie===null){e.Ie=[];const n=new Set;for(const g of e.explicitOrderBy)e.Ie.push(g),n.add(g.field.canonicalString());const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(E){let v=new Vr(ti.comparator);return E.filters.forEach((b=>{b.getFlattenedFilters().forEach((_=>{_.isInequality()&&(v=v.add(_.field))}))})),v})(e).forEach((g=>{n.has(g.canonicalString())||g.isKeyField()||e.Ie.push(new Tu(g,o))})),n.has(ti.keyField().canonicalString())||e.Ie.push(new Tu(ti.keyField(),o))}return e.Ie}function Gs(s){const e=Ht(s);return e.Ee||(e.Ee=mS(e,gu(s))),e.Ee}function mS(s,e){if(s.limitType==="F")return gE(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((h=>{const g=h.dir==="desc"?"asc":"desc";return new Tu(h.field,g)}));const n=s.endAt?new Sf(s.endAt.position,s.endAt.inclusive):null,o=s.startAt?new Sf(s.startAt.position,s.startAt.inclusive):null;return gE(s.path,s.collectionGroup,e,s.filters,s.limit,n,o)}}function F1(s,e){const n=s.filters.concat([e]);return new Ec(s.path,s.collectionGroup,s.explicitOrderBy.slice(),n,s.limit,s.limitType,s.startAt,s.endAt)}function If(s,e,n){return new Ec(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function $f(s,e){return wg(Gs(s),Gs(e))&&s.limitType===e.limitType}function k_(s){return`${Ag(Gs(s))}|lt:${s.limitType}`}function Kl(s){return`Query(target=${(function(n){let o=n.path.canonicalString();return n.collectionGroup!==null&&(o+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(o+=`, filters: [${n.filters.map((h=>O_(h))).join(", ")}]`),Qf(n.limit)||(o+=", limit: "+n.limit),n.orderBy.length>0&&(o+=`, orderBy: [${n.orderBy.map((h=>(function(E){return`${E.field.canonicalString()} (${E.dir})`})(h))).join(", ")}]`),n.startAt&&(o+=", startAt: ",o+=n.startAt.inclusive?"b:":"a:",o+=n.startAt.position.map((h=>cc(h))).join(",")),n.endAt&&(o+=", endAt: ",o+=n.endAt.inclusive?"a:":"b:",o+=n.endAt.position.map((h=>cc(h))).join(",")),`Target(${o})`})(Gs(s))}; limitType=${s.limitType})`}function ed(s,e){return e.isFoundDocument()&&(function(o,h){const g=h.key.path;return o.collectionGroup!==null?h.key.hasCollectionId(o.collectionGroup)&&o.path.isPrefixOf(g):wt.isDocumentKey(o.path)?o.path.isEqual(g):o.path.isImmediateParentOf(g)})(s,e)&&(function(o,h){for(const g of gu(o))if(!g.field.isKeyField()&&h.data.field(g.field)===null)return!1;return!0})(s,e)&&(function(o,h){for(const g of o.filters)if(!g.matches(h))return!1;return!0})(s,e)&&(function(o,h){return!(o.startAt&&!(function(E,v,b){const _=fE(E,v,b);return E.inclusive?_<=0:_<0})(o.startAt,gu(o),h)||o.endAt&&!(function(E,v,b){const _=fE(E,v,b);return E.inclusive?_>=0:_>0})(o.endAt,gu(o),h))})(s,e)}function pS(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function L_(s){return(e,n)=>{let o=!1;for(const h of gu(s)){const g=yS(h,e,n);if(g!==0)return g;o=o||h.field.isKeyField()}return 0}}function yS(s,e,n){const o=s.field.isKeyField()?wt.comparator(e.key,n.key):(function(g,E,v){const b=E.data.field(g),_=v.data.field(g);return b!==null&&_!==null?lc(b,_):Dt(42886)})(s.field,e,n);switch(s.dir){case"asc":return o;case"desc":return-1*o;default:return Dt(19790,{direction:s.dir})}}class yl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),o=this.inner[n];if(o!==void 0){for(const[h,g]of o)if(this.equalsFn(h,e))return g}}has(e){return this.get(e)!==void 0}set(e,n){const o=this.mapKeyFn(e),h=this.inner[o];if(h===void 0)return this.inner[o]=[[e,n]],void this.innerSize++;for(let g=0;g<h.length;g++)if(this.equalsFn(h[g][0],e))return void(h[g]=[e,n]);h.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return!1;for(let h=0;h<o.length;h++)if(this.equalsFn(o[h][0],e))return o.length===1?delete this.inner[n]:o.splice(h,1),this.innerSize--,!0;return!1}forEach(e){Mo(this.inner,((n,o)=>{for(const[h,g]of o)e(h,g)}))}isEmpty(){return E_(this.inner)}size(){return this.innerSize}}const ES=new ur(wt.comparator);function Ma(){return ES}const P_=new ur(wt.comparator);function ou(...s){let e=P_;for(const n of s)e=e.insert(n.key,n);return e}function B_(s){let e=P_;return s.forEach(((n,o)=>e=e.insert(n,o.overlayedDocument))),e}function il(){return mu()}function V_(){return mu()}function mu(){return new yl((s=>s.toString()),((s,e)=>s.isEqual(e)))}const xS=new ur(wt.comparator),_S=new Vr(wt.comparator);function dn(...s){let e=_S;for(const n of s)e=e.add(n);return e}const AS=new Vr(fn);function wS(){return AS}function bg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tf(e)?"-0":e}}function U_(s){return{integerValue:""+s}}function bS(s,e){return Q3(e)?U_(e):bg(s,e)}class td{constructor(){this._=void 0}}function TS(s,e,n){return s instanceof vu?(function(h,g){const E={fields:{[A_]:{stringValue:__},[b_]:{timestampValue:{seconds:h.seconds,nanos:h.nanoseconds}}}};return g&&xg(g)&&(g=Zf(g)),g&&(E.fields[w_]=g),{mapValue:E}})(n,e):s instanceof Cu?j_(s,e):s instanceof Su?z_(s,e):(function(h,g){const E=F_(h,g),v=pE(E)+pE(h.Ae);return B1(E)&&B1(h.Ae)?U_(v):bg(h.serializer,v)})(s,e)}function vS(s,e,n){return s instanceof Cu?j_(s,e):s instanceof Su?z_(s,e):n}function F_(s,e){return s instanceof Rf?(function(o){return B1(o)||(function(g){return!!g&&"doubleValue"in g})(o)})(e)?e:{integerValue:0}:null}class vu extends td{}class Cu extends td{constructor(e){super(),this.elements=e}}function j_(s,e){const n=H_(e);for(const o of s.elements)n.some((h=>Ws(h,o)))||n.push(o);return{arrayValue:{values:n}}}class Su extends td{constructor(e){super(),this.elements=e}}function z_(s,e){let n=H_(e);for(const o of s.elements)n=n.filter((h=>!Ws(h,o)));return{arrayValue:{values:n}}}class Rf extends td{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function pE(s){return br(s.integerValue||s.doubleValue)}function H_(s){return _g(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class CS{constructor(e,n){this.field=e,this.transform=n}}function SS(s,e){return s.field.isEqual(e.field)&&(function(o,h){return o instanceof Cu&&h instanceof Cu||o instanceof Su&&h instanceof Su?oc(o.elements,h.elements,Ws):o instanceof Rf&&h instanceof Rf?Ws(o.Ae,h.Ae):o instanceof vu&&h instanceof vu})(s.transform,e.transform)}class IS{constructor(e,n){this.version=e,this.transformResults=n}}class Ti{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ti}static exists(e){return new Ti(void 0,e)}static updateTime(e){return new Ti(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hf(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class nd{}function G_(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new rd(s.key,Ti.none()):new Lu(s.key,s.data,Ti.none());{const n=s.data,o=Vi.empty();let h=new Vr(ti.comparator);for(let g of e.fields)if(!h.has(g)){let E=n.field(g);E===null&&g.length>1&&(g=g.popLast(),E=n.field(g)),E===null?o.delete(g):o.set(g,E),h=h.add(g)}return new ko(s.key,o,new es(h.toArray()),Ti.none())}}function RS(s,e,n){s instanceof Lu?(function(h,g,E){const v=h.value.clone(),b=EE(h.fieldTransforms,g,E.transformResults);v.setAll(b),g.convertToFoundDocument(E.version,v).setHasCommittedMutations()})(s,e,n):s instanceof ko?(function(h,g,E){if(!hf(h.precondition,g))return void g.convertToUnknownDocument(E.version);const v=EE(h.fieldTransforms,g,E.transformResults),b=g.data;b.setAll(q_(h)),b.setAll(v),g.convertToFoundDocument(E.version,b).setHasCommittedMutations()})(s,e,n):(function(h,g,E){g.convertToNoDocument(E.version).setHasCommittedMutations()})(0,e,n)}function pu(s,e,n,o){return s instanceof Lu?(function(g,E,v,b){if(!hf(g.precondition,E))return v;const _=g.value.clone(),S=xE(g.fieldTransforms,b,E);return _.setAll(S),E.convertToFoundDocument(E.version,_).setHasLocalMutations(),null})(s,e,n,o):s instanceof ko?(function(g,E,v,b){if(!hf(g.precondition,E))return v;const _=xE(g.fieldTransforms,b,E),S=E.data;return S.setAll(q_(g)),S.setAll(_),E.convertToFoundDocument(E.version,S).setHasLocalMutations(),v===null?null:v.unionWith(g.fieldMask.fields).unionWith(g.fieldTransforms.map((N=>N.field)))})(s,e,n,o):(function(g,E,v){return hf(g.precondition,E)?(E.convertToNoDocument(E.version).setHasLocalMutations(),null):v})(s,e,n)}function NS(s,e){let n=null;for(const o of s.fieldTransforms){const h=e.data.field(o.field),g=F_(o.transform,h||null);g!=null&&(n===null&&(n=Vi.empty()),n.set(o.field,g))}return n||null}function yE(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(o,h){return o===void 0&&h===void 0||!(!o||!h)&&oc(o,h,((g,E)=>SS(g,E)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Lu extends nd{constructor(e,n,o,h=[]){super(),this.key=e,this.value=n,this.precondition=o,this.fieldTransforms=h,this.type=0}getFieldMask(){return null}}class ko extends nd{constructor(e,n,o,h,g=[]){super(),this.key=e,this.data=n,this.fieldMask=o,this.precondition=h,this.fieldTransforms=g,this.type=1}getFieldMask(){return this.fieldMask}}function q_(s){const e=new Map;return s.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const o=s.data.field(n);e.set(n,o)}})),e}function EE(s,e,n){const o=new Map;Nn(s.length===n.length,32656,{Re:n.length,Ve:s.length});for(let h=0;h<n.length;h++){const g=s[h],E=g.transform,v=e.data.field(g.field);o.set(g.field,vS(E,v,n[h]))}return o}function xE(s,e,n){const o=new Map;for(const h of s){const g=h.transform,E=n.data.field(h.field);o.set(h.field,TS(g,E,e))}return o}class rd extends nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class OS extends nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class DS{constructor(e,n,o,h){this.batchId=e,this.localWriteTime=n,this.baseMutations=o,this.mutations=h}applyToRemoteDocument(e,n){const o=n.mutationResults;for(let h=0;h<this.mutations.length;h++){const g=this.mutations[h];g.key.isEqual(e.key)&&RS(g,e,o[h])}}applyToLocalView(e,n){for(const o of this.baseMutations)o.key.isEqual(e.key)&&(n=pu(o,e,n,this.localWriteTime));for(const o of this.mutations)o.key.isEqual(e.key)&&(n=pu(o,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const o=V_();return this.mutations.forEach((h=>{const g=e.get(h.key),E=g.overlayedDocument;let v=this.applyToLocalView(E,g.mutatedFields);v=n.has(h.key)?null:v;const b=G_(E,v);b!==null&&o.set(h.key,b),E.isValidDocument()||E.convertToNoDocument(Ft.min())})),o}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),dn())}isEqual(e){return this.batchId===e.batchId&&oc(this.mutations,e.mutations,((n,o)=>yE(n,o)))&&oc(this.baseMutations,e.baseMutations,((n,o)=>yE(n,o)))}}class Tg{constructor(e,n,o,h){this.batch=e,this.commitVersion=n,this.mutationResults=o,this.docVersions=h}static from(e,n,o){Nn(e.mutations.length===o.length,58842,{me:e.mutations.length,fe:o.length});let h=(function(){return xS})();const g=e.mutations;for(let E=0;E<g.length;E++)h=h.insert(g[E].key,o[E].version);return new Tg(e,n,o,h)}}class MS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class kS{constructor(e,n){this.count=e,this.unchangedNames=n}}var Rr,xn;function LS(s){switch(s){case Ce.OK:return Dt(64938);case Ce.CANCELLED:case Ce.UNKNOWN:case Ce.DEADLINE_EXCEEDED:case Ce.RESOURCE_EXHAUSTED:case Ce.INTERNAL:case Ce.UNAVAILABLE:case Ce.UNAUTHENTICATED:return!1;case Ce.INVALID_ARGUMENT:case Ce.NOT_FOUND:case Ce.ALREADY_EXISTS:case Ce.PERMISSION_DENIED:case Ce.FAILED_PRECONDITION:case Ce.ABORTED:case Ce.OUT_OF_RANGE:case Ce.UNIMPLEMENTED:case Ce.DATA_LOSS:return!0;default:return Dt(15467,{code:s})}}function X_(s){if(s===void 0)return Da("GRPC error has no .code"),Ce.UNKNOWN;switch(s){case Rr.OK:return Ce.OK;case Rr.CANCELLED:return Ce.CANCELLED;case Rr.UNKNOWN:return Ce.UNKNOWN;case Rr.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case Rr.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case Rr.INTERNAL:return Ce.INTERNAL;case Rr.UNAVAILABLE:return Ce.UNAVAILABLE;case Rr.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case Rr.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case Rr.NOT_FOUND:return Ce.NOT_FOUND;case Rr.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case Rr.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case Rr.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case Rr.ABORTED:return Ce.ABORTED;case Rr.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case Rr.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case Rr.DATA_LOSS:return Ce.DATA_LOSS;default:return Dt(39323,{code:s})}}(xn=Rr||(Rr={}))[xn.OK=0]="OK",xn[xn.CANCELLED=1]="CANCELLED",xn[xn.UNKNOWN=2]="UNKNOWN",xn[xn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xn[xn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xn[xn.NOT_FOUND=5]="NOT_FOUND",xn[xn.ALREADY_EXISTS=6]="ALREADY_EXISTS",xn[xn.PERMISSION_DENIED=7]="PERMISSION_DENIED",xn[xn.UNAUTHENTICATED=16]="UNAUTHENTICATED",xn[xn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xn[xn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xn[xn.ABORTED=10]="ABORTED",xn[xn.OUT_OF_RANGE=11]="OUT_OF_RANGE",xn[xn.UNIMPLEMENTED=12]="UNIMPLEMENTED",xn[xn.INTERNAL=13]="INTERNAL",xn[xn.UNAVAILABLE=14]="UNAVAILABLE",xn[xn.DATA_LOSS=15]="DATA_LOSS";function PS(){return new TextEncoder}const BS=new Ao([4294967295,4294967295],0);function _E(s){const e=PS().encode(s),n=new o_;return n.update(e),new Uint8Array(n.digest())}function AE(s){const e=new DataView(s.buffer),n=e.getUint32(0,!0),o=e.getUint32(4,!0),h=e.getUint32(8,!0),g=e.getUint32(12,!0);return[new Ao([n,o],0),new Ao([h,g],0)]}class vg{constructor(e,n,o){if(this.bitmap=e,this.padding=n,this.hashCount=o,n<0||n>=8)throw new lu(`Invalid padding: ${n}`);if(o<0)throw new lu(`Invalid hash count: ${o}`);if(e.length>0&&this.hashCount===0)throw new lu(`Invalid hash count: ${o}`);if(e.length===0&&n!==0)throw new lu(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ao.fromNumber(this.ge)}ye(e,n,o){let h=e.add(n.multiply(Ao.fromNumber(o)));return h.compare(BS)===1&&(h=new Ao([h.getBits(0),h.getBits(1)],0)),h.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=_E(e),[o,h]=AE(n);for(let g=0;g<this.hashCount;g++){const E=this.ye(o,h,g);if(!this.we(E))return!1}return!0}static create(e,n,o){const h=e%8==0?0:8-e%8,g=new Uint8Array(Math.ceil(e/8)),E=new vg(g,h,n);return o.forEach((v=>E.insert(v))),E}insert(e){if(this.ge===0)return;const n=_E(e),[o,h]=AE(n);for(let g=0;g<this.hashCount;g++){const E=this.ye(o,h,g);this.Se(E)}}Se(e){const n=Math.floor(e/8),o=e%8;this.bitmap[n]|=1<<o}}class lu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class id{constructor(e,n,o,h,g){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=o,this.documentUpdates=h,this.resolvedLimboDocuments=g}static createSynthesizedRemoteEventForCurrentChange(e,n,o){const h=new Map;return h.set(e,Pu.createSynthesizedTargetChangeForCurrentChange(e,n,o)),new id(Ft.min(),h,new ur(fn),Ma(),dn())}}class Pu{constructor(e,n,o,h,g){this.resumeToken=e,this.current=n,this.addedDocuments=o,this.modifiedDocuments=h,this.removedDocuments=g}static createSynthesizedTargetChangeForCurrentChange(e,n,o){return new Pu(o,n,dn(),dn(),dn())}}class ff{constructor(e,n,o,h){this.be=e,this.removedTargetIds=n,this.key=o,this.De=h}}class Y_{constructor(e,n){this.targetId=e,this.Ce=n}}class W_{constructor(e,n,o=ni.EMPTY_BYTE_STRING,h=null){this.state=e,this.targetIds=n,this.resumeToken=o,this.cause=h}}class wE{constructor(){this.ve=0,this.Fe=bE(),this.Me=ni.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=dn(),n=dn(),o=dn();return this.Fe.forEach(((h,g)=>{switch(g){case 0:e=e.add(h);break;case 2:n=n.add(h);break;case 1:o=o.add(h);break;default:Dt(38017,{changeType:g})}})),new Pu(this.Me,this.xe,e,n,o)}qe(){this.Oe=!1,this.Fe=bE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Nn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class VS{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ma(),this.Je=$h(),this.He=$h(),this.Ye=new ur(fn)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const o=this.nt(n);switch(e.state){case 0:this.rt(n)&&o.Le(e.resumeToken);break;case 1:o.Ke(),o.Ne||o.qe(),o.Le(e.resumeToken);break;case 2:o.Ke(),o.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(o.We(),o.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),o.Le(e.resumeToken));break;default:Dt(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((o,h)=>{this.rt(h)&&n(h)}))}st(e){const n=e.targetId,o=e.Ce.count,h=this.ot(n);if(h){const g=h.target;if(U1(g))if(o===0){const E=new wt(g.path);this.et(n,E,di.newNoDocument(E,Ft.min()))}else Nn(o===1,20013,{expectedCount:o});else{const E=this._t(n);if(E!==o){const v=this.ut(e),b=v?this.ct(v,e,E):1;if(b!==0){this.it(n);const _=b===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,_)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:o="",padding:h=0},hashCount:g=0}=n;let E,v;try{E=So(o).toUint8Array()}catch(b){if(b instanceof x_)return ac("Decoding the base64 bloom filter in existence filter failed ("+b.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw b}try{v=new vg(E,h,g)}catch(b){return ac(b instanceof lu?"BloomFilter error: ":"Applying bloom filter failed: ",b),null}return v.ge===0?null:v}ct(e,n,o){return n.Ce.count===o-this.Pt(e,n.targetId)?0:2}Pt(e,n){const o=this.Ge.getRemoteKeysForTarget(n);let h=0;return o.forEach((g=>{const E=this.Ge.ht(),v=`projects/${E.projectId}/databases/${E.database}/documents/${g.path.canonicalString()}`;e.mightContain(v)||(this.et(n,g,null),h++)})),h}Tt(e){const n=new Map;this.ze.forEach(((g,E)=>{const v=this.ot(E);if(v){if(g.current&&U1(v.target)){const b=new wt(v.target.path);this.It(b).has(E)||this.Et(E,b)||this.et(E,b,di.newNoDocument(b,e))}g.Be&&(n.set(E,g.ke()),g.qe())}}));let o=dn();this.He.forEach(((g,E)=>{let v=!0;E.forEachWhile((b=>{const _=this.ot(b);return!_||_.purpose==="TargetPurposeLimboResolution"||(v=!1,!1)})),v&&(o=o.add(g))})),this.je.forEach(((g,E)=>E.setReadTime(e)));const h=new id(e,n,this.Ye,this.je,o);return this.je=Ma(),this.Je=$h(),this.He=$h(),this.Ye=new ur(fn),h}Xe(e,n){if(!this.rt(e))return;const o=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,o),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,o){if(!this.rt(e))return;const h=this.nt(e);this.Et(e,n)?h.Qe(n,1):h.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),o&&(this.je=this.je.insert(n,o))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new wE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Vr(fn),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Vr(fn),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||it("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wE),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function $h(){return new ur(wt.comparator)}function bE(){return new ur(wt.comparator)}const US={asc:"ASCENDING",desc:"DESCENDING"},FS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jS={and:"AND",or:"OR"};class zS{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function j1(s,e){return s.useProto3Json||Qf(e)?e:{value:e}}function Nf(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function K_(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function HS(s,e){return Nf(s,e.toTimestamp())}function qs(s){return Nn(!!s,49232),Ft.fromTimestamp((function(n){const o=Co(n);return new Rn(o.seconds,o.nanos)})(s))}function Cg(s,e){return z1(s,e).canonicalString()}function z1(s,e){const n=(function(h){return new Gn(["projects",h.projectId,"databases",h.database])})(s).child("documents");return e===void 0?n:n.child(e)}function Q_(s){const e=Gn.fromString(s);return Nn(tA(e),10190,{key:e.toString()}),e}function H1(s,e){return Cg(s.databaseId,e.path)}function m1(s,e){const n=Q_(e);if(n.get(1)!==s.databaseId.projectId)throw new Ze(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new Ze(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new wt(J_(n))}function Z_(s,e){return Cg(s.databaseId,e)}function GS(s){const e=Q_(s);return e.length===4?Gn.emptyPath():J_(e)}function G1(s){return new Gn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function J_(s){return Nn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function TE(s,e,n){return{name:H1(s,e),fields:n.value.mapValue.fields}}function qS(s,e){let n;if("targetChange"in e){e.targetChange;const o=(function(_){return _==="NO_CHANGE"?0:_==="ADD"?1:_==="REMOVE"?2:_==="CURRENT"?3:_==="RESET"?4:Dt(39313,{state:_})})(e.targetChange.targetChangeType||"NO_CHANGE"),h=e.targetChange.targetIds||[],g=(function(_,S){return _.useProto3Json?(Nn(S===void 0||typeof S=="string",58123),ni.fromBase64String(S||"")):(Nn(S===void 0||S instanceof Buffer||S instanceof Uint8Array,16193),ni.fromUint8Array(S||new Uint8Array))})(s,e.targetChange.resumeToken),E=e.targetChange.cause,v=E&&(function(_){const S=_.code===void 0?Ce.UNKNOWN:X_(_.code);return new Ze(S,_.message||"")})(E);n=new W_(o,h,g,v||null)}else if("documentChange"in e){e.documentChange;const o=e.documentChange;o.document,o.document.name,o.document.updateTime;const h=m1(s,o.document.name),g=qs(o.document.updateTime),E=o.document.createTime?qs(o.document.createTime):Ft.min(),v=new Vi({mapValue:{fields:o.document.fields}}),b=di.newFoundDocument(h,g,E,v),_=o.targetIds||[],S=o.removedTargetIds||[];n=new ff(_,S,b.key,b)}else if("documentDelete"in e){e.documentDelete;const o=e.documentDelete;o.document;const h=m1(s,o.document),g=o.readTime?qs(o.readTime):Ft.min(),E=di.newNoDocument(h,g),v=o.removedTargetIds||[];n=new ff([],v,E.key,E)}else if("documentRemove"in e){e.documentRemove;const o=e.documentRemove;o.document;const h=m1(s,o.document),g=o.removedTargetIds||[];n=new ff([],g,h,null)}else{if(!("filter"in e))return Dt(11601,{Rt:e});{e.filter;const o=e.filter;o.targetId;const{count:h=0,unchangedNames:g}=o,E=new kS(h,g),v=o.targetId;n=new Y_(v,E)}}return n}function XS(s,e){let n;if(e instanceof Lu)n={update:TE(s,e.key,e.value)};else if(e instanceof rd)n={delete:H1(s,e.key)};else if(e instanceof ko)n={update:TE(s,e.key,e.data),updateMask:tI(e.fieldMask)};else{if(!(e instanceof OS))return Dt(16599,{Vt:e.type});n={verify:H1(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((o=>(function(g,E){const v=E.transform;if(v instanceof vu)return{fieldPath:E.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(v instanceof Cu)return{fieldPath:E.field.canonicalString(),appendMissingElements:{values:v.elements}};if(v instanceof Su)return{fieldPath:E.field.canonicalString(),removeAllFromArray:{values:v.elements}};if(v instanceof Rf)return{fieldPath:E.field.canonicalString(),increment:v.Ae};throw Dt(20930,{transform:E.transform})})(0,o)))),e.precondition.isNone||(n.currentDocument=(function(h,g){return g.updateTime!==void 0?{updateTime:HS(h,g.updateTime)}:g.exists!==void 0?{exists:g.exists}:Dt(27497)})(s,e.precondition)),n}function YS(s,e){return s&&s.length>0?(Nn(e!==void 0,14353),s.map((n=>(function(h,g){let E=h.updateTime?qs(h.updateTime):qs(g);return E.isEqual(Ft.min())&&(E=qs(g)),new IS(E,h.transformResults||[])})(n,e)))):[]}function WS(s,e){return{documents:[Z_(s,e.path)]}}function KS(s,e){const n={structuredQuery:{}},o=e.path;let h;e.collectionGroup!==null?(h=o,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(h=o.popLast(),n.structuredQuery.from=[{collectionId:o.lastSegment()}]),n.parent=Z_(s,h);const g=(function(_){if(_.length!==0)return eA(Is.create(_,"and"))})(e.filters);g&&(n.structuredQuery.where=g);const E=(function(_){if(_.length!==0)return _.map((S=>(function(P){return{field:Ql(P.field),direction:JS(P.dir)}})(S)))})(e.orderBy);E&&(n.structuredQuery.orderBy=E);const v=j1(s,e.limit);return v!==null&&(n.structuredQuery.limit=v),e.startAt&&(n.structuredQuery.startAt=(function(_){return{before:_.inclusive,values:_.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(_){return{before:!_.inclusive,values:_.position}})(e.endAt)),{ft:n,parent:h}}function QS(s){let e=GS(s.parent);const n=s.structuredQuery,o=n.from?n.from.length:0;let h=null;if(o>0){Nn(o===1,65062);const S=n.from[0];S.allDescendants?h=S.collectionId:e=e.child(S.collectionId)}let g=[];n.where&&(g=(function(N){const P=$_(N);return P instanceof Is&&R_(P)?P.getFilters():[P]})(n.where));let E=[];n.orderBy&&(E=(function(N){return N.map((P=>(function(te){return new Tu(Zl(te.field),(function(ue){switch(ue){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(te.direction))})(P)))})(n.orderBy));let v=null;n.limit&&(v=(function(N){let P;return P=typeof N=="object"?N.value:N,Qf(P)?null:P})(n.limit));let b=null;n.startAt&&(b=(function(N){const P=!!N.before,X=N.values||[];return new Sf(X,P)})(n.startAt));let _=null;return n.endAt&&(_=(function(N){const P=!N.before,X=N.values||[];return new Sf(X,P)})(n.endAt)),gS(e,h,E,g,v,"F",b,_)}function ZS(s,e){const n=(function(h){switch(h){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Dt(28987,{purpose:h})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function $_(s){return s.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const o=Zl(n.unaryFilter.field);return Or.create(o,"==",{doubleValue:NaN});case"IS_NULL":const h=Zl(n.unaryFilter.field);return Or.create(h,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const g=Zl(n.unaryFilter.field);return Or.create(g,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const E=Zl(n.unaryFilter.field);return Or.create(E,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Dt(61313);default:return Dt(60726)}})(s):s.fieldFilter!==void 0?(function(n){return Or.create(Zl(n.fieldFilter.field),(function(h){switch(h){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Dt(58110);default:return Dt(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(n){return Is.create(n.compositeFilter.filters.map((o=>$_(o))),(function(h){switch(h){case"AND":return"and";case"OR":return"or";default:return Dt(1026)}})(n.compositeFilter.op))})(s):Dt(30097,{filter:s})}function JS(s){return US[s]}function $S(s){return FS[s]}function eI(s){return jS[s]}function Ql(s){return{fieldPath:s.canonicalString()}}function Zl(s){return ti.fromServerFormat(s.fieldPath)}function eA(s){return s instanceof Or?(function(n){if(n.op==="=="){if(hE(n.value))return{unaryFilter:{field:Ql(n.field),op:"IS_NAN"}};if(uE(n.value))return{unaryFilter:{field:Ql(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(hE(n.value))return{unaryFilter:{field:Ql(n.field),op:"IS_NOT_NAN"}};if(uE(n.value))return{unaryFilter:{field:Ql(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ql(n.field),op:$S(n.op),value:n.value}}})(s):s instanceof Is?(function(n){const o=n.getFilters().map((h=>eA(h)));return o.length===1?o[0]:{compositeFilter:{op:eI(n.op),filters:o}}})(s):Dt(54877,{filter:s})}function tI(s){const e=[];return s.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function tA(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}class yo{constructor(e,n,o,h,g=Ft.min(),E=Ft.min(),v=ni.EMPTY_BYTE_STRING,b=null){this.target=e,this.targetId=n,this.purpose=o,this.sequenceNumber=h,this.snapshotVersion=g,this.lastLimboFreeSnapshotVersion=E,this.resumeToken=v,this.expectedCount=b}withSequenceNumber(e){return new yo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new yo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class nI{constructor(e){this.yt=e}}function rI(s){const e=QS({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?If(e,e.limit,"L"):e}class iI{constructor(){this.Cn=new sI}addToCollectionParentIndex(e,n){return this.Cn.add(n),Oe.resolve()}getCollectionParents(e,n){return Oe.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return Oe.resolve()}deleteFieldIndex(e,n){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,n){return Oe.resolve()}getDocumentsMatchingTarget(e,n){return Oe.resolve(null)}getIndexType(e,n){return Oe.resolve(0)}getFieldIndexes(e,n){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,n){return Oe.resolve(vo.min())}getMinOffsetFromCollectionGroup(e,n){return Oe.resolve(vo.min())}updateCollectionGroup(e,n,o){return Oe.resolve()}updateIndexEntries(e,n){return Oe.resolve()}}class sI{constructor(){this.index={}}add(e){const n=e.lastSegment(),o=e.popLast(),h=this.index[n]||new Vr(Gn.comparator),g=!h.has(o);return this.index[n]=h.add(o),g}has(e){const n=e.lastSegment(),o=e.popLast(),h=this.index[n];return h&&h.has(o)}getEntries(e){return(this.index[e]||new Vr(Gn.comparator)).toArray()}}const vE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nA=41943040;class Pi{static withCacheSize(e){return new Pi(e,Pi.DEFAULT_COLLECTION_PERCENTILE,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,o){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=o}}Pi.DEFAULT_COLLECTION_PERCENTILE=10,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pi.DEFAULT=new Pi(nA,Pi.DEFAULT_COLLECTION_PERCENTILE,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pi.DISABLED=new Pi(-1,0,0);class uc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new uc(0)}static cr(){return new uc(-1)}}const CE="LruGarbageCollector",aI=1048576;function SE([s,e],[n,o]){const h=fn(s,n);return h===0?fn(e,o):h}class oI{constructor(e){this.Ir=e,this.buffer=new Vr(SE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const o=this.buffer.last();SE(n,o)<0&&(this.buffer=this.buffer.delete(o).add(n))}}get maxValue(){return this.buffer.last()[0]}}class lI{constructor(e,n,o){this.garbageCollector=e,this.asyncQueue=n,this.localStore=o,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){it(CE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){yc(n)?it(CE,"Ignoring IndexedDB error during garbage collection: ",n):await pc(n)}await this.Vr(3e5)}))}}class cI{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((o=>Math.floor(n/100*o)))}nthSequenceNumber(e,n){if(n===0)return Oe.resolve(Kf.ce);const o=new oI(n);return this.mr.forEachTarget(e,(h=>o.Ar(h.sequenceNumber))).next((()=>this.mr.pr(e,(h=>o.Ar(h))))).next((()=>o.maxValue))}removeTargets(e,n,o){return this.mr.removeTargets(e,n,o)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(it("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve(vE)):this.getCacheSize(e).next((o=>o<this.params.cacheSizeCollectionThreshold?(it("LruGarbageCollector",`Garbage collection skipped; Cache size ${o} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vE):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let o,h,g,E,v,b,_;const S=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((N=>(N>this.params.maximumSequenceNumbersToCollect?(it("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),h=this.params.maximumSequenceNumbersToCollect):h=N,E=Date.now(),this.nthSequenceNumber(e,h)))).next((N=>(o=N,v=Date.now(),this.removeTargets(e,o,n)))).next((N=>(g=N,b=Date.now(),this.removeOrphanedDocuments(e,o)))).next((N=>(_=Date.now(),Wl()<=hn.DEBUG&&it("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${E-S}ms
	Determined least recently used ${h} in `+(v-E)+`ms
	Removed ${g} targets in `+(b-v)+`ms
	Removed ${N} documents in `+(_-b)+`ms
Total Duration: ${_-S}ms`),Oe.resolve({didRun:!0,sequenceNumbersCollected:h,targetsRemoved:g,documentsRemoved:N}))))}}function uI(s,e){return new cI(s,e)}class hI{constructor(){this.changes=new yl((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,di.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const o=this.changes.get(n);return o!==void 0?Oe.resolve(o):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class fI{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class dI{constructor(e,n,o,h){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=o,this.indexManager=h}getDocument(e,n){let o=null;return this.documentOverlayCache.getOverlay(e,n).next((h=>(o=h,this.remoteDocumentCache.getEntry(e,n)))).next((h=>(o!==null&&pu(o.mutation,h,es.empty(),Rn.now()),h)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((o=>this.getLocalViewOfDocuments(e,o,dn()).next((()=>o))))}getLocalViewOfDocuments(e,n,o=dn()){const h=il();return this.populateOverlays(e,h,n).next((()=>this.computeViews(e,n,h,o).next((g=>{let E=ou();return g.forEach(((v,b)=>{E=E.insert(v,b.overlayedDocument)})),E}))))}getOverlayedDocuments(e,n){const o=il();return this.populateOverlays(e,o,n).next((()=>this.computeViews(e,n,o,dn())))}populateOverlays(e,n,o){const h=[];return o.forEach((g=>{n.has(g)||h.push(g)})),this.documentOverlayCache.getOverlays(e,h).next((g=>{g.forEach(((E,v)=>{n.set(E,v)}))}))}computeViews(e,n,o,h){let g=Ma();const E=mu(),v=(function(){return mu()})();return n.forEach(((b,_)=>{const S=o.get(_.key);h.has(_.key)&&(S===void 0||S.mutation instanceof ko)?g=g.insert(_.key,_):S!==void 0?(E.set(_.key,S.mutation.getFieldMask()),pu(S.mutation,_,S.mutation.getFieldMask(),Rn.now())):E.set(_.key,es.empty())})),this.recalculateAndSaveOverlays(e,g).next((b=>(b.forEach(((_,S)=>E.set(_,S))),n.forEach(((_,S)=>v.set(_,new fI(S,E.get(_)??null)))),v)))}recalculateAndSaveOverlays(e,n){const o=mu();let h=new ur(((E,v)=>E-v)),g=dn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((E=>{for(const v of E)v.keys().forEach((b=>{const _=n.get(b);if(_===null)return;let S=o.get(b)||es.empty();S=v.applyToLocalView(_,S),o.set(b,S);const N=(h.get(v.batchId)||dn()).add(b);h=h.insert(v.batchId,N)}))})).next((()=>{const E=[],v=h.getReverseIterator();for(;v.hasNext();){const b=v.getNext(),_=b.key,S=b.value,N=V_();S.forEach((P=>{if(!g.has(P)){const X=G_(n.get(P),o.get(P));X!==null&&N.set(P,X),g=g.add(P)}})),E.push(this.documentOverlayCache.saveOverlays(e,_,N))}return Oe.waitFor(E)})).next((()=>o))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((o=>this.recalculateAndSaveOverlays(e,o)))}getDocumentsMatchingQuery(e,n,o,h){return(function(E){return wt.isDocumentKey(E.path)&&E.collectionGroup===null&&E.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):M_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,o,h):this.getDocumentsMatchingCollectionQuery(e,n,o,h)}getNextDocuments(e,n,o,h){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,o,h).next((g=>{const E=h-g.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,o.largestBatchId,h-g.size):Oe.resolve(il());let v=_u,b=g;return E.next((_=>Oe.forEach(_,((S,N)=>(v<N.largestBatchId&&(v=N.largestBatchId),g.get(S)?Oe.resolve():this.remoteDocumentCache.getEntry(e,S).next((P=>{b=b.insert(S,P)}))))).next((()=>this.populateOverlays(e,_,g))).next((()=>this.computeViews(e,b,_,dn()))).next((S=>({batchId:v,changes:B_(S)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new wt(n)).next((o=>{let h=ou();return o.isFoundDocument()&&(h=h.insert(o.key,o)),h}))}getDocumentsMatchingCollectionGroupQuery(e,n,o,h){const g=n.collectionGroup;let E=ou();return this.indexManager.getCollectionParents(e,g).next((v=>Oe.forEach(v,(b=>{const _=(function(N,P){return new Ec(P,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)})(n,b.child(g));return this.getDocumentsMatchingCollectionQuery(e,_,o,h).next((S=>{S.forEach(((N,P)=>{E=E.insert(N,P)}))}))})).next((()=>E))))}getDocumentsMatchingCollectionQuery(e,n,o,h){let g;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,o.largestBatchId).next((E=>(g=E,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,o,g,h)))).next((E=>{g.forEach(((b,_)=>{const S=_.getKey();E.get(S)===null&&(E=E.insert(S,di.newInvalidDocument(S)))}));let v=ou();return E.forEach(((b,_)=>{const S=g.get(b);S!==void 0&&pu(S.mutation,_,es.empty(),Rn.now()),ed(n,_)&&(v=v.insert(b,_))})),v}))}}class gI{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return Oe.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(h){return{id:h.id,version:h.version,createTime:qs(h.createTime)}})(n)),Oe.resolve()}getNamedQuery(e,n){return Oe.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(h){return{name:h.name,query:rI(h.bundledQuery),readTime:qs(h.readTime)}})(n)),Oe.resolve()}}class mI{constructor(){this.overlays=new ur(wt.comparator),this.qr=new Map}getOverlay(e,n){return Oe.resolve(this.overlays.get(n))}getOverlays(e,n){const o=il();return Oe.forEach(n,(h=>this.getOverlay(e,h).next((g=>{g!==null&&o.set(h,g)})))).next((()=>o))}saveOverlays(e,n,o){return o.forEach(((h,g)=>{this.St(e,n,g)})),Oe.resolve()}removeOverlaysForBatchId(e,n,o){const h=this.qr.get(o);return h!==void 0&&(h.forEach((g=>this.overlays=this.overlays.remove(g))),this.qr.delete(o)),Oe.resolve()}getOverlaysForCollection(e,n,o){const h=il(),g=n.length+1,E=new wt(n.child("")),v=this.overlays.getIteratorFrom(E);for(;v.hasNext();){const b=v.getNext().value,_=b.getKey();if(!n.isPrefixOf(_.path))break;_.path.length===g&&b.largestBatchId>o&&h.set(b.getKey(),b)}return Oe.resolve(h)}getOverlaysForCollectionGroup(e,n,o,h){let g=new ur(((_,S)=>_-S));const E=this.overlays.getIterator();for(;E.hasNext();){const _=E.getNext().value;if(_.getKey().getCollectionGroup()===n&&_.largestBatchId>o){let S=g.get(_.largestBatchId);S===null&&(S=il(),g=g.insert(_.largestBatchId,S)),S.set(_.getKey(),_)}}const v=il(),b=g.getIterator();for(;b.hasNext()&&(b.getNext().value.forEach(((_,S)=>v.set(_,S))),!(v.size()>=h)););return Oe.resolve(v)}St(e,n,o){const h=this.overlays.get(o.key);if(h!==null){const E=this.qr.get(h.largestBatchId).delete(o.key);this.qr.set(h.largestBatchId,E)}this.overlays=this.overlays.insert(o.key,new MS(n,o));let g=this.qr.get(n);g===void 0&&(g=dn(),this.qr.set(n,g)),this.qr.set(n,g.add(o.key))}}class pI{constructor(){this.sessionToken=ni.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Oe.resolve()}}class Sg{constructor(){this.Qr=new Vr(Hr.$r),this.Ur=new Vr(Hr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const o=new Hr(e,n);this.Qr=this.Qr.add(o),this.Ur=this.Ur.add(o)}Wr(e,n){e.forEach((o=>this.addReference(o,n)))}removeReference(e,n){this.Gr(new Hr(e,n))}zr(e,n){e.forEach((o=>this.removeReference(o,n)))}jr(e){const n=new wt(new Gn([])),o=new Hr(n,e),h=new Hr(n,e+1),g=[];return this.Ur.forEachInRange([o,h],(E=>{this.Gr(E),g.push(E.key)})),g}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new wt(new Gn([])),o=new Hr(n,e),h=new Hr(n,e+1);let g=dn();return this.Ur.forEachInRange([o,h],(E=>{g=g.add(E.key)})),g}containsKey(e){const n=new Hr(e,0),o=this.Qr.firstAfterOrEqual(n);return o!==null&&e.isEqual(o.key)}}class Hr{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return wt.comparator(e.key,n.key)||fn(e.Yr,n.Yr)}static Kr(e,n){return fn(e.Yr,n.Yr)||wt.comparator(e.key,n.key)}}class yI{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Vr(Hr.$r)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,o,h){const g=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const E=new DS(g,n,o,h);this.mutationQueue.push(E);for(const v of h)this.Zr=this.Zr.add(new Hr(v.key,g)),this.indexManager.addToCollectionParentIndex(e,v.key.path.popLast());return Oe.resolve(E)}lookupMutationBatch(e,n){return Oe.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const o=n+1,h=this.ei(o),g=h<0?0:h;return Oe.resolve(this.mutationQueue.length>g?this.mutationQueue[g]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?Eg:this.tr-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const o=new Hr(n,0),h=new Hr(n,Number.POSITIVE_INFINITY),g=[];return this.Zr.forEachInRange([o,h],(E=>{const v=this.Xr(E.Yr);g.push(v)})),Oe.resolve(g)}getAllMutationBatchesAffectingDocumentKeys(e,n){let o=new Vr(fn);return n.forEach((h=>{const g=new Hr(h,0),E=new Hr(h,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([g,E],(v=>{o=o.add(v.Yr)}))})),Oe.resolve(this.ti(o))}getAllMutationBatchesAffectingQuery(e,n){const o=n.path,h=o.length+1;let g=o;wt.isDocumentKey(g)||(g=g.child(""));const E=new Hr(new wt(g),0);let v=new Vr(fn);return this.Zr.forEachWhile((b=>{const _=b.key.path;return!!o.isPrefixOf(_)&&(_.length===h&&(v=v.add(b.Yr)),!0)}),E),Oe.resolve(this.ti(v))}ti(e){const n=[];return e.forEach((o=>{const h=this.Xr(o);h!==null&&n.push(h)})),n}removeMutationBatch(e,n){Nn(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let o=this.Zr;return Oe.forEach(n.mutations,(h=>{const g=new Hr(h.key,n.batchId);return o=o.delete(g),this.referenceDelegate.markPotentiallyOrphaned(e,h.key)})).next((()=>{this.Zr=o}))}ir(e){}containsKey(e,n){const o=new Hr(n,0),h=this.Zr.firstAfterOrEqual(o);return Oe.resolve(n.isEqual(h&&h.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class EI{constructor(e){this.ri=e,this.docs=(function(){return new ur(wt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const o=n.key,h=this.docs.get(o),g=h?h.size:0,E=this.ri(n);return this.docs=this.docs.insert(o,{document:n.mutableCopy(),size:E}),this.size+=E-g,this.indexManager.addToCollectionParentIndex(e,o.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const o=this.docs.get(n);return Oe.resolve(o?o.document.mutableCopy():di.newInvalidDocument(n))}getEntries(e,n){let o=Ma();return n.forEach((h=>{const g=this.docs.get(h);o=o.insert(h,g?g.document.mutableCopy():di.newInvalidDocument(h))})),Oe.resolve(o)}getDocumentsMatchingQuery(e,n,o,h){let g=Ma();const E=n.path,v=new wt(E.child("__id-9223372036854775808__")),b=this.docs.getIteratorFrom(v);for(;b.hasNext();){const{key:_,value:{document:S}}=b.getNext();if(!E.isPrefixOf(_.path))break;_.path.length>E.length+1||X3(q3(S),o)<=0||(h.has(S.key)||ed(n,S))&&(g=g.insert(S.key,S.mutableCopy()))}return Oe.resolve(g)}getAllFromCollectionGroup(e,n,o,h){Dt(9500)}ii(e,n){return Oe.forEach(this.docs,(o=>n(o)))}newChangeBuffer(e){return new xI(this)}getSize(e){return Oe.resolve(this.size)}}class xI extends hI{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((o,h)=>{h.isValidDocument()?n.push(this.Nr.addEntry(e,h)):this.Nr.removeEntry(o)})),Oe.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class _I{constructor(e){this.persistence=e,this.si=new yl((n=>Ag(n)),wg),this.lastRemoteSnapshotVersion=Ft.min(),this.highestTargetId=0,this.oi=0,this._i=new Sg,this.targetCount=0,this.ai=uc.ur()}forEachTarget(e,n){return this.si.forEach(((o,h)=>n(h))),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,n,o){return o&&(this.lastRemoteSnapshotVersion=o),n>this.oi&&(this.oi=n),Oe.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new uc(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,Oe.resolve()}updateTargetData(e,n){return this.Pr(n),Oe.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,n,o){let h=0;const g=[];return this.si.forEach(((E,v)=>{v.sequenceNumber<=n&&o.get(v.targetId)===null&&(this.si.delete(E),g.push(this.removeMatchingKeysForTargetId(e,v.targetId)),h++)})),Oe.waitFor(g).next((()=>h))}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,n){const o=this.si.get(n)||null;return Oe.resolve(o)}addMatchingKeys(e,n,o){return this._i.Wr(n,o),Oe.resolve()}removeMatchingKeys(e,n,o){this._i.zr(n,o);const h=this.persistence.referenceDelegate,g=[];return h&&n.forEach((E=>{g.push(h.markPotentiallyOrphaned(e,E))})),Oe.waitFor(g)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),Oe.resolve()}getMatchingKeysForTargetId(e,n){const o=this._i.Hr(n);return Oe.resolve(o)}containsKey(e,n){return Oe.resolve(this._i.containsKey(n))}}class rA{constructor(e,n){this.ui={},this.overlays={},this.ci=new Kf(0),this.li=!1,this.li=!0,this.hi=new pI,this.referenceDelegate=e(this),this.Pi=new _I(this),this.indexManager=new iI,this.remoteDocumentCache=(function(h){return new EI(h)})((o=>this.referenceDelegate.Ti(o))),this.serializer=new nI(n),this.Ii=new gI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new mI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let o=this.ui[e.toKey()];return o||(o=new yI(n,this.referenceDelegate),this.ui[e.toKey()]=o),o}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,o){it("MemoryPersistence","Starting transaction:",e);const h=new AI(this.ci.next());return this.referenceDelegate.Ei(),o(h).next((g=>this.referenceDelegate.di(h).next((()=>g)))).toPromise().then((g=>(h.raiseOnCommittedEvent(),g)))}Ai(e,n){return Oe.or(Object.values(this.ui).map((o=>()=>o.containsKey(e,n))))}}class AI extends W3{constructor(e){super(),this.currentSequenceNumber=e}}class Ig{constructor(e){this.persistence=e,this.Ri=new Sg,this.Vi=null}static mi(e){return new Ig(e)}get fi(){if(this.Vi)return this.Vi;throw Dt(60996)}addReference(e,n,o){return this.Ri.addReference(o,n),this.fi.delete(o.toString()),Oe.resolve()}removeReference(e,n,o){return this.Ri.removeReference(o,n),this.fi.add(o.toString()),Oe.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),Oe.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((h=>this.fi.add(h.toString())));const o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(e,n.targetId).next((h=>{h.forEach((g=>this.fi.add(g.toString())))})).next((()=>o.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.fi,(o=>{const h=wt.fromPath(o);return this.gi(e,h).next((g=>{g||n.removeEntry(h,Ft.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((o=>{o?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return Oe.or([()=>Oe.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Of{constructor(e,n){this.persistence=e,this.pi=new yl((o=>Z3(o.path)),((o,h)=>o.isEqual(h))),this.garbageCollector=uI(this,n)}static mi(e,n){return new Of(e,n)}Ei(){}di(e){return Oe.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((o=>n.next((h=>o+h))))}wr(e){let n=0;return this.pr(e,(o=>{n++})).next((()=>n))}pr(e,n){return Oe.forEach(this.pi,((o,h)=>this.br(e,o,h).next((g=>g?Oe.resolve():n(h)))))}removeTargets(e,n,o){return this.persistence.getTargetCache().removeTargets(e,n,o)}removeOrphanedDocuments(e,n){let o=0;const h=this.persistence.getRemoteDocumentCache(),g=h.newChangeBuffer();return h.ii(e,(E=>this.br(e,E,n).next((v=>{v||(o++,g.removeEntry(E,Ft.min()))})))).next((()=>g.apply(e))).next((()=>o))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}removeTarget(e,n){const o=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,o)}addReference(e,n,o){return this.pi.set(o,e.currentSequenceNumber),Oe.resolve()}removeReference(e,n,o){return this.pi.set(o,e.currentSequenceNumber),Oe.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=cf(e.data.value)),n}br(e,n,o){return Oe.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const h=this.pi.get(n);return Oe.resolve(h!==void 0&&h>o)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Rg{constructor(e,n,o,h){this.targetId=e,this.fromCache=n,this.Es=o,this.ds=h}static As(e,n){let o=dn(),h=dn();for(const g of n.docChanges)switch(g.type){case 0:o=o.add(g.doc.key);break;case 1:h=h.add(g.doc.key)}return new Rg(e,n.fromCache,o,h)}}class wI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class bI{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Kb()?8:K3(gi())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,o,h){const g={result:null};return this.ys(e,n).next((E=>{g.result=E})).next((()=>{if(!g.result)return this.ws(e,n,h,o).next((E=>{g.result=E}))})).next((()=>{if(g.result)return;const E=new wI;return this.Ss(e,n,E).next((v=>{if(g.result=v,this.Vs)return this.bs(e,n,E,v.size)}))})).next((()=>g.result))}bs(e,n,o,h){return o.documentReadCount<this.fs?(Wl()<=hn.DEBUG&&it("QueryEngine","SDK will not create cache indexes for query:",Kl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Oe.resolve()):(Wl()<=hn.DEBUG&&it("QueryEngine","Query:",Kl(n),"scans",o.documentReadCount,"local documents and returns",h,"documents as results."),o.documentReadCount>this.gs*h?(Wl()<=hn.DEBUG&&it("QueryEngine","The SDK decides to create cache indexes for query:",Kl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gs(n))):Oe.resolve())}ys(e,n){if(mE(n))return Oe.resolve(null);let o=Gs(n);return this.indexManager.getIndexType(e,o).next((h=>h===0?null:(n.limit!==null&&h===1&&(n=If(n,null,"F"),o=Gs(n)),this.indexManager.getDocumentsMatchingTarget(e,o).next((g=>{const E=dn(...g);return this.ps.getDocuments(e,E).next((v=>this.indexManager.getMinOffset(e,o).next((b=>{const _=this.Ds(n,v);return this.Cs(n,_,E,b.readTime)?this.ys(e,If(n,null,"F")):this.vs(e,_,n,b)}))))})))))}ws(e,n,o,h){return mE(n)||h.isEqual(Ft.min())?Oe.resolve(null):this.ps.getDocuments(e,o).next((g=>{const E=this.Ds(n,g);return this.Cs(n,E,o,h)?Oe.resolve(null):(Wl()<=hn.DEBUG&&it("QueryEngine","Re-using previous result from %s to execute query: %s",h.toString(),Kl(n)),this.vs(e,E,n,G3(h,_u)).next((v=>v)))}))}Ds(e,n){let o=new Vr(L_(e));return n.forEach(((h,g)=>{ed(e,g)&&(o=o.add(g))})),o}Cs(e,n,o,h){if(e.limit===null)return!1;if(o.size!==n.size)return!0;const g=e.limitType==="F"?n.last():n.first();return!!g&&(g.hasPendingWrites||g.version.compareTo(h)>0)}Ss(e,n,o){return Wl()<=hn.DEBUG&&it("QueryEngine","Using full collection scan to execute query:",Kl(n)),this.ps.getDocumentsMatchingQuery(e,n,vo.min(),o)}vs(e,n,o,h){return this.ps.getDocumentsMatchingQuery(e,o,h).next((g=>(n.forEach((E=>{g=g.insert(E.key,E)})),g)))}}const Ng="LocalStore",TI=3e8;class vI{constructor(e,n,o,h){this.persistence=e,this.Fs=n,this.serializer=h,this.Ms=new ur(fn),this.xs=new yl((g=>Ag(g)),wg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(o)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function CI(s,e,n,o){return new vI(s,e,n,o)}async function iA(s,e){const n=Ht(s);return await n.persistence.runTransaction("Handle user change","readonly",(o=>{let h;return n.mutationQueue.getAllMutationBatches(o).next((g=>(h=g,n.Bs(e),n.mutationQueue.getAllMutationBatches(o)))).next((g=>{const E=[],v=[];let b=dn();for(const _ of h){E.push(_.batchId);for(const S of _.mutations)b=b.add(S.key)}for(const _ of g){v.push(_.batchId);for(const S of _.mutations)b=b.add(S.key)}return n.localDocuments.getDocuments(o,b).next((_=>({Ls:_,removedBatchIds:E,addedBatchIds:v})))}))}))}function SI(s,e){const n=Ht(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(o=>{const h=e.batch.keys(),g=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(v,b,_,S){const N=_.batch,P=N.keys();let X=Oe.resolve();return P.forEach((te=>{X=X.next((()=>S.getEntry(b,te))).next((oe=>{const ue=_.docVersions.get(te);Nn(ue!==null,48541),oe.version.compareTo(ue)<0&&(N.applyToRemoteDocument(oe,_),oe.isValidDocument()&&(oe.setReadTime(_.commitVersion),S.addEntry(oe)))}))})),X.next((()=>v.mutationQueue.removeMutationBatch(b,N)))})(n,o,e,g).next((()=>g.apply(o))).next((()=>n.mutationQueue.performConsistencyCheck(o))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(o,h,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(o,(function(v){let b=dn();for(let _=0;_<v.mutationResults.length;++_)v.mutationResults[_].transformResults.length>0&&(b=b.add(v.batch.mutations[_].key));return b})(e)))).next((()=>n.localDocuments.getDocuments(o,h)))}))}function sA(s){const e=Ht(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function II(s,e){const n=Ht(s),o=e.snapshotVersion;let h=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(g=>{const E=n.Ns.newChangeBuffer({trackRemovals:!0});h=n.Ms;const v=[];e.targetChanges.forEach(((S,N)=>{const P=h.get(N);if(!P)return;v.push(n.Pi.removeMatchingKeys(g,S.removedDocuments,N).next((()=>n.Pi.addMatchingKeys(g,S.addedDocuments,N))));let X=P.withSequenceNumber(g.currentSequenceNumber);e.targetMismatches.get(N)!==null?X=X.withResumeToken(ni.EMPTY_BYTE_STRING,Ft.min()).withLastLimboFreeSnapshotVersion(Ft.min()):S.resumeToken.approximateByteSize()>0&&(X=X.withResumeToken(S.resumeToken,o)),h=h.insert(N,X),(function(oe,ue,Ye){return oe.resumeToken.approximateByteSize()===0||ue.snapshotVersion.toMicroseconds()-oe.snapshotVersion.toMicroseconds()>=TI?!0:Ye.addedDocuments.size+Ye.modifiedDocuments.size+Ye.removedDocuments.size>0})(P,X,S)&&v.push(n.Pi.updateTargetData(g,X))}));let b=Ma(),_=dn();if(e.documentUpdates.forEach((S=>{e.resolvedLimboDocuments.has(S)&&v.push(n.persistence.referenceDelegate.updateLimboDocument(g,S))})),v.push(RI(g,E,e.documentUpdates).next((S=>{b=S.ks,_=S.qs}))),!o.isEqual(Ft.min())){const S=n.Pi.getLastRemoteSnapshotVersion(g).next((N=>n.Pi.setTargetsMetadata(g,g.currentSequenceNumber,o)));v.push(S)}return Oe.waitFor(v).next((()=>E.apply(g))).next((()=>n.localDocuments.getLocalViewOfDocuments(g,b,_))).next((()=>b))})).then((g=>(n.Ms=h,g)))}function RI(s,e,n){let o=dn(),h=dn();return n.forEach((g=>o=o.add(g))),e.getEntries(s,o).next((g=>{let E=Ma();return n.forEach(((v,b)=>{const _=g.get(v);b.isFoundDocument()!==_.isFoundDocument()&&(h=h.add(v)),b.isNoDocument()&&b.version.isEqual(Ft.min())?(e.removeEntry(v,b.readTime),E=E.insert(v,b)):!_.isValidDocument()||b.version.compareTo(_.version)>0||b.version.compareTo(_.version)===0&&_.hasPendingWrites?(e.addEntry(b),E=E.insert(v,b)):it(Ng,"Ignoring outdated watch update for ",v,". Current version:",_.version," Watch version:",b.version)})),{ks:E,qs:h}}))}function NI(s,e){const n=Ht(s);return n.persistence.runTransaction("Get next mutation batch","readonly",(o=>(e===void 0&&(e=Eg),n.mutationQueue.getNextMutationBatchAfterBatchId(o,e))))}function OI(s,e){const n=Ht(s);return n.persistence.runTransaction("Allocate target","readwrite",(o=>{let h;return n.Pi.getTargetData(o,e).next((g=>g?(h=g,Oe.resolve(h)):n.Pi.allocateTargetId(o).next((E=>(h=new yo(e,E,"TargetPurposeListen",o.currentSequenceNumber),n.Pi.addTargetData(o,h).next((()=>h)))))))})).then((o=>{const h=n.Ms.get(o.targetId);return(h===null||o.snapshotVersion.compareTo(h.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(o.targetId,o),n.xs.set(e,o.targetId)),o}))}async function q1(s,e,n){const o=Ht(s),h=o.Ms.get(e),g=n?"readwrite":"readwrite-primary";try{n||await o.persistence.runTransaction("Release target",g,(E=>o.persistence.referenceDelegate.removeTarget(E,h)))}catch(E){if(!yc(E))throw E;it(Ng,`Failed to update sequence numbers for target ${e}: ${E}`)}o.Ms=o.Ms.remove(e),o.xs.delete(h.target)}function IE(s,e,n){const o=Ht(s);let h=Ft.min(),g=dn();return o.persistence.runTransaction("Execute query","readwrite",(E=>(function(b,_,S){const N=Ht(b),P=N.xs.get(S);return P!==void 0?Oe.resolve(N.Ms.get(P)):N.Pi.getTargetData(_,S)})(o,E,Gs(e)).next((v=>{if(v)return h=v.lastLimboFreeSnapshotVersion,o.Pi.getMatchingKeysForTargetId(E,v.targetId).next((b=>{g=b}))})).next((()=>o.Fs.getDocumentsMatchingQuery(E,e,n?h:Ft.min(),n?g:dn()))).next((v=>(DI(o,pS(e),v),{documents:v,Qs:g})))))}function DI(s,e,n){let o=s.Os.get(e)||Ft.min();n.forEach(((h,g)=>{g.readTime.compareTo(o)>0&&(o=g.readTime)})),s.Os.set(e,o)}class RE{constructor(){this.activeTargetIds=wS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class MI{constructor(){this.Mo=new RE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,o){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,o){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new RE,Promise.resolve()}handleUserChange(e,n,o){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class kI{Oo(e){}shutdown(){}}const NE="ConnectivityMonitor";class OE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){it(NE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){it(NE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ef=null;function X1(){return ef===null?ef=(function(){return 268435456+Math.round(2147483648*Math.random())})():ef++,"0x"+ef.toString(16)}const p1="RestConnection",LI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class PI{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),h=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${o}/databases/${h}`,this.Wo=this.databaseId.database===vf?`project_id=${o}`:`project_id=${o}&database_id=${h}`}Go(e,n,o,h,g){const E=X1(),v=this.zo(e,n.toUriEncodedString());it(p1,`Sending RPC '${e}' ${E}:`,v,o);const b={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(b,h,g);const{host:_}=new URL(v),S=Oo(_);return this.Jo(e,v,b,o,S).then((N=>(it(p1,`Received RPC '${e}' ${E}: `,N),N)),(N=>{throw ac(p1,`RPC '${e}' ${E} failed with error: `,N,"url: ",v,"request:",o),N}))}Ho(e,n,o,h,g,E){return this.Go(e,n,o,h,g)}jo(e,n,o){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+mc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((h,g)=>e[g]=h)),o&&o.headers.forEach(((h,g)=>e[g]=h))}zo(e,n){const o=LI[e];return`${this.Uo}/v1/${n}:${o}`}terminate(){}}class BI{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const hi="WebChannelConnection";class VI extends PI{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,o,h,g){const E=X1();return new Promise(((v,b)=>{const _=new l_;_.setWithCredentials(!0),_.listenOnce(c_.COMPLETE,(()=>{try{switch(_.getLastErrorCode()){case lf.NO_ERROR:const N=_.getResponseJson();it(hi,`XHR for RPC '${e}' ${E} received:`,JSON.stringify(N)),v(N);break;case lf.TIMEOUT:it(hi,`RPC '${e}' ${E} timed out`),b(new Ze(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case lf.HTTP_ERROR:const P=_.getStatus();if(it(hi,`RPC '${e}' ${E} failed with status:`,P,"response text:",_.getResponseText()),P>0){let X=_.getResponseJson();Array.isArray(X)&&(X=X[0]);const te=X?.error;if(te&&te.status&&te.message){const oe=(function(Ye){const ke=Ye.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(ke)>=0?ke:Ce.UNKNOWN})(te.status);b(new Ze(oe,te.message))}else b(new Ze(Ce.UNKNOWN,"Server responded with status "+_.getStatus()))}else b(new Ze(Ce.UNAVAILABLE,"Connection failed."));break;default:Dt(9055,{l_:e,streamId:E,h_:_.getLastErrorCode(),P_:_.getLastError()})}}finally{it(hi,`RPC '${e}' ${E} completed.`)}}));const S=JSON.stringify(h);it(hi,`RPC '${e}' ${E} sending request:`,h),_.send(n,"POST",S,o,15)}))}T_(e,n,o){const h=X1(),g=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],E=f_(),v=h_(),b={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},_=this.longPollingOptions.timeoutSeconds;_!==void 0&&(b.longPollingTimeout=Math.round(1e3*_)),this.useFetchStreams&&(b.useFetchStreams=!0),this.jo(b.initMessageHeaders,n,o),b.encodeInitMessageHeaders=!0;const S=g.join("");it(hi,`Creating RPC '${e}' stream ${h}: ${S}`,b);const N=E.createWebChannel(S,b);this.I_(N);let P=!1,X=!1;const te=new BI({Yo:ue=>{X?it(hi,`Not sending because RPC '${e}' stream ${h} is closed:`,ue):(P||(it(hi,`Opening RPC '${e}' stream ${h} transport.`),N.open(),P=!0),it(hi,`RPC '${e}' stream ${h} sending:`,ue),N.send(ue))},Zo:()=>N.close()}),oe=(ue,Ye,ke)=>{ue.listen(Ye,(de=>{try{ke(de)}catch(Pe){setTimeout((()=>{throw Pe}),0)}}))};return oe(N,au.EventType.OPEN,(()=>{X||(it(hi,`RPC '${e}' stream ${h} transport opened.`),te.o_())})),oe(N,au.EventType.CLOSE,(()=>{X||(X=!0,it(hi,`RPC '${e}' stream ${h} transport closed`),te.a_(),this.E_(N))})),oe(N,au.EventType.ERROR,(ue=>{X||(X=!0,ac(hi,`RPC '${e}' stream ${h} transport errored. Name:`,ue.name,"Message:",ue.message),te.a_(new Ze(Ce.UNAVAILABLE,"The operation could not be completed")))})),oe(N,au.EventType.MESSAGE,(ue=>{if(!X){const Ye=ue.data[0];Nn(!!Ye,16349);const ke=Ye,de=ke?.error||ke[0]?.error;if(de){it(hi,`RPC '${e}' stream ${h} received error:`,de);const Pe=de.status;let ft=(function(j){const V=Rr[j];if(V!==void 0)return X_(V)})(Pe),qe=de.message;ft===void 0&&(ft=Ce.INTERNAL,qe="Unknown error status: "+Pe+" with message "+de.message),X=!0,te.a_(new Ze(ft,qe)),N.close()}else it(hi,`RPC '${e}' stream ${h} received:`,Ye),te.u_(Ye)}})),oe(v,u_.STAT_EVENT,(ue=>{ue.stat===k1.PROXY?it(hi,`RPC '${e}' stream ${h} detected buffering proxy`):ue.stat===k1.NOPROXY&&it(hi,`RPC '${e}' stream ${h} detected no buffering proxy`)})),setTimeout((()=>{te.__()}),0),te}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function y1(){return typeof document<"u"?document:null}function sd(s){return new zS(s,!0)}class aA{constructor(e,n,o=1e3,h=1.5,g=6e4){this.Mi=e,this.timerId=n,this.d_=o,this.A_=h,this.R_=g,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),o=Math.max(0,Date.now()-this.f_),h=Math.max(0,n-o);h>0&&it("ExponentialBackoff",`Backing off for ${h} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${o} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,h,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const DE="PersistentStream";class oA{constructor(e,n,o,h,g,E,v,b){this.Mi=e,this.S_=o,this.b_=h,this.connection=g,this.authCredentialsProvider=E,this.appCheckCredentialsProvider=v,this.listener=b,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new aA(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Ce.RESOURCE_EXHAUSTED?(Da(n.toString()),Da("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([o,h])=>{this.D_===n&&this.G_(o,h)}),(o=>{e((()=>{const h=new Ze(Ce.UNKNOWN,"Fetching auth token failed: "+o.message);return this.z_(h)}))}))}G_(e,n){const o=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{o((()=>this.listener.Xo()))})),this.stream.t_((()=>{o((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((h=>{o((()=>this.z_(h)))})),this.stream.onMessage((h=>{o((()=>++this.F_==1?this.J_(h):this.onNext(h)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return it(DE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(it(DE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class UI extends oA{constructor(e,n,o,h,g,E){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,o,h,E),this.serializer=g}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=qS(this.serializer,e),o=(function(g){if(!("targetChange"in g))return Ft.min();const E=g.targetChange;return E.targetIds&&E.targetIds.length?Ft.min():E.readTime?qs(E.readTime):Ft.min()})(e);return this.listener.H_(n,o)}Y_(e){const n={};n.database=G1(this.serializer),n.addTarget=(function(g,E){let v;const b=E.target;if(v=U1(b)?{documents:WS(g,b)}:{query:KS(g,b).ft},v.targetId=E.targetId,E.resumeToken.approximateByteSize()>0){v.resumeToken=K_(g,E.resumeToken);const _=j1(g,E.expectedCount);_!==null&&(v.expectedCount=_)}else if(E.snapshotVersion.compareTo(Ft.min())>0){v.readTime=Nf(g,E.snapshotVersion.toTimestamp());const _=j1(g,E.expectedCount);_!==null&&(v.expectedCount=_)}return v})(this.serializer,e);const o=ZS(this.serializer,e);o&&(n.labels=o),this.q_(n)}Z_(e){const n={};n.database=G1(this.serializer),n.removeTarget=e,this.q_(n)}}class FI extends oA{constructor(e,n,o,h,g,E){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,o,h,E),this.serializer=g}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Nn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Nn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Nn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=YS(e.writeResults,e.commitTime),o=qs(e.commitTime);return this.listener.na(o,n)}ra(){const e={};e.database=G1(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((o=>XS(this.serializer,o)))};this.q_(n)}}class jI{}class zI extends jI{constructor(e,n,o,h){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=o,this.serializer=h,this.ia=!1}sa(){if(this.ia)throw new Ze(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,o,h){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([g,E])=>this.connection.Go(e,z1(n,o),h,g,E))).catch((g=>{throw g.name==="FirebaseError"?(g.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),g):new Ze(Ce.UNKNOWN,g.toString())}))}Ho(e,n,o,h,g){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([E,v])=>this.connection.Ho(e,z1(n,o),h,E,v,g))).catch((E=>{throw E.name==="FirebaseError"?(E.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),E):new Ze(Ce.UNKNOWN,E.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class HI{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Da(n),this.aa=!1):it("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const dl="RemoteStore";class GI{constructor(e,n,o,h,g){this.localStore=e,this.datastore=n,this.asyncQueue=o,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=g,this.Aa.Oo((E=>{o.enqueueAndForget((async()=>{El(this)&&(it(dl,"Restarting streams for network reachability change."),await(async function(b){const _=Ht(b);_.Ea.add(4),await Bu(_),_.Ra.set("Unknown"),_.Ea.delete(4),await ad(_)})(this))}))})),this.Ra=new HI(o,h)}}async function ad(s){if(El(s))for(const e of s.da)await e(!0)}async function Bu(s){for(const e of s.da)await e(!1)}function lA(s,e){const n=Ht(s);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),kg(n)?Mg(n):xc(n).O_()&&Dg(n,e))}function Og(s,e){const n=Ht(s),o=xc(n);n.Ia.delete(e),o.O_()&&cA(n,e),n.Ia.size===0&&(o.O_()?o.L_():El(n)&&n.Ra.set("Unknown"))}function Dg(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ft.min())>0){const n=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}xc(s).Y_(e)}function cA(s,e){s.Va.Ue(e),xc(s).Z_(e)}function Mg(s){s.Va=new VS({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),xc(s).start(),s.Ra.ua()}function kg(s){return El(s)&&!xc(s).x_()&&s.Ia.size>0}function El(s){return Ht(s).Ea.size===0}function uA(s){s.Va=void 0}async function qI(s){s.Ra.set("Online")}async function XI(s){s.Ia.forEach(((e,n)=>{Dg(s,e)}))}async function YI(s,e){uA(s),kg(s)?(s.Ra.ha(e),Mg(s)):s.Ra.set("Unknown")}async function WI(s,e,n){if(s.Ra.set("Online"),e instanceof W_&&e.state===2&&e.cause)try{await(async function(h,g){const E=g.cause;for(const v of g.targetIds)h.Ia.has(v)&&(await h.remoteSyncer.rejectListen(v,E),h.Ia.delete(v),h.Va.removeTarget(v))})(s,e)}catch(o){it(dl,"Failed to remove targets %s: %s ",e.targetIds.join(","),o),await Df(s,o)}else if(e instanceof ff?s.Va.Ze(e):e instanceof Y_?s.Va.st(e):s.Va.tt(e),!n.isEqual(Ft.min()))try{const o=await sA(s.localStore);n.compareTo(o)>=0&&await(function(g,E){const v=g.Va.Tt(E);return v.targetChanges.forEach(((b,_)=>{if(b.resumeToken.approximateByteSize()>0){const S=g.Ia.get(_);S&&g.Ia.set(_,S.withResumeToken(b.resumeToken,E))}})),v.targetMismatches.forEach(((b,_)=>{const S=g.Ia.get(b);if(!S)return;g.Ia.set(b,S.withResumeToken(ni.EMPTY_BYTE_STRING,S.snapshotVersion)),cA(g,b);const N=new yo(S.target,b,_,S.sequenceNumber);Dg(g,N)})),g.remoteSyncer.applyRemoteEvent(v)})(s,n)}catch(o){it(dl,"Failed to raise snapshot:",o),await Df(s,o)}}async function Df(s,e,n){if(!yc(e))throw e;s.Ea.add(1),await Bu(s),s.Ra.set("Offline"),n||(n=()=>sA(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{it(dl,"Retrying IndexedDB access"),await n(),s.Ea.delete(1),await ad(s)}))}function hA(s,e){return e().catch((n=>Df(s,n,e)))}async function od(s){const e=Ht(s),n=Ro(e);let o=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Eg;for(;KI(e);)try{const h=await NI(e.localStore,o);if(h===null){e.Ta.length===0&&n.L_();break}o=h.batchId,QI(e,h)}catch(h){await Df(e,h)}fA(e)&&dA(e)}function KI(s){return El(s)&&s.Ta.length<10}function QI(s,e){s.Ta.push(e);const n=Ro(s);n.O_()&&n.X_&&n.ea(e.mutations)}function fA(s){return El(s)&&!Ro(s).x_()&&s.Ta.length>0}function dA(s){Ro(s).start()}async function ZI(s){Ro(s).ra()}async function JI(s){const e=Ro(s);for(const n of s.Ta)e.ea(n.mutations)}async function $I(s,e,n){const o=s.Ta.shift(),h=Tg.from(o,e,n);await hA(s,(()=>s.remoteSyncer.applySuccessfulWrite(h))),await od(s)}async function e4(s,e){e&&Ro(s).X_&&await(async function(o,h){if((function(E){return LS(E)&&E!==Ce.ABORTED})(h.code)){const g=o.Ta.shift();Ro(o).B_(),await hA(o,(()=>o.remoteSyncer.rejectFailedWrite(g.batchId,h))),await od(o)}})(s,e),fA(s)&&dA(s)}async function ME(s,e){const n=Ht(s);n.asyncQueue.verifyOperationInProgress(),it(dl,"RemoteStore received new credentials");const o=El(n);n.Ea.add(3),await Bu(n),o&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ad(n)}async function t4(s,e){const n=Ht(s);e?(n.Ea.delete(2),await ad(n)):e||(n.Ea.add(2),await Bu(n),n.Ra.set("Unknown"))}function xc(s){return s.ma||(s.ma=(function(n,o,h){const g=Ht(n);return g.sa(),new UI(o,g.connection,g.authCredentials,g.appCheckCredentials,g.serializer,h)})(s.datastore,s.asyncQueue,{Xo:qI.bind(null,s),t_:XI.bind(null,s),r_:YI.bind(null,s),H_:WI.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),kg(s)?Mg(s):s.Ra.set("Unknown")):(await s.ma.stop(),uA(s))}))),s.ma}function Ro(s){return s.fa||(s.fa=(function(n,o,h){const g=Ht(n);return g.sa(),new FI(o,g.connection,g.authCredentials,g.appCheckCredentials,g.serializer,h)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:ZI.bind(null,s),r_:e4.bind(null,s),ta:JI.bind(null,s),na:$I.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await od(s)):(await s.fa.stop(),s.Ta.length>0&&(it(dl,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Lg{constructor(e,n,o,h,g){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=o,this.op=h,this.removalCallback=g,this.deferred=new Ra,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((E=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,o,h,g){const E=Date.now()+o,v=new Lg(e,n,E,h,g);return v.start(o),v}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ze(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pg(s,e){if(Da("AsyncQueue",`${e}: ${s}`),yc(s))return new Ze(Ce.UNAVAILABLE,`${e}: ${s}`);throw s}class ic{static emptySet(e){return new ic(e.comparator)}constructor(e){this.comparator=e?(n,o)=>e(n,o)||wt.comparator(n.key,o.key):(n,o)=>wt.comparator(n.key,o.key),this.keyedMap=ou(),this.sortedSet=new ur(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,o)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ic)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),o=e.sortedSet.getIterator();for(;n.hasNext();){const h=n.getNext().key,g=o.getNext().key;if(!h.isEqual(g))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const o=new ic;return o.comparator=this.comparator,o.keyedMap=e,o.sortedSet=n,o}}class kE{constructor(){this.ga=new ur(wt.comparator)}track(e){const n=e.doc.key,o=this.ga.get(n);o?e.type!==0&&o.type===3?this.ga=this.ga.insert(n,e):e.type===3&&o.type!==1?this.ga=this.ga.insert(n,{type:o.type,doc:e.doc}):e.type===2&&o.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&o.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&o.type===0?this.ga=this.ga.remove(n):e.type===1&&o.type===2?this.ga=this.ga.insert(n,{type:1,doc:o.doc}):e.type===0&&o.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Dt(63341,{Rt:e,pa:o}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,o)=>{e.push(o)})),e}}class hc{constructor(e,n,o,h,g,E,v,b,_){this.query=e,this.docs=n,this.oldDocs=o,this.docChanges=h,this.mutatedKeys=g,this.fromCache=E,this.syncStateChanged=v,this.excludesMetadataChanges=b,this.hasCachedResults=_}static fromInitialDocuments(e,n,o,h,g){const E=[];return n.forEach((v=>{E.push({type:0,doc:v})})),new hc(e,n,ic.emptySet(n),E,o,h,!0,!1,g)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$f(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,o=e.docChanges;if(n.length!==o.length)return!1;for(let h=0;h<n.length;h++)if(n[h].type!==o[h].type||!n[h].doc.isEqual(o[h].doc))return!1;return!0}}class n4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class r4{constructor(){this.queries=LE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,o){const h=Ht(n),g=h.queries;h.queries=LE(),g.forEach(((E,v)=>{for(const b of v.Sa)b.onError(o)}))})(this,new Ze(Ce.ABORTED,"Firestore shutting down"))}}function LE(){return new yl((s=>k_(s)),$f)}async function Bg(s,e){const n=Ht(s);let o=3;const h=e.query;let g=n.queries.get(h);g?!g.ba()&&e.Da()&&(o=2):(g=new n4,o=e.Da()?0:1);try{switch(o){case 0:g.wa=await n.onListen(h,!0);break;case 1:g.wa=await n.onListen(h,!1);break;case 2:await n.onFirstRemoteStoreListen(h)}}catch(E){const v=Pg(E,`Initialization of query '${Kl(e.query)}' failed`);return void e.onError(v)}n.queries.set(h,g),g.Sa.push(e),e.va(n.onlineState),g.wa&&e.Fa(g.wa)&&Ug(n)}async function Vg(s,e){const n=Ht(s),o=e.query;let h=3;const g=n.queries.get(o);if(g){const E=g.Sa.indexOf(e);E>=0&&(g.Sa.splice(E,1),g.Sa.length===0?h=e.Da()?0:1:!g.ba()&&e.Da()&&(h=2))}switch(h){case 0:return n.queries.delete(o),n.onUnlisten(o,!0);case 1:return n.queries.delete(o),n.onUnlisten(o,!1);case 2:return n.onLastRemoteStoreUnlisten(o);default:return}}function i4(s,e){const n=Ht(s);let o=!1;for(const h of e){const g=h.query,E=n.queries.get(g);if(E){for(const v of E.Sa)v.Fa(h)&&(o=!0);E.wa=h}}o&&Ug(n)}function s4(s,e,n){const o=Ht(s),h=o.queries.get(e);if(h)for(const g of h.Sa)g.onError(n);o.queries.delete(e)}function Ug(s){s.Ca.forEach((e=>{e.next()}))}var Y1,PE;(PE=Y1||(Y1={})).Ma="default",PE.Cache="cache";class Fg{constructor(e,n,o){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=o||{}}Fa(e){if(!this.options.includeMetadataChanges){const o=[];for(const h of e.docChanges)h.type!==3&&o.push(h);e=new hc(e.query,e.docs,e.oldDocs,o,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const o=n!=="Offline";return(!this.options.qa||!o)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=hc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Y1.Cache}}class gA{constructor(e){this.key=e}}class mA{constructor(e){this.key=e}}class a4{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=dn(),this.mutatedKeys=dn(),this.eu=L_(e),this.tu=new ic(this.eu)}get nu(){return this.Ya}ru(e,n){const o=n?n.iu:new kE,h=n?n.tu:this.tu;let g=n?n.mutatedKeys:this.mutatedKeys,E=h,v=!1;const b=this.query.limitType==="F"&&h.size===this.query.limit?h.last():null,_=this.query.limitType==="L"&&h.size===this.query.limit?h.first():null;if(e.inorderTraversal(((S,N)=>{const P=h.get(S),X=ed(this.query,N)?N:null,te=!!P&&this.mutatedKeys.has(P.key),oe=!!X&&(X.hasLocalMutations||this.mutatedKeys.has(X.key)&&X.hasCommittedMutations);let ue=!1;P&&X?P.data.isEqual(X.data)?te!==oe&&(o.track({type:3,doc:X}),ue=!0):this.su(P,X)||(o.track({type:2,doc:X}),ue=!0,(b&&this.eu(X,b)>0||_&&this.eu(X,_)<0)&&(v=!0)):!P&&X?(o.track({type:0,doc:X}),ue=!0):P&&!X&&(o.track({type:1,doc:P}),ue=!0,(b||_)&&(v=!0)),ue&&(X?(E=E.add(X),g=oe?g.add(S):g.delete(S)):(E=E.delete(S),g=g.delete(S)))})),this.query.limit!==null)for(;E.size>this.query.limit;){const S=this.query.limitType==="F"?E.last():E.first();E=E.delete(S.key),g=g.delete(S.key),o.track({type:1,doc:S})}return{tu:E,iu:o,Cs:v,mutatedKeys:g}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,o,h){const g=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const E=e.iu.ya();E.sort(((S,N)=>(function(X,te){const oe=ue=>{switch(ue){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dt(20277,{Rt:ue})}};return oe(X)-oe(te)})(S.type,N.type)||this.eu(S.doc,N.doc))),this.ou(o),h=h??!1;const v=n&&!h?this._u():[],b=this.Xa.size===0&&this.current&&!h?1:0,_=b!==this.Za;return this.Za=b,E.length!==0||_?{snapshot:new hc(this.query,e.tu,g,E,e.mutatedKeys,b===0,_,!1,!!o&&o.resumeToken.approximateByteSize()>0),au:v}:{au:v}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new kE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=dn(),this.tu.forEach((o=>{this.uu(o.key)&&(this.Xa=this.Xa.add(o.key))}));const n=[];return e.forEach((o=>{this.Xa.has(o)||n.push(new mA(o))})),this.Xa.forEach((o=>{e.has(o)||n.push(new gA(o))})),n}cu(e){this.Ya=e.Qs,this.Xa=dn();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return hc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const jg="SyncEngine";class o4{constructor(e,n,o){this.query=e,this.targetId=n,this.view=o}}class l4{constructor(e){this.key=e,this.hu=!1}}class c4{constructor(e,n,o,h,g,E){this.localStore=e,this.remoteStore=n,this.eventManager=o,this.sharedClientState=h,this.currentUser=g,this.maxConcurrentLimboResolutions=E,this.Pu={},this.Tu=new yl((v=>k_(v)),$f),this.Iu=new Map,this.Eu=new Set,this.du=new ur(wt.comparator),this.Au=new Map,this.Ru=new Sg,this.Vu={},this.mu=new Map,this.fu=uc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function u4(s,e,n=!0){const o=AA(s);let h;const g=o.Tu.get(e);return g?(o.sharedClientState.addLocalQueryTarget(g.targetId),h=g.view.lu()):h=await pA(o,e,n,!0),h}async function h4(s,e){const n=AA(s);await pA(n,e,!0,!1)}async function pA(s,e,n,o){const h=await OI(s.localStore,Gs(e)),g=h.targetId,E=s.sharedClientState.addLocalQueryTarget(g,n);let v;return o&&(v=await f4(s,e,g,E==="current",h.resumeToken)),s.isPrimaryClient&&n&&lA(s.remoteStore,h),v}async function f4(s,e,n,o,h){s.pu=(N,P,X)=>(async function(oe,ue,Ye,ke){let de=ue.view.ru(Ye);de.Cs&&(de=await IE(oe.localStore,ue.query,!1).then((({documents:F})=>ue.view.ru(F,de))));const Pe=ke&&ke.targetChanges.get(ue.targetId),ft=ke&&ke.targetMismatches.get(ue.targetId)!=null,qe=ue.view.applyChanges(de,oe.isPrimaryClient,Pe,ft);return VE(oe,ue.targetId,qe.au),qe.snapshot})(s,N,P,X);const g=await IE(s.localStore,e,!0),E=new a4(e,g.Qs),v=E.ru(g.documents),b=Pu.createSynthesizedTargetChangeForCurrentChange(n,o&&s.onlineState!=="Offline",h),_=E.applyChanges(v,s.isPrimaryClient,b);VE(s,n,_.au);const S=new o4(e,n,E);return s.Tu.set(e,S),s.Iu.has(n)?s.Iu.get(n).push(e):s.Iu.set(n,[e]),_.snapshot}async function d4(s,e,n){const o=Ht(s),h=o.Tu.get(e),g=o.Iu.get(h.targetId);if(g.length>1)return o.Iu.set(h.targetId,g.filter((E=>!$f(E,e)))),void o.Tu.delete(e);o.isPrimaryClient?(o.sharedClientState.removeLocalQueryTarget(h.targetId),o.sharedClientState.isActiveQueryTarget(h.targetId)||await q1(o.localStore,h.targetId,!1).then((()=>{o.sharedClientState.clearQueryState(h.targetId),n&&Og(o.remoteStore,h.targetId),W1(o,h.targetId)})).catch(pc)):(W1(o,h.targetId),await q1(o.localStore,h.targetId,!0))}async function g4(s,e){const n=Ht(s),o=n.Tu.get(e),h=n.Iu.get(o.targetId);n.isPrimaryClient&&h.length===1&&(n.sharedClientState.removeLocalQueryTarget(o.targetId),Og(n.remoteStore,o.targetId))}async function m4(s,e,n){const o=w4(s);try{const h=await(function(E,v){const b=Ht(E),_=Rn.now(),S=v.reduce(((X,te)=>X.add(te.key)),dn());let N,P;return b.persistence.runTransaction("Locally write mutations","readwrite",(X=>{let te=Ma(),oe=dn();return b.Ns.getEntries(X,S).next((ue=>{te=ue,te.forEach(((Ye,ke)=>{ke.isValidDocument()||(oe=oe.add(Ye))}))})).next((()=>b.localDocuments.getOverlayedDocuments(X,te))).next((ue=>{N=ue;const Ye=[];for(const ke of v){const de=NS(ke,N.get(ke.key).overlayedDocument);de!=null&&Ye.push(new ko(ke.key,de,C_(de.value.mapValue),Ti.exists(!0)))}return b.mutationQueue.addMutationBatch(X,_,Ye,v)})).next((ue=>{P=ue;const Ye=ue.applyToLocalDocumentSet(N,oe);return b.documentOverlayCache.saveOverlays(X,ue.batchId,Ye)}))})).then((()=>({batchId:P.batchId,changes:B_(N)})))})(o.localStore,e);o.sharedClientState.addPendingMutation(h.batchId),(function(E,v,b){let _=E.Vu[E.currentUser.toKey()];_||(_=new ur(fn)),_=_.insert(v,b),E.Vu[E.currentUser.toKey()]=_})(o,h.batchId,n),await Vu(o,h.changes),await od(o.remoteStore)}catch(h){const g=Pg(h,"Failed to persist write");n.reject(g)}}async function yA(s,e){const n=Ht(s);try{const o=await II(n.localStore,e);e.targetChanges.forEach(((h,g)=>{const E=n.Au.get(g);E&&(Nn(h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size<=1,22616),h.addedDocuments.size>0?E.hu=!0:h.modifiedDocuments.size>0?Nn(E.hu,14607):h.removedDocuments.size>0&&(Nn(E.hu,42227),E.hu=!1))})),await Vu(n,o,e)}catch(o){await pc(o)}}function BE(s,e,n){const o=Ht(s);if(o.isPrimaryClient&&n===0||!o.isPrimaryClient&&n===1){const h=[];o.Tu.forEach(((g,E)=>{const v=E.view.va(e);v.snapshot&&h.push(v.snapshot)})),(function(E,v){const b=Ht(E);b.onlineState=v;let _=!1;b.queries.forEach(((S,N)=>{for(const P of N.Sa)P.va(v)&&(_=!0)})),_&&Ug(b)})(o.eventManager,e),h.length&&o.Pu.H_(h),o.onlineState=e,o.isPrimaryClient&&o.sharedClientState.setOnlineState(e)}}async function p4(s,e,n){const o=Ht(s);o.sharedClientState.updateQueryState(e,"rejected",n);const h=o.Au.get(e),g=h&&h.key;if(g){let E=new ur(wt.comparator);E=E.insert(g,di.newNoDocument(g,Ft.min()));const v=dn().add(g),b=new id(Ft.min(),new Map,new ur(fn),E,v);await yA(o,b),o.du=o.du.remove(g),o.Au.delete(e),zg(o)}else await q1(o.localStore,e,!1).then((()=>W1(o,e,n))).catch(pc)}async function y4(s,e){const n=Ht(s),o=e.batch.batchId;try{const h=await SI(n.localStore,e);xA(n,o,null),EA(n,o),n.sharedClientState.updateMutationState(o,"acknowledged"),await Vu(n,h)}catch(h){await pc(h)}}async function E4(s,e,n){const o=Ht(s);try{const h=await(function(E,v){const b=Ht(E);return b.persistence.runTransaction("Reject batch","readwrite-primary",(_=>{let S;return b.mutationQueue.lookupMutationBatch(_,v).next((N=>(Nn(N!==null,37113),S=N.keys(),b.mutationQueue.removeMutationBatch(_,N)))).next((()=>b.mutationQueue.performConsistencyCheck(_))).next((()=>b.documentOverlayCache.removeOverlaysForBatchId(_,S,v))).next((()=>b.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(_,S))).next((()=>b.localDocuments.getDocuments(_,S)))}))})(o.localStore,e);xA(o,e,n),EA(o,e),o.sharedClientState.updateMutationState(e,"rejected",n),await Vu(o,h)}catch(h){await pc(h)}}function EA(s,e){(s.mu.get(e)||[]).forEach((n=>{n.resolve()})),s.mu.delete(e)}function xA(s,e,n){const o=Ht(s);let h=o.Vu[o.currentUser.toKey()];if(h){const g=h.get(e);g&&(n?g.reject(n):g.resolve(),h=h.remove(e)),o.Vu[o.currentUser.toKey()]=h}}function W1(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const o of s.Iu.get(e))s.Tu.delete(o),n&&s.Pu.yu(o,n);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((o=>{s.Ru.containsKey(o)||_A(s,o)}))}function _A(s,e){s.Eu.delete(e.path.canonicalString());const n=s.du.get(e);n!==null&&(Og(s.remoteStore,n),s.du=s.du.remove(e),s.Au.delete(n),zg(s))}function VE(s,e,n){for(const o of n)o instanceof gA?(s.Ru.addReference(o.key,e),x4(s,o)):o instanceof mA?(it(jg,"Document no longer in limbo: "+o.key),s.Ru.removeReference(o.key,e),s.Ru.containsKey(o.key)||_A(s,o.key)):Dt(19791,{wu:o})}function x4(s,e){const n=e.key,o=n.path.canonicalString();s.du.get(n)||s.Eu.has(o)||(it(jg,"New document in limbo: "+n),s.Eu.add(o),zg(s))}function zg(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const n=new wt(Gn.fromString(e)),o=s.fu.next();s.Au.set(o,new l4(n)),s.du=s.du.insert(n,o),lA(s.remoteStore,new yo(Gs(Jf(n.path)),o,"TargetPurposeLimboResolution",Kf.ce))}}async function Vu(s,e,n){const o=Ht(s),h=[],g=[],E=[];o.Tu.isEmpty()||(o.Tu.forEach(((v,b)=>{E.push(o.pu(b,e,n).then((_=>{if((_||n)&&o.isPrimaryClient){const S=_?!_.fromCache:n?.targetChanges.get(b.targetId)?.current;o.sharedClientState.updateQueryState(b.targetId,S?"current":"not-current")}if(_){h.push(_);const S=Rg.As(b.targetId,_);g.push(S)}})))})),await Promise.all(E),o.Pu.H_(h),await(async function(b,_){const S=Ht(b);try{await S.persistence.runTransaction("notifyLocalViewChanges","readwrite",(N=>Oe.forEach(_,(P=>Oe.forEach(P.Es,(X=>S.persistence.referenceDelegate.addReference(N,P.targetId,X))).next((()=>Oe.forEach(P.ds,(X=>S.persistence.referenceDelegate.removeReference(N,P.targetId,X)))))))))}catch(N){if(!yc(N))throw N;it(Ng,"Failed to update sequence numbers: "+N)}for(const N of _){const P=N.targetId;if(!N.fromCache){const X=S.Ms.get(P),te=X.snapshotVersion,oe=X.withLastLimboFreeSnapshotVersion(te);S.Ms=S.Ms.insert(P,oe)}}})(o.localStore,g))}async function _4(s,e){const n=Ht(s);if(!n.currentUser.isEqual(e)){it(jg,"User change. New user:",e.toKey());const o=await iA(n.localStore,e);n.currentUser=e,(function(g,E){g.mu.forEach((v=>{v.forEach((b=>{b.reject(new Ze(Ce.CANCELLED,E))}))})),g.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,o.removedBatchIds,o.addedBatchIds),await Vu(n,o.Ls)}}function A4(s,e){const n=Ht(s),o=n.Au.get(e);if(o&&o.hu)return dn().add(o.key);{let h=dn();const g=n.Iu.get(e);if(!g)return h;for(const E of g){const v=n.Tu.get(E);h=h.unionWith(v.view.nu)}return h}}function AA(s){const e=Ht(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=yA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=A4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p4.bind(null,e),e.Pu.H_=i4.bind(null,e.eventManager),e.Pu.yu=s4.bind(null,e.eventManager),e}function w4(s){const e=Ht(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=y4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=E4.bind(null,e),e}class Mf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return CI(this.persistence,new bI,e.initialUser,this.serializer)}Cu(e){return new rA(Ig.mi,this.serializer)}Du(e){return new MI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mf.provider={build:()=>new Mf};class b4 extends Mf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Nn(this.persistence.referenceDelegate instanceof Of,46915);const o=this.persistence.referenceDelegate.garbageCollector;return new lI(o,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Pi.withCacheSize(this.cacheSizeBytes):Pi.DEFAULT;return new rA((o=>Of.mi(o,n)),this.serializer)}}class K1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=o=>BE(this.syncEngine,o,1),this.remoteStore.remoteSyncer.handleCredentialChange=_4.bind(null,this.syncEngine),await t4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new r4})()}createDatastore(e){const n=sd(e.databaseInfo.databaseId),o=(function(g){return new VI(g)})(e.databaseInfo);return(function(g,E,v,b){return new zI(g,E,v,b)})(e.authCredentials,e.appCheckCredentials,o,n)}createRemoteStore(e){return(function(o,h,g,E,v){return new GI(o,h,g,E,v)})(this.localStore,this.datastore,e.asyncQueue,(n=>BE(this.syncEngine,n,0)),(function(){return OE.v()?new OE:new kI})())}createSyncEngine(e,n){return(function(h,g,E,v,b,_,S){const N=new c4(h,g,E,v,b,_);return S&&(N.gu=!0),N})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const o=Ht(n);it(dl,"RemoteStore shutting down."),o.Ea.add(5),await Bu(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}K1.provider={build:()=>new K1};class Hg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Da("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const No="FirestoreClient";class T4{constructor(e,n,o,h,g){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=o,this.databaseInfo=h,this.user=fi.UNAUTHENTICATED,this.clientId=yg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=g,this.authCredentials.start(o,(async E=>{it(No,"Received user=",E.uid),await this.authCredentialListener(E),this.user=E})),this.appCheckCredentials.start(o,(E=>(it(No,"Received new app check token=",E),this.appCheckCredentialListener(E,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ra;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const o=Pg(n,"Failed to shutdown persistence");e.reject(o)}})),e.promise}}async function E1(s,e){s.asyncQueue.verifyOperationInProgress(),it(No,"Initializing OfflineComponentProvider");const n=s.configuration;await e.initialize(n);let o=n.initialUser;s.setCredentialChangeListener((async h=>{o.isEqual(h)||(await iA(e.localStore,h),o=h)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function UE(s,e){s.asyncQueue.verifyOperationInProgress();const n=await v4(s);it(No,"Initializing OnlineComponentProvider"),await e.initialize(n,s.configuration),s.setCredentialChangeListener((o=>ME(e.remoteStore,o))),s.setAppCheckTokenChangeListener(((o,h)=>ME(e.remoteStore,h))),s._onlineComponents=e}async function v4(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){it(No,"Using user provided OfflineComponentProvider");try{await E1(s,s._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(h){return h.name==="FirebaseError"?h.code===Ce.FAILED_PRECONDITION||h.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&h instanceof DOMException)||h.code===22||h.code===20||h.code===11})(n))throw n;ac("Error using user provided cache. Falling back to memory cache: "+n),await E1(s,new Mf)}}else it(No,"Using default OfflineComponentProvider"),await E1(s,new b4(void 0));return s._offlineComponents}async function wA(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(it(No,"Using user provided OnlineComponentProvider"),await UE(s,s._uninitializedComponentsProvider._online)):(it(No,"Using default OnlineComponentProvider"),await UE(s,new K1))),s._onlineComponents}function C4(s){return wA(s).then((e=>e.syncEngine))}async function kf(s){const e=await wA(s),n=e.eventManager;return n.onListen=u4.bind(null,e.syncEngine),n.onUnlisten=d4.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=h4.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=g4.bind(null,e.syncEngine),n}function S4(s,e,n={}){const o=new Ra;return s.asyncQueue.enqueueAndForget((async()=>(function(g,E,v,b,_){const S=new Hg({next:P=>{S.Nu(),E.enqueueAndForget((()=>Vg(g,N)));const X=P.docs.has(v);!X&&P.fromCache?_.reject(new Ze(Ce.UNAVAILABLE,"Failed to get document because the client is offline.")):X&&P.fromCache&&b&&b.source==="server"?_.reject(new Ze(Ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):_.resolve(P)},error:P=>_.reject(P)}),N=new Fg(Jf(v.path),S,{includeMetadataChanges:!0,qa:!0});return Bg(g,N)})(await kf(s),s.asyncQueue,e,n,o))),o.promise}function I4(s,e,n={}){const o=new Ra;return s.asyncQueue.enqueueAndForget((async()=>(function(g,E,v,b,_){const S=new Hg({next:P=>{S.Nu(),E.enqueueAndForget((()=>Vg(g,N))),P.fromCache&&b.source==="server"?_.reject(new Ze(Ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):_.resolve(P)},error:P=>_.reject(P)}),N=new Fg(v,S,{includeMetadataChanges:!0,qa:!0});return Bg(g,N)})(await kf(s),s.asyncQueue,e,n,o))),o.promise}function bA(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const FE=new Map;const TA="firestore.googleapis.com",jE=!0;class zE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ze(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=TA,this.ssl=jE}else this.host=e.host,this.ssl=e.ssl??jE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=nA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<aI)throw new Ze(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}H3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bA(e.experimentalLongPollingOptions??{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Ze(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Ze(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Ze(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(o,h){return o.timeoutSeconds===h.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ld{constructor(e,n,o,h){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=o,this._app=h,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ze(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ze(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(o){if(!o)return new M3;switch(o.type){case"firstParty":return new B3(o.sessionIndex||"0",o.iamToken||null,o.authTokenFactory||null);case"provider":return o.client;default:throw new Ze(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const o=FE.get(n);o&&(it("ComponentProvider","Removing Datastore"),FE.delete(n),o.terminate())})(this),Promise.resolve()}}function R4(s,e,n,o={}){s=bi(s,ld);const h=Oo(e),g=s._getSettings(),E={...g,emulatorOptions:s._getEmulatorOptions()},v=`${e}:${n}`;h&&(rg(`https://${v}`),ig("Firestore",!0)),g.host!==TA&&g.host!==v&&ac("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const b={...g,host:v,ssl:h,emulatorOptions:o};if(!ll(b,E)&&(s._setSettings(b),o.mockUserToken)){let _,S;if(typeof o.mockUserToken=="string")_=o.mockUserToken,S=fi.MOCK_USER;else{_=Fb(o.mockUserToken,s._app?.options.projectId);const N=o.mockUserToken.sub||o.mockUserToken.user_id;if(!N)throw new Ze(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new fi(N)}s._authCredentials=new k3(new g_(_,S))}}class La{constructor(e,n,o){this.converter=n,this._query=o,this.type="query",this.firestore=e}withConverter(e){return new La(this.firestore,e,this._query)}}class yr{constructor(e,n,o){this.converter=n,this._key=o,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yr(this.firestore,e,this._key)}toJSON(){return{type:yr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,o){if(ku(n,yr._jsonSchema))return new yr(e,o||null,new wt(Gn.fromString(n.referencePath)))}}yr._jsonSchemaVersion="firestore/documentReference/1.0",yr._jsonSchema={type:Dr("string",yr._jsonSchemaVersion),referencePath:Dr("string")};class wo extends La{constructor(e,n,o){super(e,n,Jf(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yr(this.firestore,null,new wt(e))}withConverter(e){return new wo(this.firestore,e,this._path)}}function wr(s,e,...n){if(s=qn(s),m_("collection","path",e),s instanceof ld){const o=Gn.fromString(e,...n);return tE(o),new wo(s,null,o)}{if(!(s instanceof yr||s instanceof wo))throw new Ze(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(Gn.fromString(e,...n));return tE(o),new wo(s.firestore,null,o)}}function Un(s,e,...n){if(s=qn(s),arguments.length===1&&(e=yg.newId()),m_("doc","path",e),s instanceof ld){const o=Gn.fromString(e,...n);return eE(o),new yr(s,null,new wt(o))}{if(!(s instanceof yr||s instanceof wo))throw new Ze(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(Gn.fromString(e,...n));return eE(o),new yr(s.firestore,s instanceof wo?s.converter:null,new wt(o))}}const HE="AsyncQueue";class GE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new aA(this,"async_queue_retry"),this._c=()=>{const o=y1();o&&it(HE,"Visibility state changed to "+o.visibilityState),this.M_.w_()},this.ac=e;const n=y1();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=y1();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Ra;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!yc(e))throw e;it(HE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((o=>{throw this.nc=o,this.rc=!1,Da("INTERNAL UNHANDLED ERROR: ",qE(o)),o})).then((o=>(this.rc=!1,o))))));return this.ac=n,n}enqueueAfterDelay(e,n,o){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const h=Lg.createAndSchedule(this,e,n,o,(g=>this.hc(g)));return this.tc.push(h),h}uc(){this.nc&&Dt(47125,{Pc:qE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,o)=>n.targetTimeMs-o.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function qE(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}function XE(s){return(function(n,o){if(typeof n!="object"||n===null)return!1;const h=n;for(const g of o)if(g in h&&typeof h[g]=="function")return!0;return!1})(s,["next","error","complete"])}class Ks extends ld{constructor(e,n,o,h){super(e,n,o,h),this.type="firestore",this._queue=new GE,this._persistenceKey=h?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new GE(e),this._firestoreClient=void 0,await e}}}function N4(s,e){const n=typeof s=="object"?s:Gf(),o=typeof s=="string"?s:vf,h=Hf(n,"firestore").getImmediate({identifier:o});if(!h._initialized){const g=yx("firestore");g&&R4(h,...g)}return h}function Uu(s){if(s._terminated)throw new Ze(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||O4(s),s._firestoreClient}function O4(s){const e=s._freezeSettings(),n=(function(h,g,E,v){return new eS(h,g,E,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,bA(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new T4(s._authCredentials,s._appCheckCredentials,s._queue,n,s._componentsProvider&&(function(h){const g=h?._online.build();return{_offline:h?._offline.build(g),_online:g}})(s._componentsProvider))}class ps{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ps(ni.fromBase64String(e))}catch(n){throw new Ze(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ps(ni.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ps._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ku(e,ps._jsonSchema))return ps.fromBase64String(e.bytes)}}ps._jsonSchemaVersion="firestore/bytes/1.0",ps._jsonSchema={type:Dr("string",ps._jsonSchemaVersion),bytes:Dr("string")};class Fu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ze(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ti(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cd{constructor(e){this._methodName=e}}class Xs{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ze(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ze(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return fn(this._lat,e._lat)||fn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Xs._jsonSchemaVersion}}static fromJSON(e){if(ku(e,Xs._jsonSchema))return new Xs(e.latitude,e.longitude)}}Xs._jsonSchemaVersion="firestore/geoPoint/1.0",Xs._jsonSchema={type:Dr("string",Xs._jsonSchemaVersion),latitude:Dr("number"),longitude:Dr("number")};class Ys{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(o,h){if(o.length!==h.length)return!1;for(let g=0;g<o.length;++g)if(o[g]!==h[g])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ys._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ku(e,Ys._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Ys(e.vectorValues);throw new Ze(Ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ys._jsonSchemaVersion="firestore/vectorValue/1.0",Ys._jsonSchema={type:Dr("string",Ys._jsonSchemaVersion),vectorValues:Dr("object")};const D4=/^__.*__$/;class M4{constructor(e,n,o){this.data=e,this.fieldMask=n,this.fieldTransforms=o}toMutation(e,n){return this.fieldMask!==null?new ko(e,this.data,this.fieldMask,n,this.fieldTransforms):new Lu(e,this.data,n,this.fieldTransforms)}}class vA{constructor(e,n,o){this.data=e,this.fieldMask=n,this.fieldTransforms=o}toMutation(e,n){return new ko(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function CA(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Dt(40011,{Ac:s})}}class Gg{constructor(e,n,o,h,g,E){this.settings=e,this.databaseId=n,this.serializer=o,this.ignoreUndefinedProperties=h,g===void 0&&this.Rc(),this.fieldTransforms=g||[],this.fieldMask=E||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Gg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),o=this.Vc({path:n,fc:!1});return o.gc(e),o}yc(e){const n=this.path?.child(e),o=this.Vc({path:n,fc:!1});return o.Rc(),o}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Lf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(CA(this.Ac)&&D4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class k4{constructor(e,n,o){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=o||sd(e)}Cc(e,n,o,h=!1){return new Gg({Ac:e,methodName:n,Dc:o,path:ti.emptyPath(),fc:!1,bc:h},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ju(s){const e=s._freezeSettings(),n=sd(s._databaseId);return new k4(s._databaseId,!!e.ignoreUndefinedProperties,n)}function qg(s,e,n,o,h,g={}){const E=s.Cc(g.merge||g.mergeFields?2:0,e,n,h);Yg("Data must be an object, but it was:",E,o);const v=RA(o,E);let b,_;if(g.merge)b=new es(E.fieldMask),_=E.fieldTransforms;else if(g.mergeFields){const S=[];for(const N of g.mergeFields){const P=Q1(e,N,n);if(!E.contains(P))throw new Ze(Ce.INVALID_ARGUMENT,`Field '${P}' is specified in your field mask but missing from your input data.`);OA(S,P)||S.push(P)}b=new es(S),_=E.fieldTransforms.filter((N=>b.covers(N.field)))}else b=null,_=E.fieldTransforms;return new M4(new Vi(v),b,_)}class ud extends cd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ud}}class Xg extends cd{_toFieldTransform(e){return new CS(e.path,new vu)}isEqual(e){return e instanceof Xg}}function SA(s,e,n,o){const h=s.Cc(1,e,n);Yg("Data must be an object, but it was:",h,o);const g=[],E=Vi.empty();Mo(o,((b,_)=>{const S=Wg(e,b,n);_=qn(_);const N=h.yc(S);if(_ instanceof ud)g.push(S);else{const P=zu(_,N);P!=null&&(g.push(S),E.set(S,P))}}));const v=new es(g);return new vA(E,v,h.fieldTransforms)}function IA(s,e,n,o,h,g){const E=s.Cc(1,e,n),v=[Q1(e,o,n)],b=[h];if(g.length%2!=0)throw new Ze(Ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let P=0;P<g.length;P+=2)v.push(Q1(e,g[P])),b.push(g[P+1]);const _=[],S=Vi.empty();for(let P=v.length-1;P>=0;--P)if(!OA(_,v[P])){const X=v[P];let te=b[P];te=qn(te);const oe=E.yc(X);if(te instanceof ud)_.push(X);else{const ue=zu(te,oe);ue!=null&&(_.push(X),S.set(X,ue))}}const N=new es(_);return new vA(S,N,E.fieldTransforms)}function L4(s,e,n,o=!1){return zu(n,s.Cc(o?4:3,e))}function zu(s,e){if(NA(s=qn(s)))return Yg("Unsupported field value:",e,s),RA(s,e);if(s instanceof cd)return(function(o,h){if(!CA(h.Ac))throw h.Sc(`${o._methodName}() can only be used with update() and set()`);if(!h.path)throw h.Sc(`${o._methodName}() is not currently supported inside arrays`);const g=o._toFieldTransform(h);g&&h.fieldTransforms.push(g)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(o,h){const g=[];let E=0;for(const v of o){let b=zu(v,h.wc(E));b==null&&(b={nullValue:"NULL_VALUE"}),g.push(b),E++}return{arrayValue:{values:g}}})(s,e)}return(function(o,h){if((o=qn(o))===null)return{nullValue:"NULL_VALUE"};if(typeof o=="number")return bS(h.serializer,o);if(typeof o=="boolean")return{booleanValue:o};if(typeof o=="string")return{stringValue:o};if(o instanceof Date){const g=Rn.fromDate(o);return{timestampValue:Nf(h.serializer,g)}}if(o instanceof Rn){const g=new Rn(o.seconds,1e3*Math.floor(o.nanoseconds/1e3));return{timestampValue:Nf(h.serializer,g)}}if(o instanceof Xs)return{geoPointValue:{latitude:o.latitude,longitude:o.longitude}};if(o instanceof ps)return{bytesValue:K_(h.serializer,o._byteString)};if(o instanceof yr){const g=h.databaseId,E=o.firestore._databaseId;if(!E.isEqual(g))throw h.Sc(`Document reference is for database ${E.projectId}/${E.database} but should be for database ${g.projectId}/${g.database}`);return{referenceValue:Cg(o.firestore._databaseId||h.databaseId,o._key.path)}}if(o instanceof Ys)return(function(E,v){return{mapValue:{fields:{[T_]:{stringValue:v_},[Cf]:{arrayValue:{values:E.toArray().map((_=>{if(typeof _!="number")throw v.Sc("VectorValues must only contain numeric values.");return bg(v.serializer,_)}))}}}}}})(o,h);throw h.Sc(`Unsupported field value: ${Wf(o)}`)})(s,e)}function RA(s,e){const n={};return E_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mo(s,((o,h)=>{const g=zu(h,e.mc(o));g!=null&&(n[o]=g)})),{mapValue:{fields:n}}}function NA(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Rn||s instanceof Xs||s instanceof ps||s instanceof yr||s instanceof cd||s instanceof Ys)}function Yg(s,e,n){if(!NA(n)||!p_(n)){const o=Wf(n);throw o==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+o)}}function Q1(s,e,n){if((e=qn(e))instanceof Fu)return e._internalPath;if(typeof e=="string")return Wg(s,e);throw Lf("Field path arguments must be of type string or ",s,!1,void 0,n)}const P4=new RegExp("[~\\*/\\[\\]]");function Wg(s,e,n){if(e.search(P4)>=0)throw Lf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new Fu(...e.split("."))._internalPath}catch{throw Lf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function Lf(s,e,n,o,h){const g=o&&!o.isEmpty(),E=h!==void 0;let v=`Function ${e}() called with invalid data`;n&&(v+=" (via `toFirestore()`)"),v+=". ";let b="";return(g||E)&&(b+=" (found",g&&(b+=` in field ${o}`),E&&(b+=` in document ${h}`),b+=")"),new Ze(Ce.INVALID_ARGUMENT,v+s+b)}function OA(s,e){return s.some((n=>n.isEqual(e)))}class DA{constructor(e,n,o,h,g){this._firestore=e,this._userDataWriter=n,this._key=o,this._document=h,this._converter=g}get id(){return this._key.path.lastSegment()}get ref(){return new yr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new B4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(hd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class B4 extends DA{data(){return super.data()}}function hd(s,e){return typeof e=="string"?Wg(s,e):e instanceof Fu?e._internalPath:e._delegate._internalPath}function MA(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ze(Ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kg{}class Qg extends Kg{}function Ia(s,e,...n){let o=[];e instanceof Kg&&o.push(e),o=o.concat(n),(function(g){const E=g.filter((b=>b instanceof Zg)).length,v=g.filter((b=>b instanceof fd)).length;if(E>1||E>0&&v>0)throw new Ze(Ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(o);for(const h of o)s=h._apply(s);return s}class fd extends Qg{constructor(e,n,o){super(),this._field=e,this._op=n,this._value=o,this.type="where"}static _create(e,n,o){return new fd(e,n,o)}_apply(e){const n=this._parse(e);return kA(e._query,n),new La(e.firestore,e.converter,F1(e._query,n))}_parse(e){const n=ju(e.firestore);return(function(g,E,v,b,_,S,N){let P;if(_.isKeyField()){if(S==="array-contains"||S==="array-contains-any")throw new Ze(Ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${S}' queries on documentId().`);if(S==="in"||S==="not-in"){WE(N,S);const te=[];for(const oe of N)te.push(YE(b,g,oe));P={arrayValue:{values:te}}}else P=YE(b,g,N)}else S!=="in"&&S!=="not-in"&&S!=="array-contains-any"||WE(N,S),P=L4(v,E,N,S==="in"||S==="not-in");return Or.create(_,S,P)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function $i(s,e,n){const o=e,h=hd("where",s);return fd._create(h,o,n)}class Zg extends Kg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Zg(e,n)}_parse(e){const n=this._queryConstraints.map((o=>o._parse(e))).filter((o=>o.getFilters().length>0));return n.length===1?n[0]:Is.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(h,g){let E=h;const v=g.getFlattenedFilters();for(const b of v)kA(E,b),E=F1(E,b)})(e._query,n),new La(e.firestore,e.converter,F1(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Jg extends Qg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Jg(e,n)}_apply(e){const n=(function(h,g,E){if(h.startAt!==null)throw new Ze(Ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(h.endAt!==null)throw new Ze(Ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Tu(g,E)})(e._query,this._field,this._direction);return new La(e.firestore,e.converter,(function(h,g){const E=h.explicitOrderBy.concat([g]);return new Ec(h.path,h.collectionGroup,E,h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(e._query,n))}}function V4(s,e="asc"){const n=e,o=hd("orderBy",s);return Jg._create(o,n)}class $g extends Qg{constructor(e,n,o){super(),this.type=e,this._limit=n,this._limitType=o}static _create(e,n,o){return new $g(e,n,o)}_apply(e){return new La(e.firestore,e.converter,If(e._query,this._limit,this._limitType))}}function U4(s){return $g._create("limit",s,"F")}function YE(s,e,n){if(typeof(n=qn(n))=="string"){if(n==="")throw new Ze(Ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!M_(e)&&n.indexOf("/")!==-1)throw new Ze(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const o=e.path.child(Gn.fromString(n));if(!wt.isDocumentKey(o))throw new Ze(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${o}' is not because it has an odd number of segments (${o.length}).`);return cE(s,new wt(o))}if(n instanceof yr)return cE(s,n._key);throw new Ze(Ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wf(n)}.`)}function WE(s,e){if(!Array.isArray(s)||s.length===0)throw new Ze(Ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function kA(s,e){const n=(function(h,g){for(const E of h)for(const v of E.getFlattenedFilters())if(g.indexOf(v.op)>=0)return v.op;return null})(s.filters,(function(h){switch(h){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Ze(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ze(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class F4{convertValue(e,n="none"){switch(Io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return br(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(So(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Dt(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const o={};return Mo(e,((h,g)=>{o[h]=this.convertValue(g,n)})),o}convertVectorValue(e){const n=e.fields?.[Cf].arrayValue?.values?.map((o=>br(o.doubleValue)));return new Ys(n)}convertGeoPoint(e){return new Xs(br(e.latitude),br(e.longitude))}convertArray(e,n){return(e.values||[]).map((o=>this.convertValue(o,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const o=Zf(e);return o==null?null:this.convertValue(o,n);case"estimate":return this.convertTimestamp(Au(e));default:return null}}convertTimestamp(e){const n=Co(e);return new Rn(n.seconds,n.nanos)}convertDocumentKey(e,n){const o=Gn.fromString(e);Nn(tA(o),9688,{name:e});const h=new wu(o.get(1),o.get(3)),g=new wt(o.popFirst(5));return h.isEqual(n)||Da(`Document ${g} contains a document reference within a different database (${h.projectId}/${h.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),g}}function em(s,e,n){let o;return o=s?n&&(n.merge||n.mergeFields)?s.toFirestore(e,n):s.toFirestore(e):e,o}class cu{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class sl extends DA{constructor(e,n,o,h,g,E){super(e,n,o,h,E),this._firestore=e,this._firestoreImpl=e,this.metadata=g}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new df(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const o=this._document.data.field(hd("DocumentSnapshot.get",e));if(o!==null)return this._userDataWriter.convertValue(o,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ze(Ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=sl._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}sl._jsonSchemaVersion="firestore/documentSnapshot/1.0",sl._jsonSchema={type:Dr("string",sl._jsonSchemaVersion),bundleSource:Dr("string","DocumentSnapshot"),bundleName:Dr("string"),bundle:Dr("string")};class df extends sl{data(e={}){return super.data(e)}}class al{constructor(e,n,o,h){this._firestore=e,this._userDataWriter=n,this._snapshot=h,this.metadata=new cu(h.hasPendingWrites,h.fromCache),this.query=o}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((o=>{e.call(n,new df(this._firestore,this._userDataWriter,o.key,o,new cu(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ze(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(h,g){if(h._snapshot.oldDocs.isEmpty()){let E=0;return h._snapshot.docChanges.map((v=>{const b=new df(h._firestore,h._userDataWriter,v.doc.key,v.doc,new cu(h._snapshot.mutatedKeys.has(v.doc.key),h._snapshot.fromCache),h.query.converter);return v.doc,{type:"added",doc:b,oldIndex:-1,newIndex:E++}}))}{let E=h._snapshot.oldDocs;return h._snapshot.docChanges.filter((v=>g||v.type!==3)).map((v=>{const b=new df(h._firestore,h._userDataWriter,v.doc.key,v.doc,new cu(h._snapshot.mutatedKeys.has(v.doc.key),h._snapshot.fromCache),h.query.converter);let _=-1,S=-1;return v.type!==0&&(_=E.indexOf(v.doc.key),E=E.delete(v.doc.key)),v.type!==1&&(E=E.add(v.doc),S=E.indexOf(v.doc.key)),{type:j4(v.type),doc:b,oldIndex:_,newIndex:S}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ze(Ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=al._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=yg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],o=[],h=[];return this.docs.forEach((g=>{g._document!==null&&(n.push(g._document),o.push(this._userDataWriter.convertObjectMap(g._document.data.value.mapValue.fields,"previous")),h.push(g.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function j4(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dt(61501,{type:s})}}function gl(s){s=bi(s,yr);const e=bi(s.firestore,Ks);return S4(Uu(e),s._key).then((n=>LA(e,s,n)))}al._jsonSchemaVersion="firestore/querySnapshot/1.0",al._jsonSchema={type:Dr("string",al._jsonSchemaVersion),bundleSource:Dr("string","QuerySnapshot"),bundleName:Dr("string"),bundle:Dr("string")};class tm extends F4{constructor(e){super(),this.firestore=e}convertBytes(e){return new ps(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new yr(this.firestore,null,n)}}function ei(s){s=bi(s,La);const e=bi(s.firestore,Ks),n=Uu(e),o=new tm(e);return MA(s._query),I4(n,s._query).then((h=>new al(e,o,s,h)))}function ol(s,e,n){s=bi(s,yr);const o=bi(s.firestore,Ks),h=em(s.converter,e,n);return Hu(o,[qg(ju(o),"setDoc",s._key,h,s.converter!==null,n).toMutation(s._key,Ti.none())])}function Cs(s,e,n,...o){s=bi(s,yr);const h=bi(s.firestore,Ks),g=ju(h);let E;return E=typeof(e=qn(e))=="string"||e instanceof Fu?IA(g,"updateDoc",s._key,e,n,o):SA(g,"updateDoc",s._key,e),Hu(h,[E.toMutation(s._key,Ti.exists(!0))])}function KE(s){return Hu(bi(s.firestore,Ks),[new rd(s._key,Ti.none())])}function gf(s,e){const n=bi(s.firestore,Ks),o=Un(s),h=em(s.converter,e);return Hu(n,[qg(ju(s.firestore),"addDoc",o._key,h,s.converter!==null,{}).toMutation(o._key,Ti.exists(!1))]).then((()=>o))}function QE(s,...e){s=qn(s);let n={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||XE(e[o])||(n=e[o++]);const h={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(XE(e[o])){const b=e[o];e[o]=b.next?.bind(b),e[o+1]=b.error?.bind(b),e[o+2]=b.complete?.bind(b)}let g,E,v;if(s instanceof yr)E=bi(s.firestore,Ks),v=Jf(s._key.path),g={next:b=>{e[o]&&e[o](LA(E,s,b))},error:e[o+1],complete:e[o+2]};else{const b=bi(s,La);E=bi(b.firestore,Ks),v=b._query;const _=new tm(E);g={next:S=>{e[o]&&e[o](new al(E,_,b,S))},error:e[o+1],complete:e[o+2]},MA(s._query)}return(function(_,S,N,P){const X=new Hg(P),te=new Fg(S,X,N);return _.asyncQueue.enqueueAndForget((async()=>Bg(await kf(_),te))),()=>{X.Nu(),_.asyncQueue.enqueueAndForget((async()=>Vg(await kf(_),te)))}})(Uu(E),v,h,g)}function Hu(s,e){return(function(o,h){const g=new Ra;return o.asyncQueue.enqueueAndForget((async()=>m4(await C4(o),h,g))),g.promise})(Uu(s),e)}function LA(s,e,n){const o=n.docs.get(e._key),h=new tm(s);return new sl(s,h,e._key,o,new cu(n.hasPendingWrites,n.fromCache),e.converter)}class z4{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ju(e)}set(e,n,o){this._verifyNotCommitted();const h=x1(e,this._firestore),g=em(h.converter,n,o),E=qg(this._dataReader,"WriteBatch.set",h._key,g,h.converter!==null,o);return this._mutations.push(E.toMutation(h._key,Ti.none())),this}update(e,n,o,...h){this._verifyNotCommitted();const g=x1(e,this._firestore);let E;return E=typeof(n=qn(n))=="string"||n instanceof Fu?IA(this._dataReader,"WriteBatch.update",g._key,n,o,h):SA(this._dataReader,"WriteBatch.update",g._key,n),this._mutations.push(E.toMutation(g._key,Ti.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=x1(e,this._firestore);return this._mutations=this._mutations.concat(new rd(n._key,Ti.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ze(Ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function x1(s,e){if((s=qn(s)).firestore!==e)throw new Ze(Ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function mf(){return new Xg("serverTimestamp")}function _1(s){return Uu(s=bi(s,Ks)),new z4(s,(e=>Hu(s,e)))}(function(e,n=!0){(function(h){mc=h})(dc),cl(new To("firestore",((o,{instanceIdentifier:h,options:g})=>{const E=o.getProvider("app").getImmediate(),v=new Ks(new L3(o.getProvider("auth-internal")),new V3(E,o.getProvider("app-check-internal")),(function(_,S){if(!Object.prototype.hasOwnProperty.apply(_.options,["projectId"]))throw new Ze(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wu(_.options.projectId,S)})(E,h),E);return g={useFetchStreams:n,...g},v._setSettings(g),v}),"PUBLIC").setMultipleInstances(!0)),Fs(Qy,Zy,e),Fs(Qy,Zy,"esm2020")})();const PA={apiKey:"AIzaSyARwb6K0M4l-hWKi8FrOLEVqRqeHRf8JR4",authDomain:"oppmoteboka.firebaseapp.com",projectId:"oppmoteboka",storageBucket:"oppmoteboka.firebasestorage.app",messagingSenderId:"732911922070",appId:"1:732911922070:web:b16d9de65062395c018bb7"},BA=wx().length?Gf():og(PA),Eo=a_(BA),Nt=N4(BA),H4=wx().find(s=>s.name==="secondary")??og(PA,"secondary"),A1=a_(H4);function dd(){const[s,e]=_e.useState(null),[n,o]=_e.useState(!0);return _e.useEffect(()=>{const v=_C(Eo,async b=>{if(!b){e(null),o(!1);return}try{const _=Un(Nt,"users",b.uid);let S=await gl(_);if(!S.exists()){const X={uid:b.uid,email:b.email??"",displayName:b.displayName??b.email??"",role:"student",term:null,termLabel:null,semesterStatus:"aktiv"};await ol(_,{...X,createdAt:mf()}),e(X),o(!1);return}const N=S.data(),P={uid:b.uid,email:N?.email??b.email??"",role:N?.role??"student",term:N?.term??null,termLabel:N?.termLabel??null,semesterStatus:N?.semesterStatus??null,displayName:N?.name??N?.displayName??b.displayName??b.email??""};e(P)}catch(_){console.error("Feil ved henting/oppretting av bruker:",_),e(null)}finally{o(!1)}});return()=>v()},[]),{user:s,loading:n,login:async(v,b)=>{await mC(Eo,v,b)},register:async(v,b)=>{await sf(Eo,v,b)},logout:async()=>{await AC(Eo)}}}var at;(function(s){s[s.QR_CODE=0]="QR_CODE",s[s.AZTEC=1]="AZTEC",s[s.CODABAR=2]="CODABAR",s[s.CODE_39=3]="CODE_39",s[s.CODE_93=4]="CODE_93",s[s.CODE_128=5]="CODE_128",s[s.DATA_MATRIX=6]="DATA_MATRIX",s[s.MAXICODE=7]="MAXICODE",s[s.ITF=8]="ITF",s[s.EAN_13=9]="EAN_13",s[s.EAN_8=10]="EAN_8",s[s.PDF_417=11]="PDF_417",s[s.RSS_14=12]="RSS_14",s[s.RSS_EXPANDED=13]="RSS_EXPANDED",s[s.UPC_A=14]="UPC_A",s[s.UPC_E=15]="UPC_E",s[s.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(at||(at={}));var ZE=new Map([[at.QR_CODE,"QR_CODE"],[at.AZTEC,"AZTEC"],[at.CODABAR,"CODABAR"],[at.CODE_39,"CODE_39"],[at.CODE_93,"CODE_93"],[at.CODE_128,"CODE_128"],[at.DATA_MATRIX,"DATA_MATRIX"],[at.MAXICODE,"MAXICODE"],[at.ITF,"ITF"],[at.EAN_13,"EAN_13"],[at.EAN_8,"EAN_8"],[at.PDF_417,"PDF_417"],[at.RSS_14,"RSS_14"],[at.RSS_EXPANDED,"RSS_EXPANDED"],[at.UPC_A,"UPC_A"],[at.UPC_E,"UPC_E"],[at.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),JE;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.URL=1]="URL"})(JE||(JE={}));function G4(s){return Object.values(at).includes(s)}var Pf;(function(s){s[s.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",s[s.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Pf||(Pf={}));var q4=(function(){function s(){}return s.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",s.SCAN_DEFAULT_FPS=2,s.DEFAULT_DISABLE_FLIP=!1,s.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,s.DEFAULT_SUPPORTED_SCAN_TYPE=[Pf.SCAN_TYPE_CAMERA,Pf.SCAN_TYPE_FILE],s})(),VA=(function(){function s(e,n){this.format=e,this.formatName=n}return s.prototype.toString=function(){return this.formatName},s.create=function(e){if(!ZE.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new s(e,ZE.get(e))},s})(),$E=(function(){function s(){}return s.createFromText=function(e){var n={text:e};return{decodedText:e,result:n}},s.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},s})(),Z1;(function(s){s[s.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",s[s.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",s[s.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Z1||(Z1={}));var X4=(function(){function s(){}return s.createFrom=function(e){return{errorMessage:e,type:Z1.UNKWOWN_ERROR}},s})(),Y4=(function(){function s(e){this.verbose=e}return s.prototype.log=function(e){this.verbose&&console.log(e)},s.prototype.warn=function(e){this.verbose&&console.warn(e)},s.prototype.logError=function(e,n){(this.verbose||n===!0)&&console.error(e)},s.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},s})();function va(s){return typeof s>"u"||s===null}var $l=(function(){function s(){}return s.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},s.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},s.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},s.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},s.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},s.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},s.scannerPaused=function(){return"Scanner paused"},s})(),UA=(function(){function s(){}return s.isMediaStreamConstraintsValid=function(e,n){if(typeof e!="object"){var o=typeof e;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(o,"."),!0),!1}for(var h=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],g=new Set(h),E=Object.keys(e),v=0,b=E;v<b.length;v++){var _=b[v];if(g.has(_))return n.logError("".concat(_," is not supported videoConstaints."),!0),!1}return!0},s})(),uu={exports:{}},W4=uu.exports,ex;function K4(){return ex||(ex=1,(function(s,e){(function(n,o){o(e)})(W4,(function(n){function o(M){return M==null}var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,r){M.__proto__=r}||function(M,r){for(var a in r)r.hasOwnProperty(a)&&(M[a]=r[a])};function g(M,r){h(M,r);function a(){this.constructor=M}M.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}function E(M,r){var a=Object.setPrototypeOf;a?a(M,r):M.__proto__=r}function v(M,r){r===void 0&&(r=M.constructor);var a=Error.captureStackTrace;a&&a(M,r)}var b=(function(M){g(r,M);function r(a){var l=this.constructor,u=M.call(this,a)||this;return Object.defineProperty(u,"name",{value:l.name,enumerable:!1}),E(u,l.prototype),v(u),u}return r})(Error);class _ extends b{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}_.kind="Exception";class S extends _{}S.kind="ArgumentException";class N extends _{}N.kind="IllegalArgumentException";class P{constructor(r){if(this.binarizer=r,r===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,a){return this.binarizer.getBlackRow(r,a)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,a,l,u){const f=this.binarizer.getLuminanceSource().crop(r,a,l,u);return new P(this.binarizer.createBinarizer(f))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new P(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new P(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class X extends _{static getChecksumInstance(){return new X}}X.kind="ChecksumException";class te{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class oe{static arraycopy(r,a,l,u,f){for(;f--;)l[u++]=r[a++]}static currentTimeMillis(){return Date.now()}}class ue extends _{}ue.kind="IndexOutOfBoundsException";class Ye extends ue{constructor(r=void 0,a=void 0){super(a),this.index=r,this.message=a}}Ye.kind="ArrayIndexOutOfBoundsException";class ke{static fill(r,a){for(let l=0,u=r.length;l<u;l++)r[l]=a}static fillWithin(r,a,l,u){ke.rangeCheck(r.length,a,l);for(let f=a;f<l;f++)r[f]=u}static rangeCheck(r,a,l){if(a>l)throw new N("fromIndex("+a+") > toIndex("+l+")");if(a<0)throw new Ye(a);if(l>r)throw new Ye(l)}static asList(...r){return r}static create(r,a,l){return Array.from({length:r}).map(f=>Array.from({length:a}).fill(l))}static createInt32Array(r,a,l){return Array.from({length:r}).map(f=>Int32Array.from({length:a}).fill(l))}static equals(r,a){if(!r||!a||!r.length||!a.length||r.length!==a.length)return!1;for(let l=0,u=r.length;l<u;l++)if(r[l]!==a[l])return!1;return!0}static hashCode(r){if(r===null)return 0;let a=1;for(const l of r)a=31*a+l;return a}static fillUint8Array(r,a){for(let l=0;l!==r.length;l++)r[l]=a}static copyOf(r,a){return r.slice(0,a)}static copyOfUint8Array(r,a){if(r.length<=a){const l=new Uint8Array(a);return l.set(r),l}return r.slice(0,a)}static copyOfRange(r,a,l){const u=l-a,f=new Int32Array(u);return oe.arraycopy(r,a,f,0,u),f}static binarySearch(r,a,l){l===void 0&&(l=ke.numberComparator);let u=0,f=r.length-1;for(;u<=f;){const m=f+u>>1,y=l(a,r[m]);if(y>0)u=m+1;else if(y<0)f=m-1;else return m}return-u-1}static numberComparator(r,a){return r-a}}class de{static numberOfTrailingZeros(r){let a;if(r===0)return 32;let l=31;return a=r<<16,a!==0&&(l-=16,r=a),a=r<<8,a!==0&&(l-=8,r=a),a=r<<4,a!==0&&(l-=4,r=a),a=r<<2,a!==0&&(l-=2,r=a),l-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let a=1;return r>>>16||(a+=16,r<<=16),r>>>24||(a+=8,r<<=8),r>>>28||(a+=4,r<<=4),r>>>30||(a+=2,r<<=2),a-=r>>>31,a}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,a){return Math.trunc(r/a)}static parseInt(r,a=void 0){return parseInt(r,a)}}de.MIN_VALUE_32_BITS=-2147483648,de.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Pe{constructor(r,a){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,a==null?this.bits=Pe.makeArray(r):this.bits=a)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const a=Pe.makeArray(r);oe.arraycopy(this.bits,0,a,0,this.bits.length),this.bits=a}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const a=this.size;if(r>=a)return a;const l=this.bits;let u=Math.floor(r/32),f=l[u];f&=~((1<<(r&31))-1);const m=l.length;for(;f===0;){if(++u===m)return a;f=l[u]}const y=u*32+de.numberOfTrailingZeros(f);return y>a?a:y}getNextUnset(r){const a=this.size;if(r>=a)return a;const l=this.bits;let u=Math.floor(r/32),f=~l[u];f&=~((1<<(r&31))-1);const m=l.length;for(;f===0;){if(++u===m)return a;f=~l[u]}const y=u*32+de.numberOfTrailingZeros(f);return y>a?a:y}setBulk(r,a){this.bits[Math.floor(r/32)]=a}setRange(r,a){if(a<r||r<0||a>this.size)throw new N;if(a===r)return;a--;const l=Math.floor(r/32),u=Math.floor(a/32),f=this.bits;for(let m=l;m<=u;m++){const y=m>l?0:r&31,T=(2<<(m<u?31:a&31))-(1<<y);f[m]|=T}}clear(){const r=this.bits.length,a=this.bits;for(let l=0;l<r;l++)a[l]=0}isRange(r,a,l){if(a<r||r<0||a>this.size)throw new N;if(a===r)return!0;a--;const u=Math.floor(r/32),f=Math.floor(a/32),m=this.bits;for(let y=u;y<=f;y++){const A=y>u?0:r&31,I=(2<<(y<f?31:a&31))-(1<<A)&4294967295;if((m[y]&I)!==(l?I:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,a){if(a<0||a>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+a);for(let l=a;l>0;l--)this.appendBit((r>>l-1&1)===1)}appendBitArray(r){const a=r.size;this.ensureCapacity(this.size+a);for(let l=0;l<a;l++)this.appendBit(r.get(l))}xor(r){if(this.size!==r.size)throw new N("Sizes don't match");const a=this.bits;for(let l=0,u=a.length;l<u;l++)a[l]^=r.bits[l]}toBytes(r,a,l,u){for(let f=0;f<u;f++){let m=0;for(let y=0;y<8;y++)this.get(r)&&(m|=1<<7-y),r++;a[l+f]=m}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),a=Math.floor((this.size-1)/32),l=a+1,u=this.bits;for(let f=0;f<l;f++){let m=u[f];m=m>>1&1431655765|(m&1431655765)<<1,m=m>>2&858993459|(m&858993459)<<2,m=m>>4&252645135|(m&252645135)<<4,m=m>>8&16711935|(m&16711935)<<8,m=m>>16&65535|(m&65535)<<16,r[a-f]=m}if(this.size!==l*32){const f=l*32-this.size;let m=r[0]>>>f;for(let y=1;y<l;y++){const A=r[y];m|=A<<32-f,r[y-1]=m,m=A>>>f}r[l-1]=m}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof Pe))return!1;const a=r;return this.size===a.size&&ke.equals(this.bits,a.bits)}hashCode(){return 31*this.size+ke.hashCode(this.bits)}toString(){let r="";for(let a=0,l=this.size;a<l;a++)(a&7)===0&&(r+=" "),r+=this.get(a)?"X":".";return r}clone(){return new Pe(this.size,this.bits.slice())}}var ft;(function(M){M[M.OTHER=0]="OTHER",M[M.PURE_BARCODE=1]="PURE_BARCODE",M[M.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",M[M.TRY_HARDER=3]="TRY_HARDER",M[M.CHARACTER_SET=4]="CHARACTER_SET",M[M.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",M[M.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",M[M.ASSUME_GS1=7]="ASSUME_GS1",M[M.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",M[M.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",M[M.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(ft||(ft={}));var qe=ft;class F extends _{static getFormatInstance(){return new F}}F.kind="FormatException";var j;(function(M){M[M.Cp437=0]="Cp437",M[M.ISO8859_1=1]="ISO8859_1",M[M.ISO8859_2=2]="ISO8859_2",M[M.ISO8859_3=3]="ISO8859_3",M[M.ISO8859_4=4]="ISO8859_4",M[M.ISO8859_5=5]="ISO8859_5",M[M.ISO8859_6=6]="ISO8859_6",M[M.ISO8859_7=7]="ISO8859_7",M[M.ISO8859_8=8]="ISO8859_8",M[M.ISO8859_9=9]="ISO8859_9",M[M.ISO8859_10=10]="ISO8859_10",M[M.ISO8859_11=11]="ISO8859_11",M[M.ISO8859_13=12]="ISO8859_13",M[M.ISO8859_14=13]="ISO8859_14",M[M.ISO8859_15=14]="ISO8859_15",M[M.ISO8859_16=15]="ISO8859_16",M[M.SJIS=16]="SJIS",M[M.Cp1250=17]="Cp1250",M[M.Cp1251=18]="Cp1251",M[M.Cp1252=19]="Cp1252",M[M.Cp1256=20]="Cp1256",M[M.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",M[M.UTF8=22]="UTF8",M[M.ASCII=23]="ASCII",M[M.Big5=24]="Big5",M[M.GB18030=25]="GB18030",M[M.EUC_KR=26]="EUC_KR"})(j||(j={}));class V{constructor(r,a,l,...u){this.valueIdentifier=r,this.name=l,typeof a=="number"?this.values=Int32Array.from([a]):this.values=a,this.otherEncodingNames=u,V.VALUE_IDENTIFIER_TO_ECI.set(r,this),V.NAME_TO_ECI.set(l,this);const f=this.values;for(let m=0,y=f.length;m!==y;m++){const A=f[m];V.VALUES_TO_ECI.set(A,this)}for(const m of u)V.NAME_TO_ECI.set(m,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new F("incorect value");const a=V.VALUES_TO_ECI.get(r);if(a===void 0)throw new F("incorect value");return a}static getCharacterSetECIByName(r){const a=V.NAME_TO_ECI.get(r);if(a===void 0)throw new F("incorect value");return a}equals(r){if(!(r instanceof V))return!1;const a=r;return this.getName()===a.getName()}}V.VALUE_IDENTIFIER_TO_ECI=new Map,V.VALUES_TO_ECI=new Map,V.NAME_TO_ECI=new Map,V.Cp437=new V(j.Cp437,Int32Array.from([0,2]),"Cp437"),V.ISO8859_1=new V(j.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),V.ISO8859_2=new V(j.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),V.ISO8859_3=new V(j.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),V.ISO8859_4=new V(j.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),V.ISO8859_5=new V(j.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),V.ISO8859_6=new V(j.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),V.ISO8859_7=new V(j.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),V.ISO8859_8=new V(j.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),V.ISO8859_9=new V(j.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),V.ISO8859_10=new V(j.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),V.ISO8859_11=new V(j.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),V.ISO8859_13=new V(j.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),V.ISO8859_14=new V(j.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),V.ISO8859_15=new V(j.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),V.ISO8859_16=new V(j.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),V.SJIS=new V(j.SJIS,20,"SJIS","Shift_JIS"),V.Cp1250=new V(j.Cp1250,21,"Cp1250","windows-1250"),V.Cp1251=new V(j.Cp1251,22,"Cp1251","windows-1251"),V.Cp1252=new V(j.Cp1252,23,"Cp1252","windows-1252"),V.Cp1256=new V(j.Cp1256,24,"Cp1256","windows-1256"),V.UnicodeBigUnmarked=new V(j.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),V.UTF8=new V(j.UTF8,26,"UTF8","UTF-8"),V.ASCII=new V(j.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),V.Big5=new V(j.Big5,28,"Big5"),V.GB18030=new V(j.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),V.EUC_KR=new V(j.EUC_KR,30,"EUC_KR","EUC-KR");class Z extends _{}Z.kind="UnsupportedOperationException";class q{static decode(r,a){const l=this.encodingName(a);return this.customDecoder?this.customDecoder(r,l):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(l)?this.decodeFallback(r,l):new TextDecoder(l).decode(r)}static shouldDecodeOnFallback(r){return!q.isBrowser()&&r==="ISO-8859-1"}static encode(r,a){const l=this.encodingName(a);return this.customEncoder?this.customEncoder(r,l):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof V?r:V.getCharacterSetECIByName(r)}static decodeFallback(r,a){const l=this.encodingCharacterSet(a);if(q.isDecodeFallbackSupported(l)){let u="";for(let f=0,m=r.length;f<m;f++){let y=r[f].toString(16);y.length<2&&(y="0"+y),u+="%"+y}return decodeURIComponent(u)}if(l.equals(V.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new Z(`Encoding ${this.encodingName(a)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(V.UTF8)||r.equals(V.ISO8859_1)||r.equals(V.ASCII)}static encodeFallback(r){const l=btoa(unescape(encodeURIComponent(r))).split(""),u=[];for(let f=0;f<l.length;f++)u.push(l[f].charCodeAt(0));return new Uint8Array(u)}}class Y{static castAsNonUtf8Char(r,a=null){const l=a?a.getName():this.ISO88591;return q.decode(new Uint8Array([r]),l)}static guessEncoding(r,a){if(a!=null&&a.get(qe.CHARACTER_SET)!==void 0)return a.get(qe.CHARACTER_SET).toString();const l=r.length;let u=!0,f=!0,m=!0,y=0,A=0,T=0,I=0,k=0,L=0,G=0,Q=0,J=0,se=0,ye=0;const Ue=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let Be=0;Be<l&&(u||f||m);Be++){const Me=r[Be]&255;m&&(y>0?(Me&128)===0?m=!1:y--:(Me&128)!==0&&((Me&64)===0?m=!1:(y++,(Me&32)===0?A++:(y++,(Me&16)===0?T++:(y++,(Me&8)===0?I++:m=!1))))),u&&(Me>127&&Me<160?u=!1:Me>159&&(Me<192||Me===215||Me===247)&&ye++),f&&(k>0?Me<64||Me===127||Me>252?f=!1:k--:Me===128||Me===160||Me>239?f=!1:Me>160&&Me<224?(L++,Q=0,G++,G>J&&(J=G)):Me>127?(k++,G=0,Q++,Q>se&&(se=Q)):(G=0,Q=0))}return m&&y>0&&(m=!1),f&&k>0&&(f=!1),m&&(Ue||A+T+I>0)?Y.UTF8:f&&(Y.ASSUME_SHIFT_JIS||J>=3||se>=3)?Y.SHIFT_JIS:u&&f?J===2&&L===2||ye*10>=l?Y.SHIFT_JIS:Y.ISO88591:u?Y.ISO88591:f?Y.SHIFT_JIS:m?Y.UTF8:Y.PLATFORM_DEFAULT_ENCODING}static format(r,...a){let l=-1;function u(m,y,A,T,I,k){if(m==="%%")return"%";if(a[++l]===void 0)return;m=T?parseInt(T.substr(1)):void 0;let L=I?parseInt(I.substr(1)):void 0,G;switch(k){case"s":G=a[l];break;case"c":G=a[l][0];break;case"f":G=parseFloat(a[l]).toFixed(m);break;case"p":G=parseFloat(a[l]).toPrecision(m);break;case"e":G=parseFloat(a[l]).toExponential(m);break;case"x":G=parseInt(a[l]).toString(L||16);break;case"d":G=parseFloat(parseInt(a[l],L||10).toPrecision(m)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(L);let Q=parseInt(A),J=A&&A[0]+""=="0"?"0":" ";for(;G.length<Q;)G=y!==void 0?G+J:J+G;return G}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(f,u)}static getBytes(r,a){return q.encode(r,a)}static getCharCode(r,a=0){return r.charCodeAt(a)}static getCharAt(r){return String.fromCharCode(r)}}Y.SHIFT_JIS=V.SJIS.getName(),Y.GB2312="GB2312",Y.ISO88591=V.ISO8859_1.getName(),Y.EUC_JP="EUC_JP",Y.UTF8=V.UTF8.getName(),Y.PLATFORM_DEFAULT_ENCODING=Y.UTF8,Y.ASSUME_SHIFT_JIS=!1;class H{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=Y.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,a,l){for(let u=a;a<a+l;u++)this.append(r[u]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,a){this.value=this.value.substr(0,r)+a+this.value.substr(r+1)}substring(r,a){return this.value.substring(r,a)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,a){this.value=this.value.substr(0,r)+a+this.value.substr(r+a.length)}}class rt{constructor(r,a,l,u){if(this.width=r,this.height=a,this.rowSize=l,this.bits=u,a==null&&(a=r),this.height=a,r<1||a<1)throw new N("Both dimensions must be greater than 0");l==null&&(l=Math.floor((r+31)/32)),this.rowSize=l,u==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const a=r.length,l=r[0].length,u=new rt(l,a);for(let f=0;f<a;f++){const m=r[f];for(let y=0;y<l;y++)m[y]&&u.set(y,f)}return u}static parseFromString(r,a,l){if(r===null)throw new N("stringRepresentation cannot be null");const u=new Array(r.length);let f=0,m=0,y=-1,A=0,T=0;for(;T<r.length;)if(r.charAt(T)===`
`||r.charAt(T)==="\r"){if(f>m){if(y===-1)y=f-m;else if(f-m!==y)throw new N("row lengths do not match");m=f,A++}T++}else if(r.substring(T,T+a.length)===a)T+=a.length,u[f]=!0,f++;else if(r.substring(T,T+l.length)===l)T+=l.length,u[f]=!1,f++;else throw new N("illegal character encountered: "+r.substring(T));if(f>m){if(y===-1)y=f-m;else if(f-m!==y)throw new N("row lengths do not match");A++}const I=new rt(y,A);for(let k=0;k<f;k++)u[k]&&I.set(Math.floor(k%y),Math.floor(k/y));return I}get(r,a){const l=a*this.rowSize+Math.floor(r/32);return(this.bits[l]>>>(r&31)&1)!==0}set(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]|=1<<(r&31)&4294967295}unset(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]&=~(1<<(r&31)&4294967295)}flip(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new N("input matrix dimensions do not match");const a=new Pe(Math.floor(this.width/32)+1),l=this.rowSize,u=this.bits;for(let f=0,m=this.height;f<m;f++){const y=f*l,A=r.getRow(f,a).getBitArray();for(let T=0;T<l;T++)u[y+T]^=A[T]}}clear(){const r=this.bits,a=r.length;for(let l=0;l<a;l++)r[l]=0}setRegion(r,a,l,u){if(a<0||r<0)throw new N("Left and top must be nonnegative");if(u<1||l<1)throw new N("Height and width must be at least 1");const f=r+l,m=a+u;if(m>this.height||f>this.width)throw new N("The region must fit inside the matrix");const y=this.rowSize,A=this.bits;for(let T=a;T<m;T++){const I=T*y;for(let k=r;k<f;k++)A[I+Math.floor(k/32)]|=1<<(k&31)&4294967295}}getRow(r,a){a==null||a.getSize()<this.width?a=new Pe(this.width):a.clear();const l=this.rowSize,u=this.bits,f=r*l;for(let m=0;m<l;m++)a.setBulk(m*32,u[f+m]);return a}setRow(r,a){oe.arraycopy(a.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),a=this.getHeight();let l=new Pe(r),u=new Pe(r);for(let f=0,m=Math.floor((a+1)/2);f<m;f++)l=this.getRow(f,l),u=this.getRow(a-1-f,u),l.reverse(),u.reverse(),this.setRow(f,u),this.setRow(a-1-f,l)}getEnclosingRectangle(){const r=this.width,a=this.height,l=this.rowSize,u=this.bits;let f=r,m=a,y=-1,A=-1;for(let T=0;T<a;T++)for(let I=0;I<l;I++){const k=u[T*l+I];if(k!==0){if(T<m&&(m=T),T>A&&(A=T),I*32<f){let L=0;for(;(k<<31-L&4294967295)===0;)L++;I*32+L<f&&(f=I*32+L)}if(I*32+31>y){let L=31;for(;!(k>>>L);)L--;I*32+L>y&&(y=I*32+L)}}}return y<f||A<m?null:Int32Array.from([f,m,y-f+1,A-m+1])}getTopLeftOnBit(){const r=this.rowSize,a=this.bits;let l=0;for(;l<a.length&&a[l]===0;)l++;if(l===a.length)return null;const u=l/r;let f=l%r*32;const m=a[l];let y=0;for(;(m<<31-y&4294967295)===0;)y++;return f+=y,Int32Array.from([f,u])}getBottomRightOnBit(){const r=this.rowSize,a=this.bits;let l=a.length-1;for(;l>=0&&a[l]===0;)l--;if(l<0)return null;const u=Math.floor(l/r);let f=Math.floor(l%r)*32;const m=a[l];let y=31;for(;!(m>>>y);)y--;return f+=y,Int32Array.from([f,u])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof rt))return!1;const a=r;return this.width===a.width&&this.height===a.height&&this.rowSize===a.rowSize&&ke.equals(this.bits,a.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+ke.hashCode(this.bits),r}toString(r="X ",a="  ",l=`
`){return this.buildToString(r,a,l)}buildToString(r,a,l){let u=new H;for(let f=0,m=this.height;f<m;f++){for(let y=0,A=this.width;y<A;y++)u.append(this.get(y,f)?r:a);u.append(l)}return u.toString()}clone(){return new rt(this.width,this.height,this.rowSize,this.bits.slice())}}class ae extends _{static getNotFoundInstance(){return new ae}}ae.kind="NotFoundException";class ce extends te{constructor(r){super(r),this.luminances=ce.EMPTY,this.buckets=new Int32Array(ce.LUMINANCE_BUCKETS)}getBlackRow(r,a){const l=this.getLuminanceSource(),u=l.getWidth();a==null||a.getSize()<u?a=new Pe(u):a.clear(),this.initArrays(u);const f=l.getRow(r,this.luminances),m=this.buckets;for(let A=0;A<u;A++)m[(f[A]&255)>>ce.LUMINANCE_SHIFT]++;const y=ce.estimateBlackPoint(m);if(u<3)for(let A=0;A<u;A++)(f[A]&255)<y&&a.set(A);else{let A=f[0]&255,T=f[1]&255;for(let I=1;I<u-1;I++){const k=f[I+1]&255;(T*4-A-k)/2<y&&a.set(I),A=T,T=k}}return a}getBlackMatrix(){const r=this.getLuminanceSource(),a=r.getWidth(),l=r.getHeight(),u=new rt(a,l);this.initArrays(a);const f=this.buckets;for(let A=1;A<5;A++){const T=Math.floor(l*A/5),I=r.getRow(T,this.luminances),k=Math.floor(a*4/5);for(let L=Math.floor(a/5);L<k;L++){const G=I[L]&255;f[G>>ce.LUMINANCE_SHIFT]++}}const m=ce.estimateBlackPoint(f),y=r.getMatrix();for(let A=0;A<l;A++){const T=A*a;for(let I=0;I<a;I++)(y[T+I]&255)<m&&u.set(I,A)}return u}createBinarizer(r){return new ce(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const a=this.buckets;for(let l=0;l<ce.LUMINANCE_BUCKETS;l++)a[l]=0}static estimateBlackPoint(r){const a=r.length;let l=0,u=0,f=0;for(let I=0;I<a;I++)r[I]>f&&(u=I,f=r[I]),r[I]>l&&(l=r[I]);let m=0,y=0;for(let I=0;I<a;I++){const k=I-u,L=r[I]*k*k;L>y&&(m=I,y=L)}if(u>m){const I=u;u=m,m=I}if(m-u<=a/16)throw new ae;let A=m-1,T=-1;for(let I=m-1;I>u;I--){const k=I-u,L=k*k*(m-I)*(l-r[I]);L>T&&(A=I,T=L)}return A<<ce.LUMINANCE_SHIFT}}ce.LUMINANCE_BITS=5,ce.LUMINANCE_SHIFT=8-ce.LUMINANCE_BITS,ce.LUMINANCE_BUCKETS=1<<ce.LUMINANCE_BITS,ce.EMPTY=Uint8ClampedArray.from([0]);class ne extends ce{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),a=r.getWidth(),l=r.getHeight();if(a>=ne.MINIMUM_DIMENSION&&l>=ne.MINIMUM_DIMENSION){const u=r.getMatrix();let f=a>>ne.BLOCK_SIZE_POWER;(a&ne.BLOCK_SIZE_MASK)!==0&&f++;let m=l>>ne.BLOCK_SIZE_POWER;(l&ne.BLOCK_SIZE_MASK)!==0&&m++;const y=ne.calculateBlackPoints(u,f,m,a,l),A=new rt(a,l);ne.calculateThresholdForBlock(u,f,m,a,l,y,A),this.matrix=A}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new ne(r)}static calculateThresholdForBlock(r,a,l,u,f,m,y){const A=f-ne.BLOCK_SIZE,T=u-ne.BLOCK_SIZE;for(let I=0;I<l;I++){let k=I<<ne.BLOCK_SIZE_POWER;k>A&&(k=A);const L=ne.cap(I,2,l-3);for(let G=0;G<a;G++){let Q=G<<ne.BLOCK_SIZE_POWER;Q>T&&(Q=T);const J=ne.cap(G,2,a-3);let se=0;for(let Ue=-2;Ue<=2;Ue++){const Be=m[L+Ue];se+=Be[J-2]+Be[J-1]+Be[J]+Be[J+1]+Be[J+2]}const ye=se/25;ne.thresholdBlock(r,Q,k,ye,u,y)}}}static cap(r,a,l){return r<a?a:r>l?l:r}static thresholdBlock(r,a,l,u,f,m){for(let y=0,A=l*f+a;y<ne.BLOCK_SIZE;y++,A+=f)for(let T=0;T<ne.BLOCK_SIZE;T++)(r[A+T]&255)<=u&&m.set(a+T,l+y)}static calculateBlackPoints(r,a,l,u,f){const m=f-ne.BLOCK_SIZE,y=u-ne.BLOCK_SIZE,A=new Array(l);for(let T=0;T<l;T++){A[T]=new Int32Array(a);let I=T<<ne.BLOCK_SIZE_POWER;I>m&&(I=m);for(let k=0;k<a;k++){let L=k<<ne.BLOCK_SIZE_POWER;L>y&&(L=y);let G=0,Q=255,J=0;for(let ye=0,Ue=I*u+L;ye<ne.BLOCK_SIZE;ye++,Ue+=u){for(let Be=0;Be<ne.BLOCK_SIZE;Be++){const Me=r[Ue+Be]&255;G+=Me,Me<Q&&(Q=Me),Me>J&&(J=Me)}if(J-Q>ne.MIN_DYNAMIC_RANGE)for(ye++,Ue+=u;ye<ne.BLOCK_SIZE;ye++,Ue+=u)for(let Be=0;Be<ne.BLOCK_SIZE;Be++)G+=r[Ue+Be]&255}let se=G>>ne.BLOCK_SIZE_POWER*2;if(J-Q<=ne.MIN_DYNAMIC_RANGE&&(se=Q/2,T>0&&k>0)){const ye=(A[T-1][k]+2*A[T][k-1]+A[T-1][k-1])/4;Q<ye&&(se=ye)}A[T][k]=se}}return A}}ne.BLOCK_SIZE_POWER=3,ne.BLOCK_SIZE=1<<ne.BLOCK_SIZE_POWER,ne.BLOCK_SIZE_MASK=ne.BLOCK_SIZE-1,ne.MINIMUM_DIMENSION=ne.BLOCK_SIZE*5,ne.MIN_DYNAMIC_RANGE=24;class ze{constructor(r,a){this.width=r,this.height=a}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,a,l,u){throw new Z("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Z("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Z("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let a=new H;for(let l=0;l<this.height;l++){const u=this.getRow(l,r);for(let f=0;f<this.width;f++){const m=u[f]&255;let y;m<64?y="#":m<128?y="+":m<192?y=".":y=" ",a.append(y)}a.append(`
`)}return a.toString()}}class pt extends ze{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,a){const l=this.delegate.getRow(r,a),u=this.getWidth();for(let f=0;f<u;f++)l[f]=255-(l[f]&255);return l}getMatrix(){const r=this.delegate.getMatrix(),a=this.getWidth()*this.getHeight(),l=new Uint8ClampedArray(a);for(let u=0;u<a;u++)l[u]=255-(r[u]&255);return l}isCropSupported(){return this.delegate.isCropSupported()}crop(r,a,l,u){return new pt(this.delegate.crop(r,a,l,u))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new pt(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new pt(this.delegate.rotateCounterClockwise45())}}class ct extends ze{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=ct.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const a=r.getContext("2d").getImageData(0,0,r.width,r.height);return ct.toGrayscaleBuffer(a.data,r.width,r.height)}static toGrayscaleBuffer(r,a,l){const u=new Uint8ClampedArray(a*l);for(let f=0,m=0,y=r.length;f<y;f+=4,m++){let A;if(r[f+3]===0)A=255;else{const I=r[f],k=r[f+1],L=r[f+2];A=306*I+601*k+117*L+512>>10}u[m]=A}return u}getRow(r,a){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const l=this.getWidth(),u=r*l;return a===null?a=this.buffer.slice(u,u+l):(a.length<l&&(a=new Uint8ClampedArray(l)),a.set(this.buffer.slice(u,u+l))),a}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,a,l,u){return super.crop(r,a,l,u),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const a=this.getTempCanvasElement(),l=a.getContext("2d"),u=r*ct.DEGREE_TO_RADIANS,f=this.canvas.width,m=this.canvas.height,y=Math.ceil(Math.abs(Math.cos(u))*f+Math.abs(Math.sin(u))*m),A=Math.ceil(Math.abs(Math.sin(u))*f+Math.abs(Math.cos(u))*m);return a.width=y,a.height=A,l.translate(y/2,A/2),l.rotate(u),l.drawImage(this.canvas,f/-2,m/-2),this.buffer=ct.makeBufferFromCanvasImageData(a),this}invert(){return new pt(this)}}ct.DEGREE_TO_RADIANS=Math.PI/180;class K{constructor(r,a,l){this.deviceId=r,this.label=a,this.kind="videoinput",this.groupId=l||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var pe=(globalThis||Wh||self||window||void 0)&&(globalThis||Wh||self||window||void 0).__awaiter||function(M,r,a,l){function u(f){return f instanceof a?f:new a(function(m){m(f)})}return new(a||(a=Promise))(function(f,m){function y(I){try{T(l.next(I))}catch(k){m(k)}}function A(I){try{T(l.throw(I))}catch(k){m(k)}}function T(I){I.done?f(I.value):u(I.value).then(y,A)}T((l=l.apply(M,r||[])).next())})};class De{constructor(r,a=500,l){this.reader=r,this.timeBetweenScansMillis=a,this._hints=l,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return pe(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),a=[];for(const l of r){const u=l.kind==="video"?"videoinput":l.kind;if(u!=="videoinput")continue;const f=l.deviceId||l.id,m=l.label||`Video device ${a.length+1}`,y=l.groupId,A={deviceId:f,label:m,kind:u,groupId:y};a.push(A)}return a})}getVideoInputDevices(){return pe(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(a=>new K(a.deviceId,a.label))})}findDeviceById(r){return pe(this,void 0,void 0,function*(){const a=yield this.listVideoInputDevices();return a?a.find(l=>l.deviceId===r):null})}decodeFromInputVideoDevice(r,a){return pe(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,a)})}decodeOnceFromVideoDevice(r,a){return pe(this,void 0,void 0,function*(){this.reset();let l;r?l={deviceId:{exact:r}}:l={facingMode:"environment"};const u={video:l};return yield this.decodeOnceFromConstraints(u,a)})}decodeOnceFromConstraints(r,a){return pe(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(l,a)})}decodeOnceFromStream(r,a){return pe(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(r,a);return yield this.decodeOnce(l)})}decodeFromInputVideoDeviceContinuously(r,a,l){return pe(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,a,l)})}decodeFromVideoDevice(r,a,l){return pe(this,void 0,void 0,function*(){let u;r?u={deviceId:{exact:r}}:u={facingMode:"environment"};const f={video:u};return yield this.decodeFromConstraints(f,a,l)})}decodeFromConstraints(r,a,l){return pe(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(u,a,l)})}decodeFromStream(r,a,l){return pe(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(r,a);return yield this.decodeContinuously(u,l)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,a){return pe(this,void 0,void 0,function*(){const l=this.prepareVideoElement(a);return this.addVideoSource(l,r),this.videoElement=l,this.stream=r,yield this.playVideoOnLoadAsync(l),l})}playVideoOnLoadAsync(r){return new Promise((a,l)=>this.playVideoOnLoad(r,()=>a()))}playVideoOnLoad(r,a){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",a),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return pe(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,a){const l=document.getElementById(r);if(!l)throw new S(`element with id '${r}' not found`);if(l.nodeName.toLowerCase()!==a.toLowerCase())throw new S(`element with id '${r}' must be an ${a} element`);return l}decodeFromImage(r,a){if(!r&&!a)throw new S("either imageElement with a src set or an url must be provided");return a&&!r?this.decodeFromImageUrl(a):this.decodeFromImageElement(r)}decodeFromVideo(r,a){if(!r&&!a)throw new S("Either an element with a src set or an URL must be provided");return a&&!r?this.decodeFromVideoUrl(a):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,a,l){if(r===void 0&&a===void 0)throw new S("Either an element with a src set or an URL must be provided");return a&&!r?this.decodeFromVideoUrlContinuously(a,l):this.decodeFromVideoElementContinuously(r,l)}decodeFromImageElement(r){if(!r)throw new S("An image element must be provided.");this.reset();const a=this.prepareImageElement(r);this.imageElement=a;let l;return this.isImageLoaded(a)?l=this.decodeOnce(a,!1,!0):l=this._decodeOnLoadImage(a),l}decodeFromVideoElement(r){const a=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(a)}decodeFromVideoElementContinuously(r,a){const l=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(l,a)}_decodeFromVideoElementSetup(r){if(!r)throw new S("A video element must be provided.");this.reset();const a=this.prepareVideoElement(r);return this.videoElement=a,a}decodeFromImageUrl(r){if(!r)throw new S("An URL must be provided.");this.reset();const a=this.prepareImageElement();this.imageElement=a;const l=this._decodeOnLoadImage(a);return a.src=r,l}decodeFromVideoUrl(r){if(!r)throw new S("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),l=this.decodeFromVideoElement(a);return a.src=r,l}decodeFromVideoUrlContinuously(r,a){if(!r)throw new S("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),u=this.decodeFromVideoElementContinuously(l,a);return l.src=r,u}_decodeOnLoadImage(r){return new Promise((a,l)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(a,l),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return pe(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,a){return pe(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,a)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let a;return typeof r>"u"&&(a=document.createElement("img"),a.width=200,a.height=200),typeof r=="string"&&(a=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(a=r),a}prepareVideoElement(r){let a;return!r&&typeof document<"u"&&(a=document.createElement("video"),a.width=200,a.height=200),typeof r=="string"&&(a=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(a=r),a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),a.setAttribute("playsinline","true"),a}decodeOnce(r,a=!0,l=!0){this._stopAsyncDecode=!1;const u=(f,m)=>{if(this._stopAsyncDecode){m(new ae("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const y=this.decode(r);f(y)}catch(y){const A=a&&y instanceof ae,I=(y instanceof X||y instanceof F)&&l;if(A||I)return setTimeout(u,this._timeBetweenDecodingAttempts,f,m);m(y)}};return new Promise((f,m)=>u(f,m))}decodeContinuously(r,a){this._stopContinuousDecode=!1;const l=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const u=this.decode(r);a(u,null),setTimeout(l,this.timeBetweenScansMillis)}catch(u){a(null,u);const f=u instanceof X||u instanceof F,m=u instanceof ae;(f||m)&&setTimeout(l,this._timeBetweenDecodingAttempts)}};l()}decode(r){const a=this.createBinaryBitmap(r);return this.decodeBitmap(a)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,a,l){a||(a={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),l||(l=this.captureCanvasContext),l.drawImage(r,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}drawImageOnCanvas(r,a,l=this.captureCanvasContext){a||(a={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),l||(l=this.captureCanvasContext),l.drawImage(r,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const a=this.getCaptureCanvas(r),l=new ct(a),u=new ne(l);return new P(u)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const l=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=l}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const a=this.createCaptureCanvas(r);this.captureCanvas=a}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const a=document.createElement("canvas");let l,u;return typeof r<"u"&&(r instanceof HTMLVideoElement?(l=r.videoWidth,u=r.videoHeight):r instanceof HTMLImageElement&&(l=r.naturalWidth||r.width,u=r.naturalHeight||r.height)),a.style.width=l+"px",a.style.height=u+"px",a.width=l,a.height=u,a}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,a){try{r.srcObject=a}catch{r.src=URL.createObjectURL(a)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class Ve{constructor(r,a,l=a==null?0:8*a.length,u,f,m=oe.currentTimeMillis()){this.text=r,this.rawBytes=a,this.numBits=l,this.resultPoints=u,this.format=f,this.timestamp=m,this.text=r,this.rawBytes=a,l==null?this.numBits=a==null?0:8*a.length:this.numBits=l,this.resultPoints=u,this.format=f,this.resultMetadata=null,m==null?this.timestamp=oe.currentTimeMillis():this.timestamp=m}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,a){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,a)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const a=this.resultPoints;if(a===null)this.resultPoints=r;else if(r!==null&&r.length>0){const l=new Array(a.length+r.length);oe.arraycopy(a,0,l,0,a.length),oe.arraycopy(r,0,l,a.length,r.length),this.resultPoints=l}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Le;(function(M){M[M.AZTEC=0]="AZTEC",M[M.CODABAR=1]="CODABAR",M[M.CODE_39=2]="CODE_39",M[M.CODE_93=3]="CODE_93",M[M.CODE_128=4]="CODE_128",M[M.DATA_MATRIX=5]="DATA_MATRIX",M[M.EAN_8=6]="EAN_8",M[M.EAN_13=7]="EAN_13",M[M.ITF=8]="ITF",M[M.MAXICODE=9]="MAXICODE",M[M.PDF_417=10]="PDF_417",M[M.QR_CODE=11]="QR_CODE",M[M.RSS_14=12]="RSS_14",M[M.RSS_EXPANDED=13]="RSS_EXPANDED",M[M.UPC_A=14]="UPC_A",M[M.UPC_E=15]="UPC_E",M[M.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Le||(Le={}));var we=Le,ut;(function(M){M[M.OTHER=0]="OTHER",M[M.ORIENTATION=1]="ORIENTATION",M[M.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",M[M.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",M[M.ISSUE_NUMBER=4]="ISSUE_NUMBER",M[M.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",M[M.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",M[M.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",M[M.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",M[M.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",M[M.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ut||(ut={}));var xt=ut;class Mt{constructor(r,a,l,u,f=-1,m=-1){this.rawBytes=r,this.text=a,this.byteSegments=l,this.ecLevel=u,this.structuredAppendSequenceNumber=f,this.structuredAppendParity=m,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Mn{exp(r){return this.expTable[r]}log(r){if(r===0)throw new N;return this.logTable[r]}static addOrSubtract(r,a){return r^a}}class Ie{constructor(r,a){if(a.length===0)throw new N;this.field=r;const l=a.length;if(l>1&&a[0]===0){let u=1;for(;u<l&&a[u]===0;)u++;u===l?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(l-u),oe.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const a=this.coefficients;let l;if(r===1){l=0;for(let m=0,y=a.length;m!==y;m++){const A=a[m];l=Mn.addOrSubtract(l,A)}return l}l=a[0];const u=a.length,f=this.field;for(let m=1;m<u;m++)l=Mn.addOrSubtract(f.multiply(r,l),a[m]);return l}addOrSubtract(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let a=this.coefficients,l=r.coefficients;if(a.length>l.length){const m=a;a=l,l=m}let u=new Int32Array(l.length);const f=l.length-a.length;oe.arraycopy(l,0,u,0,f);for(let m=f;m<l.length;m++)u[m]=Mn.addOrSubtract(a[m-f],l[m]);return new Ie(this.field,u)}multiply(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const a=this.coefficients,l=a.length,u=r.coefficients,f=u.length,m=new Int32Array(l+f-1),y=this.field;for(let A=0;A<l;A++){const T=a[A];for(let I=0;I<f;I++)m[A+I]=Mn.addOrSubtract(m[A+I],y.multiply(T,u[I]))}return new Ie(y,m)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const a=this.coefficients.length,l=this.field,u=new Int32Array(a),f=this.coefficients;for(let m=0;m<a;m++)u[m]=l.multiply(f[m],r);return new Ie(l,u)}multiplyByMonomial(r,a){if(r<0)throw new N;if(a===0)return this.field.getZero();const l=this.coefficients,u=l.length,f=new Int32Array(u+r),m=this.field;for(let y=0;y<u;y++)f[y]=m.multiply(l[y],a);return new Ie(m,f)}divide(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new N("Divide by 0");const a=this.field;let l=a.getZero(),u=this;const f=r.getCoefficient(r.getDegree()),m=a.inverse(f);for(;u.getDegree()>=r.getDegree()&&!u.isZero();){const y=u.getDegree()-r.getDegree(),A=a.multiply(u.getCoefficient(u.getDegree()),m),T=r.multiplyByMonomial(y,A),I=a.buildMonomial(y,A);l=l.addOrSubtract(I),u=u.addOrSubtract(T)}return[l,u]}toString(){let r="";for(let a=this.getDegree();a>=0;a--){let l=this.getCoefficient(a);if(l!==0){if(l<0?(r+=" - ",l=-l):r.length>0&&(r+=" + "),a===0||l!==1){const u=this.field.log(l);u===0?r+="1":u===1?r+="a":(r+="a^",r+=u)}a!==0&&(a===1?r+="x":(r+="x^",r+=a))}}return r}}class $e extends _{}$e.kind="ArithmeticException";class He extends Mn{constructor(r,a,l){super(),this.primitive=r,this.size=a,this.generatorBase=l;const u=new Int32Array(a);let f=1;for(let y=0;y<a;y++)u[y]=f,f*=2,f>=a&&(f^=r,f&=a-1);this.expTable=u;const m=new Int32Array(a);for(let y=0;y<a-1;y++)m[u[y]]=y;this.logTable=m,this.zero=new Ie(this,Int32Array.from([0])),this.one=new Ie(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,a){if(r<0)throw new N;if(a===0)return this.zero;const l=new Int32Array(r+1);return l[0]=a,new Ie(this,l)}inverse(r){if(r===0)throw new $e;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,a){return r===0||a===0?0:this.expTable[(this.logTable[r]+this.logTable[a])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+de.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}He.AZTEC_DATA_12=new He(4201,4096,1),He.AZTEC_DATA_10=new He(1033,1024,1),He.AZTEC_DATA_6=new He(67,64,1),He.AZTEC_PARAM=new He(19,16,1),He.QR_CODE_FIELD_256=new He(285,256,0),He.DATA_MATRIX_FIELD_256=new He(301,256,1),He.AZTEC_DATA_8=He.DATA_MATRIX_FIELD_256,He.MAXICODE_FIELD_64=He.AZTEC_DATA_6;class bt extends _{}bt.kind="ReedSolomonException";class yt extends _{}yt.kind="IllegalStateException";class Ct{constructor(r){this.field=r}decode(r,a){const l=this.field,u=new Ie(l,r),f=new Int32Array(a);let m=!0;for(let G=0;G<a;G++){const Q=u.evaluateAt(l.exp(G+l.getGeneratorBase()));f[f.length-1-G]=Q,Q!==0&&(m=!1)}if(m)return;const y=new Ie(l,f),A=this.runEuclideanAlgorithm(l.buildMonomial(a,1),y,a),T=A[0],I=A[1],k=this.findErrorLocations(T),L=this.findErrorMagnitudes(I,k);for(let G=0;G<k.length;G++){const Q=r.length-1-l.log(k[G]);if(Q<0)throw new bt("Bad error location");r[Q]=He.addOrSubtract(r[Q],L[G])}}runEuclideanAlgorithm(r,a,l){if(r.getDegree()<a.getDegree()){const G=r;r=a,a=G}const u=this.field;let f=r,m=a,y=u.getZero(),A=u.getOne();for(;m.getDegree()>=(l/2|0);){let G=f,Q=y;if(f=m,y=A,f.isZero())throw new bt("r_{i-1} was zero");m=G;let J=u.getZero();const se=f.getCoefficient(f.getDegree()),ye=u.inverse(se);for(;m.getDegree()>=f.getDegree()&&!m.isZero();){const Ue=m.getDegree()-f.getDegree(),Be=u.multiply(m.getCoefficient(m.getDegree()),ye);J=J.addOrSubtract(u.buildMonomial(Ue,Be)),m=m.addOrSubtract(f.multiplyByMonomial(Ue,Be))}if(A=J.multiply(y).addOrSubtract(Q),m.getDegree()>=f.getDegree())throw new yt("Division algorithm failed to reduce polynomial?")}const T=A.getCoefficient(0);if(T===0)throw new bt("sigmaTilde(0) was zero");const I=u.inverse(T),k=A.multiplyScalar(I),L=m.multiplyScalar(I);return[k,L]}findErrorLocations(r){const a=r.getDegree();if(a===1)return Int32Array.from([r.getCoefficient(1)]);const l=new Int32Array(a);let u=0;const f=this.field;for(let m=1;m<f.getSize()&&u<a;m++)r.evaluateAt(m)===0&&(l[u]=f.inverse(m),u++);if(u!==a)throw new bt("Error locator degree does not match number of roots");return l}findErrorMagnitudes(r,a){const l=a.length,u=new Int32Array(l),f=this.field;for(let m=0;m<l;m++){const y=f.inverse(a[m]);let A=1;for(let T=0;T<l;T++)if(m!==T){const I=f.multiply(a[T],y),k=(I&1)===0?I|1:I&-2;A=f.multiply(A,k)}u[m]=f.multiply(r.evaluateAt(y),f.inverse(A)),f.getGeneratorBase()!==0&&(u[m]=f.multiply(u[m],y))}return u}}var gt;(function(M){M[M.UPPER=0]="UPPER",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.DIGIT=3]="DIGIT",M[M.PUNCT=4]="PUNCT",M[M.BINARY=5]="BINARY"})(gt||(gt={}));class ht{decode(r){this.ddata=r;let a=r.getBits(),l=this.extractBits(a),u=this.correctBits(l),f=ht.convertBoolArrayToByteArray(u),m=ht.getEncodedData(u),y=new Mt(f,m,null,null);return y.setNumBits(u.length),y}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let a=r.length,l=gt.UPPER,u=gt.UPPER,f="",m=0;for(;m<a;)if(u===gt.BINARY){if(a-m<5)break;let y=ht.readCode(r,m,5);if(m+=5,y===0){if(a-m<11)break;y=ht.readCode(r,m,11)+31,m+=11}for(let A=0;A<y;A++){if(a-m<8){m=a;break}const T=ht.readCode(r,m,8);f+=Y.castAsNonUtf8Char(T),m+=8}u=l}else{let y=u===gt.DIGIT?4:5;if(a-m<y)break;let A=ht.readCode(r,m,y);m+=y;let T=ht.getCharacter(u,A);T.startsWith("CTRL_")?(l=u,u=ht.getTable(T.charAt(5)),T.charAt(6)==="L"&&(l=u)):(f+=T,u=l)}return f}static getTable(r){switch(r){case"L":return gt.LOWER;case"P":return gt.PUNCT;case"M":return gt.MIXED;case"D":return gt.DIGIT;case"B":return gt.BINARY;case"U":default:return gt.UPPER}}static getCharacter(r,a){switch(r){case gt.UPPER:return ht.UPPER_TABLE[a];case gt.LOWER:return ht.LOWER_TABLE[a];case gt.MIXED:return ht.MIXED_TABLE[a];case gt.PUNCT:return ht.PUNCT_TABLE[a];case gt.DIGIT:return ht.DIGIT_TABLE[a];default:throw new yt("Bad table")}}correctBits(r){let a,l;this.ddata.getNbLayers()<=2?(l=6,a=He.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(l=8,a=He.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(l=10,a=He.AZTEC_DATA_10):(l=12,a=He.AZTEC_DATA_12);let u=this.ddata.getNbDatablocks(),f=r.length/l;if(f<u)throw new F;let m=r.length%l,y=new Int32Array(f);for(let L=0;L<f;L++,m+=l)y[L]=ht.readCode(r,m,l);try{new Ct(a).decode(y,f-u)}catch(L){throw new F(L)}let A=(1<<l)-1,T=0;for(let L=0;L<u;L++){let G=y[L];if(G===0||G===A)throw new F;(G===1||G===A-1)&&T++}let I=new Array(u*l-T),k=0;for(let L=0;L<u;L++){let G=y[L];if(G===1||G===A-1)I.fill(G>1,k,k+l-1),k+=l-1;else for(let Q=l-1;Q>=0;--Q)I[k++]=(G&1<<Q)!==0}return I}extractBits(r){let a=this.ddata.isCompact(),l=this.ddata.getNbLayers(),u=(a?11:14)+l*4,f=new Int32Array(u),m=new Array(this.totalBitsInLayer(l,a));if(a)for(let y=0;y<f.length;y++)f[y]=y;else{let y=u+1+2*de.truncDivision(de.truncDivision(u,2)-1,15),A=u/2,T=de.truncDivision(y,2);for(let I=0;I<A;I++){let k=I+de.truncDivision(I,15);f[A-I-1]=T-k-1,f[A+I]=T+k+1}}for(let y=0,A=0;y<l;y++){let T=(l-y)*4+(a?9:12),I=y*2,k=u-1-I;for(let L=0;L<T;L++){let G=L*2;for(let Q=0;Q<2;Q++)m[A+G+Q]=r.get(f[I+Q],f[I+L]),m[A+2*T+G+Q]=r.get(f[I+L],f[k-Q]),m[A+4*T+G+Q]=r.get(f[k-Q],f[k-L]),m[A+6*T+G+Q]=r.get(f[k-L],f[I+Q])}A+=T*8}return m}static readCode(r,a,l){let u=0;for(let f=a;f<a+l;f++)u<<=1,r[f]&&(u|=1);return u}static readByte(r,a){let l=r.length-a;return l>=8?ht.readCode(r,a,8):ht.readCode(r,a,l)<<8-l}static convertBoolArrayToByteArray(r){let a=new Uint8Array((r.length+7)/8);for(let l=0;l<a.length;l++)a[l]=ht.readByte(r,8*l);return a}totalBitsInLayer(r,a){return((a?88:112)+16*r)*r}}ht.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],ht.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],ht.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],ht.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],ht.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Qe{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,a,l,u){const f=r-l,m=a-u;return Math.sqrt(f*f+m*m)}static sum(r){let a=0;for(let l=0,u=r.length;l!==u;l++){const f=r[l];a+=f}return a}}class en{static floatToIntBits(r){return r}}en.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Xe{constructor(r,a){this.x=r,this.y=a}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof Xe){const a=r;return this.x===a.x&&this.y===a.y}return!1}hashCode(){return 31*en.floatToIntBits(this.x)+en.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const a=this.distance(r[0],r[1]),l=this.distance(r[1],r[2]),u=this.distance(r[0],r[2]);let f,m,y;if(l>=a&&l>=u?(m=r[0],f=r[1],y=r[2]):u>=l&&u>=a?(m=r[1],f=r[0],y=r[2]):(m=r[2],f=r[0],y=r[1]),this.crossProductZ(f,m,y)<0){const A=f;f=y,y=A}r[0]=f,r[1]=m,r[2]=y}static distance(r,a){return Qe.distance(r.x,r.y,a.x,a.y)}static crossProductZ(r,a,l){const u=a.x,f=a.y;return(l.x-u)*(r.y-f)-(l.y-f)*(r.x-u)}}class Ur{constructor(r,a){this.bits=r,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class St extends Ur{constructor(r,a,l,u,f){super(r,a),this.compact=l,this.nbDatablocks=u,this.nbLayers=f}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Tt{constructor(r,a,l,u){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),a==null&&(a=Tt.INIT_SIZE),l==null&&(l=r.getWidth()/2|0),u==null&&(u=r.getHeight()/2|0);const f=a/2|0;if(this.leftInit=l-f,this.rightInit=l+f,this.upInit=u-f,this.downInit=u+f,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ae}detect(){let r=this.leftInit,a=this.rightInit,l=this.upInit,u=this.downInit,f=!1,m=!0,y=!1,A=!1,T=!1,I=!1,k=!1;const L=this.width,G=this.height;for(;m;){m=!1;let Q=!0;for(;(Q||!A)&&a<L;)Q=this.containsBlackPoint(l,u,a,!1),Q?(a++,m=!0,A=!0):A||a++;if(a>=L){f=!0;break}let J=!0;for(;(J||!T)&&u<G;)J=this.containsBlackPoint(r,a,u,!0),J?(u++,m=!0,T=!0):T||u++;if(u>=G){f=!0;break}let se=!0;for(;(se||!I)&&r>=0;)se=this.containsBlackPoint(l,u,r,!1),se?(r--,m=!0,I=!0):I||r--;if(r<0){f=!0;break}let ye=!0;for(;(ye||!k)&&l>=0;)ye=this.containsBlackPoint(r,a,l,!0),ye?(l--,m=!0,k=!0):k||l--;if(l<0){f=!0;break}m&&(y=!0)}if(!f&&y){const Q=a-r;let J=null;for(let Be=1;J===null&&Be<Q;Be++)J=this.getBlackPointOnSegment(r,u-Be,r+Be,u);if(J==null)throw new ae;let se=null;for(let Be=1;se===null&&Be<Q;Be++)se=this.getBlackPointOnSegment(r,l+Be,r+Be,l);if(se==null)throw new ae;let ye=null;for(let Be=1;ye===null&&Be<Q;Be++)ye=this.getBlackPointOnSegment(a,l+Be,a-Be,l);if(ye==null)throw new ae;let Ue=null;for(let Be=1;Ue===null&&Be<Q;Be++)Ue=this.getBlackPointOnSegment(a,u-Be,a-Be,u);if(Ue==null)throw new ae;return this.centerEdges(Ue,J,ye,se)}else throw new ae}getBlackPointOnSegment(r,a,l,u){const f=Qe.round(Qe.distance(r,a,l,u)),m=(l-r)/f,y=(u-a)/f,A=this.image;for(let T=0;T<f;T++){const I=Qe.round(r+T*m),k=Qe.round(a+T*y);if(A.get(I,k))return new Xe(I,k)}return null}centerEdges(r,a,l,u){const f=r.getX(),m=r.getY(),y=a.getX(),A=a.getY(),T=l.getX(),I=l.getY(),k=u.getX(),L=u.getY(),G=Tt.CORR;return f<this.width/2?[new Xe(k-G,L+G),new Xe(y+G,A+G),new Xe(T-G,I-G),new Xe(f+G,m-G)]:[new Xe(k+G,L+G),new Xe(y+G,A-G),new Xe(T-G,I+G),new Xe(f-G,m-G)]}containsBlackPoint(r,a,l,u){const f=this.image;if(u){for(let m=r;m<=a;m++)if(f.get(m,l))return!0}else for(let m=r;m<=a;m++)if(f.get(l,m))return!0;return!1}}Tt.INIT_SIZE=10,Tt.CORR=1;class Ae{static checkAndNudgePoints(r,a){const l=r.getWidth(),u=r.getHeight();let f=!0;for(let m=0;m<a.length&&f;m+=2){const y=Math.floor(a[m]),A=Math.floor(a[m+1]);if(y<-1||y>l||A<-1||A>u)throw new ae;f=!1,y===-1?(a[m]=0,f=!0):y===l&&(a[m]=l-1,f=!0),A===-1?(a[m+1]=0,f=!0):A===u&&(a[m+1]=u-1,f=!0)}f=!0;for(let m=a.length-2;m>=0&&f;m-=2){const y=Math.floor(a[m]),A=Math.floor(a[m+1]);if(y<-1||y>l||A<-1||A>u)throw new ae;f=!1,y===-1?(a[m]=0,f=!0):y===l&&(a[m]=l-1,f=!0),A===-1?(a[m+1]=0,f=!0):A===u&&(a[m+1]=u-1,f=!0)}}}class Re{constructor(r,a,l,u,f,m,y,A,T){this.a11=r,this.a21=a,this.a31=l,this.a12=u,this.a22=f,this.a32=m,this.a13=y,this.a23=A,this.a33=T}static quadrilateralToQuadrilateral(r,a,l,u,f,m,y,A,T,I,k,L,G,Q,J,se){const ye=Re.quadrilateralToSquare(r,a,l,u,f,m,y,A);return Re.squareToQuadrilateral(T,I,k,L,G,Q,J,se).times(ye)}transformPoints(r){const a=r.length,l=this.a11,u=this.a12,f=this.a13,m=this.a21,y=this.a22,A=this.a23,T=this.a31,I=this.a32,k=this.a33;for(let L=0;L<a;L+=2){const G=r[L],Q=r[L+1],J=f*G+A*Q+k;r[L]=(l*G+m*Q+T)/J,r[L+1]=(u*G+y*Q+I)/J}}transformPointsWithValues(r,a){const l=this.a11,u=this.a12,f=this.a13,m=this.a21,y=this.a22,A=this.a23,T=this.a31,I=this.a32,k=this.a33,L=r.length;for(let G=0;G<L;G++){const Q=r[G],J=a[G],se=f*Q+A*J+k;r[G]=(l*Q+m*J+T)/se,a[G]=(u*Q+y*J+I)/se}}static squareToQuadrilateral(r,a,l,u,f,m,y,A){const T=r-l+f-y,I=a-u+m-A;if(T===0&&I===0)return new Re(l-r,f-l,r,u-a,m-u,a,0,0,1);{const k=l-f,L=y-f,G=u-m,Q=A-m,J=k*Q-L*G,se=(T*Q-L*I)/J,ye=(k*I-T*G)/J;return new Re(l-r+se*l,y-r+ye*y,r,u-a+se*u,A-a+ye*A,a,se,ye,1)}}static quadrilateralToSquare(r,a,l,u,f,m,y,A){return Re.squareToQuadrilateral(r,a,l,u,f,m,y,A).buildAdjoint()}buildAdjoint(){return new Re(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new Re(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class Ge extends Ae{sampleGrid(r,a,l,u,f,m,y,A,T,I,k,L,G,Q,J,se,ye,Ue,Be){const Me=Re.quadrilateralToQuadrilateral(u,f,m,y,A,T,I,k,L,G,Q,J,se,ye,Ue,Be);return this.sampleGridWithTransform(r,a,l,Me)}sampleGridWithTransform(r,a,l,u){if(a<=0||l<=0)throw new ae;const f=new rt(a,l),m=new Float32Array(2*a);for(let y=0;y<l;y++){const A=m.length,T=y+.5;for(let I=0;I<A;I+=2)m[I]=I/2+.5,m[I+1]=T;u.transformPoints(m),Ae.checkAndNudgePoints(r,m);try{for(let I=0;I<A;I+=2)r.get(Math.floor(m[I]),Math.floor(m[I+1]))&&f.set(I/2,y)}catch{throw new ae}}return f}}class Je{static setGridSampler(r){Je.gridSampler=r}static getInstance(){return Je.gridSampler}}Je.gridSampler=new Ge;class nt{constructor(r,a){this.x=r,this.y=a}toResultPoint(){return new Xe(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class kn{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let a=this.getMatrixCenter(),l=this.getBullsEyeCorners(a);if(r){let m=l[0];l[0]=l[2],l[2]=m}this.extractParameters(l);let u=this.sampleGrid(this.image,l[this.shift%4],l[(this.shift+1)%4],l[(this.shift+2)%4],l[(this.shift+3)%4]),f=this.getMatrixCornerPoints(l);return new St(u,f,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new ae;let a=2*this.nbCenterLayers,l=new Int32Array([this.sampleLine(r[0],r[1],a),this.sampleLine(r[1],r[2],a),this.sampleLine(r[2],r[3],a),this.sampleLine(r[3],r[0],a)]);this.shift=this.getRotation(l,a);let u=0;for(let m=0;m<4;m++){let y=l[(this.shift+m)%4];this.compact?(u<<=7,u+=y>>1&127):(u<<=10,u+=(y>>2&992)+(y>>1&31))}let f=this.getCorrectedParameterData(u,this.compact);this.compact?(this.nbLayers=(f>>6)+1,this.nbDataBlocks=(f&63)+1):(this.nbLayers=(f>>11)+1,this.nbDataBlocks=(f&2047)+1)}getRotation(r,a){let l=0;r.forEach((u,f,m)=>{let y=(u>>a-2<<1)+(u&1);l=(l<<3)+y}),l=((l&1)<<11)+(l>>1);for(let u=0;u<4;u++)if(de.bitCount(l^this.EXPECTED_CORNER_BITS[u])<=2)return u;throw new ae}getCorrectedParameterData(r,a){let l,u;a?(l=7,u=2):(l=10,u=4);let f=l-u,m=new Int32Array(l);for(let A=l-1;A>=0;--A)m[A]=r&15,r>>=4;try{new Ct(He.AZTEC_PARAM).decode(m,f)}catch{throw new ae}let y=0;for(let A=0;A<u;A++)y=(y<<4)+m[A];return y}getBullsEyeCorners(r){let a=r,l=r,u=r,f=r,m=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let k=this.getFirstDifferent(a,m,1,-1),L=this.getFirstDifferent(l,m,1,1),G=this.getFirstDifferent(u,m,-1,1),Q=this.getFirstDifferent(f,m,-1,-1);if(this.nbCenterLayers>2){let J=this.distancePoint(Q,k)*this.nbCenterLayers/(this.distancePoint(f,a)*(this.nbCenterLayers+2));if(J<.75||J>1.25||!this.isWhiteOrBlackRectangle(k,L,G,Q))break}a=k,l=L,u=G,f=Q,m=!m}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ae;this.compact=this.nbCenterLayers===5;let y=new Xe(a.getX()+.5,a.getY()-.5),A=new Xe(l.getX()+.5,l.getY()+.5),T=new Xe(u.getX()-.5,u.getY()+.5),I=new Xe(f.getX()-.5,f.getY()-.5);return this.expandSquare([y,A,T,I],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,a,l,u;try{let y=new Tt(this.image).detect();r=y[0],a=y[1],l=y[2],u=y[3]}catch{let A=this.image.getWidth()/2,T=this.image.getHeight()/2;r=this.getFirstDifferent(new nt(A+7,T-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new nt(A+7,T+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new nt(A-7,T+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new nt(A-7,T-7),!1,-1,-1).toResultPoint()}let f=Qe.round((r.getX()+u.getX()+a.getX()+l.getX())/4),m=Qe.round((r.getY()+u.getY()+a.getY()+l.getY())/4);try{let y=new Tt(this.image,15,f,m).detect();r=y[0],a=y[1],l=y[2],u=y[3]}catch{r=this.getFirstDifferent(new nt(f+7,m-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new nt(f+7,m+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new nt(f-7,m+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new nt(f-7,m-7),!1,-1,-1).toResultPoint()}return f=Qe.round((r.getX()+u.getX()+a.getX()+l.getX())/4),m=Qe.round((r.getY()+u.getY()+a.getY()+l.getY())/4),new nt(f,m)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,a,l,u,f){let m=Je.getInstance(),y=this.getDimension(),A=y/2-this.nbCenterLayers,T=y/2+this.nbCenterLayers;return m.sampleGrid(r,y,y,A,A,T,A,T,T,A,T,a.getX(),a.getY(),l.getX(),l.getY(),u.getX(),u.getY(),f.getX(),f.getY())}sampleLine(r,a,l){let u=0,f=this.distanceResultPoint(r,a),m=f/l,y=r.getX(),A=r.getY(),T=m*(a.getX()-r.getX())/f,I=m*(a.getY()-r.getY())/f;for(let k=0;k<l;k++)this.image.get(Qe.round(y+k*T),Qe.round(A+k*I))&&(u|=1<<l-k-1);return u}isWhiteOrBlackRectangle(r,a,l,u){let f=3;r=new nt(r.getX()-f,r.getY()+f),a=new nt(a.getX()-f,a.getY()-f),l=new nt(l.getX()+f,l.getY()-f),u=new nt(u.getX()+f,u.getY()+f);let m=this.getColor(u,r);if(m===0)return!1;let y=this.getColor(r,a);return y!==m||(y=this.getColor(a,l),y!==m)?!1:(y=this.getColor(l,u),y===m)}getColor(r,a){let l=this.distancePoint(r,a),u=(a.getX()-r.getX())/l,f=(a.getY()-r.getY())/l,m=0,y=r.getX(),A=r.getY(),T=this.image.get(r.getX(),r.getY()),I=Math.ceil(l);for(let L=0;L<I;L++)y+=u,A+=f,this.image.get(Qe.round(y),Qe.round(A))!==T&&m++;let k=m/l;return k>.1&&k<.9?0:k<=.1===T?1:-1}getFirstDifferent(r,a,l,u){let f=r.getX()+l,m=r.getY()+u;for(;this.isValid(f,m)&&this.image.get(f,m)===a;)f+=l,m+=u;for(f-=l,m-=u;this.isValid(f,m)&&this.image.get(f,m)===a;)f+=l;for(f-=l;this.isValid(f,m)&&this.image.get(f,m)===a;)m+=u;return m-=u,new nt(f,m)}expandSquare(r,a,l){let u=l/(2*a),f=r[0].getX()-r[2].getX(),m=r[0].getY()-r[2].getY(),y=(r[0].getX()+r[2].getX())/2,A=(r[0].getY()+r[2].getY())/2,T=new Xe(y+u*f,A+u*m),I=new Xe(y-u*f,A-u*m);f=r[1].getX()-r[3].getX(),m=r[1].getY()-r[3].getY(),y=(r[1].getX()+r[3].getX())/2,A=(r[1].getY()+r[3].getY())/2;let k=new Xe(y+u*f,A+u*m),L=new Xe(y-u*f,A-u*m);return[T,k,I,L]}isValid(r,a){return r>=0&&r<this.image.getWidth()&&a>0&&a<this.image.getHeight()}isValidPoint(r){let a=Qe.round(r.getX()),l=Qe.round(r.getY());return this.isValid(a,l)}distancePoint(r,a){return Qe.distance(r.getX(),r.getY(),a.getX(),a.getY())}distanceResultPoint(r,a){return Qe.distance(r.getX(),r.getY(),a.getX(),a.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(de.truncDivision(this.nbLayers-4,8)+1)+15}}class st{decode(r,a=null){let l=null,u=new kn(r.getBlackMatrix()),f=null,m=null;try{let I=u.detectMirror(!1);f=I.getPoints(),this.reportFoundResultPoints(a,f),m=new ht().decode(I)}catch(I){l=I}if(m==null)try{let I=u.detectMirror(!0);f=I.getPoints(),this.reportFoundResultPoints(a,f),m=new ht().decode(I)}catch(I){throw l??I}let y=new Ve(m.getText(),m.getRawBytes(),m.getNumBits(),f,we.AZTEC,oe.currentTimeMillis()),A=m.getByteSegments();A!=null&&y.putMetadata(xt.BYTE_SEGMENTS,A);let T=m.getECLevel();return T!=null&&y.putMetadata(xt.ERROR_CORRECTION_LEVEL,T),y}reportFoundResultPoints(r,a){if(r!=null){let l=r.get(qe.NEED_RESULT_POINT_CALLBACK);l!=null&&a.forEach((u,f,m)=>{l.foundPossibleResultPoint(u)})}}reset(){}}class Xt extends De{constructor(r=500){super(new st,r)}}class et{decode(r,a){try{return this.doDecode(r,a)}catch{if(a&&a.get(qe.TRY_HARDER)===!0&&r.isRotateSupported()){const f=r.rotateCounterClockwise(),m=this.doDecode(f,a),y=m.getResultMetadata();let A=270;y!==null&&y.get(xt.ORIENTATION)===!0&&(A=A+y.get(xt.ORIENTATION)%360),m.putMetadata(xt.ORIENTATION,A);const T=m.getResultPoints();if(T!==null){const I=f.getHeight();for(let k=0;k<T.length;k++)T[k]=new Xe(I-T[k].getY()-1,T[k].getX())}return m}else throw new ae}}reset(){}doDecode(r,a){const l=r.getWidth(),u=r.getHeight();let f=new Pe(l);const m=a&&a.get(qe.TRY_HARDER)===!0,y=Math.max(1,u>>(m?8:5));let A;m?A=u:A=15;const T=Math.trunc(u/2);for(let I=0;I<A;I++){const k=Math.trunc((I+1)/2),L=(I&1)===0,G=T+y*(L?k:-k);if(G<0||G>=u)break;try{f=r.getBlackRow(G,f)}catch{continue}for(let Q=0;Q<2;Q++){if(Q===1&&(f.reverse(),a&&a.get(qe.NEED_RESULT_POINT_CALLBACK)===!0)){const J=new Map;a.forEach((se,ye)=>J.set(ye,se)),J.delete(qe.NEED_RESULT_POINT_CALLBACK),a=J}try{const J=this.decodeRow(G,f,a);if(Q===1){J.putMetadata(xt.ORIENTATION,180);const se=J.getResultPoints();se!==null&&(se[0]=new Xe(l-se[0].getX()-1,se[0].getY()),se[1]=new Xe(l-se[1].getX()-1,se[1].getY()))}return J}catch{}}}throw new ae}static recordPattern(r,a,l){const u=l.length;for(let T=0;T<u;T++)l[T]=0;const f=r.getSize();if(a>=f)throw new ae;let m=!r.get(a),y=0,A=a;for(;A<f;){if(r.get(A)!==m)l[y]++;else{if(++y===u)break;l[y]=1,m=!m}A++}if(!(y===u||y===u-1&&A===f))throw new ae}static recordPatternInReverse(r,a,l){let u=l.length,f=r.get(a);for(;a>0&&u>=0;)r.get(--a)!==f&&(u--,f=!f);if(u>=0)throw new ae;et.recordPattern(r,a+1,l)}static patternMatchVariance(r,a,l){const u=r.length;let f=0,m=0;for(let T=0;T<u;T++)f+=r[T],m+=a[T];if(f<m)return Number.POSITIVE_INFINITY;const y=f/m;l*=y;let A=0;for(let T=0;T<u;T++){const I=r[T],k=a[T]*y,L=I>k?I-k:k-I;if(L>l)return Number.POSITIVE_INFINITY;A+=L}return A/f}}class Te extends et{static findStartPattern(r){const a=r.getSize(),l=r.getNextSet(0);let u=0,f=Int32Array.from([0,0,0,0,0,0]),m=l,y=!1;const A=6;for(let T=l;T<a;T++)if(r.get(T)!==y)f[u]++;else{if(u===A-1){let I=Te.MAX_AVG_VARIANCE,k=-1;for(let L=Te.CODE_START_A;L<=Te.CODE_START_C;L++){const G=et.patternMatchVariance(f,Te.CODE_PATTERNS[L],Te.MAX_INDIVIDUAL_VARIANCE);G<I&&(I=G,k=L)}if(k>=0&&r.isRange(Math.max(0,m-(T-m)/2),m,!1))return Int32Array.from([m,T,k]);m+=f[0]+f[1],f=f.slice(2,f.length-1),f[u-1]=0,f[u]=0,u--}else u++;f[u]=1,y=!y}throw new ae}static decodeCode(r,a,l){et.recordPattern(r,l,a);let u=Te.MAX_AVG_VARIANCE,f=-1;for(let m=0;m<Te.CODE_PATTERNS.length;m++){const y=Te.CODE_PATTERNS[m],A=this.patternMatchVariance(a,y,Te.MAX_INDIVIDUAL_VARIANCE);A<u&&(u=A,f=m)}if(f>=0)return f;throw new ae}decodeRow(r,a,l){const u=l&&l.get(qe.ASSUME_GS1)===!0,f=Te.findStartPattern(a),m=f[2];let y=0;const A=new Uint8Array(20);A[y++]=m;let T;switch(m){case Te.CODE_START_A:T=Te.CODE_CODE_A;break;case Te.CODE_START_B:T=Te.CODE_CODE_B;break;case Te.CODE_START_C:T=Te.CODE_CODE_C;break;default:throw new F}let I=!1,k=!1,L="",G=f[0],Q=f[1];const J=Int32Array.from([0,0,0,0,0,0]);let se=0,ye=0,Ue=m,Be=0,Me=!0,Zt=!1,Ut=!1;for(;!I;){const ca=k;switch(k=!1,se=ye,ye=Te.decodeCode(a,J,Q),A[y++]=ye,ye!==Te.CODE_STOP&&(Me=!0),ye!==Te.CODE_STOP&&(Be++,Ue+=Be*ye),G=Q,Q+=J.reduce((qu,Ac)=>qu+Ac,0),ye){case Te.CODE_START_A:case Te.CODE_START_B:case Te.CODE_START_C:throw new F}switch(T){case Te.CODE_CODE_A:if(ye<64)Ut===Zt?L+=String.fromCharCode(32+ye):L+=String.fromCharCode(32+ye+128),Ut=!1;else if(ye<96)Ut===Zt?L+=String.fromCharCode(ye-64):L+=String.fromCharCode(ye+64),Ut=!1;else switch(ye!==Te.CODE_STOP&&(Me=!1),ye){case Te.CODE_FNC_1:u&&(L.length===0?L+="]C1":L+="");break;case Te.CODE_FNC_2:case Te.CODE_FNC_3:break;case Te.CODE_FNC_4_A:!Zt&&Ut?(Zt=!0,Ut=!1):Zt&&Ut?(Zt=!1,Ut=!1):Ut=!0;break;case Te.CODE_SHIFT:k=!0,T=Te.CODE_CODE_B;break;case Te.CODE_CODE_B:T=Te.CODE_CODE_B;break;case Te.CODE_CODE_C:T=Te.CODE_CODE_C;break;case Te.CODE_STOP:I=!0;break}break;case Te.CODE_CODE_B:if(ye<96)Ut===Zt?L+=String.fromCharCode(32+ye):L+=String.fromCharCode(32+ye+128),Ut=!1;else switch(ye!==Te.CODE_STOP&&(Me=!1),ye){case Te.CODE_FNC_1:u&&(L.length===0?L+="]C1":L+="");break;case Te.CODE_FNC_2:case Te.CODE_FNC_3:break;case Te.CODE_FNC_4_B:!Zt&&Ut?(Zt=!0,Ut=!1):Zt&&Ut?(Zt=!1,Ut=!1):Ut=!0;break;case Te.CODE_SHIFT:k=!0,T=Te.CODE_CODE_A;break;case Te.CODE_CODE_A:T=Te.CODE_CODE_A;break;case Te.CODE_CODE_C:T=Te.CODE_CODE_C;break;case Te.CODE_STOP:I=!0;break}break;case Te.CODE_CODE_C:if(ye<100)ye<10&&(L+="0"),L+=ye;else switch(ye!==Te.CODE_STOP&&(Me=!1),ye){case Te.CODE_FNC_1:u&&(L.length===0?L+="]C1":L+="");break;case Te.CODE_CODE_A:T=Te.CODE_CODE_A;break;case Te.CODE_CODE_B:T=Te.CODE_CODE_B;break;case Te.CODE_STOP:I=!0;break}break}ca&&(T=T===Te.CODE_CODE_A?Te.CODE_CODE_B:Te.CODE_CODE_A)}const fr=Q-G;if(Q=a.getNextUnset(Q),!a.isRange(Q,Math.min(a.getSize(),Q+(Q-G)/2),!1))throw new ae;if(Ue-=Be*se,Ue%103!==se)throw new X;const Ni=L.length;if(Ni===0)throw new ae;Ni>0&&Me&&(T===Te.CODE_CODE_C?L=L.substring(0,Ni-2):L=L.substring(0,Ni-1));const Wr=(f[1]+f[0])/2,In=G+fr/2,Pr=A.length,Ai=new Uint8Array(Pr);for(let ca=0;ca<Pr;ca++)Ai[ca]=A[ca];const za=[new Xe(Wr,r),new Xe(In,r)];return new Ve(L,Ai,0,za,we.CODE_128,new Date().getTime())}}Te.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Te.MAX_AVG_VARIANCE=.25,Te.MAX_INDIVIDUAL_VARIANCE=.7,Te.CODE_SHIFT=98,Te.CODE_CODE_C=99,Te.CODE_CODE_B=100,Te.CODE_CODE_A=101,Te.CODE_FNC_1=102,Te.CODE_FNC_2=97,Te.CODE_FNC_3=96,Te.CODE_FNC_4_A=101,Te.CODE_FNC_4_B=100,Te.CODE_START_A=103,Te.CODE_START_B=104,Te.CODE_START_C=105,Te.CODE_STOP=106;class kt extends et{constructor(r=!1,a=!1){super(),this.usingCheckDigit=r,this.extendedMode=a,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,a,l){let u=this.counters;u.fill(0),this.decodeRowResult="";let f=kt.findAsteriskPattern(a,u),m=a.getNextSet(f[1]),y=a.getSize(),A,T;do{kt.recordPattern(a,m,u);let J=kt.toNarrowWidePattern(u);if(J<0)throw new ae;A=kt.patternToChar(J),this.decodeRowResult+=A,T=m;for(let se of u)m+=se;m=a.getNextSet(m)}while(A!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let I=0;for(let J of u)I+=J;let k=m-T-I;if(m!==y&&k*2<I)throw new ae;if(this.usingCheckDigit){let J=this.decodeRowResult.length-1,se=0;for(let ye=0;ye<J;ye++)se+=kt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ye));if(this.decodeRowResult.charAt(J)!==kt.ALPHABET_STRING.charAt(se%43))throw new X;this.decodeRowResult=this.decodeRowResult.substring(0,J)}if(this.decodeRowResult.length===0)throw new ae;let L;this.extendedMode?L=kt.decodeExtended(this.decodeRowResult):L=this.decodeRowResult;let G=(f[1]+f[0])/2,Q=T+I/2;return new Ve(L,null,0,[new Xe(G,r),new Xe(Q,r)],we.CODE_39,new Date().getTime())}static findAsteriskPattern(r,a){let l=r.getSize(),u=r.getNextSet(0),f=0,m=u,y=!1,A=a.length;for(let T=u;T<l;T++)if(r.get(T)!==y)a[f]++;else{if(f===A-1){if(this.toNarrowWidePattern(a)===kt.ASTERISK_ENCODING&&r.isRange(Math.max(0,m-Math.floor((T-m)/2)),m,!1))return[m,T];m+=a[0]+a[1],a.copyWithin(0,2,2+f-1),a[f-1]=0,a[f]=0,f--}else f++;a[f]=1,y=!y}throw new ae}static toNarrowWidePattern(r){let a=r.length,l=0,u;do{let f=2147483647;for(let A of r)A<f&&A>l&&(f=A);l=f,u=0;let m=0,y=0;for(let A=0;A<a;A++){let T=r[A];T>l&&(y|=1<<a-1-A,u++,m+=T)}if(u===3){for(let A=0;A<a&&u>0;A++){let T=r[A];if(T>l&&(u--,T*2>=m))return-1}return y}}while(u>3);return-1}static patternToChar(r){for(let a=0;a<kt.CHARACTER_ENCODINGS.length;a++)if(kt.CHARACTER_ENCODINGS[a]===r)return kt.ALPHABET_STRING.charAt(a);if(r===kt.ASTERISK_ENCODING)return"*";throw new ae}static decodeExtended(r){let a=r.length,l="";for(let u=0;u<a;u++){let f=r.charAt(u);if(f==="+"||f==="$"||f==="%"||f==="/"){let m=r.charAt(u+1),y="\0";switch(f){case"+":if(m>="A"&&m<="Z")y=String.fromCharCode(m.charCodeAt(0)+32);else throw new F;break;case"$":if(m>="A"&&m<="Z")y=String.fromCharCode(m.charCodeAt(0)-64);else throw new F;break;case"%":if(m>="A"&&m<="E")y=String.fromCharCode(m.charCodeAt(0)-38);else if(m>="F"&&m<="J")y=String.fromCharCode(m.charCodeAt(0)-11);else if(m>="K"&&m<="O")y=String.fromCharCode(m.charCodeAt(0)+16);else if(m>="P"&&m<="T")y=String.fromCharCode(m.charCodeAt(0)+43);else if(m==="U")y="\0";else if(m==="V")y="@";else if(m==="W")y="`";else if(m==="X"||m==="Y"||m==="Z")y="";else throw new F;break;case"/":if(m>="A"&&m<="O")y=String.fromCharCode(m.charCodeAt(0)-32);else if(m==="Z")y=":";else throw new F;break}l+=y,u++}else l+=f}return l}}kt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",kt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],kt.ASTERISK_ENCODING=148;class mt extends et{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,a,l){let u=this.decodeStart(a),f=this.decodeEnd(a),m=new H;mt.decodeMiddle(a,u[1],f[0],m);let y=m.toString(),A=null;l!=null&&(A=l.get(qe.ALLOWED_LENGTHS)),A==null&&(A=mt.DEFAULT_ALLOWED_LENGTHS);let T=y.length,I=!1,k=0;for(let Q of A){if(T===Q){I=!0;break}Q>k&&(k=Q)}if(!I&&T>k&&(I=!0),!I)throw new F;const L=[new Xe(u[1],r),new Xe(f[0],r)];return new Ve(y,null,0,L,we.ITF,new Date().getTime())}static decodeMiddle(r,a,l,u){let f=new Int32Array(10),m=new Int32Array(5),y=new Int32Array(5);for(f.fill(0),m.fill(0),y.fill(0);a<l;){et.recordPattern(r,a,f);for(let T=0;T<5;T++){let I=2*T;m[T]=f[I],y[T]=f[I+1]}let A=mt.decodeDigit(m);u.append(A.toString()),A=this.decodeDigit(y),u.append(A.toString()),f.forEach(function(T){a+=T})}}decodeStart(r){let a=mt.skipWhiteSpace(r),l=mt.findGuardPattern(r,a,mt.START_PATTERN);return this.narrowLineWidth=(l[1]-l[0])/4,this.validateQuietZone(r,l[0]),l}validateQuietZone(r,a){let l=this.narrowLineWidth*10;l=l<a?l:a;for(let u=a-1;l>0&&u>=0&&!r.get(u);u--)l--;if(l!==0)throw new ae}static skipWhiteSpace(r){const a=r.getSize(),l=r.getNextSet(0);if(l===a)throw new ae;return l}decodeEnd(r){r.reverse();try{let a=mt.skipWhiteSpace(r),l;try{l=mt.findGuardPattern(r,a,mt.END_PATTERN_REVERSED[0])}catch(f){f instanceof ae&&(l=mt.findGuardPattern(r,a,mt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,l[0]);let u=l[0];return l[0]=r.getSize()-l[1],l[1]=r.getSize()-u,l}finally{r.reverse()}}static findGuardPattern(r,a,l){let u=l.length,f=new Int32Array(u),m=r.getSize(),y=!1,A=0,T=a;f.fill(0);for(let I=a;I<m;I++)if(r.get(I)!==y)f[A]++;else{if(A===u-1){if(et.patternMatchVariance(f,l,mt.MAX_INDIVIDUAL_VARIANCE)<mt.MAX_AVG_VARIANCE)return[T,I];T+=f[0]+f[1],oe.arraycopy(f,2,f,0,A-1),f[A-1]=0,f[A]=0,A--}else A++;f[A]=1,y=!y}throw new ae}static decodeDigit(r){let a=mt.MAX_AVG_VARIANCE,l=-1,u=mt.PATTERNS.length;for(let f=0;f<u;f++){let m=mt.PATTERNS[f],y=et.patternMatchVariance(r,m,mt.MAX_INDIVIDUAL_VARIANCE);y<a?(a=y,l=f):y===a&&(l=-1)}if(l>=0)return l%10;throw new ae}}mt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],mt.MAX_AVG_VARIANCE=.38,mt.MAX_INDIVIDUAL_VARIANCE=.5,mt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],mt.START_PATTERN=Int32Array.from([1,1,1,1]),mt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Yt extends et{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let a=!1,l,u=0,f=Int32Array.from([0,0,0]);for(;!a;){f=Int32Array.from([0,0,0]),l=Yt.findGuardPattern(r,u,!1,this.START_END_PATTERN,f);let m=l[0];u=l[1];let y=m-(u-m);y>=0&&(a=r.isRange(y,m,!1))}return l}static checkChecksum(r){return Yt.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let a=r.length;if(a===0)return!1;let l=parseInt(r.charAt(a-1),10);return Yt.getStandardUPCEANChecksum(r.substring(0,a-1))===l}static getStandardUPCEANChecksum(r){let a=r.length,l=0;for(let u=a-1;u>=0;u-=2){let f=r.charAt(u).charCodeAt(0)-48;if(f<0||f>9)throw new F;l+=f}l*=3;for(let u=a-2;u>=0;u-=2){let f=r.charAt(u).charCodeAt(0)-48;if(f<0||f>9)throw new F;l+=f}return(1e3-l)%10}static decodeEnd(r,a){return Yt.findGuardPattern(r,a,!1,Yt.START_END_PATTERN,new Int32Array(Yt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,a,l,u){return this.findGuardPattern(r,a,l,u,new Int32Array(u.length))}static findGuardPattern(r,a,l,u,f){let m=r.getSize();a=l?r.getNextUnset(a):r.getNextSet(a);let y=0,A=a,T=u.length,I=l;for(let k=a;k<m;k++)if(r.get(k)!==I)f[y]++;else{if(y===T-1){if(et.patternMatchVariance(f,u,Yt.MAX_INDIVIDUAL_VARIANCE)<Yt.MAX_AVG_VARIANCE)return Int32Array.from([A,k]);A+=f[0]+f[1];let L=f.slice(2,f.length-1);for(let G=0;G<y-1;G++)f[G]=L[G];f[y-1]=0,f[y]=0,y--}else y++;f[y]=1,I=!I}throw new ae}static decodeDigit(r,a,l,u){this.recordPattern(r,l,a);let f=this.MAX_AVG_VARIANCE,m=-1,y=u.length;for(let A=0;A<y;A++){let T=u[A],I=et.patternMatchVariance(a,T,Yt.MAX_INDIVIDUAL_VARIANCE);I<f&&(f=I,m=A)}if(m>=0)return m;throw new ae}}Yt.MAX_AVG_VARIANCE=.48,Yt.MAX_INDIVIDUAL_VARIANCE=.7,Yt.START_END_PATTERN=Int32Array.from([1,1,1]),Yt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Yt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Xn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,a,l){let u=this.decodeRowStringBuffer,f=this.decodeMiddle(a,l,u),m=u.toString(),y=Xn.parseExtensionString(m),A=[new Xe((l[0]+l[1])/2,r),new Xe(f,r)],T=new Ve(m,null,0,A,we.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&T.putAllMetadata(y),T}decodeMiddle(r,a,l){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let f=r.getSize(),m=a[1],y=0;for(let T=0;T<5&&m<f;T++){let I=Yt.decodeDigit(r,u,m,Yt.L_AND_G_PATTERNS);l+=String.fromCharCode(48+I%10);for(let k of u)m+=k;I>=10&&(y|=1<<4-T),T!==4&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(l.length!==5)throw new ae;let A=this.determineCheckDigit(y);if(Xn.extensionChecksum(l.toString())!==A)throw new ae;return m}static extensionChecksum(r){let a=r.length,l=0;for(let u=a-2;u>=0;u-=2)l+=r.charAt(u).charCodeAt(0)-48;l*=3;for(let u=a-1;u>=0;u-=2)l+=r.charAt(u).charCodeAt(0)-48;return l*=3,l%10}determineCheckDigit(r){for(let a=0;a<10;a++)if(r===this.CHECK_DIGIT_ENCODINGS[a])return a;throw new ae}static parseExtensionString(r){if(r.length!==5)return null;let a=Xn.parseExtension5String(r);return a==null?null:new Map([[xt.SUGGESTED_PRICE,a]])}static parseExtension5String(r){let a;switch(r.charAt(0)){case"0":a="";break;case"5":a="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}a="";break;default:a="";break}let l=parseInt(r.substring(1)),u=(l/100).toString(),f=l%100,m=f<10?"0"+f:f.toString();return a+u+"."+m}}class ri{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,a,l){let u=this.decodeRowStringBuffer,f=this.decodeMiddle(a,l,u),m=u.toString(),y=ri.parseExtensionString(m),A=[new Xe((l[0]+l[1])/2,r),new Xe(f,r)],T=new Ve(m,null,0,A,we.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&T.putAllMetadata(y),T}decodeMiddle(r,a,l){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let f=r.getSize(),m=a[1],y=0;for(let A=0;A<2&&m<f;A++){let T=Yt.decodeDigit(r,u,m,Yt.L_AND_G_PATTERNS);l+=String.fromCharCode(48+T%10);for(let I of u)m+=I;T>=10&&(y|=1<<1-A),A!==1&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(l.length!==2)throw new ae;if(parseInt(l.toString())%4!==y)throw new ae;return m}static parseExtensionString(r){return r.length!==2?null:new Map([[xt.ISSUE_NUMBER,parseInt(r)]])}}class Er{static decodeRow(r,a,l){let u=Yt.findGuardPattern(a,l,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Xn().decodeRow(r,a,u)}catch{return new ri().decodeRow(r,a,u)}}}Er.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Bt extends Yt{constructor(){super(),this.decodeRowStringBuffer="",Bt.L_AND_G_PATTERNS=Bt.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let a=Bt.L_PATTERNS[r-10],l=new Int32Array(a.length);for(let u=0;u<a.length;u++)l[u]=a[a.length-u-1];Bt.L_AND_G_PATTERNS[r]=l}}decodeRow(r,a,l){let u=Bt.findStartGuardPattern(a),f=l==null?null:l.get(qe.NEED_RESULT_POINT_CALLBACK);if(f!=null){const Me=new Xe((u[0]+u[1])/2,r);f.foundPossibleResultPoint(Me)}let m=this.decodeMiddle(a,u,this.decodeRowStringBuffer),y=m.rowOffset,A=m.resultString;if(f!=null){const Me=new Xe(y,r);f.foundPossibleResultPoint(Me)}let T=this.decodeEnd(a,y);if(f!=null){const Me=new Xe((T[0]+T[1])/2,r);f.foundPossibleResultPoint(Me)}let I=T[1],k=I+(I-T[0]);if(k>=a.getSize()||!a.isRange(I,k,!1))throw new ae;let L=A.toString();if(L.length<8)throw new F;if(!Bt.checkChecksum(L))throw new X;let G=(u[1]+u[0])/2,Q=(T[1]+T[0])/2,J=this.getBarcodeFormat(),se=[new Xe(G,r),new Xe(Q,r)],ye=new Ve(L,null,0,se,J,new Date().getTime()),Ue=0;try{let Me=Er.decodeRow(r,a,T[1]);ye.putMetadata(xt.UPC_EAN_EXTENSION,Me.getText()),ye.putAllMetadata(Me.getResultMetadata()),ye.addResultPoints(Me.getResultPoints()),Ue=Me.getText().length}catch{}let Be=l==null?null:l.get(qe.ALLOWED_EAN_EXTENSIONS);if(Be!=null){let Me=!1;for(let Zt in Be)if(Ue.toString()===Zt){Me=!0;break}if(!Me)throw new ae}return ye}decodeEnd(r,a){return Bt.findGuardPattern(r,a,!1,Bt.START_END_PATTERN,new Int32Array(Bt.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return Bt.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let a=r.length;if(a===0)return!1;let l=parseInt(r.charAt(a-1),10);return Bt.getStandardUPCEANChecksum(r.substring(0,a-1))===l}static getStandardUPCEANChecksum(r){let a=r.length,l=0;for(let u=a-1;u>=0;u-=2){let f=r.charAt(u).charCodeAt(0)-48;if(f<0||f>9)throw new F;l+=f}l*=3;for(let u=a-2;u>=0;u-=2){let f=r.charAt(u).charCodeAt(0)-48;if(f<0||f>9)throw new F;l+=f}return(1e3-l)%10}}class An extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,a,l){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let f=r.getSize(),m=a[1],y=0;for(let T=0;T<6&&m<f;T++){let I=Bt.decodeDigit(r,u,m,Bt.L_AND_G_PATTERNS);l+=String.fromCharCode(48+I%10);for(let k of u)m+=k;I>=10&&(y|=1<<5-T)}l=An.determineFirstDigit(l,y),m=Bt.findGuardPattern(r,m,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let T=0;T<6&&m<f;T++){let I=Bt.decodeDigit(r,u,m,Bt.L_PATTERNS);l+=String.fromCharCode(48+I);for(let k of u)m+=k}return{rowOffset:m,resultString:l}}getBarcodeFormat(){return we.EAN_13}static determineFirstDigit(r,a){for(let l=0;l<10;l++)if(a===this.FIRST_DIGIT_ENCODINGS[l])return r=String.fromCharCode(48+l)+r,r;throw new ae}}An.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class mi extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,a,l){const u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let f=r.getSize(),m=a[1];for(let A=0;A<4&&m<f;A++){let T=Bt.decodeDigit(r,u,m,Bt.L_PATTERNS);l+=String.fromCharCode(48+T);for(let I of u)m+=I}m=Bt.findGuardPattern(r,m,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let A=0;A<4&&m<f;A++){let T=Bt.decodeDigit(r,u,m,Bt.L_PATTERNS);l+=String.fromCharCode(48+T);for(let I of u)m+=I}return{rowOffset:m,resultString:l}}getBarcodeFormat(){return we.EAN_8}}class Gr extends Bt{constructor(){super(...arguments),this.ean13Reader=new An}getBarcodeFormat(){return we.UPC_A}decode(r,a){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,a,l){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,a,l))}decodeMiddle(r,a,l){return this.ean13Reader.decodeMiddle(r,a,l)}maybeReturnResult(r){let a=r.getText();if(a.charAt(0)==="0"){let l=new Ve(a.substring(1),null,null,r.getResultPoints(),we.UPC_A);return r.getResultMetadata()!=null&&l.putAllMetadata(r.getResultMetadata()),l}else throw new ae}reset(){this.ean13Reader.reset()}}class Yn extends Bt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,a,l){const u=this.decodeMiddleCounters.map(T=>T);u[0]=0,u[1]=0,u[2]=0,u[3]=0;const f=r.getSize();let m=a[1],y=0;for(let T=0;T<6&&m<f;T++){const I=Yn.decodeDigit(r,u,m,Yn.L_AND_G_PATTERNS);l+=String.fromCharCode(48+I%10);for(let k of u)m+=k;I>=10&&(y|=1<<5-T)}let A=Yn.determineNumSysAndCheckDigit(l,y);return{rowOffset:m,resultString:A}}decodeEnd(r,a){return Yn.findGuardPatternWithoutCounters(r,a,!0,Yn.MIDDLE_END_PATTERN)}checkChecksum(r){return Bt.checkChecksum(Yn.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,a){for(let l=0;l<=1;l++)for(let u=0;u<10;u++)if(a===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[l][u]){let f=String.fromCharCode(48+l),m=String.fromCharCode(48+u);return f+r+m}throw ae.getNotFoundInstance()}getBarcodeFormat(){return we.UPC_E}static convertUPCEtoUPCA(r){const a=r.slice(1,7).split("").map(f=>f.charCodeAt(0)),l=new H;l.append(r.charAt(0));let u=a[5];switch(u){case 0:case 1:case 2:l.appendChars(a,0,2),l.append(u),l.append("0000"),l.appendChars(a,2,3);break;case 3:l.appendChars(a,0,3),l.append("00000"),l.appendChars(a,3,2);break;case 4:l.appendChars(a,0,4),l.append("00000"),l.append(a[4]);break;default:l.appendChars(a,0,5),l.append("0000"),l.append(u);break}return r.length>=8&&l.append(r.charAt(7)),l.toString()}}Yn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Js extends et{constructor(r){super();let a=r==null?null:r.get(qe.POSSIBLE_FORMATS),l=[];o(a)?(l.push(new An),l.push(new Gr),l.push(new mi),l.push(new Yn)):(a.indexOf(we.EAN_13)>-1&&l.push(new An),a.indexOf(we.UPC_A)>-1&&l.push(new Gr),a.indexOf(we.EAN_8)>-1&&l.push(new mi),a.indexOf(we.UPC_E)>-1&&l.push(new Yn)),this.readers=l}decodeRow(r,a,l){for(let u of this.readers)try{const f=u.decodeRow(r,a,l),m=f.getBarcodeFormat()===we.EAN_13&&f.getText().charAt(0)==="0",y=l==null?null:l.get(qe.POSSIBLE_FORMATS),A=y==null||y.includes(we.UPC_A);if(m&&A){const T=f.getRawBytes(),I=new Ve(f.getText().substring(1),T,T?T.length:null,f.getResultPoints(),we.UPC_A);return I.putAllMetadata(f.getResultMetadata()),I}return f}catch{}throw new ae}reset(){for(let r of this.readers)r.reset()}}class ar extends et{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,a){for(let l=0;l<a.length;l++)if(et.patternMatchVariance(r,a[l],ar.MAX_INDIVIDUAL_VARIANCE)<ar.MAX_AVG_VARIANCE)return l;throw new ae}static count(r){return Qe.sum(new Int32Array(r))}static increment(r,a){let l=0,u=a[0];for(let f=1;f<r.length;f++)a[f]>u&&(u=a[f],l=f);r[l]++}static decrement(r,a){let l=0,u=a[0];for(let f=1;f<r.length;f++)a[f]<u&&(u=a[f],l=f);r[l]--}static isFinderPattern(r){let a=r[0]+r[1],l=a+r[2]+r[3],u=a/l;if(u>=ar.MIN_FINDER_PATTERN_RATIO&&u<=ar.MAX_FINDER_PATTERN_RATIO){let f=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER;for(let y of r)y>m&&(m=y),y<f&&(f=y);return m<10*f}return!1}}ar.MAX_AVG_VARIANCE=.2,ar.MAX_INDIVIDUAL_VARIANCE=.45,ar.MIN_FINDER_PATTERN_RATIO=9.5/12,ar.MAX_FINDER_PATTERN_RATIO=12.5/14;class Mr{constructor(r,a){this.value=r,this.checksumPortion=a}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof Mr))return!1;const a=r;return this.value===a.value&&this.checksumPortion===a.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class vi{constructor(r,a,l,u,f){this.value=r,this.startEnd=a,this.value=r,this.startEnd=a,this.resultPoints=new Array,this.resultPoints.push(new Xe(l,f)),this.resultPoints.push(new Xe(u,f))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof vi))return!1;const a=r;return this.value===a.value}hashCode(){return this.value}}class ii{constructor(){}static getRSSvalue(r,a,l){let u=0;for(let A of r)u+=A;let f=0,m=0,y=r.length;for(let A=0;A<y-1;A++){let T;for(T=1,m|=1<<A;T<r[A];T++,m&=~(1<<A)){let I=ii.combins(u-T-1,y-A-2);if(l&&m===0&&u-T-(y-A-1)>=y-A-1&&(I-=ii.combins(u-T-(y-A),y-A-2)),y-A-1>1){let k=0;for(let L=u-T-(y-A-2);L>a;L--)k+=ii.combins(u-T-L-1,y-A-3);I-=k*(y-1-A)}else u-T>a&&I--;f+=I}u-=T}return f}static combins(r,a){let l,u;r-a>a?(u=a,l=r-a):(u=r-a,l=a);let f=1,m=1;for(let y=r;y>l;y--)f*=y,m<=u&&(f/=m,m++);for(;m<=u;)f/=m,m++;return f}}class ys{static buildBitArray(r){let a=r.length*2-1;r[r.length-1].getRightChar()==null&&(a-=1);let l=12*a,u=new Pe(l),f=0,y=r[0].getRightChar().getValue();for(let A=11;A>=0;--A)(y&1<<A)!=0&&u.set(f),f++;for(let A=1;A<r.length;++A){let T=r[A],I=T.getLeftChar().getValue();for(let k=11;k>=0;--k)(I&1<<k)!=0&&u.set(f),f++;if(T.getRightChar()!=null){let k=T.getRightChar().getValue();for(let L=11;L>=0;--L)(k&1<<L)!=0&&u.set(f),f++}}return u}}class pi{constructor(r,a){a?this.decodedInformation=null:(this.finished=r,this.decodedInformation=a)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Es{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class $n extends Es{constructor(r,a){super(r),this.value=a}getValue(){return this.value}isFNC1(){return this.value===$n.FNC1}}$n.FNC1="$";class kr extends Es{constructor(r,a,l){super(r),l?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=a}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Lr extends Es{constructor(r,a,l){if(super(r),a<0||a>10||l<0||l>10)throw new F;this.firstDigit=a,this.secondDigit=l}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Lr.FNC1}isSecondDigitFNC1(){return this.secondDigit===Lr.FNC1}isAnyFNC1(){return this.firstDigit===Lr.FNC1||this.secondDigit===Lr.FNC1}}Lr.FNC1=10;class We{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new ae;let a=r.substring(0,2);for(let f of We.TWO_DIGIT_DATA_LENGTH)if(f[0]===a)return f[1]===We.VARIABLE_LENGTH?We.processVariableAI(2,f[2],r):We.processFixedAI(2,f[1],r);if(r.length<3)throw new ae;let l=r.substring(0,3);for(let f of We.THREE_DIGIT_DATA_LENGTH)if(f[0]===l)return f[1]===We.VARIABLE_LENGTH?We.processVariableAI(3,f[2],r):We.processFixedAI(3,f[1],r);for(let f of We.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(f[0]===l)return f[1]===We.VARIABLE_LENGTH?We.processVariableAI(4,f[2],r):We.processFixedAI(4,f[1],r);if(r.length<4)throw new ae;let u=r.substring(0,4);for(let f of We.FOUR_DIGIT_DATA_LENGTH)if(f[0]===u)return f[1]===We.VARIABLE_LENGTH?We.processVariableAI(4,f[2],r):We.processFixedAI(4,f[1],r);throw new ae}static processFixedAI(r,a,l){if(l.length<r)throw new ae;let u=l.substring(0,r);if(l.length<r+a)throw new ae;let f=l.substring(r,r+a),m=l.substring(r+a),y="("+u+")"+f,A=We.parseFieldsInGeneralPurpose(m);return A==null?y:y+A}static processVariableAI(r,a,l){let u=l.substring(0,r),f;l.length<r+a?f=l.length:f=r+a;let m=l.substring(r,f),y=l.substring(f),A="("+u+")"+m,T=We.parseFieldsInGeneralPurpose(y);return T==null?A:A+T}}We.VARIABLE_LENGTH=[],We.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",We.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",We.VARIABLE_LENGTH,20],["22",We.VARIABLE_LENGTH,29],["30",We.VARIABLE_LENGTH,8],["37",We.VARIABLE_LENGTH,8],["90",We.VARIABLE_LENGTH,30],["91",We.VARIABLE_LENGTH,30],["92",We.VARIABLE_LENGTH,30],["93",We.VARIABLE_LENGTH,30],["94",We.VARIABLE_LENGTH,30],["95",We.VARIABLE_LENGTH,30],["96",We.VARIABLE_LENGTH,30],["97",We.VARIABLE_LENGTH,3],["98",We.VARIABLE_LENGTH,30],["99",We.VARIABLE_LENGTH,30]],We.THREE_DIGIT_DATA_LENGTH=[["240",We.VARIABLE_LENGTH,30],["241",We.VARIABLE_LENGTH,30],["242",We.VARIABLE_LENGTH,6],["250",We.VARIABLE_LENGTH,30],["251",We.VARIABLE_LENGTH,30],["253",We.VARIABLE_LENGTH,17],["254",We.VARIABLE_LENGTH,20],["400",We.VARIABLE_LENGTH,30],["401",We.VARIABLE_LENGTH,30],["402",17],["403",We.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",We.VARIABLE_LENGTH,20],["421",We.VARIABLE_LENGTH,15],["422",3],["423",We.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],We.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",We.VARIABLE_LENGTH,15],["391",We.VARIABLE_LENGTH,18],["392",We.VARIABLE_LENGTH,15],["393",We.VARIABLE_LENGTH,18],["703",We.VARIABLE_LENGTH,30]],We.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",We.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",We.VARIABLE_LENGTH,20],["8003",We.VARIABLE_LENGTH,30],["8004",We.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",We.VARIABLE_LENGTH,30],["8008",We.VARIABLE_LENGTH,12],["8018",18],["8020",We.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",We.VARIABLE_LENGTH,70],["8200",We.VARIABLE_LENGTH,70]];class Tr{constructor(r){this.buffer=new H,this.information=r}decodeAllCodes(r,a){let l=a,u=null;do{let f=this.decodeGeneralPurposeField(l,u),m=We.parseFieldsInGeneralPurpose(f.getNewString());if(m!=null&&r.append(m),f.isRemaining()?u=""+f.getRemainingValue():u=null,l===f.getNewPosition())break;l=f.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let a=r;a<r+3;++a)if(this.information.get(a))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let f=this.extractNumericValueFromBitArray(r,4);return f===0?new Lr(this.information.getSize(),Lr.FNC1,Lr.FNC1):new Lr(this.information.getSize(),f-1,Lr.FNC1)}let a=this.extractNumericValueFromBitArray(r,7),l=(a-8)/11,u=(a-8)%11;return new Lr(r+7,l,u)}extractNumericValueFromBitArray(r,a){return Tr.extractNumericValueFromBitArray(this.information,r,a)}static extractNumericValueFromBitArray(r,a,l){let u=0;for(let f=0;f<l;++f)r.get(a+f)&&(u|=1<<l-f-1);return u}decodeGeneralPurposeField(r,a){this.buffer.setLengthToZero(),a!=null&&this.buffer.append(a),this.current.setPosition(r);let l=this.parseBlocks();return l!=null&&l.isRemaining()?new kr(this.current.getPosition(),this.buffer.toString(),l.getRemainingValue()):new kr(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,a;do{let l=this.current.getPosition();if(this.current.isAlpha()?(a=this.parseAlphaBlock(),r=a.isFinished()):this.current.isIsoIec646()?(a=this.parseIsoIec646Block(),r=a.isFinished()):(a=this.parseNumericBlock(),r=a.isFinished()),!(l!==this.current.getPosition())&&!r)break}while(!r);return a.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let a;return r.isSecondDigitFNC1()?a=new kr(this.current.getPosition(),this.buffer.toString()):a=new kr(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new pi(!0,a)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let a=new kr(this.current.getPosition(),this.buffer.toString());return new pi(!0,a)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new pi(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let a=new kr(this.current.getPosition(),this.buffer.toString());return new pi(!0,a)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new pi(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let a=new kr(this.current.getPosition(),this.buffer.toString());return new pi(!0,a)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new pi(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,5);if(a>=5&&a<16)return!0;if(r+7>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,7);if(l>=64&&l<116)return!0;if(r+8>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,8);return u>=232&&u<253}decodeIsoIec646(r){let a=this.extractNumericValueFromBitArray(r,5);if(a===15)return new $n(r+5,$n.FNC1);if(a>=5&&a<15)return new $n(r+5,"0"+(a-5));let l=this.extractNumericValueFromBitArray(r,7);if(l>=64&&l<90)return new $n(r+7,""+(l+1));if(l>=90&&l<116)return new $n(r+7,""+(l+7));let u=this.extractNumericValueFromBitArray(r,8),f;switch(u){case 232:f="!";break;case 233:f='"';break;case 234:f="%";break;case 235:f="&";break;case 236:f="'";break;case 237:f="(";break;case 238:f=")";break;case 239:f="*";break;case 240:f="+";break;case 241:f=",";break;case 242:f="-";break;case 243:f=".";break;case 244:f="/";break;case 245:f=":";break;case 246:f=";";break;case 247:f="<";break;case 248:f="=";break;case 249:f=">";break;case 250:f="?";break;case 251:f="_";break;case 252:f=" ";break;default:throw new F}return new $n(r+8,f)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,5);if(a>=5&&a<16)return!0;if(r+6>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,6);return l>=16&&l<63}decodeAlphanumeric(r){let a=this.extractNumericValueFromBitArray(r,5);if(a===15)return new $n(r+5,$n.FNC1);if(a>=5&&a<15)return new $n(r+5,"0"+(a-5));let l=this.extractNumericValueFromBitArray(r,6);if(l>=32&&l<58)return new $n(r+6,""+(l+33));let u;switch(l){case 58:u="*";break;case 59:u=",";break;case 60:u="-";break;case 61:u=".";break;case 62:u="/";break;default:throw new yt("Decoding invalid alphanumeric value: "+l)}return new $n(r+6,u)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let a=0;a<5&&a+r<this.information.getSize();++a)if(a===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+a))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let a=r;a<r+3;++a)if(this.information.get(a))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let a=0;a<4&&a+r<this.information.getSize();++a)if(this.information.get(r+a))return!1;return!0}}class Hn{constructor(r){this.information=r,this.generalDecoder=new Tr(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class gn extends Hn{constructor(r){super(r)}encodeCompressedGtin(r,a){r.append("(01)");let l=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,a,l)}encodeCompressedGtinWithoutAI(r,a,l){for(let u=0;u<4;++u){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(a+10*u,10);f/100===0&&r.append("0"),f/10===0&&r.append("0"),r.append(f)}gn.appendCheckDigit(r,l)}static appendCheckDigit(r,a){let l=0;for(let u=0;u<13;u++){let f=r.charAt(u+a).charCodeAt(0)-48;l+=(u&1)===0?3*f:f}l=10-l%10,l===10&&(l=0),r.append(l)}}gn.GTIN_SIZE=40;class ee extends gn{constructor(r){super(r)}parseInformation(){let r=new H;r.append("(01)");let a=r.length(),l=this.getGeneralDecoder().extractNumericValueFromBitArray(ee.HEADER_SIZE,4);return r.append(l),this.encodeCompressedGtinWithoutAI(r,ee.HEADER_SIZE+4,a),this.getGeneralDecoder().decodeAllCodes(r,ee.HEADER_SIZE+44)}}ee.HEADER_SIZE=4;class je extends Hn{constructor(r){super(r)}parseInformation(){let r=new H;return this.getGeneralDecoder().decodeAllCodes(r,je.HEADER_SIZE)}}je.HEADER_SIZE=5;class tt extends gn{constructor(r){super(r)}encodeCompressedWeight(r,a,l){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(a,l);this.addWeightCode(r,u);let f=this.checkWeight(u),m=1e5;for(let y=0;y<5;++y)f/m===0&&r.append("0"),m/=10;r.append(f)}}class Ke extends tt{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=Ke.HEADER_SIZE+tt.GTIN_SIZE+Ke.WEIGHT_SIZE)throw new ae;let r=new H;return this.encodeCompressedGtin(r,Ke.HEADER_SIZE),this.encodeCompressedWeight(r,Ke.HEADER_SIZE+tt.GTIN_SIZE,Ke.WEIGHT_SIZE),r.toString()}}Ke.HEADER_SIZE=5,Ke.WEIGHT_SIZE=15;class Vt extends Ke{constructor(r){super(r)}addWeightCode(r,a){r.append("(3103)")}checkWeight(r){return r}}class Gt extends Ke{constructor(r){super(r)}addWeightCode(r,a){a<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class Ln extends gn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Ln.HEADER_SIZE+gn.GTIN_SIZE)throw new ae;let r=new H;this.encodeCompressedGtin(r,Ln.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Ln.HEADER_SIZE+gn.GTIN_SIZE,Ln.LAST_DIGIT_SIZE);r.append("(392"),r.append(a),r.append(")");let l=this.getGeneralDecoder().decodeGeneralPurposeField(Ln.HEADER_SIZE+gn.GTIN_SIZE+Ln.LAST_DIGIT_SIZE,null);return r.append(l.getNewString()),r.toString()}}Ln.HEADER_SIZE=8,Ln.LAST_DIGIT_SIZE=2;class yn extends gn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<yn.HEADER_SIZE+gn.GTIN_SIZE)throw new ae;let r=new H;this.encodeCompressedGtin(r,yn.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(yn.HEADER_SIZE+gn.GTIN_SIZE,yn.LAST_DIGIT_SIZE);r.append("(393"),r.append(a),r.append(")");let l=this.getGeneralDecoder().extractNumericValueFromBitArray(yn.HEADER_SIZE+gn.GTIN_SIZE+yn.LAST_DIGIT_SIZE,yn.FIRST_THREE_DIGITS_SIZE);l/100==0&&r.append("0"),l/10==0&&r.append("0"),r.append(l);let u=this.getGeneralDecoder().decodeGeneralPurposeField(yn.HEADER_SIZE+gn.GTIN_SIZE+yn.LAST_DIGIT_SIZE+yn.FIRST_THREE_DIGITS_SIZE,null);return r.append(u.getNewString()),r.toString()}}yn.HEADER_SIZE=8,yn.LAST_DIGIT_SIZE=2,yn.FIRST_THREE_DIGITS_SIZE=10;class Lt extends tt{constructor(r,a,l){super(r),this.dateCode=l,this.firstAIdigits=a}parseInformation(){if(this.getInformation().getSize()!=Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE+Lt.DATE_SIZE)throw new ae;let r=new H;return this.encodeCompressedGtin(r,Lt.HEADER_SIZE),this.encodeCompressedWeight(r,Lt.HEADER_SIZE+Lt.GTIN_SIZE,Lt.WEIGHT_SIZE),this.encodeCompressedDate(r,Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,a){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(a,Lt.DATE_SIZE);if(l==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let u=l%32;l/=32;let f=l%12+1;l/=12;let m=l;m/10==0&&r.append("0"),r.append(m),f/10==0&&r.append("0"),r.append(f),u/10==0&&r.append("0"),r.append(u)}addWeightCode(r,a){r.append("("),r.append(this.firstAIdigits),r.append(a/1e5),r.append(")")}checkWeight(r){return r%1e5}}Lt.HEADER_SIZE=8,Lt.WEIGHT_SIZE=20,Lt.DATE_SIZE=16;function hr(M){try{if(M.get(1))return new ee(M);if(!M.get(2))return new je(M);switch(Tr.extractNumericValueFromBitArray(M,1,4)){case 4:return new Vt(M);case 5:return new Gt(M)}switch(Tr.extractNumericValueFromBitArray(M,1,5)){case 12:return new Ln(M);case 13:return new yn(M)}switch(Tr.extractNumericValueFromBitArray(M,1,7)){case 56:return new Lt(M,"310","11");case 57:return new Lt(M,"320","11");case 58:return new Lt(M,"310","13");case 59:return new Lt(M,"320","13");case 60:return new Lt(M,"310","15");case 61:return new Lt(M,"320","15");case 62:return new Lt(M,"310","17");case 63:return new Lt(M,"320","17")}}catch(r){throw console.log(r),new yt("unknown decoder: "+M)}}class Wn{constructor(r,a,l,u){this.leftchar=r,this.rightchar=a,this.finderpattern=l,this.maybeLast=u}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,a){return r instanceof Wn?Wn.equalsOrNull(r.leftchar,a.leftchar)&&Wn.equalsOrNull(r.rightchar,a.rightchar)&&Wn.equalsOrNull(r.finderpattern,a.finderpattern):!1}static equalsOrNull(r,a){return r===null?a===null:Wn.equals(r,a)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class er{constructor(r,a,l){this.pairs=r,this.rowNumber=a,this.wasReversed=l}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,a){return r instanceof er?this.checkEqualitity(r,a)&&r.wasReversed===a.wasReversed:!1}checkEqualitity(r,a){if(!r||!a)return;let l;return r.forEach((u,f)=>{a.forEach(m=>{u.getLeftChar().getValue()===m.getLeftChar().getValue()&&u.getRightChar().getValue()===m.getRightChar().getValue()&&u.getFinderPatter().getValue()===m.getFinderPatter().getValue()&&(l=!0)})}),l}}class Ne extends ar{constructor(r){super(...arguments),this.pairs=new Array(Ne.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,a,l){this.pairs.length=0,this.startFromEven=!1;try{return Ne.constructResult(this.decodeRow2pairs(r,a))}catch(u){this.verbose&&console.log(u)}return this.pairs.length=0,this.startFromEven=!0,Ne.constructResult(this.decodeRow2pairs(r,a))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,a){let l=!1;for(;!l;)try{this.pairs.push(this.retrieveNextPair(a,this.pairs,r))}catch(f){if(f instanceof ae){if(!this.pairs.length)throw new ae;l=!0}}if(this.checkChecksum())return this.pairs;let u;if(this.rows.length?u=!0:u=!1,this.storeRow(r,!1),u){let f=this.checkRowsBoolean(!1);if(f!=null||(f=this.checkRowsBoolean(!0),f!=null))return f}throw new ae}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let a=null;try{a=this.checkRows(new Array,0)}catch(l){this.verbose&&console.log(l)}return r&&(this.rows=this.rows.reverse()),a}checkRows(r,a){for(let l=a;l<this.rows.length;l++){let u=this.rows[l];this.pairs.length=0;for(let m of r)this.pairs.push(m.getPairs());if(this.pairs.push(u.getPairs()),!Ne.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let f=new Array(r);f.push(u);try{return this.checkRows(f,l+1)}catch(m){this.verbose&&console.log(m)}}throw new ae}static isValidSequence(r){for(let a of Ne.FINDER_PATTERN_SEQUENCES){if(r.length>a.length)continue;let l=!0;for(let u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!=a[u]){l=!1;break}if(l)return!0}return!1}storeRow(r,a){let l=0,u=!1,f=!1;for(;l<this.rows.length;){let m=this.rows[l];if(m.getRowNumber()>r){f=m.isEquivalent(this.pairs);break}u=m.isEquivalent(this.pairs),l++}f||u||Ne.isPartialRow(this.pairs,this.rows)||(this.rows.push(l,new er(this.pairs,r,a)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,a){for(let l of a)if(l.getPairs().length!==r.length){for(let u of l.getPairs())for(let f of r)if(Wn.equals(u,f))break}}static isPartialRow(r,a){for(let l of a){let u=!0;for(let f of r){let m=!1;for(let y of l.getPairs())if(f.equals(y)){m=!0;break}if(!m){u=!1;break}}if(u)return!0}return!1}getRows(){return this.rows}static constructResult(r){let a=ys.buildBitArray(r),u=hr(a).parseInformation(),f=r[0].getFinderPattern().getResultPoints(),m=r[r.length-1].getFinderPattern().getResultPoints(),y=[f[0],f[1],m[0],m[1]];return new Ve(u,null,null,y,we.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),a=r.getLeftChar(),l=r.getRightChar();if(l==null)return!1;let u=l.getChecksumPortion(),f=2;for(let y=1;y<this.pairs.size();++y){let A=this.pairs.get(y);u+=A.getLeftChar().getChecksumPortion(),f++;let T=A.getRightChar();T!=null&&(u+=T.getChecksumPortion(),f++)}return u%=211,211*(f-4)+u==a.getValue()}static getNextSecondBar(r,a){let l;return r.get(a)?(l=r.getNextUnset(a),l=r.getNextSet(l)):(l=r.getNextSet(a),l=r.getNextUnset(l)),l}retrieveNextPair(r,a,l){let u=a.length%2==0;this.startFromEven&&(u=!u);let f,m=!0,y=-1;do this.findNextPair(r,a,y),f=this.parseFoundFinderPattern(r,l,u),f==null?y=Ne.getNextSecondBar(r,this.startEnd[0]):m=!1;while(m);let A=this.decodeDataCharacter(r,f,u,!0);if(!this.isEmptyPair(a)&&a[a.length-1].mustBeLast())throw new ae;let T;try{T=this.decodeDataCharacter(r,f,u,!1)}catch(I){T=null,this.verbose&&console.log(I)}return new Wn(A,T,f,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,a,l){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let f=r.getSize(),m;l>=0?m=l:this.isEmptyPair(a)?m=0:m=a[a.length-1].getFinderPattern().getStartEnd()[1];let y=a.length%2!=0;this.startFromEven&&(y=!y);let A=!1;for(;m<f&&(A=!r.get(m),!!A);)m++;let T=0,I=m;for(let k=m;k<f;k++)if(r.get(k)!=A)u[T]++;else{if(T==3){if(y&&Ne.reverseCounters(u),Ne.isFinderPattern(u)){this.startEnd[0]=I,this.startEnd[1]=k;return}y&&Ne.reverseCounters(u),I+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,T--}else T++;u[T]=1,A=!A}throw new ae}static reverseCounters(r){let a=r.length;for(let l=0;l<a/2;++l){let u=r[l];r[l]=r[a-l-1],r[a-l-1]=u}}parseFoundFinderPattern(r,a,l){let u,f,m;if(l){let T=this.startEnd[0]-1;for(;T>=0&&!r.get(T);)T--;T++,u=this.startEnd[0]-T,f=T,m=this.startEnd[1]}else f=this.startEnd[0],m=r.getNextUnset(this.startEnd[1]+1),u=m-this.startEnd[1];let y=this.getDecodeFinderCounters();oe.arraycopy(y,0,y,1,y.length-1),y[0]=u;let A;try{A=this.parseFinderValue(y,Ne.FINDER_PATTERNS)}catch{return null}return new vi(A,[f,m],f,m,a)}decodeDataCharacter(r,a,l,u){let f=this.getDataCharacterCounters();for(let In=0;In<f.length;In++)f[In]=0;if(u)Ne.recordPatternInReverse(r,a.getStartEnd()[0],f);else{Ne.recordPattern(r,a.getStartEnd()[1],f);for(let In=0,Pr=f.length-1;In<Pr;In++,Pr--){let Ai=f[In];f[In]=f[Pr],f[Pr]=Ai}}let m=17,y=Qe.sum(new Int32Array(f))/m,A=(a.getStartEnd()[1]-a.getStartEnd()[0])/15;if(Math.abs(y-A)/A>.3)throw new ae;let T=this.getOddCounts(),I=this.getEvenCounts(),k=this.getOddRoundingErrors(),L=this.getEvenRoundingErrors();for(let In=0;In<f.length;In++){let Pr=1*f[In]/y,Ai=Pr+.5;if(Ai<1){if(Pr<.3)throw new ae;Ai=1}else if(Ai>8){if(Pr>8.7)throw new ae;Ai=8}let za=In/2;(In&1)==0?(T[za]=Ai,k[za]=Pr-Ai):(I[za]=Ai,L[za]=Pr-Ai)}this.adjustOddEvenCounts(m);let G=4*a.getValue()+(l?0:2)+(u?0:1)-1,Q=0,J=0;for(let In=T.length-1;In>=0;In--){if(Ne.isNotA1left(a,l,u)){let Pr=Ne.WEIGHTS[G][2*In];J+=T[In]*Pr}Q+=T[In]}let se=0;for(let In=I.length-1;In>=0;In--)if(Ne.isNotA1left(a,l,u)){let Pr=Ne.WEIGHTS[G][2*In+1];se+=I[In]*Pr}let ye=J+se;if((Q&1)!=0||Q>13||Q<4)throw new ae;let Ue=(13-Q)/2,Be=Ne.SYMBOL_WIDEST[Ue],Me=9-Be,Zt=ii.getRSSvalue(T,Be,!0),Ut=ii.getRSSvalue(I,Me,!1),fr=Ne.EVEN_TOTAL_SUBSET[Ue],Ni=Ne.GSUM[Ue],Wr=Zt*fr+Ut+Ni;return new Mr(Wr,ye)}static isNotA1left(r,a,l){return!(r.getValue()==0&&a&&l)}adjustOddEvenCounts(r){let a=Qe.sum(new Int32Array(this.getOddCounts())),l=Qe.sum(new Int32Array(this.getEvenCounts())),u=!1,f=!1;a>13?f=!0:a<4&&(u=!0);let m=!1,y=!1;l>13?y=!0:l<4&&(m=!0);let A=a+l-r,T=(a&1)==1,I=(l&1)==0;if(A==1)if(T){if(I)throw new ae;f=!0}else{if(!I)throw new ae;y=!0}else if(A==-1)if(T){if(I)throw new ae;u=!0}else{if(!I)throw new ae;m=!0}else if(A==0){if(T){if(!I)throw new ae;a<l?(u=!0,y=!0):(f=!0,m=!0)}else if(I)throw new ae}else throw new ae;if(u){if(f)throw new ae;Ne.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(f&&Ne.decrement(this.getOddCounts(),this.getOddRoundingErrors()),m){if(y)throw new ae;Ne.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&Ne.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ne.SYMBOL_WIDEST=[7,5,4,3,1],Ne.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Ne.GSUM=[0,348,1388,2948,3988],Ne.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Ne.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Ne.FINDER_PAT_A=0,Ne.FINDER_PAT_B=1,Ne.FINDER_PAT_C=2,Ne.FINDER_PAT_D=3,Ne.FINDER_PAT_E=4,Ne.FINDER_PAT_F=5,Ne.FINDER_PATTERN_SEQUENCES=[[Ne.FINDER_PAT_A,Ne.FINDER_PAT_A],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_B,Ne.FINDER_PAT_B],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_C,Ne.FINDER_PAT_B,Ne.FINDER_PAT_D],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_E,Ne.FINDER_PAT_B,Ne.FINDER_PAT_D,Ne.FINDER_PAT_C],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_E,Ne.FINDER_PAT_B,Ne.FINDER_PAT_D,Ne.FINDER_PAT_D,Ne.FINDER_PAT_F],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_E,Ne.FINDER_PAT_B,Ne.FINDER_PAT_D,Ne.FINDER_PAT_E,Ne.FINDER_PAT_F,Ne.FINDER_PAT_F],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_A,Ne.FINDER_PAT_B,Ne.FINDER_PAT_B,Ne.FINDER_PAT_C,Ne.FINDER_PAT_C,Ne.FINDER_PAT_D,Ne.FINDER_PAT_D],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_A,Ne.FINDER_PAT_B,Ne.FINDER_PAT_B,Ne.FINDER_PAT_C,Ne.FINDER_PAT_C,Ne.FINDER_PAT_D,Ne.FINDER_PAT_E,Ne.FINDER_PAT_E],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_A,Ne.FINDER_PAT_B,Ne.FINDER_PAT_B,Ne.FINDER_PAT_C,Ne.FINDER_PAT_C,Ne.FINDER_PAT_D,Ne.FINDER_PAT_E,Ne.FINDER_PAT_F,Ne.FINDER_PAT_F],[Ne.FINDER_PAT_A,Ne.FINDER_PAT_A,Ne.FINDER_PAT_B,Ne.FINDER_PAT_B,Ne.FINDER_PAT_C,Ne.FINDER_PAT_D,Ne.FINDER_PAT_D,Ne.FINDER_PAT_E,Ne.FINDER_PAT_E,Ne.FINDER_PAT_F,Ne.FINDER_PAT_F]],Ne.MAX_PAIRS=11;class Lo extends Mr{constructor(r,a,l){super(r,a),this.count=0,this.finderPattern=l}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class _n extends ar{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,a,l){const u=this.decodePair(a,!1,r,l);_n.addOrTally(this.possibleLeftPairs,u),a.reverse();let f=this.decodePair(a,!0,r,l);_n.addOrTally(this.possibleRightPairs,f),a.reverse();for(let m of this.possibleLeftPairs)if(m.getCount()>1){for(let y of this.possibleRightPairs)if(y.getCount()>1&&_n.checkChecksum(m,y))return _n.constructResult(m,y)}throw new ae}static addOrTally(r,a){if(a==null)return;let l=!1;for(let u of r)if(u.getValue()===a.getValue()){u.incrementCount(),l=!0;break}l||r.push(a)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,a){let l=4537077*r.getValue()+a.getValue(),u=new String(l).toString(),f=new H;for(let T=13-u.length;T>0;T--)f.append("0");f.append(u);let m=0;for(let T=0;T<13;T++){let I=f.charAt(T).charCodeAt(0)-48;m+=(T&1)===0?3*I:I}m=10-m%10,m===10&&(m=0),f.append(m.toString());let y=r.getFinderPattern().getResultPoints(),A=a.getFinderPattern().getResultPoints();return new Ve(f.toString(),null,0,[y[0],y[1],A[0],A[1]],we.RSS_14,new Date().getTime())}static checkChecksum(r,a){let l=(r.getChecksumPortion()+16*a.getChecksumPortion())%79,u=9*r.getFinderPattern().getValue()+a.getFinderPattern().getValue();return u>72&&u--,u>8&&u--,l===u}decodePair(r,a,l,u){try{let f=this.findFinderPattern(r,a),m=this.parseFoundFinderPattern(r,l,a,f),y=u==null?null:u.get(qe.NEED_RESULT_POINT_CALLBACK);if(y!=null){let I=(f[0]+f[1])/2;a&&(I=r.getSize()-1-I),y.foundPossibleResultPoint(new Xe(I,l))}let A=this.decodeDataCharacter(r,m,!0),T=this.decodeDataCharacter(r,m,!1);return new Lo(1597*A.getValue()+T.getValue(),A.getChecksumPortion()+4*T.getChecksumPortion(),m)}catch{return null}}decodeDataCharacter(r,a,l){let u=this.getDataCharacterCounters();for(let se=0;se<u.length;se++)u[se]=0;if(l)et.recordPatternInReverse(r,a.getStartEnd()[0],u);else{et.recordPattern(r,a.getStartEnd()[1]+1,u);for(let se=0,ye=u.length-1;se<ye;se++,ye--){let Ue=u[se];u[se]=u[ye],u[ye]=Ue}}let f=l?16:15,m=Qe.sum(new Int32Array(u))/f,y=this.getOddCounts(),A=this.getEvenCounts(),T=this.getOddRoundingErrors(),I=this.getEvenRoundingErrors();for(let se=0;se<u.length;se++){let ye=u[se]/m,Ue=Math.floor(ye+.5);Ue<1?Ue=1:Ue>8&&(Ue=8);let Be=Math.floor(se/2);(se&1)===0?(y[Be]=Ue,T[Be]=ye-Ue):(A[Be]=Ue,I[Be]=ye-Ue)}this.adjustOddEvenCounts(l,f);let k=0,L=0;for(let se=y.length-1;se>=0;se--)L*=9,L+=y[se],k+=y[se];let G=0,Q=0;for(let se=A.length-1;se>=0;se--)G*=9,G+=A[se],Q+=A[se];let J=L+3*G;if(l){if((k&1)!==0||k>12||k<4)throw new ae;let se=(12-k)/2,ye=_n.OUTSIDE_ODD_WIDEST[se],Ue=9-ye,Be=ii.getRSSvalue(y,ye,!1),Me=ii.getRSSvalue(A,Ue,!0),Zt=_n.OUTSIDE_EVEN_TOTAL_SUBSET[se],Ut=_n.OUTSIDE_GSUM[se];return new Mr(Be*Zt+Me+Ut,J)}else{if((Q&1)!==0||Q>10||Q<4)throw new ae;let se=(10-Q)/2,ye=_n.INSIDE_ODD_WIDEST[se],Ue=9-ye,Be=ii.getRSSvalue(y,ye,!0),Me=ii.getRSSvalue(A,Ue,!1),Zt=_n.INSIDE_ODD_TOTAL_SUBSET[se],Ut=_n.INSIDE_GSUM[se];return new Mr(Me*Zt+Be+Ut,J)}}findFinderPattern(r,a){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let u=r.getSize(),f=!1,m=0;for(;m<u&&(f=!r.get(m),a!==f);)m++;let y=0,A=m;for(let T=m;T<u;T++)if(r.get(T)!==f)l[y]++;else{if(y===3){if(ar.isFinderPattern(l))return[A,T];A+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,y--}else y++;l[y]=1,f=!f}throw new ae}parseFoundFinderPattern(r,a,l,u){let f=r.get(u[0]),m=u[0]-1;for(;m>=0&&f!==r.get(m);)m--;m++;const y=u[0]-m,A=this.getDecodeFinderCounters(),T=new Int32Array(A.length);oe.arraycopy(A,0,T,1,A.length-1),T[0]=y;const I=this.parseFinderValue(T,_n.FINDER_PATTERNS);let k=m,L=u[1];return l&&(k=r.getSize()-1-k,L=r.getSize()-1-L),new vi(I,[m,u[1]],k,L,a)}adjustOddEvenCounts(r,a){let l=Qe.sum(new Int32Array(this.getOddCounts())),u=Qe.sum(new Int32Array(this.getEvenCounts())),f=!1,m=!1,y=!1,A=!1;r?(l>12?m=!0:l<4&&(f=!0),u>12?A=!0:u<4&&(y=!0)):(l>11?m=!0:l<5&&(f=!0),u>10?A=!0:u<4&&(y=!0));let T=l+u-a,I=(l&1)===(r?1:0),k=(u&1)===1;if(T===1)if(I){if(k)throw new ae;m=!0}else{if(!k)throw new ae;A=!0}else if(T===-1)if(I){if(k)throw new ae;f=!0}else{if(!k)throw new ae;y=!0}else if(T===0){if(I){if(!k)throw new ae;l<u?(f=!0,A=!0):(m=!0,y=!0)}else if(k)throw new ae}else throw new ae;if(f){if(m)throw new ae;ar.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&ar.decrement(this.getOddCounts(),this.getOddRoundingErrors()),y){if(A)throw new ae;ar.increment(this.getEvenCounts(),this.getOddRoundingErrors())}A&&ar.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}_n.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],_n.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],_n.OUTSIDE_GSUM=[0,161,961,2015,2715],_n.INSIDE_GSUM=[0,336,1036,1516],_n.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],_n.INSIDE_ODD_WIDEST=[2,4,6,8],_n.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class qr extends et{constructor(r,a){super(),this.readers=[],this.verbose=a===!0;const l=r?r.get(qe.POSSIBLE_FORMATS):null,u=r&&r.get(qe.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;l?((l.includes(we.EAN_13)||l.includes(we.UPC_A)||l.includes(we.EAN_8)||l.includes(we.UPC_E))&&this.readers.push(new Js(r)),l.includes(we.CODE_39)&&this.readers.push(new kt(u)),l.includes(we.CODE_128)&&this.readers.push(new Te),l.includes(we.ITF)&&this.readers.push(new mt),l.includes(we.RSS_14)&&this.readers.push(new _n),l.includes(we.RSS_EXPANDED)&&this.readers.push(new Ne(this.verbose))):(this.readers.push(new Js(r)),this.readers.push(new kt),this.readers.push(new Js(r)),this.readers.push(new Te),this.readers.push(new mt),this.readers.push(new _n),this.readers.push(new Ne(this.verbose)))}decodeRow(r,a,l){for(let u=0;u<this.readers.length;u++)try{return this.readers[u].decodeRow(r,a,l)}catch{}throw new ae}reset(){this.readers.forEach(r=>r.reset())}}class Po extends De{constructor(r=500,a){super(new qr(a),r,a)}}class on{constructor(r,a,l){this.ecCodewords=r,this.ecBlocks=[a],l&&this.ecBlocks.push(l)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class tn{constructor(r,a){this.count=r,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Qt{constructor(r,a,l,u,f,m){this.versionNumber=r,this.symbolSizeRows=a,this.symbolSizeColumns=l,this.dataRegionSizeRows=u,this.dataRegionSizeColumns=f,this.ecBlocks=m;let y=0;const A=m.getECCodewords(),T=m.getECBlocks();for(let I of T)y+=I.getCount()*(I.getDataCodewords()+A);this.totalCodewords=y}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,a){if((r&1)!==0||(a&1)!==0)throw new F;for(let l of Qt.VERSIONS)if(l.symbolSizeRows===r&&l.symbolSizeColumns===a)return l;throw new F}toString(){return""+this.versionNumber}static buildVersions(){return[new Qt(1,10,10,8,8,new on(5,new tn(1,3))),new Qt(2,12,12,10,10,new on(7,new tn(1,5))),new Qt(3,14,14,12,12,new on(10,new tn(1,8))),new Qt(4,16,16,14,14,new on(12,new tn(1,12))),new Qt(5,18,18,16,16,new on(14,new tn(1,18))),new Qt(6,20,20,18,18,new on(18,new tn(1,22))),new Qt(7,22,22,20,20,new on(20,new tn(1,30))),new Qt(8,24,24,22,22,new on(24,new tn(1,36))),new Qt(9,26,26,24,24,new on(28,new tn(1,44))),new Qt(10,32,32,14,14,new on(36,new tn(1,62))),new Qt(11,36,36,16,16,new on(42,new tn(1,86))),new Qt(12,40,40,18,18,new on(48,new tn(1,114))),new Qt(13,44,44,20,20,new on(56,new tn(1,144))),new Qt(14,48,48,22,22,new on(68,new tn(1,174))),new Qt(15,52,52,24,24,new on(42,new tn(2,102))),new Qt(16,64,64,14,14,new on(56,new tn(2,140))),new Qt(17,72,72,16,16,new on(36,new tn(4,92))),new Qt(18,80,80,18,18,new on(48,new tn(4,114))),new Qt(19,88,88,20,20,new on(56,new tn(4,144))),new Qt(20,96,96,22,22,new on(68,new tn(4,174))),new Qt(21,104,104,24,24,new on(56,new tn(6,136))),new Qt(22,120,120,18,18,new on(68,new tn(6,175))),new Qt(23,132,132,20,20,new on(62,new tn(8,163))),new Qt(24,144,144,22,22,new on(62,new tn(8,156),new tn(2,155))),new Qt(25,8,18,6,16,new on(7,new tn(1,5))),new Qt(26,8,32,6,14,new on(11,new tn(1,10))),new Qt(27,12,26,10,24,new on(14,new tn(1,16))),new Qt(28,12,36,10,16,new on(18,new tn(1,22))),new Qt(29,16,36,14,16,new on(24,new tn(1,32))),new Qt(30,16,48,14,22,new on(28,new tn(1,49)))]}}Qt.VERSIONS=Qt.buildVersions();class Rs{constructor(r){const a=r.getHeight();if(a<8||a>144||(a&1)!==0)throw new F;this.version=Rs.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new rt(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const a=r.getHeight(),l=r.getWidth();return Qt.getVersionForDimensions(a,l)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let a=0,l=4,u=0;const f=this.mappingBitMatrix.getHeight(),m=this.mappingBitMatrix.getWidth();let y=!1,A=!1,T=!1,I=!1;do if(l===f&&u===0&&!y)r[a++]=this.readCorner1(f,m)&255,l-=2,u+=2,y=!0;else if(l===f-2&&u===0&&(m&3)!==0&&!A)r[a++]=this.readCorner2(f,m)&255,l-=2,u+=2,A=!0;else if(l===f+4&&u===2&&(m&7)===0&&!T)r[a++]=this.readCorner3(f,m)&255,l-=2,u+=2,T=!0;else if(l===f-2&&u===0&&(m&7)===4&&!I)r[a++]=this.readCorner4(f,m)&255,l-=2,u+=2,I=!0;else{do l<f&&u>=0&&!this.readMappingMatrix.get(u,l)&&(r[a++]=this.readUtah(l,u,f,m)&255),l-=2,u+=2;while(l>=0&&u<m);l+=1,u+=3;do l>=0&&u<m&&!this.readMappingMatrix.get(u,l)&&(r[a++]=this.readUtah(l,u,f,m)&255),l+=2,u-=2;while(l<f&&u>=0);l+=3,u+=1}while(l<f||u<m);if(a!==this.version.getTotalCodewords())throw new F;return r}readModule(r,a,l,u){return r<0&&(r+=l,a+=4-(l+4&7)),a<0&&(a+=u,r+=4-(u+4&7)),this.readMappingMatrix.set(a,r),this.mappingBitMatrix.get(a,r)}readUtah(r,a,l,u){let f=0;return this.readModule(r-2,a-2,l,u)&&(f|=1),f<<=1,this.readModule(r-2,a-1,l,u)&&(f|=1),f<<=1,this.readModule(r-1,a-2,l,u)&&(f|=1),f<<=1,this.readModule(r-1,a-1,l,u)&&(f|=1),f<<=1,this.readModule(r-1,a,l,u)&&(f|=1),f<<=1,this.readModule(r,a-2,l,u)&&(f|=1),f<<=1,this.readModule(r,a-1,l,u)&&(f|=1),f<<=1,this.readModule(r,a,l,u)&&(f|=1),f}readCorner1(r,a){let l=0;return this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,1,r,a)&&(l|=1),l<<=1,this.readModule(r-1,2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(2,a-1,r,a)&&(l|=1),l<<=1,this.readModule(3,a-1,r,a)&&(l|=1),l}readCorner2(r,a){let l=0;return this.readModule(r-3,0,r,a)&&(l|=1),l<<=1,this.readModule(r-2,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(0,a-4,r,a)&&(l|=1),l<<=1,this.readModule(0,a-3,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l}readCorner3(r,a){let l=0;return this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(0,a-3,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-3,r,a)&&(l|=1),l<<=1,this.readModule(1,a-2,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l}readCorner4(r,a){let l=0;return this.readModule(r-3,0,r,a)&&(l|=1),l<<=1,this.readModule(r-2,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(2,a-1,r,a)&&(l|=1),l<<=1,this.readModule(3,a-1,r,a)&&(l|=1),l}extractDataRegion(r){const a=this.version.getSymbolSizeRows(),l=this.version.getSymbolSizeColumns();if(r.getHeight()!==a)throw new N("Dimension of bitMatrix must match the version size");const u=this.version.getDataRegionSizeRows(),f=this.version.getDataRegionSizeColumns(),m=a/u|0,y=l/f|0,A=m*u,T=y*f,I=new rt(T,A);for(let k=0;k<m;++k){const L=k*u;for(let G=0;G<y;++G){const Q=G*f;for(let J=0;J<u;++J){const se=k*(u+2)+1+J,ye=L+J;for(let Ue=0;Ue<f;++Ue){const Be=G*(f+2)+1+Ue;if(r.get(Be,se)){const Me=Q+Ue;I.set(Me,ye)}}}}}return I}}class Xr{constructor(r,a){this.numDataCodewords=r,this.codewords=a}static getDataBlocks(r,a){const l=a.getECBlocks();let u=0;const f=l.getECBlocks();for(let J of f)u+=J.getCount();const m=new Array(u);let y=0;for(let J of f)for(let se=0;se<J.getCount();se++){const ye=J.getDataCodewords(),Ue=l.getECCodewords()+ye;m[y++]=new Xr(ye,new Uint8Array(Ue))}const T=m[0].codewords.length-l.getECCodewords(),I=T-1;let k=0;for(let J=0;J<I;J++)for(let se=0;se<y;se++)m[se].codewords[J]=r[k++];const L=a.getVersionNumber()===24,G=L?8:y;for(let J=0;J<G;J++)m[J].codewords[T-1]=r[k++];const Q=m[0].codewords.length;for(let J=T;J<Q;J++)for(let se=0;se<y;se++){const ye=L?(se+8)%y:se,Ue=L&&ye>7?J-1:J;m[ye].codewords[Ue]=r[k++]}if(k!==r.length)throw new N;return m}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class tr{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new N(""+r);let a=0,l=this.bitOffset,u=this.byteOffset;const f=this.bytes;if(l>0){const m=8-l,y=r<m?r:m,A=m-y,T=255>>8-y<<A;a=(f[u]&T)>>A,r-=y,l+=y,l===8&&(l=0,u++)}if(r>0){for(;r>=8;)a=a<<8|f[u]&255,u++,r-=8;if(r>0){const m=8-r,y=255>>m<<m;a=a<<r|(f[u]&y)>>m,l+=r}}return this.bitOffset=l,this.byteOffset=u,a}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Jt;(function(M){M[M.PAD_ENCODE=0]="PAD_ENCODE",M[M.ASCII_ENCODE=1]="ASCII_ENCODE",M[M.C40_ENCODE=2]="C40_ENCODE",M[M.TEXT_ENCODE=3]="TEXT_ENCODE",M[M.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",M[M.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",M[M.BASE256_ENCODE=6]="BASE256_ENCODE"})(Jt||(Jt={}));class Yr{static decode(r){const a=new tr(r),l=new H,u=new H,f=new Array;let m=Jt.ASCII_ENCODE;do if(m===Jt.ASCII_ENCODE)m=this.decodeAsciiSegment(a,l,u);else{switch(m){case Jt.C40_ENCODE:this.decodeC40Segment(a,l);break;case Jt.TEXT_ENCODE:this.decodeTextSegment(a,l);break;case Jt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(a,l);break;case Jt.EDIFACT_ENCODE:this.decodeEdifactSegment(a,l);break;case Jt.BASE256_ENCODE:this.decodeBase256Segment(a,l,f);break;default:throw new F}m=Jt.ASCII_ENCODE}while(m!==Jt.PAD_ENCODE&&a.available()>0);return u.length()>0&&l.append(u.toString()),new Mt(r,l.toString(),f.length===0?null:f,null)}static decodeAsciiSegment(r,a,l){let u=!1;do{let f=r.readBits(8);if(f===0)throw new F;if(f<=128)return u&&(f+=128),a.append(String.fromCharCode(f-1)),Jt.ASCII_ENCODE;if(f===129)return Jt.PAD_ENCODE;if(f<=229){const m=f-130;m<10&&a.append("0"),a.append(""+m)}else switch(f){case 230:return Jt.C40_ENCODE;case 231:return Jt.BASE256_ENCODE;case 232:a.append("");break;case 233:case 234:break;case 235:u=!0;break;case 236:a.append("[)>05"),l.insert(0,"");break;case 237:a.append("[)>06"),l.insert(0,"");break;case 238:return Jt.ANSIX12_ENCODE;case 239:return Jt.TEXT_ENCODE;case 240:return Jt.EDIFACT_ENCODE;case 241:break;default:if(f!==254||r.available()!==0)throw new F;break}}while(r.available()>0);return Jt.ASCII_ENCODE}static decodeC40Segment(r,a){let l=!1;const u=[];let f=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),u);for(let y=0;y<3;y++){const A=u[y];switch(f){case 0:if(A<3)f=A+1;else if(A<this.C40_BASIC_SET_CHARS.length){const T=this.C40_BASIC_SET_CHARS[A];l?(a.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):a.append(T)}else throw new F;break;case 1:l?(a.append(String.fromCharCode(A+128)),l=!1):a.append(String.fromCharCode(A)),f=0;break;case 2:if(A<this.C40_SHIFT2_SET_CHARS.length){const T=this.C40_SHIFT2_SET_CHARS[A];l?(a.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):a.append(T)}else switch(A){case 27:a.append("");break;case 30:l=!0;break;default:throw new F}f=0;break;case 3:l?(a.append(String.fromCharCode(A+224)),l=!1):a.append(String.fromCharCode(A+96)),f=0;break;default:throw new F}}}while(r.available()>0)}static decodeTextSegment(r,a){let l=!1,u=[],f=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),u);for(let y=0;y<3;y++){const A=u[y];switch(f){case 0:if(A<3)f=A+1;else if(A<this.TEXT_BASIC_SET_CHARS.length){const T=this.TEXT_BASIC_SET_CHARS[A];l?(a.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):a.append(T)}else throw new F;break;case 1:l?(a.append(String.fromCharCode(A+128)),l=!1):a.append(String.fromCharCode(A)),f=0;break;case 2:if(A<this.TEXT_SHIFT2_SET_CHARS.length){const T=this.TEXT_SHIFT2_SET_CHARS[A];l?(a.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):a.append(T)}else switch(A){case 27:a.append("");break;case 30:l=!0;break;default:throw new F}f=0;break;case 3:if(A<this.TEXT_SHIFT3_SET_CHARS.length){const T=this.TEXT_SHIFT3_SET_CHARS[A];l?(a.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):a.append(T),f=0}else throw new F;break;default:throw new F}}}while(r.available()>0)}static decodeAnsiX12Segment(r,a){const l=[];do{if(r.available()===8)return;const u=r.readBits(8);if(u===254)return;this.parseTwoBytes(u,r.readBits(8),l);for(let f=0;f<3;f++){const m=l[f];switch(m){case 0:a.append("\r");break;case 1:a.append("*");break;case 2:a.append(">");break;case 3:a.append(" ");break;default:if(m<14)a.append(String.fromCharCode(m+44));else if(m<40)a.append(String.fromCharCode(m+51));else throw new F;break}}}while(r.available()>0)}static parseTwoBytes(r,a,l){let u=(r<<8)+a-1,f=Math.floor(u/1600);l[0]=f,u-=f*1600,f=Math.floor(u/40),l[1]=f,l[2]=u-f*40}static decodeEdifactSegment(r,a){do{if(r.available()<=16)return;for(let l=0;l<4;l++){let u=r.readBits(6);if(u===31){const f=8-r.getBitOffset();f!==8&&r.readBits(f);return}(u&32)===0&&(u|=64),a.append(String.fromCharCode(u))}}while(r.available()>0)}static decodeBase256Segment(r,a,l){let u=1+r.getByteOffset();const f=this.unrandomize255State(r.readBits(8),u++);let m;if(f===0?m=r.available()/8|0:f<250?m=f:m=250*(f-249)+this.unrandomize255State(r.readBits(8),u++),m<0)throw new F;const y=new Uint8Array(m);for(let A=0;A<m;A++){if(r.available()<8)throw new F;y[A]=this.unrandomize255State(r.readBits(8),u++)}l.push(y);try{a.append(q.decode(y,Y.ISO88591))}catch(A){throw new yt("Platform does not support required encoding: "+A.message)}}static unrandomize255State(r,a){const l=149*a%255+1,u=r-l;return u>=0?u:u+256}}Yr.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Yr.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Yr.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Yr.TEXT_SHIFT2_SET_CHARS=Yr.C40_SHIFT2_SET_CHARS,Yr.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Bo{constructor(){this.rsDecoder=new Ct(He.DATA_MATRIX_FIELD_256)}decode(r){const a=new Rs(r),l=a.getVersion(),u=a.readCodewords(),f=Xr.getDataBlocks(u,l);let m=0;for(let T of f)m+=T.getNumDataCodewords();const y=new Uint8Array(m),A=f.length;for(let T=0;T<A;T++){const I=f[T],k=I.getCodewords(),L=I.getNumDataCodewords();this.correctErrors(k,L);for(let G=0;G<L;G++)y[G*A+T]=k[G]}return Yr.decode(y)}correctErrors(r,a){const l=new Int32Array(r);try{this.rsDecoder.decode(l,r.length-a)}catch{throw new X}for(let u=0;u<a;u++)r[u]=l[u]}}class It{constructor(r){this.image=r,this.rectangleDetector=new Tt(this.image)}detect(){const r=this.rectangleDetector.detect();let a=this.detectSolid1(r);if(a=this.detectSolid2(a),a[3]=this.correctTopRight(a),!a[3])throw new ae;a=this.shiftToModuleCenter(a);const l=a[0],u=a[1],f=a[2],m=a[3];let y=this.transitionsBetween(l,m)+1,A=this.transitionsBetween(f,m)+1;(y&1)===1&&(y+=1),(A&1)===1&&(A+=1),4*y<7*A&&4*A<7*y&&(y=A=Math.max(y,A));let T=It.sampleGrid(this.image,l,u,f,m,y,A);return new Ur(T,[l,u,f,m])}static shiftPoint(r,a,l){let u=(a.getX()-r.getX())/(l+1),f=(a.getY()-r.getY())/(l+1);return new Xe(r.getX()+u,r.getY()+f)}static moveAway(r,a,l){let u=r.getX(),f=r.getY();return u<a?u-=1:u+=1,f<l?f-=1:f+=1,new Xe(u,f)}detectSolid1(r){let a=r[0],l=r[1],u=r[3],f=r[2],m=this.transitionsBetween(a,l),y=this.transitionsBetween(l,u),A=this.transitionsBetween(u,f),T=this.transitionsBetween(f,a),I=m,k=[f,a,l,u];return I>y&&(I=y,k[0]=a,k[1]=l,k[2]=u,k[3]=f),I>A&&(I=A,k[0]=l,k[1]=u,k[2]=f,k[3]=a),I>T&&(k[0]=u,k[1]=f,k[2]=a,k[3]=l),k}detectSolid2(r){let a=r[0],l=r[1],u=r[2],f=r[3],m=this.transitionsBetween(a,f),y=It.shiftPoint(l,u,(m+1)*4),A=It.shiftPoint(u,l,(m+1)*4),T=this.transitionsBetween(y,a),I=this.transitionsBetween(A,f);return T<I?(r[0]=a,r[1]=l,r[2]=u,r[3]=f):(r[0]=l,r[1]=u,r[2]=f,r[3]=a),r}correctTopRight(r){let a=r[0],l=r[1],u=r[2],f=r[3],m=this.transitionsBetween(a,f),y=this.transitionsBetween(l,f),A=It.shiftPoint(a,l,(y+1)*4),T=It.shiftPoint(u,l,(m+1)*4);m=this.transitionsBetween(A,f),y=this.transitionsBetween(T,f);let I=new Xe(f.getX()+(u.getX()-l.getX())/(m+1),f.getY()+(u.getY()-l.getY())/(m+1)),k=new Xe(f.getX()+(a.getX()-l.getX())/(y+1),f.getY()+(a.getY()-l.getY())/(y+1));if(!this.isValid(I))return this.isValid(k)?k:null;if(!this.isValid(k))return I;let L=this.transitionsBetween(A,I)+this.transitionsBetween(T,I),G=this.transitionsBetween(A,k)+this.transitionsBetween(T,k);return L>G?I:k}shiftToModuleCenter(r){let a=r[0],l=r[1],u=r[2],f=r[3],m=this.transitionsBetween(a,f)+1,y=this.transitionsBetween(u,f)+1,A=It.shiftPoint(a,l,y*4),T=It.shiftPoint(u,l,m*4);m=this.transitionsBetween(A,f)+1,y=this.transitionsBetween(T,f)+1,(m&1)===1&&(m+=1),(y&1)===1&&(y+=1);let I=(a.getX()+l.getX()+u.getX()+f.getX())/4,k=(a.getY()+l.getY()+u.getY()+f.getY())/4;a=It.moveAway(a,I,k),l=It.moveAway(l,I,k),u=It.moveAway(u,I,k),f=It.moveAway(f,I,k);let L,G;return A=It.shiftPoint(a,l,y*4),A=It.shiftPoint(A,f,m*4),L=It.shiftPoint(l,a,y*4),L=It.shiftPoint(L,u,m*4),T=It.shiftPoint(u,f,y*4),T=It.shiftPoint(T,l,m*4),G=It.shiftPoint(f,u,y*4),G=It.shiftPoint(G,a,m*4),[A,L,T,G]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,a,l,u,f,m,y){return Je.getInstance().sampleGrid(r,m,y,.5,.5,m-.5,.5,m-.5,y-.5,.5,y-.5,a.getX(),a.getY(),f.getX(),f.getY(),u.getX(),u.getY(),l.getX(),l.getY())}transitionsBetween(r,a){let l=Math.trunc(r.getX()),u=Math.trunc(r.getY()),f=Math.trunc(a.getX()),m=Math.trunc(a.getY()),y=Math.abs(m-u)>Math.abs(f-l);if(y){let J=l;l=u,u=J,J=f,f=m,m=J}let A=Math.abs(f-l),T=Math.abs(m-u),I=-A/2,k=u<m?1:-1,L=l<f?1:-1,G=0,Q=this.image.get(y?u:l,y?l:u);for(let J=l,se=u;J!==f;J+=L){let ye=this.image.get(y?se:J,y?J:se);if(ye!==Q&&(G++,Q=ye),I+=T,I>0){if(se===m)break;se+=k,I-=A}}return G}}class si{constructor(){this.decoder=new Bo}decode(r,a=null){let l,u;if(a!=null&&a.has(qe.PURE_BARCODE)){const T=si.extractPureBits(r.getBlackMatrix());l=this.decoder.decode(T),u=si.NO_POINTS}else{const T=new It(r.getBlackMatrix()).detect();l=this.decoder.decode(T.getBits()),u=T.getPoints()}const f=l.getRawBytes(),m=new Ve(l.getText(),f,8*f.length,u,we.DATA_MATRIX,oe.currentTimeMillis()),y=l.getByteSegments();y!=null&&m.putMetadata(xt.BYTE_SEGMENTS,y);const A=l.getECLevel();return A!=null&&m.putMetadata(xt.ERROR_CORRECTION_LEVEL,A),m}reset(){}static extractPureBits(r){const a=r.getTopLeftOnBit(),l=r.getBottomRightOnBit();if(a==null||l==null)throw new ae;const u=this.moduleSize(a,r);let f=a[1];const m=l[1];let y=a[0];const T=(l[0]-y+1)/u,I=(m-f+1)/u;if(T<=0||I<=0)throw new ae;const k=u/2;f+=k,y+=k;const L=new rt(T,I);for(let G=0;G<I;G++){const Q=f+G*u;for(let J=0;J<T;J++)r.get(y+J*u,Q)&&L.set(J,G)}return L}static moduleSize(r,a){const l=a.getWidth();let u=r[0];const f=r[1];for(;u<l&&a.get(u,f);)u++;if(u===l)throw new ae;const m=u-r[0];if(m===0)throw new ae;return m}}si.NO_POINTS=[];class ts extends De{constructor(r=500){super(new si,r)}}var Ci;(function(M){M[M.L=0]="L",M[M.M=1]="M",M[M.Q=2]="Q",M[M.H=3]="H"})(Ci||(Ci={}));class Wt{constructor(r,a,l){this.value=r,this.stringValue=a,this.bits=l,Wt.FOR_BITS.set(l,this),Wt.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return Wt.L;case"M":return Wt.M;case"Q":return Wt.Q;case"H":return Wt.H;default:throw new S(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof Wt))return!1;const a=r;return this.value===a.value}static forBits(r){if(r<0||r>=Wt.FOR_BITS.size)throw new N;return Wt.FOR_BITS.get(r)}}Wt.FOR_BITS=new Map,Wt.FOR_VALUE=new Map,Wt.L=new Wt(Ci.L,"L",1),Wt.M=new Wt(Ci.M,"M",0),Wt.Q=new Wt(Ci.Q,"Q",3),Wt.H=new Wt(Ci.H,"H",2);class or{constructor(r){this.errorCorrectionLevel=Wt.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,a){return de.bitCount(r^a)}static decodeFormatInformation(r,a){const l=or.doDecodeFormatInformation(r,a);return l!==null?l:or.doDecodeFormatInformation(r^or.FORMAT_INFO_MASK_QR,a^or.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,a){let l=Number.MAX_SAFE_INTEGER,u=0;for(const f of or.FORMAT_INFO_DECODE_LOOKUP){const m=f[0];if(m===r||m===a)return new or(f[1]);let y=or.numBitsDiffering(r,m);y<l&&(u=f[1],l=y),r!==a&&(y=or.numBitsDiffering(a,m),y<l&&(u=f[1],l=y))}return l<=3?new or(u):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof or))return!1;const a=r;return this.errorCorrectionLevel===a.errorCorrectionLevel&&this.dataMask===a.dataMask}}or.FORMAT_INFO_MASK_QR=21522,or.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class le{constructor(r,...a){this.ecCodewordsPerBlock=r,this.ecBlocks=a}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const a=this.ecBlocks;for(const l of a)r+=l.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class z{constructor(r,a){this.count=r,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ot{constructor(r,a,...l){this.versionNumber=r,this.alignmentPatternCenters=a,this.ecBlocks=l;let u=0;const f=l[0].getECCodewordsPerBlock(),m=l[0].getECBlocks();for(const y of m)u+=y.getCount()*(y.getDataCodewords()+f);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new F;try{return this.getVersionForNumber((r-17)/4)}catch{throw new F}}static getVersionForNumber(r){if(r<1||r>40)throw new N;return ot.VERSIONS[r-1]}static decodeVersionInformation(r){let a=Number.MAX_SAFE_INTEGER,l=0;for(let u=0;u<ot.VERSION_DECODE_INFO.length;u++){const f=ot.VERSION_DECODE_INFO[u];if(f===r)return ot.getVersionForNumber(u+7);const m=or.numBitsDiffering(r,f);m<a&&(l=u+7,a=m)}return a<=3?ot.getVersionForNumber(l):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),a=new rt(r);a.setRegion(0,0,9,9),a.setRegion(r-8,0,8,9),a.setRegion(0,r-8,9,8);const l=this.alignmentPatternCenters.length;for(let u=0;u<l;u++){const f=this.alignmentPatternCenters[u]-2;for(let m=0;m<l;m++)u===0&&(m===0||m===l-1)||u===l-1&&m===0||a.setRegion(this.alignmentPatternCenters[m]-2,f,5,5)}return a.setRegion(6,9,1,r-17),a.setRegion(9,6,r-17,1),this.versionNumber>6&&(a.setRegion(r-11,0,3,6),a.setRegion(0,r-11,6,3)),a}toString(){return""+this.versionNumber}}ot.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ot.VERSIONS=[new ot(1,new Int32Array(0),new le(7,new z(1,19)),new le(10,new z(1,16)),new le(13,new z(1,13)),new le(17,new z(1,9))),new ot(2,Int32Array.from([6,18]),new le(10,new z(1,34)),new le(16,new z(1,28)),new le(22,new z(1,22)),new le(28,new z(1,16))),new ot(3,Int32Array.from([6,22]),new le(15,new z(1,55)),new le(26,new z(1,44)),new le(18,new z(2,17)),new le(22,new z(2,13))),new ot(4,Int32Array.from([6,26]),new le(20,new z(1,80)),new le(18,new z(2,32)),new le(26,new z(2,24)),new le(16,new z(4,9))),new ot(5,Int32Array.from([6,30]),new le(26,new z(1,108)),new le(24,new z(2,43)),new le(18,new z(2,15),new z(2,16)),new le(22,new z(2,11),new z(2,12))),new ot(6,Int32Array.from([6,34]),new le(18,new z(2,68)),new le(16,new z(4,27)),new le(24,new z(4,19)),new le(28,new z(4,15))),new ot(7,Int32Array.from([6,22,38]),new le(20,new z(2,78)),new le(18,new z(4,31)),new le(18,new z(2,14),new z(4,15)),new le(26,new z(4,13),new z(1,14))),new ot(8,Int32Array.from([6,24,42]),new le(24,new z(2,97)),new le(22,new z(2,38),new z(2,39)),new le(22,new z(4,18),new z(2,19)),new le(26,new z(4,14),new z(2,15))),new ot(9,Int32Array.from([6,26,46]),new le(30,new z(2,116)),new le(22,new z(3,36),new z(2,37)),new le(20,new z(4,16),new z(4,17)),new le(24,new z(4,12),new z(4,13))),new ot(10,Int32Array.from([6,28,50]),new le(18,new z(2,68),new z(2,69)),new le(26,new z(4,43),new z(1,44)),new le(24,new z(6,19),new z(2,20)),new le(28,new z(6,15),new z(2,16))),new ot(11,Int32Array.from([6,30,54]),new le(20,new z(4,81)),new le(30,new z(1,50),new z(4,51)),new le(28,new z(4,22),new z(4,23)),new le(24,new z(3,12),new z(8,13))),new ot(12,Int32Array.from([6,32,58]),new le(24,new z(2,92),new z(2,93)),new le(22,new z(6,36),new z(2,37)),new le(26,new z(4,20),new z(6,21)),new le(28,new z(7,14),new z(4,15))),new ot(13,Int32Array.from([6,34,62]),new le(26,new z(4,107)),new le(22,new z(8,37),new z(1,38)),new le(24,new z(8,20),new z(4,21)),new le(22,new z(12,11),new z(4,12))),new ot(14,Int32Array.from([6,26,46,66]),new le(30,new z(3,115),new z(1,116)),new le(24,new z(4,40),new z(5,41)),new le(20,new z(11,16),new z(5,17)),new le(24,new z(11,12),new z(5,13))),new ot(15,Int32Array.from([6,26,48,70]),new le(22,new z(5,87),new z(1,88)),new le(24,new z(5,41),new z(5,42)),new le(30,new z(5,24),new z(7,25)),new le(24,new z(11,12),new z(7,13))),new ot(16,Int32Array.from([6,26,50,74]),new le(24,new z(5,98),new z(1,99)),new le(28,new z(7,45),new z(3,46)),new le(24,new z(15,19),new z(2,20)),new le(30,new z(3,15),new z(13,16))),new ot(17,Int32Array.from([6,30,54,78]),new le(28,new z(1,107),new z(5,108)),new le(28,new z(10,46),new z(1,47)),new le(28,new z(1,22),new z(15,23)),new le(28,new z(2,14),new z(17,15))),new ot(18,Int32Array.from([6,30,56,82]),new le(30,new z(5,120),new z(1,121)),new le(26,new z(9,43),new z(4,44)),new le(28,new z(17,22),new z(1,23)),new le(28,new z(2,14),new z(19,15))),new ot(19,Int32Array.from([6,30,58,86]),new le(28,new z(3,113),new z(4,114)),new le(26,new z(3,44),new z(11,45)),new le(26,new z(17,21),new z(4,22)),new le(26,new z(9,13),new z(16,14))),new ot(20,Int32Array.from([6,34,62,90]),new le(28,new z(3,107),new z(5,108)),new le(26,new z(3,41),new z(13,42)),new le(30,new z(15,24),new z(5,25)),new le(28,new z(15,15),new z(10,16))),new ot(21,Int32Array.from([6,28,50,72,94]),new le(28,new z(4,116),new z(4,117)),new le(26,new z(17,42)),new le(28,new z(17,22),new z(6,23)),new le(30,new z(19,16),new z(6,17))),new ot(22,Int32Array.from([6,26,50,74,98]),new le(28,new z(2,111),new z(7,112)),new le(28,new z(17,46)),new le(30,new z(7,24),new z(16,25)),new le(24,new z(34,13))),new ot(23,Int32Array.from([6,30,54,78,102]),new le(30,new z(4,121),new z(5,122)),new le(28,new z(4,47),new z(14,48)),new le(30,new z(11,24),new z(14,25)),new le(30,new z(16,15),new z(14,16))),new ot(24,Int32Array.from([6,28,54,80,106]),new le(30,new z(6,117),new z(4,118)),new le(28,new z(6,45),new z(14,46)),new le(30,new z(11,24),new z(16,25)),new le(30,new z(30,16),new z(2,17))),new ot(25,Int32Array.from([6,32,58,84,110]),new le(26,new z(8,106),new z(4,107)),new le(28,new z(8,47),new z(13,48)),new le(30,new z(7,24),new z(22,25)),new le(30,new z(22,15),new z(13,16))),new ot(26,Int32Array.from([6,30,58,86,114]),new le(28,new z(10,114),new z(2,115)),new le(28,new z(19,46),new z(4,47)),new le(28,new z(28,22),new z(6,23)),new le(30,new z(33,16),new z(4,17))),new ot(27,Int32Array.from([6,34,62,90,118]),new le(30,new z(8,122),new z(4,123)),new le(28,new z(22,45),new z(3,46)),new le(30,new z(8,23),new z(26,24)),new le(30,new z(12,15),new z(28,16))),new ot(28,Int32Array.from([6,26,50,74,98,122]),new le(30,new z(3,117),new z(10,118)),new le(28,new z(3,45),new z(23,46)),new le(30,new z(4,24),new z(31,25)),new le(30,new z(11,15),new z(31,16))),new ot(29,Int32Array.from([6,30,54,78,102,126]),new le(30,new z(7,116),new z(7,117)),new le(28,new z(21,45),new z(7,46)),new le(30,new z(1,23),new z(37,24)),new le(30,new z(19,15),new z(26,16))),new ot(30,Int32Array.from([6,26,52,78,104,130]),new le(30,new z(5,115),new z(10,116)),new le(28,new z(19,47),new z(10,48)),new le(30,new z(15,24),new z(25,25)),new le(30,new z(23,15),new z(25,16))),new ot(31,Int32Array.from([6,30,56,82,108,134]),new le(30,new z(13,115),new z(3,116)),new le(28,new z(2,46),new z(29,47)),new le(30,new z(42,24),new z(1,25)),new le(30,new z(23,15),new z(28,16))),new ot(32,Int32Array.from([6,34,60,86,112,138]),new le(30,new z(17,115)),new le(28,new z(10,46),new z(23,47)),new le(30,new z(10,24),new z(35,25)),new le(30,new z(19,15),new z(35,16))),new ot(33,Int32Array.from([6,30,58,86,114,142]),new le(30,new z(17,115),new z(1,116)),new le(28,new z(14,46),new z(21,47)),new le(30,new z(29,24),new z(19,25)),new le(30,new z(11,15),new z(46,16))),new ot(34,Int32Array.from([6,34,62,90,118,146]),new le(30,new z(13,115),new z(6,116)),new le(28,new z(14,46),new z(23,47)),new le(30,new z(44,24),new z(7,25)),new le(30,new z(59,16),new z(1,17))),new ot(35,Int32Array.from([6,30,54,78,102,126,150]),new le(30,new z(12,121),new z(7,122)),new le(28,new z(12,47),new z(26,48)),new le(30,new z(39,24),new z(14,25)),new le(30,new z(22,15),new z(41,16))),new ot(36,Int32Array.from([6,24,50,76,102,128,154]),new le(30,new z(6,121),new z(14,122)),new le(28,new z(6,47),new z(34,48)),new le(30,new z(46,24),new z(10,25)),new le(30,new z(2,15),new z(64,16))),new ot(37,Int32Array.from([6,28,54,80,106,132,158]),new le(30,new z(17,122),new z(4,123)),new le(28,new z(29,46),new z(14,47)),new le(30,new z(49,24),new z(10,25)),new le(30,new z(24,15),new z(46,16))),new ot(38,Int32Array.from([6,32,58,84,110,136,162]),new le(30,new z(4,122),new z(18,123)),new le(28,new z(13,46),new z(32,47)),new le(30,new z(48,24),new z(14,25)),new le(30,new z(42,15),new z(32,16))),new ot(39,Int32Array.from([6,26,54,82,110,138,166]),new le(30,new z(20,117),new z(4,118)),new le(28,new z(40,47),new z(7,48)),new le(30,new z(43,24),new z(22,25)),new le(30,new z(10,15),new z(67,16))),new ot(40,Int32Array.from([6,30,58,86,114,142,170]),new le(30,new z(19,118),new z(6,119)),new le(28,new z(18,47),new z(31,48)),new le(30,new z(34,24),new z(34,25)),new le(30,new z(20,15),new z(61,16)))];var lr;(function(M){M[M.DATA_MASK_000=0]="DATA_MASK_000",M[M.DATA_MASK_001=1]="DATA_MASK_001",M[M.DATA_MASK_010=2]="DATA_MASK_010",M[M.DATA_MASK_011=3]="DATA_MASK_011",M[M.DATA_MASK_100=4]="DATA_MASK_100",M[M.DATA_MASK_101=5]="DATA_MASK_101",M[M.DATA_MASK_110=6]="DATA_MASK_110",M[M.DATA_MASK_111=7]="DATA_MASK_111"})(lr||(lr={}));class xr{constructor(r,a){this.value=r,this.isMasked=a}unmaskBitMatrix(r,a){for(let l=0;l<a;l++)for(let u=0;u<a;u++)this.isMasked(l,u)&&r.flip(u,l)}}xr.values=new Map([[lr.DATA_MASK_000,new xr(lr.DATA_MASK_000,(M,r)=>(M+r&1)===0)],[lr.DATA_MASK_001,new xr(lr.DATA_MASK_001,(M,r)=>(M&1)===0)],[lr.DATA_MASK_010,new xr(lr.DATA_MASK_010,(M,r)=>r%3===0)],[lr.DATA_MASK_011,new xr(lr.DATA_MASK_011,(M,r)=>(M+r)%3===0)],[lr.DATA_MASK_100,new xr(lr.DATA_MASK_100,(M,r)=>(Math.floor(M/2)+Math.floor(r/3)&1)===0)],[lr.DATA_MASK_101,new xr(lr.DATA_MASK_101,(M,r)=>M*r%6===0)],[lr.DATA_MASK_110,new xr(lr.DATA_MASK_110,(M,r)=>M*r%6<3)],[lr.DATA_MASK_111,new xr(lr.DATA_MASK_111,(M,r)=>(M+r+M*r%3&1)===0)]]);class ai{constructor(r){const a=r.getHeight();if(a<21||(a&3)!==1)throw new F;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let f=0;f<6;f++)r=this.copyBit(f,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let f=5;f>=0;f--)r=this.copyBit(8,f,r);const a=this.bitMatrix.getHeight();let l=0;const u=a-7;for(let f=a-1;f>=u;f--)l=this.copyBit(8,f,l);for(let f=a-8;f<a;f++)l=this.copyBit(f,8,l);if(this.parsedFormatInfo=or.decodeFormatInformation(r,l),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new F}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),a=Math.floor((r-17)/4);if(a<=6)return ot.getVersionForNumber(a);let l=0;const u=r-11;for(let m=5;m>=0;m--)for(let y=r-9;y>=u;y--)l=this.copyBit(y,m,l);let f=ot.decodeVersionInformation(l);if(f!==null&&f.getDimensionForVersion()===r)return this.parsedVersion=f,f;l=0;for(let m=5;m>=0;m--)for(let y=r-9;y>=u;y--)l=this.copyBit(m,y,l);if(f=ot.decodeVersionInformation(l),f!==null&&f.getDimensionForVersion()===r)return this.parsedVersion=f,f;throw new F}copyBit(r,a,l){return(this.isMirror?this.bitMatrix.get(a,r):this.bitMatrix.get(r,a))?l<<1|1:l<<1}readCodewords(){const r=this.readFormatInformation(),a=this.readVersion(),l=xr.values.get(r.getDataMask()),u=this.bitMatrix.getHeight();l.unmaskBitMatrix(this.bitMatrix,u);const f=a.buildFunctionPattern();let m=!0;const y=new Uint8Array(a.getTotalCodewords());let A=0,T=0,I=0;for(let k=u-1;k>0;k-=2){k===6&&k--;for(let L=0;L<u;L++){const G=m?u-1-L:L;for(let Q=0;Q<2;Q++)f.get(k-Q,G)||(I++,T<<=1,this.bitMatrix.get(k-Q,G)&&(T|=1),I===8&&(y[A++]=T,I=0,T=0))}m=!m}if(A!==a.getTotalCodewords())throw new F;return y}remask(){if(this.parsedFormatInfo===null)return;const r=xr.values[this.parsedFormatInfo.getDataMask()],a=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,a)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let a=0,l=r.getWidth();a<l;a++)for(let u=a+1,f=r.getHeight();u<f;u++)r.get(a,u)!==r.get(u,a)&&(r.flip(u,a),r.flip(a,u))}}class Pa{constructor(r,a){this.numDataCodewords=r,this.codewords=a}static getDataBlocks(r,a,l){if(r.length!==a.getTotalCodewords())throw new N;const u=a.getECBlocksForLevel(l);let f=0;const m=u.getECBlocks();for(const Q of m)f+=Q.getCount();const y=new Array(f);let A=0;for(const Q of m)for(let J=0;J<Q.getCount();J++){const se=Q.getDataCodewords(),ye=u.getECCodewordsPerBlock()+se;y[A++]=new Pa(se,new Uint8Array(ye))}const T=y[0].codewords.length;let I=y.length-1;for(;I>=0&&y[I].codewords.length!==T;)I--;I++;const k=T-u.getECCodewordsPerBlock();let L=0;for(let Q=0;Q<k;Q++)for(let J=0;J<A;J++)y[J].codewords[Q]=r[L++];for(let Q=I;Q<A;Q++)y[Q].codewords[k]=r[L++];const G=y[0].codewords.length;for(let Q=k;Q<G;Q++)for(let J=0;J<A;J++){const se=J<I?Q:Q+1;y[J].codewords[se]=r[L++]}return y}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Fr;(function(M){M[M.TERMINATOR=0]="TERMINATOR",M[M.NUMERIC=1]="NUMERIC",M[M.ALPHANUMERIC=2]="ALPHANUMERIC",M[M.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",M[M.BYTE=4]="BYTE",M[M.ECI=5]="ECI",M[M.KANJI=6]="KANJI",M[M.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",M[M.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",M[M.HANZI=9]="HANZI"})(Fr||(Fr={}));class Et{constructor(r,a,l,u){this.value=r,this.stringValue=a,this.characterCountBitsForVersions=l,this.bits=u,Et.FOR_BITS.set(u,this),Et.FOR_VALUE.set(r,this)}static forBits(r){const a=Et.FOR_BITS.get(r);if(a===void 0)throw new N;return a}getCharacterCountBits(r){const a=r.getVersionNumber();let l;return a<=9?l=0:a<=26?l=1:l=2,this.characterCountBitsForVersions[l]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof Et))return!1;const a=r;return this.value===a.value}toString(){return this.stringValue}}Et.FOR_BITS=new Map,Et.FOR_VALUE=new Map,Et.TERMINATOR=new Et(Fr.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Et.NUMERIC=new Et(Fr.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Et.ALPHANUMERIC=new Et(Fr.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Et.STRUCTURED_APPEND=new Et(Fr.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Et.BYTE=new Et(Fr.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Et.ECI=new Et(Fr.ECI,"ECI",Int32Array.from([0,0,0]),7),Et.KANJI=new Et(Fr.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Et.FNC1_FIRST_POSITION=new Et(Fr.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Et.FNC1_SECOND_POSITION=new Et(Fr.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Et.HANZI=new Et(Fr.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Cn{static decode(r,a,l,u){const f=new tr(r);let m=new H;const y=new Array;let A=-1,T=-1;try{let I=null,k=!1,L;do{if(f.available()<4)L=Et.TERMINATOR;else{const G=f.readBits(4);L=Et.forBits(G)}switch(L){case Et.TERMINATOR:break;case Et.FNC1_FIRST_POSITION:case Et.FNC1_SECOND_POSITION:k=!0;break;case Et.STRUCTURED_APPEND:if(f.available()<16)throw new F;A=f.readBits(8),T=f.readBits(8);break;case Et.ECI:const G=Cn.parseECIValue(f);if(I=V.getCharacterSetECIByValue(G),I===null)throw new F;break;case Et.HANZI:const Q=f.readBits(4),J=f.readBits(L.getCharacterCountBits(a));Q===Cn.GB2312_SUBSET&&Cn.decodeHanziSegment(f,m,J);break;default:const se=f.readBits(L.getCharacterCountBits(a));switch(L){case Et.NUMERIC:Cn.decodeNumericSegment(f,m,se);break;case Et.ALPHANUMERIC:Cn.decodeAlphanumericSegment(f,m,se,k);break;case Et.BYTE:Cn.decodeByteSegment(f,m,se,I,y,u);break;case Et.KANJI:Cn.decodeKanjiSegment(f,m,se);break;default:throw new F}break}}while(L!==Et.TERMINATOR)}catch{throw new F}return new Mt(r,m.toString(),y.length===0?null:y,l===null?null:l.toString(),A,T)}static decodeHanziSegment(r,a,l){if(l*13>r.available())throw new F;const u=new Uint8Array(2*l);let f=0;for(;l>0;){const m=r.readBits(13);let y=m/96<<8&4294967295|m%96;y<959?y+=41377:y+=42657,u[f]=y>>8&255,u[f+1]=y&255,f+=2,l--}try{a.append(q.decode(u,Y.GB2312))}catch(m){throw new F(m)}}static decodeKanjiSegment(r,a,l){if(l*13>r.available())throw new F;const u=new Uint8Array(2*l);let f=0;for(;l>0;){const m=r.readBits(13);let y=m/192<<8&4294967295|m%192;y<7936?y+=33088:y+=49472,u[f]=y>>8,u[f+1]=y,f+=2,l--}try{a.append(q.decode(u,Y.SHIFT_JIS))}catch(m){throw new F(m)}}static decodeByteSegment(r,a,l,u,f,m){if(8*l>r.available())throw new F;const y=new Uint8Array(l);for(let T=0;T<l;T++)y[T]=r.readBits(8);let A;u===null?A=Y.guessEncoding(y,m):A=u.getName();try{a.append(q.decode(y,A))}catch(T){throw new F(T)}f.push(y)}static toAlphaNumericChar(r){if(r>=Cn.ALPHANUMERIC_CHARS.length)throw new F;return Cn.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,a,l,u){const f=a.length();for(;l>1;){if(r.available()<11)throw new F;const m=r.readBits(11);a.append(Cn.toAlphaNumericChar(Math.floor(m/45))),a.append(Cn.toAlphaNumericChar(m%45)),l-=2}if(l===1){if(r.available()<6)throw new F;a.append(Cn.toAlphaNumericChar(r.readBits(6)))}if(u)for(let m=f;m<a.length();m++)a.charAt(m)==="%"&&(m<a.length()-1&&a.charAt(m+1)==="%"?a.deleteCharAt(m+1):a.setCharAt(m,""))}static decodeNumericSegment(r,a,l){for(;l>=3;){if(r.available()<10)throw new F;const u=r.readBits(10);if(u>=1e3)throw new F;a.append(Cn.toAlphaNumericChar(Math.floor(u/100))),a.append(Cn.toAlphaNumericChar(Math.floor(u/10)%10)),a.append(Cn.toAlphaNumericChar(u%10)),l-=3}if(l===2){if(r.available()<7)throw new F;const u=r.readBits(7);if(u>=100)throw new F;a.append(Cn.toAlphaNumericChar(Math.floor(u/10))),a.append(Cn.toAlphaNumericChar(u%10))}else if(l===1){if(r.available()<4)throw new F;const u=r.readBits(4);if(u>=10)throw new F;a.append(Cn.toAlphaNumericChar(u))}}static parseECIValue(r){const a=r.readBits(8);if((a&128)===0)return a&127;if((a&192)===128){const l=r.readBits(8);return(a&63)<<8&4294967295|l}if((a&224)===192){const l=r.readBits(16);return(a&31)<<16&4294967295|l}throw new F}}Cn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Cn.GB2312_SUBSET=1;class Vo{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const a=r[0];r[0]=r[2],r[2]=a}}class Ns{constructor(){this.rsDecoder=new Ct(He.QR_CODE_FIELD_256)}decodeBooleanArray(r,a){return this.decodeBitMatrix(rt.parseFromBooleanArray(r),a)}decodeBitMatrix(r,a){const l=new ai(r);let u=null;try{return this.decodeBitMatrixParser(l,a)}catch(f){u=f}try{l.remask(),l.setMirror(!0),l.readVersion(),l.readFormatInformation(),l.mirror();const f=this.decodeBitMatrixParser(l,a);return f.setOther(new Vo(!0)),f}catch(f){throw u!==null?u:f}}decodeBitMatrixParser(r,a){const l=r.readVersion(),u=r.readFormatInformation().getErrorCorrectionLevel(),f=r.readCodewords(),m=Pa.getDataBlocks(f,l,u);let y=0;for(const I of m)y+=I.getNumDataCodewords();const A=new Uint8Array(y);let T=0;for(const I of m){const k=I.getCodewords(),L=I.getNumDataCodewords();this.correctErrors(k,L);for(let G=0;G<L;G++)A[T++]=k[G]}return Cn.decode(A,l,u,a)}correctErrors(r,a){const l=new Int32Array(r);try{this.rsDecoder.decode(l,r.length-a)}catch{throw new X}for(let u=0;u<a;u++)r[u]=l[u]}}class Os extends Xe{constructor(r,a,l){super(r,a),this.estimatedModuleSize=l}aboutEquals(r,a,l){if(Math.abs(a-this.getY())<=r&&Math.abs(l-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,a,l){const u=(this.getX()+a)/2,f=(this.getY()+r)/2,m=(this.estimatedModuleSize+l)/2;return new Os(u,f,m)}}class oi{constructor(r,a,l,u,f,m,y){this.image=r,this.startX=a,this.startY=l,this.width=u,this.height=f,this.moduleSize=m,this.resultPointCallback=y,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,a=this.height,l=this.width,u=r+l,f=this.startY+a/2,m=new Int32Array(3),y=this.image;for(let A=0;A<a;A++){const T=f+((A&1)===0?Math.floor((A+1)/2):-Math.floor((A+1)/2));m[0]=0,m[1]=0,m[2]=0;let I=r;for(;I<u&&!y.get(I,T);)I++;let k=0;for(;I<u;){if(y.get(I,T))if(k===1)m[1]++;else if(k===2){if(this.foundPatternCross(m)){const L=this.handlePossibleCenter(m,T,I);if(L!==null)return L}m[0]=m[2],m[1]=1,m[2]=0,k=1}else m[++k]++;else k===1&&k++,m[k]++;I++}if(this.foundPatternCross(m)){const L=this.handlePossibleCenter(m,T,u);if(L!==null)return L}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ae}static centerFromEnd(r,a){return a-r[2]-r[1]/2}foundPatternCross(r){const a=this.moduleSize,l=a/2;for(let u=0;u<3;u++)if(Math.abs(a-r[u])>=l)return!1;return!0}crossCheckVertical(r,a,l,u){const f=this.image,m=f.getHeight(),y=this.crossCheckStateCount;y[0]=0,y[1]=0,y[2]=0;let A=r;for(;A>=0&&f.get(a,A)&&y[1]<=l;)y[1]++,A--;if(A<0||y[1]>l)return NaN;for(;A>=0&&!f.get(a,A)&&y[0]<=l;)y[0]++,A--;if(y[0]>l)return NaN;for(A=r+1;A<m&&f.get(a,A)&&y[1]<=l;)y[1]++,A++;if(A===m||y[1]>l)return NaN;for(;A<m&&!f.get(a,A)&&y[2]<=l;)y[2]++,A++;if(y[2]>l)return NaN;const T=y[0]+y[1]+y[2];return 5*Math.abs(T-u)>=2*u?NaN:this.foundPatternCross(y)?oi.centerFromEnd(y,A):NaN}handlePossibleCenter(r,a,l){const u=r[0]+r[1]+r[2],f=oi.centerFromEnd(r,l),m=this.crossCheckVertical(a,f,2*r[1],u);if(!isNaN(m)){const y=(r[0]+r[1]+r[2])/3;for(const T of this.possibleCenters)if(T.aboutEquals(y,m,f))return T.combineEstimate(m,f,y);const A=new Os(f,m,y);this.possibleCenters.push(A),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(A)}return null}}class $s extends Xe{constructor(r,a,l,u){super(r,a),this.estimatedModuleSize=l,this.count=u,u===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,a,l){if(Math.abs(a-this.getY())<=r&&Math.abs(l-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,a,l){const u=this.count+1,f=(this.count*this.getX()+a)/u,m=(this.count*this.getY()+r)/u,y=(this.count*this.estimatedModuleSize+l)/u;return new $s(f,m,y,u)}}class Si{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Fn{constructor(r,a){this.image=r,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=a}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const a=r!=null&&r.get(qe.TRY_HARDER)!==void 0,l=r!=null&&r.get(qe.PURE_BARCODE)!==void 0,u=this.image,f=u.getHeight(),m=u.getWidth();let y=Math.floor(3*f/(4*Fn.MAX_MODULES));(y<Fn.MIN_SKIP||a)&&(y=Fn.MIN_SKIP);let A=!1;const T=new Int32Array(5);for(let k=y-1;k<f&&!A;k+=y){T[0]=0,T[1]=0,T[2]=0,T[3]=0,T[4]=0;let L=0;for(let G=0;G<m;G++)if(u.get(G,k))(L&1)===1&&L++,T[L]++;else if((L&1)===0)if(L===4)if(Fn.foundPatternCross(T)){if(this.handlePossibleCenter(T,k,G,l)===!0)if(y=2,this.hasSkipped===!0)A=this.haveMultiplyConfirmedCenters();else{const J=this.findRowSkip();J>T[2]&&(k+=J-T[2]-y,G=m-1)}else{T[0]=T[2],T[1]=T[3],T[2]=T[4],T[3]=1,T[4]=0,L=3;continue}L=0,T[0]=0,T[1]=0,T[2]=0,T[3]=0,T[4]=0}else T[0]=T[2],T[1]=T[3],T[2]=T[4],T[3]=1,T[4]=0,L=3;else T[++L]++;else T[L]++;Fn.foundPatternCross(T)&&this.handlePossibleCenter(T,k,m,l)===!0&&(y=T[0],this.hasSkipped&&(A=this.haveMultiplyConfirmedCenters()))}const I=this.selectBestPatterns();return Xe.orderBestPatterns(I),new Si(I)}static centerFromEnd(r,a){return a-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let a=0;for(let f=0;f<5;f++){const m=r[f];if(m===0)return!1;a+=m}if(a<7)return!1;const l=a/7,u=l/2;return Math.abs(l-r[0])<u&&Math.abs(l-r[1])<u&&Math.abs(3*l-r[2])<3*u&&Math.abs(l-r[3])<u&&Math.abs(l-r[4])<u}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,a,l,u){const f=this.getCrossCheckStateCount();let m=0;const y=this.image;for(;r>=m&&a>=m&&y.get(a-m,r-m);)f[2]++,m++;if(r<m||a<m)return!1;for(;r>=m&&a>=m&&!y.get(a-m,r-m)&&f[1]<=l;)f[1]++,m++;if(r<m||a<m||f[1]>l)return!1;for(;r>=m&&a>=m&&y.get(a-m,r-m)&&f[0]<=l;)f[0]++,m++;if(f[0]>l)return!1;const A=y.getHeight(),T=y.getWidth();for(m=1;r+m<A&&a+m<T&&y.get(a+m,r+m);)f[2]++,m++;if(r+m>=A||a+m>=T)return!1;for(;r+m<A&&a+m<T&&!y.get(a+m,r+m)&&f[3]<l;)f[3]++,m++;if(r+m>=A||a+m>=T||f[3]>=l)return!1;for(;r+m<A&&a+m<T&&y.get(a+m,r+m)&&f[4]<l;)f[4]++,m++;if(f[4]>=l)return!1;const I=f[0]+f[1]+f[2]+f[3]+f[4];return Math.abs(I-u)<2*u&&Fn.foundPatternCross(f)}crossCheckVertical(r,a,l,u){const f=this.image,m=f.getHeight(),y=this.getCrossCheckStateCount();let A=r;for(;A>=0&&f.get(a,A);)y[2]++,A--;if(A<0)return NaN;for(;A>=0&&!f.get(a,A)&&y[1]<=l;)y[1]++,A--;if(A<0||y[1]>l)return NaN;for(;A>=0&&f.get(a,A)&&y[0]<=l;)y[0]++,A--;if(y[0]>l)return NaN;for(A=r+1;A<m&&f.get(a,A);)y[2]++,A++;if(A===m)return NaN;for(;A<m&&!f.get(a,A)&&y[3]<l;)y[3]++,A++;if(A===m||y[3]>=l)return NaN;for(;A<m&&f.get(a,A)&&y[4]<l;)y[4]++,A++;if(y[4]>=l)return NaN;const T=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(T-u)>=2*u?NaN:Fn.foundPatternCross(y)?Fn.centerFromEnd(y,A):NaN}crossCheckHorizontal(r,a,l,u){const f=this.image,m=f.getWidth(),y=this.getCrossCheckStateCount();let A=r;for(;A>=0&&f.get(A,a);)y[2]++,A--;if(A<0)return NaN;for(;A>=0&&!f.get(A,a)&&y[1]<=l;)y[1]++,A--;if(A<0||y[1]>l)return NaN;for(;A>=0&&f.get(A,a)&&y[0]<=l;)y[0]++,A--;if(y[0]>l)return NaN;for(A=r+1;A<m&&f.get(A,a);)y[2]++,A++;if(A===m)return NaN;for(;A<m&&!f.get(A,a)&&y[3]<l;)y[3]++,A++;if(A===m||y[3]>=l)return NaN;for(;A<m&&f.get(A,a)&&y[4]<l;)y[4]++,A++;if(y[4]>=l)return NaN;const T=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(T-u)>=u?NaN:Fn.foundPatternCross(y)?Fn.centerFromEnd(y,A):NaN}handlePossibleCenter(r,a,l,u){const f=r[0]+r[1]+r[2]+r[3]+r[4];let m=Fn.centerFromEnd(r,l),y=this.crossCheckVertical(a,Math.floor(m),r[2],f);if(!isNaN(y)&&(m=this.crossCheckHorizontal(Math.floor(m),Math.floor(y),r[2],f),!isNaN(m)&&(!u||this.crossCheckDiagonal(Math.floor(y),Math.floor(m),r[2],f)))){const A=f/7;let T=!1;const I=this.possibleCenters;for(let k=0,L=I.length;k<L;k++){const G=I[k];if(G.aboutEquals(A,y,m)){I[k]=G.combineEstimate(y,m,A),T=!0;break}}if(!T){const k=new $s(m,y,A);I.push(k),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(k)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let a=null;for(const l of this.possibleCenters)if(l.getCount()>=Fn.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,a=0;const l=this.possibleCenters.length;for(const m of this.possibleCenters)m.getCount()>=Fn.CENTER_QUORUM&&(r++,a+=m.getEstimatedModuleSize());if(r<3)return!1;const u=a/l;let f=0;for(const m of this.possibleCenters)f+=Math.abs(m.getEstimatedModuleSize()-u);return f<=.05*a}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new ae;const a=this.possibleCenters;let l;if(r>3){let u=0,f=0;for(const A of this.possibleCenters){const T=A.getEstimatedModuleSize();u+=T,f+=T*T}l=u/r;let m=Math.sqrt(f/r-l*l);a.sort((A,T)=>{const I=Math.abs(T.getEstimatedModuleSize()-l),k=Math.abs(A.getEstimatedModuleSize()-l);return I<k?-1:I>k?1:0});const y=Math.max(.2*l,m);for(let A=0;A<a.length&&a.length>3;A++){const T=a[A];Math.abs(T.getEstimatedModuleSize()-l)>y&&(a.splice(A,1),A--)}}if(a.length>3){let u=0;for(const f of a)u+=f.getEstimatedModuleSize();l=u/a.length,a.sort((f,m)=>{if(m.getCount()===f.getCount()){const y=Math.abs(m.getEstimatedModuleSize()-l),A=Math.abs(f.getEstimatedModuleSize()-l);return y<A?1:y>A?-1:0}else return m.getCount()-f.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]}}Fn.CENTER_QUORUM=2,Fn.MIN_SKIP=3,Fn.MAX_MODULES=57;class li{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(qe.NEED_RESULT_POINT_CALLBACK);const l=new Fn(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(l)}processFinderPatternInfo(r){const a=r.getTopLeft(),l=r.getTopRight(),u=r.getBottomLeft(),f=this.calculateModuleSize(a,l,u);if(f<1)throw new ae("No pattern found in proccess finder.");const m=li.computeDimension(a,l,u,f),y=ot.getProvisionalVersionForDimension(m),A=y.getDimensionForVersion()-7;let T=null;if(y.getAlignmentPatternCenters().length>0){const G=l.getX()-a.getX()+u.getX(),Q=l.getY()-a.getY()+u.getY(),J=1-3/A,se=Math.floor(a.getX()+J*(G-a.getX())),ye=Math.floor(a.getY()+J*(Q-a.getY()));for(let Ue=4;Ue<=16;Ue<<=1)try{T=this.findAlignmentInRegion(f,se,ye,Ue);break}catch(Be){if(!(Be instanceof ae))throw Be}}const I=li.createTransform(a,l,u,T,m),k=li.sampleGrid(this.image,I,m);let L;return T===null?L=[u,a,l]:L=[u,a,l,T],new Ur(k,L)}static createTransform(r,a,l,u,f){const m=f-3.5;let y,A,T,I;return u!==null?(y=u.getX(),A=u.getY(),T=m-3,I=T):(y=a.getX()-r.getX()+l.getX(),A=a.getY()-r.getY()+l.getY(),T=m,I=m),Re.quadrilateralToQuadrilateral(3.5,3.5,m,3.5,T,I,3.5,m,r.getX(),r.getY(),a.getX(),a.getY(),y,A,l.getX(),l.getY())}static sampleGrid(r,a,l){return Je.getInstance().sampleGridWithTransform(r,l,l,a)}static computeDimension(r,a,l,u){const f=Qe.round(Xe.distance(r,a)/u),m=Qe.round(Xe.distance(r,l)/u);let y=Math.floor((f+m)/2)+7;switch(y&3){case 0:y++;break;case 2:y--;break;case 3:throw new ae("Dimensions could be not found.")}return y}calculateModuleSize(r,a,l){return(this.calculateModuleSizeOneWay(r,a)+this.calculateModuleSizeOneWay(r,l))/2}calculateModuleSizeOneWay(r,a){const l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(a.getX()),Math.floor(a.getY())),u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(l)?u/7:isNaN(u)?l/7:(l+u)/14}sizeOfBlackWhiteBlackRunBothWays(r,a,l,u){let f=this.sizeOfBlackWhiteBlackRun(r,a,l,u),m=1,y=r-(l-r);y<0?(m=r/(r-y),y=0):y>=this.image.getWidth()&&(m=(this.image.getWidth()-1-r)/(y-r),y=this.image.getWidth()-1);let A=Math.floor(a-(u-a)*m);return m=1,A<0?(m=a/(a-A),A=0):A>=this.image.getHeight()&&(m=(this.image.getHeight()-1-a)/(A-a),A=this.image.getHeight()-1),y=Math.floor(r+(y-r)*m),f+=this.sizeOfBlackWhiteBlackRun(r,a,y,A),f-1}sizeOfBlackWhiteBlackRun(r,a,l,u){const f=Math.abs(u-a)>Math.abs(l-r);if(f){let G=r;r=a,a=G,G=l,l=u,u=G}const m=Math.abs(l-r),y=Math.abs(u-a);let A=-m/2;const T=r<l?1:-1,I=a<u?1:-1;let k=0;const L=l+T;for(let G=r,Q=a;G!==L;G+=T){const J=f?Q:G,se=f?G:Q;if(k===1===this.image.get(J,se)){if(k===2)return Qe.distance(G,Q,r,a);k++}if(A+=y,A>0){if(Q===u)break;Q+=I,A-=m}}return k===2?Qe.distance(l+T,u,r,a):NaN}findAlignmentInRegion(r,a,l,u){const f=Math.floor(u*r),m=Math.max(0,a-f),y=Math.min(this.image.getWidth()-1,a+f);if(y-m<r*3)throw new ae("Alignment top exceeds estimated module size.");const A=Math.max(0,l-f),T=Math.min(this.image.getHeight()-1,l+f);if(T-A<r*3)throw new ae("Alignment bottom exceeds estimated module size.");return new oi(this.image,m,A,y-m,T-A,r,this.resultPointCallback).find()}}class ci{constructor(){this.decoder=new Ns}getDecoder(){return this.decoder}decode(r,a){let l,u;if(a!=null&&a.get(qe.PURE_BARCODE)!==void 0){const A=ci.extractPureBits(r.getBlackMatrix());l=this.decoder.decodeBitMatrix(A,a),u=ci.NO_POINTS}else{const A=new li(r.getBlackMatrix()).detect(a);l=this.decoder.decodeBitMatrix(A.getBits(),a),u=A.getPoints()}l.getOther()instanceof Vo&&l.getOther().applyMirroredCorrection(u);const f=new Ve(l.getText(),l.getRawBytes(),void 0,u,we.QR_CODE,void 0),m=l.getByteSegments();m!==null&&f.putMetadata(xt.BYTE_SEGMENTS,m);const y=l.getECLevel();return y!==null&&f.putMetadata(xt.ERROR_CORRECTION_LEVEL,y),l.hasStructuredAppend()&&(f.putMetadata(xt.STRUCTURED_APPEND_SEQUENCE,l.getStructuredAppendSequenceNumber()),f.putMetadata(xt.STRUCTURED_APPEND_PARITY,l.getStructuredAppendParity())),f}reset(){}static extractPureBits(r){const a=r.getTopLeftOnBit(),l=r.getBottomRightOnBit();if(a===null||l===null)throw new ae;const u=this.moduleSize(a,r);let f=a[1],m=l[1],y=a[0],A=l[0];if(y>=A||f>=m)throw new ae;if(m-f!==A-y&&(A=y+(m-f),A>=r.getWidth()))throw new ae;const T=Math.round((A-y+1)/u),I=Math.round((m-f+1)/u);if(T<=0||I<=0)throw new ae;if(I!==T)throw new ae;const k=Math.floor(u/2);f+=k,y+=k;const L=y+Math.floor((T-1)*u)-A;if(L>0){if(L>k)throw new ae;y-=L}const G=f+Math.floor((I-1)*u)-m;if(G>0){if(G>k)throw new ae;f-=G}const Q=new rt(T,I);for(let J=0;J<I;J++){const se=f+Math.floor(J*u);for(let ye=0;ye<T;ye++)r.get(y+Math.floor(ye*u),se)&&Q.set(ye,J)}return Q}static moduleSize(r,a){const l=a.getHeight(),u=a.getWidth();let f=r[0],m=r[1],y=!0,A=0;for(;f<u&&m<l;){if(y!==a.get(f,m)){if(++A===5)break;y=!y}f++,m++}if(f===u||m===l)throw new ae;return(f-r[0])/7}}ci.NO_POINTS=new Array;class _t{PDF417Common(){}static getBitCountSum(r){return Qe.sum(r)}static toIntArray(r){if(r==null||!r.length)return _t.EMPTY_INT_ARRAY;const a=new Int32Array(r.length);let l=0;for(const u of r)a[l++]=u;return a}static getCodeword(r){const a=ke.binarySearch(_t.SYMBOL_TABLE,r&262143);return a<0?-1:(_t.CODEWORD_TABLE[a]-1)%_t.NUMBER_OF_CODEWORDS}}_t.NUMBER_OF_CODEWORDS=929,_t.MAX_CODEWORDS_IN_BARCODE=_t.NUMBER_OF_CODEWORDS-1,_t.MIN_ROWS_IN_BARCODE=3,_t.MAX_ROWS_IN_BARCODE=90,_t.MODULES_IN_CODEWORD=17,_t.MODULES_IN_STOP_PATTERN=18,_t.BARS_IN_MODULE=8,_t.EMPTY_INT_ARRAY=new Int32Array([]),_t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),_t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Ds{constructor(r,a){this.bits=r,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class vt{static detectMultiple(r,a,l){let u=r.getBlackMatrix(),f=vt.detect(l,u);return f.length||(u=u.clone(),u.rotate180(),f=vt.detect(l,u)),new Ds(u,f)}static detect(r,a){const l=new Array;let u=0,f=0,m=!1;for(;u<a.getHeight();){const y=vt.findVertices(a,u,f);if(y[0]==null&&y[3]==null){if(!m)break;m=!1,f=0;for(const A of l)A[1]!=null&&(u=Math.trunc(Math.max(u,A[1].getY()))),A[3]!=null&&(u=Math.max(u,Math.trunc(A[3].getY())));u+=vt.ROW_STEP;continue}if(m=!0,l.push(y),!r)break;y[2]!=null?(f=Math.trunc(y[2].getX()),u=Math.trunc(y[2].getY())):(f=Math.trunc(y[4].getX()),u=Math.trunc(y[4].getY()))}return l}static findVertices(r,a,l){const u=r.getHeight(),f=r.getWidth(),m=new Array(8);return vt.copyToResult(m,vt.findRowsWithPattern(r,u,f,a,l,vt.START_PATTERN),vt.INDEXES_START_PATTERN),m[4]!=null&&(l=Math.trunc(m[4].getX()),a=Math.trunc(m[4].getY())),vt.copyToResult(m,vt.findRowsWithPattern(r,u,f,a,l,vt.STOP_PATTERN),vt.INDEXES_STOP_PATTERN),m}static copyToResult(r,a,l){for(let u=0;u<l.length;u++)r[l[u]]=a[u]}static findRowsWithPattern(r,a,l,u,f,m){const y=new Array(4);let A=!1;const T=new Int32Array(m.length);for(;u<a;u+=vt.ROW_STEP){let k=vt.findGuardPattern(r,f,u,l,!1,m,T);if(k!=null){for(;u>0;){const L=vt.findGuardPattern(r,f,--u,l,!1,m,T);if(L!=null)k=L;else{u++;break}}y[0]=new Xe(k[0],u),y[1]=new Xe(k[1],u),A=!0;break}}let I=u+1;if(A){let k=0,L=Int32Array.from([Math.trunc(y[0].getX()),Math.trunc(y[1].getX())]);for(;I<a;I++){const G=vt.findGuardPattern(r,L[0],I,l,!1,m,T);if(G!=null&&Math.abs(L[0]-G[0])<vt.MAX_PATTERN_DRIFT&&Math.abs(L[1]-G[1])<vt.MAX_PATTERN_DRIFT)L=G,k=0;else{if(k>vt.SKIPPED_ROW_COUNT_MAX)break;k++}}I-=k+1,y[2]=new Xe(L[0],I),y[3]=new Xe(L[1],I)}return I-u<vt.BARCODE_MIN_HEIGHT&&ke.fill(y,null),y}static findGuardPattern(r,a,l,u,f,m,y){ke.fillWithin(y,0,y.length,0);let A=a,T=0;for(;r.get(A,l)&&A>0&&T++<vt.MAX_PIXEL_DRIFT;)A--;let I=A,k=0,L=m.length;for(let G=f;I<u;I++)if(r.get(I,l)!==G)y[k]++;else{if(k===L-1){if(vt.patternMatchVariance(y,m,vt.MAX_INDIVIDUAL_VARIANCE)<vt.MAX_AVG_VARIANCE)return new Int32Array([A,I]);A+=y[0]+y[1],oe.arraycopy(y,2,y,0,k-1),y[k-1]=0,y[k]=0,k--}else k++;y[k]=1,G=!G}return k===L-1&&vt.patternMatchVariance(y,m,vt.MAX_INDIVIDUAL_VARIANCE)<vt.MAX_AVG_VARIANCE?new Int32Array([A,I-1]):null}static patternMatchVariance(r,a,l){let u=r.length,f=0,m=0;for(let T=0;T<u;T++)f+=r[T],m+=a[T];if(f<m)return 1/0;let y=f/m;l*=y;let A=0;for(let T=0;T<u;T++){let I=r[T],k=a[T]*y,L=I>k?I-k:k-I;if(L>l)return 1/0;A+=L}return A/f}}vt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),vt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),vt.MAX_AVG_VARIANCE=.42,vt.MAX_INDIVIDUAL_VARIANCE=.8,vt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),vt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),vt.MAX_PIXEL_DRIFT=3,vt.MAX_PATTERN_DRIFT=5,vt.SKIPPED_ROW_COUNT_MAX=25,vt.ROW_STEP=5,vt.BARCODE_MIN_HEIGHT=10;class Sn{constructor(r,a){if(a.length===0)throw new N;this.field=r;let l=a.length;if(l>1&&a[0]===0){let u=1;for(;u<l&&a[u]===0;)u++;u===l?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(l-u),oe.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let u=0;for(let f of this.coefficients)u=this.field.add(u,f);return u}let a=this.coefficients[0],l=this.coefficients.length;for(let u=1;u<l;u++)a=this.field.add(this.field.multiply(r,a),this.coefficients[u]);return a}add(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let a=this.coefficients,l=r.coefficients;if(a.length>l.length){let m=a;a=l,l=m}let u=new Int32Array(l.length),f=l.length-a.length;oe.arraycopy(l,0,u,0,f);for(let m=f;m<l.length;m++)u[m]=this.field.add(a[m-f],l[m]);return new Sn(this.field,u)}subtract(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof Sn?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new Sn(this.field,new Int32Array([0]));let a=this.coefficients,l=a.length,u=r.coefficients,f=u.length,m=new Int32Array(l+f-1);for(let y=0;y<l;y++){let A=a[y];for(let T=0;T<f;T++)m[y+T]=this.field.add(m[y+T],this.field.multiply(A,u[T]))}return new Sn(this.field,m)}negative(){let r=this.coefficients.length,a=new Int32Array(r);for(let l=0;l<r;l++)a[l]=this.field.subtract(0,this.coefficients[l]);return new Sn(this.field,a)}multiplyScalar(r){if(r===0)return new Sn(this.field,new Int32Array([0]));if(r===1)return this;let a=this.coefficients.length,l=new Int32Array(a);for(let u=0;u<a;u++)l[u]=this.field.multiply(this.coefficients[u],r);return new Sn(this.field,l)}multiplyByMonomial(r,a){if(r<0)throw new N;if(a===0)return new Sn(this.field,new Int32Array([0]));let l=this.coefficients.length,u=new Int32Array(l+r);for(let f=0;f<l;f++)u[f]=this.field.multiply(this.coefficients[f],a);return new Sn(this.field,u)}toString(){let r=new H;for(let a=this.getDegree();a>=0;a--){let l=this.getCoefficient(a);l!==0&&(l<0?(r.append(" - "),l=-l):r.length()>0&&r.append(" + "),(a===0||l!==1)&&r.append(l),a!==0&&(a===1?r.append("x"):(r.append("x^"),r.append(a))))}return r.toString()}}class ea{add(r,a){return(r+a)%this.modulus}subtract(r,a){return(this.modulus+r-a)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new N;return this.logTable[r]}inverse(r){if(r===0)throw new $e;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,a){return r===0||a===0?0:this.expTable[(this.logTable[r]+this.logTable[a])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class wn extends ea{constructor(r,a){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let l=1;for(let u=0;u<r;u++)this.expTable[u]=l,l=l*a%r;for(let u=0;u<r-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new Sn(this,new Int32Array([0])),this.one=new Sn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,a){if(r<0)throw new N;if(a===0)return this.zero;let l=new Int32Array(r+1);return l[0]=a,new Sn(this,l)}}wn.PDF417_GF=new wn(_t.NUMBER_OF_CODEWORDS,3);class Fi{constructor(){this.field=wn.PDF417_GF}decode(r,a,l){let u=new Sn(this.field,r),f=new Int32Array(a),m=!1;for(let Q=a;Q>0;Q--){let J=u.evaluateAt(this.field.exp(Q));f[a-Q]=J,J!==0&&(m=!0)}if(!m)return 0;let y=this.field.getOne();if(l!=null)for(const Q of l){let J=this.field.exp(r.length-1-Q),se=new Sn(this.field,new Int32Array([this.field.subtract(0,J),1]));y=y.multiply(se)}let A=new Sn(this.field,f),T=this.runEuclideanAlgorithm(this.field.buildMonomial(a,1),A,a),I=T[0],k=T[1],L=this.findErrorLocations(I),G=this.findErrorMagnitudes(k,I,L);for(let Q=0;Q<L.length;Q++){let J=r.length-1-this.field.log(L[Q]);if(J<0)throw X.getChecksumInstance();r[J]=this.field.subtract(r[J],G[Q])}return L.length}runEuclideanAlgorithm(r,a,l){if(r.getDegree()<a.getDegree()){let L=r;r=a,a=L}let u=r,f=a,m=this.field.getZero(),y=this.field.getOne();for(;f.getDegree()>=Math.round(l/2);){let L=u,G=m;if(u=f,m=y,u.isZero())throw X.getChecksumInstance();f=L;let Q=this.field.getZero(),J=u.getCoefficient(u.getDegree()),se=this.field.inverse(J);for(;f.getDegree()>=u.getDegree()&&!f.isZero();){let ye=f.getDegree()-u.getDegree(),Ue=this.field.multiply(f.getCoefficient(f.getDegree()),se);Q=Q.add(this.field.buildMonomial(ye,Ue)),f=f.subtract(u.multiplyByMonomial(ye,Ue))}y=Q.multiply(m).subtract(G).negative()}let A=y.getCoefficient(0);if(A===0)throw X.getChecksumInstance();let T=this.field.inverse(A),I=y.multiply(T),k=f.multiply(T);return[I,k]}findErrorLocations(r){let a=r.getDegree(),l=new Int32Array(a),u=0;for(let f=1;f<this.field.getSize()&&u<a;f++)r.evaluateAt(f)===0&&(l[u]=this.field.inverse(f),u++);if(u!==a)throw X.getChecksumInstance();return l}findErrorMagnitudes(r,a,l){let u=a.getDegree(),f=new Int32Array(u);for(let T=1;T<=u;T++)f[u-T]=this.field.multiply(T,a.getCoefficient(T));let m=new Sn(this.field,f),y=l.length,A=new Int32Array(y);for(let T=0;T<y;T++){let I=this.field.inverse(l[T]),k=this.field.subtract(0,r.evaluateAt(I)),L=this.field.inverse(m.evaluateAt(I));A[T]=this.field.multiply(k,L)}return A}}class ji{constructor(r,a,l,u,f){r instanceof ji?this.constructor_2(r):this.constructor_1(r,a,l,u,f)}constructor_1(r,a,l,u,f){const m=a==null||l==null,y=u==null||f==null;if(m&&y)throw new ae;m?(a=new Xe(0,u.getY()),l=new Xe(0,f.getY())):y&&(u=new Xe(r.getWidth()-1,a.getY()),f=new Xe(r.getWidth()-1,l.getY())),this.image=r,this.topLeft=a,this.bottomLeft=l,this.topRight=u,this.bottomRight=f,this.minX=Math.trunc(Math.min(a.getX(),l.getX())),this.maxX=Math.trunc(Math.max(u.getX(),f.getX())),this.minY=Math.trunc(Math.min(a.getY(),u.getY())),this.maxY=Math.trunc(Math.max(l.getY(),f.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,a){return r==null?a:a==null?r:new ji(r.image,r.topLeft,r.bottomLeft,a.topRight,a.bottomRight)}addMissingRows(r,a,l){let u=this.topLeft,f=this.bottomLeft,m=this.topRight,y=this.bottomRight;if(r>0){let A=l?this.topLeft:this.topRight,T=Math.trunc(A.getY()-r);T<0&&(T=0);let I=new Xe(A.getX(),T);l?u=I:m=I}if(a>0){let A=l?this.bottomLeft:this.bottomRight,T=Math.trunc(A.getY()+a);T>=this.image.getHeight()&&(T=this.image.getHeight()-1);let I=new Xe(A.getX(),T);l?f=I:y=I}return new ji(this.image,u,f,m,y)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class ta{constructor(r,a,l,u){this.columnCount=r,this.errorCorrectionLevel=u,this.rowCountUpperPart=a,this.rowCountLowerPart=l,this.rowCount=a+l}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class xs{constructor(){this.buffer=""}static form(r,a){let l=-1;function u(m,y,A,T,I,k){if(m==="%%")return"%";if(a[++l]===void 0)return;m=T?parseInt(T.substr(1)):void 0;let L=I?parseInt(I.substr(1)):void 0,G;switch(k){case"s":G=a[l];break;case"c":G=a[l][0];break;case"f":G=parseFloat(a[l]).toFixed(m);break;case"p":G=parseFloat(a[l]).toPrecision(m);break;case"e":G=parseFloat(a[l]).toExponential(m);break;case"x":G=parseInt(a[l]).toString(L||16);break;case"d":G=parseFloat(parseInt(a[l],L||10).toPrecision(m)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(L);let Q=parseInt(A),J=A&&A[0]+""=="0"?"0":" ";for(;G.length<Q;)G=y!==void 0?G+J:J+G;return G}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(f,u)}format(r,...a){this.buffer+=xs.form(r,a)}toString(){return this.buffer}}class zi{constructor(r){this.boundingBox=new ji(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let a=this.getCodeword(r);if(a!=null)return a;for(let l=1;l<zi.MAX_NEARBY_DISTANCE;l++){let u=this.imageRowToCodewordIndex(r)-l;if(u>=0&&(a=this.codewords[u],a!=null)||(u=this.imageRowToCodewordIndex(r)+l,u<this.codewords.length&&(a=this.codewords[u],a!=null)))return a}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,a){this.codewords[this.imageRowToCodewordIndex(r)]=a}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new xs;let a=0;for(const l of this.codewords){if(l==null){r.format("%3d:    |   %n",a++);continue}r.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}return r.toString()}}zi.MAX_NEARBY_DISTANCE=5;class yi{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let a=this.values.get(r);a==null&&(a=0),a++,this.values.set(r,a)}getValue(){let r=-1,a=new Array;for(const[l,u]of this.values.entries()){const f={getKey:()=>l,getValue:()=>u};f.getValue()>r?(r=f.getValue(),a=[],a.push(f.getKey())):f.getValue()===r&&a.push(f.getKey())}return _t.toIntArray(a)}getConfidence(r){return this.values.get(r)}}class Ii extends zi{constructor(r,a){super(r),this._isLeft=a}setRowNumbers(){for(let r of this.getCodewords())r?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let a=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(a,r);let l=this.getBoundingBox(),u=this._isLeft?l.getTopLeft():l.getTopRight(),f=this._isLeft?l.getBottomLeft():l.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.imageRowToCodewordIndex(Math.trunc(f.getY())),A=-1,T=1,I=0;for(let k=m;k<y;k++){if(a[k]==null)continue;let L=a[k],G=L.getRowNumber()-A;if(G===0)I++;else if(G===1)T=Math.max(T,I),I=1,A=L.getRowNumber();else if(G<0||L.getRowNumber()>=r.getRowCount()||G>k)a[k]=null;else{let Q;T>2?Q=(T-2)*G:Q=G;let J=Q>=k;for(let se=1;se<=Q&&!J;se++)J=a[k-se]!=null;J?a[k]=null:(A=L.getRowNumber(),I=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let a=new Int32Array(r.getRowCount());for(let l of this.getCodewords())if(l!=null){let u=l.getRowNumber();if(u>=a.length)continue;a[u]++}return a}adjustIncompleteIndicatorColumnRowNumbers(r){let a=this.getBoundingBox(),l=this._isLeft?a.getTopLeft():a.getTopRight(),u=this._isLeft?a.getBottomLeft():a.getBottomRight(),f=this.imageRowToCodewordIndex(Math.trunc(l.getY())),m=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.getCodewords(),A=-1;for(let T=f;T<m;T++){if(y[T]==null)continue;let I=y[T];I.setRowNumberAsRowIndicatorColumn();let k=I.getRowNumber()-A;k===0||(k===1?A=I.getRowNumber():I.getRowNumber()>=r.getRowCount()?y[T]=null:A=I.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),a=new yi,l=new yi,u=new yi,f=new yi;for(let y of r){if(y==null)continue;y.setRowNumberAsRowIndicatorColumn();let A=y.getValue()%30,T=y.getRowNumber();switch(this._isLeft||(T+=2),T%3){case 0:l.setValue(A*3+1);break;case 1:f.setValue(A/3),u.setValue(A%3);break;case 2:a.setValue(A+1);break}}if(a.getValue().length===0||l.getValue().length===0||u.getValue().length===0||f.getValue().length===0||a.getValue()[0]<1||l.getValue()[0]+u.getValue()[0]<_t.MIN_ROWS_IN_BARCODE||l.getValue()[0]+u.getValue()[0]>_t.MAX_ROWS_IN_BARCODE)return null;let m=new ta(a.getValue()[0],l.getValue()[0],u.getValue()[0],f.getValue()[0]);return this.removeIncorrectCodewords(r,m),m}removeIncorrectCodewords(r,a){for(let l=0;l<r.length;l++){let u=r[l];if(r[l]==null)continue;let f=u.getValue()%30,m=u.getRowNumber();if(m>a.getRowCount()){r[l]=null;continue}switch(this._isLeft||(m+=2),m%3){case 0:f*3+1!==a.getRowCountUpperPart()&&(r[l]=null);break;case 1:(Math.trunc(f/3)!==a.getErrorCorrectionLevel()||f%3!==a.getRowCountLowerPart())&&(r[l]=null);break;case 2:f+1!==a.getColumnCount()&&(r[l]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class cr{constructor(r,a){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=a,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=_t.MAX_CODEWORDS_IN_BARCODE,a;do a=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<a);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let a=1;a<this.barcodeColumnCount+1;a++){let l=this.detectionResultColumns[a].getCodewords();for(let u=0;u<l.length;u++)l[u]!=null&&(l[u].hasValidRowNumber()||this.adjustRowNumbers(a,u,l))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<r.length;l++)if(r[l]!=null&&a[l]!=null&&r[l].getRowNumber()===a[l].getRowNumber())for(let u=1;u<=this.barcodeColumnCount;u++){let f=this.detectionResultColumns[u].getCodewords()[l];f!=null&&(f.setRowNumber(r[l].getRowNumber()),f.hasValidRowNumber()||(this.detectionResultColumns[u].getCodewords()[l]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<a.length;l++){if(a[l]==null)continue;let u=a[l].getRowNumber(),f=0;for(let m=this.barcodeColumnCount+1;m>0&&f<this.ADJUST_ROW_NUMBER_SKIP;m--){let y=this.detectionResultColumns[m].getCodewords()[l];y!=null&&(f=cr.adjustRowNumberIfValid(u,f,y),y.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,a=this.detectionResultColumns[0].getCodewords();for(let l=0;l<a.length;l++){if(a[l]==null)continue;let u=a[l].getRowNumber(),f=0;for(let m=1;m<this.barcodeColumnCount+1&&f<this.ADJUST_ROW_NUMBER_SKIP;m++){let y=this.detectionResultColumns[m].getCodewords()[l];y!=null&&(f=cr.adjustRowNumberIfValid(u,f,y),y.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,a,l){return l==null||l.hasValidRowNumber()||(l.isValidRowNumber(r)?(l.setRowNumber(r),a=0):++a),a}adjustRowNumbers(r,a,l){if(!this.detectionResultColumns[r-1])return;let u=l[a],f=this.detectionResultColumns[r-1].getCodewords(),m=f;this.detectionResultColumns[r+1]!=null&&(m=this.detectionResultColumns[r+1].getCodewords());let y=new Array(14);y[2]=f[a],y[3]=m[a],a>0&&(y[0]=l[a-1],y[4]=f[a-1],y[5]=m[a-1]),a>1&&(y[8]=l[a-2],y[10]=f[a-2],y[11]=m[a-2]),a<l.length-1&&(y[1]=l[a+1],y[6]=f[a+1],y[7]=m[a+1]),a<l.length-2&&(y[9]=l[a+2],y[12]=f[a+2],y[13]=m[a+2]);for(let A of y)if(cr.adjustRowNumber(u,A))return}static adjustRowNumber(r,a){return a==null?!1:a.hasValidRowNumber()&&a.getBucket()===r.getBucket()?(r.setRowNumber(a.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,a){this.detectionResultColumns[r]=a}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let a=new xs;for(let l=0;l<r.getCodewords().length;l++){a.format("CW %3d:",l);for(let u=0;u<this.barcodeColumnCount+2;u++){if(this.detectionResultColumns[u]==null){a.format("    |   ");continue}let f=this.detectionResultColumns[u].getCodewords()[l];if(f==null){a.format("    |   ");continue}a.format(" %3d|%3d",f.getRowNumber(),f.getValue())}a.format("%n")}return a.toString()}}class Ei{constructor(r,a,l,u){this.rowNumber=Ei.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(a),this.bucket=Math.trunc(l),this.value=Math.trunc(u)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==Ei.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}Ei.BARCODE_ROW_UNKNOWN=-1;class Kn{static initialize(){for(let r=0;r<_t.SYMBOL_TABLE.length;r++){let a=_t.SYMBOL_TABLE[r],l=a&1;for(let u=0;u<_t.BARS_IN_MODULE;u++){let f=0;for(;(a&1)===l;)f+=1,a>>=1;l=a&1,Kn.RATIOS_TABLE[r]||(Kn.RATIOS_TABLE[r]=new Array(_t.BARS_IN_MODULE)),Kn.RATIOS_TABLE[r][_t.BARS_IN_MODULE-u-1]=Math.fround(f/_t.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let a=Kn.getDecodedCodewordValue(Kn.sampleBitCounts(r));return a!==-1?a:Kn.getClosestDecodedValue(r)}static sampleBitCounts(r){let a=Qe.sum(r),l=new Int32Array(_t.BARS_IN_MODULE),u=0,f=0;for(let m=0;m<_t.MODULES_IN_CODEWORD;m++){let y=a/(2*_t.MODULES_IN_CODEWORD)+m*a/_t.MODULES_IN_CODEWORD;f+r[u]<=y&&(f+=r[u],u++),l[u]++}return l}static getDecodedCodewordValue(r){let a=Kn.getBitValue(r);return _t.getCodeword(a)===-1?-1:a}static getBitValue(r){let a=0;for(let l=0;l<r.length;l++)for(let u=0;u<r[l];u++)a=a<<1|(l%2===0?1:0);return Math.trunc(a)}static getClosestDecodedValue(r){let a=Qe.sum(r),l=new Array(_t.BARS_IN_MODULE);if(a>1)for(let m=0;m<l.length;m++)l[m]=Math.fround(r[m]/a);let u=en.MAX_VALUE,f=-1;this.bSymbolTableReady||Kn.initialize();for(let m=0;m<Kn.RATIOS_TABLE.length;m++){let y=0,A=Kn.RATIOS_TABLE[m];for(let T=0;T<_t.BARS_IN_MODULE;T++){let I=Math.fround(A[T]-l[T]);if(y+=Math.fround(I*I),y>=u)break}y<u&&(u=y,f=_t.SYMBOL_TABLE[m])}return f}}Kn.bSymbolTableReady=!1,Kn.RATIOS_TABLE=new Array(_t.SYMBOL_TABLE.length).map(M=>new Array(_t.BARS_IN_MODULE));class _s{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class Ba{static parseLong(r,a=void 0){return parseInt(r,a)}}class As extends _{}As.kind="NullPointerException";class Va{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,a,l){if(r==null)throw new As;if(a<0||a>r.length||l<0||a+l>r.length||a+l<0)throw new ue;if(l===0)return;for(let u=0;u<l;u++)this.write(r[a+u])}flush(){}close(){}}class ns extends _{}class Ua extends Va{constructor(r=32){if(super(),this.count=0,r<0)throw new N("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let l=this.buf.length<<1;if(l-r<0&&(l=r),l<0){if(r<0)throw new ns;l=de.MAX_VALUE}this.buf=ke.copyOfUint8Array(this.buf,l)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,a,l){if(a<0||a>r.length||l<0||a+l-r.length>0)throw new ue;this.ensureCapacity(this.count+l),oe.arraycopy(r,a,this.buf,this.count,l),this.count+=l}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return ke.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var En;(function(M){M[M.ALPHA=0]="ALPHA",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.PUNCT=3]="PUNCT",M[M.ALPHA_SHIFT=4]="ALPHA_SHIFT",M[M.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(En||(En={}));function Ms(){if(typeof window<"u")return window.BigInt||null;if(typeof Wh<"u")return Wh.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let na;function Hi(M){if(typeof na>"u"&&(na=Ms()),na===null)throw new Error("BigInt is not supported!");return na(M)}function ra(){let M=[];M[0]=Hi(1);let r=Hi(900);M[1]=r;for(let a=2;a<16;a++)M[a]=M[a-1]*r;return M}class me{static decode(r,a){let l=new H(""),u=V.ISO8859_1;l.enableDecoding(u);let f=1,m=r[f++],y=new _s;for(;f<r[0];){switch(m){case me.TEXT_COMPACTION_MODE_LATCH:f=me.textCompaction(r,f,l);break;case me.BYTE_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:f=me.byteCompaction(m,r,u,f,l);break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(r[f++]);break;case me.NUMERIC_COMPACTION_MODE_LATCH:f=me.numericCompaction(r,f,l);break;case me.ECI_CHARSET:V.getCharacterSetECIByValue(r[f++]);break;case me.ECI_GENERAL_PURPOSE:f+=2;break;case me.ECI_USER_DEFINED:f++;break;case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:f=me.decodeMacroBlock(r,f,y);break;case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:throw new F;default:f--,f=me.textCompaction(r,f,l);break}if(f<r.length)m=r[f++];else throw F.getFormatInstance()}if(l.length()===0)throw F.getFormatInstance();let A=new Mt(null,l.toString(),null,a);return A.setOther(y),A}static decodeMacroBlock(r,a,l){if(a+me.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw F.getFormatInstance();let u=new Int32Array(me.NUMBER_OF_SEQUENCE_CODEWORDS);for(let y=0;y<me.NUMBER_OF_SEQUENCE_CODEWORDS;y++,a++)u[y]=r[a];l.setSegmentIndex(de.parseInt(me.decodeBase900toBase10(u,me.NUMBER_OF_SEQUENCE_CODEWORDS)));let f=new H;a=me.textCompaction(r,a,f),l.setFileId(f.toString());let m=-1;for(r[a]===me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(m=a+1);a<r[0];)switch(r[a]){case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(a++,r[a]){case me.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let y=new H;a=me.textCompaction(r,a+1,y),l.setFileName(y.toString());break;case me.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let A=new H;a=me.textCompaction(r,a+1,A),l.setSender(A.toString());break;case me.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let T=new H;a=me.textCompaction(r,a+1,T),l.setAddressee(T.toString());break;case me.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let I=new H;a=me.numericCompaction(r,a+1,I),l.setSegmentCount(de.parseInt(I.toString()));break;case me.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let k=new H;a=me.numericCompaction(r,a+1,k),l.setTimestamp(Ba.parseLong(k.toString()));break;case me.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let L=new H;a=me.numericCompaction(r,a+1,L),l.setChecksum(de.parseInt(L.toString()));break;case me.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let G=new H;a=me.numericCompaction(r,a+1,G),l.setFileSize(Ba.parseLong(G.toString()));break;default:throw F.getFormatInstance()}break;case me.MACRO_PDF417_TERMINATOR:a++,l.setLastSegment(!0);break;default:throw F.getFormatInstance()}if(m!==-1){let y=a-m;l.isLastSegment()&&y--,l.setOptionalData(ke.copyOfRange(r,m,m+y))}return a}static textCompaction(r,a,l){let u=new Int32Array((r[0]-a)*2),f=new Int32Array((r[0]-a)*2),m=0,y=!1;for(;a<r[0]&&!y;){let A=r[a++];if(A<me.TEXT_COMPACTION_MODE_LATCH)u[m]=A/30,u[m+1]=A%30,m+=2;else switch(A){case me.TEXT_COMPACTION_MODE_LATCH:u[m++]=me.TEXT_COMPACTION_MODE_LATCH;break;case me.BYTE_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.NUMERIC_COMPACTION_MODE_LATCH:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:a--,y=!0;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u[m]=me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,A=r[a++],f[m]=A,m++;break}}return me.decodeTextCompaction(u,f,m,l),a}static decodeTextCompaction(r,a,l,u){let f=En.ALPHA,m=En.ALPHA,y=0;for(;y<l;){let A=r[y],T="";switch(f){case En.ALPHA:if(A<26)T=String.fromCharCode(65+A);else switch(A){case 26:T=" ";break;case me.LL:f=En.LOWER;break;case me.ML:f=En.MIXED;break;case me.PS:m=f,f=En.PUNCT_SHIFT;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case me.TEXT_COMPACTION_MODE_LATCH:f=En.ALPHA;break}break;case En.LOWER:if(A<26)T=String.fromCharCode(97+A);else switch(A){case 26:T=" ";break;case me.AS:m=f,f=En.ALPHA_SHIFT;break;case me.ML:f=En.MIXED;break;case me.PS:m=f,f=En.PUNCT_SHIFT;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case me.TEXT_COMPACTION_MODE_LATCH:f=En.ALPHA;break}break;case En.MIXED:if(A<me.PL)T=me.MIXED_CHARS[A];else switch(A){case me.PL:f=En.PUNCT;break;case 26:T=" ";break;case me.LL:f=En.LOWER;break;case me.AL:f=En.ALPHA;break;case me.PS:m=f,f=En.PUNCT_SHIFT;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case me.TEXT_COMPACTION_MODE_LATCH:f=En.ALPHA;break}break;case En.PUNCT:if(A<me.PAL)T=me.PUNCT_CHARS[A];else switch(A){case me.PAL:f=En.ALPHA;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case me.TEXT_COMPACTION_MODE_LATCH:f=En.ALPHA;break}break;case En.ALPHA_SHIFT:if(f=m,A<26)T=String.fromCharCode(65+A);else switch(A){case 26:T=" ";break;case me.TEXT_COMPACTION_MODE_LATCH:f=En.ALPHA;break}break;case En.PUNCT_SHIFT:if(f=m,A<me.PAL)T=me.PUNCT_CHARS[A];else switch(A){case me.PAL:f=En.ALPHA;break;case me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case me.TEXT_COMPACTION_MODE_LATCH:f=En.ALPHA;break}break}T!==""&&u.append(T),y++}}static byteCompaction(r,a,l,u,f){let m=new Ua,y=0,A=0,T=!1;switch(r){case me.BYTE_COMPACTION_MODE_LATCH:let I=new Int32Array(6),k=a[u++];for(;u<a[0]&&!T;)switch(I[y++]=k,A=900*A+k,k=a[u++],k){case me.TEXT_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH:case me.NUMERIC_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:u--,T=!0;break;default:if(y%5===0&&y>0){for(let L=0;L<6;++L)m.write(Number(Hi(A)>>Hi(8*(5-L))));A=0,y=0}break}u===a[0]&&k<me.TEXT_COMPACTION_MODE_LATCH&&(I[y++]=k);for(let L=0;L<y;L++)m.write(I[L]);break;case me.BYTE_COMPACTION_MODE_LATCH_6:for(;u<a[0]&&!T;){let L=a[u++];if(L<me.TEXT_COMPACTION_MODE_LATCH)y++,A=900*A+L;else switch(L){case me.TEXT_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH:case me.NUMERIC_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:u--,T=!0;break}if(y%5===0&&y>0){for(let G=0;G<6;++G)m.write(Number(Hi(A)>>Hi(8*(5-G))));A=0,y=0}}break}return f.append(q.decode(m.toByteArray(),l)),u}static numericCompaction(r,a,l){let u=0,f=!1,m=new Int32Array(me.MAX_NUMERIC_CODEWORDS);for(;a<r[0]&&!f;){let y=r[a++];if(a===r[0]&&(f=!0),y<me.TEXT_COMPACTION_MODE_LATCH)m[u]=y,u++;else switch(y){case me.TEXT_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH:case me.BYTE_COMPACTION_MODE_LATCH_6:case me.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case me.MACRO_PDF417_TERMINATOR:a--,f=!0;break}(u%me.MAX_NUMERIC_CODEWORDS===0||y===me.NUMERIC_COMPACTION_MODE_LATCH||f)&&u>0&&(l.append(me.decodeBase900toBase10(m,u)),u=0)}return a}static decodeBase900toBase10(r,a){let l=Hi(0);for(let f=0;f<a;f++)l+=me.EXP900[a-f-1]*Hi(r[f]);let u=l.toString();if(u.charAt(0)!=="1")throw new F;return u.substring(1)}}me.TEXT_COMPACTION_MODE_LATCH=900,me.BYTE_COMPACTION_MODE_LATCH=901,me.NUMERIC_COMPACTION_MODE_LATCH=902,me.BYTE_COMPACTION_MODE_LATCH_6=924,me.ECI_USER_DEFINED=925,me.ECI_GENERAL_PURPOSE=926,me.ECI_CHARSET=927,me.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,me.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,me.MACRO_PDF417_TERMINATOR=922,me.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,me.MAX_NUMERIC_CODEWORDS=15,me.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,me.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,me.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,me.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,me.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,me.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,me.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,me.PL=25,me.LL=27,me.AS=27,me.ML=28,me.AL=28,me.PS=29,me.PAL=29,me.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,me.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",me.EXP900=Ms()?ra():[],me.NUMBER_OF_SEQUENCE_CODEWORDS=2;class jt{constructor(){}static decode(r,a,l,u,f,m,y){let A=new ji(r,a,l,u,f),T=null,I=null,k;for(let Q=!0;;Q=!1){if(a!=null&&(T=jt.getRowIndicatorColumn(r,A,a,!0,m,y)),u!=null&&(I=jt.getRowIndicatorColumn(r,A,u,!1,m,y)),k=jt.merge(T,I),k==null)throw ae.getNotFoundInstance();let J=k.getBoundingBox();if(Q&&J!=null&&(J.getMinY()<A.getMinY()||J.getMaxY()>A.getMaxY()))A=J;else break}k.setBoundingBox(A);let L=k.getBarcodeColumnCount()+1;k.setDetectionResultColumn(0,T),k.setDetectionResultColumn(L,I);let G=T!=null;for(let Q=1;Q<=L;Q++){let J=G?Q:L-Q;if(k.getDetectionResultColumn(J)!==void 0)continue;let se;J===0||J===L?se=new Ii(A,J===0):se=new zi(A),k.setDetectionResultColumn(J,se);let ye=-1,Ue=ye;for(let Be=A.getMinY();Be<=A.getMaxY();Be++){if(ye=jt.getStartColumn(k,J,Be,G),ye<0||ye>A.getMaxX()){if(Ue===-1)continue;ye=Ue}let Me=jt.detectCodeword(r,A.getMinX(),A.getMaxX(),G,ye,Be,m,y);Me!=null&&(se.setCodeword(Be,Me),Ue=ye,m=Math.min(m,Me.getWidth()),y=Math.max(y,Me.getWidth()))}}return jt.createDecoderResult(k)}static merge(r,a){if(r==null&&a==null)return null;let l=jt.getBarcodeMetadata(r,a);if(l==null)return null;let u=ji.merge(jt.adjustBoundingBox(r),jt.adjustBoundingBox(a));return new cr(l,u)}static adjustBoundingBox(r){if(r==null)return null;let a=r.getRowHeights();if(a==null)return null;let l=jt.getMax(a),u=0;for(let y of a)if(u+=l-y,y>0)break;let f=r.getCodewords();for(let y=0;u>0&&f[y]==null;y++)u--;let m=0;for(let y=a.length-1;y>=0&&(m+=l-a[y],!(a[y]>0));y--);for(let y=f.length-1;m>0&&f[y]==null;y--)m--;return r.getBoundingBox().addMissingRows(u,m,r.isLeft())}static getMax(r){let a=-1;for(let l of r)a=Math.max(a,l);return a}static getBarcodeMetadata(r,a){let l;if(r==null||(l=r.getBarcodeMetadata())==null)return a==null?null:a.getBarcodeMetadata();let u;return a==null||(u=a.getBarcodeMetadata())==null?l:l.getColumnCount()!==u.getColumnCount()&&l.getErrorCorrectionLevel()!==u.getErrorCorrectionLevel()&&l.getRowCount()!==u.getRowCount()?null:l}static getRowIndicatorColumn(r,a,l,u,f,m){let y=new Ii(a,u);for(let A=0;A<2;A++){let T=A===0?1:-1,I=Math.trunc(Math.trunc(l.getX()));for(let k=Math.trunc(Math.trunc(l.getY()));k<=a.getMaxY()&&k>=a.getMinY();k+=T){let L=jt.detectCodeword(r,0,r.getWidth(),u,I,k,f,m);L!=null&&(y.setCodeword(k,L),u?I=L.getStartX():I=L.getEndX())}}return y}static adjustCodewordCount(r,a){let l=a[0][1],u=l.getValue(),f=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-jt.getNumberOfECCodeWords(r.getBarcodeECLevel());if(u.length===0){if(f<1||f>_t.MAX_CODEWORDS_IN_BARCODE)throw ae.getNotFoundInstance();l.setValue(f)}else u[0]!==f&&l.setValue(f)}static createDecoderResult(r){let a=jt.createBarcodeMatrix(r);jt.adjustCodewordCount(r,a);let l=new Array,u=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),f=[],m=new Array;for(let A=0;A<r.getBarcodeRowCount();A++)for(let T=0;T<r.getBarcodeColumnCount();T++){let I=a[A][T+1].getValue(),k=A*r.getBarcodeColumnCount()+T;I.length===0?l.push(k):I.length===1?u[k]=I[0]:(m.push(k),f.push(I))}let y=new Array(f.length);for(let A=0;A<y.length;A++)y[A]=f[A];return jt.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),u,_t.toIntArray(l),_t.toIntArray(m),y)}static createDecoderResultFromAmbiguousValues(r,a,l,u,f){let m=new Int32Array(u.length),y=100;for(;y-- >0;){for(let A=0;A<m.length;A++)a[u[A]]=f[A][m[A]];try{return jt.decodeCodewords(a,r,l)}catch(A){if(!(A instanceof X))throw A}if(m.length===0)throw X.getChecksumInstance();for(let A=0;A<m.length;A++)if(m[A]<f[A].length-1){m[A]++;break}else if(m[A]=0,A===m.length-1)throw X.getChecksumInstance()}throw X.getChecksumInstance()}static createBarcodeMatrix(r){let a=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let u=0;u<a.length;u++)for(let f=0;f<a[u].length;f++)a[u][f]=new yi;let l=0;for(let u of r.getDetectionResultColumns()){if(u!=null){for(let f of u.getCodewords())if(f!=null){let m=f.getRowNumber();if(m>=0){if(m>=a.length)continue;a[m][l].setValue(f.getValue())}}}l++}return a}static isValidBarcodeColumn(r,a){return a>=0&&a<=r.getBarcodeColumnCount()+1}static getStartColumn(r,a,l,u){let f=u?1:-1,m=null;if(jt.isValidBarcodeColumn(r,a-f)&&(m=r.getDetectionResultColumn(a-f).getCodeword(l)),m!=null)return u?m.getEndX():m.getStartX();if(m=r.getDetectionResultColumn(a).getCodewordNearby(l),m!=null)return u?m.getStartX():m.getEndX();if(jt.isValidBarcodeColumn(r,a-f)&&(m=r.getDetectionResultColumn(a-f).getCodewordNearby(l)),m!=null)return u?m.getEndX():m.getStartX();let y=0;for(;jt.isValidBarcodeColumn(r,a-f);){a-=f;for(let A of r.getDetectionResultColumn(a).getCodewords())if(A!=null)return(u?A.getEndX():A.getStartX())+f*y*(A.getEndX()-A.getStartX());y++}return u?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,a,l,u,f,m,y,A){f=jt.adjustCodewordStartColumn(r,a,l,u,f,m);let T=jt.getModuleBitCount(r,a,l,u,f,m);if(T==null)return null;let I,k=Qe.sum(T);if(u)I=f+k;else{for(let Q=0;Q<T.length/2;Q++){let J=T[Q];T[Q]=T[T.length-1-Q],T[T.length-1-Q]=J}I=f,f=I-k}if(!jt.checkCodewordSkew(k,y,A))return null;let L=Kn.getDecodedValue(T),G=_t.getCodeword(L);return G===-1?null:new Ei(f,I,jt.getCodewordBucketNumber(L),G)}static getModuleBitCount(r,a,l,u,f,m){let y=f,A=new Int32Array(8),T=0,I=u?1:-1,k=u;for(;(u?y<l:y>=a)&&T<A.length;)r.get(y,m)===k?(A[T]++,y+=I):(T++,k=!k);return T===A.length||y===(u?l:a)&&T===A.length-1?A:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,a,l,u,f,m){let y=f,A=u?-1:1;for(let T=0;T<2;T++){for(;(u?y>=a:y<l)&&u===r.get(y,m);){if(Math.abs(f-y)>jt.CODEWORD_SKEW_SIZE)return f;y+=A}A=-A,u=!u}return y}static checkCodewordSkew(r,a,l){return a-jt.CODEWORD_SKEW_SIZE<=r&&r<=l+jt.CODEWORD_SKEW_SIZE}static decodeCodewords(r,a,l){if(r.length===0)throw F.getFormatInstance();let u=1<<a+1,f=jt.correctErrors(r,l,u);jt.verifyCodewordCount(r,u);let m=me.decode(r,""+a);return m.setErrorsCorrected(f),m.setErasures(l.length),m}static correctErrors(r,a,l){if(a!=null&&a.length>l/2+jt.MAX_ERRORS||l<0||l>jt.MAX_EC_CODEWORDS)throw X.getChecksumInstance();return jt.errorCorrection.decode(r,l,a)}static verifyCodewordCount(r,a){if(r.length<4)throw F.getFormatInstance();let l=r[0];if(l>r.length)throw F.getFormatInstance();if(l===0)if(a<r.length)r[0]=r.length-a;else throw F.getFormatInstance()}static getBitCountForCodeword(r){let a=new Int32Array(8),l=0,u=a.length-1;for(;!((r&1)!==l&&(l=r&1,u--,u<0));)a[u]++,r>>=1;return a}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return jt.getCodewordBucketNumber(jt.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let a=new xs;for(let l=0;l<r.length;l++){a.format("Row %2d: ",l);for(let u=0;u<r[l].length;u++){let f=r[l][u];f.getValue().length===0?a.format("        ",null):a.format("%4d(%2d)",f.getValue()[0],f.getConfidence(f.getValue()[0]))}a.format("%n")}return a.toString()}}jt.CODEWORD_SKEW_SIZE=2,jt.MAX_ERRORS=3,jt.MAX_EC_CODEWORDS=512,jt.errorCorrection=new Fi;class nr{decode(r,a=null){let l=nr.decode(r,a,!1);if(l==null||l.length===0||l[0]==null)throw ae.getNotFoundInstance();return l[0]}decodeMultiple(r,a=null){try{return nr.decode(r,a,!0)}catch(l){throw l instanceof F||l instanceof X?ae.getNotFoundInstance():l}}static decode(r,a,l){const u=new Array,f=vt.detectMultiple(r,a,l);for(const m of f.getPoints()){const y=jt.decode(f.getBits(),m[4],m[5],m[6],m[7],nr.getMinCodewordWidth(m),nr.getMaxCodewordWidth(m)),A=new Ve(y.getText(),y.getRawBytes(),void 0,m,we.PDF_417);A.putMetadata(xt.ERROR_CORRECTION_LEVEL,y.getECLevel());const T=y.getOther();T!=null&&A.putMetadata(xt.PDF417_EXTRA_METADATA,T),u.push(A)}return u.map(m=>m)}static getMaxWidth(r,a){return r==null||a==null?0:Math.trunc(Math.abs(r.getX()-a.getX()))}static getMinWidth(r,a){return r==null||a==null?de.MAX_VALUE:Math.trunc(Math.abs(r.getX()-a.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(nr.getMaxWidth(r[0],r[4]),nr.getMaxWidth(r[6],r[2])*_t.MODULES_IN_CODEWORD/_t.MODULES_IN_STOP_PATTERN),Math.max(nr.getMaxWidth(r[1],r[5]),nr.getMaxWidth(r[7],r[3])*_t.MODULES_IN_CODEWORD/_t.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(nr.getMinWidth(r[0],r[4]),nr.getMinWidth(r[6],r[2])*_t.MODULES_IN_CODEWORD/_t.MODULES_IN_STOP_PATTERN),Math.min(nr.getMinWidth(r[1],r[5]),nr.getMinWidth(r[7],r[3])*_t.MODULES_IN_CODEWORD/_t.MODULES_IN_STOP_PATTERN)))}reset(){}}class ia extends _{}ia.kind="ReaderException";class Uo{constructor(r,a){this.verbose=r===!0,a&&this.setHints(a)}decode(r,a){return a&&this.setHints(a),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const a=!o(r)&&r.get(qe.TRY_HARDER)===!0,l=o(r)?null:r.get(qe.POSSIBLE_FORMATS),u=new Array;if(!o(l)){const f=l.some(m=>m===we.UPC_A||m===we.UPC_E||m===we.EAN_13||m===we.EAN_8||m===we.CODABAR||m===we.CODE_39||m===we.CODE_93||m===we.CODE_128||m===we.ITF||m===we.RSS_14||m===we.RSS_EXPANDED);f&&!a&&u.push(new qr(r,this.verbose)),l.includes(we.QR_CODE)&&u.push(new ci),l.includes(we.DATA_MATRIX)&&u.push(new si),l.includes(we.AZTEC)&&u.push(new st),l.includes(we.PDF_417)&&u.push(new nr),f&&a&&u.push(new qr(r,this.verbose))}u.length===0&&(a||u.push(new qr(r,this.verbose)),u.push(new ci),u.push(new si),u.push(new st),u.push(new nr),a&&u.push(new qr(r,this.verbose))),this.readers=u}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new ia("No readers where selected, nothing can be read.");for(const a of this.readers)try{return a.decode(r,this.hints)}catch(l){if(l instanceof ia)continue}throw new ae("No MultiFormat Readers were able to detect the code.")}}class rs extends De{constructor(r=null,a=500){const l=new Uo;l.setHints(r),super(l,a)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class xl extends De{constructor(r=500){super(new nr,r)}}class _l extends De{constructor(r=500){super(new ci,r)}}var Fa;(function(M){M[M.ERROR_CORRECTION=0]="ERROR_CORRECTION",M[M.CHARACTER_SET=1]="CHARACTER_SET",M[M.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",M[M.MIN_SIZE=3]="MIN_SIZE",M[M.MAX_SIZE=4]="MAX_SIZE",M[M.MARGIN=5]="MARGIN",M[M.PDF417_COMPACT=6]="PDF417_COMPACT",M[M.PDF417_COMPACTION=7]="PDF417_COMPACTION",M[M.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",M[M.AZTEC_LAYERS=9]="AZTEC_LAYERS",M[M.QR_VERSION=10]="QR_VERSION"})(Fa||(Fa={}));var rr=Fa;class is{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new Ie(r,Int32Array.from([1])))}buildGenerator(r){const a=this.cachedGenerators;if(r>=a.length){let l=a[a.length-1];const u=this.field;for(let f=a.length;f<=r;f++){const m=l.multiply(new Ie(u,Int32Array.from([1,u.exp(f-1+u.getGeneratorBase())])));a.push(m),l=m}}return a[r]}encode(r,a){if(a===0)throw new N("No error correction bytes");const l=r.length-a;if(l<=0)throw new N("No data bytes provided");const u=this.buildGenerator(a),f=new Int32Array(l);oe.arraycopy(r,0,f,0,l);let m=new Ie(this.field,f);m=m.multiplyByMonomial(a,1);const A=m.divide(u)[1].getCoefficients(),T=a-A.length;for(let I=0;I<T;I++)r[l+I]=0;oe.arraycopy(A,0,r,l+T,A.length)}}class $t{constructor(){}static applyMaskPenaltyRule1(r){return $t.applyMaskPenaltyRule1Internal(r,!0)+$t.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let a=0;const l=r.getArray(),u=r.getWidth(),f=r.getHeight();for(let m=0;m<f-1;m++){const y=l[m];for(let A=0;A<u-1;A++){const T=y[A];T===y[A+1]&&T===l[m+1][A]&&T===l[m+1][A+1]&&a++}}return $t.N2*a}static applyMaskPenaltyRule3(r){let a=0;const l=r.getArray(),u=r.getWidth(),f=r.getHeight();for(let m=0;m<f;m++)for(let y=0;y<u;y++){const A=l[m];y+6<u&&A[y]===1&&A[y+1]===0&&A[y+2]===1&&A[y+3]===1&&A[y+4]===1&&A[y+5]===0&&A[y+6]===1&&($t.isWhiteHorizontal(A,y-4,y)||$t.isWhiteHorizontal(A,y+7,y+11))&&a++,m+6<f&&l[m][y]===1&&l[m+1][y]===0&&l[m+2][y]===1&&l[m+3][y]===1&&l[m+4][y]===1&&l[m+5][y]===0&&l[m+6][y]===1&&($t.isWhiteVertical(l,y,m-4,m)||$t.isWhiteVertical(l,y,m+7,m+11))&&a++}return a*$t.N3}static isWhiteHorizontal(r,a,l){a=Math.max(a,0),l=Math.min(l,r.length);for(let u=a;u<l;u++)if(r[u]===1)return!1;return!0}static isWhiteVertical(r,a,l,u){l=Math.max(l,0),u=Math.min(u,r.length);for(let f=l;f<u;f++)if(r[f][a]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let a=0;const l=r.getArray(),u=r.getWidth(),f=r.getHeight();for(let A=0;A<f;A++){const T=l[A];for(let I=0;I<u;I++)T[I]===1&&a++}const m=r.getHeight()*r.getWidth();return Math.floor(Math.abs(a*2-m)*10/m)*$t.N4}static getDataMaskBit(r,a,l){let u,f;switch(r){case 0:u=l+a&1;break;case 1:u=l&1;break;case 2:u=a%3;break;case 3:u=(l+a)%3;break;case 4:u=Math.floor(l/2)+Math.floor(a/3)&1;break;case 5:f=l*a,u=(f&1)+f%3;break;case 6:f=l*a,u=(f&1)+f%3&1;break;case 7:f=l*a,u=f%3+(l+a&1)&1;break;default:throw new N("Invalid mask pattern: "+r)}return u===0}static applyMaskPenaltyRule1Internal(r,a){let l=0;const u=a?r.getHeight():r.getWidth(),f=a?r.getWidth():r.getHeight(),m=r.getArray();for(let y=0;y<u;y++){let A=0,T=-1;for(let I=0;I<f;I++){const k=a?m[y][I]:m[I][y];k===T?A++:(A>=5&&(l+=$t.N1+(A-5)),A=1,T=k)}A>=5&&(l+=$t.N1+(A-5))}return l}}$t.N1=3,$t.N2=3,$t.N3=40,$t.N4=10;class sa{constructor(r,a){this.width=r,this.height=a;const l=new Array(a);for(let u=0;u!==a;u++)l[u]=new Uint8Array(r);this.bytes=l}getHeight(){return this.height}getWidth(){return this.width}get(r,a){return this.bytes[a][r]}getArray(){return this.bytes}setNumber(r,a,l){this.bytes[a][r]=l}setBoolean(r,a,l){this.bytes[a][r]=l?1:0}clear(r){for(const a of this.bytes)ke.fill(a,r)}equals(r){if(!(r instanceof sa))return!1;const a=r;if(this.width!==a.width||this.height!==a.height)return!1;for(let l=0,u=this.height;l<u;++l){const f=this.bytes[l],m=a.bytes[l];for(let y=0,A=this.width;y<A;++y)if(f[y]!==m[y])return!1}return!0}toString(){const r=new H;for(let a=0,l=this.height;a<l;++a){const u=this.bytes[a];for(let f=0,m=this.width;f<m;++f)switch(u[f]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class ss{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new H;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<ss.NUM_MASK_PATTERNS}}ss.NUM_MASK_PATTERNS=8;class nn extends _{}nn.kind="WriterException";class p{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,a,l,u,f){p.clearMatrix(f),p.embedBasicPatterns(l,f),p.embedTypeInfo(a,u,f),p.maybeEmbedVersionInfo(l,f),p.embedDataBits(r,u,f)}static embedBasicPatterns(r,a){p.embedPositionDetectionPatternsAndSeparators(a),p.embedDarkDotAtLeftBottomCorner(a),p.maybeEmbedPositionAdjustmentPatterns(r,a),p.embedTimingPatterns(a)}static embedTypeInfo(r,a,l){const u=new Pe;p.makeTypeInfoBits(r,a,u);for(let f=0,m=u.getSize();f<m;++f){const y=u.get(u.getSize()-1-f),A=p.TYPE_INFO_COORDINATES[f],T=A[0],I=A[1];if(l.setBoolean(T,I,y),f<8){const k=l.getWidth()-f-1;l.setBoolean(k,8,y)}else{const L=l.getHeight()-7+(f-8);l.setBoolean(8,L,y)}}}static maybeEmbedVersionInfo(r,a){if(r.getVersionNumber()<7)return;const l=new Pe;p.makeVersionInfoBits(r,l);let u=17;for(let f=0;f<6;++f)for(let m=0;m<3;++m){const y=l.get(u);u--,a.setBoolean(f,a.getHeight()-11+m,y),a.setBoolean(a.getHeight()-11+m,f,y)}}static embedDataBits(r,a,l){let u=0,f=-1,m=l.getWidth()-1,y=l.getHeight()-1;for(;m>0;){for(m===6&&(m-=1);y>=0&&y<l.getHeight();){for(let A=0;A<2;++A){const T=m-A;if(!p.isEmpty(l.get(T,y)))continue;let I;u<r.getSize()?(I=r.get(u),++u):I=!1,a!==255&&$t.getDataMaskBit(a,T,y)&&(I=!I),l.setBoolean(T,y,I)}y+=f}f=-f,y+=f,m-=2}if(u!==r.getSize())throw new nn("Not all bits consumed: "+u+"/"+r.getSize())}static findMSBSet(r){return 32-de.numberOfLeadingZeros(r)}static calculateBCHCode(r,a){if(a===0)throw new N("0 polynomial");const l=p.findMSBSet(a);for(r<<=l-1;p.findMSBSet(r)>=l;)r^=a<<p.findMSBSet(r)-l;return r}static makeTypeInfoBits(r,a,l){if(!ss.isValidMaskPattern(a))throw new nn("Invalid mask pattern");const u=r.getBits()<<3|a;l.appendBits(u,5);const f=p.calculateBCHCode(u,p.TYPE_INFO_POLY);l.appendBits(f,10);const m=new Pe;if(m.appendBits(p.TYPE_INFO_MASK_PATTERN,15),l.xor(m),l.getSize()!==15)throw new nn("should not happen but we got: "+l.getSize())}static makeVersionInfoBits(r,a){a.appendBits(r.getVersionNumber(),6);const l=p.calculateBCHCode(r.getVersionNumber(),p.VERSION_INFO_POLY);if(a.appendBits(l,12),a.getSize()!==18)throw new nn("should not happen but we got: "+a.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let a=8;a<r.getWidth()-8;++a){const l=(a+1)%2;p.isEmpty(r.get(a,6))&&r.setNumber(a,6,l),p.isEmpty(r.get(6,a))&&r.setNumber(6,a,l)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new nn;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,a,l){for(let u=0;u<8;++u){if(!p.isEmpty(l.get(r+u,a)))throw new nn;l.setNumber(r+u,a,0)}}static embedVerticalSeparationPattern(r,a,l){for(let u=0;u<7;++u){if(!p.isEmpty(l.get(r,a+u)))throw new nn;l.setNumber(r,a+u,0)}}static embedPositionAdjustmentPattern(r,a,l){for(let u=0;u<5;++u){const f=p.POSITION_ADJUSTMENT_PATTERN[u];for(let m=0;m<5;++m)l.setNumber(r+m,a+u,f[m])}}static embedPositionDetectionPattern(r,a,l){for(let u=0;u<7;++u){const f=p.POSITION_DETECTION_PATTERN[u];for(let m=0;m<7;++m)l.setNumber(r+m,a+u,f[m])}}static embedPositionDetectionPatternsAndSeparators(r){const a=p.POSITION_DETECTION_PATTERN[0].length;p.embedPositionDetectionPattern(0,0,r),p.embedPositionDetectionPattern(r.getWidth()-a,0,r),p.embedPositionDetectionPattern(0,r.getWidth()-a,r);const l=8;p.embedHorizontalSeparationPattern(0,l-1,r),p.embedHorizontalSeparationPattern(r.getWidth()-l,l-1,r),p.embedHorizontalSeparationPattern(0,r.getWidth()-l,r);const u=7;p.embedVerticalSeparationPattern(u,0,r),p.embedVerticalSeparationPattern(r.getHeight()-u-1,0,r),p.embedVerticalSeparationPattern(u,r.getHeight()-u,r)}static maybeEmbedPositionAdjustmentPatterns(r,a){if(r.getVersionNumber()<2)return;const l=r.getVersionNumber()-1,u=p.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[l];for(let f=0,m=u.length;f!==m;f++){const y=u[f];if(y>=0)for(let A=0;A!==m;A++){const T=u[A];T>=0&&p.isEmpty(a.get(T,y))&&p.embedPositionAdjustmentPattern(T-2,y-2,a)}}}}p.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),p.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),p.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),p.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),p.VERSION_INFO_POLY=7973,p.TYPE_INFO_POLY=1335,p.TYPE_INFO_MASK_PATTERN=21522;class C{constructor(r,a){this.dataBytes=r,this.errorCorrectionBytes=a}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class O{constructor(){}static calculateMaskPenalty(r){return $t.applyMaskPenaltyRule1(r)+$t.applyMaskPenaltyRule2(r)+$t.applyMaskPenaltyRule3(r)+$t.applyMaskPenaltyRule4(r)}static encode(r,a,l=null){let u=O.DEFAULT_BYTE_MODE_ENCODING;const f=l!==null&&l.get(rr.CHARACTER_SET)!==void 0;f&&(u=l.get(rr.CHARACTER_SET).toString());const m=this.chooseMode(r,u),y=new Pe;if(m===Et.BYTE&&(f||O.DEFAULT_BYTE_MODE_ENCODING!==u)){const Be=V.getCharacterSetECIByName(u);Be!==void 0&&this.appendECI(Be,y)}this.appendModeInfo(m,y);const A=new Pe;this.appendBytes(r,m,A,u);let T;if(l!==null&&l.get(rr.QR_VERSION)!==void 0){const Be=Number.parseInt(l.get(rr.QR_VERSION).toString(),10);T=ot.getVersionForNumber(Be);const Me=this.calculateBitsNeeded(m,y,A,T);if(!this.willFit(Me,T,a))throw new nn("Data too big for requested version")}else T=this.recommendVersion(a,m,y,A);const I=new Pe;I.appendBitArray(y);const k=m===Et.BYTE?A.getSizeInBytes():r.length;this.appendLengthInfo(k,T,m,I),I.appendBitArray(A);const L=T.getECBlocksForLevel(a),G=T.getTotalCodewords()-L.getTotalECCodewords();this.terminateBits(G,I);const Q=this.interleaveWithECBytes(I,T.getTotalCodewords(),G,L.getNumBlocks()),J=new ss;J.setECLevel(a),J.setMode(m),J.setVersion(T);const se=T.getDimensionForVersion(),ye=new sa(se,se),Ue=this.chooseMaskPattern(Q,a,T,ye);return J.setMaskPattern(Ue),p.buildMatrix(Q,a,T,Ue,ye),J.setMatrix(ye),J}static recommendVersion(r,a,l,u){const f=this.calculateBitsNeeded(a,l,u,ot.getVersionForNumber(1)),m=this.chooseVersion(f,r),y=this.calculateBitsNeeded(a,l,u,m);return this.chooseVersion(y,r)}static calculateBitsNeeded(r,a,l,u){return a.getSize()+r.getCharacterCountBits(u)+l.getSize()}static getAlphanumericCode(r){return r<O.ALPHANUMERIC_TABLE.length?O.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,a=null){if(V.SJIS.getName()===a&&this.isOnlyDoubleByteKanji(r))return Et.KANJI;let l=!1,u=!1;for(let f=0,m=r.length;f<m;++f){const y=r.charAt(f);if(O.isDigit(y))l=!0;else if(this.getAlphanumericCode(y.charCodeAt(0))!==-1)u=!0;else return Et.BYTE}return u?Et.ALPHANUMERIC:l?Et.NUMERIC:Et.BYTE}static isOnlyDoubleByteKanji(r){let a;try{a=q.encode(r,V.SJIS)}catch{return!1}const l=a.length;if(l%2!==0)return!1;for(let u=0;u<l;u+=2){const f=a[u]&255;if((f<129||f>159)&&(f<224||f>235))return!1}return!0}static chooseMaskPattern(r,a,l,u){let f=Number.MAX_SAFE_INTEGER,m=-1;for(let y=0;y<ss.NUM_MASK_PATTERNS;y++){p.buildMatrix(r,a,l,y,u);let A=this.calculateMaskPenalty(u);A<f&&(f=A,m=y)}return m}static chooseVersion(r,a){for(let l=1;l<=40;l++){const u=ot.getVersionForNumber(l);if(O.willFit(r,u,a))return u}throw new nn("Data too big")}static willFit(r,a,l){const u=a.getTotalCodewords(),m=a.getECBlocksForLevel(l).getTotalECCodewords(),y=u-m,A=(r+7)/8;return y>=A}static terminateBits(r,a){const l=r*8;if(a.getSize()>l)throw new nn("data bits cannot fit in the QR Code"+a.getSize()+" > "+l);for(let m=0;m<4&&a.getSize()<l;++m)a.appendBit(!1);const u=a.getSize()&7;if(u>0)for(let m=u;m<8;m++)a.appendBit(!1);const f=r-a.getSizeInBytes();for(let m=0;m<f;++m)a.appendBits((m&1)===0?236:17,8);if(a.getSize()!==l)throw new nn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,a,l,u,f,m){if(u>=l)throw new nn("Block ID too large");const y=r%l,A=l-y,T=Math.floor(r/l),I=T+1,k=Math.floor(a/l),L=k+1,G=T-k,Q=I-L;if(G!==Q)throw new nn("EC bytes mismatch");if(l!==A+y)throw new nn("RS blocks mismatch");if(r!==(k+G)*A+(L+Q)*y)throw new nn("Total bytes mismatch");u<A?(f[0]=k,m[0]=G):(f[0]=L,m[0]=Q)}static interleaveWithECBytes(r,a,l,u){if(r.getSizeInBytes()!==l)throw new nn("Number of bits and data bytes does not match");let f=0,m=0,y=0;const A=new Array;for(let I=0;I<u;++I){const k=new Int32Array(1),L=new Int32Array(1);O.getNumDataBytesAndNumECBytesForBlockID(a,l,u,I,k,L);const G=k[0],Q=new Uint8Array(G);r.toBytes(8*f,Q,0,G);const J=O.generateECBytes(Q,L[0]);A.push(new C(Q,J)),m=Math.max(m,G),y=Math.max(y,J.length),f+=k[0]}if(l!==f)throw new nn("Data bytes does not match offset");const T=new Pe;for(let I=0;I<m;++I)for(const k of A){const L=k.getDataBytes();I<L.length&&T.appendBits(L[I],8)}for(let I=0;I<y;++I)for(const k of A){const L=k.getErrorCorrectionBytes();I<L.length&&T.appendBits(L[I],8)}if(a!==T.getSizeInBytes())throw new nn("Interleaving error: "+a+" and "+T.getSizeInBytes()+" differ.");return T}static generateECBytes(r,a){const l=r.length,u=new Int32Array(l+a);for(let m=0;m<l;m++)u[m]=r[m]&255;new is(He.QR_CODE_FIELD_256).encode(u,a);const f=new Uint8Array(a);for(let m=0;m<a;m++)f[m]=u[l+m];return f}static appendModeInfo(r,a){a.appendBits(r.getBits(),4)}static appendLengthInfo(r,a,l,u){const f=l.getCharacterCountBits(a);if(r>=1<<f)throw new nn(r+" is bigger than "+((1<<f)-1));u.appendBits(r,f)}static appendBytes(r,a,l,u){switch(a){case Et.NUMERIC:O.appendNumericBytes(r,l);break;case Et.ALPHANUMERIC:O.appendAlphanumericBytes(r,l);break;case Et.BYTE:O.append8BitBytes(r,l,u);break;case Et.KANJI:O.appendKanjiBytes(r,l);break;default:throw new nn("Invalid mode: "+a)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const a=O.getDigit(r);return a>=0&&a<=9}static appendNumericBytes(r,a){const l=r.length;let u=0;for(;u<l;){const f=O.getDigit(r.charAt(u));if(u+2<l){const m=O.getDigit(r.charAt(u+1)),y=O.getDigit(r.charAt(u+2));a.appendBits(f*100+m*10+y,10),u+=3}else if(u+1<l){const m=O.getDigit(r.charAt(u+1));a.appendBits(f*10+m,7),u+=2}else a.appendBits(f,4),u++}}static appendAlphanumericBytes(r,a){const l=r.length;let u=0;for(;u<l;){const f=O.getAlphanumericCode(r.charCodeAt(u));if(f===-1)throw new nn;if(u+1<l){const m=O.getAlphanumericCode(r.charCodeAt(u+1));if(m===-1)throw new nn;a.appendBits(f*45+m,11),u+=2}else a.appendBits(f,6),u++}}static append8BitBytes(r,a,l){let u;try{u=q.encode(r,l)}catch(f){throw new nn(f)}for(let f=0,m=u.length;f!==m;f++){const y=u[f];a.appendBits(y,8)}}static appendKanjiBytes(r,a){let l;try{l=q.encode(r,V.SJIS)}catch(f){throw new nn(f)}const u=l.length;for(let f=0;f<u;f+=2){const m=l[f]&255,y=l[f+1]&255,A=m<<8&4294967295|y;let T=-1;if(A>=33088&&A<=40956?T=A-33088:A>=57408&&A<=60351&&(T=A-49472),T===-1)throw new nn("Invalid byte sequence");const I=(T>>8)*192+(T&255);a.appendBits(I,13)}}static appendECI(r,a){a.appendBits(Et.ECI.getBits(),4),a.appendBits(r.getValue(),8)}}O.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),O.DEFAULT_BYTE_MODE_ENCODING=V.UTF8.getName();class U{write(r,a,l,u=null){if(r.length===0)throw new N("Found empty contents");if(a<0||l<0)throw new N("Requested dimensions are too small: "+a+"x"+l);let f=Wt.L,m=U.QUIET_ZONE_SIZE;u!==null&&(u.get(rr.ERROR_CORRECTION)!==void 0&&(f=Wt.fromString(u.get(rr.ERROR_CORRECTION).toString())),u.get(rr.MARGIN)!==void 0&&(m=Number.parseInt(u.get(rr.MARGIN).toString(),10)));const y=O.encode(r,f,u);return this.renderResult(y,a,l,m)}writeToDom(r,a,l,u,f=null){typeof r=="string"&&(r=document.querySelector(r));const m=this.write(a,l,u,f);r&&r.appendChild(m)}renderResult(r,a,l,u){const f=r.getMatrix();if(f===null)throw new yt;const m=f.getWidth(),y=f.getHeight(),A=m+u*2,T=y+u*2,I=Math.max(a,A),k=Math.max(l,T),L=Math.min(Math.floor(I/A),Math.floor(k/T)),G=Math.floor((I-m*L)/2),Q=Math.floor((k-y*L)/2),J=this.createSVGElement(I,k);for(let se=0,ye=Q;se<y;se++,ye+=L)for(let Ue=0,Be=G;Ue<m;Ue++,Be+=L)if(f.get(Ue,se)===1){const Me=this.createSvgRectElement(Be,ye,L,L);J.appendChild(Me)}return J}createSVGElement(r,a){const l=document.createElementNS(U.SVG_NS,"svg");return l.setAttributeNS(null,"height",r.toString()),l.setAttributeNS(null,"width",a.toString()),l}createSvgRectElement(r,a,l,u){const f=document.createElementNS(U.SVG_NS,"rect");return f.setAttributeNS(null,"x",r.toString()),f.setAttributeNS(null,"y",a.toString()),f.setAttributeNS(null,"height",l.toString()),f.setAttributeNS(null,"width",u.toString()),f.setAttributeNS(null,"fill","#000000"),f}}U.QUIET_ZONE_SIZE=4,U.SVG_NS="http://www.w3.org/2000/svg";class ie{encode(r,a,l,u,f){if(r.length===0)throw new N("Found empty contents");if(a!==we.QR_CODE)throw new N("Can only encode QR_CODE, but got "+a);if(l<0||u<0)throw new N(`Requested dimensions are too small: ${l}x${u}`);let m=Wt.L,y=ie.QUIET_ZONE_SIZE;f!==null&&(f.get(rr.ERROR_CORRECTION)!==void 0&&(m=Wt.fromString(f.get(rr.ERROR_CORRECTION).toString())),f.get(rr.MARGIN)!==void 0&&(y=Number.parseInt(f.get(rr.MARGIN).toString(),10)));const A=O.encode(r,m,f);return ie.renderResult(A,l,u,y)}static renderResult(r,a,l,u){const f=r.getMatrix();if(f===null)throw new yt;const m=f.getWidth(),y=f.getHeight(),A=m+u*2,T=y+u*2,I=Math.max(a,A),k=Math.max(l,T),L=Math.min(Math.floor(I/A),Math.floor(k/T)),G=Math.floor((I-m*L)/2),Q=Math.floor((k-y*L)/2),J=new rt(I,k);for(let se=0,ye=Q;se<y;se++,ye+=L)for(let Ue=0,Be=G;Ue<m;Ue++,Be+=L)f.get(Ue,se)===1&&J.setRegion(Be,ye,L,L);return J}}ie.QUIET_ZONE_SIZE=4;class Ee{encode(r,a,l,u,f){let m;switch(a){case we.QR_CODE:m=new ie;break;default:throw new N("No encoder available for format "+a)}return m.encode(r,a,l,u,f)}}class Fe extends ze{constructor(r,a,l,u,f,m,y,A){if(super(m,y),this.yuvData=r,this.dataWidth=a,this.dataHeight=l,this.left=u,this.top=f,u+m>a||f+y>l)throw new N("Crop rectangle does not fit within image data.");A&&this.reverseHorizontal(m,y)}getRow(r,a){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const l=this.getWidth();(a==null||a.length<l)&&(a=new Uint8ClampedArray(l));const u=(r+this.top)*this.dataWidth+this.left;return oe.arraycopy(this.yuvData,u,a,0,l),a}getMatrix(){const r=this.getWidth(),a=this.getHeight();if(r===this.dataWidth&&a===this.dataHeight)return this.yuvData;const l=r*a,u=new Uint8ClampedArray(l);let f=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return oe.arraycopy(this.yuvData,f,u,0,l),u;for(let m=0;m<a;m++){const y=m*r;oe.arraycopy(this.yuvData,f,u,y,r),f+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,a,l,u){return new Fe(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+a,l,u,!1)}renderThumbnail(){const r=this.getWidth()/Fe.THUMBNAIL_SCALE_FACTOR,a=this.getHeight()/Fe.THUMBNAIL_SCALE_FACTOR,l=new Int32Array(r*a),u=this.yuvData;let f=this.top*this.dataWidth+this.left;for(let m=0;m<a;m++){const y=m*r;for(let A=0;A<r;A++){const T=u[f+A*Fe.THUMBNAIL_SCALE_FACTOR]&255;l[y+A]=4278190080|T*65793}f+=this.dataWidth*Fe.THUMBNAIL_SCALE_FACTOR}return l}getThumbnailWidth(){return this.getWidth()/Fe.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Fe.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,a){const l=this.yuvData;for(let u=0,f=this.top*this.dataWidth+this.left;u<a;u++,f+=this.dataWidth){const m=f+r/2;for(let y=f,A=f+r-1;y<m;y++,A--){const T=l[y];l[y]=l[A],l[A]=T}}}invert(){return new pt(this)}}Fe.THUMBNAIL_SCALE_FACTOR=2;class Pt extends ze{constructor(r,a,l,u,f,m,y){if(super(a,l),this.dataWidth=u,this.dataHeight=f,this.left=m,this.top=y,r.BYTES_PER_ELEMENT===4){const A=a*l,T=new Uint8ClampedArray(A);for(let I=0;I<A;I++){const k=r[I],L=k>>16&255,G=k>>7&510,Q=k&255;T[I]=(L+G+Q)/4&255}this.luminances=T}else this.luminances=r;if(u===void 0&&(this.dataWidth=a),f===void 0&&(this.dataHeight=l),m===void 0&&(this.left=0),y===void 0&&(this.top=0),this.left+a>this.dataWidth||this.top+l>this.dataHeight)throw new N("Crop rectangle does not fit within image data.")}getRow(r,a){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const l=this.getWidth();(a==null||a.length<l)&&(a=new Uint8ClampedArray(l));const u=(r+this.top)*this.dataWidth+this.left;return oe.arraycopy(this.luminances,u,a,0,l),a}getMatrix(){const r=this.getWidth(),a=this.getHeight();if(r===this.dataWidth&&a===this.dataHeight)return this.luminances;const l=r*a,u=new Uint8ClampedArray(l);let f=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return oe.arraycopy(this.luminances,f,u,0,l),u;for(let m=0;m<a;m++){const y=m*r;oe.arraycopy(this.luminances,f,u,y,r),f+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,a,l,u){return new Pt(this.luminances,l,u,this.dataWidth,this.dataHeight,this.left+r,this.top+a)}invert(){return new pt(this)}}class ir extends V{static forName(r){return this.getCharacterSetECIByName(r)}}class mn{}mn.ISO_8859_1=V.ISO8859_1;class jn{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class xi{static singletonList(r){return[r]}static min(r,a){return r.sort(a)[0]}}class as{constructor(r){this.previous=r}getPrevious(){return this.previous}}class jr extends as{constructor(r,a,l){super(r),this.value=a,this.bitCount=l}appendTo(r,a){r.appendBits(this.value,this.bitCount)}add(r,a){return new jr(this,r,a)}addBinaryShift(r,a){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new jr(this,r,a)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+de.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class _i extends jr{constructor(r,a,l){super(r,0,0),this.binaryShiftStart=a,this.binaryShiftByteCount=l}appendTo(r,a){for(let l=0;l<this.binaryShiftByteCount;l++)(l===0||l===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):l===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(a[this.binaryShiftStart+l],8)}addBinaryShift(r,a){return new _i(this,r,a)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function aa(M,r,a){return new _i(M,r,a)}function os(M,r,a){return new jr(M,r,a)}const ja=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],ks=0,Al=1,Ri=2,_c=3,Gi=4,Fo=new jr(null,0,0),oa=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function gd(M){for(let r of M)ke.fill(r,-1);return M[ks][Gi]=0,M[Al][Gi]=0,M[Al][ks]=28,M[_c][Gi]=0,M[Ri][Gi]=0,M[Ri][ks]=15,M}const jo=gd(ke.createInt32Array(6,6));class qi{constructor(r,a,l,u){this.token=r,this.mode=a,this.binaryShiftByteCount=l,this.bitCount=u}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,a){let l=this.bitCount,u=this.token;if(r!==this.mode){let m=oa[this.mode][r];u=os(u,m&65535,m>>16),l+=m>>16}let f=r===Ri?4:5;return u=os(u,a,f),new qi(u,r,0,l+f)}shiftAndAppend(r,a){let l=this.token,u=this.mode===Ri?4:5;return l=os(l,jo[this.mode][r],u),l=os(l,a,5),new qi(l,this.mode,0,this.bitCount+u+5)}addBinaryShiftChar(r){let a=this.token,l=this.mode,u=this.bitCount;if(this.mode===Gi||this.mode===Ri){let y=oa[l][ks];a=os(a,y&65535,y>>16),u+=y>>16,l=ks}let f=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,m=new qi(a,l,this.binaryShiftByteCount+1,u+f);return m.binaryShiftByteCount===2078&&(m=m.endBinaryShift(r+1)),m}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let a=this.token;return a=aa(a,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new qi(a,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let a=this.bitCount+(oa[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?a+=qi.calculateBinaryShiftCost(r)-qi.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(a+=10),a<=r.bitCount}toBitArray(r){let a=[];for(let u=this.endBinaryShift(r.length).token;u!==null;u=u.getPrevious())a.unshift(u);let l=new Pe;for(const u of a)u.appendTo(l,r);return l}toString(){return Y.format("%s bits=%d bytes=%d",ja[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}qi.INITIAL_STATE=new qi(Fo,ks,0,0);function Gu(M){const r=Y.getCharCode(" "),a=Y.getCharCode("."),l=Y.getCharCode(",");M[ks][r]=1;const u=Y.getCharCode("Z"),f=Y.getCharCode("A");for(let L=f;L<=u;L++)M[ks][L]=L-f+2;M[Al][r]=1;const m=Y.getCharCode("z"),y=Y.getCharCode("a");for(let L=y;L<=m;L++)M[Al][L]=L-y+2;M[Ri][r]=1;const A=Y.getCharCode("9"),T=Y.getCharCode("0");for(let L=T;L<=A;L++)M[Ri][L]=L-T+2;M[Ri][l]=12,M[Ri][a]=13;const I=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let L=0;L<I.length;L++)M[_c][Y.getCharCode(I[L])]=L;const k=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let L=0;L<k.length;L++)Y.getCharCode(k[L])>0&&(M[Gi][Y.getCharCode(k[L])]=L);return M}const zo=Gu(ke.createInt32Array(5,256));class la{constructor(r){this.text=r}encode(){const r=Y.getCharCode(" "),a=Y.getCharCode(`
`);let l=xi.singletonList(qi.INITIAL_STATE);for(let f=0;f<this.text.length;f++){let m,y=f+1<this.text.length?this.text[f+1]:0;switch(this.text[f]){case Y.getCharCode("\r"):m=y===a?2:0;break;case Y.getCharCode("."):m=y===r?3:0;break;case Y.getCharCode(","):m=y===r?4:0;break;case Y.getCharCode(":"):m=y===r?5:0;break;default:m=0}m>0?(l=la.updateStateListForPair(l,f,m),f++):l=this.updateStateListForChar(l,f)}return xi.min(l,(f,m)=>f.getBitCount()-m.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,a){const l=[];for(let u of r)this.updateStateForChar(u,a,l);return la.simplifyStates(l)}updateStateForChar(r,a,l){let u=this.text[a]&255,f=zo[r.getMode()][u]>0,m=null;for(let y=0;y<=Gi;y++){let A=zo[y][u];if(A>0){if(m==null&&(m=r.endBinaryShift(a)),!f||y===r.getMode()||y===Ri){const T=m.latchAndAppend(y,A);l.push(T)}if(!f&&jo[r.getMode()][y]>=0){const T=m.shiftAndAppend(y,A);l.push(T)}}}if(r.getBinaryShiftByteCount()>0||zo[r.getMode()][u]===0){let y=r.addBinaryShiftChar(a);l.push(y)}}static updateStateListForPair(r,a,l){const u=[];for(let f of r)this.updateStateForPair(f,a,l,u);return this.simplifyStates(u)}static updateStateForPair(r,a,l,u){let f=r.endBinaryShift(a);if(u.push(f.latchAndAppend(Gi,l)),r.getMode()!==Gi&&u.push(f.shiftAndAppend(Gi,l)),l===3||l===4){let m=f.latchAndAppend(Ri,16-l).latchAndAppend(Ri,1);u.push(m)}if(r.getBinaryShiftByteCount()>0){let m=r.addBinaryShiftChar(a).addBinaryShiftChar(a+1);u.push(m)}}static simplifyStates(r){let a=[];for(const l of r){let u=!0;for(const f of a){if(f.isBetterThanOrEqualTo(l)){u=!1;break}l.isBetterThanOrEqualTo(f)&&(a=a.filter(m=>m!==f))}u&&a.push(l)}return a}}class ln{constructor(){}static encodeBytes(r){return ln.encode(r,ln.DEFAULT_EC_PERCENT,ln.DEFAULT_AZTEC_LAYERS)}static encode(r,a,l){let u=new la(r).encode(),f=de.truncDivision(u.getSize()*a,100)+11,m=u.getSize()+f,y,A,T,I,k;if(l!==ln.DEFAULT_AZTEC_LAYERS){if(y=l<0,A=Math.abs(l),A>(y?ln.MAX_NB_BITS_COMPACT:ln.MAX_NB_BITS))throw new N(Y.format("Illegal value %s for layers",l));T=ln.totalBitsInLayer(A,y),I=ln.WORD_SIZE[A];let Me=T-T%I;if(k=ln.stuffBits(u,I),k.getSize()+f>Me)throw new N("Data to large for user specified layer");if(y&&k.getSize()>I*64)throw new N("Data to large for user specified layer")}else{I=0,k=null;for(let Me=0;;Me++){if(Me>ln.MAX_NB_BITS)throw new N("Data too large for an Aztec code");if(y=Me<=3,A=y?Me+1:Me,T=ln.totalBitsInLayer(A,y),m>T)continue;(k==null||I!==ln.WORD_SIZE[A])&&(I=ln.WORD_SIZE[A],k=ln.stuffBits(u,I));let Zt=T-T%I;if(!(y&&k.getSize()>I*64)&&k.getSize()+f<=Zt)break}}let L=ln.generateCheckWords(k,T,I),G=k.getSize()/I,Q=ln.generateModeMessage(y,A,G),J=(y?11:14)+A*4,se=new Int32Array(J),ye;if(y){ye=J;for(let Me=0;Me<se.length;Me++)se[Me]=Me}else{ye=J+1+2*de.truncDivision(de.truncDivision(J,2)-1,15);let Me=de.truncDivision(J,2),Zt=de.truncDivision(ye,2);for(let Ut=0;Ut<Me;Ut++){let fr=Ut+de.truncDivision(Ut,15);se[Me-Ut-1]=Zt-fr-1,se[Me+Ut]=Zt+fr+1}}let Ue=new rt(ye);for(let Me=0,Zt=0;Me<A;Me++){let Ut=(A-Me)*4+(y?9:12);for(let fr=0;fr<Ut;fr++){let Ni=fr*2;for(let Wr=0;Wr<2;Wr++)L.get(Zt+Ni+Wr)&&Ue.set(se[Me*2+Wr],se[Me*2+fr]),L.get(Zt+Ut*2+Ni+Wr)&&Ue.set(se[Me*2+fr],se[J-1-Me*2-Wr]),L.get(Zt+Ut*4+Ni+Wr)&&Ue.set(se[J-1-Me*2-Wr],se[J-1-Me*2-fr]),L.get(Zt+Ut*6+Ni+Wr)&&Ue.set(se[J-1-Me*2-fr],se[Me*2+Wr])}Zt+=Ut*8}if(ln.drawModeMessage(Ue,y,ye,Q),y)ln.drawBullsEye(Ue,de.truncDivision(ye,2),5);else{ln.drawBullsEye(Ue,de.truncDivision(ye,2),7);for(let Me=0,Zt=0;Me<de.truncDivision(J,2)-1;Me+=15,Zt+=16)for(let Ut=de.truncDivision(ye,2)&1;Ut<ye;Ut+=2)Ue.set(de.truncDivision(ye,2)-Zt,Ut),Ue.set(de.truncDivision(ye,2)+Zt,Ut),Ue.set(Ut,de.truncDivision(ye,2)-Zt),Ue.set(Ut,de.truncDivision(ye,2)+Zt)}let Be=new jn;return Be.setCompact(y),Be.setSize(ye),Be.setLayers(A),Be.setCodeWords(G),Be.setMatrix(Ue),Be}static drawBullsEye(r,a,l){for(let u=0;u<l;u+=2)for(let f=a-u;f<=a+u;f++)r.set(f,a-u),r.set(f,a+u),r.set(a-u,f),r.set(a+u,f);r.set(a-l,a-l),r.set(a-l+1,a-l),r.set(a-l,a-l+1),r.set(a+l,a-l),r.set(a+l,a-l+1),r.set(a+l,a+l-1)}static generateModeMessage(r,a,l){let u=new Pe;return r?(u.appendBits(a-1,2),u.appendBits(l-1,6),u=ln.generateCheckWords(u,28,4)):(u.appendBits(a-1,5),u.appendBits(l-1,11),u=ln.generateCheckWords(u,40,4)),u}static drawModeMessage(r,a,l,u){let f=de.truncDivision(l,2);if(a)for(let m=0;m<7;m++){let y=f-3+m;u.get(m)&&r.set(y,f-5),u.get(m+7)&&r.set(f+5,y),u.get(20-m)&&r.set(y,f+5),u.get(27-m)&&r.set(f-5,y)}else for(let m=0;m<10;m++){let y=f-5+m+de.truncDivision(m,5);u.get(m)&&r.set(y,f-7),u.get(m+10)&&r.set(f+7,y),u.get(29-m)&&r.set(y,f+7),u.get(39-m)&&r.set(f-7,y)}}static generateCheckWords(r,a,l){let u=r.getSize()/l,f=new is(ln.getGF(l)),m=de.truncDivision(a,l),y=ln.bitsToWords(r,l,m);f.encode(y,m-u);let A=a%l,T=new Pe;T.appendBits(0,A);for(const I of Array.from(y))T.appendBits(I,l);return T}static bitsToWords(r,a,l){let u=new Int32Array(l),f,m;for(f=0,m=r.getSize()/a;f<m;f++){let y=0;for(let A=0;A<a;A++)y|=r.get(f*a+A)?1<<a-A-1:0;u[f]=y}return u}static getGF(r){switch(r){case 4:return He.AZTEC_PARAM;case 6:return He.AZTEC_DATA_6;case 8:return He.AZTEC_DATA_8;case 10:return He.AZTEC_DATA_10;case 12:return He.AZTEC_DATA_12;default:throw new N("Unsupported word size "+r)}}static stuffBits(r,a){let l=new Pe,u=r.getSize(),f=(1<<a)-2;for(let m=0;m<u;m+=a){let y=0;for(let A=0;A<a;A++)(m+A>=u||r.get(m+A))&&(y|=1<<a-1-A);(y&f)===f?(l.appendBits(y&f,a),m--):(y&f)===0?(l.appendBits(y|1,a),m--):l.appendBits(y,a)}return l}static totalBitsInLayer(r,a){return((a?88:112)+16*r)*r}}ln.DEFAULT_EC_PERCENT=33,ln.DEFAULT_AZTEC_LAYERS=0,ln.MAX_NB_BITS=32,ln.MAX_NB_BITS_COMPACT=4,ln.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ho{encode(r,a,l,u){return this.encodeWithHints(r,a,l,u,null)}encodeWithHints(r,a,l,u,f){let m=mn.ISO_8859_1,y=ln.DEFAULT_EC_PERCENT,A=ln.DEFAULT_AZTEC_LAYERS;return f!=null&&(f.has(rr.CHARACTER_SET)&&(m=ir.forName(f.get(rr.CHARACTER_SET).toString())),f.has(rr.ERROR_CORRECTION)&&(y=de.parseInt(f.get(rr.ERROR_CORRECTION).toString())),f.has(rr.AZTEC_LAYERS)&&(A=de.parseInt(f.get(rr.AZTEC_LAYERS).toString()))),Ho.encodeLayers(r,a,l,u,m,y,A)}static encodeLayers(r,a,l,u,f,m,y){if(a!==we.AZTEC)throw new N("Can only encode AZTEC, but got "+a);let A=ln.encode(Y.getBytes(r,f),m,y);return Ho.renderResult(A,l,u)}static renderResult(r,a,l){let u=r.getMatrix();if(u==null)throw new yt;let f=u.getWidth(),m=u.getHeight(),y=Math.max(a,f),A=Math.max(l,m),T=Math.min(y/f,A/m),I=(y-f*T)/2,k=(A-m*T)/2,L=new rt(y,A);for(let G=0,Q=k;G<m;G++,Q+=T)for(let J=0,se=I;J<f;J++,se+=T)u.get(J,G)&&L.setRegion(se,Q,T,T);return L}}n.AbstractExpandedDecoder=Hn,n.ArgumentException=S,n.ArithmeticException=$e,n.AztecCode=jn,n.AztecCodeReader=st,n.AztecCodeWriter=Ho,n.AztecDecoder=ht,n.AztecDetector=kn,n.AztecDetectorResult=St,n.AztecEncoder=ln,n.AztecHighLevelEncoder=la,n.AztecPoint=nt,n.BarcodeFormat=we,n.Binarizer=te,n.BinaryBitmap=P,n.BitArray=Pe,n.BitMatrix=rt,n.BitSource=tr,n.BrowserAztecCodeReader=Xt,n.BrowserBarcodeReader=Po,n.BrowserCodeReader=De,n.BrowserDatamatrixCodeReader=ts,n.BrowserMultiFormatReader=rs,n.BrowserPDF417Reader=xl,n.BrowserQRCodeReader=_l,n.BrowserQRCodeSvgWriter=U,n.CharacterSetECI=V,n.ChecksumException=X,n.Code128Reader=Te,n.Code39Reader=kt,n.DataMatrixDecodedBitStreamParser=Yr,n.DataMatrixReader=si,n.DecodeHintType=qe,n.DecoderResult=Mt,n.DefaultGridSampler=Ge,n.DetectorResult=Ur,n.EAN13Reader=An,n.EncodeHintType=rr,n.Exception=_,n.FormatException=F,n.GenericGF=He,n.GenericGFPoly=Ie,n.GlobalHistogramBinarizer=ce,n.GridSampler=Ae,n.GridSamplerInstance=Je,n.HTMLCanvasElementLuminanceSource=ct,n.HybridBinarizer=ne,n.ITFReader=mt,n.IllegalArgumentException=N,n.IllegalStateException=yt,n.InvertedLuminanceSource=pt,n.LuminanceSource=ze,n.MathUtils=Qe,n.MultiFormatOneDReader=qr,n.MultiFormatReader=Uo,n.MultiFormatWriter=Ee,n.NotFoundException=ae,n.OneDReader=et,n.PDF417DecodedBitStreamParser=me,n.PDF417DecoderErrorCorrection=Fi,n.PDF417Reader=nr,n.PDF417ResultMetadata=_s,n.PerspectiveTransform=Re,n.PlanarYUVLuminanceSource=Fe,n.QRCodeByteMatrix=sa,n.QRCodeDataMask=xr,n.QRCodeDecodedBitStreamParser=Cn,n.QRCodeDecoderErrorCorrectionLevel=Wt,n.QRCodeDecoderFormatInformation=or,n.QRCodeEncoder=O,n.QRCodeEncoderQRCode=ss,n.QRCodeMaskUtil=$t,n.QRCodeMatrixUtil=p,n.QRCodeMode=Et,n.QRCodeReader=ci,n.QRCodeVersion=ot,n.QRCodeWriter=ie,n.RGBLuminanceSource=Pt,n.RSS14Reader=_n,n.RSSExpandedReader=Ne,n.ReaderException=ia,n.ReedSolomonDecoder=Ct,n.ReedSolomonEncoder=is,n.ReedSolomonException=bt,n.Result=Ve,n.ResultMetadataType=xt,n.ResultPoint=Xe,n.StringUtils=Y,n.UnsupportedOperationException=Z,n.VideoInputDevice=K,n.WhiteRectangleDetector=Tt,n.WriterException=nn,n.ZXingArrays=ke,n.ZXingCharset=ir,n.ZXingInteger=de,n.ZXingStandardCharsets=mn,n.ZXingStringBuilder=H,n.ZXingStringEncoding=q,n.ZXingSystem=oe,n.createAbstractExpandedDecoder=hr,Object.defineProperty(n,"__esModule",{value:!0})}))})(uu,uu.exports)),uu.exports}var Jn=K4();const Q4=tg(Jn),Z4=xb({__proto__:null,default:Q4},[Jn]);var tx=(function(){function s(e,n,o){if(this.formatMap=new Map([[at.QR_CODE,Jn.BarcodeFormat.QR_CODE],[at.AZTEC,Jn.BarcodeFormat.AZTEC],[at.CODABAR,Jn.BarcodeFormat.CODABAR],[at.CODE_39,Jn.BarcodeFormat.CODE_39],[at.CODE_93,Jn.BarcodeFormat.CODE_93],[at.CODE_128,Jn.BarcodeFormat.CODE_128],[at.DATA_MATRIX,Jn.BarcodeFormat.DATA_MATRIX],[at.MAXICODE,Jn.BarcodeFormat.MAXICODE],[at.ITF,Jn.BarcodeFormat.ITF],[at.EAN_13,Jn.BarcodeFormat.EAN_13],[at.EAN_8,Jn.BarcodeFormat.EAN_8],[at.PDF_417,Jn.BarcodeFormat.PDF_417],[at.RSS_14,Jn.BarcodeFormat.RSS_14],[at.RSS_EXPANDED,Jn.BarcodeFormat.RSS_EXPANDED],[at.UPC_A,Jn.BarcodeFormat.UPC_A],[at.UPC_E,Jn.BarcodeFormat.UPC_E],[at.UPC_EAN_EXTENSION,Jn.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Z4)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=o;var h=this.createZXingFormats(e),g=new Map;g.set(Jn.DecodeHintType.POSSIBLE_FORMATS,h),g.set(Jn.DecodeHintType.TRY_HARDER,!1),this.hints=g}return s.prototype.decodeAsync=function(e){var n=this;return new Promise(function(o,h){try{o(n.decode(e))}catch(g){h(g)}})},s.prototype.decode=function(e){var n=new Jn.MultiFormatReader(this.verbose,this.hints),o=new Jn.HTMLCanvasElementLuminanceSource(e),h=new Jn.BinaryBitmap(new Jn.HybridBinarizer(o)),g=n.decode(h);return{text:g.text,format:VA.create(this.toHtml5QrcodeSupportedFormats(g.format)),debugData:this.createDebugData()}},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,o,h){e.set(n,o)}),e},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createZXingFormats=function(e){for(var n=[],o=0,h=e;o<h.length;o++){var g=h[o];this.formatMap.has(g)?n.push(this.formatMap.get(g)):this.logger.logError("".concat(g," is not supported by")+"ZXingHtml5QrcodeShim")}return n},s.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},s})(),J4=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(E){E(g)})}return new(n||(n=Promise))(function(g,E){function v(S){try{_(o.next(S))}catch(N){E(N)}}function b(S){try{_(o.throw(S))}catch(N){E(N)}}function _(S){S.done?g(S.value):h(S.value).then(v,b)}_((o=o.apply(s,e||[])).next())})},$4=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,E;return E={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function v(_){return function(S){return b([_,S])}}function b(_){if(o)throw new TypeError("Generator is already executing.");for(;E&&(E=0,_[0]&&(n=0)),n;)try{if(o=1,h&&(g=_[0]&2?h.return:_[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,_[1])).done)return g;switch(h=0,g&&(_=[_[0]&2,g.value]),_[0]){case 0:case 1:g=_;break;case 4:return n.label++,{value:_[1],done:!1};case 5:n.label++,h=_[1],_=[0];continue;case 7:_=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(_[0]===6||_[0]===2)){n=0;continue}if(_[0]===3&&(!g||_[1]>g[0]&&_[1]<g[3])){n.label=_[1];break}if(_[0]===6&&n.label<g[1]){n.label=g[1],g=_;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(_);break}g[2]&&n.ops.pop(),n.trys.pop();continue}_=e.call(s,n)}catch(S){_=[6,S],h=0}finally{o=g=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},nx=(function(){function s(e,n,o){if(this.formatMap=new Map([[at.QR_CODE,"qr_code"],[at.AZTEC,"aztec"],[at.CODABAR,"codabar"],[at.CODE_39,"code_39"],[at.CODE_93,"code_93"],[at.CODE_128,"code_128"],[at.DATA_MATRIX,"data_matrix"],[at.ITF,"itf"],[at.EAN_13,"ean_13"],[at.EAN_8,"ean_8"],[at.PDF_417,"pdf417"],[at.UPC_A,"upc_a"],[at.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!s.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=o;var h=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(h),!this.detector)throw"BarcodeDetector detector not supported"}return s.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},s.prototype.decodeAsync=function(e){return J4(this,void 0,void 0,function(){var n,o;return $4(this,function(h){switch(h.label){case 0:return[4,this.detector.detect(e)];case 1:if(n=h.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return o=this.selectLargestBarcode(n),[2,{text:o.rawValue,format:VA.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}]}})})},s.prototype.selectLargestBarcode=function(e){for(var n=null,o=0,h=0,g=e;h<g.length;h++){var E=g[h],v=E.boundingBox.width*E.boundingBox.height;v>o&&(o=v,n=E)}if(!n)throw"No largest barcode found";return n},s.prototype.createBarcodeDetectorFormats=function(e){for(var n=[],o=0,h=e;o<h.length;o++){var g=h[o];this.formatMap.has(g)?n.push(this.formatMap.get(g)):this.logger.warn("".concat(g," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,o,h){e.set(n,o)}),e},s.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},s})(),rx=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(E){E(g)})}return new(n||(n=Promise))(function(g,E){function v(S){try{_(o.next(S))}catch(N){E(N)}}function b(S){try{_(o.throw(S))}catch(N){E(N)}}function _(S){S.done?g(S.value):h(S.value).then(v,b)}_((o=o.apply(s,e||[])).next())})},ix=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,E;return E={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function v(_){return function(S){return b([_,S])}}function b(_){if(o)throw new TypeError("Generator is already executing.");for(;E&&(E=0,_[0]&&(n=0)),n;)try{if(o=1,h&&(g=_[0]&2?h.return:_[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,_[1])).done)return g;switch(h=0,g&&(_=[_[0]&2,g.value]),_[0]){case 0:case 1:g=_;break;case 4:return n.label++,{value:_[1],done:!1};case 5:n.label++,h=_[1],_=[0];continue;case 7:_=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(_[0]===6||_[0]===2)){n=0;continue}if(_[0]===3&&(!g||_[1]>g[0]&&_[1]<g[3])){n.label=_[1];break}if(_[0]===6&&n.label<g[1]){n.label=g[1],g=_;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(_);break}g[2]&&n.ops.pop(),n.trys.pop();continue}_=e.call(s,n)}catch(S){_=[6,S],h=0}finally{o=g=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},e8=(function(){function s(e,n,o,h){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=o,n&&nx.isSupported()?(this.primaryDecoder=new nx(e,o,h),this.secondaryDecoder=new tx(e,o,h)):this.primaryDecoder=new tx(e,o,h)}return s.prototype.decodeAsync=function(e){return rx(this,void 0,void 0,function(){var n;return ix(this,function(o){switch(o.label){case 0:n=performance.now(),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,o.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},s.prototype.decodeRobustlyAsync=function(e){return rx(this,void 0,void 0,function(){var n,o;return ix(this,function(h){switch(h.label){case 0:n=performance.now(),h.label=1;case 1:return h.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,h.sent()];case 3:if(o=h.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw o;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},s.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},s.prototype.possiblyLogPerformance=function(e){if(this.verbose){var n=performance.now()-e;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},s.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,n=0,o=this.executionResults;n<o.length;n++){var h=o[n];e+=h}var g=e/this.executionResults.length;console.log("".concat(g," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},s})(),nm=(function(){var s=function(e,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(o[g]=h[g])},s(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");s(e,n);function o(){this.constructor=e}e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}})(),Bf=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(E){E(g)})}return new(n||(n=Promise))(function(g,E){function v(S){try{_(o.next(S))}catch(N){E(N)}}function b(S){try{_(o.throw(S))}catch(N){E(N)}}function _(S){S.done?g(S.value):h(S.value).then(v,b)}_((o=o.apply(s,e||[])).next())})},Vf=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,E;return E={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function v(_){return function(S){return b([_,S])}}function b(_){if(o)throw new TypeError("Generator is already executing.");for(;E&&(E=0,_[0]&&(n=0)),n;)try{if(o=1,h&&(g=_[0]&2?h.return:_[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,_[1])).done)return g;switch(h=0,g&&(_=[_[0]&2,g.value]),_[0]){case 0:case 1:g=_;break;case 4:return n.label++,{value:_[1],done:!1};case 5:n.label++,h=_[1],_=[0];continue;case 7:_=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(_[0]===6||_[0]===2)){n=0;continue}if(_[0]===3&&(!g||_[1]>g[0]&&_[1]<g[3])){n.label=_[1];break}if(_[0]===6&&n.label<g[1]){n.label=g[1],g=_;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(_);break}g[2]&&n.ops.pop(),n.trys.pop();continue}_=e.call(s,n)}catch(S){_=[6,S],h=0}finally{o=g=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},FA=(function(){function s(e,n){this.name=e,this.track=n}return s.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},s.prototype.apply=function(e){var n={};n[this.name]=e;var o={advanced:[n]};return this.track.applyConstraints(o)},s.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var n=e[this.name];return n}return null},s})(),t8=(function(s){nm(e,s);function e(n,o){return s.call(this,n,o)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(n){var o={};o[this.name]=n;var h={advanced:[o]};return this.track.applyConstraints(h)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),o=n[this.name];return{min:o.min,max:o.max,step:o.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e})(FA),n8=(function(s){nm(e,s);function e(n){return s.call(this,"zoom",n)||this}return e})(t8),r8=(function(s){nm(e,s);function e(n){return s.call(this,"torch",n)||this}return e})(FA),i8=(function(){function s(e){this.track=e}return s.prototype.zoomFeature=function(){return new n8(this.track)},s.prototype.torchFeature=function(){return new r8(this.track)},s})(),s8=(function(){function s(e,n,o){this.isClosed=!1,this.parentElement=e,this.mediaStream=n,this.callbacks=o,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return s.prototype.createVideoElement=function(e){var n=document.createElement("video");return n.style.width="".concat(e,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},s.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var o=e.surface.clientWidth,h=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(o,h),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},s.create=function(e,n,o,h){return Bf(this,void 0,void 0,function(){var g,E;return Vf(this,function(v){switch(v.label){case 0:return g=new s(e,n,h),o.aspectRatio?(E={aspectRatio:o.aspectRatio},[4,g.getFirstTrackOrFail().applyConstraints(E)]):[3,2];case 1:v.sent(),v.label=2;case 2:return g.setupSurface(),[2,g]}})})},s.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},s.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},s.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},s.prototype.resume=function(e){this.failIfClosed();var n=this,o=function(){setTimeout(e,200),n.surface.removeEventListener("playing",o)};this.surface.addEventListener("playing",o),this.surface.play()},s.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},s.prototype.getSurface=function(){return this.failIfClosed(),this.surface},s.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},s.prototype.applyVideoConstraints=function(e){return Bf(this,void 0,void 0,function(){return Vf(this,function(n){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},s.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(n,o){var h=e.mediaStream.getVideoTracks(),g=h.length,E=0;e.mediaStream.getVideoTracks().forEach(function(v){e.mediaStream.removeTrack(v),v.stop(),++E,E>=g&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),n())})})},s.prototype.getCapabilities=function(){return new i8(this.getFirstTrackOrFail())},s})(),a8=(function(){function s(e){this.mediaStream=e}return s.prototype.render=function(e,n,o){return Bf(this,void 0,void 0,function(){return Vf(this,function(h){return[2,s8.create(e,this.mediaStream,n,o)]})})},s.create=function(e){return Bf(this,void 0,void 0,function(){var n,o;return Vf(this,function(h){switch(h.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return o=h.sent(),[2,new s(o)]}})})},s})(),sx=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(E){E(g)})}return new(n||(n=Promise))(function(g,E){function v(S){try{_(o.next(S))}catch(N){E(N)}}function b(S){try{_(o.throw(S))}catch(N){E(N)}}function _(S){S.done?g(S.value):h(S.value).then(v,b)}_((o=o.apply(s,e||[])).next())})},ax=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,E;return E={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function v(_){return function(S){return b([_,S])}}function b(_){if(o)throw new TypeError("Generator is already executing.");for(;E&&(E=0,_[0]&&(n=0)),n;)try{if(o=1,h&&(g=_[0]&2?h.return:_[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,_[1])).done)return g;switch(h=0,g&&(_=[_[0]&2,g.value]),_[0]){case 0:case 1:g=_;break;case 4:return n.label++,{value:_[1],done:!1};case 5:n.label++,h=_[1],_=[0];continue;case 7:_=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(_[0]===6||_[0]===2)){n=0;continue}if(_[0]===3&&(!g||_[1]>g[0]&&_[1]<g[3])){n.label=_[1];break}if(_[0]===6&&n.label<g[1]){n.label=g[1],g=_;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(_);break}g[2]&&n.ops.pop(),n.trys.pop();continue}_=e.call(s,n)}catch(S){_=[6,S],h=0}finally{o=g=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},o8=(function(){function s(){}return s.failIfNotSupported=function(){return sx(this,void 0,void 0,function(){return ax(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new s]})})},s.prototype.create=function(e){return sx(this,void 0,void 0,function(){return ax(this,function(n){return[2,a8.create(e)]})})},s})(),l8=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(E){E(g)})}return new(n||(n=Promise))(function(g,E){function v(S){try{_(o.next(S))}catch(N){E(N)}}function b(S){try{_(o.throw(S))}catch(N){E(N)}}function _(S){S.done?g(S.value):h(S.value).then(v,b)}_((o=o.apply(s,e||[])).next())})},c8=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,E;return E={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function v(_){return function(S){return b([_,S])}}function b(_){if(o)throw new TypeError("Generator is already executing.");for(;E&&(E=0,_[0]&&(n=0)),n;)try{if(o=1,h&&(g=_[0]&2?h.return:_[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,_[1])).done)return g;switch(h=0,g&&(_=[_[0]&2,g.value]),_[0]){case 0:case 1:g=_;break;case 4:return n.label++,{value:_[1],done:!1};case 5:n.label++,h=_[1],_=[0];continue;case 7:_=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(_[0]===6||_[0]===2)){n=0;continue}if(_[0]===3&&(!g||_[1]>g[0]&&_[1]<g[3])){n.label=_[1];break}if(_[0]===6&&n.label<g[1]){n.label=g[1],g=_;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(_);break}g[2]&&n.ops.pop(),n.trys.pop();continue}_=e.call(s,n)}catch(S){_=[6,S],h=0}finally{o=g=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},u8=(function(){function s(){}return s.retrieve=function(){if(navigator.mediaDevices)return s.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?s.getCamerasFromMediaStreamTrack():s.rejectWithError()},s.rejectWithError=function(){var e=$l.unableToQuerySupportedDevices();return s.isHttpsOrLocalhost()||(e=$l.insecureContextCameraQueryError()),Promise.reject(e)},s.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},s.getCamerasFromMediaDevices=function(){return l8(this,void 0,void 0,function(){var e,n,o,h,g,E,v;return c8(this,function(b){switch(b.label){case 0:return e=function(_){for(var S=_.getVideoTracks(),N=0,P=S;N<P.length;N++){var X=P[N];X.enabled=!1,X.stop(),_.removeTrack(X)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=b.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(o=b.sent(),h=[],g=0,E=o;g<E.length;g++)v=E[g],v.kind==="videoinput"&&h.push({id:v.deviceId,label:v.label});return e(n),[2,h]}})})},s.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,n){var o=function(g){for(var E=[],v=0,b=g;v<b.length;v++){var _=b[v];_.kind==="video"&&E.push({id:_.id,label:_.label})}e(E)},h=MediaStreamTrack;h.getSources(o)})},s})(),pr;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.NOT_STARTED=1]="NOT_STARTED",s[s.SCANNING=2]="SCANNING",s[s.PAUSED=3]="PAUSED"})(pr||(pr={}));var h8=(function(){function s(){this.state=pr.NOT_STARTED,this.onGoingTransactionNewState=pr.UNKNOWN}return s.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},s.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},s.prototype.execute=function(){if(this.onGoingTransactionNewState===pr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=pr.UNKNOWN,this.directTransition(e)},s.prototype.cancel=function(){if(this.onGoingTransactionNewState===pr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=pr.UNKNOWN},s.prototype.getState=function(){return this.state},s.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==pr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},s.prototype.validateTransition=function(e){switch(this.state){case pr.UNKNOWN:throw"Transition from unknown is not allowed";case pr.NOT_STARTED:this.failIfNewStateIs(e,[pr.PAUSED]);break;case pr.SCANNING:break;case pr.PAUSED:break}},s.prototype.failIfNewStateIs=function(e,n){for(var o=0,h=n;o<h.length;o++){var g=h[o];if(e===g)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},s})(),f8=(function(){function s(e){this.stateManager=e}return s.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},s.prototype.directTransition=function(e){this.stateManager.directTransition(e)},s.prototype.getState=function(){return this.stateManager.getState()},s.prototype.canScanFile=function(){return this.stateManager.getState()===pr.NOT_STARTED},s.prototype.isScanning=function(){return this.stateManager.getState()!==pr.NOT_STARTED},s.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===pr.SCANNING},s.prototype.isPaused=function(){return this.stateManager.getState()===pr.PAUSED},s})(),d8=(function(){function s(){}return s.create=function(){return new f8(new h8)},s})(),g8=(function(){var s=function(e,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(o[g]=h[g])},s(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");s(e,n);function o(){this.constructor=e}e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}})(),Ji=(function(s){g8(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e})(q4),m8=(function(){function s(e,n){this.logger=n,this.fps=Ji.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=Ji.DEFAULT_DISABLE_FLIP}return s.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?UA.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},s.prototype.isShadedBoxEnabled=function(){return!va(this.qrbox)},s.create=function(e,n){return new s(e,n)},s})(),p8=(function(){function s(e,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var o;typeof n=="boolean"?this.verbose=n===!0:n&&(o=n,this.verbose=o.verbose===!0,o.experimentalFeatures),this.logger=new Y4(this.verbose),this.qrcode=new e8(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(o),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=d8.create()}return s.prototype.start=function(e,n,o,h){var g=this;if(!e)throw"cameraIdOrConfig is required";if(!o||typeof o!="function")throw"qrCodeSuccessCallback is required and should be a function.";var E;h?E=h:E=this.verbose?this.logger.log:function(){};var v=m8.create(n,this.logger);this.clearElement();var b=!1;v.videoConstraints&&(v.isMediaStreamConstraintsValid()?b=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var _=b,S=document.getElementById(this.elementId);S.clientWidth?S.clientWidth:Ji.DEFAULT_WIDTH,S.style.position="relative",this.shouldScan=!0,this.element=S;var N=this,P=this.stateManagerProxy.startTransition(pr.SCANNING);return new Promise(function(X,te){var oe=_?v.videoConstraints:N.createVideoConstraints(e);if(!oe){P.cancel(),te("videoConstraints should be defined");return}var ue={};(!_||v.aspectRatio)&&(ue.aspectRatio=v.aspectRatio);var Ye={onRenderSurfaceReady:function(ke,de){N.setupUi(ke,de,v),N.isScanning=!0,N.foreverScan(v,o,E)}};o8.failIfNotSupported().then(function(ke){ke.create(oe).then(function(de){return de.render(g.element,ue,Ye).then(function(Pe){N.renderedCamera=Pe,P.execute(),X(null)}).catch(function(Pe){P.cancel(),te(Pe)})}).catch(function(de){P.cancel(),te($l.errorGettingUserMedia(de))})}).catch(function(ke){P.cancel(),te($l.cameraStreamingNotSupported())})})},s.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(pr.PAUSED),this.showPausedState(),(va(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},s.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,n=function(){e.stateManagerProxy.directTransition(pr.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},s.prototype.getState=function(){return this.stateManagerProxy.getState()},s.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(pr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var o=function(){if(e.element){var g=document.getElementById(Ji.SHADED_REGION_ELEMENT_ID);g&&e.element.removeChild(g)}},h=this;return this.renderedCamera.close().then(function(){return h.renderedCamera=null,h.element&&(h.element.removeChild(h.canvasElement),h.canvasElement=null),o(),h.qrRegion&&(h.qrRegion=null),h.context&&(h.context=null),n.execute(),h.hidePausedState(),h.isScanning=!1,Promise.resolve()})},s.prototype.scanFile=function(e,n){return this.scanFileV2(e,n).then(function(o){return o.decodedText})},s.prototype.scanFileV2=function(e,n){var o=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(va(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(h,g){o.possiblyCloseLastScanImageFile(),o.clearElement(),o.lastScanImageFile=URL.createObjectURL(e);var E=new Image;E.onload=function(){var v=E.width,b=E.height,_=document.getElementById(o.elementId),S=_.clientWidth?_.clientWidth:Ji.DEFAULT_WIDTH,N=Math.max(_.clientHeight?_.clientHeight:b,Ji.FILE_SCAN_MIN_HEIGHT),P=o.computeCanvasDrawConfig(v,b,S,N);if(n){var X=o.createCanvasElement(S,N,"qr-canvas-visible");X.style.display="inline-block",_.appendChild(X);var te=X.getContext("2d");if(!te)throw"Unable to get 2d context from canvas";te.canvas.width=S,te.canvas.height=N,te.drawImage(E,0,0,v,b,P.x,P.y,P.width,P.height)}var oe=Ji.FILE_SCAN_HIDDEN_CANVAS_PADDING,ue=Math.max(E.width,P.width),Ye=Math.max(E.height,P.height),ke=ue+2*oe,de=Ye+2*oe,Pe=o.createCanvasElement(ke,de);_.appendChild(Pe);var ft=Pe.getContext("2d");if(!ft)throw"Unable to get 2d context from canvas";ft.canvas.width=ke,ft.canvas.height=de,ft.drawImage(E,0,0,v,b,oe,oe,ue,Ye);try{o.qrcode.decodeRobustlyAsync(Pe).then(function(qe){h($E.createFromQrcodeResult(qe))}).catch(g)}catch(qe){g("QR code parse error, error = ".concat(qe))}},E.onerror=g,E.onabort=g,E.onstalled=g,E.onsuspend=g,E.src=URL.createObjectURL(e)})},s.prototype.clear=function(){this.clearElement()},s.getCameras=function(){return u8.retrieve()},s.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},s.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},s.prototype.applyVideoConstraints=function(e){if(e){if(!UA.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},s.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},s.prototype.getSupportedFormats=function(e){var n=[at.QR_CODE,at.AZTEC,at.CODABAR,at.CODE_39,at.CODE_93,at.CODE_128,at.DATA_MATRIX,at.MAXICODE,at.ITF,at.EAN_13,at.EAN_8,at.PDF_417,at.RSS_14,at.RSS_EXPANDED,at.UPC_A,at.UPC_E,at.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return n;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var o=[],h=0,g=e.formatsToSupport;h<g.length;h++){var E=g[h];G4(E)?o.push(E):this.logger.warn("Invalid format: ".concat(E," passed in config, ignoring."))}if(o.length===0)throw"None of formatsToSupport match supported values.";return o},s.prototype.getUseBarCodeDetectorIfSupported=function(e){if(va(e))return!0;if(!va(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(va(e.experimentalFeatures))return!0;var n=e.experimentalFeatures;return va(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},s.prototype.validateQrboxSize=function(e,n,o){var h=this,g=o.qrbox;this.validateQrboxConfig(g);var E=this.toQrdimensions(e,n,g),v=function(_){if(_<Ji.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ji.MIN_QR_BOX_SIZE,"px.")},b=function(_){return _>e&&(h.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),_=e),_};v(E.width),v(E.height),E.width=b(E.width)},s.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},s.prototype.toQrdimensions=function(e,n,o){if(typeof o=="number")return{width:o,height:o};if(typeof o=="function")try{return o(e,n)}catch(h){throw new Error("qrbox config was passed as a function but it failed with unknown error"+h)}return o},s.prototype.setupUi=function(e,n,o){o.isShadedBoxEnabled()&&this.validateQrboxSize(e,n,o);var h=va(o.qrbox)?{width:e,height:n}:o.qrbox;this.validateQrboxConfig(h);var g=this.toQrdimensions(e,n,h);g.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var E=o.isShadedBoxEnabled()&&g.height<=n,v={x:0,y:0,width:e,height:n},b=E?this.getShadedRegionBounds(e,n,g):v,_=this.createCanvasElement(b.width,b.height),S={willReadFrequently:!0},N=_.getContext("2d",S);N.canvas.width=b.width,N.canvas.height=b.height,this.element.append(_),E&&this.possiblyInsertShadingElement(this.element,e,n,g),this.createScannerPausedUiElement(this.element),this.qrRegion=b,this.context=N,this.canvasElement=_},s.prototype.createScannerPausedUiElement=function(e){var n=document.createElement("div");n.innerText=$l.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",e.appendChild(n),this.scannerPausedUiElement=n},s.prototype.scanContext=function(e,n){var o=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(h){return e(h.text,$E.createFromQrcodeResult(h)),o.possiblyUpdateShaders(!0),!0}).catch(function(h){o.possiblyUpdateShaders(!1);var g=$l.codeParseError(h);return n(g,X4.createFrom(g)),!1})},s.prototype.foreverScan=function(e,n,o){var h=this;if(this.shouldScan&&this.renderedCamera){var g=this.renderedCamera.getSurface(),E=g.videoWidth/g.clientWidth,v=g.videoHeight/g.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var b=this.qrRegion.width*E,_=this.qrRegion.height*v,S=this.qrRegion.x*E,N=this.qrRegion.y*v;this.context.drawImage(g,S,N,b,_,0,0,this.qrRegion.width,this.qrRegion.height);var P=function(){h.foreverScanTimeout=setTimeout(function(){h.foreverScan(e,n,o)},h.getTimeoutFps(e.fps))};this.scanContext(n,o).then(function(X){!X&&e.disableFlip!==!0?(h.context.translate(h.context.canvas.width,0),h.context.scale(-1,1),h.scanContext(n,o).finally(function(){P()})):P()}).catch(function(X){h.logger.logError("Error happend while scanning context",X),P()})}},s.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var n="facingMode",o="deviceId",h={user:!0,environment:!0},g="exact",E=function(te){if(te in h)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(te,"'")},v=Object.keys(e);if(v.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(v.length," keys");var b=Object.keys(e)[0];if(b!==n&&b!==o)throw"Only '".concat(n,"' and '").concat(o,"' ")+" are supported for 'cameraIdOrConfig'";if(b===n){var _=e.facingMode;if(typeof _=="string"){if(E(_))return{facingMode:_}}else if(typeof _=="object")if(g in _){if(E(_["".concat(g)]))return{facingMode:{exact:_["".concat(g)]}}}else throw"'facingMode' should be string or object with"+" ".concat(g," as key.");else{var S=typeof _;throw"Invalid type of 'facingMode' = ".concat(S)}}else{var N=e.deviceId;if(typeof N=="string")return{deviceId:N};if(typeof N=="object"){if(g in N)return{deviceId:{exact:N["".concat(g)]}};throw"'deviceId' should be string or object with"+" ".concat(g," as key.")}else{var P=typeof N;throw"Invalid type of 'deviceId' = ".concat(P)}}}var X=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(X)},s.prototype.computeCanvasDrawConfig=function(e,n,o,h){if(e<=o&&n<=h){var g=(o-e)/2,E=(h-n)/2;return{x:g,y:E,width:e,height:n}}else{var v=e,b=n;return e>o&&(n=o/e*n,e=o),n>h&&(e=h/n*e,n=h),this.logger.log("Image downsampled from "+"".concat(v,"X").concat(b)+" to ".concat(e,"X").concat(n,".")),this.computeCanvasDrawConfig(e,n,o,h)}},s.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},s.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=e?Ji.BORDER_SHADER_MATCH_COLOR:Ji.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},s.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},s.prototype.createCanvasElement=function(e,n,o){var h=e,g=n,E=document.createElement("canvas");return E.style.width="".concat(h,"px"),E.style.height="".concat(g,"px"),E.style.display="none",E.id=va(o)?"qr-canvas":o,E},s.prototype.getShadedRegionBounds=function(e,n,o){if(o.width>e||o.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-o.width)/2,y:(n-o.height)/2,width:o.width,height:o.height}},s.prototype.possiblyInsertShadingElement=function(e,n,o,h){if(!(n-h.width<1||o-h.height<1)){var g=document.createElement("div");g.style.position="absolute";var E=(n-h.width)/2,v=(o-h.height)/2;if(g.style.borderLeft="".concat(E,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderRight="".concat(E,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderTop="".concat(v,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderBottom="".concat(v,"px solid rgba(0, 0, 0, 0.48)"),g.style.boxSizing="border-box",g.style.top="0px",g.style.bottom="0px",g.style.left="0px",g.style.right="0px",g.id="".concat(Ji.SHADED_REGION_ELEMENT_ID),n-h.width<11||o-h.height<11)this.hasBorderShaders=!1;else{var b=5,_=40;this.insertShaderBorders(g,_,b,-b,null,0,!0),this.insertShaderBorders(g,_,b,-b,null,0,!1),this.insertShaderBorders(g,_,b,null,-b,0,!0),this.insertShaderBorders(g,_,b,null,-b,0,!1),this.insertShaderBorders(g,b,_+b,-b,null,-b,!0),this.insertShaderBorders(g,b,_+b,null,-b,-b,!0),this.insertShaderBorders(g,b,_+b,-b,null,-b,!1),this.insertShaderBorders(g,b,_+b,null,-b,-b,!1),this.hasBorderShaders=!0}e.append(g)}},s.prototype.insertShaderBorders=function(e,n,o,h,g,E,v){var b=document.createElement("div");b.style.position="absolute",b.style.backgroundColor=Ji.BORDER_SHADER_DEFAULT_COLOR,b.style.width="".concat(n,"px"),b.style.height="".concat(o,"px"),h!==null&&(b.style.top="".concat(h,"px")),g!==null&&(b.style.bottom="".concat(g,"px")),v?b.style.left="".concat(E,"px"):b.style.right="".concat(E,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(b),e.appendChild(b)},s.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},s.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},s.prototype.getTimeoutFps=function(e){return 1e3/e},s})(),ox;(function(s){s[s.STATUS_DEFAULT=0]="STATUS_DEFAULT",s[s.STATUS_SUCCESS=1]="STATUS_SUCCESS",s[s.STATUS_WARNING=2]="STATUS_WARNING",s[s.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(ox||(ox={}));const y8=({onCode:s})=>(_e.useEffect(()=>{const e="qr-reader",n=new p8(e);return n.start({facingMode:"environment"},{fps:10,qrbox:250},o=>{s(o)},()=>{}).catch(o=>{console.error("Kunne ikke starte QR-leser:",o)}),()=>{n.stop().then(()=>n.clear()).catch(()=>{})}},[s]),D.jsx("div",{id:"qr-reader",style:{width:"100%"}}));async function E8(){const e=(await ei(wr(Nt,"terms"))).docs.map(n=>{const o=n.data(),h=typeof o?.value=="number"?o.value:void 0;if(typeof h!="number")return null;const g=typeof o?.label=="string"?o.label:"",E=typeof o?.order=="number"?o.order:void 0;return{value:h,label:g,order:E}}).filter(Boolean);return e.sort((n,o)=>(n.order??n.value)-(o.order??o.value)),e}function rm(){const[s,e]=_e.useState([]),[n,o]=_e.useState(!0),[h,g]=_e.useState(null);_e.useEffect(()=>{let v=!0;return(async()=>{try{o(!0);const b=await E8();v&&e(b)}catch(b){v&&g(b)}finally{v&&o(!1)}})(),()=>{v=!1}},[]);const E=_e.useMemo(()=>{const v=new Map;for(const b of s)v.set(b.value,b);return v},[s]);return{options:s,byValue:E,loading:n,error:h}}function ml(s,e){if(e==null)return"Ukjent termin";let n;return Array.isArray(s)?n=s.find(o=>o.value===e):s instanceof Map&&(n=s.get(e)),n&&n.label?n.label:`Termin ${e}`}function x8(s){if(s==="Testmodul 1 - Testtermin 1")return s;const e=/(Modul)\s+(\d+)\s*-\s*(Blokk|Termin)\s+(\d+)/i,n=s.match(e);if(n){const g=n[2],E=n[4];return`M${g} - T${E}`}const o=/(Modul|Termin)\s+(\d+)/i,h=s.match(o);return h?`M${h[2]}`:s}function _8(s,e){if(e==null)return"";const n=ml(s,e);return x8(n)}const A8={width:"100%",maxWidth:460,backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},nu={fontSize:"0.8rem"},ru={width:"100%",padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.9rem",marginTop:"0.15rem"},w8={padding:"0.35rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",cursor:"pointer",fontSize:"0.9rem"},tf={padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",color:"#111827",cursor:"pointer",fontSize:"0.9rem"};function im({uid:s,role:e,onClose:n,displayName:o,email:h}){const{options:g}=rm(),[E,v]=_e.useState(!0),[b,_]=_e.useState(!1),[S,N]=_e.useState(null),[P,X]=_e.useState(null),[te,oe]=_e.useState(""),[ue,Ye]=_e.useState(""),[ke,de]=_e.useState(h),[Pe,ft]=_e.useState(null),[qe,F]=_e.useState([]),[j,V]=_e.useState(""),[Z,q]=_e.useState(""),Y=e==="teacher"||e==="student";_e.useEffect(()=>{let ne=!0;return(async()=>{try{v(!0);const ze=Un(Nt,"users",s),pt=await gl(ze),ct=pt.exists()?pt.data():{};if(!ne)return;oe(String(ct.phone??"")),Ye(String(ct.secondaryEmail??"")),de(String(ct?.email??h)),ft(typeof ct.term=="number"?ct.term:null);const K=Array.isArray(ct.allowedTerms)?ct.allowedTerms.filter(pe=>typeof pe=="number"):[];F(K)}catch{ne&&N("Kunne ikke laste profildata.")}finally{ne&&v(!1)}})(),()=>{ne=!1}},[s]);const H=_e.useMemo(()=>qe.map(ne=>ml(g,ne)),[qe,g]),rt=async()=>{N(null),X(null),_(!0);try{const ne={phone:te.trim()||null};Y&&(ne.secondaryEmail=ue.trim()||null),await Cs(Un(Nt,"users",s),ne),X("Profilen er oppdatert.")}catch(ne){console.error(ne),N("Kunne ikke lagre profilendringer.")}finally{_(!1)}},ae=async()=>{N(null),X(null);const ne=ke.trim();if(!ne){N("Epost kan ikke vre tom.");return}if(ne===h){X("Eposten er uendret.");return}try{const ze=Eo.currentUser;if(!ze){N("Ingen innlogget bruker.");return}await pC(ze,ne),await Cs(Un(Nt,"users",s),{email:ne}),X("Epost er oppdatert.")}catch(ze){console.warn("updateEmail failed",ze),ze?.code==="auth/requires-recent-login"?N("Av sikkerhetshensyn m du logge inn p nytt fr du kan endre epost. Logg ut og inn igjen, og prv p nytt."):ze?.code==="auth/email-already-in-use"?N("Epostadressen er allerede i bruk av en annen bruker."):N("Kunne ikke oppdatere epost.")}},ce=async()=>{if(N(null),X(null),!j||j.length<6){N("Passord m vre minst 6 tegn.");return}if(j!==Z){N("Passordene er ikke like.");return}try{const ne=Eo.currentUser;if(!ne){N("Ingen innlogget bruker.");return}await yC(ne,j),X("Passordet er oppdatert."),V(""),q("")}catch(ne){if(console.warn("updatePassword failed",ne),ne?.code==="auth/requires-recent-login")try{await Uy(Eo,h),X("Vi har sendt en e-post for  tilbakestille passordet ditt. Sjekk innboksen.")}catch(ze){console.error(ze),N("Kunne ikke sende e-post for tilbakestilling.")}else N("Kunne ikke endre passord.")}};return D.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},"aria-modal":!0,role:"dialog",children:D.jsxs("div",{style:A8,children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[D.jsx("h3",{style:{margin:0},children:"Min profil"}),D.jsx("button",{type:"button",onClick:n,style:tf,children:"Lukk"})]}),D.jsx("p",{style:{marginTop:"0.25rem",fontSize:"0.85rem",color:"#6b7280"},children:o||h}),E?D.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"1rem 0"},children:"Laster..."}):D.jsxs(D.Fragment,{children:[D.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.6rem",marginTop:"0.5rem",marginBottom:"0.75rem"},children:[D.jsxs("label",{style:nu,children:["Mobilnummer",D.jsx("input",{type:"tel",value:te,onChange:ne=>oe(ne.target.value),placeholder:"Eks: 99999999",style:ru})]}),Y&&D.jsxs("label",{style:nu,children:["Sekundr epost",D.jsx("input",{type:"email",value:ue,onChange:ne=>Ye(ne.target.value),placeholder:"eksempel@uio.no",style:ru})]}),e==="student"&&D.jsxs("div",{style:{fontSize:"0.9rem",color:"#374151"},children:[D.jsx("div",{style:{fontWeight:600},children:"Din termin"}),D.jsx("div",{children:ml(g,Pe)})]}),e==="teacher"&&D.jsxs("div",{style:{fontSize:"0.9rem",color:"#374151"},children:[D.jsx("div",{style:{fontWeight:600},children:"Terminer du kan registrere p"}),qe.length===0?D.jsx("div",{children:"Ingen"}):D.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginTop:"0.25rem"},children:H.map((ne,ze)=>D.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",border:"1px solid #e5e7eb",borderRadius:"999px",background:"#f9fafb",fontSize:"0.8rem"},children:ne},ze))})]})]}),D.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:D.jsx("button",{type:"button",onClick:rt,style:w8,disabled:b,children:b?"Lagrer...":"Lagre endringer"})}),D.jsx("hr",{style:{margin:"1rem 0"}}),D.jsx("h4",{style:{marginTop:0},children:"Endre primr epost"}),D.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[D.jsxs("label",{style:nu,children:["Epost",D.jsx("input",{type:"email",value:ke,onChange:ne=>de(ne.target.value),placeholder:"din@epost.no",style:ru})]}),D.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:D.jsx("button",{type:"button",onClick:ae,style:tf,children:"Oppdater epost"})})]}),D.jsx("h4",{style:{marginTop:0},children:"Endre passord"}),D.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[D.jsxs("label",{style:nu,children:["Nytt passord",D.jsx("input",{type:"password",value:j,onChange:ne=>V(ne.target.value),placeholder:"Minst 6 tegn",style:ru})]}),D.jsxs("label",{style:nu,children:["Bekreft passord",D.jsx("input",{type:"password",value:Z,onChange:ne=>q(ne.target.value),style:ru})]}),D.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:ce,style:tf,children:"Oppdater passord"}),D.jsx("button",{type:"button",onClick:async()=>{try{await Uy(Eo,h),X("E-post for tilbakestilling er sendt.")}catch{N("Kunne ikke sende e-post for tilbakestilling.")}},style:tf,children:"Send tilbakestillingslenke"})]})]}),(S||P)&&D.jsx("p",{style:{marginTop:"0.75rem",fontSize:"0.85rem",color:S?"#b91c1c":"#166534"},children:S||P})]})]})})}function b8({user:s}){const{logout:e}=dd(),[n,o]=_e.useState(""),[h,g]=_e.useState(!1),[E,v]=_e.useState(!1),b=s.term??11,[_,S]=_e.useState([]),[N,P]=_e.useState(!1),[X,te]=_e.useState(0),[oe,ue]=_e.useState(!1),{options:Ye}=rm(),[ke,de]=_e.useState(!1),[Pe,ft]=_e.useState(null),[qe,F]=_e.useState([]),[j,V]=_e.useState({}),[Z,q]=_e.useState("idle"),[Y,H]=_e.useState(null),[rt,ae]=_e.useState(null),ce=s.semesterStatus&&s.semesterStatus!=="aktiv",ne=()=>{q("idle"),H(null),ae(null),o(""),ue(!1)},ze=async Le=>{if(!(!Le||Le.length<6)){g(!0),q("idle"),H(null);try{const we=wr(Nt,"sessions"),ut=Ia(we,$i("code","==",Le)),xt=await ei(ut);if(xt.empty){q("error"),H("Fant ingen kt med denne koden."),o(""),ue(!1),g(!1);return}const Mt=xt.docs[0],Mn=Mt.data(),Ie=Un(Nt,"sessions",Mt.id,"attendance",s.uid);if((await gl(Ie)).exists()){q("error"),H("Du er allerede registrert p denne kten."),o(""),ue(!1),g(!1);return}await ol(Ie,{userId:s.uid,studentName:s.displayName,studentEmail:s.email,createdAt:Rn.now(),status:"present"});const He=Mn.name||"kten";ae(He),q("success"),H(null),ue(!1),o(""),te(bt=>bt+1)}catch(we){console.error(we),q("error"),H("Noe gikk galt ved registrering av oppmte."),o(""),ue(!1)}finally{g(!1)}}},pt=Le=>{if(!Le||h)return;const we=Le.replace(/\D/g,"").slice(0,6);we.length===6&&(o(we),ze(we))};_e.useEffect(()=>{(async()=>{P(!0);try{const we=wr(Nt,"requirements"),ut=Ia(we,$i("term","==",b)),Mt=(await ei(ut)).docs.map(St=>{const Tt=St.data();return{category:Tt.category,requiredCount:Tt.requiredCount}}),Mn=wr(Nt,"sessions"),Ie=Ia(Mn,$i("term","==",b)),He=(await ei(Ie)).docs.map(St=>{const Tt=St.data();return{id:St.id,timeId:typeof Tt?.timeId=="string"?Tt.timeId:void 0,name:typeof Tt?.name=="string"?Tt.name:void 0,category:typeof Tt?.category=="string"?Tt.category:void 0}}),bt=wr(Nt,"times"),yt=Ia(bt,$i("term","==",b)),gt=(await ei(yt)).docs.map(St=>{const Tt=St.data();return{id:St.id,name:Tt.name,category:Tt.category,term:Tt.term,order:typeof Tt?.order=="number"?Tt.order:void 0}}),ht=new Map;for(const St of gt)St.category&&ht.set(St.category,(ht.get(St.category)??0)+1);const Qe=new Map,en={};for(const St of He){if(!St.category)continue;const Tt=Un(Nt,"sessions",St.id,"attendance",s.uid);if((await gl(Tt)).exists()){if(Qe.set(St.category,(Qe.get(St.category)??0)+1),St.timeId)en[St.timeId]=!0;else if(St.name&&St.category){const Re=gt.find(Ge=>Ge.category===St.category&&Ge.name===St.name);Re&&(en[Re.id]=!0)}}}const Xe=new Set;for(const St of Mt)Xe.add(St.category);for(const St of He)St.category&&Xe.add(St.category);for(const St of gt)St.category&&Xe.add(St.category);const Ur=[];Xe.forEach(St=>{const Tt=Mt.find(Je=>Je.category===St),Ae=Tt?Tt.requiredCount:null,Re=ht.get(St)??0,Ge=Qe.get(St)??0;Ur.push({category:St,attendedCount:Ge,totalSessions:Re,requiredCount:Ae})}),Ur.sort((St,Tt)=>St.category.localeCompare(Tt.category,"nb-NO",{sensitivity:"base"})),S(Ur),F(gt),V(en)}catch(we){console.error(we),S([]),F([]),V({})}finally{P(!1)}})()},[b,s.uid,X]);const ct=Le=>{const we=Le.match(/^\s*(\d+)/);return we?parseInt(we[1],10):Number.POSITIVE_INFINITY},K=_e.useMemo(()=>{if(!ke||!Pe)return[];const Le=qe.filter(we=>we.category===Pe).map(we=>({...we,attended:!!j[we.id]}));return Le.sort((we,ut)=>{const xt=(we.order??Number.MAX_SAFE_INTEGER)-(ut.order??Number.MAX_SAFE_INTEGER);if(xt!==0)return xt;const Mt=ct(we.name),Mn=ct(ut.name);return Mt!==Mn?Mt-Mn:we.name.localeCompare(ut.name,"nb-NO",{sensitivity:"base"})}),Le},[ke,Pe,qe,j]),pe=Le=>{ft(Le),de(!0)},De=()=>{de(!1),ft(null)},Ve=Le=>{const ut=Le.target.value.replace(/\D/g,"").slice(0,6);o(ut),ut.length===6&&!h&&ze(ut)};return _e.useEffect(()=>{if(Z==="idle")return;const we=setTimeout(()=>{ne()},5e3);return()=>clearTimeout(we)},[Z]),D.jsxs(D.Fragment,{children:[D.jsxs("div",{className:"page-card page-card--student",children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[D.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),D.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:()=>v(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),D.jsx("button",{onClick:e,type:"button",style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),D.jsx("h2",{style:{textAlign:"center",marginBottom:"1rem"},children:"Registrer oppmte"}),ce&&D.jsxs("p",{style:{color:"red",textAlign:"center"},children:['Du er markert som "',s.semesterStatus,'" dette semesteret. Ingen oppmtekrav, men du kan fortsatt registrere oppmte.']}),D.jsx("div",{style:{marginTop:"1rem",textAlign:"center"},children:Z==="success"?D.jsxs(D.Fragment,{children:[D.jsx("div",{style:{fontSize:"4rem",color:"#16a34a",marginBottom:"0.5rem"},children:""}),D.jsx("h3",{style:{margin:0,marginBottom:"0.3rem"},children:"Oppmte registrert"}),rt&&D.jsx("p",{style:{margin:0,marginBottom:"1rem",fontSize:"1rem",color:"#374151"},children:rt}),D.jsx("button",{type:"button",onClick:ne,style:{marginTop:"0.5rem",padding:"0.5rem 1.2rem",borderRadius:"999px",border:"none",background:"#2563eb",color:"white",fontWeight:500,cursor:"pointer",fontSize:"0.95rem"},children:"Registrer en kode til"})]}):Z==="error"?D.jsxs(D.Fragment,{children:[D.jsx("div",{style:{fontSize:"4rem",color:"#dc2626",marginBottom:"0.5rem"},children:""}),D.jsx("h3",{style:{margin:0,marginBottom:"0.3rem"},children:"Kunne ikke registrere oppmte"}),Y&&D.jsx("p",{style:{margin:0,marginBottom:"1rem",fontSize:"0.95rem",color:"#374151"},children:Y}),D.jsx("button",{type:"button",onClick:ne,style:{marginTop:"0.5rem",padding:"0.5rem 1.2rem",borderRadius:"999px",border:"none",background:"#6b7280",color:"white",fontWeight:500,cursor:"pointer",fontSize:"0.95rem"},children:"Prv en kode til"})]}):D.jsxs(D.Fragment,{children:[D.jsx("label",{style:{display:"block",marginBottom:"0.3rem"},children:"6-sifret kode fra lrer"}),D.jsx("input",{value:n,onChange:Ve,maxLength:6,placeholder:"482931",style:{padding:"0.5rem 0.8rem",fontSize:"1.2rem",letterSpacing:"0.3em",textAlign:"center",borderRadius:"0.5rem",border:"1px solid #d1d5db",minWidth:"10rem"}}),h&&D.jsx(bo,{}),D.jsx("br",{}),D.jsx("button",{type:"button",onClick:()=>ue(Le=>!Le),style:{marginTop:"1rem",padding:"0.4rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:oe?"#e5e7eb":"#f9fafb",cursor:"pointer",fontSize:"0.9rem"},children:oe?"Stopp skanning":"Skann QR-kode"}),oe&&D.jsx("div",{style:{marginTop:"0.8rem",display:"flex",justifyContent:"center"},children:D.jsx("div",{style:{width:"260px",maxWidth:"100%",borderRadius:"0.75rem",overflow:"hidden",border:"1px solid #d1d5db"},children:D.jsx(y8,{onCode:pt})})})]})}),D.jsx("hr",{style:{marginTop:"2rem",marginBottom:"1rem"}}),D.jsxs("section",{children:[D.jsx("h3",{style:{textAlign:"center"},children:ml(Ye,b)}),N?D.jsx(bo,{}):_.length===0?D.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen registrerte timer for denne terminen enn."}):D.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Gruppe"}),D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Registrerte oppmter"}),D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Krav"})]})}),D.jsx("tbody",{children:_.map(Le=>{const ut={padding:"0.5rem",borderBottom:"1px solid #f3f4f6",background:Le.requiredCount!=null&&Le.attendedCount>=Le.requiredCount?"#dcfce7":"transparent"};return D.jsxs("tr",{onClick:()=>pe(Le.category),title:"Klikk for  se detaljer",style:{cursor:"pointer"},children:[D.jsx("td",{style:ut,children:Le.category}),D.jsx("td",{style:ut,children:Le.totalSessions>0?`${Le.attendedCount}/${Le.totalSessions}`:Le.attendedCount}),D.jsx("td",{style:ut,children:Le.requiredCount??"-"})]},Le.category)})})]})]}),ke&&D.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},onClick:De,children:D.jsxs("div",{onClick:Le=>Le.stopPropagation(),style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[D.jsx("h3",{style:{margin:0},children:Pe?`Oppmte i ${Pe}`:"Oppmte"}),D.jsx("button",{type:"button",onClick:De,style:{border:"none",background:"transparent",fontSize:"1.2rem",cursor:"pointer"},"aria-label":"Lukk",title:"Lukk",children:""})]}),K.length===0?D.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen timer er definert i denne gruppen enda."}):D.jsx("ul",{style:{listStyle:"none",padding:0,marginTop:"0.75rem"},children:K.map(Le=>D.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.35rem 0",borderBottom:"1px solid #f3f4f6"},children:[D.jsx("span",{children:Le.name}),D.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",borderRadius:"999px",backgroundColor:Le.attended?"#dcfce7":"#fee2e2",color:Le.attended?"#166534":"#991b1b",fontSize:"0.8rem"},children:Le.attended?"Registrert":"Mangler"})]},Le.id))}),D.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"0.75rem"},children:D.jsx("button",{type:"button",onClick:De,style:{padding:"0.35rem 0.8rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff",cursor:"pointer"},children:"Lukk"})})]})})]}),E&&D.jsx(im,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>v(!1)})]})}var T8=Object.defineProperty,Uf=Object.getOwnPropertySymbols,jA=Object.prototype.hasOwnProperty,zA=Object.prototype.propertyIsEnumerable,lx=(s,e,n)=>e in s?T8(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,J1=(s,e)=>{for(var n in e||(e={}))jA.call(e,n)&&lx(s,n,e[n]);if(Uf)for(var n of Uf(e))zA.call(e,n)&&lx(s,n,e[n]);return s},$1=(s,e)=>{var n={};for(var o in s)jA.call(s,o)&&e.indexOf(o)<0&&(n[o]=s[o]);if(s!=null&&Uf)for(var o of Uf(s))e.indexOf(o)<0&&zA.call(s,o)&&(n[o]=s[o]);return n};var pl;(s=>{const e=class an{constructor(b,_,S,N){if(this.version=b,this.errorCorrectionLevel=_,this.modules=[],this.isFunction=[],b<an.MIN_VERSION||b>an.MAX_VERSION)throw new RangeError("Version value out of range");if(N<-1||N>7)throw new RangeError("Mask value out of range");this.size=b*4+17;let P=[];for(let te=0;te<this.size;te++)P.push(!1);for(let te=0;te<this.size;te++)this.modules.push(P.slice()),this.isFunction.push(P.slice());this.drawFunctionPatterns();const X=this.addEccAndInterleave(S);if(this.drawCodewords(X),N==-1){let te=1e9;for(let oe=0;oe<8;oe++){this.applyMask(oe),this.drawFormatBits(oe);const ue=this.getPenaltyScore();ue<te&&(N=oe,te=ue),this.applyMask(oe)}}h(0<=N&&N<=7),this.mask=N,this.applyMask(N),this.drawFormatBits(N),this.isFunction=[]}static encodeText(b,_){const S=s.QrSegment.makeSegments(b);return an.encodeSegments(S,_)}static encodeBinary(b,_){const S=s.QrSegment.makeBytes(b);return an.encodeSegments([S],_)}static encodeSegments(b,_,S=1,N=40,P=-1,X=!0){if(!(an.MIN_VERSION<=S&&S<=N&&N<=an.MAX_VERSION)||P<-1||P>7)throw new RangeError("Invalid value");let te,oe;for(te=S;;te++){const de=an.getNumDataCodewords(te,_)*8,Pe=E.getTotalBits(b,te);if(Pe<=de){oe=Pe;break}if(te>=N)throw new RangeError("Data too long")}for(const de of[an.Ecc.MEDIUM,an.Ecc.QUARTILE,an.Ecc.HIGH])X&&oe<=an.getNumDataCodewords(te,de)*8&&(_=de);let ue=[];for(const de of b){n(de.mode.modeBits,4,ue),n(de.numChars,de.mode.numCharCountBits(te),ue);for(const Pe of de.getData())ue.push(Pe)}h(ue.length==oe);const Ye=an.getNumDataCodewords(te,_)*8;h(ue.length<=Ye),n(0,Math.min(4,Ye-ue.length),ue),n(0,(8-ue.length%8)%8,ue),h(ue.length%8==0);for(let de=236;ue.length<Ye;de^=253)n(de,8,ue);let ke=[];for(;ke.length*8<ue.length;)ke.push(0);return ue.forEach((de,Pe)=>ke[Pe>>>3]|=de<<7-(Pe&7)),new an(te,_,ke,P)}getModule(b,_){return 0<=b&&b<this.size&&0<=_&&_<this.size&&this.modules[_][b]}getModules(){return this.modules}drawFunctionPatterns(){for(let S=0;S<this.size;S++)this.setFunctionModule(6,S,S%2==0),this.setFunctionModule(S,6,S%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const b=this.getAlignmentPatternPositions(),_=b.length;for(let S=0;S<_;S++)for(let N=0;N<_;N++)S==0&&N==0||S==0&&N==_-1||S==_-1&&N==0||this.drawAlignmentPattern(b[S],b[N]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(b){const _=this.errorCorrectionLevel.formatBits<<3|b;let S=_;for(let P=0;P<10;P++)S=S<<1^(S>>>9)*1335;const N=(_<<10|S)^21522;h(N>>>15==0);for(let P=0;P<=5;P++)this.setFunctionModule(8,P,o(N,P));this.setFunctionModule(8,7,o(N,6)),this.setFunctionModule(8,8,o(N,7)),this.setFunctionModule(7,8,o(N,8));for(let P=9;P<15;P++)this.setFunctionModule(14-P,8,o(N,P));for(let P=0;P<8;P++)this.setFunctionModule(this.size-1-P,8,o(N,P));for(let P=8;P<15;P++)this.setFunctionModule(8,this.size-15+P,o(N,P));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let b=this.version;for(let S=0;S<12;S++)b=b<<1^(b>>>11)*7973;const _=this.version<<12|b;h(_>>>18==0);for(let S=0;S<18;S++){const N=o(_,S),P=this.size-11+S%3,X=Math.floor(S/3);this.setFunctionModule(P,X,N),this.setFunctionModule(X,P,N)}}drawFinderPattern(b,_){for(let S=-4;S<=4;S++)for(let N=-4;N<=4;N++){const P=Math.max(Math.abs(N),Math.abs(S)),X=b+N,te=_+S;0<=X&&X<this.size&&0<=te&&te<this.size&&this.setFunctionModule(X,te,P!=2&&P!=4)}}drawAlignmentPattern(b,_){for(let S=-2;S<=2;S++)for(let N=-2;N<=2;N++)this.setFunctionModule(b+N,_+S,Math.max(Math.abs(N),Math.abs(S))!=1)}setFunctionModule(b,_,S){this.modules[_][b]=S,this.isFunction[_][b]=!0}addEccAndInterleave(b){const _=this.version,S=this.errorCorrectionLevel;if(b.length!=an.getNumDataCodewords(_,S))throw new RangeError("Invalid argument");const N=an.NUM_ERROR_CORRECTION_BLOCKS[S.ordinal][_],P=an.ECC_CODEWORDS_PER_BLOCK[S.ordinal][_],X=Math.floor(an.getNumRawDataModules(_)/8),te=N-X%N,oe=Math.floor(X/N);let ue=[];const Ye=an.reedSolomonComputeDivisor(P);for(let de=0,Pe=0;de<N;de++){let ft=b.slice(Pe,Pe+oe-P+(de<te?0:1));Pe+=ft.length;const qe=an.reedSolomonComputeRemainder(ft,Ye);de<te&&ft.push(0),ue.push(ft.concat(qe))}let ke=[];for(let de=0;de<ue[0].length;de++)ue.forEach((Pe,ft)=>{(de!=oe-P||ft>=te)&&ke.push(Pe[de])});return h(ke.length==X),ke}drawCodewords(b){if(b.length!=Math.floor(an.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let _=0;for(let S=this.size-1;S>=1;S-=2){S==6&&(S=5);for(let N=0;N<this.size;N++)for(let P=0;P<2;P++){const X=S-P,oe=(S+1&2)==0?this.size-1-N:N;!this.isFunction[oe][X]&&_<b.length*8&&(this.modules[oe][X]=o(b[_>>>3],7-(_&7)),_++)}}h(_==b.length*8)}applyMask(b){if(b<0||b>7)throw new RangeError("Mask value out of range");for(let _=0;_<this.size;_++)for(let S=0;S<this.size;S++){let N;switch(b){case 0:N=(S+_)%2==0;break;case 1:N=_%2==0;break;case 2:N=S%3==0;break;case 3:N=(S+_)%3==0;break;case 4:N=(Math.floor(S/3)+Math.floor(_/2))%2==0;break;case 5:N=S*_%2+S*_%3==0;break;case 6:N=(S*_%2+S*_%3)%2==0;break;case 7:N=((S+_)%2+S*_%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[_][S]&&N&&(this.modules[_][S]=!this.modules[_][S])}}getPenaltyScore(){let b=0;for(let P=0;P<this.size;P++){let X=!1,te=0,oe=[0,0,0,0,0,0,0];for(let ue=0;ue<this.size;ue++)this.modules[P][ue]==X?(te++,te==5?b+=an.PENALTY_N1:te>5&&b++):(this.finderPenaltyAddHistory(te,oe),X||(b+=this.finderPenaltyCountPatterns(oe)*an.PENALTY_N3),X=this.modules[P][ue],te=1);b+=this.finderPenaltyTerminateAndCount(X,te,oe)*an.PENALTY_N3}for(let P=0;P<this.size;P++){let X=!1,te=0,oe=[0,0,0,0,0,0,0];for(let ue=0;ue<this.size;ue++)this.modules[ue][P]==X?(te++,te==5?b+=an.PENALTY_N1:te>5&&b++):(this.finderPenaltyAddHistory(te,oe),X||(b+=this.finderPenaltyCountPatterns(oe)*an.PENALTY_N3),X=this.modules[ue][P],te=1);b+=this.finderPenaltyTerminateAndCount(X,te,oe)*an.PENALTY_N3}for(let P=0;P<this.size-1;P++)for(let X=0;X<this.size-1;X++){const te=this.modules[P][X];te==this.modules[P][X+1]&&te==this.modules[P+1][X]&&te==this.modules[P+1][X+1]&&(b+=an.PENALTY_N2)}let _=0;for(const P of this.modules)_=P.reduce((X,te)=>X+(te?1:0),_);const S=this.size*this.size,N=Math.ceil(Math.abs(_*20-S*10)/S)-1;return h(0<=N&&N<=9),b+=N*an.PENALTY_N4,h(0<=b&&b<=2568888),b}getAlignmentPatternPositions(){if(this.version==1)return[];{const b=Math.floor(this.version/7)+2,_=this.version==32?26:Math.ceil((this.version*4+4)/(b*2-2))*2;let S=[6];for(let N=this.size-7;S.length<b;N-=_)S.splice(1,0,N);return S}}static getNumRawDataModules(b){if(b<an.MIN_VERSION||b>an.MAX_VERSION)throw new RangeError("Version number out of range");let _=(16*b+128)*b+64;if(b>=2){const S=Math.floor(b/7)+2;_-=(25*S-10)*S-55,b>=7&&(_-=36)}return h(208<=_&&_<=29648),_}static getNumDataCodewords(b,_){return Math.floor(an.getNumRawDataModules(b)/8)-an.ECC_CODEWORDS_PER_BLOCK[_.ordinal][b]*an.NUM_ERROR_CORRECTION_BLOCKS[_.ordinal][b]}static reedSolomonComputeDivisor(b){if(b<1||b>255)throw new RangeError("Degree out of range");let _=[];for(let N=0;N<b-1;N++)_.push(0);_.push(1);let S=1;for(let N=0;N<b;N++){for(let P=0;P<_.length;P++)_[P]=an.reedSolomonMultiply(_[P],S),P+1<_.length&&(_[P]^=_[P+1]);S=an.reedSolomonMultiply(S,2)}return _}static reedSolomonComputeRemainder(b,_){let S=_.map(N=>0);for(const N of b){const P=N^S.shift();S.push(0),_.forEach((X,te)=>S[te]^=an.reedSolomonMultiply(X,P))}return S}static reedSolomonMultiply(b,_){if(b>>>8||_>>>8)throw new RangeError("Byte out of range");let S=0;for(let N=7;N>=0;N--)S=S<<1^(S>>>7)*285,S^=(_>>>N&1)*b;return h(S>>>8==0),S}finderPenaltyCountPatterns(b){const _=b[1];h(_<=this.size*3);const S=_>0&&b[2]==_&&b[3]==_*3&&b[4]==_&&b[5]==_;return(S&&b[0]>=_*4&&b[6]>=_?1:0)+(S&&b[6]>=_*4&&b[0]>=_?1:0)}finderPenaltyTerminateAndCount(b,_,S){return b&&(this.finderPenaltyAddHistory(_,S),_=0),_+=this.size,this.finderPenaltyAddHistory(_,S),this.finderPenaltyCountPatterns(S)}finderPenaltyAddHistory(b,_){_[0]==0&&(b+=this.size),_.pop(),_.unshift(b)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],s.QrCode=e;function n(v,b,_){if(b<0||b>31||v>>>b)throw new RangeError("Value out of range");for(let S=b-1;S>=0;S--)_.push(v>>>S&1)}function o(v,b){return(v>>>b&1)!=0}function h(v){if(!v)throw new Error("Assertion error")}const g=class mr{constructor(b,_,S){if(this.mode=b,this.numChars=_,this.bitData=S,_<0)throw new RangeError("Invalid argument");this.bitData=S.slice()}static makeBytes(b){let _=[];for(const S of b)n(S,8,_);return new mr(mr.Mode.BYTE,b.length,_)}static makeNumeric(b){if(!mr.isNumeric(b))throw new RangeError("String contains non-numeric characters");let _=[];for(let S=0;S<b.length;){const N=Math.min(b.length-S,3);n(parseInt(b.substring(S,S+N),10),N*3+1,_),S+=N}return new mr(mr.Mode.NUMERIC,b.length,_)}static makeAlphanumeric(b){if(!mr.isAlphanumeric(b))throw new RangeError("String contains unencodable characters in alphanumeric mode");let _=[],S;for(S=0;S+2<=b.length;S+=2){let N=mr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(S))*45;N+=mr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(S+1)),n(N,11,_)}return S<b.length&&n(mr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(S)),6,_),new mr(mr.Mode.ALPHANUMERIC,b.length,_)}static makeSegments(b){return b==""?[]:mr.isNumeric(b)?[mr.makeNumeric(b)]:mr.isAlphanumeric(b)?[mr.makeAlphanumeric(b)]:[mr.makeBytes(mr.toUtf8ByteArray(b))]}static makeEci(b){let _=[];if(b<0)throw new RangeError("ECI assignment value out of range");if(b<128)n(b,8,_);else if(b<16384)n(2,2,_),n(b,14,_);else if(b<1e6)n(6,3,_),n(b,21,_);else throw new RangeError("ECI assignment value out of range");return new mr(mr.Mode.ECI,0,_)}static isNumeric(b){return mr.NUMERIC_REGEX.test(b)}static isAlphanumeric(b){return mr.ALPHANUMERIC_REGEX.test(b)}getData(){return this.bitData.slice()}static getTotalBits(b,_){let S=0;for(const N of b){const P=N.mode.numCharCountBits(_);if(N.numChars>=1<<P)return 1/0;S+=4+P+N.bitData.length}return S}static toUtf8ByteArray(b){b=encodeURI(b);let _=[];for(let S=0;S<b.length;S++)b.charAt(S)!="%"?_.push(b.charCodeAt(S)):(_.push(parseInt(b.substring(S+1,S+3),16)),S+=2);return _}};g.NUMERIC_REGEX=/^[0-9]*$/,g.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,g.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let E=g;s.QrSegment=g})(pl||(pl={}));(s=>{(e=>{const n=class{constructor(h,g){this.ordinal=h,this.formatBits=g}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),e.Ecc=n})(s.QrCode||(s.QrCode={}))})(pl||(pl={}));(s=>{(e=>{const n=class{constructor(h,g){this.modeBits=h,this.numBitsCharCount=g}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),e.Mode=n})(s.QrSegment||(s.QrSegment={}))})(pl||(pl={}));var ec=pl;var v8={L:ec.QrCode.Ecc.LOW,M:ec.QrCode.Ecc.MEDIUM,Q:ec.QrCode.Ecc.QUARTILE,H:ec.QrCode.Ecc.HIGH},HA=128,GA="L",qA="#FFFFFF",XA="#000000",YA=!1,WA=1,C8=4,S8=0,I8=.1;function KA(s,e=0){const n=[];return s.forEach(function(o,h){let g=null;o.forEach(function(E,v){if(!E&&g!==null){n.push(`M${g+e} ${h+e}h${v-g}v1H${g+e}z`),g=null;return}if(v===o.length-1){if(!E)return;g===null?n.push(`M${v+e},${h+e} h1v1H${v+e}z`):n.push(`M${g+e},${h+e} h${v+1-g}v1H${g+e}z`);return}E&&g===null&&(g=v)})}),n.join("")}function QA(s,e){return s.slice().map((n,o)=>o<e.y||o>=e.y+e.h?n:n.map((h,g)=>g<e.x||g>=e.x+e.w?h:!1))}function R8(s,e,n,o){if(o==null)return null;const h=s.length+n*2,g=Math.floor(e*I8),E=h/e,v=(o.width||g)*E,b=(o.height||g)*E,_=o.x==null?s.length/2-v/2:o.x*E,S=o.y==null?s.length/2-b/2:o.y*E,N=o.opacity==null?1:o.opacity;let P=null;if(o.excavate){let te=Math.floor(_),oe=Math.floor(S),ue=Math.ceil(v+_-te),Ye=Math.ceil(b+S-oe);P={x:te,y:oe,w:ue,h:Ye}}const X=o.crossOrigin;return{x:_,y:S,h:b,w:v,excavation:P,opacity:N,crossOrigin:X}}function N8(s,e){return e!=null?Math.max(Math.floor(e),0):s?C8:S8}function ZA({value:s,level:e,minVersion:n,includeMargin:o,marginSize:h,imageSettings:g,size:E,boostLevel:v}){let b=Nr.useMemo(()=>{const te=(Array.isArray(s)?s:[s]).reduce((oe,ue)=>(oe.push(...ec.QrSegment.makeSegments(ue)),oe),[]);return ec.QrCode.encodeSegments(te,v8[e],n,void 0,void 0,v)},[s,e,n,v]);const{cells:_,margin:S,numCells:N,calculatedImageSettings:P}=Nr.useMemo(()=>{let X=b.getModules();const te=N8(o,h),oe=X.length+te*2,ue=R8(X,E,te,g);return{cells:X,margin:te,numCells:oe,calculatedImageSettings:ue}},[b,E,g,o,h]);return{qrcode:b,margin:S,cells:_,numCells:N,calculatedImageSettings:P}}var O8=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),JA=Nr.forwardRef(function(e,n){const o=e,{value:h,size:g=HA,level:E=GA,bgColor:v=qA,fgColor:b=XA,includeMargin:_=YA,minVersion:S=WA,boostLevel:N,marginSize:P,imageSettings:X}=o,oe=$1(o,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:ue}=oe,Ye=$1(oe,["style"]),ke=X?.src,de=Nr.useRef(null),Pe=Nr.useRef(null),ft=Nr.useCallback(rt=>{de.current=rt,typeof n=="function"?n(rt):n&&(n.current=rt)},[n]),[qe,F]=Nr.useState(!1),{margin:j,cells:V,numCells:Z,calculatedImageSettings:q}=ZA({value:h,level:E,minVersion:S,boostLevel:N,includeMargin:_,marginSize:P,imageSettings:X,size:g});Nr.useEffect(()=>{if(de.current!=null){const rt=de.current,ae=rt.getContext("2d");if(!ae)return;let ce=V;const ne=Pe.current,ze=q!=null&&ne!==null&&ne.complete&&ne.naturalHeight!==0&&ne.naturalWidth!==0;ze&&q.excavation!=null&&(ce=QA(V,q.excavation));const pt=window.devicePixelRatio||1;rt.height=rt.width=g*pt;const ct=g/Z*pt;ae.scale(ct,ct),ae.fillStyle=v,ae.fillRect(0,0,Z,Z),ae.fillStyle=b,O8?ae.fill(new Path2D(KA(ce,j))):V.forEach(function(K,pe){K.forEach(function(De,Ve){De&&ae.fillRect(Ve+j,pe+j,1,1)})}),q&&(ae.globalAlpha=q.opacity),ze&&ae.drawImage(ne,q.x+j,q.y+j,q.w,q.h)}}),Nr.useEffect(()=>{F(!1)},[ke]);const Y=J1({height:g,width:g},ue);let H=null;return ke!=null&&(H=Nr.createElement("img",{src:ke,key:ke,style:{display:"none"},onLoad:()=>{F(!0)},ref:Pe,crossOrigin:q?.crossOrigin})),Nr.createElement(Nr.Fragment,null,Nr.createElement("canvas",J1({style:Y,height:g,width:g,ref:ft,role:"img"},Ye)),H)});JA.displayName="QRCodeCanvas";var D8=Nr.forwardRef(function(e,n){const o=e,{value:h,size:g=HA,level:E=GA,bgColor:v=qA,fgColor:b=XA,includeMargin:_=YA,minVersion:S=WA,boostLevel:N,title:P,marginSize:X,imageSettings:te}=o,oe=$1(o,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:ue,cells:Ye,numCells:ke,calculatedImageSettings:de}=ZA({value:h,level:E,minVersion:S,boostLevel:N,includeMargin:_,marginSize:X,imageSettings:te,size:g});let Pe=Ye,ft=null;te!=null&&de!=null&&(de.excavation!=null&&(Pe=QA(Ye,de.excavation)),ft=Nr.createElement("image",{href:te.src,height:de.h,width:de.w,x:de.x+ue,y:de.y+ue,preserveAspectRatio:"none",opacity:de.opacity,crossOrigin:de.crossOrigin}));const qe=KA(Pe,ue);return Nr.createElement("svg",J1({height:g,width:g,viewBox:`0 0 ${ke} ${ke}`,ref:n,role:"img"},oe),!!P&&Nr.createElement("title",null,P),Nr.createElement("path",{fill:v,d:`M0,0 h${ke}v${ke}H0z`,shapeRendering:"crispEdges"}),Nr.createElement("path",{fill:b,d:qe,shapeRendering:"crispEdges"}),ft)});D8.displayName="QRCodeSVG";function M8({user:s}){const[e,n]=_e.useState([]),[o,h]=_e.useState(null),[g,E]=_e.useState(null),[v,b]=_e.useState(""),[_,S]=_e.useState(null),[N,P]=_e.useState([]),[X,te]=_e.useState(!0),[oe,ue]=_e.useState(!1),[Ye,ke]=_e.useState([]),[de,Pe]=_e.useState(!0),[ft,qe]=_e.useState(""),[F,j]=_e.useState(!1),[V,Z]=_e.useState(120),[q,Y]=_e.useState([]),[H,rt]=_e.useState(!1),ae=_e.useRef(null),ce=_e.useRef(null),{options:ne}=rm(),{logout:ze}=dd(),[pt,ct]=_e.useState(!1);_e.useEffect(()=>{(async()=>{te(!0);const He=(await ei(wr(Nt,"times"))).docs.map(bt=>{const yt=bt.data();return{id:bt.id,name:yt.name,category:yt.category,term:yt.term}});n(He),te(!1)})()},[]),_e.useEffect(()=>{(async()=>{try{const $e=Un(Nt,"users",s.uid),He=await gl($e),bt=He.exists()?He.data():null,yt=Array.isArray(bt?.allowedTerms)?bt.allowedTerms.map(Ct=>typeof Ct=="number"?Ct:parseInt(Ct,10)).filter(Ct=>!Number.isNaN(Ct)):[];E(yt)}catch($e){console.warn("Kunne ikke hente allowedTerms for lrer:",$e),E([])}})()},[s.uid]),_e.useMemo(()=>{if(g===null)return ne;const Ie=new Set(g??[]);return ne.filter($e=>Ie.has($e.value))},[g,ne]),_e.useEffect(()=>{(async()=>{if(!(g===null||!o)){Pe(!0);try{const $e=wr(Nt,"users"),He=Ia($e,$i("role","==","student"),$i("term","==",o)),yt=(await ei(He)).docs.map(Ct=>{const gt=Ct.data(),ht=gt?.name&&String(gt.name)||gt?.displayName&&String(gt.displayName)||null;return{id:Ct.id,name:ht,email:String(gt?.email??""),phone:gt?.phone?String(gt.phone):null,term:typeof gt?.term=="number"?gt.term:null}});yt.sort((Ct,gt)=>{const ht=(Ct.name??"").toLocaleLowerCase(),Qe=(gt.name??"").toLocaleLowerCase();return ht!==Qe?ht.localeCompare(Qe,"nb-NO"):Ct.email.localeCompare(gt.email,"nb-NO")}),ke(yt)}catch($e){console.error("Feil ved lasting av studenter:",$e),ke([])}finally{Pe(!1)}}})()},[g,o]),_e.useEffect(()=>{K()},[s.uid]);const K=async()=>{try{rt(!0);const Ie=Date.now()-14400*1e3,$e=Rn.fromMillis(Ie),He=wr(Nt,"sessions");let bt=[];try{const gt=Ia(He,$i("teacherId","==",s.uid),$i("createdAt",">=",$e),V4("createdAt","desc"),U4(50));bt=(await ei(gt)).docs}catch{const ht=Ia(He,$i("teacherId","==",s.uid));bt=(await ei(ht)).docs.filter(en=>{const Xe=en.data()?.createdAt;return Xe&&Xe.toMillis()>=Ie}).sort((en,Xe)=>{const Ur=en.data()?.createdAt?.toMillis?.()??0;return(Xe.data()?.createdAt?.toMillis?.()??0)-Ur}).slice(0,50)}const yt=new Set,Ct=[];for(const gt of bt){const ht=gt.data(),Qe=String(ht?.timeId??"");if(!(!Qe||yt.has(Qe))&&(yt.add(Qe),Ct.push({timeId:Qe,name:String(ht?.name??"Ukjent time"),category:String(ht?.category??""),term:typeof ht?.term=="number"?ht.term:Number(ht?.term)||0,lastAt:ht?.createdAt}),Ct.length>=10))break}Y(Ct)}catch(Ie){console.warn("Kunne ikke hente nylige timer:",Ie),Y([])}finally{rt(!1)}};_e.useEffect(()=>{if(!_){P([]);return}const Ie=wr(Nt,"sessions",_.id,"attendance"),$e=QE(Ie,He=>{const bt=He.docs.map(yt=>{const Ct=yt.data();return{id:yt.id,studentName:Ct.studentName??null,studentEmail:Ct.studentEmail??null,createdAt:Ct.createdAt}}).sort((yt,Ct)=>{const gt=yt.createdAt?.toMillis?.()??0,ht=Ct.createdAt?.toMillis?.()??0;return gt-ht});P(bt)});return()=>$e()},[_?.id]);const pe=_e.useMemo(()=>e.filter(Ie=>Ie.term===o),[e,o]),De=_e.useMemo(()=>{const Ie=v.trim().toLowerCase();return Ie?pe.filter($e=>$e.name.toLowerCase().includes(Ie)).sort(($e,He)=>$e.name.localeCompare(He.name,"nb-NO",{sensitivity:"base"})):[]},[pe,v]),Ve=_e.useMemo(()=>{const Ie=ft.trim().toLowerCase();return!Ie||!_?[]:Ye.filter($e=>{if($e.term!==_.term)return!1;const He=($e.name??"").toLowerCase(),bt=$e.email.toLowerCase(),yt=($e.phone??"").toLowerCase();return He.includes(Ie)||bt.includes(Ie)||yt.includes(Ie)}).slice(0,10)},[Ye,ft,_]),Le=async Ie=>{const $e=e.find(Qe=>Qe.id===Ie);if(!$e)return;if(_){const Qe=Un(Nt,"sessions",_.id);await Cs(Qe,{isOpen:!1}),S(null)}const He=Math.floor(1e5+Math.random()*9e5),bt=String(He),yt=wr(Nt,"sessions"),Ct=Rn.now(),ht={id:(await gf(yt,{timeId:$e.id,name:$e.name,category:$e.category,term:$e.term,code:bt,teacherId:s.uid,teacherName:s.displayName,teacherEmail:s.email,createdAt:Ct,isOpen:!0,openedAt:Ct})).id,timeId:$e.id,name:$e.name,category:$e.category,term:$e.term,code:bt,teacherId:s.uid,createdAt:Ct,isOpen:!0,openedAt:Ct};S(ht),K()},we=async Ie=>{b(Ie.name),ue(!1),await Le(Ie.id),ce.current&&ce.current.blur()},ut=async Ie=>{h(Ie.term),b(Ie.name),ue(!1),await Le(Ie.timeId)},xt=async()=>{if(!_)return;const Ie=Un(Nt,"sessions",_.id);if(!_.isOpen){const He=Rn.now();await Cs(Ie,{isOpen:!0,openedAt:He}),S({..._,isOpen:!0,openedAt:He}),Z(120)}else await Cs(Ie,{isOpen:!1}),S({..._,isOpen:!1})};_e.useEffect(()=>{if(!_)return;const Ie=Un(Nt,"sessions",_.id),$e=QE(Ie,He=>{if(!He.exists())return;const bt=He.data();S(yt=>yt&&yt.id===He.id?{...yt,isOpen:bt?.isOpen??yt.isOpen,openedAt:bt?.openedAt??yt.openedAt}:yt)});return()=>$e()},[_?.id]),_e.useEffect(()=>{if(!_||!_.isOpen||!_.openedAt){Z(0);return}const Ie=_.openedAt.toMillis(),$e=async()=>{const bt=Date.now(),yt=Math.floor((bt-Ie)/1e3),Ct=Math.max(0,15-yt);if(Z(Ct),Ct===0&&_.isOpen)try{await Cs(Un(Nt,"sessions",_.id),{isOpen:!1}),S({..._,isOpen:!1})}catch{}};$e();const He=setInterval($e,1e3);return()=>clearInterval(He)},[_?.id,_?.isOpen,_?.openedAt]);const Mt=Ie=>{const $e=Math.floor(Ie/60).toString().padStart(2,"0"),He=Math.floor(Ie%60).toString().padStart(2,"0");return`${$e}:${He}`},Mn=async Ie=>{if(_)try{const $e=Un(Nt,"sessions",_.id,"attendance",Ie.id);if((await gl($e)).exists()){alert("Studenten er allerede registrert p denne kten.");return}await ol($e,{userId:Ie.id,studentName:Ie.name??null,studentEmail:Ie.email,createdAt:Rn.now(),status:"present",addedManually:!0,addedBy:s.uid}),qe(""),j(!1)}catch($e){console.error($e),alert("Kunne ikke legge til student manuelt.")}};return X?D.jsx("div",{className:"page-card page-card--teacher",children:D.jsx(bo,{})}):D.jsxs(D.Fragment,{children:[D.jsxs("div",{className:"page-card page-card--teacher",children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[D.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),D.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:()=>ct(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),D.jsx("button",{onClick:ze,type:"button",style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),D.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem"},children:"Registrer oppmte"}),D.jsxs("section",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",alignItems:"center"},children:[D.jsx("div",{style:{marginBottom:"1rem",width:"100%",maxWidth:520},children:(()=>{const Ie=g!==null?new Set(g??[]):null,$e=Ie?ne.filter(He=>Ie.has(He.value)):ne;return $e.length===0?D.jsx("div",{style:{width:"100%",padding:"0.6rem 0",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"0.5rem",background:"#f9fafb",color:"#6b7280",textAlign:"center"},children:"Ingen terminer tilgjengelig"}):D.jsxs("select",{value:o??"",onChange:He=>{const bt=He.target.value,yt=bt===""?null:parseInt(bt,10);h(yt),b(""),ue(!1),S(null),P([]),yt!=null&&setTimeout(()=>{ce.current?.focus()},0)},style:{width:"100%",padding:"0.6rem 0.75rem",fontSize:"16px",textAlign:"center"},children:[D.jsx("option",{value:"",disabled:!0,children:"Velg modul"}),$e.map(He=>D.jsx("option",{value:He.value,children:He.label},He.value))]})})()}),D.jsxs("div",{style:{position:"relative",marginBottom:"0.75rem",width:"100%",maxWidth:520},children:[D.jsx("input",{ref:ce,value:v,onChange:Ie=>{b(Ie.target.value),ue(!0)},onFocus:()=>{o&&v.trim().length>0&&ue(!0)},placeholder:o?"Start  skrive navnet p timen...":"Velg modul frst",disabled:!o,style:{width:"100%",padding:"0.6rem 0rem",fontSize:"16px",textAlign:"center",opacity:o?1:.6}}),oe&&De.length>0&&D.jsx("ul",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",marginTop:"0.2rem",listStyle:"none",padding:0,maxHeight:"220px",overflowY:"auto",boxShadow:"0 10px 20px rgba(0,0,0,0.08)"},children:De.map(Ie=>D.jsxs("li",{onClick:()=>we(Ie),style:{padding:"0.4rem 0.6rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseDown:$e=>$e.preventDefault(),children:[D.jsx("div",{children:Ie.name}),D.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:Ie.category})]},Ie.id))})]})]}),!_&&q.length>0&&D.jsx("section",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",alignItems:"center"},children:D.jsxs("div",{style:{width:"100%",maxWidth:520},children:[D.jsx("h4",{style:{textAlign:"center",marginTop:0},children:"Nylig registrerte timer"}),D.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:q.map(Ie=>D.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid #f3f4f6"},children:[D.jsxs("div",{children:[D.jsx("div",{style:{fontWeight:600},children:Ie.name}),D.jsxs("div",{style:{fontSize:"0.8rem",color:"#6b7280"},children:[Ie.category,"  ",ml(ne,Ie.term)]})]}),D.jsx("button",{type:"button",onClick:()=>void ut(Ie),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"none",background:"#16a34a",color:"white",cursor:"pointer"},children:"pne"})]},Ie.timeId))})]})}),_&&D.jsxs("section",{ref:ae,style:{marginTop:"2rem",padding:"1rem",border:"1px solid #e5e7eb",borderRadius:"0.75rem",background:"#f9fafb"},children:[D.jsxs("div",{style:{textAlign:"center"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"0.25rem"},children:ml(ne,_.term)}),D.jsxs("p",{style:{margin:0},children:[D.jsx("strong",{children:"Time:"})," ",_.name]}),D.jsxs("p",{style:{marginTop:"0.2rem"},children:[D.jsx("strong",{children:"Gruppe:"})," ",_.category]})]}),D.jsxs("div",{style:{marginTop:"1rem",position:"relative"},children:[D.jsxs("div",{style:{filter:_.isOpen===!1?"blur(6px)":"none",pointerEvents:"none",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[D.jsx(JA,{value:_.code,size:160,includeMargin:!0}),D.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",letterSpacing:"0.3em"},children:_.code})]}),_.isOpen===!1&&D.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center"},children:D.jsx("div",{style:{background:"rgba(255,255,255,0.85)",padding:"0.5rem 0.75rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb",fontWeight:600,color:"#6b7280"},children:"kten er lukket"})})]}),D.jsxs("div",{style:{marginTop:"1.5rem"},children:[D.jsx("h4",{style:{textAlign:"center",marginBottom:"0.3rem"},children:"Legg til student manuelt"}),D.jsx("p",{style:{fontSize:"0.8rem",color:"#6b7280",textAlign:"center",marginTop:0,marginBottom:"0.5rem"},children:"Brukes dersom en student ikke kan skanne eller skrive inn kode."}),de&&D.jsx("div",{style:{display:"flex",justifyContent:"center"},children:D.jsx(bo,{})}),D.jsxs("div",{style:{position:"relative",maxWidth:"360px",margin:"0 auto"},children:[D.jsx("input",{value:ft,onChange:Ie=>{qe(Ie.target.value),j(!0)},onFocus:()=>{ft.trim().length>0&&j(!0)},placeholder:de?"Laster studenter...":"Sk p navn, e-post eller telefon",disabled:de,style:{width:"100%",padding:"0.6rem 0.75rem",fontSize:"16px",borderRadius:"0.5rem",border:"1px solid #d1d5db",textAlign:"center"}}),F&&Ve.length>0&&D.jsx("ul",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:20,background:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",marginTop:"0.2rem",listStyle:"none",padding:0,maxHeight:"220px",overflowY:"auto",boxShadow:"0 10px 20px rgba(0,0,0,0.08)"},children:Ve.map(Ie=>D.jsxs("li",{onClick:()=>Mn(Ie),style:{padding:"0.4rem 0.6rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseDown:$e=>$e.preventDefault(),children:[D.jsx("div",{children:Ie.name||"(Uten navn)"}),D.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[Ie.email,Ie.phone?`  ${Ie.phone}`:""]})]},Ie.id))})]})]}),D.jsxs("div",{style:{marginTop:"1.2rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[D.jsx("div",{style:{fontWeight:600,color:"#111827"},children:Mt(V)}),D.jsx("button",{onClick:xt,style:{padding:"0.5rem 1.2rem",borderRadius:"999px",border:"none",background:(_.isOpen===!1,"#6CE1AB"),color:"black",fontWeight:500,cursor:"pointer"},children:_.isOpen===!1?"pne kta":"Lukk kt"})]}),D.jsx("hr",{style:{margin:"1rem 0"}}),D.jsx("h4",{children:"Registrerte studenter"}),N.length===0?D.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen har registrert seg enn."}):D.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Navn"}),D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"E-post"}),D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Tidspunkt"})]})}),D.jsx("tbody",{children:N.map(Ie=>D.jsxs("tr",{children:[D.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6"},children:Ie.studentName||"-"}),D.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6"},children:Ie.studentEmail||"-"}),D.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6",fontSize:"0.8rem",color:"#6b7280"},children:Ie.createdAt?new Date(Ie.createdAt.toMillis()).toLocaleTimeString("no-NO",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"})]},Ie.id))})]})]})]}),pt&&D.jsx(im,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>ct(!1)})]})}const k8="type.googleapis.com/google.protobuf.Int64Value",L8="type.googleapis.com/google.protobuf.UInt64Value";function $A(s,e){const n={};for(const o in s)s.hasOwnProperty(o)&&(n[o]=e(s[o]));return n}function Ff(s){if(s==null)return null;if(s instanceof Number&&(s=s.valueOf()),typeof s=="number"&&isFinite(s)||s===!0||s===!1||Object.prototype.toString.call(s)==="[object String]")return s;if(s instanceof Date)return s.toISOString();if(Array.isArray(s))return s.map(e=>Ff(e));if(typeof s=="function"||typeof s=="object")return $A(s,e=>Ff(e));throw new Error("Data cannot be encoded in JSON: "+s)}function fc(s){if(s==null)return s;if(s["@type"])switch(s["@type"]){case k8:case L8:{const e=Number(s.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+s);return e}default:throw new Error("Data cannot be decoded from JSON: "+s)}return Array.isArray(s)?s.map(e=>fc(e)):typeof s=="function"||typeof s=="object"?$A(s,e=>fc(e)):s}const sm="functions";const cx={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ui extends Qs{constructor(e,n,o){super(`${sm}/${e}`,n||""),this.details=o,Object.setPrototypeOf(this,Ui.prototype)}}function P8(s){if(s>=200&&s<300)return"ok";switch(s){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function jf(s,e){let n=P8(s),o=n,h;try{const g=e&&e.error;if(g){const E=g.status;if(typeof E=="string"){if(!cx[E])return new Ui("internal","internal");n=cx[E],o=E}const v=g.message;typeof v=="string"&&(o=v),h=g.details,h!==void 0&&(h=fc(h))}}catch{}return n==="ok"?null:new Ui(n,o,h)}class B8{constructor(e,n,o,h){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Bi(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=o.getImmediate({optional:!0}),this.auth||n.get().then(g=>this.auth=g,()=>{}),this.messaging||o.get().then(g=>this.messaging=g,()=>{}),this.appCheck||h?.get().then(g=>this.appCheck=g,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),o=await this.getMessagingToken(),h=await this.getAppCheckToken(e);return{authToken:n,messagingToken:o,appCheckToken:h}}}const eg="us-central1",V8=/^data: (.*?)(?:\n|$)/;function U8(s){let e=null;return{promise:new Promise((n,o)=>{e=setTimeout(()=>{o(new Ui("deadline-exceeded","deadline-exceeded"))},s)}),cancel:()=>{e&&clearTimeout(e)}}}class F8{constructor(e,n,o,h,g=eg,E=(...v)=>fetch(...v)){this.app=e,this.fetchImpl=E,this.emulatorOrigin=null,this.contextProvider=new B8(e,n,o,h),this.cancelAllRequests=new Promise(v=>{this.deleteService=()=>Promise.resolve(v())});try{const v=new URL(g);this.customDomain=v.origin+(v.pathname==="/"?"":v.pathname),this.region=eg}catch{this.customDomain=null,this.region=g}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function j8(s,e,n){const o=Oo(e);s.emulatorOrigin=`http${o?"s":""}://${e}:${n}`,o&&(rg(s.emulatorOrigin+"/backends"),ig("Functions",!0))}function z8(s,e,n){const o=h=>G8(s,e,h,{});return o.stream=(h,g)=>X8(s,e,h,g),o}function ew(s){return s.emulatorOrigin&&Oo(s.emulatorOrigin)?"include":void 0}async function H8(s,e,n,o,h){n["Content-Type"]="application/json";let g;try{g=await o(s,{method:"POST",body:JSON.stringify(e),headers:n,credentials:ew(h)})}catch{return{status:0,json:null}}let E=null;try{E=await g.json()}catch{}return{status:g.status,json:E}}async function tw(s,e){const n={},o=await s.contextProvider.getContext(e.limitedUseAppCheckTokens);return o.authToken&&(n.Authorization="Bearer "+o.authToken),o.messagingToken&&(n["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=o.appCheckToken),n}function G8(s,e,n,o){const h=s._url(e);return q8(s,h,n,o)}async function q8(s,e,n,o){n=Ff(n);const h={data:n},g=await tw(s,o),E=o.timeout||7e4,v=U8(E),b=await Promise.race([H8(e,h,g,s.fetchImpl,s),v.promise,s.cancelAllRequests]);if(v.cancel(),!b)throw new Ui("cancelled","Firebase Functions instance was deleted.");const _=jf(b.status,b.json);if(_)throw _;if(!b.json)throw new Ui("internal","Response is not valid JSON object.");let S=b.json.data;if(typeof S>"u"&&(S=b.json.result),typeof S>"u")throw new Ui("internal","Response is missing data field.");return{data:fc(S)}}function X8(s,e,n,o){const h=s._url(e);return Y8(s,h,n,o||{})}async function Y8(s,e,n,o){n=Ff(n);const h={data:n},g=await tw(s,o);g["Content-Type"]="application/json",g.Accept="text/event-stream";let E;try{E=await s.fetchImpl(e,{method:"POST",body:JSON.stringify(h),headers:g,signal:o?.signal,credentials:ew(s)})}catch(P){if(P instanceof Error&&P.name==="AbortError"){const te=new Ui("cancelled","Request was cancelled.");return{data:Promise.reject(te),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(te)}}}}}}const X=jf(0,null);return{data:Promise.reject(X),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(X)}}}}}}let v,b;const _=new Promise((P,X)=>{v=P,b=X});o?.signal?.addEventListener("abort",()=>{const P=new Ui("cancelled","Request was cancelled.");b(P)});const S=E.body.getReader(),N=W8(S,v,b,o?.signal);return{stream:{[Symbol.asyncIterator](){const P=N.getReader();return{async next(){const{value:X,done:te}=await P.read();return{value:X,done:te}},async return(){return await P.cancel(),{done:!0,value:void 0}}}}},data:_}}function W8(s,e,n,o){const h=(E,v)=>{const b=E.match(V8);if(!b)return;const _=b[1];try{const S=JSON.parse(_);if("result"in S){e(fc(S.result));return}if("message"in S){v.enqueue(fc(S.message));return}if("error"in S){const N=jf(0,S);v.error(N),n(N);return}}catch(S){if(S instanceof Ui){v.error(S),n(S);return}}},g=new TextDecoder;return new ReadableStream({start(E){let v="";return b();async function b(){if(o?.aborted){const _=new Ui("cancelled","Request was cancelled");return E.error(_),n(_),Promise.resolve()}try{const{value:_,done:S}=await s.read();if(S){v.trim()&&h(v.trim(),E),E.close();return}if(o?.aborted){const P=new Ui("cancelled","Request was cancelled");E.error(P),n(P),await s.cancel();return}v+=g.decode(_,{stream:!0});const N=v.split(`
`);v=N.pop()||"";for(const P of N)P.trim()&&h(P.trim(),E);return b()}catch(_){const S=_ instanceof Ui?_:jf(0,null);E.error(S),n(S)}}},cancel(){return s.cancel()}})}const ux="@firebase/functions",hx="0.13.1";const K8="auth-internal",Q8="app-check-internal",Z8="messaging-internal";function J8(s){const e=(n,{instanceIdentifier:o})=>{const h=n.getProvider("app").getImmediate(),g=n.getProvider(K8),E=n.getProvider(Z8),v=n.getProvider(Q8);return new F8(h,g,E,v,o)};cl(new To(sm,e,"PUBLIC").setMultipleInstances(!0)),Fs(ux,hx,s),Fs(ux,hx,"esm2020")}function w1(s=Gf(),e=eg){const o=Hf(qn(s),sm).getImmediate({identifier:e}),h=yx("functions");return h&&$8(o,...h),o}function $8(s,e,n){j8(qn(s),e,n)}function b1(s,e,n){return z8(qn(s),e)}J8();function fx(s){const e=s.match(/^\s*(\d+)/);return e?parseInt(e[1],10):Number.POSITIVE_INFINITY}function T1(){const s="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$";let e="";for(let n=0;n<12;n++)e+=s[Math.floor(Math.random()*s.length)];return e}const eR=()=>{const[s,e]=_e.useState([]),[n,o]=_e.useState(!0),[h,g]=_e.useState(""),[E,v]=_e.useState("teachers"),[b,_]=_e.useState("all"),[S,N]=_e.useState("name"),[P,X]=_e.useState("asc"),[te,oe]=_e.useState("all"),[ue,Ye]=_e.useState("name"),[ke,de]=_e.useState("asc"),[Pe,ft]=_e.useState("name"),[qe,F]=_e.useState("asc"),[j,V]=_e.useState([]),Z=_e.useMemo(()=>j.slice().sort((ee,je)=>(ee.order??ee.value)-(je.order??je.value)).map(ee=>({value:ee.value,label:ee.label||`Termin ${ee.value}`})),[j]);_e.useEffect(()=>{(async()=>{try{const tt=(await ei(wr(Nt,"terms"))).docs.map(Ke=>{const Vt=Ke.data(),Gt=typeof Vt?.value=="number"?Vt.value:void 0;if(typeof Gt!="number")return null;const Ln=typeof Vt?.label=="string"?Vt.label:"",yn=typeof Vt?.order=="number"?Vt.order:void 0;return{value:Gt,label:Ln,order:yn}}).filter(Boolean);tt.sort((Ke,Vt)=>(Ke.order??Ke.value)-(Vt.order??Vt.value)),V(tt)}catch(je){console.warn("Kunne ikke laste terminer fra Firestore for admin-brukerpanel:",je)}})()},[]);const[q,Y]=_e.useState(null),[H,rt]=_e.useState(null),[ae,ce]=_e.useState(""),[ne,ze]=_e.useState(""),[pt,ct]=_e.useState(""),[K,pe]=_e.useState("teacher"),[De,Ve]=_e.useState([]),[Le,we]=_e.useState(null),[ut,xt]=_e.useState(null),[Mt,Mn]=_e.useState(""),[Ie,$e]=_e.useState(""),[He,bt]=_e.useState(""),[yt,Ct]=_e.useState("student"),[gt,ht]=_e.useState(null),[Qe,en]=_e.useState(null),[Xe,Ur]=_e.useState({}),St=(ee,je)=>{if(ee&&je!=null)return Xe[ee]?.[je]},Tt=async(ee,je)=>{if(!(!ee||je==null)&&Xe[ee]?.[je]===void 0)try{const tt=Un(Nt,"users",ee,"books",String(je)),Ke=await gl(tt),Vt=Ke.exists()?{approved:!!Ke.data().approved,approvedAt:Ke.data().approvedAt??null}:{approved:!1,approvedAt:null};Ur(Gt=>({...Gt,[ee]:{...Gt[ee]??{},[je]:Vt}}))}catch(tt){console.error("Kunne ikke laste godkjenning for bok:",tt)}},Ae=({uid:ee,term:je})=>{const tt=St(ee,je);if(_e.useEffect(()=>{tt===void 0&&Tt(ee,je)},[ee,je,tt]),!tt)return D.jsx("span",{style:{color:"#9ca3af"},children:""});if(tt.approved){const Ke=tt.approvedAt,Vt=Ke?new Date(Ke.toDate()).toLocaleString("nb-NO"):void 0;return D.jsx("span",{title:Vt,style:{color:"#16a34a",fontSize:"1rem"},children:""})}return D.jsx("span",{style:{color:"#9ca3af"},children:""})},[Re,Ge]=_e.useState(null),[Je,nt]=_e.useState(null),[kn,st]=_e.useState(""),[Xt,et]=_e.useState(""),[Te,kt]=_e.useState(""),[mt,Yt]=_e.useState("admin");_e.useEffect(()=>{(async()=>{try{o(!0);const tt=(await ei(wr(Nt,"users"))).docs.map(Ke=>{const Vt=Ke.data();return{docId:Ke.id,email:Vt.email??"",displayName:Vt.name??Vt.displayName??Vt.email??"(uten navn)",role:Vt.role??"student",term:Vt.term??null,phone:Vt.phone??null,allowedTerms:Vt.allowedTerms??[]}});tt.sort((Ke,Vt)=>Ke.displayName.localeCompare(Vt.displayName,"nb-NO",{sensitivity:"base"})),e(tt)}catch(je){console.error("Feil ved lasting av brukere:",je),e([])}finally{o(!1)}})()},[]);const Xn=_e.useMemo(()=>{const ee=h.trim().toLowerCase();return ee?s.filter(je=>{const tt=(je.displayName??"").toLowerCase(),Ke=(je.email??"").toLowerCase(),Vt=(je.phone??"").toLowerCase();return`${tt} ${Ke} ${Vt}`.includes(ee)}):s},[s,h]);let ri=Xn.filter(ee=>ee.role==="teacher"),Er=Xn.filter(ee=>ee.role==="student"),Bt=Xn.filter(ee=>ee.role==="admin");if(b!=="all"){const ee=b;ri=ri.filter(je=>(je.allowedTerms??[]).includes(ee))}if(te!=="all"){const ee=te;Er=Er.filter(je=>je.term===ee)}ri.sort((ee,je)=>{const tt=Gt=>S==="name"?Gt.displayName??"":S==="email"?Gt.email??"":Gt.phone??"",Ke=tt(ee).toLowerCase(),Vt=tt(je).toLowerCase();return Ke<Vt?P==="asc"?-1:1:Ke>Vt?P==="asc"?1:-1:0}),Er.sort((ee,je)=>{const tt=Gt=>ue==="name"?Gt.displayName??"":ue==="email"?Gt.email??"":Gt.phone??"",Ke=tt(ee).toLowerCase(),Vt=tt(je).toLowerCase();return Ke<Vt?ke==="asc"?-1:1:Ke>Vt?ke==="asc"?1:-1:0}),Bt.sort((ee,je)=>{const tt=Gt=>Pe==="name"?Gt.displayName??"":Pe==="email"?Gt.email??"":Gt.phone??"",Ke=tt(ee).toLowerCase(),Vt=tt(je).toLowerCase();return Ke<Vt?qe==="asc"?-1:1:Ke>Vt?qe==="asc"?1:-1:0}),ri=ri.slice(0,50),Er=Er.slice(0,50),Bt=Bt.slice(0,50);const An=ee=>{N(je=>je===ee?(X(tt=>tt==="asc"?"desc":"asc"),je):(X("asc"),ee))},mi=ee=>{Ye(je=>je===ee?(de(tt=>tt==="asc"?"desc":"asc"),je):(de("asc"),ee))},Gr=ee=>{ft(je=>je===ee?(F(tt=>tt==="asc"?"desc":"asc"),je):(F("asc"),ee))},Yn=()=>{Y("create"),rt(null),ce(""),ze(""),ct(""),pe("teacher"),Ve([])},Js=async()=>{const ee=ne.trim(),je=ae.trim(),tt=pt.trim();if(!ee){alert("E-post m fylles ut for  opprette lrer.");return}if(!De||De.length===0){alert("Velg minst n termin lreren kan registrere for.");return}try{const Ke=T1(),Gt=(await sf(A1,ee,Ke)).user.uid,Ln={uid:Gt,email:ee,displayName:je||ee,name:je||ee,role:K,term:null,phone:tt||null,allowedTerms:De};await ol(Un(Nt,"users",Gt),Ln,{merge:!0}),e(yn=>{const Lt=[{docId:Gt,email:ee,displayName:Ln.displayName,role:K,term:null,phone:tt||null,allowedTerms:[...De]},...yn];return Lt.sort((hr,Wn)=>hr.displayName.localeCompare(Wn.displayName,"nb-NO",{sensitivity:"base"})),Lt}),Y(null),rt(null),alert(`Ny lrer opprettet.

E-post: ${ee}
Midlertidig passord: ${Ke}

Gi passordet til lreren og be dem bytte etter frste innlogging.`)}catch(Ke){console.error("Feil ved oppretting av lrer:",Ke),Ke?.code==="auth/email-already-in-use"?alert("E-posten er allerede i bruk i Auth. Bruk en annen eller koble eksisterende bruker."):alert("Kunne ikke opprette lrer. Se console for mer info.")}},ar=ee=>{Y("edit"),rt(ee),ce(ee.displayName),ze(ee.email),ct(ee.phone??""),pe(ee.role),Ve(ee.allowedTerms??[])},Mr=async()=>{if(!H)return;const ee=H.docId;try{if(ne.trim()&&ne.trim()!==(H.email||""))try{const tt=w1(void 0,"europe-west1");await b1(tt,"adminUpdateUserEmail")({uid:ee,newEmail:ne.trim()})}catch(tt){console.error("adminUpdateUserEmail failed",tt),alert("Kunne ikke oppdatere lrerens epost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const je=Un(Nt,"users",ee);await Cs(je,{displayName:ae,email:ne,phone:pt||null,role:K,allowedTerms:De}),e(tt=>tt.map(Ke=>Ke.docId===ee?{...Ke,displayName:ae,email:ne,phone:pt||null,role:K,allowedTerms:[...De]}:Ke)),Y(null),rt(null)}catch(je){console.error("Feil ved lagring av lrer:",je),alert("Kunne ikke lagre endringer for lrer.")}},vi=()=>{Y(null),rt(null)},ii=ee=>{Ve(je=>je.includes(ee)?je.filter(tt=>tt!==ee):[...je,ee])},ys=()=>{we("create"),xt(null),Mn(""),$e(""),bt(""),Ct("student"),ht(null)},pi=async()=>{const ee=Ie.trim(),je=Mt.trim(),tt=He.trim();if(!ee){alert("E-post m fylles ut for  opprette student.");return}if(gt==null){alert("Velg termin studenten tilhrer.");return}try{const Ke=T1(),Gt=(await sf(A1,ee,Ke)).user.uid,Ln={uid:Gt,email:ee,displayName:je||ee,name:je||ee,role:yt,term:gt,phone:tt||null,allowedTerms:[]};await ol(Un(Nt,"users",Gt),Ln,{merge:!0}),e(yn=>{const Lt=[{docId:Gt,email:ee,displayName:Ln.displayName,role:yt,term:gt,phone:tt||null,allowedTerms:[]},...yn];return Lt.sort((hr,Wn)=>hr.displayName.localeCompare(Wn.displayName,"nb-NO",{sensitivity:"base"})),Lt}),we(null),xt(null),alert(`Ny student opprettet.

E-post: ${ee}
Midlertidig passord: ${Ke}

Gi passordet til studenten og be dem bytte etter frste innlogging.`)}catch(Ke){console.error("Feil ved oppretting av student:",Ke),Ke?.code==="auth/email-already-in-use"?alert("E-posten er allerede i bruk i Auth. Bruk en annen eller koble eksisterende bruker."):alert("Kunne ikke opprette student. Se console for mer info.")}},Es=ee=>{we("edit"),xt(ee),Mn(ee.displayName),$e(ee.email),bt(ee.phone??""),Ct(ee.role),ht(ee.term??null)},$n=async()=>{if(!ut)return;const ee=ut.docId;try{if(Ie.trim()&&Ie.trim()!==(ut.email||""))try{const tt=w1(void 0,"europe-west1");await b1(tt,"adminUpdateUserEmail")({uid:ee,newEmail:Ie.trim()})}catch(tt){console.error("adminUpdateUserEmail failed",tt),alert("Kunne ikke oppdatere studentens epost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const je=Un(Nt,"users",ee);await Cs(je,{displayName:Mt,email:Ie,phone:He||null,role:yt,term:gt??null}),e(tt=>tt.map(Ke=>Ke.docId===ee?{...Ke,displayName:Mt,email:Ie,phone:He||null,role:yt,term:gt??null}:Ke)),we(null),xt(null)}catch(je){console.error("Feil ved lagring av student:",je),alert("Kunne ikke lagre endringer for student.")}},kr=()=>{we(null),xt(null)},Lr=()=>{Ge("create"),nt(null),st(""),et(""),kt(""),Yt("admin")},We=async()=>{const ee=Xt.trim(),je=kn.trim(),tt=Te.trim();if(!ee){alert("E-post m fylles ut for  opprette admin.");return}if(!tt){alert("Mobilnummer m fylles ut for  opprette admin.");return}try{const Ke=T1(),Gt=(await sf(A1,ee,Ke)).user.uid,Ln={uid:Gt,email:ee,displayName:je||ee,name:je||ee,role:mt,term:null,phone:tt,allowedTerms:[]};await ol(Un(Nt,"users",Gt),Ln,{merge:!0}),e(yn=>{const Lt=[{docId:Gt,email:ee,displayName:Ln.displayName,role:mt,term:null,phone:tt,allowedTerms:[]},...yn];return Lt.sort((hr,Wn)=>hr.displayName.localeCompare(Wn.displayName,"nb-NO",{sensitivity:"base"})),Lt}),Ge(null),nt(null),alert(`Ny admin opprettet.

E-post: ${ee}
Midlertidig passord: ${Ke}

Gi passordet til admin og be dem bytte etter frste innlogging.`)}catch(Ke){console.error("Feil ved oppretting av admin:",Ke),Ke?.code==="auth/email-already-in-use"?alert("E-posten er allerede i bruk i Auth. Bruk en annen eller koble eksisterende bruker."):alert("Kunne ikke opprette admin. Se console for mer info.")}},Tr=ee=>{Ge("edit"),nt(ee),st(ee.displayName),et(ee.email),kt(ee.phone??""),Yt(ee.role)},Hn=async()=>{if(!Je)return;const ee=Je.docId;try{if(Xt.trim()&&Xt.trim()!==(Je.email||""))try{const tt=w1(void 0,"europe-west1");await b1(tt,"adminUpdateUserEmail")({uid:ee,newEmail:Xt.trim()})}catch(tt){console.error("adminUpdateUserEmail failed",tt),alert("Kunne ikke oppdatere adminepost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const je=Un(Nt,"users",ee);await Cs(je,{displayName:kn,email:Xt,phone:Te||null,role:mt}),e(tt=>tt.map(Ke=>Ke.docId===ee?{...Ke,displayName:kn,email:Xt,phone:Te||null,role:mt}:Ke)),Ge(null),nt(null)}catch(je){console.error("Feil ved lagring av admin:",je),alert("Kunne ikke lagre endringer for admin.")}},gn=()=>{Ge(null),nt(null)};return D.jsxs("div",{style:{marginBottom:"2rem"},children:[D.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem"},children:[D.jsx("button",{type:"button",onClick:()=>v("students"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #d1d5db",background:E==="students"?"#6CE1AB":"#ffffff",color:E==="students"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Studenter"}),D.jsx("button",{type:"button",onClick:()=>v("teachers"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #d1d5db",background:E==="teachers"?"#6CE1AB":"#ffffff",color:E==="teachers"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Lrere"}),D.jsx("button",{type:"button",onClick:()=>v("admins"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #d1d5db",background:E==="admins"?"#6CE1AB":"#ffffff",color:E==="admins"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Admin"})]}),D.jsx("input",{type:"text",placeholder:"Sk p navn, e-post eller mobil...",value:h,onChange:ee=>g(ee.target.value),style:{width:"100%",padding:"0.4rem 0.6rem",marginBottom:"0.75rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.9rem"}}),n?D.jsx(bo,{}):D.jsxs(D.Fragment,{children:[E==="teachers"&&D.jsxs("div",{style:{marginBottom:"1.2rem"},children:[D.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[D.jsx("div",{style:{fontSize:"0.8rem"},children:D.jsx("label",{children:D.jsxs("select",{value:b==="all"?"":b,onChange:ee=>{const je=ee.target.value;_(je===""?"all":parseInt(je,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[D.jsx("option",{value:"",children:"Alle terminer"}),Z.map(ee=>D.jsx("option",{value:ee.value,children:ee.label},ee.value))]})})}),D.jsx("button",{type:"button",onClick:Yn,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),D.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>An("name"),children:["Navn"," ",S==="name"&&(P==="asc"?"":"")]}),D.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>An("email"),children:["E-post"," ",S==="email"&&(P==="asc"?"":"")]}),D.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>An("phone"),children:["Mobil"," ",S==="phone"&&(P==="asc"?"":"")]})]})}),D.jsx("tbody",{children:ri.length===0?D.jsx("tr",{children:D.jsx("td",{colSpan:3,style:{padding:"0.4rem",fontSize:"0.85rem",color:"#6b7280"},children:"Ingen lrere funnet."})}):ri.map(ee=>D.jsxs("tr",{onClick:()=>ar(ee),style:{cursor:"pointer"},children:[D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.displayName}),D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.email}),D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.phone??""})]},ee.docId))})]})]}),E==="students"&&D.jsxs("div",{style:{marginBottom:"1.2rem"},children:[D.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[D.jsx("div",{style:{fontSize:"0.8rem"},children:D.jsx("label",{children:D.jsxs("select",{value:te==="all"?"":te,onChange:ee=>{const je=ee.target.value;oe(je===""?"all":parseInt(je,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[D.jsx("option",{value:"",children:"Alle terminer"}),Z.map(ee=>D.jsx("option",{value:ee.value,children:ee.label},ee.value))]})})}),D.jsx("button",{type:"button",onClick:ys,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),Er.length===0?D.jsx("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:"Ingen studenter funnet."}):D.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>mi("name"),children:["Navn"," ",ue==="name"&&(ke==="asc"?"":"")]}),D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem"},children:"Termin"}),D.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem"},children:"Godkjent?"})]})}),D.jsx("tbody",{children:Er.map(ee=>D.jsxs("tr",{onClick:()=>Es(ee),style:{cursor:"pointer"},children:[D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.displayName}),D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.term!=null&&ee.term!==void 0?_8(Z,ee.term):"Ingen"}),D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},onMouseEnter:je=>{Tt(ee.docId,ee.term??null)},children:ee.term==null?"":D.jsx(Ae,{uid:ee.docId,term:ee.term})})]},ee.docId))})]})]}),E==="admins"&&D.jsxs("div",{style:{marginBottom:"1.2rem"},children:[D.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"end",gap:"0.5rem",marginBottom:"0.4rem"},children:D.jsx("button",{type:"button",onClick:Lr,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})}),Bt.length===0?D.jsx("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:"Ingen administratorer funnet."}):D.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Gr("name"),children:["Navn"," ",Pe==="name"&&(qe==="asc"?"":"")]}),D.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Gr("email"),children:["E-post"," ",Pe==="email"&&(qe==="asc"?"":"")]}),D.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Gr("phone"),children:["Mobil"," ",Pe==="phone"&&(qe==="asc"?"":"")]})]})}),D.jsx("tbody",{children:Bt.map(ee=>D.jsxs("tr",{onClick:()=>Tr(ee),style:{cursor:"pointer"},children:[D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.displayName}),D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.email}),D.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:ee.phone??""})]},ee.docId))})]})]})]}),q&&D.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:D.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:q==="create"?"Ny lrer":"Rediger lrer"}),D.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:q==="create"?"Opprett ny lrer, velg hvilke terminer de kan registrere for og lagre.":"Endre navn, e-post, mobil, rolle og hvilke terminer lreren kan undervise p."}),D.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",D.jsx("input",{type:"text",value:ae,onChange:ee=>ce(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",D.jsx("input",{type:"email",value:ne,onChange:ee=>ze(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",D.jsx("input",{type:"tel",value:pt,onChange:ee=>ct(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",D.jsxs("select",{value:K,onChange:ee=>pe(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[D.jsx("option",{value:"teacher",children:"Lrer"}),D.jsx("option",{value:"student",children:"Student"}),D.jsx("option",{value:"admin",children:"Admin"})]})]}),D.jsxs("div",{style:{fontSize:"0.8rem"},children:[D.jsx("div",{style:{marginBottom:"0.25rem"},children:"Termin(er) lreren kan registrere for:"}),D.jsx("div",{style:{maxHeight:"150px",overflowY:"auto",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"0.35rem 0.45rem"},children:Z.map(ee=>D.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.35rem",fontSize:"0.8rem",padding:"0.15rem 0"},children:[D.jsx("input",{type:"checkbox",checked:De.includes(ee.value),onChange:()=>ii(ee.value)}),D.jsx("span",{children:ee.label})]},ee.value))})]})]}),D.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:vi,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),D.jsx("button",{type:"button",onClick:q==="create"?Js:Mr,style:{padding:"0.3rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:q==="create"?"Opprett lrer":"Lagre"})]})]})}),Le&&D.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:D.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:Le==="create"?"Ny student":"Rediger student"}),D.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:Le==="create"?"Opprett ny student og velg termin.":"Endre navn, e-post, mobil, rolle og termin."}),D.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",D.jsx("input",{type:"text",value:Mt,onChange:ee=>Mn(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",D.jsx("input",{type:"email",value:Ie,onChange:ee=>$e(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",D.jsx("input",{type:"tel",value:He,onChange:ee=>bt(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",D.jsxs("select",{value:yt,onChange:ee=>Ct(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[D.jsx("option",{value:"student",children:"Student"}),D.jsx("option",{value:"teacher",children:"Lrer"}),D.jsx("option",{value:"admin",children:"Admin"})]})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Termin",D.jsxs("select",{value:gt??"",onChange:ee=>{const je=ee.target.value;ht(je===""?null:parseInt(je,10))},style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[D.jsx("option",{value:"",children:"Ingen"}),Z.map(ee=>D.jsx("option",{value:ee.value,children:ee.label},ee.value))]})]})]}),D.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:kr,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),D.jsx("button",{type:"button",onClick:Le==="create"?pi:$n,style:{padding:"0.3rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:Le==="create"?"Opprett student":"Lagre"})]})]})}),Re&&D.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:D.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:Re==="create"?"Ny admin":"Rediger admin"}),D.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:Re==="create"?"Opprett ny admin.":"Endre navn, e-post, mobil og rolle."}),D.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",D.jsx("input",{type:"text",value:kn,onChange:ee=>st(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",D.jsx("input",{type:"email",value:Xt,onChange:ee=>et(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",D.jsx("input",{type:"tel",value:Te,onChange:ee=>kt(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),D.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",D.jsxs("select",{value:mt,onChange:ee=>Yt(ee.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[D.jsx("option",{value:"admin",children:"Admin"}),D.jsx("option",{value:"teacher",children:"Lrer"}),D.jsx("option",{value:"student",children:"Student"})]})]})]}),D.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:gn,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),D.jsx("button",{type:"button",onClick:Re==="create"?We:Hn,style:{padding:"0.3rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:Re==="create"?"Opprett admin":"Lagre"})]})]})})]})},tR=()=>{const[s,e]=_e.useState([]),[n,o]=_e.useState(""),[h,g]=_e.useState([]),[E,v]=_e.useState(!0),[b,_]=_e.useState(""),[S,N]=_e.useState({}),[P,X]=_e.useState(null),[te,oe]=_e.useState(""),[ue,Ye]=_e.useState(""),[ke,de]=_e.useState(null),[Pe,ft]=_e.useState(0),[qe,F]=_e.useState({}),[j,V]=_e.useState([]),[Z,q]=_e.useState(!1),[Y,H]=_e.useState(""),rt=_e.useRef(null),[ae,ce]=_e.useState(!1),[ne,ze]=_e.useState([]),[pt,ct]=_e.useState(!1),[K,pe]=_e.useState([]);_e.useEffect(()=>{(async()=>{try{v(!0);const[Re,Ge,Je,nt]=await Promise.all([ei(wr(Nt,"requirements")),ei(wr(Nt,"times")),ei(wr(Nt,"termLabels")).catch(()=>null),ei(wr(Nt,"terms")).catch(()=>null)]),kn=Re.docs.map(Xt=>{const et=Xt.data();return{id:Xt.id,term:et.term,category:et.category,requiredCount:et.requiredCount??0,order:typeof et?.order=="number"?et.order:void 0}}),st=Ge.docs.map(Xt=>{const et=Xt.data();return{id:Xt.id,name:et.name,category:et.category,term:et.term}});if(e(kn),g(st),nt){const Xt=nt.docs.map(et=>{const Te=et.data(),kt=typeof Te?.value=="number"?Te.value:void 0,mt=typeof Te?.label=="string"?Te.label:"",Yt=typeof Te?.order=="number"?Te.order:void 0;return typeof kt!="number"?null:{docId:et.id,value:kt,label:mt,order:Yt}}).filter(Boolean);Xt.sort((et,Te)=>{const kt=et.order??et.value,mt=Te.order??Te.value;return kt-mt}),V(Xt)}if(Je){const Xt={};Je.docs.forEach(et=>{const Te=et.data(),kt=parseInt(et.id,10);!Number.isNaN(kt)&&typeof Te?.label=="string"&&Te.label.trim()&&(Xt[kt]=Te.label.trim())}),F(Xt)}}catch(Re){console.error("Feil ved lasting av termin-oppsett:",Re)}finally{v(!1)}})()},[]);const De=s.filter(Ae=>Ae.term===n).sort((Ae,Re)=>{const Ge=Ae.order??Number.MAX_SAFE_INTEGER,Je=Re.order??Number.MAX_SAFE_INTEGER;return Ge!==Je?Ge-Je:Ae.category.localeCompare(Re.category,"nb-NO",{sensitivity:"base"})}),Ve=_e.useMemo(()=>{const Ae=j.slice().sort((Re,Ge)=>(Re.order??Re.value)-(Ge.order??Ge.value)).map(Re=>({value:Re.value,label:Re.label||`Termin ${Re.value}`}));return Object.keys(qe).length>0?Ae.map(Re=>({...Re,label:qe[Re.value]??Re.label})):Ae},[j,qe]),Le=Ae=>ml(Ve,Ae??null),we=()=>{if(n==="")return;const Ae=Le(n);H(Ae),q(!0),setTimeout(()=>rt.current?.focus(),0)},ut=()=>{q(!1),H("")},xt=async()=>{if(n==="")return;const Ae=Le(n),Re=Y.trim();if(!Re||Re===Ae){q(!1);return}try{const Ge=j.find(Je=>Je.value===Number(n));if(Ge)await Cs(Un(Nt,"terms",Ge.docId),{label:Re,updatedAt:mf()}),V(Je=>Je.map(nt=>nt.docId===Ge.docId?{...nt,label:Re}:nt));else{const Je=String(n);await ol(Un(Nt,"termLabels",Je),{label:Re,updatedAt:mf(),value:Number(n)},{merge:!0}),F(nt=>({...nt,[Number(n)]:Re}))}q(!1)}catch(Ge){console.error("Feil ved endring av modulnavn:",Ge),alert("Kunne ikke endre navn p modulen.")}},Mt=async()=>{try{const Ae=j.map(et=>et.value),Re=j.map(et=>et.order??et.value),Ge=Ae.length>0?Math.max(...Ae):0,Je=Re.length>0?Math.max(...Re):0,nt=Ge+1,kn=Je+1,Xt={docId:(await gf(wr(Nt,"terms"),{value:nt,label:"",order:kn,createdAt:mf()})).id,value:nt,label:"",order:kn};V(et=>[...et,Xt]),o(nt),H(""),q(!0),setTimeout(()=>rt.current?.focus(),0)}catch(Ae){console.error("Kunne ikke opprette ny oppmtebok:",Ae),alert("Kunne ikke opprette ny oppmtebok.")}},Mn=()=>{if(j.length===0)return;const Ae=j.slice().sort((Re,Ge)=>(Re.order??Re.value)-(Ge.order??Ge.value));ze(Ae),ce(!0)},Ie=(Ae,Re)=>{ze(Ge=>{const Je=Ge.slice(),nt=Ae+Re;if(nt<0||nt>=Je.length)return Ge;const[kn]=Je.splice(Ae,1);return Je.splice(nt,0,kn),Je})},$e=async()=>{try{const Ae=_1(Nt);ne.forEach((Re,Ge)=>{Ae.update(Un(Nt,"terms",Re.docId),{order:Ge+1})}),await Ae.commit(),V(ne.map((Re,Ge)=>({...Re,order:Ge+1}))),ce(!1)}catch(Ae){console.error("Kunne ikke lagre sortering av terminer:",Ae),alert("Kunne ikke lagre sortering av terminer.")}},He=()=>{if(n==="")return;const Ae=s.filter(Re=>Re.term===n).slice().sort((Re,Ge)=>{const Je=Re.order??Number.MAX_SAFE_INTEGER,nt=Ge.order??Number.MAX_SAFE_INTEGER;return Je!==nt?Je-nt:Re.category.localeCompare(Ge.category,"nb-NO",{sensitivity:"base"})});pe(Ae),ct(!0)},bt=(Ae,Re)=>{pe(Ge=>{const Je=Ge.slice(),nt=Ae+Re;if(nt<0||nt>=Je.length)return Ge;const[kn]=Je.splice(Ae,1);return Je.splice(nt,0,kn),Je})},yt=async()=>{try{const Ae=_1(Nt);K.forEach((Re,Ge)=>{Ae.update(Un(Nt,"requirements",Re.id),{order:Ge+1})}),await Ae.commit(),e(Re=>{const Ge={};return K.forEach((Je,nt)=>Ge[Je.id]=nt+1),Re.map(Je=>Ge[Je.id]?{...Je,order:Ge[Je.id]}:Je)}),ct(!1)}catch(Ae){console.error("Kunne ikke lagre sortering av grupper:",Ae),alert("Kunne ikke lagre sortering av grupper.")}},Ct=async Ae=>{const Re=te.trim();if(!Re||Re===Ae.name){X(null),oe("");return}try{await Cs(Un(Nt,"times",Ae.id),{name:Re}),g(Ge=>Ge.map(Je=>Je.id===Ae.id?{...Je,name:Re}:Je)),X(null),oe("")}catch(Ge){console.error("Feil ved endring av timenavn:",Ge),alert("Kunne ikke oppdatere navn p timen.")}},gt=h.filter(Ae=>Ae.term===n),ht=Ae=>{de(Ae.id),Ye(Ae.category),ft(Ae.requiredCount??0)},Qe=()=>{de(null)},en=async Ae=>{if(!ke)return;const Re=Ae.category,Ge=(ue||"").trim()||Re,Je=h.filter(st=>st.term===Ae.term&&st.category===Re).length;let nt=Pe;if((Number.isNaN(nt)||nt<0)&&(nt=0),Je>0&&nt>Je&&(nt=Je),De.find(st=>st.id!==Ae.id&&st.category.toLowerCase()===Ge.toLowerCase())){alert("Det finnes allerede en gruppe med dette navnet i valgt termin.");return}try{const st=_1(Nt),Xt=Un(Nt,"requirements",Ae.id);st.update(Xt,{category:Ge,requiredCount:nt});const et=Ia(wr(Nt,"times"),$i("term","==",Ae.term),$i("category","==",Re));(await ei(et)).forEach(Yt=>{st.update(Yt.ref,{category:Ge})});const kt=Ia(wr(Nt,"sessions"),$i("term","==",Ae.term),$i("category","==",Re));(await ei(kt)).forEach(Yt=>{st.update(Yt.ref,{category:Ge})}),await st.commit(),e(Yt=>Yt.map(Xn=>Xn.id===Ae.id?{...Xn,category:Ge,requiredCount:nt}:Xn)),g(Yt=>Yt.map(Xn=>Xn.term===Ae.term&&Xn.category===Re?{...Xn,category:Ge}:Xn)),de(null)}catch(st){console.error("Feil ved lagring av gruppe:",st),alert("Kunne ikke lagre endringene for gruppen.")}},Xe=async()=>{const Ae=b.trim();if(!Ae)return;if(De.some(Ge=>Ge.category.toLowerCase()===Ae.toLowerCase())){alert("Denne gruppen finnes allerede for valgt termin.");return}try{const Ge=s.filter(st=>st.term===n),nt=(Ge.length?Math.max(...Ge.map(st=>typeof st.order=="number"?st.order:0)):0)+1,kn=await gf(wr(Nt,"requirements"),{term:n,category:Ae,requiredCount:0,order:nt});e(st=>[...st,{id:kn.id,term:n,category:Ae,requiredCount:0,order:nt}]),_("")}catch(Ge){console.error("Feil ved oppretting av kategori:",Ge),alert("Kunne ikke opprette kategori.")}},Ur=async Ae=>{if(window.confirm("Er du sikker p at du vil slette denne gruppen for terminen?"))try{await KE(Un(Nt,"requirements",Ae)),e(Re=>Re.filter(Ge=>Ge.id!==Ae))}catch(Re){console.error("Feil ved sletting av krav:",Re),alert("Kunne ikke slette gruppen.")}},St=async Ae=>{const Re=Ae.id,Ge=(S[Re]??"").trim();if(Ge)try{const Je=await gf(wr(Nt,"times"),{term:n,category:Ae.category,name:Ge});g(nt=>[...nt,{id:Je.id,term:n,category:Ae.category,name:Ge}]),N(nt=>({...nt,[Re]:""}))}catch(Je){console.error("Feil ved oppretting av time:",Je),alert("Kunne ikke opprette time.")}},Tt=async Ae=>{if(window.confirm(`Slette timen "${Ae.name}" fra ${Le(Ae.term)}? Historiske sesjoner beholdes, men timen forsvinner fra admin-oppsettet.`))try{await KE(Un(Nt,"times",Ae.id)),g(Ge=>Ge.filter(Je=>Je.id!==Ae.id))}catch(Ge){console.error("Feil ved sletting av time:",Ge),alert("Kunne ikke slette time.")}};return E?D.jsx(bo,{}):D.jsxs(D.Fragment,{children:[D.jsxs("section",{style:{marginBottom:"2rem"},children:[D.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[D.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[Z?D.jsx("input",{ref:rt,type:"text",value:Y,onChange:Ae=>H(Ae.target.value),onKeyDown:Ae=>{Ae.key==="Enter"?(Ae.preventDefault(),xt()):Ae.key==="Escape"&&(Ae.preventDefault(),ut())},placeholder:"Navn p modul",style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}}):D.jsxs("select",{value:n,onChange:Ae=>{const Re=Ae.target.value;if(Re==="__new__"){Mt();return}o(Re===""?"":parseInt(Re,10))},style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"},children:[D.jsx("option",{value:"",disabled:!0,children:"Velg termin"}),Ve.map(Ae=>D.jsx("option",{value:Ae.value,children:Ae.label},Ae.value)),D.jsx("option",{value:"__new__",children:"+ Ny oppmtebok"})]}),D.jsx("button",{type:"button",disabled:n===""&&!Z,onClick:()=>{Z?xt():we()},style:{width:"160px",padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#6CE1AB",color:"black",fontSize:"0.9rem",cursor:n===""&&!Z?"not-allowed":"pointer",whiteSpace:"nowrap"},children:Z?"Lagre":"Endre navn"}),D.jsx("button",{type:"button",title:"Sorter oppmtebker",disabled:j.length===0,onClick:Mn,style:{padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",background:"#ffffff",fontSize:"0.9rem",cursor:j.length===0?"not-allowed":"pointer"},children:""})]}),D.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",alignItems:"center"},children:[D.jsx("input",{type:"text",placeholder:"Ny gruppe...",value:b,onChange:Ae=>_(Ae.target.value),onKeyDown:Ae=>{Ae.key==="Enter"&&(Ae.preventDefault(),Xe())},style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}}),D.jsx("button",{type:"button",onClick:Xe,style:{width:"160px",padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#6CE1AB",color:"black",fontSize:"0.9rem",cursor:"pointer",whiteSpace:"nowrap"},children:"Legg til gruppe"}),D.jsx("button",{type:"button",title:"Sorter grupper",disabled:n===""||De.length===0,onClick:He,style:{padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",background:"#ffffff",fontSize:"0.9rem",cursor:n===""||De.length===0?"not-allowed":"pointer"},children:""})]})]}),De.length===0?D.jsxs("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:["Ingen grupper definert enn for ",Le(n),"."]}):D.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:De.map(Ae=>{const Re=Ae.id,Ge=gt.filter(st=>st.category===Ae.category).sort((st,Xt)=>{const et=fx(st.name),Te=fx(Xt.name);return et!==Te?et-Te:st.name.localeCompare(Xt.name,"nb-NO",{sensitivity:"base"})}),Je=S[Re]??"",nt=gt.filter(st=>st.category===Ae.category).length,kn=ke===Ae.id;return D.jsxs("div",{style:{borderRadius:"0.75rem",border:"1px solid #e5e7eb",padding:"0.75rem 0.75rem",backgroundColor:"#f9fafb"},children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem",gap:"0.5rem",flexWrap:"wrap"},children:[D.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:kn?D.jsxs(D.Fragment,{children:[D.jsx("input",{type:"text",value:ue,onChange:st=>Ye(st.target.value),onKeyDown:st=>{st.key==="Enter"?en(Ae):st.key==="Escape"&&Qe()},autoFocus:!0,style:{minWidth:"12rem",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.9rem"}}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[D.jsx("input",{type:"number",min:0,max:nt,value:Pe,onChange:st=>{const Xt=parseInt(st.target.value,10);ft(Number.isNaN(Xt)?0:Xt)},onKeyDown:st=>{st.key==="Enter"?en(Ae):st.key==="Escape"&&Qe()},style:{width:"4rem",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.9rem",textAlign:"center"}}),D.jsxs("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:["/ ",nt]})]})]}):D.jsxs("div",{style:{fontWeight:600,fontSize:"0.95rem"},children:[Ae.category," (",Ae.requiredCount,"/",nt,")"]})}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:()=>kn?void en(Ae):ht(Ae),style:{padding:"0.25rem 0.6rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:kn?"Lagre":"Endre gruppe"}),D.jsx("button",{type:"button",onClick:()=>Ur(Ae.id),style:{padding:"0.25rem 0.6rem",borderRadius:"999px",border:"none",backgroundColor:"#fee2e2",color:"#991b1b",fontSize:"0.75rem",cursor:"pointer"},children:"Slett gruppe"})]})]}),Ge.length>0?D.jsx("ul",{style:{listStyle:"none",paddingLeft:0,margin:"0 0 0.5rem 0",fontSize:"0.85rem"},children:Ge.map(st=>{const Xt=P===st.id;return D.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.15rem 0",borderBottom:"1px dashed #e5e7eb",gap:"0.5rem"},children:[D.jsx("div",{style:{flex:1},children:Xt?D.jsx("input",{type:"text",value:te,onChange:et=>oe(et.target.value),onKeyDown:et=>{et.key==="Enter"?Ct(st):et.key==="Escape"&&(X(null),oe(""))},autoFocus:!0,style:{width:"100%",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.85rem"}}):D.jsx("span",{children:st.name})}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[Xt?D.jsx("button",{type:"button",onClick:()=>void Ct(st),style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:"Lagre"}):D.jsx("button",{type:"button",onClick:()=>{X(st.id),oe(st.name)},style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:"Endre"}),D.jsx("button",{type:"button",onClick:()=>Tt(st),style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#fee2e2",color:"#b91c1c",fontSize:"0.75rem",cursor:"pointer"},children:"Slett"})]})]},st.id)})}):D.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.8rem",color:"#9ca3af"},children:"Ingen timer lagt til i denne gruppen."}),D.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"},children:[D.jsx("input",{type:"text",placeholder:"Ny time...",value:Je,onChange:st=>N(Xt=>({...Xt,[Re]:st.target.value})),onKeyDown:st=>{st.key==="Enter"&&(st.preventDefault(),St(Ae))},style:{flex:1,padding:"0.3rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem"}}),D.jsx("button",{type:"button",onClick:()=>St(Ae),style:{padding:"0.35rem 0.8rem",borderRadius:"999px",border:"none",backgroundColor:"#4b5563",color:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til time"})]})]},Ae.id)})})]}),ae&&D.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:D.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[D.jsx("h3",{style:{marginTop:0},children:"Sorter oppmtebker"}),D.jsx("ul",{style:{listStyle:"none",padding:0,margin:"0 0 0.75rem"},children:ne.map((Ae,Re)=>D.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.4rem 0.6rem",marginBottom:"0.4rem"},children:[D.jsx("span",{style:{fontSize:"0.9rem"},children:Ae.label||`Termin ${Ae.value}`}),D.jsxs("span",{style:{display:"flex",gap:"0.25rem"},children:[D.jsx("button",{type:"button",onClick:()=>Ie(Re,-1),disabled:Re===0,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""}),D.jsx("button",{type:"button",onClick:()=>Ie(Re,1),disabled:Re===ne.length-1,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""})]})]},Ae.docId))}),D.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:()=>ce(!1),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff"},children:"Avbryt"}),D.jsx("button",{type:"button",onClick:()=>void $e(),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"none",background:"#16a34a",color:"#fff"},children:"Lagre rekkeflge"})]})]})}),pt&&D.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:D.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[D.jsx("h3",{style:{marginTop:0},children:"Sorter grupper"}),D.jsx("ul",{style:{listStyle:"none",padding:0,margin:"0 0 0.75rem"},children:K.map((Ae,Re)=>D.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.4rem 0.6rem",marginBottom:"0.4rem"},children:[D.jsx("span",{style:{fontSize:"0.9rem"},children:Ae.category}),D.jsxs("span",{style:{display:"flex",gap:"0.25rem"},children:[D.jsx("button",{type:"button",onClick:()=>bt(Re,-1),disabled:Re===0,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""}),D.jsx("button",{type:"button",onClick:()=>bt(Re,1),disabled:Re===K.length-1,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""})]})]},Ae.id))}),D.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:()=>ct(!1),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff"},children:"Avbryt"}),D.jsx("button",{type:"button",onClick:()=>void yt(),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"none",background:"#16a34a",color:"#fff"},children:"Lagre rekkeflge"})]})]})})]})},nR=()=>{const{user:s,loading:e,logout:n}=dd(),[o,h]=_e.useState("setup"),[g,E]=_e.useState(!1);return e?D.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:D.jsx(bo,{})}):!s||s.role!=="admin"?D.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"1.5rem"},children:D.jsxs("div",{className:"page-card page-card--admin",children:[D.jsx("h2",{children:"Ingen tilgang"}),D.jsx("p",{children:"Du m vre logget inn som administrator for  se denne siden."})]})}):D.jsxs(D.Fragment,{children:[D.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"flex-start",justifyContent:"center",padding:"1.5rem 1rem"},children:D.jsxs("div",{className:"page-card page-card--admin",children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[D.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),D.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:()=>E(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),D.jsx("button",{type:"button",onClick:n,style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),D.jsxs("header",{style:{marginBottom:"1rem",borderBottom:"1px solid #e5e7eb",paddingBottom:"0.75rem"},children:[D.jsx("h2",{style:{margin:0},children:"Adminpanel"}),D.jsx("p",{style:{margin:"0.25rem 0 0.75rem",fontSize:"0.85rem",color:"#6b7280"},children:"Oppsett av krav per termin, administrasjon av brukere og forhndsvisning for lrere."}),D.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[D.jsx("button",{type:"button",onClick:()=>h("setup"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #e5e7eb",background:o==="setup"?"#6CE1AB":"#ffffff",color:o==="setup"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Oppmtebker"}),D.jsx("button",{type:"button",onClick:()=>h("users"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #e5e7eb",background:o==="users"?"#6CE1AB":"#ffffff",color:o==="users"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Brukere"})]})]}),o==="setup"&&D.jsx(tR,{}),o==="users"&&D.jsx(eR,{})]})}),g&&D.jsx(im,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>E(!1)})]})};function rR(s){try{return s.toLocaleDateString("no-NO")}catch{const e=String(s.getDate()).padStart(2,"0"),n=String(s.getMonth()+1).padStart(2,"0"),o=s.getFullYear();return`${e}.${n}.${o}`}}function v1(){const s=rR(new Date);return D.jsx("footer",{className:"site-footer",role:"contentinfo",style:{backgroundColor:"#6CE1AB"},children:D.jsxs("div",{id:"footer-container",className:"footer-row",style:{width:"90%",margin:"5rem auto 0",padding:"3rem 0 2rem",display:"flex",justifyContent:"space-between"},children:[D.jsxs("div",{className:"footer-left",style:{width:"60%",marginRight:"2rem",alignItems:"left"},children:[D.jsxs("p",{className:"small-text",children:["Sist teknisk oppdatert: ",s,"."]}),D.jsx("h2",{children:"Laget med kjrlighet for en effektiv hverdag"}),D.jsx("p",{children:"Dette er sten beskrive at vi lytter til brukernes behov, og at forbedringer blir rullet ut fortlpende. Vrt ml er enkel registreringp design, funksjonalitet og tilgjengelighet. Takk for at du n, deler innspill, og bidrar til  gjre hverdagen mer effektiv. Din erfaring hjelper oss  prioritere riktig videre."})]}),D.jsxs("div",{className:"footer-right",style:{alignItems:"right",textAlign:"right",width:"30%"},children:[D.jsx("img",{src:"./public/favicon.svg",alt:"Oppmteboka logo",style:{width:"50px"}}),D.jsxs("div",{className:"footer-feedback",children:[D.jsx("a",{href:"mailto:hei@oppmoteboka.no?subject=Tilbakelding",className:"footer-link",style:{color:"black"},children:"Gi tilbakemelding"}),D.jsx("p",{className:"footer-mail",children:"hei@oppmoteboka.no"})]}),D.jsx("p",{className:"footer-credits",style:{marginTop:"1rem"},children:"Nettisden er utviklet av Vetle Mrland og ge Frivoll"})]})]})})}function iR(){const{user:s,loading:e,login:n}=dd(),[o,h]=_e.useState(""),[g,E]=_e.useState(""),[v,b]=_e.useState(null),[_,S]=_e.useState(!1),N=async P=>{if(P.preventDefault(),b(null),!o||!g){b("Fyll inn bde e-post og passord.");return}S(!0);try{await n(o.trim(),g)}catch(X){console.error(X);let te="Kunne ikke logge inn.";X?.code==="auth/user-not-found"?te="Bruker finnes ikke.":X?.code==="auth/wrong-password"?te="Feil passord.":X?.code==="auth/email-already-in-use"?te="E-postadressen er allerede registrert.":X?.code==="auth/weak-password"&&(te="Passordet er for svakt (min. 6 tegn)."),b(te)}finally{S(!1)}};return e?D.jsxs(D.Fragment,{children:[D.jsx("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",padding:"1rem 0.75rem 0"},children:D.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"auto 0"},children:D.jsx("div",{className:"page-card",children:D.jsx(bo,{})})})}),D.jsx(v1,{})]}):s?D.jsxs(D.Fragment,{children:[D.jsx("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",width:"100%",padding:"1rem 0.75rem 0"},children:D.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"auto 0"},children:s.role==="admin"?D.jsx(nR,{user:s}):s.role==="teacher"?D.jsx(M8,{user:s}):D.jsx(b8,{user:s})})}),D.jsx(v1,{})]}):D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"front-page",style:{minHeight:"100vh",display:"flex",flexDirection:"column",background:"#CEFFDF",width:"100%",padding:"1rem 0.75rem 0"},children:D.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"auto 0"},children:D.jsxs("div",{className:"page-card",style:{maxWidth:"420px"},children:[D.jsx("h1",{style:{marginBottom:"2rem",textAlign:"center"},children:"Oppmteregistrering"}),D.jsxs("form",{onSubmit:N,children:[D.jsxs("div",{style:{marginBottom:"0.75rem"},children:[D.jsx("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:"0.2rem"},children:"Mobil / Epost"}),D.jsx("input",{type:"email",value:o,onChange:P=>h(P.target.value),placeholder:"uiobrukernavn@uio.no",style:{width:"100%",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}})]}),D.jsxs("div",{style:{marginBottom:"0.75rem"},children:[D.jsx("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:"0.2rem"},children:"Passord"}),D.jsx("input",{type:"password",value:g,onChange:P=>E(P.target.value),placeholder:"Minst 6 tegn",style:{width:"100%",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}})]}),v&&D.jsx("p",{style:{color:"red",fontSize:"0.85rem",marginBottom:"0.75rem"},children:v}),D.jsx("button",{type:"submit",disabled:_,style:{width:"100%",padding:"0.6rem 1rem",borderRadius:"999px",border:"none",background:"#6CE1AB",color:"black",fontWeight:500,cursor:"pointer",marginTop:"1.5rem",marginBottom:"1rem"},children:_?"Logger inn...":"Logg inn"})]})]})})}),D.jsx(v1,{})]})}Nb.createRoot(document.getElementById("root")).render(D.jsx(Nr.StrictMode,{children:D.jsx(iR,{})}));
