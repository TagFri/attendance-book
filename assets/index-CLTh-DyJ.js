function Ob(s,e){for(var t=0;t<e.length;t++){const o=e[t];if(typeof o!="string"&&!Array.isArray(o)){for(const u in o)if(u!=="default"&&!(u in s)){const g=Object.getOwnPropertyDescriptor(o,u);g&&Object.defineProperty(s,u,g.get?g:{enumerable:!0,get:()=>o[u]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const g of u)if(g.type==="childList")for(const x of g.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&o(x)}).observe(document,{childList:!0,subtree:!0});function t(u){const g={};return u.integrity&&(g.integrity=u.integrity),u.referrerPolicy&&(g.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?g.credentials="include":u.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function o(u){if(u.ep)return;u.ep=!0;const g=t(u);fetch(u.href,g)}})();var $h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xd(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var a1={exports:{}},iu={};var h2;function Db(){if(h2)return iu;h2=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(o,u,g){var x=null;if(g!==void 0&&(x=""+g),u.key!==void 0&&(x=""+u.key),"key"in u){g={};for(var T in u)T!=="key"&&(g[T]=u[T])}else g=u;return u=g.ref,{$$typeof:s,type:o,key:x,ref:u!==void 0?u:null,props:g}}return iu.Fragment=e,iu.jsx=t,iu.jsxs=t,iu}var d2;function Mb(){return d2||(d2=1,a1.exports=Db()),a1.exports}var I=Mb(),o1={exports:{}},Jt={};var f2;function kb(){if(f2)return Jt;f2=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),g=Symbol.for("react.consumer"),x=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.iterator;function L(Q){return Q===null||typeof Q!="object"?null:(Q=P&&Q[P]||Q["@@iterator"],typeof Q=="function"?Q:null)}var ee={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},re=Object.assign,se={};function Ye(Q,$,pe){this.props=Q,this.context=$,this.refs=se,this.updater=pe||ee}Ye.prototype.isReactComponent={},Ye.prototype.setState=function(Q,$){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,$,"setState")},Ye.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function Oe(){}Oe.prototype=Ye.prototype;function le(Q,$,pe){this.props=Q,this.context=$,this.refs=se,this.updater=pe||ee}var Ue=le.prototype=new Oe;Ue.constructor=le,re(Ue,Ye.prototype),Ue.isPureReactComponent=!0;var dt=Array.isArray;function Ze(){}var F={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function U(Q,$,pe){var Te=pe.ref;return{$$typeof:s,type:Q,key:$,ref:Te!==void 0?Te:null,props:pe}}function J(Q,$){return U(Q.type,$,Q.props)}function X(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===s}function Y(Q){var $={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(pe){return $[pe]})}var G=/\/+/g;function at(Q,$){return typeof Q=="object"&&Q!==null&&Q.key!=null?Y(""+Q.key):$.toString(36)}function ce(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(Ze,Ze):(Q.status="pending",Q.then(function($){Q.status==="pending"&&(Q.status="fulfilled",Q.value=$)},function($){Q.status==="pending"&&(Q.status="rejected",Q.reason=$)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function ue(Q,$,pe,Te,nt){var ve=typeof Q;(ve==="undefined"||ve==="boolean")&&(Q=null);var st=!1;if(Q===null)st=!0;else switch(ve){case"bigint":case"string":case"number":st=!0;break;case"object":switch(Q.$$typeof){case s:case e:st=!0;break;case C:return st=Q._init,ue(st(Q._payload),$,pe,Te,nt)}}if(st)return nt=nt(Q),st=Te===""?"."+at(Q,0):Te,dt(nt)?(pe="",st!=null&&(pe=st.replace(G,"$&/")+"/"),ue(nt,$,pe,"",function(cn){return cn})):nt!=null&&(X(nt)&&(nt=J(nt,pe+(nt.key==null||Q&&Q.key===nt.key?"":(""+nt.key).replace(G,"$&/")+"/")+st)),$.push(nt)),1;st=0;var xt=Te===""?".":Te+":";if(dt(Q))for(var kt=0;kt<Q.length;kt++)Te=Q[kt],ve=xt+at(Te,kt),st+=ue(Te,$,pe,ve,nt);else if(kt=L(Q),typeof kt=="function")for(Q=kt.call(Q),kt=0;!(Te=Q.next()).done;)Te=Te.value,ve=xt+at(Te,kt++),st+=ue(Te,$,pe,ve,nt);else if(ve==="object"){if(typeof Q.then=="function")return ue(ce(Q),$,pe,Te,nt);throw $=String(Q),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return st}function Ee(Q,$,pe){if(Q==null)return Q;var Te=[],nt=0;return ue(Q,Te,"","",function(ve){return $.call(pe,ve,nt++)}),Te}function We(Q){if(Q._status===-1){var $=Q._result;$=$(),$.then(function(pe){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=pe)},function(pe){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=pe)}),Q._status===-1&&(Q._status=0,Q._result=$)}if(Q._status===1)return Q._result.default;throw Q._result}var qe=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},ot={map:Ee,forEach:function(Q,$,pe){Ee(Q,function(){$.apply(this,arguments)},pe)},count:function(Q){var $=0;return Ee(Q,function(){$++}),$},toArray:function(Q){return Ee(Q,function($){return $})||[]},only:function(Q){if(!X(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return Jt.Activity=R,Jt.Children=ot,Jt.Component=Ye,Jt.Fragment=t,Jt.Profiler=u,Jt.PureComponent=le,Jt.StrictMode=o,Jt.Suspense=b,Jt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Jt.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return F.H.useMemoCache(Q)}},Jt.cache=function(Q){return function(){return Q.apply(null,arguments)}},Jt.cacheSignal=function(){return null},Jt.cloneElement=function(Q,$,pe){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var Te=re({},Q.props),nt=Q.key;if($!=null)for(ve in $.key!==void 0&&(nt=""+$.key),$)!z.call($,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&$.ref===void 0||(Te[ve]=$[ve]);var ve=arguments.length-2;if(ve===1)Te.children=pe;else if(1<ve){for(var st=Array(ve),xt=0;xt<ve;xt++)st[xt]=arguments[xt+2];Te.children=st}return U(Q.type,nt,Te)},Jt.createContext=function(Q){return Q={$$typeof:x,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:g,_context:Q},Q},Jt.createElement=function(Q,$,pe){var Te,nt={},ve=null;if($!=null)for(Te in $.key!==void 0&&(ve=""+$.key),$)z.call($,Te)&&Te!=="key"&&Te!=="__self"&&Te!=="__source"&&(nt[Te]=$[Te]);var st=arguments.length-2;if(st===1)nt.children=pe;else if(1<st){for(var xt=Array(st),kt=0;kt<st;kt++)xt[kt]=arguments[kt+2];nt.children=xt}if(Q&&Q.defaultProps)for(Te in st=Q.defaultProps,st)nt[Te]===void 0&&(nt[Te]=st[Te]);return U(Q,ve,nt)},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(Q){return{$$typeof:T,render:Q}},Jt.isValidElement=X,Jt.lazy=function(Q){return{$$typeof:C,_payload:{_status:-1,_result:Q},_init:We}},Jt.memo=function(Q,$){return{$$typeof:w,type:Q,compare:$===void 0?null:$}},Jt.startTransition=function(Q){var $=F.T,pe={};F.T=pe;try{var Te=Q(),nt=F.S;nt!==null&&nt(pe,Te),typeof Te=="object"&&Te!==null&&typeof Te.then=="function"&&Te.then(Ze,qe)}catch(ve){qe(ve)}finally{$!==null&&pe.types!==null&&($.types=pe.types),F.T=$}},Jt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Jt.use=function(Q){return F.H.use(Q)},Jt.useActionState=function(Q,$,pe){return F.H.useActionState(Q,$,pe)},Jt.useCallback=function(Q,$){return F.H.useCallback(Q,$)},Jt.useContext=function(Q){return F.H.useContext(Q)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(Q,$){return F.H.useDeferredValue(Q,$)},Jt.useEffect=function(Q,$){return F.H.useEffect(Q,$)},Jt.useEffectEvent=function(Q){return F.H.useEffectEvent(Q)},Jt.useId=function(){return F.H.useId()},Jt.useImperativeHandle=function(Q,$,pe){return F.H.useImperativeHandle(Q,$,pe)},Jt.useInsertionEffect=function(Q,$){return F.H.useInsertionEffect(Q,$)},Jt.useLayoutEffect=function(Q,$){return F.H.useLayoutEffect(Q,$)},Jt.useMemo=function(Q,$){return F.H.useMemo(Q,$)},Jt.useOptimistic=function(Q,$){return F.H.useOptimistic(Q,$)},Jt.useReducer=function(Q,$,pe){return F.H.useReducer(Q,$,pe)},Jt.useRef=function(Q){return F.H.useRef(Q)},Jt.useState=function(Q){return F.H.useState(Q)},Jt.useSyncExternalStore=function(Q,$,pe){return F.H.useSyncExternalStore(Q,$,pe)},Jt.useTransition=function(){return F.H.useTransition()},Jt.version="19.2.0",Jt}var g2;function sg(){return g2||(g2=1,o1.exports=kb()),o1.exports}var oe=sg();const Qe=Xd(oe);var l1={exports:{}},su={},c1={exports:{}},u1={};var m2;function Lb(){return m2||(m2=1,(function(s){function e(ue,Ee){var We=ue.length;ue.push(Ee);e:for(;0<We;){var qe=We-1>>>1,ot=ue[qe];if(0<u(ot,Ee))ue[qe]=Ee,ue[We]=ot,We=qe;else break e}}function t(ue){return ue.length===0?null:ue[0]}function o(ue){if(ue.length===0)return null;var Ee=ue[0],We=ue.pop();if(We!==Ee){ue[0]=We;e:for(var qe=0,ot=ue.length,Q=ot>>>1;qe<Q;){var $=2*(qe+1)-1,pe=ue[$],Te=$+1,nt=ue[Te];if(0>u(pe,We))Te<ot&&0>u(nt,pe)?(ue[qe]=nt,ue[Te]=We,qe=Te):(ue[qe]=pe,ue[$]=We,qe=$);else if(Te<ot&&0>u(nt,We))ue[qe]=nt,ue[Te]=We,qe=Te;else break e}}return Ee}function u(ue,Ee){var We=ue.sortIndex-Ee.sortIndex;return We!==0?We:ue.id-Ee.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var g=performance;s.unstable_now=function(){return g.now()}}else{var x=Date,T=x.now();s.unstable_now=function(){return x.now()-T}}var b=[],w=[],C=1,R=null,P=3,L=!1,ee=!1,re=!1,se=!1,Ye=typeof setTimeout=="function"?setTimeout:null,Oe=typeof clearTimeout=="function"?clearTimeout:null,le=typeof setImmediate<"u"?setImmediate:null;function Ue(ue){for(var Ee=t(w);Ee!==null;){if(Ee.callback===null)o(w);else if(Ee.startTime<=ue)o(w),Ee.sortIndex=Ee.expirationTime,e(b,Ee);else break;Ee=t(w)}}function dt(ue){if(re=!1,Ue(ue),!ee)if(t(b)!==null)ee=!0,Ze||(Ze=!0,Y());else{var Ee=t(w);Ee!==null&&ce(dt,Ee.startTime-ue)}}var Ze=!1,F=-1,z=5,U=-1;function J(){return se?!0:!(s.unstable_now()-U<z)}function X(){if(se=!1,Ze){var ue=s.unstable_now();U=ue;var Ee=!0;try{e:{ee=!1,re&&(re=!1,Oe(F),F=-1),L=!0;var We=P;try{t:{for(Ue(ue),R=t(b);R!==null&&!(R.expirationTime>ue&&J());){var qe=R.callback;if(typeof qe=="function"){R.callback=null,P=R.priorityLevel;var ot=qe(R.expirationTime<=ue);if(ue=s.unstable_now(),typeof ot=="function"){R.callback=ot,Ue(ue),Ee=!0;break t}R===t(b)&&o(b),Ue(ue)}else o(b);R=t(b)}if(R!==null)Ee=!0;else{var Q=t(w);Q!==null&&ce(dt,Q.startTime-ue),Ee=!1}}break e}finally{R=null,P=We,L=!1}Ee=void 0}}finally{Ee?Y():Ze=!1}}}var Y;if(typeof le=="function")Y=function(){le(X)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,at=G.port2;G.port1.onmessage=X,Y=function(){at.postMessage(null)}}else Y=function(){Ye(X,0)};function ce(ue,Ee){F=Ye(function(){ue(s.unstable_now())},Ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(ue){ue.callback=null},s.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<ue?Math.floor(1e3/ue):5},s.unstable_getCurrentPriorityLevel=function(){return P},s.unstable_next=function(ue){switch(P){case 1:case 2:case 3:var Ee=3;break;default:Ee=P}var We=P;P=Ee;try{return ue()}finally{P=We}},s.unstable_requestPaint=function(){se=!0},s.unstable_runWithPriority=function(ue,Ee){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var We=P;P=ue;try{return Ee()}finally{P=We}},s.unstable_scheduleCallback=function(ue,Ee,We){var qe=s.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?qe+We:qe):We=qe,ue){case 1:var ot=-1;break;case 2:ot=250;break;case 5:ot=1073741823;break;case 4:ot=1e4;break;default:ot=5e3}return ot=We+ot,ue={id:C++,callback:Ee,priorityLevel:ue,startTime:We,expirationTime:ot,sortIndex:-1},We>qe?(ue.sortIndex=We,e(w,ue),t(b)===null&&ue===t(w)&&(re?(Oe(F),F=-1):re=!0,ce(dt,We-qe))):(ue.sortIndex=ot,e(b,ue),ee||L||(ee=!0,Ze||(Ze=!0,Y()))),ue},s.unstable_shouldYield=J,s.unstable_wrapCallback=function(ue){var Ee=P;return function(){var We=P;P=Ee;try{return ue.apply(this,arguments)}finally{P=We}}}})(u1)),u1}var p2;function Pb(){return p2||(p2=1,c1.exports=Lb()),c1.exports}var h1={exports:{}},Ei={};var y2;function Bb(){if(y2)return Ei;y2=1;var s=sg();function e(b){var w="https://react.dev/errors/"+b;if(1<arguments.length){w+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)w+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+b+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var o={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},u=Symbol.for("react.portal");function g(b,w,C){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:R==null?null:""+R,children:b,containerInfo:w,implementation:C}}var x=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function T(b,w){if(b==="font")return"";if(typeof w=="string")return w==="use-credentials"?w:""}return Ei.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Ei.createPortal=function(b,w){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w||w.nodeType!==1&&w.nodeType!==9&&w.nodeType!==11)throw Error(e(299));return g(b,w,null,C)},Ei.flushSync=function(b){var w=x.T,C=o.p;try{if(x.T=null,o.p=2,b)return b()}finally{x.T=w,o.p=C,o.d.f()}},Ei.preconnect=function(b,w){typeof b=="string"&&(w?(w=w.crossOrigin,w=typeof w=="string"?w==="use-credentials"?w:"":void 0):w=null,o.d.C(b,w))},Ei.prefetchDNS=function(b){typeof b=="string"&&o.d.D(b)},Ei.preinit=function(b,w){if(typeof b=="string"&&w&&typeof w.as=="string"){var C=w.as,R=T(C,w.crossOrigin),P=typeof w.integrity=="string"?w.integrity:void 0,L=typeof w.fetchPriority=="string"?w.fetchPriority:void 0;C==="style"?o.d.S(b,typeof w.precedence=="string"?w.precedence:void 0,{crossOrigin:R,integrity:P,fetchPriority:L}):C==="script"&&o.d.X(b,{crossOrigin:R,integrity:P,fetchPriority:L,nonce:typeof w.nonce=="string"?w.nonce:void 0})}},Ei.preinitModule=function(b,w){if(typeof b=="string")if(typeof w=="object"&&w!==null){if(w.as==null||w.as==="script"){var C=T(w.as,w.crossOrigin);o.d.M(b,{crossOrigin:C,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0})}}else w==null&&o.d.M(b)},Ei.preload=function(b,w){if(typeof b=="string"&&typeof w=="object"&&w!==null&&typeof w.as=="string"){var C=w.as,R=T(C,w.crossOrigin);o.d.L(b,C,{crossOrigin:R,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0,type:typeof w.type=="string"?w.type:void 0,fetchPriority:typeof w.fetchPriority=="string"?w.fetchPriority:void 0,referrerPolicy:typeof w.referrerPolicy=="string"?w.referrerPolicy:void 0,imageSrcSet:typeof w.imageSrcSet=="string"?w.imageSrcSet:void 0,imageSizes:typeof w.imageSizes=="string"?w.imageSizes:void 0,media:typeof w.media=="string"?w.media:void 0})}},Ei.preloadModule=function(b,w){if(typeof b=="string")if(w){var C=T(w.as,w.crossOrigin);o.d.m(b,{as:typeof w.as=="string"&&w.as!=="script"?w.as:void 0,crossOrigin:C,integrity:typeof w.integrity=="string"?w.integrity:void 0})}else o.d.m(b)},Ei.requestFormReset=function(b){o.d.r(b)},Ei.unstable_batchedUpdates=function(b,w){return b(w)},Ei.useFormState=function(b,w,C){return x.H.useFormState(b,w,C)},Ei.useFormStatus=function(){return x.H.useHostTransitionStatus()},Ei.version="19.2.0",Ei}var x2;function AE(){if(x2)return h1.exports;x2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),h1.exports=Bb(),h1.exports}var E2;function Vb(){if(E2)return su;E2=1;var s=Pb(),e=sg(),t=AE();function o(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function g(n){var i=n,c=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(c=i.return),n=i.return;while(n)}return i.tag===3?c:null}function x(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function T(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function b(n){if(g(n)!==n)throw Error(o(188))}function w(n){var i=n.alternate;if(!i){if(i=g(n),i===null)throw Error(o(188));return i!==n?null:n}for(var c=n,f=i;;){var E=c.return;if(E===null)break;var A=E.alternate;if(A===null){if(f=E.return,f!==null){c=f;continue}break}if(E.child===A.child){for(A=E.child;A;){if(A===c)return b(E),n;if(A===f)return b(E),i;A=A.sibling}throw Error(o(188))}if(c.return!==f.return)c=E,f=A;else{for(var O=!1,V=E.child;V;){if(V===c){O=!0,c=E,f=A;break}if(V===f){O=!0,f=E,c=A;break}V=V.sibling}if(!O){for(V=A.child;V;){if(V===c){O=!0,c=A,f=E;break}if(V===f){O=!0,f=A,c=E;break}V=V.sibling}if(!O)throw Error(o(189))}}if(c.alternate!==f)throw Error(o(190))}if(c.tag!==3)throw Error(o(188));return c.stateNode.current===c?n:i}function C(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=C(n),i!==null)return i;n=n.sibling}return null}var R=Object.assign,P=Symbol.for("react.element"),L=Symbol.for("react.transitional.element"),ee=Symbol.for("react.portal"),re=Symbol.for("react.fragment"),se=Symbol.for("react.strict_mode"),Ye=Symbol.for("react.profiler"),Oe=Symbol.for("react.consumer"),le=Symbol.for("react.context"),Ue=Symbol.for("react.forward_ref"),dt=Symbol.for("react.suspense"),Ze=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function Y(n){return n===null||typeof n!="object"?null:(n=X&&n[X]||n["@@iterator"],typeof n=="function"?n:null)}var G=Symbol.for("react.client.reference");function at(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===G?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case re:return"Fragment";case Ye:return"Profiler";case se:return"StrictMode";case dt:return"Suspense";case Ze:return"SuspenseList";case U:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case ee:return"Portal";case le:return n.displayName||"Context";case Oe:return(n._context.displayName||"Context")+".Consumer";case Ue:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case F:return i=n.displayName||null,i!==null?i:at(n.type)||"Memo";case z:i=n._payload,n=n._init;try{return at(n(i))}catch{}}return null}var ce=Array.isArray,ue=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,We={pending:!1,data:null,method:null,action:null},qe=[],ot=-1;function Q(n){return{current:n}}function $(n){0>ot||(n.current=qe[ot],qe[ot]=null,ot--)}function pe(n,i){ot++,qe[ot]=n.current,n.current=i}var Te=Q(null),nt=Q(null),ve=Q(null),st=Q(null);function xt(n,i){switch(pe(ve,i),pe(nt,n),pe(Te,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?ky(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=ky(i),n=Ly(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}$(Te),pe(Te,n)}function kt(){$(Te),$(nt),$(ve)}function cn(n){n.memoizedState!==null&&pe(st,n);var i=Te.current,c=Ly(i,n.type);i!==c&&(pe(nt,n),pe(Te,c))}function en(n){nt.current===n&&($(Te),$(nt)),st.current===n&&($(st),eu._currentValue=We)}var En,Lt;function hn(n){if(En===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);En=i&&i[1]||"",Lt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+En+n+Lt}var wn=!1;function De(n,i){if(!n||wn)return"";wn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var Be=function(){throw Error()};if(Object.defineProperty(Be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Be,[])}catch(Ce){var xe=Ce}Reflect.construct(n,[],Be)}else{try{Be.call()}catch(Ce){xe=Ce}n.call(Be.prototype)}}else{try{throw Error()}catch(Ce){xe=Ce}(Be=n())&&typeof Be.catch=="function"&&Be.catch(function(){})}}catch(Ce){if(Ce&&xe&&typeof Ce.stack=="string")return[Ce.stack,xe.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=f.DetermineComponentFrameRoot(),O=A[0],V=A[1];if(O&&V){var W=O.split(`
`),ye=V.split(`
`);for(E=f=0;f<W.length&&!W[f].includes("DetermineComponentFrameRoot");)f++;for(;E<ye.length&&!ye[E].includes("DetermineComponentFrameRoot");)E++;if(f===W.length||E===ye.length)for(f=W.length-1,E=ye.length-1;1<=f&&0<=E&&W[f]!==ye[E];)E--;for(;1<=f&&0<=E;f--,E--)if(W[f]!==ye[E]){if(f!==1||E!==1)do if(f--,E--,0>E||W[f]!==ye[E]){var Ne=`
`+W[f].replace(" at new "," at ");return n.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",n.displayName)),Ne}while(1<=f&&0<=E);break}}}finally{wn=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?hn(c):""}function ge(n,i){switch(n.tag){case 26:case 27:case 5:return hn(n.type);case 16:return hn("Lazy");case 13:return n.child!==i&&i!==null?hn("Suspense Fallback"):hn("Suspense");case 19:return hn("SuspenseList");case 0:case 15:return De(n.type,!1);case 11:return De(n.type.render,!1);case 1:return De(n.type,!0);case 31:return hn("Activity");default:return""}}function Re(n){try{var i="",c=null;do i+=ge(n,c),c=n,n=n.return;while(n);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Fe=Object.prototype.hasOwnProperty,ke=s.unstable_scheduleCallback,be=s.unstable_cancelCallback,Pt=s.unstable_shouldYield,vt=s.unstable_requestPaint,Rt=s.unstable_now,Fn=s.unstable_getCurrentPriorityLevel,Xt=s.unstable_ImmediatePriority,yr=s.unstable_UserBlockingPriority,xr=s.unstable_NormalPriority,or=s.unstable_LowPriority,Zr=s.unstable_IdlePriority,Ti=s.log,ki=s.unstable_setDisableYieldValue,tn=null,ze=null;function zt(n){if(typeof Ti=="function"&&ki(n),ze&&typeof ze.setStrictMode=="function")try{ze.setStrictMode(tn,n)}catch{}}var wt=Math.clz32?Math.clz32:Xr,_n=Math.log,vr=Math.LN2;function Xr(n){return n>>>=0,n===0?32:31-(_n(n)/vr|0)|0}var Tr=256,Bt=262144,Qt=4194304;function jn(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Mr(n,i,c){var f=n.pendingLanes;if(f===0)return 0;var E=0,A=n.suspendedLanes,O=n.pingedLanes;n=n.warmLanes;var V=f&134217727;return V!==0?(f=V&~A,f!==0?E=jn(f):(O&=V,O!==0?E=jn(O):c||(c=V&~n,c!==0&&(E=jn(c))))):(V=f&~A,V!==0?E=jn(V):O!==0?E=jn(O):c||(c=f&~n,c!==0&&(E=jn(c)))),E===0?0:i!==0&&i!==E&&(i&A)===0&&(A=E&-E,c=i&-i,A>=c||A===32&&(c&4194048)!==0)?i:E}function ut(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function nn(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ie(){var n=Qt;return Qt<<=1,(Qt&62914560)===0&&(Qt=4194304),n}function Ie(n){for(var i=[],c=0;31>c;c++)i.push(n);return i}function He(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Xe(n,i,c,f,E,A){var O=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var V=n.entanglements,W=n.expirationTimes,ye=n.hiddenUpdates;for(c=O&~c;0<c;){var Ne=31-wt(c),Be=1<<Ne;V[Ne]=0,W[Ne]=-1;var xe=ye[Ne];if(xe!==null)for(ye[Ne]=null,Ne=0;Ne<xe.length;Ne++){var Ce=xe[Ne];Ce!==null&&(Ce.lane&=-536870913)}c&=~Be}f!==0&&rt(n,f,0),A!==0&&E===0&&n.tag!==0&&(n.suspendedLanes|=A&~(O&~i))}function rt(n,i,c){n.pendingLanes|=i,n.suspendedLanes&=~i;var f=31-wt(i);n.entangledLanes|=i,n.entanglements[f]=n.entanglements[f]|1073741824|c&261930}function ft(n,i){var c=n.entangledLanes|=i;for(n=n.entanglements;c;){var f=31-wt(c),E=1<<f;E&i|n[f]&i&&(n[f]|=i),c&=~E}}function it(n,i){var c=i&-i;return c=(c&42)!==0?1:Ht(c),(c&(n.suspendedLanes|i))!==0?0:c}function Ht(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function St(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Vt(){var n=Ee.p;return n!==0?n:(n=window.event,n===void 0?32:i2(n.type))}function Me(n,i){var c=Ee.p;try{return Ee.p=n,i()}finally{Ee.p=c}}var sn=Math.random().toString(36).slice(2),gt="__reactFiber$"+sn,Ot="__reactProps$"+sn,$n="__reactContainer$"+sn,fi="__reactEvents$"+sn,Ps="__reactListeners$"+sn,ri="__reactHandles$"+sn,Ha="__reactResources$"+sn,Li="__reactMarker$"+sn;function Yr(n){delete n[gt],delete n[Ot],delete n[fi],delete n[Ps],delete n[ri]}function Wn(n){var i=n[gt];if(i)return i;for(var c=n.parentNode;c;){if(i=c[$n]||c[gt]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(n=zy(n);n!==null;){if(c=n[gt])return c;n=zy(n)}return i}n=c,c=n.parentNode}return null}function un(n){if(n=n[gt]||n[$n]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function Jr(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(o(33))}function kr(n){var i=n[Ha];return i||(i=n[Ha]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function sr(n){n[Li]=!0}var Ve=new Set,K={};function Se(n,i){$e(n,i),$e(n+"Capture",i)}function $e(n,i){for(K[n]=i,n=0;n<i.length;n++)Ve.add(i[n])}var mt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tt={},lt={};function ht(n){return Fe.call(lt,n)?!0:Fe.call(tt,n)?!1:mt.test(n)?lt[n]=!0:(tt[n]=!0,!1)}function dn(n,i,c){if(ht(i))if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+c)}}function fn(n,i,c){if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+c)}}function Rn(n,i,c,f){if(f===null)n.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(i,c,""+f)}}function Ft(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function kn(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Pi(n,i,c){var f=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,A=f.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return E.call(this)},set:function(O){c=""+O,A.call(this,O)}}),Object.defineProperty(n,i,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(O){c=""+O},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function It(n){if(!n._valueTracker){var i=kn(n)?"checked":"value";n._valueTracker=Pi(n,i,""+n[i])}}function er(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var c=i.getValue(),f="";return n&&(f=kn(n)?n.checked?"true":"false":n.value),n=f,n!==c?(i.setValue(n),!0):!1}function Cr(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var gi=/[\n"\\]/g;function an(n){return n.replace(gi,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Er(n,i,c,f,E,A,O,V){n.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.type=O:n.removeAttribute("type"),i!=null?O==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Ft(i)):n.value!==""+Ft(i)&&(n.value=""+Ft(i)):O!=="submit"&&O!=="reset"||n.removeAttribute("value"),i!=null?H(n,O,Ft(i)):c!=null?H(n,O,Ft(c)):f!=null&&n.removeAttribute("value"),E==null&&A!=null&&(n.defaultChecked=!!A),E!=null&&(n.checked=E&&typeof E!="function"&&typeof E!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?n.name=""+Ft(V):n.removeAttribute("name")}function fe(n,i,c,f,E,A,O,V){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(n.type=A),i!=null||c!=null){if(!(A!=="submit"&&A!=="reset"||i!=null)){It(n);return}c=c!=null?""+Ft(c):"",i=i!=null?""+Ft(i):c,V||i===n.value||(n.value=i),n.defaultValue=i}f=f??E,f=typeof f!="function"&&typeof f!="symbol"&&!!f,n.checked=V?n.checked:!!f,n.defaultChecked=!!f,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(n.name=O),It(n)}function H(n,i,c){i==="number"&&Cr(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function _t(n,i,c,f){if(n=n.options,i){i={};for(var E=0;E<c.length;E++)i["$"+c[E]]=!0;for(c=0;c<n.length;c++)E=i.hasOwnProperty("$"+n[c].value),n[c].selected!==E&&(n[c].selected=E),E&&f&&(n[c].defaultSelected=!0)}else{for(c=""+Ft(c),i=null,E=0;E<n.length;E++){if(n[E].value===c){n[E].selected=!0,f&&(n[E].defaultSelected=!0);return}i!==null||n[E].disabled||(i=n[E])}i!==null&&(i.selected=!0)}}function wr(n,i,c){if(i!=null&&(i=""+Ft(i),i!==n.value&&(n.value=i),c==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=c!=null?""+Ft(c):""}function Lr(n,i,c,f){if(i==null){if(f!=null){if(c!=null)throw Error(o(92));if(ce(f)){if(1<f.length)throw Error(o(93));f=f[0]}c=f}c==null&&(c=""),i=c}c=Ft(i),n.defaultValue=c,f=n.textContent,f===c&&f!==""&&f!==null&&(n.value=f),It(n)}function mi(n,i){if(i){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=i;return}}n.textContent=i}var Ga=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $r(n,i,c){var f=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":f?n.setProperty(i,c):typeof c!="number"||c===0||Ga.has(i)?i==="float"?n.cssFloat=c:n[i]=(""+c).trim():n[i]=c+"px"}function Tt(n,i,c){if(i!=null&&typeof i!="object")throw Error(o(62));if(n=n.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?n.setProperty(f,""):f==="float"?n.cssFloat="":n[f]="");for(var E in i)f=i[E],i.hasOwnProperty(E)&&c[E]!==f&&$r(n,E,f)}else for(var A in i)i.hasOwnProperty(A)&&$r(n,A,i[A])}function zn(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vs(n){return Bs.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function pi(){}var ia=null;function Bi(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var tr=null,yi=null;function xi(n){var i=un(n);if(i&&(n=i.stateNode)){var c=n[Ot]||null;e:switch(n=i.stateNode,i.type){case"input":if(Er(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+an(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var f=c[i];if(f!==n&&f.form===n.form){var E=f[Ot]||null;if(!E)throw Error(o(90));Er(f,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(i=0;i<c.length;i++)f=c[i],f.form===n.form&&er(f)}break e;case"textarea":wr(n,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&_t(n,!!c.multiple,i,!1)}}}var Nt=!1;function Us(n,i,c){if(Nt)return n(i,c);Nt=!0;try{var f=n(i);return f}finally{if(Nt=!1,(tr!==null||yi!==null)&&(Oh(),tr&&(i=tr,n=yi,yi=tr=null,xi(i),n)))for(i=0;i<n.length;i++)xi(n[i])}}function Ut(n,i){var c=n.stateNode;if(c===null)return null;var f=c[Ot]||null;if(f===null)return null;c=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(o(231,i,typeof c));return c}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sa=!1;if(Hn)try{var Ln={};Object.defineProperty(Ln,"passive",{get:function(){sa=!0}}),window.addEventListener("test",Ln,Ln),window.removeEventListener("test",Ln,Ln)}catch{sa=!1}var Qi=null,Zi=null,aa=null;function Cs(){if(aa)return aa;var n,i=Zi,c=i.length,f,E="value"in Qi?Qi.value:Qi.textContent,A=E.length;for(n=0;n<c&&i[n]===E[n];n++);var O=c-n;for(f=1;f<=O&&i[c-f]===E[A-f];f++);return aa=E.slice(n,1<f?1-f:void 0)}function Ji(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Ci(){return!0}function Vi(){return!1}function _r(n){function i(c,f,E,A,O){this._reactName=c,this._targetInst=E,this.type=f,this.nativeEvent=A,this.target=O,this.currentTarget=null;for(var V in n)n.hasOwnProperty(V)&&(c=n[V],this[V]=c?c(A):A[V]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Ci:Vi,this.isPropagationStopped=Vi,this}return R(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),i}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lr=_r(Si),Ss=R({},Si,{view:0,detail:0}),qa=_r(Ss),Is,Xa,hs,Ya=R({},Ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fs,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==hs&&(hs&&n.type==="mousemove"?(Is=n.screenX-hs.screenX,Xa=n.screenY-hs.screenY):Xa=Is=0,hs=n),Is)},movementY:function(n){return"movementY"in n?n.movementY:Xa}}),Dn=_r(Ya),Fs=R({},Ya,{dataTransfer:0}),oa=_r(Fs),$i=R({},Ss,{relatedTarget:0}),la=_r($i),we=R({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),Zt=_r(we),fr=R({},Si,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),ca=_r(fr),Ho=R({},Si,{data:0}),ds=_r(Ho),Al={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ka={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gr(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Ka[n])?!!i[n]:!1}function fs(){return gr}var gn=R({},Ss,{key:function(n){if(n.key){var i=Al[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Ji(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?bl[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fs,charCode:function(n){return n.type==="keypress"?Ji(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ji(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ua=_r(gn),gs=R({},Ya,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mn=_r(gs),p=R({},Ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fs}),S=_r(p),D=R({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),j=_r(D),he=R({},Ya,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ae=_r(he),et=R({},Si,{newState:0,oldState:0}),Yt=_r(et),mr=[9,13,27,32],Nn=Hn&&"CompositionEvent"in window,nr=null;Hn&&"documentMode"in document&&(nr=document.documentMode);var Ii=Hn&&"TextEvent"in window&&!nr,ms=Hn&&(!Nn||nr&&8<nr&&11>=nr),ei=" ",Ri=!1;function ha(n,i){switch(n){case"keyup":return mr.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ps(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Wa=!1;function js(n,i){switch(n){case"compositionend":return ps(i);case"keypress":return i.which!==32?null:(Ri=!0,ei);case"textInput":return n=i.data,n===ei&&Ri?null:n;default:return null}}function vl(n,i){if(Wa)return n==="compositionend"||!Nn&&ha(n,i)?(n=Cs(),aa=Zi=Qi=null,Wa=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ms&&i.locale!=="ko"?null:i.data;default:return null}}var Ui={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vc(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Ui[n.type]:i==="textarea"}function es(n,i,c,f){tr?yi?yi.push(f):yi=[f]:tr=f,i=Vh(i,"onChange"),0<i.length&&(c=new lr("onChange","change",null,c,f),n.push({event:c,listeners:i}))}var Go=null,da=null;function Ef(n){Iy(n,0)}function qo(n){var i=Jr(n);if(er(i))return n}function ts(n,i){if(n==="change")return i}var Wu=!1;if(Hn){var Xo;if(Hn){var fa="oninput"in document;if(!fa){var An=document.createElement("div");An.setAttribute("oninput","return;"),fa=typeof An.oninput=="function"}Xo=fa}else Xo=!1;Wu=Xo&&(!document.documentMode||9<document.documentMode)}function Yo(){Go&&(Go.detachEvent("onpropertychange",M),da=Go=null)}function M(n){if(n.propertyName==="value"&&qo(da)){var i=[];es(i,da,n,Bi(n)),Us(Ef,i)}}function r(n,i,c){n==="focusin"?(Yo(),Go=i,da=c,Go.attachEvent("onpropertychange",M)):n==="focusout"&&Yo()}function a(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return qo(da)}function l(n,i){if(n==="click")return qo(i)}function h(n,i){if(n==="input"||n==="change")return qo(i)}function d(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var m=typeof Object.is=="function"?Object.is:d;function y(n,i){if(m(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var c=Object.keys(n),f=Object.keys(i);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var E=c[f];if(!Fe.call(i,E)||!m(n[E],i[E]))return!1}return!0}function _(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function v(n,i){var c=_(n);n=0;for(var f;c;){if(c.nodeType===3){if(f=n+c.textContent.length,n<=i&&f>=i)return{node:c,offset:i-n};n=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=_(c)}}function N(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?N(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function k(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Cr(n.document);i instanceof n.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)n=i.contentWindow;else break;i=Cr(n.document)}return i}function B(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var q=Hn&&"documentMode"in document&&11>=document.documentMode,Z=null,te=null,de=null,_e=!1;function Je(n,i,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;_e||Z==null||Z!==Cr(f)||(f=Z,"selectionStart"in f&&B(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),de&&y(de,f)||(de=f,f=Vh(te,"onSelect"),0<f.length&&(i=new lr("onSelect","select",null,i,c),n.push({event:i,listeners:f}),i.target=Z)))}function Ke(n,i){var c={};return c[n.toLowerCase()]=i.toLowerCase(),c["Webkit"+n]="webkit"+i,c["Moz"+n]="moz"+i,c}var Ge={animationend:Ke("Animation","AnimationEnd"),animationiteration:Ke("Animation","AnimationIteration"),animationstart:Ke("Animation","AnimationStart"),transitionrun:Ke("Transition","TransitionRun"),transitionstart:Ke("Transition","TransitionStart"),transitioncancel:Ke("Transition","TransitionCancel"),transitionend:Ke("Transition","TransitionEnd")},ln={},Kt={};Hn&&(Kt=document.createElement("div").style,"AnimationEvent"in window||(delete Ge.animationend.animation,delete Ge.animationiteration.animation,delete Ge.animationstart.animation),"TransitionEvent"in window||delete Ge.transitionend.transition);function Sr(n){if(ln[n])return ln[n];if(!Ge[n])return n;var i=Ge[n],c;for(c in i)if(i.hasOwnProperty(c)&&c in Kt)return ln[n]=i[c];return n}var Fi=Sr("animationend"),ii=Sr("animationiteration"),Gn=Sr("animationstart"),Kr=Sr("transitionrun"),Ni=Sr("transitionstart"),Qa=Sr("transitioncancel"),ga=Sr("transitionend"),Qu=new Map,Tc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tc.push("scrollEnd");function Rs(n,i){Qu.set(n,i),Se(i,[n])}var Zu=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},ys=[],Tl=0,wf=0;function Ju(){for(var n=Tl,i=wf=Tl=0;i<n;){var c=ys[i];ys[i++]=null;var f=ys[i];ys[i++]=null;var E=ys[i];ys[i++]=null;var A=ys[i];if(ys[i++]=null,f!==null&&E!==null){var O=f.pending;O===null?E.next=E:(E.next=O.next,O.next=E),f.pending=E}A!==0&&cm(c,E,A)}}function $u(n,i,c,f){ys[Tl++]=n,ys[Tl++]=i,ys[Tl++]=c,ys[Tl++]=f,wf|=f,n.lanes|=f,n=n.alternate,n!==null&&(n.lanes|=f)}function _f(n,i,c,f){return $u(n,i,c,f),eh(n)}function Ko(n,i){return $u(n,null,null,i),eh(n)}function cm(n,i,c){n.lanes|=c;var f=n.alternate;f!==null&&(f.lanes|=c);for(var E=!1,A=n.return;A!==null;)A.childLanes|=c,f=A.alternate,f!==null&&(f.childLanes|=c),A.tag===22&&(n=A.stateNode,n===null||n._visibility&1||(E=!0)),n=A,A=A.return;return n.tag===3?(A=n.stateNode,E&&i!==null&&(E=31-wt(c),n=A.hiddenUpdates,f=n[E],f===null?n[E]=[i]:f.push(i),i.lane=c|536870912),A):null}function eh(n){if(50<Yc)throw Yc=0,N0=null,Error(o(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Cl={};function gA(n,i,c,f){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ns(n,i,c,f){return new gA(n,i,c,f)}function Af(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ma(n,i){var c=n.alternate;return c===null?(c=ns(n.tag,i,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=i,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,i=n.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function um(n,i){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,i=c.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function th(n,i,c,f,E,A){var O=0;if(f=n,typeof n=="function")Af(n)&&(O=1);else if(typeof n=="string")O=Eb(n,c,Te.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case U:return n=ns(31,c,i,E),n.elementType=U,n.lanes=A,n;case re:return Wo(c.children,E,A,i);case se:O=8,E|=24;break;case Ye:return n=ns(12,c,i,E|2),n.elementType=Ye,n.lanes=A,n;case dt:return n=ns(13,c,i,E),n.elementType=dt,n.lanes=A,n;case Ze:return n=ns(19,c,i,E),n.elementType=Ze,n.lanes=A,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case le:O=10;break e;case Oe:O=9;break e;case Ue:O=11;break e;case F:O=14;break e;case z:O=16,f=null;break e}O=29,c=Error(o(130,n===null?"null":typeof n,"")),f=null}return i=ns(O,c,i,E),i.elementType=n,i.type=f,i.lanes=A,i}function Wo(n,i,c,f){return n=ns(7,n,f,i),n.lanes=c,n}function bf(n,i,c){return n=ns(6,n,null,i),n.lanes=c,n}function hm(n){var i=ns(18,null,null,0);return i.stateNode=n,i}function vf(n,i,c){return i=ns(4,n.children!==null?n.children:[],n.key,i),i.lanes=c,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var dm=new WeakMap;function xs(n,i){if(typeof n=="object"&&n!==null){var c=dm.get(n);return c!==void 0?c:(i={value:n,source:i,stack:Re(i)},dm.set(n,i),i)}return{value:n,source:i,stack:Re(i)}}var Sl=[],Il=0,nh=null,Cc=0,Es=[],ws=0,Za=null,zs=1,Hs="";function pa(n,i){Sl[Il++]=Cc,Sl[Il++]=nh,nh=n,Cc=i}function fm(n,i,c){Es[ws++]=zs,Es[ws++]=Hs,Es[ws++]=Za,Za=n;var f=zs;n=Hs;var E=32-wt(f)-1;f&=~(1<<E),c+=1;var A=32-wt(i)+E;if(30<A){var O=E-E%5;A=(f&(1<<O)-1).toString(32),f>>=O,E-=O,zs=1<<32-wt(i)+E|c<<E|f,Hs=A+n}else zs=1<<A|c<<E|f,Hs=n}function Tf(n){n.return!==null&&(pa(n,1),fm(n,1,0))}function Cf(n){for(;n===nh;)nh=Sl[--Il],Sl[Il]=null,Cc=Sl[--Il],Sl[Il]=null;for(;n===Za;)Za=Es[--ws],Es[ws]=null,Hs=Es[--ws],Es[ws]=null,zs=Es[--ws],Es[ws]=null}function gm(n,i){Es[ws++]=zs,Es[ws++]=Hs,Es[ws++]=Za,zs=i.id,Hs=i.overflow,Za=n}var si=null,cr=null,On=!1,Ja=null,_s=!1,Sf=Error(o(519));function $a(n){var i=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Sc(xs(i,n)),Sf}function mm(n){var i=n.stateNode,c=n.type,f=n.memoizedProps;switch(i[gt]=n,i[Ot]=f,c){case"dialog":yn("cancel",i),yn("close",i);break;case"iframe":case"object":case"embed":yn("load",i);break;case"video":case"audio":for(c=0;c<Wc.length;c++)yn(Wc[c],i);break;case"source":yn("error",i);break;case"img":case"image":case"link":yn("error",i),yn("load",i);break;case"details":yn("toggle",i);break;case"input":yn("invalid",i),fe(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":yn("invalid",i);break;case"textarea":yn("invalid",i),Lr(i,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||f.suppressHydrationWarning===!0||Dy(i.textContent,c)?(f.popover!=null&&(yn("beforetoggle",i),yn("toggle",i)),f.onScroll!=null&&yn("scroll",i),f.onScrollEnd!=null&&yn("scrollend",i),f.onClick!=null&&(i.onclick=pi),i=!0):i=!1,i||$a(n,!0)}function pm(n){for(si=n.return;si;)switch(si.tag){case 5:case 31:case 13:_s=!1;return;case 27:case 3:_s=!0;return;default:si=si.return}}function Rl(n){if(n!==si)return!1;if(!On)return pm(n),On=!0,!1;var i=n.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||q0(n.type,n.memoizedProps)),c=!c),c&&cr&&$a(n),pm(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(o(317));cr=jy(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(o(317));cr=jy(n)}else i===27?(i=cr,go(n.type)?(n=Q0,Q0=null,cr=n):cr=i):cr=si?bs(n.stateNode.nextSibling):null;return!0}function Qo(){cr=si=null,On=!1}function If(){var n=Ja;return n!==null&&(Gi===null?Gi=n:Gi.push.apply(Gi,n),Ja=null),n}function Sc(n){Ja===null?Ja=[n]:Ja.push(n)}var Rf=Q(null),Zo=null,ya=null;function eo(n,i,c){pe(Rf,i._currentValue),i._currentValue=c}function xa(n){n._currentValue=Rf.current,$(Rf)}function Nf(n,i,c){for(;n!==null;){var f=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),n===c)break;n=n.return}}function Of(n,i,c,f){var E=n.child;for(E!==null&&(E.return=n);E!==null;){var A=E.dependencies;if(A!==null){var O=E.child;A=A.firstContext;e:for(;A!==null;){var V=A;A=E;for(var W=0;W<i.length;W++)if(V.context===i[W]){A.lanes|=c,V=A.alternate,V!==null&&(V.lanes|=c),Nf(A.return,c,n),f||(O=null);break e}A=V.next}}else if(E.tag===18){if(O=E.return,O===null)throw Error(o(341));O.lanes|=c,A=O.alternate,A!==null&&(A.lanes|=c),Nf(O,c,n),O=null}else O=E.child;if(O!==null)O.return=E;else for(O=E;O!==null;){if(O===n){O=null;break}if(E=O.sibling,E!==null){E.return=O.return,O=E;break}O=O.return}E=O}}function Nl(n,i,c,f){n=null;for(var E=i,A=!1;E!==null;){if(!A){if((E.flags&524288)!==0)A=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var O=E.alternate;if(O===null)throw Error(o(387));if(O=O.memoizedProps,O!==null){var V=E.type;m(E.pendingProps.value,O.value)||(n!==null?n.push(V):n=[V])}}else if(E===st.current){if(O=E.alternate,O===null)throw Error(o(387));O.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(n!==null?n.push(eu):n=[eu])}E=E.return}n!==null&&Of(i,n,c,f),i.flags|=262144}function rh(n){for(n=n.firstContext;n!==null;){if(!m(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Jo(n){Zo=n,ya=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function ai(n){return ym(Zo,n)}function ih(n,i){return Zo===null&&Jo(n),ym(n,i)}function ym(n,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},ya===null){if(n===null)throw Error(o(308));ya=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else ya=ya.next=i;return c}var mA=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(c,f){n.push(f)}};this.abort=function(){i.aborted=!0,n.forEach(function(c){return c()})}},pA=s.unstable_scheduleCallback,yA=s.unstable_NormalPriority,Ur={$$typeof:le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Df(){return{controller:new mA,data:new Map,refCount:0}}function Ic(n){n.refCount--,n.refCount===0&&pA(yA,function(){n.controller.abort()})}var Rc=null,Mf=0,Ol=0,Dl=null;function xA(n,i){if(Rc===null){var c=Rc=[];Mf=0,Ol=P0(),Dl={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Mf++,i.then(xm,xm),i}function xm(){if(--Mf===0&&Rc!==null){Dl!==null&&(Dl.status="fulfilled");var n=Rc;Rc=null,Ol=0,Dl=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function EA(n,i){var c=[],f={status:"pending",value:null,reason:null,then:function(E){c.push(E)}};return n.then(function(){f.status="fulfilled",f.value=i;for(var E=0;E<c.length;E++)(0,c[E])(i)},function(E){for(f.status="rejected",f.reason=E,E=0;E<c.length;E++)(0,c[E])(void 0)}),f}var Em=ue.S;ue.S=function(n,i){ny=Rt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&xA(n,i),Em!==null&&Em(n,i)};var $o=Q(null);function kf(){var n=$o.current;return n!==null?n:rr.pooledCache}function sh(n,i){i===null?pe($o,$o.current):pe($o,i.pool)}function wm(){var n=kf();return n===null?null:{parent:Ur._currentValue,pool:n}}var Ml=Error(o(460)),Lf=Error(o(474)),ah=Error(o(542)),oh={then:function(){}};function _m(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Am(n,i,c){switch(c=n[c],c===void 0?n.push(i):c!==i&&(i.then(pi,pi),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,vm(n),n;default:if(typeof i.status=="string")i.then(pi,pi);else{if(n=rr,n!==null&&100<n.shellSuspendCounter)throw Error(o(482));n=i,n.status="pending",n.then(function(f){if(i.status==="pending"){var E=i;E.status="fulfilled",E.value=f}},function(f){if(i.status==="pending"){var E=i;E.status="rejected",E.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,vm(n),n}throw tl=i,Ml}}function el(n){try{var i=n._init;return i(n._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(tl=c,Ml):c}}var tl=null;function bm(){if(tl===null)throw Error(o(459));var n=tl;return tl=null,n}function vm(n){if(n===Ml||n===ah)throw Error(o(483))}var kl=null,Nc=0;function lh(n){var i=Nc;return Nc+=1,kl===null&&(kl=[]),Am(kl,n,i)}function Oc(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function ch(n,i){throw i.$$typeof===P?Error(o(525)):(n=Object.prototype.toString.call(i),Error(o(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Tm(n){function i(ae,ne){if(n){var me=ae.deletions;me===null?(ae.deletions=[ne],ae.flags|=16):me.push(ne)}}function c(ae,ne){if(!n)return null;for(;ne!==null;)i(ae,ne),ne=ne.sibling;return null}function f(ae){for(var ne=new Map;ae!==null;)ae.key!==null?ne.set(ae.key,ae):ne.set(ae.index,ae),ae=ae.sibling;return ne}function E(ae,ne){return ae=ma(ae,ne),ae.index=0,ae.sibling=null,ae}function A(ae,ne,me){return ae.index=me,n?(me=ae.alternate,me!==null?(me=me.index,me<ne?(ae.flags|=67108866,ne):me):(ae.flags|=67108866,ne)):(ae.flags|=1048576,ne)}function O(ae){return n&&ae.alternate===null&&(ae.flags|=67108866),ae}function V(ae,ne,me,Pe){return ne===null||ne.tag!==6?(ne=bf(me,ae.mode,Pe),ne.return=ae,ne):(ne=E(ne,me),ne.return=ae,ne)}function W(ae,ne,me,Pe){var Dt=me.type;return Dt===re?Ne(ae,ne,me.props.children,Pe,me.key):ne!==null&&(ne.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===z&&el(Dt)===ne.type)?(ne=E(ne,me.props),Oc(ne,me),ne.return=ae,ne):(ne=th(me.type,me.key,me.props,null,ae.mode,Pe),Oc(ne,me),ne.return=ae,ne)}function ye(ae,ne,me,Pe){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==me.containerInfo||ne.stateNode.implementation!==me.implementation?(ne=vf(me,ae.mode,Pe),ne.return=ae,ne):(ne=E(ne,me.children||[]),ne.return=ae,ne)}function Ne(ae,ne,me,Pe,Dt){return ne===null||ne.tag!==7?(ne=Wo(me,ae.mode,Pe,Dt),ne.return=ae,ne):(ne=E(ne,me),ne.return=ae,ne)}function Be(ae,ne,me){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=bf(""+ne,ae.mode,me),ne.return=ae,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case L:return me=th(ne.type,ne.key,ne.props,null,ae.mode,me),Oc(me,ne),me.return=ae,me;case ee:return ne=vf(ne,ae.mode,me),ne.return=ae,ne;case z:return ne=el(ne),Be(ae,ne,me)}if(ce(ne)||Y(ne))return ne=Wo(ne,ae.mode,me,null),ne.return=ae,ne;if(typeof ne.then=="function")return Be(ae,lh(ne),me);if(ne.$$typeof===le)return Be(ae,ih(ae,ne),me);ch(ae,ne)}return null}function xe(ae,ne,me,Pe){var Dt=ne!==null?ne.key:null;if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Dt!==null?null:V(ae,ne,""+me,Pe);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case L:return me.key===Dt?W(ae,ne,me,Pe):null;case ee:return me.key===Dt?ye(ae,ne,me,Pe):null;case z:return me=el(me),xe(ae,ne,me,Pe)}if(ce(me)||Y(me))return Dt!==null?null:Ne(ae,ne,me,Pe,null);if(typeof me.then=="function")return xe(ae,ne,lh(me),Pe);if(me.$$typeof===le)return xe(ae,ne,ih(ae,me),Pe);ch(ae,me)}return null}function Ce(ae,ne,me,Pe,Dt){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return ae=ae.get(me)||null,V(ne,ae,""+Pe,Dt);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case L:return ae=ae.get(Pe.key===null?me:Pe.key)||null,W(ne,ae,Pe,Dt);case ee:return ae=ae.get(Pe.key===null?me:Pe.key)||null,ye(ne,ae,Pe,Dt);case z:return Pe=el(Pe),Ce(ae,ne,me,Pe,Dt)}if(ce(Pe)||Y(Pe))return ae=ae.get(me)||null,Ne(ne,ae,Pe,Dt,null);if(typeof Pe.then=="function")return Ce(ae,ne,me,lh(Pe),Dt);if(Pe.$$typeof===le)return Ce(ae,ne,me,ih(ne,Pe),Dt);ch(ne,Pe)}return null}function At(ae,ne,me,Pe){for(var Dt=null,Pn=null,bt=ne,on=ne=0,vn=null;bt!==null&&on<me.length;on++){bt.index>on?(vn=bt,bt=null):vn=bt.sibling;var Bn=xe(ae,bt,me[on],Pe);if(Bn===null){bt===null&&(bt=vn);break}n&&bt&&Bn.alternate===null&&i(ae,bt),ne=A(Bn,ne,on),Pn===null?Dt=Bn:Pn.sibling=Bn,Pn=Bn,bt=vn}if(on===me.length)return c(ae,bt),On&&pa(ae,on),Dt;if(bt===null){for(;on<me.length;on++)bt=Be(ae,me[on],Pe),bt!==null&&(ne=A(bt,ne,on),Pn===null?Dt=bt:Pn.sibling=bt,Pn=bt);return On&&pa(ae,on),Dt}for(bt=f(bt);on<me.length;on++)vn=Ce(bt,ae,on,me[on],Pe),vn!==null&&(n&&vn.alternate!==null&&bt.delete(vn.key===null?on:vn.key),ne=A(vn,ne,on),Pn===null?Dt=vn:Pn.sibling=vn,Pn=vn);return n&&bt.forEach(function(Eo){return i(ae,Eo)}),On&&pa(ae,on),Dt}function jt(ae,ne,me,Pe){if(me==null)throw Error(o(151));for(var Dt=null,Pn=null,bt=ne,on=ne=0,vn=null,Bn=me.next();bt!==null&&!Bn.done;on++,Bn=me.next()){bt.index>on?(vn=bt,bt=null):vn=bt.sibling;var Eo=xe(ae,bt,Bn.value,Pe);if(Eo===null){bt===null&&(bt=vn);break}n&&bt&&Eo.alternate===null&&i(ae,bt),ne=A(Eo,ne,on),Pn===null?Dt=Eo:Pn.sibling=Eo,Pn=Eo,bt=vn}if(Bn.done)return c(ae,bt),On&&pa(ae,on),Dt;if(bt===null){for(;!Bn.done;on++,Bn=me.next())Bn=Be(ae,Bn.value,Pe),Bn!==null&&(ne=A(Bn,ne,on),Pn===null?Dt=Bn:Pn.sibling=Bn,Pn=Bn);return On&&pa(ae,on),Dt}for(bt=f(bt);!Bn.done;on++,Bn=me.next())Bn=Ce(bt,ae,on,Bn.value,Pe),Bn!==null&&(n&&Bn.alternate!==null&&bt.delete(Bn.key===null?on:Bn.key),ne=A(Bn,ne,on),Pn===null?Dt=Bn:Pn.sibling=Bn,Pn=Bn);return n&&bt.forEach(function(Nb){return i(ae,Nb)}),On&&pa(ae,on),Dt}function Jn(ae,ne,me,Pe){if(typeof me=="object"&&me!==null&&me.type===re&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case L:e:{for(var Dt=me.key;ne!==null;){if(ne.key===Dt){if(Dt=me.type,Dt===re){if(ne.tag===7){c(ae,ne.sibling),Pe=E(ne,me.props.children),Pe.return=ae,ae=Pe;break e}}else if(ne.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===z&&el(Dt)===ne.type){c(ae,ne.sibling),Pe=E(ne,me.props),Oc(Pe,me),Pe.return=ae,ae=Pe;break e}c(ae,ne);break}else i(ae,ne);ne=ne.sibling}me.type===re?(Pe=Wo(me.props.children,ae.mode,Pe,me.key),Pe.return=ae,ae=Pe):(Pe=th(me.type,me.key,me.props,null,ae.mode,Pe),Oc(Pe,me),Pe.return=ae,ae=Pe)}return O(ae);case ee:e:{for(Dt=me.key;ne!==null;){if(ne.key===Dt)if(ne.tag===4&&ne.stateNode.containerInfo===me.containerInfo&&ne.stateNode.implementation===me.implementation){c(ae,ne.sibling),Pe=E(ne,me.children||[]),Pe.return=ae,ae=Pe;break e}else{c(ae,ne);break}else i(ae,ne);ne=ne.sibling}Pe=vf(me,ae.mode,Pe),Pe.return=ae,ae=Pe}return O(ae);case z:return me=el(me),Jn(ae,ne,me,Pe)}if(ce(me))return At(ae,ne,me,Pe);if(Y(me)){if(Dt=Y(me),typeof Dt!="function")throw Error(o(150));return me=Dt.call(me),jt(ae,ne,me,Pe)}if(typeof me.then=="function")return Jn(ae,ne,lh(me),Pe);if(me.$$typeof===le)return Jn(ae,ne,ih(ae,me),Pe);ch(ae,me)}return typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint"?(me=""+me,ne!==null&&ne.tag===6?(c(ae,ne.sibling),Pe=E(ne,me),Pe.return=ae,ae=Pe):(c(ae,ne),Pe=bf(me,ae.mode,Pe),Pe.return=ae,ae=Pe),O(ae)):c(ae,ne)}return function(ae,ne,me,Pe){try{Nc=0;var Dt=Jn(ae,ne,me,Pe);return kl=null,Dt}catch(bt){if(bt===Ml||bt===ah)throw bt;var Pn=ns(29,bt,null,ae.mode);return Pn.lanes=Pe,Pn.return=ae,Pn}finally{}}}var nl=Tm(!0),Cm=Tm(!1),to=!1;function Pf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Bf(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function no(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ro(n,i,c){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,(Un&2)!==0){var E=f.pending;return E===null?i.next=i:(i.next=E.next,E.next=i),f.pending=i,i=eh(n),cm(n,null,c),i}return $u(n,f,i,c),eh(n)}function Dc(n,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var f=i.lanes;f&=n.pendingLanes,c|=f,i.lanes=c,ft(n,c)}}function Vf(n,i){var c=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var E=null,A=null;if(c=c.firstBaseUpdate,c!==null){do{var O={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};A===null?E=A=O:A=A.next=O,c=c.next}while(c!==null);A===null?E=A=i:A=A.next=i}else E=A=i;c={baseState:f.baseState,firstBaseUpdate:E,lastBaseUpdate:A,shared:f.shared,callbacks:f.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=i:n.next=i,c.lastBaseUpdate=i}var Uf=!1;function Mc(){if(Uf){var n=Dl;if(n!==null)throw n}}function kc(n,i,c,f){Uf=!1;var E=n.updateQueue;to=!1;var A=E.firstBaseUpdate,O=E.lastBaseUpdate,V=E.shared.pending;if(V!==null){E.shared.pending=null;var W=V,ye=W.next;W.next=null,O===null?A=ye:O.next=ye,O=W;var Ne=n.alternate;Ne!==null&&(Ne=Ne.updateQueue,V=Ne.lastBaseUpdate,V!==O&&(V===null?Ne.firstBaseUpdate=ye:V.next=ye,Ne.lastBaseUpdate=W))}if(A!==null){var Be=E.baseState;O=0,Ne=ye=W=null,V=A;do{var xe=V.lane&-536870913,Ce=xe!==V.lane;if(Ce?(bn&xe)===xe:(f&xe)===xe){xe!==0&&xe===Ol&&(Uf=!0),Ne!==null&&(Ne=Ne.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var At=n,jt=V;xe=i;var Jn=c;switch(jt.tag){case 1:if(At=jt.payload,typeof At=="function"){Be=At.call(Jn,Be,xe);break e}Be=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=jt.payload,xe=typeof At=="function"?At.call(Jn,Be,xe):At,xe==null)break e;Be=R({},Be,xe);break e;case 2:to=!0}}xe=V.callback,xe!==null&&(n.flags|=64,Ce&&(n.flags|=8192),Ce=E.callbacks,Ce===null?E.callbacks=[xe]:Ce.push(xe))}else Ce={lane:xe,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Ne===null?(ye=Ne=Ce,W=Be):Ne=Ne.next=Ce,O|=xe;if(V=V.next,V===null){if(V=E.shared.pending,V===null)break;Ce=V,V=Ce.next,Ce.next=null,E.lastBaseUpdate=Ce,E.shared.pending=null}}while(!0);Ne===null&&(W=Be),E.baseState=W,E.firstBaseUpdate=ye,E.lastBaseUpdate=Ne,A===null&&(E.shared.lanes=0),lo|=O,n.lanes=O,n.memoizedState=Be}}function Sm(n,i){if(typeof n!="function")throw Error(o(191,n));n.call(i)}function Im(n,i){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)Sm(c[n],i)}var Ll=Q(null),uh=Q(0);function Rm(n,i){n=Sa,pe(uh,n),pe(Ll,i),Sa=n|i.baseLanes}function Ff(){pe(uh,Sa),pe(Ll,Ll.current)}function jf(){Sa=uh.current,$(Ll),$(uh)}var rs=Q(null),As=null;function io(n){var i=n.alternate;pe(Pr,Pr.current&1),pe(rs,n),As===null&&(i===null||Ll.current!==null||i.memoizedState!==null)&&(As=n)}function zf(n){pe(Pr,Pr.current),pe(rs,n),As===null&&(As=n)}function Nm(n){n.tag===22?(pe(Pr,Pr.current),pe(rs,n),As===null&&(As=n)):so()}function so(){pe(Pr,Pr.current),pe(rs,rs.current)}function is(n){$(rs),As===n&&(As=null),$(Pr)}var Pr=Q(0);function hh(n){for(var i=n;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||K0(c)||W0(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ea=0,rn=null,Qn=null,Fr=null,dh=!1,Pl=!1,rl=!1,fh=0,Lc=0,Bl=null,wA=0;function Ir(){throw Error(o(321))}function Hf(n,i){if(i===null)return!1;for(var c=0;c<i.length&&c<n.length;c++)if(!m(n[c],i[c]))return!1;return!0}function Gf(n,i,c,f,E,A){return Ea=A,rn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ue.H=n===null||n.memoizedState===null?fp:s0,rl=!1,A=c(f,E),rl=!1,Pl&&(A=Dm(i,c,f,E)),Om(n),A}function Om(n){ue.H=Vc;var i=Qn!==null&&Qn.next!==null;if(Ea=0,Fr=Qn=rn=null,dh=!1,Lc=0,Bl=null,i)throw Error(o(300));n===null||jr||(n=n.dependencies,n!==null&&rh(n)&&(jr=!0))}function Dm(n,i,c,f){rn=n;var E=0;do{if(Pl&&(Bl=null),Lc=0,Pl=!1,25<=E)throw Error(o(301));if(E+=1,Fr=Qn=null,n.updateQueue!=null){var A=n.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}ue.H=gp,A=i(c,f)}while(Pl);return A}function _A(){var n=ue.H,i=n.useState()[0];return i=typeof i.then=="function"?Pc(i):i,n=n.useState()[0],(Qn!==null?Qn.memoizedState:null)!==n&&(rn.flags|=1024),i}function qf(){var n=fh!==0;return fh=0,n}function Xf(n,i,c){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~c}function Yf(n){if(dh){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}dh=!1}Ea=0,Fr=Qn=rn=null,Pl=!1,Lc=fh=0,Bl=null}function Oi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fr===null?rn.memoizedState=Fr=n:Fr=Fr.next=n,Fr}function Br(){if(Qn===null){var n=rn.alternate;n=n!==null?n.memoizedState:null}else n=Qn.next;var i=Fr===null?rn.memoizedState:Fr.next;if(i!==null)Fr=i,Qn=n;else{if(n===null)throw rn.alternate===null?Error(o(467)):Error(o(310));Qn=n,n={memoizedState:Qn.memoizedState,baseState:Qn.baseState,baseQueue:Qn.baseQueue,queue:Qn.queue,next:null},Fr===null?rn.memoizedState=Fr=n:Fr=Fr.next=n}return Fr}function gh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pc(n){var i=Lc;return Lc+=1,Bl===null&&(Bl=[]),n=Am(Bl,n,i),i=rn,(Fr===null?i.memoizedState:Fr.next)===null&&(i=i.alternate,ue.H=i===null||i.memoizedState===null?fp:s0),n}function mh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Pc(n);if(n.$$typeof===le)return ai(n)}throw Error(o(438,String(n)))}function Kf(n){var i=null,c=rn.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var f=rn.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(E){return E.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=gh(),rn.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(n),f=0;f<n;f++)c[f]=J;return i.index++,c}function wa(n,i){return typeof i=="function"?i(n):i}function ph(n){var i=Br();return Wf(i,Qn,n)}function Wf(n,i,c){var f=n.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=c;var E=n.baseQueue,A=f.pending;if(A!==null){if(E!==null){var O=E.next;E.next=A.next,A.next=O}i.baseQueue=E=A,f.pending=null}if(A=n.baseState,E===null)n.memoizedState=A;else{i=E.next;var V=O=null,W=null,ye=i,Ne=!1;do{var Be=ye.lane&-536870913;if(Be!==ye.lane?(bn&Be)===Be:(Ea&Be)===Be){var xe=ye.revertLane;if(xe===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null}),Be===Ol&&(Ne=!0);else if((Ea&xe)===xe){ye=ye.next,xe===Ol&&(Ne=!0);continue}else Be={lane:0,revertLane:ye.revertLane,gesture:null,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},W===null?(V=W=Be,O=A):W=W.next=Be,rn.lanes|=xe,lo|=xe;Be=ye.action,rl&&c(A,Be),A=ye.hasEagerState?ye.eagerState:c(A,Be)}else xe={lane:Be,revertLane:ye.revertLane,gesture:ye.gesture,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},W===null?(V=W=xe,O=A):W=W.next=xe,rn.lanes|=Be,lo|=Be;ye=ye.next}while(ye!==null&&ye!==i);if(W===null?O=A:W.next=V,!m(A,n.memoizedState)&&(jr=!0,Ne&&(c=Dl,c!==null)))throw c;n.memoizedState=A,n.baseState=O,n.baseQueue=W,f.lastRenderedState=A}return E===null&&(f.lanes=0),[n.memoizedState,f.dispatch]}function Qf(n){var i=Br(),c=i.queue;if(c===null)throw Error(o(311));c.lastRenderedReducer=n;var f=c.dispatch,E=c.pending,A=i.memoizedState;if(E!==null){c.pending=null;var O=E=E.next;do A=n(A,O.action),O=O.next;while(O!==E);m(A,i.memoizedState)||(jr=!0),i.memoizedState=A,i.baseQueue===null&&(i.baseState=A),c.lastRenderedState=A}return[A,f]}function Mm(n,i,c){var f=rn,E=Br(),A=On;if(A){if(c===void 0)throw Error(o(407));c=c()}else c=i();var O=!m((Qn||E).memoizedState,c);if(O&&(E.memoizedState=c,jr=!0),E=E.queue,$f(Pm.bind(null,f,E,n),[n]),E.getSnapshot!==i||O||Fr!==null&&Fr.memoizedState.tag&1){if(f.flags|=2048,Vl(9,{destroy:void 0},Lm.bind(null,f,E,c,i),null),rr===null)throw Error(o(349));A||(Ea&127)!==0||km(f,i,c)}return c}function km(n,i,c){n.flags|=16384,n={getSnapshot:i,value:c},i=rn.updateQueue,i===null?(i=gh(),rn.updateQueue=i,i.stores=[n]):(c=i.stores,c===null?i.stores=[n]:c.push(n))}function Lm(n,i,c,f){i.value=c,i.getSnapshot=f,Bm(i)&&Vm(n)}function Pm(n,i,c){return c(function(){Bm(i)&&Vm(n)})}function Bm(n){var i=n.getSnapshot;n=n.value;try{var c=i();return!m(n,c)}catch{return!0}}function Vm(n){var i=Ko(n,2);i!==null&&qi(i,n,2)}function Zf(n){var i=Oi();if(typeof n=="function"){var c=n;if(n=c(),rl){zt(!0);try{c()}finally{zt(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:n},i}function Um(n,i,c,f){return n.baseState=c,Wf(n,Qn,typeof f=="function"?f:wa)}function AA(n,i,c,f,E){if(Eh(n))throw Error(o(485));if(n=i.action,n!==null){var A={payload:E,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){A.listeners.push(O)}};ue.T!==null?c(!0):A.isTransition=!1,f(A),c=i.pending,c===null?(A.next=i.pending=A,Fm(i,A)):(A.next=c.next,i.pending=c.next=A)}}function Fm(n,i){var c=i.action,f=i.payload,E=n.state;if(i.isTransition){var A=ue.T,O={};ue.T=O;try{var V=c(E,f),W=ue.S;W!==null&&W(O,V),jm(n,i,V)}catch(ye){Jf(n,i,ye)}finally{A!==null&&O.types!==null&&(A.types=O.types),ue.T=A}}else try{A=c(E,f),jm(n,i,A)}catch(ye){Jf(n,i,ye)}}function jm(n,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){zm(n,i,f)},function(f){return Jf(n,i,f)}):zm(n,i,c)}function zm(n,i,c){i.status="fulfilled",i.value=c,Hm(i),n.state=c,i=n.pending,i!==null&&(c=i.next,c===i?n.pending=null:(c=c.next,i.next=c,Fm(n,c)))}function Jf(n,i,c){var f=n.pending;if(n.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=c,Hm(i),i=i.next;while(i!==f)}n.action=null}function Hm(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function Gm(n,i){return i}function qm(n,i){if(On){var c=rr.formState;if(c!==null){e:{var f=rn;if(On){if(cr){t:{for(var E=cr,A=_s;E.nodeType!==8;){if(!A){E=null;break t}if(E=bs(E.nextSibling),E===null){E=null;break t}}A=E.data,E=A==="F!"||A==="F"?E:null}if(E){cr=bs(E.nextSibling),f=E.data==="F!";break e}}$a(f)}f=!1}f&&(i=c[0])}}return c=Oi(),c.memoizedState=c.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gm,lastRenderedState:i},c.queue=f,c=up.bind(null,rn,f),f.dispatch=c,f=Zf(!1),A=i0.bind(null,rn,!1,f.queue),f=Oi(),E={state:i,dispatch:null,action:n,pending:null},f.queue=E,c=AA.bind(null,rn,E,A,c),E.dispatch=c,f.memoizedState=n,[i,c,!1]}function Xm(n){var i=Br();return Ym(i,Qn,n)}function Ym(n,i,c){if(i=Wf(n,i,Gm)[0],n=ph(wa)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=Pc(i)}catch(O){throw O===Ml?ah:O}else f=i;i=Br();var E=i.queue,A=E.dispatch;return c!==i.memoizedState&&(rn.flags|=2048,Vl(9,{destroy:void 0},bA.bind(null,E,c),null)),[f,A,n]}function bA(n,i){n.action=i}function Km(n){var i=Br(),c=Qn;if(c!==null)return Ym(i,c,n);Br(),i=i.memoizedState,c=Br();var f=c.queue.dispatch;return c.memoizedState=n,[i,f,!1]}function Vl(n,i,c,f){return n={tag:n,create:c,deps:f,inst:i,next:null},i=rn.updateQueue,i===null&&(i=gh(),rn.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=n.next=n:(f=c.next,c.next=n,n.next=f,i.lastEffect=n),n}function Wm(){return Br().memoizedState}function yh(n,i,c,f){var E=Oi();rn.flags|=n,E.memoizedState=Vl(1|i,{destroy:void 0},c,f===void 0?null:f)}function xh(n,i,c,f){var E=Br();f=f===void 0?null:f;var A=E.memoizedState.inst;Qn!==null&&f!==null&&Hf(f,Qn.memoizedState.deps)?E.memoizedState=Vl(i,A,c,f):(rn.flags|=n,E.memoizedState=Vl(1|i,A,c,f))}function Qm(n,i){yh(8390656,8,n,i)}function $f(n,i){xh(2048,8,n,i)}function vA(n){rn.flags|=4;var i=rn.updateQueue;if(i===null)i=gh(),rn.updateQueue=i,i.events=[n];else{var c=i.events;c===null?i.events=[n]:c.push(n)}}function Zm(n){var i=Br().memoizedState;return vA({ref:i,nextImpl:n}),function(){if((Un&2)!==0)throw Error(o(440));return i.impl.apply(void 0,arguments)}}function Jm(n,i){return xh(4,2,n,i)}function $m(n,i){return xh(4,4,n,i)}function ep(n,i){if(typeof i=="function"){n=n();var c=i(n);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function tp(n,i,c){c=c!=null?c.concat([n]):null,xh(4,4,ep.bind(null,i,n),c)}function e0(){}function np(n,i){var c=Br();i=i===void 0?null:i;var f=c.memoizedState;return i!==null&&Hf(i,f[1])?f[0]:(c.memoizedState=[n,i],n)}function rp(n,i){var c=Br();i=i===void 0?null:i;var f=c.memoizedState;if(i!==null&&Hf(i,f[1]))return f[0];if(f=n(),rl){zt(!0);try{n()}finally{zt(!1)}}return c.memoizedState=[f,i],f}function t0(n,i,c){return c===void 0||(Ea&1073741824)!==0&&(bn&261930)===0?n.memoizedState=i:(n.memoizedState=c,n=iy(),rn.lanes|=n,lo|=n,c)}function ip(n,i,c,f){return m(c,i)?c:Ll.current!==null?(n=t0(n,c,f),m(n,i)||(jr=!0),n):(Ea&42)===0||(Ea&1073741824)!==0&&(bn&261930)===0?(jr=!0,n.memoizedState=c):(n=iy(),rn.lanes|=n,lo|=n,i)}function sp(n,i,c,f,E){var A=Ee.p;Ee.p=A!==0&&8>A?A:8;var O=ue.T,V={};ue.T=V,i0(n,!1,i,c);try{var W=E(),ye=ue.S;if(ye!==null&&ye(V,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var Ne=EA(W,f);Bc(n,i,Ne,os(n))}else Bc(n,i,f,os(n))}catch(Be){Bc(n,i,{then:function(){},status:"rejected",reason:Be},os())}finally{Ee.p=A,O!==null&&V.types!==null&&(O.types=V.types),ue.T=O}}function TA(){}function n0(n,i,c,f){if(n.tag!==5)throw Error(o(476));var E=ap(n).queue;sp(n,E,i,We,c===null?TA:function(){return op(n),c(f)})}function ap(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:We,baseState:We,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:We},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:c},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function op(n){var i=ap(n);i.next===null&&(i=n.alternate.memoizedState),Bc(n,i.next.queue,{},os())}function r0(){return ai(eu)}function lp(){return Br().memoizedState}function cp(){return Br().memoizedState}function CA(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var c=os();n=no(c);var f=ro(i,n,c);f!==null&&(qi(f,i,c),Dc(f,i,c)),i={cache:Df()},n.payload=i;return}i=i.return}}function SA(n,i,c){var f=os();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Eh(n)?hp(i,c):(c=_f(n,i,c,f),c!==null&&(qi(c,n,f),dp(c,i,f)))}function up(n,i,c){var f=os();Bc(n,i,c,f)}function Bc(n,i,c,f){var E={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Eh(n))hp(i,E);else{var A=n.alternate;if(n.lanes===0&&(A===null||A.lanes===0)&&(A=i.lastRenderedReducer,A!==null))try{var O=i.lastRenderedState,V=A(O,c);if(E.hasEagerState=!0,E.eagerState=V,m(V,O))return $u(n,i,E,0),rr===null&&Ju(),!1}catch{}finally{}if(c=_f(n,i,E,f),c!==null)return qi(c,n,f),dp(c,i,f),!0}return!1}function i0(n,i,c,f){if(f={lane:2,revertLane:P0(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Eh(n)){if(i)throw Error(o(479))}else i=_f(n,c,f,2),i!==null&&qi(i,n,2)}function Eh(n){var i=n.alternate;return n===rn||i!==null&&i===rn}function hp(n,i){Pl=dh=!0;var c=n.pending;c===null?i.next=i:(i.next=c.next,c.next=i),n.pending=i}function dp(n,i,c){if((c&4194048)!==0){var f=i.lanes;f&=n.pendingLanes,c|=f,i.lanes=c,ft(n,c)}}var Vc={readContext:ai,use:mh,useCallback:Ir,useContext:Ir,useEffect:Ir,useImperativeHandle:Ir,useLayoutEffect:Ir,useInsertionEffect:Ir,useMemo:Ir,useReducer:Ir,useRef:Ir,useState:Ir,useDebugValue:Ir,useDeferredValue:Ir,useTransition:Ir,useSyncExternalStore:Ir,useId:Ir,useHostTransitionStatus:Ir,useFormState:Ir,useActionState:Ir,useOptimistic:Ir,useMemoCache:Ir,useCacheRefresh:Ir};Vc.useEffectEvent=Ir;var fp={readContext:ai,use:mh,useCallback:function(n,i){return Oi().memoizedState=[n,i===void 0?null:i],n},useContext:ai,useEffect:Qm,useImperativeHandle:function(n,i,c){c=c!=null?c.concat([n]):null,yh(4194308,4,ep.bind(null,i,n),c)},useLayoutEffect:function(n,i){return yh(4194308,4,n,i)},useInsertionEffect:function(n,i){yh(4,2,n,i)},useMemo:function(n,i){var c=Oi();i=i===void 0?null:i;var f=n();if(rl){zt(!0);try{n()}finally{zt(!1)}}return c.memoizedState=[f,i],f},useReducer:function(n,i,c){var f=Oi();if(c!==void 0){var E=c(i);if(rl){zt(!0);try{c(i)}finally{zt(!1)}}}else E=i;return f.memoizedState=f.baseState=E,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:E},f.queue=n,n=n.dispatch=SA.bind(null,rn,n),[f.memoizedState,n]},useRef:function(n){var i=Oi();return n={current:n},i.memoizedState=n},useState:function(n){n=Zf(n);var i=n.queue,c=up.bind(null,rn,i);return i.dispatch=c,[n.memoizedState,c]},useDebugValue:e0,useDeferredValue:function(n,i){var c=Oi();return t0(c,n,i)},useTransition:function(){var n=Zf(!1);return n=sp.bind(null,rn,n.queue,!0,!1),Oi().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,c){var f=rn,E=Oi();if(On){if(c===void 0)throw Error(o(407));c=c()}else{if(c=i(),rr===null)throw Error(o(349));(bn&127)!==0||km(f,i,c)}E.memoizedState=c;var A={value:c,getSnapshot:i};return E.queue=A,Qm(Pm.bind(null,f,A,n),[n]),f.flags|=2048,Vl(9,{destroy:void 0},Lm.bind(null,f,A,c,i),null),c},useId:function(){var n=Oi(),i=rr.identifierPrefix;if(On){var c=Hs,f=zs;c=(f&~(1<<32-wt(f)-1)).toString(32)+c,i="_"+i+"R_"+c,c=fh++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=wA++,i="_"+i+"r_"+c.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:r0,useFormState:qm,useActionState:qm,useOptimistic:function(n){var i=Oi();i.memoizedState=i.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=i0.bind(null,rn,!0,c),c.dispatch=i,[n,i]},useMemoCache:Kf,useCacheRefresh:function(){return Oi().memoizedState=CA.bind(null,rn)},useEffectEvent:function(n){var i=Oi(),c={impl:n};return i.memoizedState=c,function(){if((Un&2)!==0)throw Error(o(440));return c.impl.apply(void 0,arguments)}}},s0={readContext:ai,use:mh,useCallback:np,useContext:ai,useEffect:$f,useImperativeHandle:tp,useInsertionEffect:Jm,useLayoutEffect:$m,useMemo:rp,useReducer:ph,useRef:Wm,useState:function(){return ph(wa)},useDebugValue:e0,useDeferredValue:function(n,i){var c=Br();return ip(c,Qn.memoizedState,n,i)},useTransition:function(){var n=ph(wa)[0],i=Br().memoizedState;return[typeof n=="boolean"?n:Pc(n),i]},useSyncExternalStore:Mm,useId:lp,useHostTransitionStatus:r0,useFormState:Xm,useActionState:Xm,useOptimistic:function(n,i){var c=Br();return Um(c,Qn,n,i)},useMemoCache:Kf,useCacheRefresh:cp};s0.useEffectEvent=Zm;var gp={readContext:ai,use:mh,useCallback:np,useContext:ai,useEffect:$f,useImperativeHandle:tp,useInsertionEffect:Jm,useLayoutEffect:$m,useMemo:rp,useReducer:Qf,useRef:Wm,useState:function(){return Qf(wa)},useDebugValue:e0,useDeferredValue:function(n,i){var c=Br();return Qn===null?t0(c,n,i):ip(c,Qn.memoizedState,n,i)},useTransition:function(){var n=Qf(wa)[0],i=Br().memoizedState;return[typeof n=="boolean"?n:Pc(n),i]},useSyncExternalStore:Mm,useId:lp,useHostTransitionStatus:r0,useFormState:Km,useActionState:Km,useOptimistic:function(n,i){var c=Br();return Qn!==null?Um(c,Qn,n,i):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:Kf,useCacheRefresh:cp};gp.useEffectEvent=Zm;function a0(n,i,c,f){i=n.memoizedState,c=c(f,i),c=c==null?i:R({},i,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var o0={enqueueSetState:function(n,i,c){n=n._reactInternals;var f=os(),E=no(f);E.payload=i,c!=null&&(E.callback=c),i=ro(n,E,f),i!==null&&(qi(i,n,f),Dc(i,n,f))},enqueueReplaceState:function(n,i,c){n=n._reactInternals;var f=os(),E=no(f);E.tag=1,E.payload=i,c!=null&&(E.callback=c),i=ro(n,E,f),i!==null&&(qi(i,n,f),Dc(i,n,f))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var c=os(),f=no(c);f.tag=2,i!=null&&(f.callback=i),i=ro(n,f,c),i!==null&&(qi(i,n,c),Dc(i,n,c))}};function mp(n,i,c,f,E,A,O){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,A,O):i.prototype&&i.prototype.isPureReactComponent?!y(c,f)||!y(E,A):!0}function pp(n,i,c,f){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,f),i.state!==n&&o0.enqueueReplaceState(i,i.state,null)}function il(n,i){var c=i;if("ref"in i){c={};for(var f in i)f!=="ref"&&(c[f]=i[f])}if(n=n.defaultProps){c===i&&(c=R({},c));for(var E in n)c[E]===void 0&&(c[E]=n[E])}return c}function yp(n){Zu(n)}function xp(n){console.error(n)}function Ep(n){Zu(n)}function wh(n,i){try{var c=n.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function wp(n,i,c){try{var f=n.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function l0(n,i,c){return c=no(c),c.tag=3,c.payload={element:null},c.callback=function(){wh(n,i)},c}function _p(n){return n=no(n),n.tag=3,n}function Ap(n,i,c,f){var E=c.type.getDerivedStateFromError;if(typeof E=="function"){var A=f.value;n.payload=function(){return E(A)},n.callback=function(){wp(i,c,f)}}var O=c.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(n.callback=function(){wp(i,c,f),typeof E!="function"&&(co===null?co=new Set([this]):co.add(this));var V=f.stack;this.componentDidCatch(f.value,{componentStack:V!==null?V:""})})}function IA(n,i,c,f,E){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=c.alternate,i!==null&&Nl(i,c,E,!0),c=rs.current,c!==null){switch(c.tag){case 31:case 13:return As===null?Dh():c.alternate===null&&Rr===0&&(Rr=3),c.flags&=-257,c.flags|=65536,c.lanes=E,f===oh?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([f]):i.add(f),M0(n,f,E)),!1;case 22:return c.flags|=65536,f===oh?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([f]):c.add(f)),M0(n,f,E)),!1}throw Error(o(435,c.tag))}return M0(n,f,E),Dh(),!1}if(On)return i=rs.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=E,f!==Sf&&(n=Error(o(422),{cause:f}),Sc(xs(n,c)))):(f!==Sf&&(i=Error(o(423),{cause:f}),Sc(xs(i,c))),n=n.current.alternate,n.flags|=65536,E&=-E,n.lanes|=E,f=xs(f,c),E=l0(n.stateNode,f,E),Vf(n,E),Rr!==4&&(Rr=2)),!1;var A=Error(o(520),{cause:f});if(A=xs(A,c),Xc===null?Xc=[A]:Xc.push(A),Rr!==4&&(Rr=2),i===null)return!0;f=xs(f,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,n=E&-E,c.lanes|=n,n=l0(c.stateNode,f,n),Vf(c,n),!1;case 1:if(i=c.type,A=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(co===null||!co.has(A))))return c.flags|=65536,E&=-E,c.lanes|=E,E=_p(E),Ap(E,n,c,f),Vf(c,E),!1}c=c.return}while(c!==null);return!1}var c0=Error(o(461)),jr=!1;function oi(n,i,c,f){i.child=n===null?Cm(i,null,c,f):nl(i,n.child,c,f)}function bp(n,i,c,f,E){c=c.render;var A=i.ref;if("ref"in f){var O={};for(var V in f)V!=="ref"&&(O[V]=f[V])}else O=f;return Jo(i),f=Gf(n,i,c,O,A,E),V=qf(),n!==null&&!jr?(Xf(n,i,E),_a(n,i,E)):(On&&V&&Tf(i),i.flags|=1,oi(n,i,f,E),i.child)}function vp(n,i,c,f,E){if(n===null){var A=c.type;return typeof A=="function"&&!Af(A)&&A.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=A,Tp(n,i,A,f,E)):(n=th(c.type,null,f,i,i.mode,E),n.ref=i.ref,n.return=i,i.child=n)}if(A=n.child,!y0(n,E)){var O=A.memoizedProps;if(c=c.compare,c=c!==null?c:y,c(O,f)&&n.ref===i.ref)return _a(n,i,E)}return i.flags|=1,n=ma(A,f),n.ref=i.ref,n.return=i,i.child=n}function Tp(n,i,c,f,E){if(n!==null){var A=n.memoizedProps;if(y(A,f)&&n.ref===i.ref)if(jr=!1,i.pendingProps=f=A,y0(n,E))(n.flags&131072)!==0&&(jr=!0);else return i.lanes=n.lanes,_a(n,i,E)}return u0(n,i,c,f,E)}function Cp(n,i,c,f){var E=f.children,A=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(A=A!==null?A.baseLanes|c:c,n!==null){for(f=i.child=n.child,E=0;f!==null;)E=E|f.lanes|f.childLanes,f=f.sibling;f=E&~A}else f=0,i.child=null;return Sp(n,i,A,c,f)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&sh(i,A!==null?A.cachePool:null),A!==null?Rm(i,A):Ff(),Nm(i);else return f=i.lanes=536870912,Sp(n,i,A!==null?A.baseLanes|c:c,c,f)}else A!==null?(sh(i,A.cachePool),Rm(i,A),so(),i.memoizedState=null):(n!==null&&sh(i,null),Ff(),so());return oi(n,i,E,c),i.child}function Uc(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Sp(n,i,c,f,E){var A=kf();return A=A===null?null:{parent:Ur._currentValue,pool:A},i.memoizedState={baseLanes:c,cachePool:A},n!==null&&sh(i,null),Ff(),Nm(i),n!==null&&Nl(n,i,f,!0),i.childLanes=E,null}function _h(n,i){return i=bh({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Ip(n,i,c){return nl(i,n.child,null,c),n=_h(i,i.pendingProps),n.flags|=2,is(i),i.memoizedState=null,n}function RA(n,i,c){var f=i.pendingProps,E=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(On){if(f.mode==="hidden")return n=_h(i,f),i.lanes=536870912,Uc(null,n);if(zf(i),(n=cr)?(n=Fy(n,_s),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Za!==null?{id:zs,overflow:Hs}:null,retryLane:536870912,hydrationErrors:null},c=hm(n),c.return=i,i.child=c,si=i,cr=null)):n=null,n===null)throw $a(i);return i.lanes=536870912,null}return _h(i,f)}var A=n.memoizedState;if(A!==null){var O=A.dehydrated;if(zf(i),E)if(i.flags&256)i.flags&=-257,i=Ip(n,i,c);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(o(558));else if(jr||Nl(n,i,c,!1),E=(c&n.childLanes)!==0,jr||E){if(f=rr,f!==null&&(O=it(f,c),O!==0&&O!==A.retryLane))throw A.retryLane=O,Ko(n,O),qi(f,n,O),c0;Dh(),i=Ip(n,i,c)}else n=A.treeContext,cr=bs(O.nextSibling),si=i,On=!0,Ja=null,_s=!1,n!==null&&gm(i,n),i=_h(i,f),i.flags|=4096;return i}return n=ma(n.child,{mode:f.mode,children:f.children}),n.ref=i.ref,i.child=n,n.return=i,n}function Ah(n,i){var c=i.ref;if(c===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(o(284));(n===null||n.ref!==c)&&(i.flags|=4194816)}}function u0(n,i,c,f,E){return Jo(i),c=Gf(n,i,c,f,void 0,E),f=qf(),n!==null&&!jr?(Xf(n,i,E),_a(n,i,E)):(On&&f&&Tf(i),i.flags|=1,oi(n,i,c,E),i.child)}function Rp(n,i,c,f,E,A){return Jo(i),i.updateQueue=null,c=Dm(i,f,c,E),Om(n),f=qf(),n!==null&&!jr?(Xf(n,i,A),_a(n,i,A)):(On&&f&&Tf(i),i.flags|=1,oi(n,i,c,A),i.child)}function Np(n,i,c,f,E){if(Jo(i),i.stateNode===null){var A=Cl,O=c.contextType;typeof O=="object"&&O!==null&&(A=ai(O)),A=new c(f,A),i.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=o0,i.stateNode=A,A._reactInternals=i,A=i.stateNode,A.props=f,A.state=i.memoizedState,A.refs={},Pf(i),O=c.contextType,A.context=typeof O=="object"&&O!==null?ai(O):Cl,A.state=i.memoizedState,O=c.getDerivedStateFromProps,typeof O=="function"&&(a0(i,c,O,f),A.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(O=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),O!==A.state&&o0.enqueueReplaceState(A,A.state,null),kc(i,f,A,E),Mc(),A.state=i.memoizedState),typeof A.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(n===null){A=i.stateNode;var V=i.memoizedProps,W=il(c,V);A.props=W;var ye=A.context,Ne=c.contextType;O=Cl,typeof Ne=="object"&&Ne!==null&&(O=ai(Ne));var Be=c.getDerivedStateFromProps;Ne=typeof Be=="function"||typeof A.getSnapshotBeforeUpdate=="function",V=i.pendingProps!==V,Ne||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(V||ye!==O)&&pp(i,A,f,O),to=!1;var xe=i.memoizedState;A.state=xe,kc(i,f,A,E),Mc(),ye=i.memoizedState,V||xe!==ye||to?(typeof Be=="function"&&(a0(i,c,Be,f),ye=i.memoizedState),(W=to||mp(i,c,W,f,xe,ye,O))?(Ne||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(i.flags|=4194308)):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=ye),A.props=f,A.state=ye,A.context=O,f=W):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{A=i.stateNode,Bf(n,i),O=i.memoizedProps,Ne=il(c,O),A.props=Ne,Be=i.pendingProps,xe=A.context,ye=c.contextType,W=Cl,typeof ye=="object"&&ye!==null&&(W=ai(ye)),V=c.getDerivedStateFromProps,(ye=typeof V=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(O!==Be||xe!==W)&&pp(i,A,f,W),to=!1,xe=i.memoizedState,A.state=xe,kc(i,f,A,E),Mc();var Ce=i.memoizedState;O!==Be||xe!==Ce||to||n!==null&&n.dependencies!==null&&rh(n.dependencies)?(typeof V=="function"&&(a0(i,c,V,f),Ce=i.memoizedState),(Ne=to||mp(i,c,Ne,f,xe,Ce,W)||n!==null&&n.dependencies!==null&&rh(n.dependencies))?(ye||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(f,Ce,W),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(f,Ce,W)),typeof A.componentDidUpdate=="function"&&(i.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof A.componentDidUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=Ce),A.props=f,A.state=Ce,A.context=W,f=Ne):(typeof A.componentDidUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(i.flags|=1024),f=!1)}return A=f,Ah(n,i),f=(i.flags&128)!==0,A||f?(A=i.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:A.render(),i.flags|=1,n!==null&&f?(i.child=nl(i,n.child,null,E),i.child=nl(i,null,c,E)):oi(n,i,c,E),i.memoizedState=A.state,n=i.child):n=_a(n,i,E),n}function Op(n,i,c,f){return Qo(),i.flags|=256,oi(n,i,c,f),i.child}var h0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function d0(n){return{baseLanes:n,cachePool:wm()}}function f0(n,i,c){return n=n!==null?n.childLanes&~c:0,i&&(n|=as),n}function Dp(n,i,c){var f=i.pendingProps,E=!1,A=(i.flags&128)!==0,O;if((O=A)||(O=n!==null&&n.memoizedState===null?!1:(Pr.current&2)!==0),O&&(E=!0,i.flags&=-129),O=(i.flags&32)!==0,i.flags&=-33,n===null){if(On){if(E?io(i):so(),(n=cr)?(n=Fy(n,_s),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Za!==null?{id:zs,overflow:Hs}:null,retryLane:536870912,hydrationErrors:null},c=hm(n),c.return=i,i.child=c,si=i,cr=null)):n=null,n===null)throw $a(i);return W0(n)?i.lanes=32:i.lanes=536870912,null}var V=f.children;return f=f.fallback,E?(so(),E=i.mode,V=bh({mode:"hidden",children:V},E),f=Wo(f,E,c,null),V.return=i,f.return=i,V.sibling=f,i.child=V,f=i.child,f.memoizedState=d0(c),f.childLanes=f0(n,O,c),i.memoizedState=h0,Uc(null,f)):(io(i),g0(i,V))}var W=n.memoizedState;if(W!==null&&(V=W.dehydrated,V!==null)){if(A)i.flags&256?(io(i),i.flags&=-257,i=m0(n,i,c)):i.memoizedState!==null?(so(),i.child=n.child,i.flags|=128,i=null):(so(),V=f.fallback,E=i.mode,f=bh({mode:"visible",children:f.children},E),V=Wo(V,E,c,null),V.flags|=2,f.return=i,V.return=i,f.sibling=V,i.child=f,nl(i,n.child,null,c),f=i.child,f.memoizedState=d0(c),f.childLanes=f0(n,O,c),i.memoizedState=h0,i=Uc(null,f));else if(io(i),W0(V)){if(O=V.nextSibling&&V.nextSibling.dataset,O)var ye=O.dgst;O=ye,f=Error(o(419)),f.stack="",f.digest=O,Sc({value:f,source:null,stack:null}),i=m0(n,i,c)}else if(jr||Nl(n,i,c,!1),O=(c&n.childLanes)!==0,jr||O){if(O=rr,O!==null&&(f=it(O,c),f!==0&&f!==W.retryLane))throw W.retryLane=f,Ko(n,f),qi(O,n,f),c0;K0(V)||Dh(),i=m0(n,i,c)}else K0(V)?(i.flags|=192,i.child=n.child,i=null):(n=W.treeContext,cr=bs(V.nextSibling),si=i,On=!0,Ja=null,_s=!1,n!==null&&gm(i,n),i=g0(i,f.children),i.flags|=4096);return i}return E?(so(),V=f.fallback,E=i.mode,W=n.child,ye=W.sibling,f=ma(W,{mode:"hidden",children:f.children}),f.subtreeFlags=W.subtreeFlags&65011712,ye!==null?V=ma(ye,V):(V=Wo(V,E,c,null),V.flags|=2),V.return=i,f.return=i,f.sibling=V,i.child=f,Uc(null,f),f=i.child,V=n.child.memoizedState,V===null?V=d0(c):(E=V.cachePool,E!==null?(W=Ur._currentValue,E=E.parent!==W?{parent:W,pool:W}:E):E=wm(),V={baseLanes:V.baseLanes|c,cachePool:E}),f.memoizedState=V,f.childLanes=f0(n,O,c),i.memoizedState=h0,Uc(n.child,f)):(io(i),c=n.child,n=c.sibling,c=ma(c,{mode:"visible",children:f.children}),c.return=i,c.sibling=null,n!==null&&(O=i.deletions,O===null?(i.deletions=[n],i.flags|=16):O.push(n)),i.child=c,i.memoizedState=null,c)}function g0(n,i){return i=bh({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function bh(n,i){return n=ns(22,n,null,i),n.lanes=0,n}function m0(n,i,c){return nl(i,n.child,null,c),n=g0(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function Mp(n,i,c){n.lanes|=i;var f=n.alternate;f!==null&&(f.lanes|=i),Nf(n.return,i,c)}function p0(n,i,c,f,E,A){var O=n.memoizedState;O===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:E,treeForkCount:A}:(O.isBackwards=i,O.rendering=null,O.renderingStartTime=0,O.last=f,O.tail=c,O.tailMode=E,O.treeForkCount=A)}function kp(n,i,c){var f=i.pendingProps,E=f.revealOrder,A=f.tail;f=f.children;var O=Pr.current,V=(O&2)!==0;if(V?(O=O&1|2,i.flags|=128):O&=1,pe(Pr,O),oi(n,i,f,c),f=On?Cc:0,!V&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Mp(n,c,i);else if(n.tag===19)Mp(n,c,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(E){case"forwards":for(c=i.child,E=null;c!==null;)n=c.alternate,n!==null&&hh(n)===null&&(E=c),c=c.sibling;c=E,c===null?(E=i.child,i.child=null):(E=c.sibling,c.sibling=null),p0(i,!1,E,c,A,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,E=i.child,i.child=null;E!==null;){if(n=E.alternate,n!==null&&hh(n)===null){i.child=E;break}n=E.sibling,E.sibling=c,c=E,E=n}p0(i,!0,c,null,A,f);break;case"together":p0(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function _a(n,i,c){if(n!==null&&(i.dependencies=n.dependencies),lo|=i.lanes,(c&i.childLanes)===0)if(n!==null){if(Nl(n,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(o(153));if(i.child!==null){for(n=i.child,c=ma(n,n.pendingProps),i.child=c,c.return=i;n.sibling!==null;)n=n.sibling,c=c.sibling=ma(n,n.pendingProps),c.return=i;c.sibling=null}return i.child}function y0(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&rh(n)))}function NA(n,i,c){switch(i.tag){case 3:xt(i,i.stateNode.containerInfo),eo(i,Ur,n.memoizedState.cache),Qo();break;case 27:case 5:cn(i);break;case 4:xt(i,i.stateNode.containerInfo);break;case 10:eo(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,zf(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(io(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Dp(n,i,c):(io(i),n=_a(n,i,c),n!==null?n.sibling:null);io(i);break;case 19:var E=(n.flags&128)!==0;if(f=(c&i.childLanes)!==0,f||(Nl(n,i,c,!1),f=(c&i.childLanes)!==0),E){if(f)return kp(n,i,c);i.flags|=128}if(E=i.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),pe(Pr,Pr.current),f)break;return null;case 22:return i.lanes=0,Cp(n,i,c,i.pendingProps);case 24:eo(i,Ur,n.memoizedState.cache)}return _a(n,i,c)}function Lp(n,i,c){if(n!==null)if(n.memoizedProps!==i.pendingProps)jr=!0;else{if(!y0(n,c)&&(i.flags&128)===0)return jr=!1,NA(n,i,c);jr=(n.flags&131072)!==0}else jr=!1,On&&(i.flags&1048576)!==0&&fm(i,Cc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(n=el(i.elementType),i.type=n,typeof n=="function")Af(n)?(f=il(n,f),i.tag=1,i=Np(null,i,n,f,c)):(i.tag=0,i=u0(null,i,n,f,c));else{if(n!=null){var E=n.$$typeof;if(E===Ue){i.tag=11,i=bp(null,i,n,f,c);break e}else if(E===F){i.tag=14,i=vp(null,i,n,f,c);break e}}throw i=at(n)||n,Error(o(306,i,""))}}return i;case 0:return u0(n,i,i.type,i.pendingProps,c);case 1:return f=i.type,E=il(f,i.pendingProps),Np(n,i,f,E,c);case 3:e:{if(xt(i,i.stateNode.containerInfo),n===null)throw Error(o(387));f=i.pendingProps;var A=i.memoizedState;E=A.element,Bf(n,i),kc(i,f,null,c);var O=i.memoizedState;if(f=O.cache,eo(i,Ur,f),f!==A.cache&&Of(i,[Ur],c,!0),Mc(),f=O.element,A.isDehydrated)if(A={element:f,isDehydrated:!1,cache:O.cache},i.updateQueue.baseState=A,i.memoizedState=A,i.flags&256){i=Op(n,i,f,c);break e}else if(f!==E){E=xs(Error(o(424)),i),Sc(E),i=Op(n,i,f,c);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(cr=bs(n.firstChild),si=i,On=!0,Ja=null,_s=!0,c=Cm(i,null,f,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Qo(),f===E){i=_a(n,i,c);break e}oi(n,i,f,c)}i=i.child}return i;case 26:return Ah(n,i),n===null?(c=Xy(i.type,null,i.pendingProps,null))?i.memoizedState=c:On||(c=i.type,n=i.pendingProps,f=Uh(ve.current).createElement(c),f[gt]=i,f[Ot]=n,li(f,c,n),sr(f),i.stateNode=f):i.memoizedState=Xy(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return cn(i),n===null&&On&&(f=i.stateNode=Hy(i.type,i.pendingProps,ve.current),si=i,_s=!0,E=cr,go(i.type)?(Q0=E,cr=bs(f.firstChild)):cr=E),oi(n,i,i.pendingProps.children,c),Ah(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&On&&((E=f=cr)&&(f=ab(f,i.type,i.pendingProps,_s),f!==null?(i.stateNode=f,si=i,cr=bs(f.firstChild),_s=!1,E=!0):E=!1),E||$a(i)),cn(i),E=i.type,A=i.pendingProps,O=n!==null?n.memoizedProps:null,f=A.children,q0(E,A)?f=null:O!==null&&q0(E,O)&&(i.flags|=32),i.memoizedState!==null&&(E=Gf(n,i,_A,null,null,c),eu._currentValue=E),Ah(n,i),oi(n,i,f,c),i.child;case 6:return n===null&&On&&((n=c=cr)&&(c=ob(c,i.pendingProps,_s),c!==null?(i.stateNode=c,si=i,cr=null,n=!0):n=!1),n||$a(i)),null;case 13:return Dp(n,i,c);case 4:return xt(i,i.stateNode.containerInfo),f=i.pendingProps,n===null?i.child=nl(i,null,f,c):oi(n,i,f,c),i.child;case 11:return bp(n,i,i.type,i.pendingProps,c);case 7:return oi(n,i,i.pendingProps,c),i.child;case 8:return oi(n,i,i.pendingProps.children,c),i.child;case 12:return oi(n,i,i.pendingProps.children,c),i.child;case 10:return f=i.pendingProps,eo(i,i.type,f.value),oi(n,i,f.children,c),i.child;case 9:return E=i.type._context,f=i.pendingProps.children,Jo(i),E=ai(E),f=f(E),i.flags|=1,oi(n,i,f,c),i.child;case 14:return vp(n,i,i.type,i.pendingProps,c);case 15:return Tp(n,i,i.type,i.pendingProps,c);case 19:return kp(n,i,c);case 31:return RA(n,i,c);case 22:return Cp(n,i,c,i.pendingProps);case 24:return Jo(i),f=ai(Ur),n===null?(E=kf(),E===null&&(E=rr,A=Df(),E.pooledCache=A,A.refCount++,A!==null&&(E.pooledCacheLanes|=c),E=A),i.memoizedState={parent:f,cache:E},Pf(i),eo(i,Ur,E)):((n.lanes&c)!==0&&(Bf(n,i),kc(i,null,null,c),Mc()),E=n.memoizedState,A=i.memoizedState,E.parent!==f?(E={parent:f,cache:f},i.memoizedState=E,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=E),eo(i,Ur,f)):(f=A.cache,eo(i,Ur,f),f!==E.cache&&Of(i,[Ur],c,!0))),oi(n,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(o(156,i.tag))}function Aa(n){n.flags|=4}function x0(n,i,c,f,E){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(E&335544128)===E)if(n.stateNode.complete)n.flags|=8192;else if(ly())n.flags|=8192;else throw tl=oh,Lf}else n.flags&=-16777217}function Pp(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Zy(i))if(ly())n.flags|=8192;else throw tl=oh,Lf}function vh(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?ie():536870912,n.lanes|=i,zl|=i)}function Fc(n,i){if(!On)switch(n.tailMode){case"hidden":i=n.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function ur(n){var i=n.alternate!==null&&n.alternate.child===n.child,c=0,f=0;if(i)for(var E=n.child;E!==null;)c|=E.lanes|E.childLanes,f|=E.subtreeFlags&65011712,f|=E.flags&65011712,E.return=n,E=E.sibling;else for(E=n.child;E!==null;)c|=E.lanes|E.childLanes,f|=E.subtreeFlags,f|=E.flags,E.return=n,E=E.sibling;return n.subtreeFlags|=f,n.childLanes=c,i}function OA(n,i,c){var f=i.pendingProps;switch(Cf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ur(i),null;case 1:return ur(i),null;case 3:return c=i.stateNode,f=null,n!==null&&(f=n.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),xa(Ur),kt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(Rl(i)?Aa(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,If())),ur(i),null;case 26:var E=i.type,A=i.memoizedState;return n===null?(Aa(i),A!==null?(ur(i),Pp(i,A)):(ur(i),x0(i,E,null,f,c))):A?A!==n.memoizedState?(Aa(i),ur(i),Pp(i,A)):(ur(i),i.flags&=-16777217):(n=n.memoizedProps,n!==f&&Aa(i),ur(i),x0(i,E,n,f,c)),null;case 27:if(en(i),c=ve.current,E=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&Aa(i);else{if(!f){if(i.stateNode===null)throw Error(o(166));return ur(i),null}n=Te.current,Rl(i)?mm(i):(n=Hy(E,f,c),i.stateNode=n,Aa(i))}return ur(i),null;case 5:if(en(i),E=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&Aa(i);else{if(!f){if(i.stateNode===null)throw Error(o(166));return ur(i),null}if(A=Te.current,Rl(i))mm(i);else{var O=Uh(ve.current);switch(A){case 1:A=O.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:A=O.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":A=O.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":A=O.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":A=O.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof f.is=="string"?O.createElement("select",{is:f.is}):O.createElement("select"),f.multiple?A.multiple=!0:f.size&&(A.size=f.size);break;default:A=typeof f.is=="string"?O.createElement(E,{is:f.is}):O.createElement(E)}}A[gt]=i,A[Ot]=f;e:for(O=i.child;O!==null;){if(O.tag===5||O.tag===6)A.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===i)break e;for(;O.sibling===null;){if(O.return===null||O.return===i)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}i.stateNode=A;e:switch(li(A,E,f),E){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Aa(i)}}return ur(i),x0(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,c),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==f&&Aa(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(o(166));if(n=ve.current,Rl(i)){if(n=i.stateNode,c=i.memoizedProps,f=null,E=si,E!==null)switch(E.tag){case 27:case 5:f=E.memoizedProps}n[gt]=i,n=!!(n.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Dy(n.nodeValue,c)),n||$a(i,!0)}else n=Uh(n).createTextNode(f),n[gt]=i,i.stateNode=n}return ur(i),null;case 31:if(c=i.memoizedState,n===null||n.memoizedState!==null){if(f=Rl(i),c!==null){if(n===null){if(!f)throw Error(o(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(o(557));n[gt]=i}else Qo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ur(i),n=!1}else c=If(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=c),n=!0;if(!n)return i.flags&256?(is(i),i):(is(i),null);if((i.flags&128)!==0)throw Error(o(558))}return ur(i),null;case 13:if(f=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(E=Rl(i),f!==null&&f.dehydrated!==null){if(n===null){if(!E)throw Error(o(318));if(E=i.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(o(317));E[gt]=i}else Qo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ur(i),E=!1}else E=If(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=E),E=!0;if(!E)return i.flags&256?(is(i),i):(is(i),null)}return is(i),(i.flags&128)!==0?(i.lanes=c,i):(c=f!==null,n=n!==null&&n.memoizedState!==null,c&&(f=i.child,E=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(E=f.alternate.memoizedState.cachePool.pool),A=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),A!==E&&(f.flags|=2048)),c!==n&&c&&(i.child.flags|=8192),vh(i,i.updateQueue),ur(i),null);case 4:return kt(),n===null&&F0(i.stateNode.containerInfo),ur(i),null;case 10:return xa(i.type),ur(i),null;case 19:if($(Pr),f=i.memoizedState,f===null)return ur(i),null;if(E=(i.flags&128)!==0,A=f.rendering,A===null)if(E)Fc(f,!1);else{if(Rr!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(A=hh(n),A!==null){for(i.flags|=128,Fc(f,!1),n=A.updateQueue,i.updateQueue=n,vh(i,n),i.subtreeFlags=0,n=c,c=i.child;c!==null;)um(c,n),c=c.sibling;return pe(Pr,Pr.current&1|2),On&&pa(i,f.treeForkCount),i.child}n=n.sibling}f.tail!==null&&Rt()>Rh&&(i.flags|=128,E=!0,Fc(f,!1),i.lanes=4194304)}else{if(!E)if(n=hh(A),n!==null){if(i.flags|=128,E=!0,n=n.updateQueue,i.updateQueue=n,vh(i,n),Fc(f,!0),f.tail===null&&f.tailMode==="hidden"&&!A.alternate&&!On)return ur(i),null}else 2*Rt()-f.renderingStartTime>Rh&&c!==536870912&&(i.flags|=128,E=!0,Fc(f,!1),i.lanes=4194304);f.isBackwards?(A.sibling=i.child,i.child=A):(n=f.last,n!==null?n.sibling=A:i.child=A,f.last=A)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=Rt(),n.sibling=null,c=Pr.current,pe(Pr,E?c&1|2:c&1),On&&pa(i,f.treeForkCount),n):(ur(i),null);case 22:case 23:return is(i),jf(),f=i.memoizedState!==null,n!==null?n.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(c&536870912)!==0&&(i.flags&128)===0&&(ur(i),i.subtreeFlags&6&&(i.flags|=8192)):ur(i),c=i.updateQueue,c!==null&&vh(i,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048),n!==null&&$($o),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),xa(Ur),ur(i),null;case 25:return null;case 30:return null}throw Error(o(156,i.tag))}function DA(n,i){switch(Cf(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return xa(Ur),kt(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return en(i),null;case 31:if(i.memoizedState!==null){if(is(i),i.alternate===null)throw Error(o(340));Qo()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(is(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(o(340));Qo()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return $(Pr),null;case 4:return kt(),null;case 10:return xa(i.type),null;case 22:case 23:return is(i),jf(),n!==null&&$($o),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return xa(Ur),null;case 25:return null;default:return null}}function Bp(n,i){switch(Cf(i),i.tag){case 3:xa(Ur),kt();break;case 26:case 27:case 5:en(i);break;case 4:kt();break;case 31:i.memoizedState!==null&&is(i);break;case 13:is(i);break;case 19:$(Pr);break;case 10:xa(i.type);break;case 22:case 23:is(i),jf(),n!==null&&$($o);break;case 24:xa(Ur)}}function jc(n,i){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var E=f.next;c=E;do{if((c.tag&n)===n){f=void 0;var A=c.create,O=c.inst;f=A(),O.destroy=f}c=c.next}while(c!==E)}}catch(V){Yn(i,i.return,V)}}function ao(n,i,c){try{var f=i.updateQueue,E=f!==null?f.lastEffect:null;if(E!==null){var A=E.next;f=A;do{if((f.tag&n)===n){var O=f.inst,V=O.destroy;if(V!==void 0){O.destroy=void 0,E=i;var W=c,ye=V;try{ye()}catch(Ne){Yn(E,W,Ne)}}}f=f.next}while(f!==A)}}catch(Ne){Yn(i,i.return,Ne)}}function Vp(n){var i=n.updateQueue;if(i!==null){var c=n.stateNode;try{Im(i,c)}catch(f){Yn(n,n.return,f)}}}function Up(n,i,c){c.props=il(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(f){Yn(n,i,f)}}function zc(n,i){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var f=n.stateNode;break;case 30:f=n.stateNode;break;default:f=n.stateNode}typeof c=="function"?n.refCleanup=c(f):c.current=f}}catch(E){Yn(n,i,E)}}function Gs(n,i){var c=n.ref,f=n.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(E){Yn(n,i,E)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(E){Yn(n,i,E)}else c.current=null}function Fp(n){var i=n.type,c=n.memoizedProps,f=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(E){Yn(n,n.return,E)}}function E0(n,i,c){try{var f=n.stateNode;eb(f,n.type,c,i),f[Ot]=i}catch(E){Yn(n,n.return,E)}}function jp(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&go(n.type)||n.tag===4}function w0(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||jp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&go(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function _0(n,i,c){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(n),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=pi));else if(f!==4&&(f===27&&go(n.type)&&(c=n.stateNode,i=null),n=n.child,n!==null))for(_0(n,i,c),n=n.sibling;n!==null;)_0(n,i,c),n=n.sibling}function Th(n,i,c){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?c.insertBefore(n,i):c.appendChild(n);else if(f!==4&&(f===27&&go(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(Th(n,i,c),n=n.sibling;n!==null;)Th(n,i,c),n=n.sibling}function zp(n){var i=n.stateNode,c=n.memoizedProps;try{for(var f=n.type,E=i.attributes;E.length;)i.removeAttributeNode(E[0]);li(i,f,c),i[gt]=n,i[Ot]=c}catch(A){Yn(n,n.return,A)}}var ba=!1,zr=!1,A0=!1,Hp=typeof WeakSet=="function"?WeakSet:Set,ti=null;function MA(n,i){if(n=n.containerInfo,H0=Xh,n=k(n),B(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else e:{c=(c=n.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var E=f.anchorOffset,A=f.focusNode;f=f.focusOffset;try{c.nodeType,A.nodeType}catch{c=null;break e}var O=0,V=-1,W=-1,ye=0,Ne=0,Be=n,xe=null;t:for(;;){for(var Ce;Be!==c||E!==0&&Be.nodeType!==3||(V=O+E),Be!==A||f!==0&&Be.nodeType!==3||(W=O+f),Be.nodeType===3&&(O+=Be.nodeValue.length),(Ce=Be.firstChild)!==null;)xe=Be,Be=Ce;for(;;){if(Be===n)break t;if(xe===c&&++ye===E&&(V=O),xe===A&&++Ne===f&&(W=O),(Ce=Be.nextSibling)!==null)break;Be=xe,xe=Be.parentNode}Be=Ce}c=V===-1||W===-1?null:{start:V,end:W}}else c=null}c=c||{start:0,end:0}}else c=null;for(G0={focusedElem:n,selectionRange:c},Xh=!1,ti=i;ti!==null;)if(i=ti,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,ti=n;else for(;ti!==null;){switch(i=ti,A=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(c=0;c<n.length;c++)E=n[c],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&A!==null){n=void 0,c=i,E=A.memoizedProps,A=A.memoizedState,f=c.stateNode;try{var At=il(c.type,E);n=f.getSnapshotBeforeUpdate(At,A),f.__reactInternalSnapshotBeforeUpdate=n}catch(jt){Yn(c,c.return,jt)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,c=n.nodeType,c===9)Y0(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Y0(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(o(163))}if(n=i.sibling,n!==null){n.return=i.return,ti=n;break}ti=i.return}}function Gp(n,i,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Ta(n,c),f&4&&jc(5,c);break;case 1:if(Ta(n,c),f&4)if(n=c.stateNode,i===null)try{n.componentDidMount()}catch(O){Yn(c,c.return,O)}else{var E=il(c.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(E,i,n.__reactInternalSnapshotBeforeUpdate)}catch(O){Yn(c,c.return,O)}}f&64&&Vp(c),f&512&&zc(c,c.return);break;case 3:if(Ta(n,c),f&64&&(n=c.updateQueue,n!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Im(n,i)}catch(O){Yn(c,c.return,O)}}break;case 27:i===null&&f&4&&zp(c);case 26:case 5:Ta(n,c),i===null&&f&4&&Fp(c),f&512&&zc(c,c.return);break;case 12:Ta(n,c);break;case 31:Ta(n,c),f&4&&Yp(n,c);break;case 13:Ta(n,c),f&4&&Kp(n,c),f&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=zA.bind(null,c),lb(n,c))));break;case 22:if(f=c.memoizedState!==null||ba,!f){i=i!==null&&i.memoizedState!==null||zr,E=ba;var A=zr;ba=f,(zr=i)&&!A?Ca(n,c,(c.subtreeFlags&8772)!==0):Ta(n,c),ba=E,zr=A}break;case 30:break;default:Ta(n,c)}}function qp(n){var i=n.alternate;i!==null&&(n.alternate=null,qp(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Yr(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var pr=null,ji=!1;function va(n,i,c){for(c=c.child;c!==null;)Xp(n,i,c),c=c.sibling}function Xp(n,i,c){if(ze&&typeof ze.onCommitFiberUnmount=="function")try{ze.onCommitFiberUnmount(tn,c)}catch{}switch(c.tag){case 26:zr||Gs(c,i),va(n,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:zr||Gs(c,i);var f=pr,E=ji;go(c.type)&&(pr=c.stateNode,ji=!1),va(n,i,c),Zc(c.stateNode),pr=f,ji=E;break;case 5:zr||Gs(c,i);case 6:if(f=pr,E=ji,pr=null,va(n,i,c),pr=f,ji=E,pr!==null)if(ji)try{(pr.nodeType===9?pr.body:pr.nodeName==="HTML"?pr.ownerDocument.body:pr).removeChild(c.stateNode)}catch(A){Yn(c,i,A)}else try{pr.removeChild(c.stateNode)}catch(A){Yn(c,i,A)}break;case 18:pr!==null&&(ji?(n=pr,Vy(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),Ql(n)):Vy(pr,c.stateNode));break;case 4:f=pr,E=ji,pr=c.stateNode.containerInfo,ji=!0,va(n,i,c),pr=f,ji=E;break;case 0:case 11:case 14:case 15:ao(2,c,i),zr||ao(4,c,i),va(n,i,c);break;case 1:zr||(Gs(c,i),f=c.stateNode,typeof f.componentWillUnmount=="function"&&Up(c,i,f)),va(n,i,c);break;case 21:va(n,i,c);break;case 22:zr=(f=zr)||c.memoizedState!==null,va(n,i,c),zr=f;break;default:va(n,i,c)}}function Yp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Ql(n)}catch(c){Yn(i,i.return,c)}}}function Kp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Ql(n)}catch(c){Yn(i,i.return,c)}}function kA(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new Hp),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new Hp),i;default:throw Error(o(435,n.tag))}}function Ch(n,i){var c=kA(n);i.forEach(function(f){if(!c.has(f)){c.add(f);var E=HA.bind(null,n,f);f.then(E,E)}})}function zi(n,i){var c=i.deletions;if(c!==null)for(var f=0;f<c.length;f++){var E=c[f],A=n,O=i,V=O;e:for(;V!==null;){switch(V.tag){case 27:if(go(V.type)){pr=V.stateNode,ji=!1;break e}break;case 5:pr=V.stateNode,ji=!1;break e;case 3:case 4:pr=V.stateNode.containerInfo,ji=!0;break e}V=V.return}if(pr===null)throw Error(o(160));Xp(A,O,E),pr=null,ji=!1,A=E.alternate,A!==null&&(A.return=null),E.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Wp(i,n),i=i.sibling}var Ns=null;function Wp(n,i){var c=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:zi(i,n),Hi(n),f&4&&(ao(3,n,n.return),jc(3,n),ao(5,n,n.return));break;case 1:zi(i,n),Hi(n),f&512&&(zr||c===null||Gs(c,c.return)),f&64&&ba&&(n=n.updateQueue,n!==null&&(f=n.callbacks,f!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var E=Ns;if(zi(i,n),Hi(n),f&512&&(zr||c===null||Gs(c,c.return)),f&4){var A=c!==null?c.memoizedState:null;if(f=n.memoizedState,c===null)if(f===null)if(n.stateNode===null){e:{f=n.type,c=n.memoizedProps,E=E.ownerDocument||E;t:switch(f){case"title":A=E.getElementsByTagName("title")[0],(!A||A[Li]||A[gt]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=E.createElement(f),E.head.insertBefore(A,E.querySelector("head > title"))),li(A,f,c),A[gt]=n,sr(A),f=A;break e;case"link":var O=Wy("link","href",E).get(f+(c.href||""));if(O){for(var V=0;V<O.length;V++)if(A=O[V],A.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&A.getAttribute("rel")===(c.rel==null?null:c.rel)&&A.getAttribute("title")===(c.title==null?null:c.title)&&A.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){O.splice(V,1);break t}}A=E.createElement(f),li(A,f,c),E.head.appendChild(A);break;case"meta":if(O=Wy("meta","content",E).get(f+(c.content||""))){for(V=0;V<O.length;V++)if(A=O[V],A.getAttribute("content")===(c.content==null?null:""+c.content)&&A.getAttribute("name")===(c.name==null?null:c.name)&&A.getAttribute("property")===(c.property==null?null:c.property)&&A.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&A.getAttribute("charset")===(c.charSet==null?null:c.charSet)){O.splice(V,1);break t}}A=E.createElement(f),li(A,f,c),E.head.appendChild(A);break;default:throw Error(o(468,f))}A[gt]=n,sr(A),f=A}n.stateNode=f}else Qy(E,n.type,n.stateNode);else n.stateNode=Ky(E,f,n.memoizedProps);else A!==f?(A===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):A.count--,f===null?Qy(E,n.type,n.stateNode):Ky(E,f,n.memoizedProps)):f===null&&n.stateNode!==null&&E0(n,n.memoizedProps,c.memoizedProps)}break;case 27:zi(i,n),Hi(n),f&512&&(zr||c===null||Gs(c,c.return)),c!==null&&f&4&&E0(n,n.memoizedProps,c.memoizedProps);break;case 5:if(zi(i,n),Hi(n),f&512&&(zr||c===null||Gs(c,c.return)),n.flags&32){E=n.stateNode;try{mi(E,"")}catch(At){Yn(n,n.return,At)}}f&4&&n.stateNode!=null&&(E=n.memoizedProps,E0(n,E,c!==null?c.memoizedProps:E)),f&1024&&(A0=!0);break;case 6:if(zi(i,n),Hi(n),f&4){if(n.stateNode===null)throw Error(o(162));f=n.memoizedProps,c=n.stateNode;try{c.nodeValue=f}catch(At){Yn(n,n.return,At)}}break;case 3:if(zh=null,E=Ns,Ns=Fh(i.containerInfo),zi(i,n),Ns=E,Hi(n),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Ql(i.containerInfo)}catch(At){Yn(n,n.return,At)}A0&&(A0=!1,Qp(n));break;case 4:f=Ns,Ns=Fh(n.stateNode.containerInfo),zi(i,n),Hi(n),Ns=f;break;case 12:zi(i,n),Hi(n);break;case 31:zi(i,n),Hi(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Ch(n,f)));break;case 13:zi(i,n),Hi(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Ih=Rt()),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Ch(n,f)));break;case 22:E=n.memoizedState!==null;var W=c!==null&&c.memoizedState!==null,ye=ba,Ne=zr;if(ba=ye||E,zr=Ne||W,zi(i,n),zr=Ne,ba=ye,Hi(n),f&8192)e:for(i=n.stateNode,i._visibility=E?i._visibility&-2:i._visibility|1,E&&(c===null||W||ba||zr||sl(n)),c=null,i=n;;){if(i.tag===5||i.tag===26){if(c===null){W=c=i;try{if(A=W.stateNode,E)O=A.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{V=W.stateNode;var Be=W.memoizedProps.style,xe=Be!=null&&Be.hasOwnProperty("display")?Be.display:null;V.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch(At){Yn(W,W.return,At)}}}else if(i.tag===6){if(c===null){W=i;try{W.stateNode.nodeValue=E?"":W.memoizedProps}catch(At){Yn(W,W.return,At)}}}else if(i.tag===18){if(c===null){W=i;try{var Ce=W.stateNode;E?Uy(Ce,!0):Uy(W.stateNode,!1)}catch(At){Yn(W,W.return,At)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=n.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Ch(n,c))));break;case 19:zi(i,n),Hi(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Ch(n,f)));break;case 30:break;case 21:break;default:zi(i,n),Hi(n)}}function Hi(n){var i=n.flags;if(i&2){try{for(var c,f=n.return;f!==null;){if(jp(f)){c=f;break}f=f.return}if(c==null)throw Error(o(160));switch(c.tag){case 27:var E=c.stateNode,A=w0(n);Th(n,A,E);break;case 5:var O=c.stateNode;c.flags&32&&(mi(O,""),c.flags&=-33);var V=w0(n);Th(n,V,O);break;case 3:case 4:var W=c.stateNode.containerInfo,ye=w0(n);_0(n,ye,W);break;default:throw Error(o(161))}}catch(Ne){Yn(n,n.return,Ne)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Qp(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;Qp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function Ta(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Gp(n,i.alternate,i),i=i.sibling}function sl(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:ao(4,i,i.return),sl(i);break;case 1:Gs(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&Up(i,i.return,c),sl(i);break;case 27:Zc(i.stateNode);case 26:case 5:Gs(i,i.return),sl(i);break;case 22:i.memoizedState===null&&sl(i);break;case 30:sl(i);break;default:sl(i)}n=n.sibling}}function Ca(n,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,E=n,A=i,O=A.flags;switch(A.tag){case 0:case 11:case 15:Ca(E,A,c),jc(4,A);break;case 1:if(Ca(E,A,c),f=A,E=f.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(ye){Yn(f,f.return,ye)}if(f=A,E=f.updateQueue,E!==null){var V=f.stateNode;try{var W=E.shared.hiddenCallbacks;if(W!==null)for(E.shared.hiddenCallbacks=null,E=0;E<W.length;E++)Sm(W[E],V)}catch(ye){Yn(f,f.return,ye)}}c&&O&64&&Vp(A),zc(A,A.return);break;case 27:zp(A);case 26:case 5:Ca(E,A,c),c&&f===null&&O&4&&Fp(A),zc(A,A.return);break;case 12:Ca(E,A,c);break;case 31:Ca(E,A,c),c&&O&4&&Yp(E,A);break;case 13:Ca(E,A,c),c&&O&4&&Kp(E,A);break;case 22:A.memoizedState===null&&Ca(E,A,c),zc(A,A.return);break;case 30:break;default:Ca(E,A,c)}i=i.sibling}}function b0(n,i){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&Ic(c))}function v0(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Ic(n))}function Os(n,i,c,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Zp(n,i,c,f),i=i.sibling}function Zp(n,i,c,f){var E=i.flags;switch(i.tag){case 0:case 11:case 15:Os(n,i,c,f),E&2048&&jc(9,i);break;case 1:Os(n,i,c,f);break;case 3:Os(n,i,c,f),E&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Ic(n)));break;case 12:if(E&2048){Os(n,i,c,f),n=i.stateNode;try{var A=i.memoizedProps,O=A.id,V=A.onPostCommit;typeof V=="function"&&V(O,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(W){Yn(i,i.return,W)}}else Os(n,i,c,f);break;case 31:Os(n,i,c,f);break;case 13:Os(n,i,c,f);break;case 23:break;case 22:A=i.stateNode,O=i.alternate,i.memoizedState!==null?A._visibility&2?Os(n,i,c,f):Hc(n,i):A._visibility&2?Os(n,i,c,f):(A._visibility|=2,Ul(n,i,c,f,(i.subtreeFlags&10256)!==0||!1)),E&2048&&b0(O,i);break;case 24:Os(n,i,c,f),E&2048&&v0(i.alternate,i);break;default:Os(n,i,c,f)}}function Ul(n,i,c,f,E){for(E=E&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var A=n,O=i,V=c,W=f,ye=O.flags;switch(O.tag){case 0:case 11:case 15:Ul(A,O,V,W,E),jc(8,O);break;case 23:break;case 22:var Ne=O.stateNode;O.memoizedState!==null?Ne._visibility&2?Ul(A,O,V,W,E):Hc(A,O):(Ne._visibility|=2,Ul(A,O,V,W,E)),E&&ye&2048&&b0(O.alternate,O);break;case 24:Ul(A,O,V,W,E),E&&ye&2048&&v0(O.alternate,O);break;default:Ul(A,O,V,W,E)}i=i.sibling}}function Hc(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=n,f=i,E=f.flags;switch(f.tag){case 22:Hc(c,f),E&2048&&b0(f.alternate,f);break;case 24:Hc(c,f),E&2048&&v0(f.alternate,f);break;default:Hc(c,f)}i=i.sibling}}var Gc=8192;function Fl(n,i,c){if(n.subtreeFlags&Gc)for(n=n.child;n!==null;)Jp(n,i,c),n=n.sibling}function Jp(n,i,c){switch(n.tag){case 26:Fl(n,i,c),n.flags&Gc&&n.memoizedState!==null&&wb(c,Ns,n.memoizedState,n.memoizedProps);break;case 5:Fl(n,i,c);break;case 3:case 4:var f=Ns;Ns=Fh(n.stateNode.containerInfo),Fl(n,i,c),Ns=f;break;case 22:n.memoizedState===null&&(f=n.alternate,f!==null&&f.memoizedState!==null?(f=Gc,Gc=16777216,Fl(n,i,c),Gc=f):Fl(n,i,c));break;default:Fl(n,i,c)}}function $p(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function qc(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];ti=f,ty(f,n)}$p(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)ey(n),n=n.sibling}function ey(n){switch(n.tag){case 0:case 11:case 15:qc(n),n.flags&2048&&ao(9,n,n.return);break;case 3:qc(n);break;case 12:qc(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,Sh(n)):qc(n);break;default:qc(n)}}function Sh(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];ti=f,ty(f,n)}$p(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:ao(8,i,i.return),Sh(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Sh(i));break;default:Sh(i)}n=n.sibling}}function ty(n,i){for(;ti!==null;){var c=ti;switch(c.tag){case 0:case 11:case 15:ao(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ic(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,ti=f;else e:for(c=n;ti!==null;){f=ti;var E=f.sibling,A=f.return;if(qp(f),f===c){ti=null;break e}if(E!==null){E.return=A,ti=E;break e}ti=A}}}var LA={getCacheForType:function(n){var i=ai(Ur),c=i.data.get(n);return c===void 0&&(c=n(),i.data.set(n,c)),c},cacheSignal:function(){return ai(Ur).controller.signal}},PA=typeof WeakMap=="function"?WeakMap:Map,Un=0,rr=null,pn=null,bn=0,Xn=0,ss=null,oo=!1,jl=!1,T0=!1,Sa=0,Rr=0,lo=0,al=0,C0=0,as=0,zl=0,Xc=null,Gi=null,S0=!1,Ih=0,ny=0,Rh=1/0,Nh=null,co=null,Wr=0,uo=null,Hl=null,Ia=0,I0=0,R0=null,ry=null,Yc=0,N0=null;function os(){return(Un&2)!==0&&bn!==0?bn&-bn:ue.T!==null?P0():Vt()}function iy(){if(as===0)if((bn&536870912)===0||On){var n=Bt;Bt<<=1,(Bt&3932160)===0&&(Bt=262144),as=n}else as=536870912;return n=rs.current,n!==null&&(n.flags|=32),as}function qi(n,i,c){(n===rr&&(Xn===2||Xn===9)||n.cancelPendingCommit!==null)&&(Gl(n,0),ho(n,bn,as,!1)),He(n,c),((Un&2)===0||n!==rr)&&(n===rr&&((Un&2)===0&&(al|=c),Rr===4&&ho(n,bn,as,!1)),qs(n))}function sy(n,i,c){if((Un&6)!==0)throw Error(o(327));var f=!c&&(i&127)===0&&(i&n.expiredLanes)===0||ut(n,i),E=f?UA(n,i):D0(n,i,!0),A=f;do{if(E===0){jl&&!f&&ho(n,i,0,!1);break}else{if(c=n.current.alternate,A&&!BA(c)){E=D0(n,i,!1),A=!1;continue}if(E===2){if(A=i,n.errorRecoveryDisabledLanes&A)var O=0;else O=n.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){i=O;e:{var V=n;E=Xc;var W=V.current.memoizedState.isDehydrated;if(W&&(Gl(V,O).flags|=256),O=D0(V,O,!1),O!==2){if(T0&&!W){V.errorRecoveryDisabledLanes|=A,al|=A,E=4;break e}A=Gi,Gi=E,A!==null&&(Gi===null?Gi=A:Gi.push.apply(Gi,A))}E=O}if(A=!1,E!==2)continue}}if(E===1){Gl(n,0),ho(n,i,0,!0);break}e:{switch(f=n,A=E,A){case 0:case 1:throw Error(o(345));case 4:if((i&4194048)!==i)break;case 6:ho(f,i,as,!oo);break e;case 2:Gi=null;break;case 3:case 5:break;default:throw Error(o(329))}if((i&62914560)===i&&(E=Ih+300-Rt(),10<E)){if(ho(f,i,as,!oo),Mr(f,0,!0)!==0)break e;Ia=i,f.timeoutHandle=Py(ay.bind(null,f,c,Gi,Nh,S0,i,as,al,zl,oo,A,"Throttled",-0,0),E);break e}ay(f,c,Gi,Nh,S0,i,as,al,zl,oo,A,null,-0,0)}}break}while(!0);qs(n)}function ay(n,i,c,f,E,A,O,V,W,ye,Ne,Be,xe,Ce){if(n.timeoutHandle=-1,Be=i.subtreeFlags,Be&8192||(Be&16785408)===16785408){Be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pi},Jp(i,A,Be);var At=(A&62914560)===A?Ih-Rt():(A&4194048)===A?ny-Rt():0;if(At=_b(Be,At),At!==null){Ia=A,n.cancelPendingCommit=At(gy.bind(null,n,i,A,c,f,E,O,V,W,Ne,Be,null,xe,Ce)),ho(n,A,O,!ye);return}}gy(n,i,A,c,f,E,O,V,W)}function BA(n){for(var i=n;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var E=c[f],A=E.getSnapshot;E=E.value;try{if(!m(A(),E))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ho(n,i,c,f){i&=~C0,i&=~al,n.suspendedLanes|=i,n.pingedLanes&=~i,f&&(n.warmLanes|=i),f=n.expirationTimes;for(var E=i;0<E;){var A=31-wt(E),O=1<<A;f[A]=-1,E&=~O}c!==0&&rt(n,c,i)}function Oh(){return(Un&6)===0?(Kc(0),!1):!0}function O0(){if(pn!==null){if(Xn===0)var n=pn.return;else n=pn,ya=Zo=null,Yf(n),kl=null,Nc=0,n=pn;for(;n!==null;)Bp(n.alternate,n),n=n.return;pn=null}}function Gl(n,i){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,rb(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),Ia=0,O0(),rr=n,pn=c=ma(n.current,null),bn=i,Xn=0,ss=null,oo=!1,jl=ut(n,i),T0=!1,zl=as=C0=al=lo=Rr=0,Gi=Xc=null,S0=!1,(i&8)!==0&&(i|=i&32);var f=n.entangledLanes;if(f!==0)for(n=n.entanglements,f&=i;0<f;){var E=31-wt(f),A=1<<E;i|=n[E],f&=~A}return Sa=i,Ju(),c}function oy(n,i){rn=null,ue.H=Vc,i===Ml||i===ah?(i=bm(),Xn=3):i===Lf?(i=bm(),Xn=4):Xn=i===c0?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ss=i,pn===null&&(Rr=1,wh(n,xs(i,n.current)))}function ly(){var n=rs.current;return n===null?!0:(bn&4194048)===bn?As===null:(bn&62914560)===bn||(bn&536870912)!==0?n===As:!1}function cy(){var n=ue.H;return ue.H=Vc,n===null?Vc:n}function uy(){var n=ue.A;return ue.A=LA,n}function Dh(){Rr=4,oo||(bn&4194048)!==bn&&rs.current!==null||(jl=!0),(lo&134217727)===0&&(al&134217727)===0||rr===null||ho(rr,bn,as,!1)}function D0(n,i,c){var f=Un;Un|=2;var E=cy(),A=uy();(rr!==n||bn!==i)&&(Nh=null,Gl(n,i)),i=!1;var O=Rr;e:do try{if(Xn!==0&&pn!==null){var V=pn,W=ss;switch(Xn){case 8:O0(),O=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(i=!0);var ye=Xn;if(Xn=0,ss=null,ql(n,V,W,ye),c&&jl){O=0;break e}break;default:ye=Xn,Xn=0,ss=null,ql(n,V,W,ye)}}VA(),O=Rr;break}catch(Ne){oy(n,Ne)}while(!0);return i&&n.shellSuspendCounter++,ya=Zo=null,Un=f,ue.H=E,ue.A=A,pn===null&&(rr=null,bn=0,Ju()),O}function VA(){for(;pn!==null;)hy(pn)}function UA(n,i){var c=Un;Un|=2;var f=cy(),E=uy();rr!==n||bn!==i?(Nh=null,Rh=Rt()+500,Gl(n,i)):jl=ut(n,i);e:do try{if(Xn!==0&&pn!==null){i=pn;var A=ss;t:switch(Xn){case 1:Xn=0,ss=null,ql(n,i,A,1);break;case 2:case 9:if(_m(A)){Xn=0,ss=null,dy(i);break}i=function(){Xn!==2&&Xn!==9||rr!==n||(Xn=7),qs(n)},A.then(i,i);break e;case 3:Xn=7;break e;case 4:Xn=5;break e;case 7:_m(A)?(Xn=0,ss=null,dy(i)):(Xn=0,ss=null,ql(n,i,A,7));break;case 5:var O=null;switch(pn.tag){case 26:O=pn.memoizedState;case 5:case 27:var V=pn;if(O?Zy(O):V.stateNode.complete){Xn=0,ss=null;var W=V.sibling;if(W!==null)pn=W;else{var ye=V.return;ye!==null?(pn=ye,Mh(ye)):pn=null}break t}}Xn=0,ss=null,ql(n,i,A,5);break;case 6:Xn=0,ss=null,ql(n,i,A,6);break;case 8:O0(),Rr=6;break e;default:throw Error(o(462))}}FA();break}catch(Ne){oy(n,Ne)}while(!0);return ya=Zo=null,ue.H=f,ue.A=E,Un=c,pn!==null?0:(rr=null,bn=0,Ju(),Rr)}function FA(){for(;pn!==null&&!Pt();)hy(pn)}function hy(n){var i=Lp(n.alternate,n,Sa);n.memoizedProps=n.pendingProps,i===null?Mh(n):pn=i}function dy(n){var i=n,c=i.alternate;switch(i.tag){case 15:case 0:i=Rp(c,i,i.pendingProps,i.type,void 0,bn);break;case 11:i=Rp(c,i,i.pendingProps,i.type.render,i.ref,bn);break;case 5:Yf(i);default:Bp(c,i),i=pn=um(i,Sa),i=Lp(c,i,Sa)}n.memoizedProps=n.pendingProps,i===null?Mh(n):pn=i}function ql(n,i,c,f){ya=Zo=null,Yf(i),kl=null,Nc=0;var E=i.return;try{if(IA(n,E,i,c,bn)){Rr=1,wh(n,xs(c,n.current)),pn=null;return}}catch(A){if(E!==null)throw pn=E,A;Rr=1,wh(n,xs(c,n.current)),pn=null;return}i.flags&32768?(On||f===1?n=!0:jl||(bn&536870912)!==0?n=!1:(oo=n=!0,(f===2||f===9||f===3||f===6)&&(f=rs.current,f!==null&&f.tag===13&&(f.flags|=16384))),fy(i,n)):Mh(i)}function Mh(n){var i=n;do{if((i.flags&32768)!==0){fy(i,oo);return}n=i.return;var c=OA(i.alternate,i,Sa);if(c!==null){pn=c;return}if(i=i.sibling,i!==null){pn=i;return}pn=i=n}while(i!==null);Rr===0&&(Rr=5)}function fy(n,i){do{var c=DA(n.alternate,n);if(c!==null){c.flags&=32767,pn=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(n=n.sibling,n!==null)){pn=n;return}pn=n=c}while(n!==null);Rr=6,pn=null}function gy(n,i,c,f,E,A,O,V,W){n.cancelPendingCommit=null;do kh();while(Wr!==0);if((Un&6)!==0)throw Error(o(327));if(i!==null){if(i===n.current)throw Error(o(177));if(A=i.lanes|i.childLanes,A|=wf,Xe(n,c,A,O,V,W),n===rr&&(pn=rr=null,bn=0),Hl=i,uo=n,Ia=c,I0=A,R0=E,ry=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,GA(xr,function(){return Ey(),null})):(n.callbackNode=null,n.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=ue.T,ue.T=null,E=Ee.p,Ee.p=2,O=Un,Un|=4;try{MA(n,i,c)}finally{Un=O,Ee.p=E,ue.T=f}}Wr=1,my(),py(),yy()}}function my(){if(Wr===1){Wr=0;var n=uo,i=Hl,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=ue.T,ue.T=null;var f=Ee.p;Ee.p=2;var E=Un;Un|=4;try{Wp(i,n);var A=G0,O=k(n.containerInfo),V=A.focusedElem,W=A.selectionRange;if(O!==V&&V&&V.ownerDocument&&N(V.ownerDocument.documentElement,V)){if(W!==null&&B(V)){var ye=W.start,Ne=W.end;if(Ne===void 0&&(Ne=ye),"selectionStart"in V)V.selectionStart=ye,V.selectionEnd=Math.min(Ne,V.value.length);else{var Be=V.ownerDocument||document,xe=Be&&Be.defaultView||window;if(xe.getSelection){var Ce=xe.getSelection(),At=V.textContent.length,jt=Math.min(W.start,At),Jn=W.end===void 0?jt:Math.min(W.end,At);!Ce.extend&&jt>Jn&&(O=Jn,Jn=jt,jt=O);var ae=v(V,jt),ne=v(V,Jn);if(ae&&ne&&(Ce.rangeCount!==1||Ce.anchorNode!==ae.node||Ce.anchorOffset!==ae.offset||Ce.focusNode!==ne.node||Ce.focusOffset!==ne.offset)){var me=Be.createRange();me.setStart(ae.node,ae.offset),Ce.removeAllRanges(),jt>Jn?(Ce.addRange(me),Ce.extend(ne.node,ne.offset)):(me.setEnd(ne.node,ne.offset),Ce.addRange(me))}}}}for(Be=[],Ce=V;Ce=Ce.parentNode;)Ce.nodeType===1&&Be.push({element:Ce,left:Ce.scrollLeft,top:Ce.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<Be.length;V++){var Pe=Be[V];Pe.element.scrollLeft=Pe.left,Pe.element.scrollTop=Pe.top}}Xh=!!H0,G0=H0=null}finally{Un=E,Ee.p=f,ue.T=c}}n.current=i,Wr=2}}function py(){if(Wr===2){Wr=0;var n=uo,i=Hl,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=ue.T,ue.T=null;var f=Ee.p;Ee.p=2;var E=Un;Un|=4;try{Gp(n,i.alternate,i)}finally{Un=E,Ee.p=f,ue.T=c}}Wr=3}}function yy(){if(Wr===4||Wr===3){Wr=0,vt();var n=uo,i=Hl,c=Ia,f=ry;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Wr=5:(Wr=0,Hl=uo=null,xy(n,n.pendingLanes));var E=n.pendingLanes;if(E===0&&(co=null),St(c),i=i.stateNode,ze&&typeof ze.onCommitFiberRoot=="function")try{ze.onCommitFiberRoot(tn,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=ue.T,E=Ee.p,Ee.p=2,ue.T=null;try{for(var A=n.onRecoverableError,O=0;O<f.length;O++){var V=f[O];A(V.value,{componentStack:V.stack})}}finally{ue.T=i,Ee.p=E}}(Ia&3)!==0&&kh(),qs(n),E=n.pendingLanes,(c&261930)!==0&&(E&42)!==0?n===N0?Yc++:(Yc=0,N0=n):Yc=0,Kc(0)}}function xy(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Ic(i)))}function kh(){return my(),py(),yy(),Ey()}function Ey(){if(Wr!==5)return!1;var n=uo,i=I0;I0=0;var c=St(Ia),f=ue.T,E=Ee.p;try{Ee.p=32>c?32:c,ue.T=null,c=R0,R0=null;var A=uo,O=Ia;if(Wr=0,Hl=uo=null,Ia=0,(Un&6)!==0)throw Error(o(331));var V=Un;if(Un|=4,ey(A.current),Zp(A,A.current,O,c),Un=V,Kc(0,!1),ze&&typeof ze.onPostCommitFiberRoot=="function")try{ze.onPostCommitFiberRoot(tn,A)}catch{}return!0}finally{Ee.p=E,ue.T=f,xy(n,i)}}function wy(n,i,c){i=xs(c,i),i=l0(n.stateNode,i,2),n=ro(n,i,2),n!==null&&(He(n,2),qs(n))}function Yn(n,i,c){if(n.tag===3)wy(n,n,c);else for(;i!==null;){if(i.tag===3){wy(i,n,c);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(co===null||!co.has(f))){n=xs(c,n),c=_p(2),f=ro(i,c,2),f!==null&&(Ap(c,f,i,n),He(f,2),qs(f));break}}i=i.return}}function M0(n,i,c){var f=n.pingCache;if(f===null){f=n.pingCache=new PA;var E=new Set;f.set(i,E)}else E=f.get(i),E===void 0&&(E=new Set,f.set(i,E));E.has(c)||(T0=!0,E.add(c),n=jA.bind(null,n,i,c),i.then(n,n))}function jA(n,i,c){var f=n.pingCache;f!==null&&f.delete(i),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,rr===n&&(bn&c)===c&&(Rr===4||Rr===3&&(bn&62914560)===bn&&300>Rt()-Ih?(Un&2)===0&&Gl(n,0):C0|=c,zl===bn&&(zl=0)),qs(n)}function _y(n,i){i===0&&(i=ie()),n=Ko(n,i),n!==null&&(He(n,i),qs(n))}function zA(n){var i=n.memoizedState,c=0;i!==null&&(c=i.retryLane),_y(n,c)}function HA(n,i){var c=0;switch(n.tag){case 31:case 13:var f=n.stateNode,E=n.memoizedState;E!==null&&(c=E.retryLane);break;case 19:f=n.stateNode;break;case 22:f=n.stateNode._retryCache;break;default:throw Error(o(314))}f!==null&&f.delete(i),_y(n,c)}function GA(n,i){return ke(n,i)}var Lh=null,Xl=null,k0=!1,Ph=!1,L0=!1,fo=0;function qs(n){n!==Xl&&n.next===null&&(Xl===null?Lh=Xl=n:Xl=Xl.next=n),Ph=!0,k0||(k0=!0,XA())}function Kc(n,i){if(!L0&&Ph){L0=!0;do for(var c=!1,f=Lh;f!==null;){if(n!==0){var E=f.pendingLanes;if(E===0)var A=0;else{var O=f.suspendedLanes,V=f.pingedLanes;A=(1<<31-wt(42|n)+1)-1,A&=E&~(O&~V),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(c=!0,Ty(f,A))}else A=bn,A=Mr(f,f===rr?A:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(A&3)===0||ut(f,A)||(c=!0,Ty(f,A));f=f.next}while(c);L0=!1}}function qA(){Ay()}function Ay(){Ph=k0=!1;var n=0;fo!==0&&nb()&&(n=fo);for(var i=Rt(),c=null,f=Lh;f!==null;){var E=f.next,A=by(f,i);A===0?(f.next=null,c===null?Lh=E:c.next=E,E===null&&(Xl=c)):(c=f,(n!==0||(A&3)!==0)&&(Ph=!0)),f=E}Wr!==0&&Wr!==5||Kc(n),fo!==0&&(fo=0)}function by(n,i){for(var c=n.suspendedLanes,f=n.pingedLanes,E=n.expirationTimes,A=n.pendingLanes&-62914561;0<A;){var O=31-wt(A),V=1<<O,W=E[O];W===-1?((V&c)===0||(V&f)!==0)&&(E[O]=nn(V,i)):W<=i&&(n.expiredLanes|=V),A&=~V}if(i=rr,c=bn,c=Mr(n,n===i?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f=n.callbackNode,c===0||n===i&&(Xn===2||Xn===9)||n.cancelPendingCommit!==null)return f!==null&&f!==null&&be(f),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||ut(n,c)){if(i=c&-c,i===n.callbackPriority)return i;switch(f!==null&&be(f),St(c)){case 2:case 8:c=yr;break;case 32:c=xr;break;case 268435456:c=Zr;break;default:c=xr}return f=vy.bind(null,n),c=ke(c,f),n.callbackPriority=i,n.callbackNode=c,i}return f!==null&&f!==null&&be(f),n.callbackPriority=2,n.callbackNode=null,2}function vy(n,i){if(Wr!==0&&Wr!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if(kh()&&n.callbackNode!==c)return null;var f=bn;return f=Mr(n,n===rr?f:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f===0?null:(sy(n,f,i),by(n,Rt()),n.callbackNode!=null&&n.callbackNode===c?vy.bind(null,n):null)}function Ty(n,i){if(kh())return null;sy(n,i,!0)}function XA(){ib(function(){(Un&6)!==0?ke(Xt,qA):Ay()})}function P0(){if(fo===0){var n=Ol;n===0&&(n=Tr,Tr<<=1,(Tr&261888)===0&&(Tr=256)),fo=n}return fo}function Cy(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Vs(""+n)}function Sy(n,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,n.id&&c.setAttribute("form",n.id),i.parentNode.insertBefore(c,i),n=new FormData(n),c.parentNode.removeChild(c),n}function YA(n,i,c,f,E){if(i==="submit"&&c&&c.stateNode===E){var A=Cy((E[Ot]||null).action),O=f.submitter;O&&(i=(i=O[Ot]||null)?Cy(i.formAction):O.getAttribute("formAction"),i!==null&&(A=i,O=null));var V=new lr("action","action",null,f,E);n.push({event:V,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(fo!==0){var W=O?Sy(E,O):new FormData(E);n0(c,{pending:!0,data:W,method:E.method,action:A},null,W)}}else typeof A=="function"&&(V.preventDefault(),W=O?Sy(E,O):new FormData(E),n0(c,{pending:!0,data:W,method:E.method,action:A},A,W))},currentTarget:E}]})}}for(var B0=0;B0<Tc.length;B0++){var V0=Tc[B0],KA=V0.toLowerCase(),WA=V0[0].toUpperCase()+V0.slice(1);Rs(KA,"on"+WA)}Rs(Fi,"onAnimationEnd"),Rs(ii,"onAnimationIteration"),Rs(Gn,"onAnimationStart"),Rs("dblclick","onDoubleClick"),Rs("focusin","onFocus"),Rs("focusout","onBlur"),Rs(Kr,"onTransitionRun"),Rs(Ni,"onTransitionStart"),Rs(Qa,"onTransitionCancel"),Rs(ga,"onTransitionEnd"),$e("onMouseEnter",["mouseout","mouseover"]),$e("onMouseLeave",["mouseout","mouseover"]),$e("onPointerEnter",["pointerout","pointerover"]),$e("onPointerLeave",["pointerout","pointerover"]),Se("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Se("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Se("onBeforeInput",["compositionend","keypress","textInput","paste"]),Se("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wc));function Iy(n,i){i=(i&4)!==0;for(var c=0;c<n.length;c++){var f=n[c],E=f.event;f=f.listeners;e:{var A=void 0;if(i)for(var O=f.length-1;0<=O;O--){var V=f[O],W=V.instance,ye=V.currentTarget;if(V=V.listener,W!==A&&E.isPropagationStopped())break e;A=V,E.currentTarget=ye;try{A(E)}catch(Ne){Zu(Ne)}E.currentTarget=null,A=W}else for(O=0;O<f.length;O++){if(V=f[O],W=V.instance,ye=V.currentTarget,V=V.listener,W!==A&&E.isPropagationStopped())break e;A=V,E.currentTarget=ye;try{A(E)}catch(Ne){Zu(Ne)}E.currentTarget=null,A=W}}}}function yn(n,i){var c=i[fi];c===void 0&&(c=i[fi]=new Set);var f=n+"__bubble";c.has(f)||(Ry(i,n,2,!1),c.add(f))}function U0(n,i,c){var f=0;i&&(f|=4),Ry(c,n,f,i)}var Bh="_reactListening"+Math.random().toString(36).slice(2);function F0(n){if(!n[Bh]){n[Bh]=!0,Ve.forEach(function(c){c!=="selectionchange"&&(QA.has(c)||U0(c,!1,n),U0(c,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Bh]||(i[Bh]=!0,U0("selectionchange",!1,i))}}function Ry(n,i,c,f){switch(i2(i)){case 2:var E=vb;break;case 8:E=Tb;break;default:E=t1}c=E.bind(null,i,c,n),E=void 0,!sa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(E=!0),f?E!==void 0?n.addEventListener(i,c,{capture:!0,passive:E}):n.addEventListener(i,c,!0):E!==void 0?n.addEventListener(i,c,{passive:E}):n.addEventListener(i,c,!1)}function j0(n,i,c,f,E){var A=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var O=f.tag;if(O===3||O===4){var V=f.stateNode.containerInfo;if(V===E)break;if(O===4)for(O=f.return;O!==null;){var W=O.tag;if((W===3||W===4)&&O.stateNode.containerInfo===E)return;O=O.return}for(;V!==null;){if(O=Wn(V),O===null)return;if(W=O.tag,W===5||W===6||W===26||W===27){f=A=O;continue e}V=V.parentNode}}f=f.return}Us(function(){var ye=A,Ne=Bi(c),Be=[];e:{var xe=Qu.get(n);if(xe!==void 0){var Ce=lr,At=n;switch(n){case"keypress":if(Ji(c)===0)break e;case"keydown":case"keyup":Ce=ua;break;case"focusin":At="focus",Ce=la;break;case"focusout":At="blur",Ce=la;break;case"beforeblur":case"afterblur":Ce=la;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=Dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=oa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=S;break;case Fi:case ii:case Gn:Ce=Zt;break;case ga:Ce=j;break;case"scroll":case"scrollend":Ce=qa;break;case"wheel":Ce=Ae;break;case"copy":case"cut":case"paste":Ce=ca;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=mn;break;case"toggle":case"beforetoggle":Ce=Yt}var jt=(i&4)!==0,Jn=!jt&&(n==="scroll"||n==="scrollend"),ae=jt?xe!==null?xe+"Capture":null:xe;jt=[];for(var ne=ye,me;ne!==null;){var Pe=ne;if(me=Pe.stateNode,Pe=Pe.tag,Pe!==5&&Pe!==26&&Pe!==27||me===null||ae===null||(Pe=Ut(ne,ae),Pe!=null&&jt.push(Qc(ne,Pe,me))),Jn)break;ne=ne.return}0<jt.length&&(xe=new Ce(xe,At,null,c,Ne),Be.push({event:xe,listeners:jt}))}}if((i&7)===0){e:{if(xe=n==="mouseover"||n==="pointerover",Ce=n==="mouseout"||n==="pointerout",xe&&c!==ia&&(At=c.relatedTarget||c.fromElement)&&(Wn(At)||At[$n]))break e;if((Ce||xe)&&(xe=Ne.window===Ne?Ne:(xe=Ne.ownerDocument)?xe.defaultView||xe.parentWindow:window,Ce?(At=c.relatedTarget||c.toElement,Ce=ye,At=At?Wn(At):null,At!==null&&(Jn=g(At),jt=At.tag,At!==Jn||jt!==5&&jt!==27&&jt!==6)&&(At=null)):(Ce=null,At=ye),Ce!==At)){if(jt=Dn,Pe="onMouseLeave",ae="onMouseEnter",ne="mouse",(n==="pointerout"||n==="pointerover")&&(jt=mn,Pe="onPointerLeave",ae="onPointerEnter",ne="pointer"),Jn=Ce==null?xe:Jr(Ce),me=At==null?xe:Jr(At),xe=new jt(Pe,ne+"leave",Ce,c,Ne),xe.target=Jn,xe.relatedTarget=me,Pe=null,Wn(Ne)===ye&&(jt=new jt(ae,ne+"enter",At,c,Ne),jt.target=me,jt.relatedTarget=Jn,Pe=jt),Jn=Pe,Ce&&At)t:{for(jt=ZA,ae=Ce,ne=At,me=0,Pe=ae;Pe;Pe=jt(Pe))me++;Pe=0;for(var Dt=ne;Dt;Dt=jt(Dt))Pe++;for(;0<me-Pe;)ae=jt(ae),me--;for(;0<Pe-me;)ne=jt(ne),Pe--;for(;me--;){if(ae===ne||ne!==null&&ae===ne.alternate){jt=ae;break t}ae=jt(ae),ne=jt(ne)}jt=null}else jt=null;Ce!==null&&Ny(Be,xe,Ce,jt,!1),At!==null&&Jn!==null&&Ny(Be,Jn,At,jt,!0)}}e:{if(xe=ye?Jr(ye):window,Ce=xe.nodeName&&xe.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&xe.type==="file")var Pn=ts;else if(vc(xe))if(Wu)Pn=h;else{Pn=a;var bt=r}else Ce=xe.nodeName,!Ce||Ce.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?ye&&zn(ye.elementType)&&(Pn=ts):Pn=l;if(Pn&&(Pn=Pn(n,ye))){es(Be,Pn,c,Ne);break e}bt&&bt(n,xe,ye),n==="focusout"&&ye&&xe.type==="number"&&ye.memoizedProps.value!=null&&H(xe,"number",xe.value)}switch(bt=ye?Jr(ye):window,n){case"focusin":(vc(bt)||bt.contentEditable==="true")&&(Z=bt,te=ye,de=null);break;case"focusout":de=te=Z=null;break;case"mousedown":_e=!0;break;case"contextmenu":case"mouseup":case"dragend":_e=!1,Je(Be,c,Ne);break;case"selectionchange":if(q)break;case"keydown":case"keyup":Je(Be,c,Ne)}var on;if(Nn)e:{switch(n){case"compositionstart":var vn="onCompositionStart";break e;case"compositionend":vn="onCompositionEnd";break e;case"compositionupdate":vn="onCompositionUpdate";break e}vn=void 0}else Wa?ha(n,c)&&(vn="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(vn="onCompositionStart");vn&&(ms&&c.locale!=="ko"&&(Wa||vn!=="onCompositionStart"?vn==="onCompositionEnd"&&Wa&&(on=Cs()):(Qi=Ne,Zi="value"in Qi?Qi.value:Qi.textContent,Wa=!0)),bt=Vh(ye,vn),0<bt.length&&(vn=new ds(vn,n,null,c,Ne),Be.push({event:vn,listeners:bt}),on?vn.data=on:(on=ps(c),on!==null&&(vn.data=on)))),(on=Ii?js(n,c):vl(n,c))&&(vn=Vh(ye,"onBeforeInput"),0<vn.length&&(bt=new ds("onBeforeInput","beforeinput",null,c,Ne),Be.push({event:bt,listeners:vn}),bt.data=on)),YA(Be,n,ye,c,Ne)}Iy(Be,i)})}function Qc(n,i,c){return{instance:n,listener:i,currentTarget:c}}function Vh(n,i){for(var c=i+"Capture",f=[];n!==null;){var E=n,A=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||A===null||(E=Ut(n,c),E!=null&&f.unshift(Qc(n,E,A)),E=Ut(n,i),E!=null&&f.push(Qc(n,E,A))),n.tag===3)return f;n=n.return}return[]}function ZA(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Ny(n,i,c,f,E){for(var A=i._reactName,O=[];c!==null&&c!==f;){var V=c,W=V.alternate,ye=V.stateNode;if(V=V.tag,W!==null&&W===f)break;V!==5&&V!==26&&V!==27||ye===null||(W=ye,E?(ye=Ut(c,A),ye!=null&&O.unshift(Qc(c,ye,W))):E||(ye=Ut(c,A),ye!=null&&O.push(Qc(c,ye,W)))),c=c.return}O.length!==0&&n.push({event:i,listeners:O})}var JA=/\r\n?/g,$A=/\u0000|\uFFFD/g;function Oy(n){return(typeof n=="string"?n:""+n).replace(JA,`
`).replace($A,"")}function Dy(n,i){return i=Oy(i),Oy(n)===i}function Zn(n,i,c,f,E,A){switch(c){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||mi(n,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&mi(n,""+f);break;case"className":fn(n,"class",f);break;case"tabIndex":fn(n,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":fn(n,c,f);break;case"style":Tt(n,f,A);break;case"data":if(i!=="object"){fn(n,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||c!=="href")){n.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(c);break}f=Vs(""+f),n.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(c==="formAction"?(i!=="input"&&Zn(n,i,"name",E.name,E,null),Zn(n,i,"formEncType",E.formEncType,E,null),Zn(n,i,"formMethod",E.formMethod,E,null),Zn(n,i,"formTarget",E.formTarget,E,null)):(Zn(n,i,"encType",E.encType,E,null),Zn(n,i,"method",E.method,E,null),Zn(n,i,"target",E.target,E,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(c);break}f=Vs(""+f),n.setAttribute(c,f);break;case"onClick":f!=null&&(n.onclick=pi);break;case"onScroll":f!=null&&yn("scroll",n);break;case"onScrollEnd":f!=null&&yn("scrollend",n);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(o(61));if(c=f.__html,c!=null){if(E.children!=null)throw Error(o(60));n.innerHTML=c}}break;case"multiple":n.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":n.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){n.removeAttribute("xlink:href");break}c=Vs(""+f),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,""+f):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":f===!0?n.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,f):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?n.setAttribute(c,f):n.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?n.removeAttribute(c):n.setAttribute(c,f);break;case"popover":yn("beforetoggle",n),yn("toggle",n),dn(n,"popover",f);break;case"xlinkActuate":Rn(n,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Rn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Rn(n,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Rn(n,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Rn(n,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Rn(n,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Rn(n,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Rn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Rn(n,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":dn(n,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=zo.get(c)||c,dn(n,c,f))}}function z0(n,i,c,f,E,A){switch(c){case"style":Tt(n,f,A);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(o(61));if(c=f.__html,c!=null){if(E.children!=null)throw Error(o(60));n.innerHTML=c}}break;case"children":typeof f=="string"?mi(n,f):(typeof f=="number"||typeof f=="bigint")&&mi(n,""+f);break;case"onScroll":f!=null&&yn("scroll",n);break;case"onScrollEnd":f!=null&&yn("scrollend",n);break;case"onClick":f!=null&&(n.onclick=pi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!K.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(E=c.endsWith("Capture"),i=c.slice(2,E?c.length-7:void 0),A=n[Ot]||null,A=A!=null?A[c]:null,typeof A=="function"&&n.removeEventListener(i,A,E),typeof f=="function")){typeof A!="function"&&A!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(i,f,E);break e}c in n?n[c]=f:f===!0?n.setAttribute(c,""):dn(n,c,f)}}}function li(n,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yn("error",n),yn("load",n);var f=!1,E=!1,A;for(A in c)if(c.hasOwnProperty(A)){var O=c[A];if(O!=null)switch(A){case"src":f=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:Zn(n,i,A,O,c,null)}}E&&Zn(n,i,"srcSet",c.srcSet,c,null),f&&Zn(n,i,"src",c.src,c,null);return;case"input":yn("invalid",n);var V=A=O=E=null,W=null,ye=null;for(f in c)if(c.hasOwnProperty(f)){var Ne=c[f];if(Ne!=null)switch(f){case"name":E=Ne;break;case"type":O=Ne;break;case"checked":W=Ne;break;case"defaultChecked":ye=Ne;break;case"value":A=Ne;break;case"defaultValue":V=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(o(137,i));break;default:Zn(n,i,f,Ne,c,null)}}fe(n,A,V,W,ye,O,E,!1);return;case"select":yn("invalid",n),f=O=A=null;for(E in c)if(c.hasOwnProperty(E)&&(V=c[E],V!=null))switch(E){case"value":A=V;break;case"defaultValue":O=V;break;case"multiple":f=V;default:Zn(n,i,E,V,c,null)}i=A,c=O,n.multiple=!!f,i!=null?_t(n,!!f,i,!1):c!=null&&_t(n,!!f,c,!0);return;case"textarea":yn("invalid",n),A=E=f=null;for(O in c)if(c.hasOwnProperty(O)&&(V=c[O],V!=null))switch(O){case"value":f=V;break;case"defaultValue":E=V;break;case"children":A=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(o(91));break;default:Zn(n,i,O,V,c,null)}Lr(n,f,E,A);return;case"option":for(W in c)if(c.hasOwnProperty(W)&&(f=c[W],f!=null))switch(W){case"selected":n.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Zn(n,i,W,f,c,null)}return;case"dialog":yn("beforetoggle",n),yn("toggle",n),yn("cancel",n),yn("close",n);break;case"iframe":case"object":yn("load",n);break;case"video":case"audio":for(f=0;f<Wc.length;f++)yn(Wc[f],n);break;case"image":yn("error",n),yn("load",n);break;case"details":yn("toggle",n);break;case"embed":case"source":case"link":yn("error",n),yn("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ye in c)if(c.hasOwnProperty(ye)&&(f=c[ye],f!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:Zn(n,i,ye,f,c,null)}return;default:if(zn(i)){for(Ne in c)c.hasOwnProperty(Ne)&&(f=c[Ne],f!==void 0&&z0(n,i,Ne,f,c,void 0));return}}for(V in c)c.hasOwnProperty(V)&&(f=c[V],f!=null&&Zn(n,i,V,f,c,null))}function eb(n,i,c,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,A=null,O=null,V=null,W=null,ye=null,Ne=null;for(Ce in c){var Be=c[Ce];if(c.hasOwnProperty(Ce)&&Be!=null)switch(Ce){case"checked":break;case"value":break;case"defaultValue":W=Be;default:f.hasOwnProperty(Ce)||Zn(n,i,Ce,null,f,Be)}}for(var xe in f){var Ce=f[xe];if(Be=c[xe],f.hasOwnProperty(xe)&&(Ce!=null||Be!=null))switch(xe){case"type":A=Ce;break;case"name":E=Ce;break;case"checked":ye=Ce;break;case"defaultChecked":Ne=Ce;break;case"value":O=Ce;break;case"defaultValue":V=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(o(137,i));break;default:Ce!==Be&&Zn(n,i,xe,Ce,f,Be)}}Er(n,O,V,W,ye,Ne,A,E);return;case"select":Ce=O=V=xe=null;for(A in c)if(W=c[A],c.hasOwnProperty(A)&&W!=null)switch(A){case"value":break;case"multiple":Ce=W;default:f.hasOwnProperty(A)||Zn(n,i,A,null,f,W)}for(E in f)if(A=f[E],W=c[E],f.hasOwnProperty(E)&&(A!=null||W!=null))switch(E){case"value":xe=A;break;case"defaultValue":V=A;break;case"multiple":O=A;default:A!==W&&Zn(n,i,E,A,f,W)}i=V,c=O,f=Ce,xe!=null?_t(n,!!c,xe,!1):!!f!=!!c&&(i!=null?_t(n,!!c,i,!0):_t(n,!!c,c?[]:"",!1));return;case"textarea":Ce=xe=null;for(V in c)if(E=c[V],c.hasOwnProperty(V)&&E!=null&&!f.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:Zn(n,i,V,null,f,E)}for(O in f)if(E=f[O],A=c[O],f.hasOwnProperty(O)&&(E!=null||A!=null))switch(O){case"value":xe=E;break;case"defaultValue":Ce=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(o(91));break;default:E!==A&&Zn(n,i,O,E,f,A)}wr(n,xe,Ce);return;case"option":for(var At in c)if(xe=c[At],c.hasOwnProperty(At)&&xe!=null&&!f.hasOwnProperty(At))switch(At){case"selected":n.selected=!1;break;default:Zn(n,i,At,null,f,xe)}for(W in f)if(xe=f[W],Ce=c[W],f.hasOwnProperty(W)&&xe!==Ce&&(xe!=null||Ce!=null))switch(W){case"selected":n.selected=xe&&typeof xe!="function"&&typeof xe!="symbol";break;default:Zn(n,i,W,xe,f,Ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var jt in c)xe=c[jt],c.hasOwnProperty(jt)&&xe!=null&&!f.hasOwnProperty(jt)&&Zn(n,i,jt,null,f,xe);for(ye in f)if(xe=f[ye],Ce=c[ye],f.hasOwnProperty(ye)&&xe!==Ce&&(xe!=null||Ce!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(o(137,i));break;default:Zn(n,i,ye,xe,f,Ce)}return;default:if(zn(i)){for(var Jn in c)xe=c[Jn],c.hasOwnProperty(Jn)&&xe!==void 0&&!f.hasOwnProperty(Jn)&&z0(n,i,Jn,void 0,f,xe);for(Ne in f)xe=f[Ne],Ce=c[Ne],!f.hasOwnProperty(Ne)||xe===Ce||xe===void 0&&Ce===void 0||z0(n,i,Ne,xe,f,Ce);return}}for(var ae in c)xe=c[ae],c.hasOwnProperty(ae)&&xe!=null&&!f.hasOwnProperty(ae)&&Zn(n,i,ae,null,f,xe);for(Be in f)xe=f[Be],Ce=c[Be],!f.hasOwnProperty(Be)||xe===Ce||xe==null&&Ce==null||Zn(n,i,Be,xe,f,Ce)}function My(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tb(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var E=c[f],A=E.transferSize,O=E.initiatorType,V=E.duration;if(A&&V&&My(O)){for(O=0,V=E.responseEnd,f+=1;f<c.length;f++){var W=c[f],ye=W.startTime;if(ye>V)break;var Ne=W.transferSize,Be=W.initiatorType;Ne&&My(Be)&&(W=W.responseEnd,O+=Ne*(W<V?1:(V-ye)/(W-ye)))}if(--f,i+=8*(A+O)/(E.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var H0=null,G0=null;function Uh(n){return n.nodeType===9?n:n.ownerDocument}function ky(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ly(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function q0(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var X0=null;function nb(){var n=window.event;return n&&n.type==="popstate"?n===X0?!1:(X0=n,!0):(X0=null,!1)}var Py=typeof setTimeout=="function"?setTimeout:void 0,rb=typeof clearTimeout=="function"?clearTimeout:void 0,By=typeof Promise=="function"?Promise:void 0,ib=typeof queueMicrotask=="function"?queueMicrotask:typeof By<"u"?function(n){return By.resolve(null).then(n).catch(sb)}:Py;function sb(n){setTimeout(function(){throw n})}function go(n){return n==="head"}function Vy(n,i){var c=i,f=0;do{var E=c.nextSibling;if(n.removeChild(c),E&&E.nodeType===8)if(c=E.data,c==="/$"||c==="/&"){if(f===0){n.removeChild(E),Ql(i);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Zc(n.ownerDocument.documentElement);else if(c==="head"){c=n.ownerDocument.head,Zc(c);for(var A=c.firstChild;A;){var O=A.nextSibling,V=A.nodeName;A[Li]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&A.rel.toLowerCase()==="stylesheet"||c.removeChild(A),A=O}}else c==="body"&&Zc(n.ownerDocument.body);c=E}while(c);Ql(i)}function Uy(n,i){var c=n;n=0;do{var f=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(n===0)break;n--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||n++;c=f}while(c)}function Y0(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Y0(c),Yr(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function ab(n,i,c,f){for(;n.nodeType===1;){var E=c;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(f){if(!n[Li])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(A=n.getAttribute("rel"),A==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(A!==E.rel||n.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||n.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||n.getAttribute("title")!==(E.title==null?null:E.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(A=n.getAttribute("src"),(A!==(E.src==null?null:E.src)||n.getAttribute("type")!==(E.type==null?null:E.type)||n.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&A&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var A=E.name==null?null:""+E.name;if(E.type==="hidden"&&n.getAttribute("name")===A)return n}else return n;if(n=bs(n.nextSibling),n===null)break}return null}function ob(n,i,c){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=bs(n.nextSibling),n===null))return null;return n}function Fy(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=bs(n.nextSibling),n===null))return null;return n}function K0(n){return n.data==="$?"||n.data==="$~"}function W0(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function lb(n,i){var c=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||c.readyState!=="loading")i();else{var f=function(){i(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),n._reactRetry=f}}function bs(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Q0=null;function jy(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="/$"||c==="/&"){if(i===0)return bs(n.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}n=n.nextSibling}return null}function zy(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return n;i--}else c!=="/$"&&c!=="/&"||i++}n=n.previousSibling}return null}function Hy(n,i,c){switch(i=Uh(c),n){case"html":if(n=i.documentElement,!n)throw Error(o(452));return n;case"head":if(n=i.head,!n)throw Error(o(453));return n;case"body":if(n=i.body,!n)throw Error(o(454));return n;default:throw Error(o(451))}}function Zc(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Yr(n)}var vs=new Map,Gy=new Set;function Fh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ra=Ee.d;Ee.d={f:cb,r:ub,D:hb,C:db,L:fb,m:gb,X:pb,S:mb,M:yb};function cb(){var n=Ra.f(),i=Oh();return n||i}function ub(n){var i=un(n);i!==null&&i.tag===5&&i.type==="form"?op(i):Ra.r(n)}var Yl=typeof document>"u"?null:document;function qy(n,i,c){var f=Yl;if(f&&typeof i=="string"&&i){var E=an(i);E='link[rel="'+n+'"][href="'+E+'"]',typeof c=="string"&&(E+='[crossorigin="'+c+'"]'),Gy.has(E)||(Gy.add(E),n={rel:n,crossOrigin:c,href:i},f.querySelector(E)===null&&(i=f.createElement("link"),li(i,"link",n),sr(i),f.head.appendChild(i)))}}function hb(n){Ra.D(n),qy("dns-prefetch",n,null)}function db(n,i){Ra.C(n,i),qy("preconnect",n,i)}function fb(n,i,c){Ra.L(n,i,c);var f=Yl;if(f&&n&&i){var E='link[rel="preload"][as="'+an(i)+'"]';i==="image"&&c&&c.imageSrcSet?(E+='[imagesrcset="'+an(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(E+='[imagesizes="'+an(c.imageSizes)+'"]')):E+='[href="'+an(n)+'"]';var A=E;switch(i){case"style":A=Kl(n);break;case"script":A=Wl(n)}vs.has(A)||(n=R({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:n,as:i},c),vs.set(A,n),f.querySelector(E)!==null||i==="style"&&f.querySelector(Jc(A))||i==="script"&&f.querySelector($c(A))||(i=f.createElement("link"),li(i,"link",n),sr(i),f.head.appendChild(i)))}}function gb(n,i){Ra.m(n,i);var c=Yl;if(c&&n){var f=i&&typeof i.as=="string"?i.as:"script",E='link[rel="modulepreload"][as="'+an(f)+'"][href="'+an(n)+'"]',A=E;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Wl(n)}if(!vs.has(A)&&(n=R({rel:"modulepreload",href:n},i),vs.set(A,n),c.querySelector(E)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector($c(A)))return}f=c.createElement("link"),li(f,"link",n),sr(f),c.head.appendChild(f)}}}function mb(n,i,c){Ra.S(n,i,c);var f=Yl;if(f&&n){var E=kr(f).hoistableStyles,A=Kl(n);i=i||"default";var O=E.get(A);if(!O){var V={loading:0,preload:null};if(O=f.querySelector(Jc(A)))V.loading=5;else{n=R({rel:"stylesheet",href:n,"data-precedence":i},c),(c=vs.get(A))&&Z0(n,c);var W=O=f.createElement("link");sr(W),li(W,"link",n),W._p=new Promise(function(ye,Ne){W.onload=ye,W.onerror=Ne}),W.addEventListener("load",function(){V.loading|=1}),W.addEventListener("error",function(){V.loading|=2}),V.loading|=4,jh(O,i,f)}O={type:"stylesheet",instance:O,count:1,state:V},E.set(A,O)}}}function pb(n,i){Ra.X(n,i);var c=Yl;if(c&&n){var f=kr(c).hoistableScripts,E=Wl(n),A=f.get(E);A||(A=c.querySelector($c(E)),A||(n=R({src:n,async:!0},i),(i=vs.get(E))&&J0(n,i),A=c.createElement("script"),sr(A),li(A,"link",n),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(E,A))}}function yb(n,i){Ra.M(n,i);var c=Yl;if(c&&n){var f=kr(c).hoistableScripts,E=Wl(n),A=f.get(E);A||(A=c.querySelector($c(E)),A||(n=R({src:n,async:!0,type:"module"},i),(i=vs.get(E))&&J0(n,i),A=c.createElement("script"),sr(A),li(A,"link",n),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(E,A))}}function Xy(n,i,c,f){var E=(E=ve.current)?Fh(E):null;if(!E)throw Error(o(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Kl(c.href),c=kr(E).hoistableStyles,f=c.get(i),f||(f={type:"style",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=Kl(c.href);var A=kr(E).hoistableStyles,O=A.get(n);if(O||(E=E.ownerDocument||E,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(n,O),(A=E.querySelector(Jc(n)))&&!A._p&&(O.instance=A,O.state.loading=5),vs.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},vs.set(n,c),A||xb(E,n,c,O.state))),i&&f===null)throw Error(o(528,""));return O}if(i&&f!==null)throw Error(o(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Wl(c),c=kr(E).hoistableScripts,f=c.get(i),f||(f={type:"script",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,n))}}function Kl(n){return'href="'+an(n)+'"'}function Jc(n){return'link[rel="stylesheet"]['+n+"]"}function Yy(n){return R({},n,{"data-precedence":n.precedence,precedence:null})}function xb(n,i,c,f){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=n.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),li(i,"link",c),sr(i),n.head.appendChild(i))}function Wl(n){return'[src="'+an(n)+'"]'}function $c(n){return"script[async]"+n}function Ky(n,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var f=n.querySelector('style[data-href~="'+an(c.href)+'"]');if(f)return i.instance=f,sr(f),f;var E=R({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(n.ownerDocument||n).createElement("style"),sr(f),li(f,"style",E),jh(f,c.precedence,n),i.instance=f;case"stylesheet":E=Kl(c.href);var A=n.querySelector(Jc(E));if(A)return i.state.loading|=4,i.instance=A,sr(A),A;f=Yy(c),(E=vs.get(E))&&Z0(f,E),A=(n.ownerDocument||n).createElement("link"),sr(A);var O=A;return O._p=new Promise(function(V,W){O.onload=V,O.onerror=W}),li(A,"link",f),i.state.loading|=4,jh(A,c.precedence,n),i.instance=A;case"script":return A=Wl(c.src),(E=n.querySelector($c(A)))?(i.instance=E,sr(E),E):(f=c,(E=vs.get(A))&&(f=R({},c),J0(f,E)),n=n.ownerDocument||n,E=n.createElement("script"),sr(E),li(E,"link",f),n.head.appendChild(E),i.instance=E);case"void":return null;default:throw Error(o(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,jh(f,c.precedence,n));return i.instance}function jh(n,i,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=f.length?f[f.length-1]:null,A=E,O=0;O<f.length;O++){var V=f[O];if(V.dataset.precedence===i)A=V;else if(A!==E)break}A?A.parentNode.insertBefore(n,A.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(n,i.firstChild))}function Z0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function J0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var zh=null;function Wy(n,i,c){if(zh===null){var f=new Map,E=zh=new Map;E.set(c,f)}else E=zh,f=E.get(c),f||(f=new Map,E.set(c,f));if(f.has(n))return f;for(f.set(n,null),c=c.getElementsByTagName(n),E=0;E<c.length;E++){var A=c[E];if(!(A[Li]||A[gt]||n==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var O=A.getAttribute(i)||"";O=n+O;var V=f.get(O);V?V.push(A):f.set(O,[A])}}return f}function Qy(n,i,c){n=n.ownerDocument||n,n.head.insertBefore(c,i==="title"?n.querySelector("head > title"):null)}function Eb(n,i,c){if(c===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Zy(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function wb(n,i,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var E=Kl(f.href),A=i.querySelector(Jc(E));if(A){i=A._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Hh.bind(n),i.then(n,n)),c.state.loading|=4,c.instance=A,sr(A);return}A=i.ownerDocument||i,f=Yy(f),(E=vs.get(E))&&Z0(f,E),A=A.createElement("link"),sr(A);var O=A;O._p=new Promise(function(V,W){O.onload=V,O.onerror=W}),li(A,"link",f),c.instance=A}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(n.count++,c=Hh.bind(n),i.addEventListener("load",c),i.addEventListener("error",c))}}var $0=0;function _b(n,i){return n.stylesheets&&n.count===0&&qh(n,n.stylesheets),0<n.count||0<n.imgCount?function(c){var f=setTimeout(function(){if(n.stylesheets&&qh(n,n.stylesheets),n.unsuspend){var A=n.unsuspend;n.unsuspend=null,A()}},6e4+i);0<n.imgBytes&&$0===0&&($0=62500*tb());var E=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&qh(n,n.stylesheets),n.unsuspend)){var A=n.unsuspend;n.unsuspend=null,A()}},(n.imgBytes>$0?50:800)+i);return n.unsuspend=c,function(){n.unsuspend=null,clearTimeout(f),clearTimeout(E)}}:null}function Hh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Gh=null;function qh(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Gh=new Map,i.forEach(Ab,n),Gh=null,Hh.call(n))}function Ab(n,i){if(!(i.state.loading&4)){var c=Gh.get(n);if(c)var f=c.get(null);else{c=new Map,Gh.set(n,c);for(var E=n.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<E.length;A++){var O=E[A];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(c.set(O.dataset.precedence,O),f=O)}f&&c.set(null,f)}E=i.instance,O=E.getAttribute("data-precedence"),A=c.get(O)||f,A===f&&c.set(null,E),c.set(O,E),this.count++,f=Hh.bind(this),E.addEventListener("load",f),E.addEventListener("error",f),A?A.parentNode.insertBefore(E,A.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(E,n.firstChild)),i.state.loading|=4}}var eu={$$typeof:le,Provider:null,Consumer:null,_currentValue:We,_currentValue2:We,_threadCount:0};function bb(n,i,c,f,E,A,O,V,W){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ie(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ie(0),this.hiddenUpdates=Ie(null),this.identifierPrefix=f,this.onUncaughtError=E,this.onCaughtError=A,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Jy(n,i,c,f,E,A,O,V,W,ye,Ne,Be){return n=new bb(n,i,c,O,W,ye,Ne,Be,V),i=1,A===!0&&(i|=24),A=ns(3,null,null,i),n.current=A,A.stateNode=n,i=Df(),i.refCount++,n.pooledCache=i,i.refCount++,A.memoizedState={element:f,isDehydrated:c,cache:i},Pf(A),n}function $y(n){return n?(n=Cl,n):Cl}function e2(n,i,c,f,E,A){E=$y(E),f.context===null?f.context=E:f.pendingContext=E,f=no(i),f.payload={element:c},A=A===void 0?null:A,A!==null&&(f.callback=A),c=ro(n,f,i),c!==null&&(qi(c,n,i),Dc(c,n,i))}function t2(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<i?c:i}}function e1(n,i){t2(n,i),(n=n.alternate)&&t2(n,i)}function n2(n){if(n.tag===13||n.tag===31){var i=Ko(n,67108864);i!==null&&qi(i,n,67108864),e1(n,67108864)}}function r2(n){if(n.tag===13||n.tag===31){var i=os();i=Ht(i);var c=Ko(n,i);c!==null&&qi(c,n,i),e1(n,i)}}var Xh=!0;function vb(n,i,c,f){var E=ue.T;ue.T=null;var A=Ee.p;try{Ee.p=2,t1(n,i,c,f)}finally{Ee.p=A,ue.T=E}}function Tb(n,i,c,f){var E=ue.T;ue.T=null;var A=Ee.p;try{Ee.p=8,t1(n,i,c,f)}finally{Ee.p=A,ue.T=E}}function t1(n,i,c,f){if(Xh){var E=n1(f);if(E===null)j0(n,i,f,Yh,c),s2(n,f);else if(Sb(E,n,i,c,f))f.stopPropagation();else if(s2(n,f),i&4&&-1<Cb.indexOf(n)){for(;E!==null;){var A=un(E);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var O=jn(A.pendingLanes);if(O!==0){var V=A;for(V.pendingLanes|=2,V.entangledLanes|=2;O;){var W=1<<31-wt(O);V.entanglements[1]|=W,O&=~W}qs(A),(Un&6)===0&&(Rh=Rt()+500,Kc(0))}}break;case 31:case 13:V=Ko(A,2),V!==null&&qi(V,A,2),Oh(),e1(A,2)}if(A=n1(f),A===null&&j0(n,i,f,Yh,c),A===E)break;E=A}E!==null&&f.stopPropagation()}else j0(n,i,f,null,c)}}function n1(n){return n=Bi(n),r1(n)}var Yh=null;function r1(n){if(Yh=null,n=Wn(n),n!==null){var i=g(n);if(i===null)n=null;else{var c=i.tag;if(c===13){if(n=x(i),n!==null)return n;n=null}else if(c===31){if(n=T(i),n!==null)return n;n=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Yh=n,null}function i2(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fn()){case Xt:return 2;case yr:return 8;case xr:case or:return 32;case Zr:return 268435456;default:return 32}default:return 32}}var i1=!1,mo=null,po=null,yo=null,tu=new Map,nu=new Map,xo=[],Cb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function s2(n,i){switch(n){case"focusin":case"focusout":mo=null;break;case"dragenter":case"dragleave":po=null;break;case"mouseover":case"mouseout":yo=null;break;case"pointerover":case"pointerout":tu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":nu.delete(i.pointerId)}}function ru(n,i,c,f,E,A){return n===null||n.nativeEvent!==A?(n={blockedOn:i,domEventName:c,eventSystemFlags:f,nativeEvent:A,targetContainers:[E]},i!==null&&(i=un(i),i!==null&&n2(i)),n):(n.eventSystemFlags|=f,i=n.targetContainers,E!==null&&i.indexOf(E)===-1&&i.push(E),n)}function Sb(n,i,c,f,E){switch(i){case"focusin":return mo=ru(mo,n,i,c,f,E),!0;case"dragenter":return po=ru(po,n,i,c,f,E),!0;case"mouseover":return yo=ru(yo,n,i,c,f,E),!0;case"pointerover":var A=E.pointerId;return tu.set(A,ru(tu.get(A)||null,n,i,c,f,E)),!0;case"gotpointercapture":return A=E.pointerId,nu.set(A,ru(nu.get(A)||null,n,i,c,f,E)),!0}return!1}function a2(n){var i=Wn(n.target);if(i!==null){var c=g(i);if(c!==null){if(i=c.tag,i===13){if(i=x(c),i!==null){n.blockedOn=i,Me(n.priority,function(){r2(c)});return}}else if(i===31){if(i=T(c),i!==null){n.blockedOn=i,Me(n.priority,function(){r2(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Kh(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var c=n1(n.nativeEvent);if(c===null){c=n.nativeEvent;var f=new c.constructor(c.type,c);ia=f,c.target.dispatchEvent(f),ia=null}else return i=un(c),i!==null&&n2(i),n.blockedOn=c,!1;i.shift()}return!0}function o2(n,i,c){Kh(n)&&c.delete(i)}function Ib(){i1=!1,mo!==null&&Kh(mo)&&(mo=null),po!==null&&Kh(po)&&(po=null),yo!==null&&Kh(yo)&&(yo=null),tu.forEach(o2),nu.forEach(o2)}function Wh(n,i){n.blockedOn===i&&(n.blockedOn=null,i1||(i1=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Ib)))}var Qh=null;function l2(n){Qh!==n&&(Qh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Qh===n&&(Qh=null);for(var i=0;i<n.length;i+=3){var c=n[i],f=n[i+1],E=n[i+2];if(typeof f!="function"){if(r1(f||c)===null)continue;break}var A=un(c);A!==null&&(n.splice(i,3),i-=3,n0(A,{pending:!0,data:E,method:c.method,action:f},f,E))}}))}function Ql(n){function i(W){return Wh(W,n)}mo!==null&&Wh(mo,n),po!==null&&Wh(po,n),yo!==null&&Wh(yo,n),tu.forEach(i),nu.forEach(i);for(var c=0;c<xo.length;c++){var f=xo[c];f.blockedOn===n&&(f.blockedOn=null)}for(;0<xo.length&&(c=xo[0],c.blockedOn===null);)a2(c),c.blockedOn===null&&xo.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var E=c[f],A=c[f+1],O=E[Ot]||null;if(typeof A=="function")O||l2(c);else if(O){var V=null;if(A&&A.hasAttribute("formAction")){if(E=A,O=A[Ot]||null)V=O.formAction;else if(r1(E)!==null)continue}else V=O.action;typeof V=="function"?c[f+1]=V:(c.splice(f,3),f-=3),l2(c)}}}function c2(){function n(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(O){return E=O})},focusReset:"manual",scroll:"manual"})}function i(){E!==null&&(E(),E=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,E=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),E!==null&&(E(),E=null)}}}function s1(n){this._internalRoot=n}Zh.prototype.render=s1.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(o(409));var c=i.current,f=os();e2(c,f,n,i,null,null)},Zh.prototype.unmount=s1.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;e2(n.current,2,null,n,null,null),Oh(),i[$n]=null}};function Zh(n){this._internalRoot=n}Zh.prototype.unstable_scheduleHydration=function(n){if(n){var i=Vt();n={blockedOn:null,target:n,priority:i};for(var c=0;c<xo.length&&i!==0&&i<xo[c].priority;c++);xo.splice(c,0,n),c===0&&a2(n)}};var u2=e.version;if(u2!=="19.2.0")throw Error(o(527,u2,"19.2.0"));Ee.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(o(188)):(n=Object.keys(n).join(","),Error(o(268,n)));return n=w(i),n=n!==null?C(n):null,n=n===null?null:n.stateNode,n};var Rb={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ue,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jh.isDisabled&&Jh.supportsFiber)try{tn=Jh.inject(Rb),ze=Jh}catch{}}return su.createRoot=function(n,i){if(!u(n))throw Error(o(299));var c=!1,f="",E=yp,A=xp,O=Ep;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(E=i.onUncaughtError),i.onCaughtError!==void 0&&(A=i.onCaughtError),i.onRecoverableError!==void 0&&(O=i.onRecoverableError)),i=Jy(n,1,!1,null,null,c,f,null,E,A,O,c2),n[$n]=i.current,F0(n),new s1(i)},su.hydrateRoot=function(n,i,c){if(!u(n))throw Error(o(299));var f=!1,E="",A=yp,O=xp,V=Ep,W=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onUncaughtError!==void 0&&(A=c.onUncaughtError),c.onCaughtError!==void 0&&(O=c.onCaughtError),c.onRecoverableError!==void 0&&(V=c.onRecoverableError),c.formState!==void 0&&(W=c.formState)),i=Jy(n,1,!0,i,c??null,f,E,W,A,O,V,c2),i.context=$y(null),c=i.current,f=os(),f=Ht(f),E=no(f),E.callback=null,ro(c,E,f),c=f,i.current.lanes=c,He(i,c),qs(i),n[$n]=i.current,F0(n),new Zh(i)},su.version="19.2.0",su}var w2;function Ub(){if(w2)return l1.exports;w2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),l1.exports=Vb(),l1.exports}var Fb=Ub();const jb=Xd(Fb),lc=()=>I.jsxs("div",{style:{padding:"1.5rem 0",display:"flex",justifyContent:"center",alignItems:"center"},children:[I.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",border:"3px solid #e5e7eb",borderTopColor:"#2EC483",animation:"spin 1s linear infinite"}}),I.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]}),zb=()=>{};var _2={};const bE=function(s){const e=[];let t=0;for(let o=0;o<s.length;o++){let u=s.charCodeAt(o);u<128?e[t++]=u:u<2048?(e[t++]=u>>6|192,e[t++]=u&63|128):(u&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(u=65536+((u&1023)<<10)+(s.charCodeAt(++o)&1023),e[t++]=u>>18|240,e[t++]=u>>12&63|128,e[t++]=u>>6&63|128,e[t++]=u&63|128):(e[t++]=u>>12|224,e[t++]=u>>6&63|128,e[t++]=u&63|128)}return e},Hb=function(s){const e=[];let t=0,o=0;for(;t<s.length;){const u=s[t++];if(u<128)e[o++]=String.fromCharCode(u);else if(u>191&&u<224){const g=s[t++];e[o++]=String.fromCharCode((u&31)<<6|g&63)}else if(u>239&&u<365){const g=s[t++],x=s[t++],T=s[t++],b=((u&7)<<18|(g&63)<<12|(x&63)<<6|T&63)-65536;e[o++]=String.fromCharCode(55296+(b>>10)),e[o++]=String.fromCharCode(56320+(b&1023))}else{const g=s[t++],x=s[t++];e[o++]=String.fromCharCode((u&15)<<12|(g&63)<<6|x&63)}}return e.join("")},vE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let u=0;u<s.length;u+=3){const g=s[u],x=u+1<s.length,T=x?s[u+1]:0,b=u+2<s.length,w=b?s[u+2]:0,C=g>>2,R=(g&3)<<4|T>>4;let P=(T&15)<<2|w>>6,L=w&63;b||(L=64,x||(P=64)),o.push(t[C],t[R],t[P],t[L])}return o.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(bE(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Hb(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let u=0;u<s.length;){const g=t[s.charAt(u++)],T=u<s.length?t[s.charAt(u)]:0;++u;const w=u<s.length?t[s.charAt(u)]:64;++u;const R=u<s.length?t[s.charAt(u)]:64;if(++u,g==null||T==null||w==null||R==null)throw new Gb;const P=g<<2|T>>4;if(o.push(P),w!==64){const L=T<<4&240|w>>2;if(o.push(L),R!==64){const ee=w<<6&192|R;o.push(ee)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Gb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qb=function(s){const e=bE(s);return vE.encodeByteArray(e,!0)},wd=function(s){return qb(s).replace(/\./g,"")},TE=function(s){try{return vE.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Xb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Yb=()=>Xb().__FIREBASE_DEFAULTS__,Kb=()=>{if(typeof process>"u"||typeof _2>"u")return;const s=_2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Wb=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&TE(s[1]);return e&&JSON.parse(e)},Yd=()=>{try{return zb()||Yb()||Kb()||Wb()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},CE=s=>Yd()?.emulatorHosts?.[s],SE=s=>{const e=CE(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),o]:[e.substring(0,t),o]},IE=()=>Yd()?.config,RE=s=>Yd()?.[`_${s}`];class Qb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,o)=>{t?this.reject(t):this.resolve(o),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,o))}}}function Vo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ag(s){return(await fetch(s,{credentials:"include"})).ok}function Zb(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},o=e||"demo-project",u=s.iat||0,g=s.sub||s.user_id;if(!g)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const x={iss:`https://securetoken.google.com/${o}`,aud:o,iat:u,exp:u+3600,auth_time:u,sub:g,user_id:g,firebase:{sign_in_provider:"custom",identities:{}},...s};return[wd(JSON.stringify(t)),wd(JSON.stringify(x)),""].join(".")}const pu={};function Jb(){const s={prod:[],emulator:[]};for(const e of Object.keys(pu))pu[e]?s.emulator.push(e):s.prod.push(e);return s}function $b(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let A2=!1;function og(s,e){if(typeof window>"u"||typeof document>"u"||!Vo(window.location.host)||pu[s]===e||pu[s]||A2)return;pu[s]=e;function t(P){return`__firebase__banner__${P}`}const o="__firebase__banner",g=Jb().prod.length>0;function x(){const P=document.getElementById(o);P&&P.remove()}function T(P){P.style.display="flex",P.style.background="#7faaf0",P.style.position="fixed",P.style.bottom="5px",P.style.left="5px",P.style.padding=".5em",P.style.borderRadius="5px",P.style.alignItems="center"}function b(P,L){P.setAttribute("width","24"),P.setAttribute("id",L),P.setAttribute("height","24"),P.setAttribute("viewBox","0 0 24 24"),P.setAttribute("fill","none"),P.style.marginLeft="-6px"}function w(){const P=document.createElement("span");return P.style.cursor="pointer",P.style.marginLeft="16px",P.style.fontSize="24px",P.innerHTML=" &times;",P.onclick=()=>{A2=!0,x()},P}function C(P,L){P.setAttribute("id",L),P.innerText="Learn more",P.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",P.setAttribute("target","__blank"),P.style.paddingLeft="5px",P.style.textDecoration="underline"}function R(){const P=$b(o),L=t("text"),ee=document.getElementById(L)||document.createElement("span"),re=t("learnmore"),se=document.getElementById(re)||document.createElement("a"),Ye=t("preprendIcon"),Oe=document.getElementById(Ye)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(P.created){const le=P.element;T(le),C(se,re);const Ue=w();b(Oe,Ye),le.append(Oe,ee,se,Ue),document.body.appendChild(le)}g?(ee.innerText="Preview backend disconnected.",Oe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Oe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,ee.innerText="Preview backend running in this workspace."),ee.setAttribute("id",L)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",R):R()}function vi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ev(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vi())}function tv(){const s=Yd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rv(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function iv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sv(){const s=vi();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function av(){return!tv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ov(){try{return typeof indexedDB=="object"}catch{return!1}}function lv(){return new Promise((s,e)=>{try{let t=!0;const o="validate-browser-context-for-indexeddb-analytics-module",u=self.indexedDB.open(o);u.onsuccess=()=>{u.result.close(),t||self.indexedDB.deleteDatabase(o),s(!0)},u.onupgradeneeded=()=>{t=!1},u.onerror=()=>{e(u.error?.message||"")}}catch(t){e(t)}})}const cv="FirebaseError";class na extends Error{constructor(e,t,o){super(t),this.code=e,this.customData=o,this.name=cv,Object.setPrototypeOf(this,na.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mu.prototype.create)}}class Mu{constructor(e,t,o){this.service=e,this.serviceName=t,this.errors=o}create(e,...t){const o=t[0]||{},u=`${this.service}/${e}`,g=this.errors[e],x=g?uv(g,o):"Error",T=`${this.serviceName}: ${x} (${u}).`;return new na(u,T,o)}}function uv(s,e){return s.replace(hv,(t,o)=>{const u=e[o];return u!=null?String(u):`<${o}?>`})}const hv=/\{\$([^}]+)}/g;function dv(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function dl(s,e){if(s===e)return!0;const t=Object.keys(s),o=Object.keys(e);for(const u of t){if(!o.includes(u))return!1;const g=s[u],x=e[u];if(b2(g)&&b2(x)){if(!dl(g,x))return!1}else if(g!==x)return!1}for(const u of o)if(!t.includes(u))return!1;return!0}function b2(s){return s!==null&&typeof s=="object"}function ku(s){const e=[];for(const[t,o]of Object.entries(s))Array.isArray(o)?o.forEach(u=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(u))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function cu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(o=>{if(o){const[u,g]=o.split("=");e[decodeURIComponent(u)]=decodeURIComponent(g)}}),e}function uu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function fv(s,e){const t=new gv(s,e);return t.subscribe.bind(t)}class gv{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(o=>{this.error(o)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,o){let u;if(e===void 0&&t===void 0&&o===void 0)throw new Error("Missing Observer.");mv(e,["next","error","complete"])?u=e:u={next:e,error:t,complete:o},u.next===void 0&&(u.next=d1),u.error===void 0&&(u.error=d1),u.complete===void 0&&(u.complete=d1);const g=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?u.error(this.finalError):u.complete()}catch{}}),this.observers.push(u),g}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mv(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function d1(){}function ir(s){return s&&s._delegate?s._delegate:s}class Oo{constructor(e,t,o){this.name=e,this.instanceFactory=t,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ol="[DEFAULT]";class pv{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const o=new Qb;if(this.instancesDeferred.set(t,o),this.isInitialized(t)||this.shouldAutoInitialize())try{const u=this.getOrInitializeService({instanceIdentifier:t});u&&o.resolve(u)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),o=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(u){if(o)return null;throw u}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xv(e))try{this.getOrInitializeService({instanceIdentifier:ol})}catch{}for(const[t,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(t);try{const g=this.getOrInitializeService({instanceIdentifier:u});o.resolve(g)}catch{}}}}clearInstance(e=ol){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ol){return this.instances.has(e)}getOptions(e=ol){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const u=this.getOrInitializeService({instanceIdentifier:o,options:t});for(const[g,x]of this.instancesDeferred.entries()){const T=this.normalizeInstanceIdentifier(g);o===T&&x.resolve(u)}return u}onInit(e,t){const o=this.normalizeInstanceIdentifier(t),u=this.onInitCallbacks.get(o)??new Set;u.add(e),this.onInitCallbacks.set(o,u);const g=this.instances.get(o);return g&&e(g,o),()=>{u.delete(e)}}invokeOnInitCallbacks(e,t){const o=this.onInitCallbacks.get(t);if(o)for(const u of o)try{u(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let o=this.instances.get(e);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:yv(e),options:t}),this.instances.set(e,o),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(o,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,o)}catch{}return o||null}normalizeInstanceIdentifier(e=ol){return this.component?this.component.multipleInstances?e:ol:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yv(s){return s===ol?void 0:s}function xv(s){return s.instantiationMode==="EAGER"}class Ev{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new pv(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Tn;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Tn||(Tn={}));const wv={debug:Tn.DEBUG,verbose:Tn.VERBOSE,info:Tn.INFO,warn:Tn.WARN,error:Tn.ERROR,silent:Tn.SILENT},_v=Tn.INFO,Av={[Tn.DEBUG]:"log",[Tn.VERBOSE]:"log",[Tn.INFO]:"info",[Tn.WARN]:"warn",[Tn.ERROR]:"error"},bv=(s,e,...t)=>{if(e<s.logLevel)return;const o=new Date().toISOString(),u=Av[e];if(u)console[u](`[${o}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lg{constructor(e){this.name=e,this._logLevel=_v,this._logHandler=bv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Tn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Tn.DEBUG,...e),this._logHandler(this,Tn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Tn.VERBOSE,...e),this._logHandler(this,Tn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Tn.INFO,...e),this._logHandler(this,Tn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Tn.WARN,...e),this._logHandler(this,Tn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Tn.ERROR,...e),this._logHandler(this,Tn.ERROR,...e)}}const vv=(s,e)=>e.some(t=>s instanceof t);let v2,T2;function Tv(){return v2||(v2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Cv(){return T2||(T2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const NE=new WeakMap,R1=new WeakMap,OE=new WeakMap,f1=new WeakMap,cg=new WeakMap;function Sv(s){const e=new Promise((t,o)=>{const u=()=>{s.removeEventListener("success",g),s.removeEventListener("error",x)},g=()=>{t(So(s.result)),u()},x=()=>{o(s.error),u()};s.addEventListener("success",g),s.addEventListener("error",x)});return e.then(t=>{t instanceof IDBCursor&&NE.set(t,s)}).catch(()=>{}),cg.set(e,s),e}function Iv(s){if(R1.has(s))return;const e=new Promise((t,o)=>{const u=()=>{s.removeEventListener("complete",g),s.removeEventListener("error",x),s.removeEventListener("abort",x)},g=()=>{t(),u()},x=()=>{o(s.error||new DOMException("AbortError","AbortError")),u()};s.addEventListener("complete",g),s.addEventListener("error",x),s.addEventListener("abort",x)});R1.set(s,e)}let N1={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return R1.get(s);if(e==="objectStoreNames")return s.objectStoreNames||OE.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return So(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Rv(s){N1=s(N1)}function Nv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const o=s.call(g1(this),e,...t);return OE.set(o,e.sort?e.sort():[e]),So(o)}:Cv().includes(s)?function(...e){return s.apply(g1(this),e),So(NE.get(this))}:function(...e){return So(s.apply(g1(this),e))}}function Ov(s){return typeof s=="function"?Nv(s):(s instanceof IDBTransaction&&Iv(s),vv(s,Tv())?new Proxy(s,N1):s)}function So(s){if(s instanceof IDBRequest)return Sv(s);if(f1.has(s))return f1.get(s);const e=Ov(s);return e!==s&&(f1.set(s,e),cg.set(e,s)),e}const g1=s=>cg.get(s);function Dv(s,e,{blocked:t,upgrade:o,blocking:u,terminated:g}={}){const x=indexedDB.open(s,e),T=So(x);return o&&x.addEventListener("upgradeneeded",b=>{o(So(x.result),b.oldVersion,b.newVersion,So(x.transaction),b)}),t&&x.addEventListener("blocked",b=>t(b.oldVersion,b.newVersion,b)),T.then(b=>{g&&b.addEventListener("close",()=>g()),u&&b.addEventListener("versionchange",w=>u(w.oldVersion,w.newVersion,w))}).catch(()=>{}),T}const Mv=["get","getKey","getAll","getAllKeys","count"],kv=["put","add","delete","clear"],m1=new Map;function C2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(m1.get(e))return m1.get(e);const t=e.replace(/FromIndex$/,""),o=e!==t,u=kv.includes(t);if(!(t in(o?IDBIndex:IDBObjectStore).prototype)||!(u||Mv.includes(t)))return;const g=async function(x,...T){const b=this.transaction(x,u?"readwrite":"readonly");let w=b.store;return o&&(w=w.index(T.shift())),(await Promise.all([w[t](...T),u&&b.done]))[0]};return m1.set(e,g),g}Rv(s=>({...s,get:(e,t,o)=>C2(e,t)||s.get(e,t,o),has:(e,t)=>!!C2(e,t)||s.has(e,t)}));class Lv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Pv(t)){const o=t.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(t=>t).join(" ")}}function Pv(s){return s.getComponent()?.type==="VERSION"}const O1="@firebase/app",S2="0.14.6";const Pa=new lg("@firebase/app"),Bv="@firebase/app-compat",Vv="@firebase/analytics-compat",Uv="@firebase/analytics",Fv="@firebase/app-check-compat",jv="@firebase/app-check",zv="@firebase/auth",Hv="@firebase/auth-compat",Gv="@firebase/database",qv="@firebase/data-connect",Xv="@firebase/database-compat",Yv="@firebase/functions",Kv="@firebase/functions-compat",Wv="@firebase/installations",Qv="@firebase/installations-compat",Zv="@firebase/messaging",Jv="@firebase/messaging-compat",$v="@firebase/performance",eT="@firebase/performance-compat",tT="@firebase/remote-config",nT="@firebase/remote-config-compat",rT="@firebase/storage",iT="@firebase/storage-compat",sT="@firebase/firestore",aT="@firebase/ai",oT="@firebase/firestore-compat",lT="firebase",cT="12.6.0";const D1="[DEFAULT]",uT={[O1]:"fire-core",[Bv]:"fire-core-compat",[Uv]:"fire-analytics",[Vv]:"fire-analytics-compat",[jv]:"fire-app-check",[Fv]:"fire-app-check-compat",[zv]:"fire-auth",[Hv]:"fire-auth-compat",[Gv]:"fire-rtdb",[qv]:"fire-data-connect",[Xv]:"fire-rtdb-compat",[Yv]:"fire-fn",[Kv]:"fire-fn-compat",[Wv]:"fire-iid",[Qv]:"fire-iid-compat",[Zv]:"fire-fcm",[Jv]:"fire-fcm-compat",[$v]:"fire-perf",[eT]:"fire-perf-compat",[tT]:"fire-rc",[nT]:"fire-rc-compat",[rT]:"fire-gcs",[iT]:"fire-gcs-compat",[sT]:"fire-fst",[oT]:"fire-fst-compat",[aT]:"fire-vertex","fire-js":"fire-js",[lT]:"fire-js-all"};const Au=new Map,hT=new Map,M1=new Map;function I2(s,e){try{s.container.addComponent(e)}catch(t){Pa.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function fl(s){const e=s.name;if(M1.has(e))return Pa.debug(`There were multiple attempts to register component ${e}.`),!1;M1.set(e,s);for(const t of Au.values())I2(t,s);for(const t of hT.values())I2(t,s);return!0}function Kd(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function cs(s){return s==null?!1:s.settings!==void 0}const dT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Io=new Mu("app","Firebase",dT);class fT{constructor(e,t,o){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new Oo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Io.create("app-deleted",{appName:this._name})}}const yc=cT;function ug(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const o={name:D1,automaticDataCollectionEnabled:!0,...e},u=o.name;if(typeof u!="string"||!u)throw Io.create("bad-app-name",{appName:String(u)});if(t||(t=IE()),!t)throw Io.create("no-options");const g=Au.get(u);if(g){if(dl(t,g.options)&&dl(o,g.config))return g;throw Io.create("duplicate-app",{appName:u})}const x=new Ev(u);for(const b of M1.values())x.addComponent(b);const T=new fT(t,o,x);return Au.set(u,T),T}function Wd(s=D1){const e=Au.get(s);if(!e&&s===D1&&IE())return ug();if(!e)throw Io.create("no-app",{appName:s});return e}function DE(){return Array.from(Au.values())}function Ys(s,e,t){let o=uT[s]??s;t&&(o+=`-${t}`);const u=o.match(/\s|\//),g=e.match(/\s|\//);if(u||g){const x=[`Unable to register library "${o}" with version "${e}":`];u&&x.push(`library name "${o}" contains illegal characters (whitespace or "/")`),u&&g&&x.push("and"),g&&x.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pa.warn(x.join(" "));return}fl(new Oo(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}const gT="firebase-heartbeat-database",mT=1,bu="firebase-heartbeat-store";let p1=null;function ME(){return p1||(p1=Dv(gT,mT,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(bu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Io.create("idb-open",{originalErrorMessage:s.message})})),p1}async function pT(s){try{const t=(await ME()).transaction(bu),o=await t.objectStore(bu).get(kE(s));return await t.done,o}catch(e){if(e instanceof na)Pa.warn(e.message);else{const t=Io.create("idb-get",{originalErrorMessage:e?.message});Pa.warn(t.message)}}}async function R2(s,e){try{const o=(await ME()).transaction(bu,"readwrite");await o.objectStore(bu).put(e,kE(s)),await o.done}catch(t){if(t instanceof na)Pa.warn(t.message);else{const o=Io.create("idb-set",{originalErrorMessage:t?.message});Pa.warn(o.message)}}}function kE(s){return`${s.name}!${s.options.appId}`}const yT=1024,xT=30;class ET{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _T(t),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=N2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(u=>u.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:t}),this._heartbeatsCache.heartbeats.length>xT){const u=AT(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Pa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=N2(),{heartbeatsToSend:t,unsentEntries:o}=wT(this._heartbeatsCache.heartbeats),u=wd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(e){return Pa.warn(e),""}}}function N2(){return new Date().toISOString().substring(0,10)}function wT(s,e=yT){const t=[];let o=s.slice();for(const u of s){const g=t.find(x=>x.agent===u.agent);if(g){if(g.dates.push(u.date),O2(t)>e){g.dates.pop();break}}else if(t.push({agent:u.agent,dates:[u.date]}),O2(t)>e){t.pop();break}o=o.slice(1)}return{heartbeatsToSend:t,unsentEntries:o}}class _T{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ov()?lv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await pT(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const o=await this.read();return R2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const o=await this.read();return R2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function O2(s){return wd(JSON.stringify({version:2,heartbeats:s})).length}function AT(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let o=1;o<s.length;o++)s[o].date<t&&(t=s[o].date,e=o);return e}function bT(s){fl(new Oo("platform-logger",e=>new Lv(e),"PRIVATE")),fl(new Oo("heartbeat",e=>new ET(e),"PRIVATE")),Ys(O1,S2,s),Ys(O1,S2,"esm2020"),Ys("fire-js","")}bT("");var vT="firebase",TT="12.6.0";Ys(vT,TT,"app");function LE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CT=LE,PE=new Mu("auth","Firebase",LE());const _d=new lg("@firebase/auth");function ST(s,...e){_d.logLevel<=Tn.WARN&&_d.warn(`Auth (${yc}): ${s}`,...e)}function od(s,...e){_d.logLevel<=Tn.ERROR&&_d.error(`Auth (${yc}): ${s}`,...e)}function ks(s,...e){throw hg(s,...e)}function Ks(s,...e){return hg(s,...e)}function BE(s,e,t){const o={...CT(),[e]:t};return new Mu("auth","Firebase",o).create(e,{appName:s.name})}function Ma(s){return BE(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hg(s,...e){if(typeof s!="string"){const t=e[0],o=[...e.slice(1)];return o[0]&&(o[0].appName=s.name),s._errorFactory.create(t,...o)}return PE.create(s,...e)}function Gt(s,e,...t){if(!s)throw hg(e,...t)}function Oa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw od(e),new Error(e)}function Ba(s,e){s||Oa(e)}function k1(){return typeof self<"u"&&self.location?.href||""}function IT(){return D2()==="http:"||D2()==="https:"}function D2(){return typeof self<"u"&&self.location?.protocol||null}function RT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IT()||rv()||"connection"in navigator)?navigator.onLine:!0}function NT(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Lu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ba(t>e,"Short delay should be less than long delay!"),this.isMobile=ev()||iv()}get(){return RT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dg(s,e){Ba(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class VE{static initialize(e,t,o){this.fetchImpl=e,t&&(this.headersImpl=t),o&&(this.responseImpl=o)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Oa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Oa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Oa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const OT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const DT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],MT=new Lu(3e4,6e4);function ja(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ra(s,e,t,o,u={}){return UE(s,u,async()=>{let g={},x={};o&&(e==="GET"?x=o:g={body:JSON.stringify(o)});const T=ku({key:s.config.apiKey,...x}).slice(1),b=await s._getAdditionalHeaders();b["Content-Type"]="application/json",s.languageCode&&(b["X-Firebase-Locale"]=s.languageCode);const w={method:e,headers:b,...g};return nv()||(w.referrerPolicy="no-referrer"),s.emulatorConfig&&Vo(s.emulatorConfig.host)&&(w.credentials="include"),VE.fetch()(await FE(s,s.config.apiHost,t,T),w)})}async function UE(s,e,t){s._canInitEmulator=!1;const o={...OT,...e};try{const u=new LT(s),g=await Promise.race([t(),u.promise]);u.clearNetworkTimeout();const x=await g.json();if("needConfirmation"in x)throw ed(s,"account-exists-with-different-credential",x);if(g.ok&&!("errorMessage"in x))return x;{const T=g.ok?x.errorMessage:x.error.message,[b,w]=T.split(" : ");if(b==="FEDERATED_USER_ID_ALREADY_LINKED")throw ed(s,"credential-already-in-use",x);if(b==="EMAIL_EXISTS")throw ed(s,"email-already-in-use",x);if(b==="USER_DISABLED")throw ed(s,"user-disabled",x);const C=o[b]||b.toLowerCase().replace(/[_\s]+/g,"-");if(w)throw BE(s,C,w);ks(s,C)}}catch(u){if(u instanceof na)throw u;ks(s,"network-request-failed",{message:String(u)})}}async function Pu(s,e,t,o,u={}){const g=await ra(s,e,t,o,u);return"mfaPendingCredential"in g&&ks(s,"multi-factor-auth-required",{_serverResponse:g}),g}async function FE(s,e,t,o){const u=`${e}${t}?${o}`,g=s,x=g.config.emulator?dg(s.config,u):`${s.config.apiScheme}://${u}`;return DT.includes(t)&&(await g._persistenceManagerAvailable,g._getPersistenceType()==="COOKIE")?g._getPersistence()._getFinalTarget(x).toString():x}function kT(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class LT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,o)=>{this.timer=setTimeout(()=>o(Ks(this.auth,"network-request-failed")),MT.get())})}}function ed(s,e,t){const o={appName:s.name};t.email&&(o.email=t.email),t.phoneNumber&&(o.phoneNumber=t.phoneNumber);const u=Ks(s,e,o);return u.customData._tokenResponse=t,u}function M2(s){return s!==void 0&&s.enterprise!==void 0}class PT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return kT(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function BT(s,e){return ra(s,"GET","/v2/recaptchaConfig",ja(s,e))}async function VT(s,e){return ra(s,"POST","/v1/accounts:delete",e)}async function Ad(s,e){return ra(s,"POST","/v1/accounts:lookup",e)}function yu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UT(s,e=!1){const t=ir(s),o=await t.getIdToken(e),u=fg(o);Gt(u&&u.exp&&u.auth_time&&u.iat,t.auth,"internal-error");const g=typeof u.firebase=="object"?u.firebase:void 0,x=g?.sign_in_provider;return{claims:u,token:o,authTime:yu(y1(u.auth_time)),issuedAtTime:yu(y1(u.iat)),expirationTime:yu(y1(u.exp)),signInProvider:x||null,signInSecondFactor:g?.sign_in_second_factor||null}}function y1(s){return Number(s)*1e3}function fg(s){const[e,t,o]=s.split(".");if(e===void 0||t===void 0||o===void 0)return od("JWT malformed, contained fewer than 3 sections"),null;try{const u=TE(t);return u?JSON.parse(u):(od("Failed to decode base64 JWT payload"),null)}catch(u){return od("Caught error parsing JWT payload as JSON",u?.toString()),null}}function k2(s){const e=fg(s);return Gt(e,"internal-error"),Gt(typeof e.exp<"u","internal-error"),Gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function cc(s,e,t=!1){if(t)return e;try{return await e}catch(o){throw o instanceof na&&FT(o)&&s.auth.currentUser===s&&await s.auth.signOut(),o}}function FT({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class jT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const o=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class L1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yu(this.lastLoginAt),this.creationTime=yu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bd(s){const e=s.auth,t=await s.getIdToken(),o=await cc(s,Ad(e,{idToken:t}));Gt(o?.users.length,e,"internal-error");const u=o.users[0];s._notifyReloadListener(u);const g=u.providerUserInfo?.length?jE(u.providerUserInfo):[],x=HT(s.providerData,g),T=s.isAnonymous,b=!(s.email&&u.passwordHash)&&!x?.length,w=T?b:!1,C={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:x,metadata:new L1(u.createdAt,u.lastLoginAt),isAnonymous:w};Object.assign(s,C)}async function zT(s){const e=ir(s);await bd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function HT(s,e){return[...s.filter(o=>!e.some(u=>u.providerId===o.providerId)),...e]}function jE(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function GT(s,e){const t=await UE(s,{},async()=>{const o=ku({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:u,apiKey:g}=s.config,x=await FE(s,u,"/v1/token",`key=${g}`),T=await s._getAdditionalHeaders();T["Content-Type"]="application/x-www-form-urlencoded";const b={method:"POST",headers:T,body:o};return s.emulatorConfig&&Vo(s.emulatorConfig.host)&&(b.credentials="include"),VE.fetch()(x,b)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function qT(s,e){return ra(s,"POST","/v2/accounts:revokeToken",ja(s,e))}class ic{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Gt(e.idToken,"internal-error"),Gt(typeof e.idToken<"u","internal-error"),Gt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):k2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Gt(e.length!==0,"internal-error");const t=k2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:o,refreshToken:u,expiresIn:g}=await GT(e,t);this.updateTokensAndExpiration(o,u,Number(g))}updateTokensAndExpiration(e,t,o){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+o*1e3}static fromJSON(e,t){const{refreshToken:o,accessToken:u,expirationTime:g}=t,x=new ic;return o&&(Gt(typeof o=="string","internal-error",{appName:e}),x.refreshToken=o),u&&(Gt(typeof u=="string","internal-error",{appName:e}),x.accessToken=u),g&&(Gt(typeof g=="number","internal-error",{appName:e}),x.expirationTime=g),x}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ic,this.toJSON())}_performRefresh(){return Oa("not implemented")}}function wo(s,e){Gt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Ms{constructor({uid:e,auth:t,stsTokenManager:o,...u}){this.providerId="firebase",this.proactiveRefresh=new jT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=u.displayName||null,this.email=u.email||null,this.emailVerified=u.emailVerified||!1,this.phoneNumber=u.phoneNumber||null,this.photoURL=u.photoURL||null,this.isAnonymous=u.isAnonymous||!1,this.tenantId=u.tenantId||null,this.providerData=u.providerData?[...u.providerData]:[],this.metadata=new L1(u.createdAt||void 0,u.lastLoginAt||void 0)}async getIdToken(e){const t=await cc(this,this.stsTokenManager.getToken(this.auth,e));return Gt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return UT(this,e)}reload(){return zT(this)}_assign(e){this!==e&&(Gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ms({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let o=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),o=!0),t&&await bd(this),await this.auth._persistUserIfCurrent(this),o&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cs(this.auth.app))return Promise.reject(Ma(this.auth));const e=await this.getIdToken();return await cc(this,VT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const o=t.displayName??void 0,u=t.email??void 0,g=t.phoneNumber??void 0,x=t.photoURL??void 0,T=t.tenantId??void 0,b=t._redirectEventId??void 0,w=t.createdAt??void 0,C=t.lastLoginAt??void 0,{uid:R,emailVerified:P,isAnonymous:L,providerData:ee,stsTokenManager:re}=t;Gt(R&&re,e,"internal-error");const se=ic.fromJSON(this.name,re);Gt(typeof R=="string",e,"internal-error"),wo(o,e.name),wo(u,e.name),Gt(typeof P=="boolean",e,"internal-error"),Gt(typeof L=="boolean",e,"internal-error"),wo(g,e.name),wo(x,e.name),wo(T,e.name),wo(b,e.name),wo(w,e.name),wo(C,e.name);const Ye=new Ms({uid:R,auth:e,email:u,emailVerified:P,displayName:o,isAnonymous:L,photoURL:x,phoneNumber:g,tenantId:T,stsTokenManager:se,createdAt:w,lastLoginAt:C});return ee&&Array.isArray(ee)&&(Ye.providerData=ee.map(Oe=>({...Oe}))),b&&(Ye._redirectEventId=b),Ye}static async _fromIdTokenResponse(e,t,o=!1){const u=new ic;u.updateFromServerResponse(t);const g=new Ms({uid:t.localId,auth:e,stsTokenManager:u,isAnonymous:o});return await bd(g),g}static async _fromGetAccountInfoResponse(e,t,o){const u=t.users[0];Gt(u.localId!==void 0,"internal-error");const g=u.providerUserInfo!==void 0?jE(u.providerUserInfo):[],x=!(u.email&&u.passwordHash)&&!g?.length,T=new ic;T.updateFromIdToken(o);const b=new Ms({uid:u.localId,auth:e,stsTokenManager:T,isAnonymous:x}),w={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:g,metadata:new L1(u.createdAt,u.lastLoginAt),isAnonymous:!(u.email&&u.passwordHash)&&!g?.length};return Object.assign(b,w),b}}const L2=new Map;function Da(s){Ba(s instanceof Function,"Expected a class definition");let e=L2.get(s);return e?(Ba(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,L2.set(s,e),e)}class zE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}zE.type="NONE";const P2=zE;function ld(s,e,t){return`firebase:${s}:${e}:${t}`}class sc{constructor(e,t,o){this.persistence=e,this.auth=t,this.userKey=o;const{config:u,name:g}=this.auth;this.fullUserKey=ld(this.userKey,u.apiKey,g),this.fullPersistenceKey=ld("persistence",u.apiKey,g),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ad(this.auth,{idToken:e}).catch(()=>{});return t?Ms._fromGetAccountInfoResponse(this.auth,t,e):null}return Ms._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,o="authUser"){if(!t.length)return new sc(Da(P2),e,o);const u=(await Promise.all(t.map(async w=>{if(await w._isAvailable())return w}))).filter(w=>w);let g=u[0]||Da(P2);const x=ld(o,e.config.apiKey,e.name);let T=null;for(const w of t)try{const C=await w._get(x);if(C){let R;if(typeof C=="string"){const P=await Ad(e,{idToken:C}).catch(()=>{});if(!P)break;R=await Ms._fromGetAccountInfoResponse(e,P,C)}else R=Ms._fromJSON(e,C);w!==g&&(T=R),g=w;break}}catch{}const b=u.filter(w=>w._shouldAllowMigration);return!g._shouldAllowMigration||!b.length?new sc(g,e,o):(g=b[0],T&&await g._set(x,T.toJSON()),await Promise.all(t.map(async w=>{if(w!==g)try{await w._remove(x)}catch{}})),new sc(g,e,o))}}function B2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(XE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(HE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(KE(e))return"Blackberry";if(WE(e))return"Webos";if(GE(e))return"Safari";if((e.includes("chrome/")||qE(e))&&!e.includes("edge/"))return"Chrome";if(YE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,o=s.match(t);if(o?.length===2)return o[1]}return"Other"}function HE(s=vi()){return/firefox\//i.test(s)}function GE(s=vi()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function qE(s=vi()){return/crios\//i.test(s)}function XE(s=vi()){return/iemobile/i.test(s)}function YE(s=vi()){return/android/i.test(s)}function KE(s=vi()){return/blackberry/i.test(s)}function WE(s=vi()){return/webos/i.test(s)}function gg(s=vi()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function XT(s=vi()){return gg(s)&&!!window.navigator?.standalone}function YT(){return sv()&&document.documentMode===10}function QE(s=vi()){return gg(s)||YE(s)||WE(s)||KE(s)||/windows phone/i.test(s)||XE(s)}function ZE(s,e=[]){let t;switch(s){case"Browser":t=B2(vi());break;case"Worker":t=`${B2(vi())}-${s}`;break;default:t=s}const o=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${yc}/${o}`}class KT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const o=g=>new Promise((x,T)=>{try{const b=e(g);x(b)}catch(b){T(b)}});o.onAbort=t,this.queue.push(o);const u=this.queue.length-1;return()=>{this.queue[u]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const o of this.queue)await o(e),o.onAbort&&t.push(o.onAbort)}catch(o){t.reverse();for(const u of t)try{u()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:o?.message})}}}async function WT(s,e={}){return ra(s,"GET","/v2/passwordPolicy",ja(s,e))}const QT=6;class ZT{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??QT,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const o=this.customStrengthOptions.minPasswordLength,u=this.customStrengthOptions.maxPasswordLength;o&&(t.meetsMinPasswordLength=e.length>=o),u&&(t.meetsMaxPasswordLength=e.length<=u)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let o;for(let u=0;u<e.length;u++)o=e.charAt(u),this.updatePasswordCharacterOptionsStatuses(t,o>="a"&&o<="z",o>="A"&&o<="Z",o>="0"&&o<="9",this.allowedNonAlphanumericCharacters.includes(o))}updatePasswordCharacterOptionsStatuses(e,t,o,u,g){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=o)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=u)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=g))}}class JT{constructor(e,t,o,u){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=o,this.config=u,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new V2(this),this.idTokenSubscription=new V2(this),this.beforeStateQueue=new KT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=u.sdkClientVersion,this._persistenceManagerAvailable=new Promise(g=>this._resolvePersistenceManagerAvailable=g)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Da(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await sc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ad(this,{idToken:e}),o=await Ms._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(o)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(cs(this.app)){const g=this.app.settings.authIdToken;return g?new Promise(x=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(g).then(x,x))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let o=t,u=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const g=this.redirectUser?._redirectEventId,x=o?._redirectEventId,T=await this.tryRedirectSignIn(e);(!g||g===x)&&T?.user&&(o=T.user,u=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(u)try{await this.beforeStateQueue.runMiddleware(o)}catch(g){o=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(g))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cs(this.app))return Promise.reject(Ma(this));const t=e?ir(e):null;return t&&Gt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cs(this.app)?Promise.reject(Ma(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cs(this.app)?Promise.reject(Ma(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Da(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WT(this),t=new ZT(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Mu("auth","Firebase",e())}onAuthStateChanged(e,t,o){return this.registerStateListener(this.authStateSubscription,e,t,o)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,o){return this.registerStateListener(this.idTokenSubscription,e,t,o)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const o=this.onAuthStateChanged(()=>{o(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),o={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(o.tenantId=this.tenantId),await qT(this,o)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const o=await this.getOrInitRedirectPersistenceManager(t);return e===null?o.removeCurrentUser():o.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Da(e)||this._popupRedirectResolver;Gt(t,this,"argument-error"),this.redirectPersistenceManager=await sc.create(this,[Da(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,o,u){if(this._deleted)return()=>{};const g=typeof t=="function"?t:t.next.bind(t);let x=!1;const T=this._isInitialized?Promise.resolve():this._initializationPromise;if(Gt(T,this,"internal-error"),T.then(()=>{x||g(this.currentUser)}),typeof t=="function"){const b=e.addObserver(t,o,u);return()=>{x=!0,b()}}else{const b=e.addObserver(t);return()=>{x=!0,b()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const o=await this._getAppCheckToken();return o&&(e["X-Firebase-AppCheck"]=o),e}async _getAppCheckToken(){if(cs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ST(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Uo(s){return ir(s)}class V2{constructor(e){this.auth=e,this.observer=null,this.addObserver=fv(t=>this.observer=t)}get next(){return Gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Qd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $T(s){Qd=s}function JE(s){return Qd.loadJS(s)}function eC(){return Qd.recaptchaEnterpriseScript}function tC(){return Qd.gapiScript}function nC(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class rC{constructor(){this.enterprise=new iC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class iC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const sC="recaptcha-enterprise",$E="NO_RECAPTCHA";class aC{constructor(e){this.type=sC,this.auth=Uo(e)}async verify(e="verify",t=!1){async function o(g){if(!t){if(g.tenantId==null&&g._agentRecaptchaConfig!=null)return g._agentRecaptchaConfig.siteKey;if(g.tenantId!=null&&g._tenantRecaptchaConfigs[g.tenantId]!==void 0)return g._tenantRecaptchaConfigs[g.tenantId].siteKey}return new Promise(async(x,T)=>{BT(g,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(b=>{if(b.recaptchaKey===void 0)T(new Error("recaptcha Enterprise site key undefined"));else{const w=new PT(b);return g.tenantId==null?g._agentRecaptchaConfig=w:g._tenantRecaptchaConfigs[g.tenantId]=w,x(w.siteKey)}}).catch(b=>{T(b)})})}function u(g,x,T){const b=window.grecaptcha;M2(b)?b.enterprise.ready(()=>{b.enterprise.execute(g,{action:e}).then(w=>{x(w)}).catch(()=>{x($E)})}):T(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new rC().execute("siteKey",{action:"verify"}):new Promise((g,x)=>{o(this.auth).then(T=>{if(!t&&M2(window.grecaptcha))u(T,g,x);else{if(typeof window>"u"){x(new Error("RecaptchaVerifier is only supported in browser"));return}let b=eC();b.length!==0&&(b+=T),JE(b).then(()=>{u(T,g,x)}).catch(w=>{x(w)})}}).catch(T=>{x(T)})})}}async function U2(s,e,t,o=!1,u=!1){const g=new aC(s);let x;if(u)x=$E;else try{x=await g.verify(t)}catch{x=await g.verify(t,!0)}const T={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in T){const b=T.phoneEnrollmentInfo.phoneNumber,w=T.phoneEnrollmentInfo.recaptchaToken;Object.assign(T,{phoneEnrollmentInfo:{phoneNumber:b,recaptchaToken:w,captchaResponse:x,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in T){const b=T.phoneSignInInfo.recaptchaToken;Object.assign(T,{phoneSignInInfo:{recaptchaToken:b,captchaResponse:x,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return T}return o?Object.assign(T,{captchaResp:x}):Object.assign(T,{captchaResponse:x}),Object.assign(T,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(T,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),T}async function vd(s,e,t,o,u){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const g=await U2(s,e,t,t==="getOobCode");return o(s,g)}else return o(s,e).catch(async g=>{if(g.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const x=await U2(s,e,t,t==="getOobCode");return o(s,x)}else return Promise.reject(g)})}function oC(s,e){const t=Kd(s,"auth");if(t.isInitialized()){const u=t.getImmediate(),g=t.getOptions();if(dl(g,e??{}))return u;ks(u,"already-initialized")}return t.initialize({options:e})}function lC(s,e){const t=e?.persistence||[],o=(Array.isArray(t)?t:[t]).map(Da);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(o,e?.popupRedirectResolver)}function cC(s,e,t){const o=Uo(s);Gt(/^https?:\/\//.test(e),o,"invalid-emulator-scheme");const u=!1,g=ew(e),{host:x,port:T}=uC(e),b=T===null?"":`:${T}`,w={url:`${g}//${x}${b}/`},C=Object.freeze({host:x,port:T,protocol:g.replace(":",""),options:Object.freeze({disableWarnings:u})});if(!o._canInitEmulator){Gt(o.config.emulator&&o.emulatorConfig,o,"emulator-config-failed"),Gt(dl(w,o.config.emulator)&&dl(C,o.emulatorConfig),o,"emulator-config-failed");return}o.config.emulator=w,o.emulatorConfig=C,o.settings.appVerificationDisabledForTesting=!0,Vo(x)?(ag(`${g}//${x}${b}`),og("Auth",!0)):hC()}function ew(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function uC(s){const e=ew(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const o=t[2].split("@").pop()||"",u=/^(\[[^\]]+\])(:|$)/.exec(o);if(u){const g=u[1];return{host:g,port:F2(o.substr(g.length+1))}}else{const[g,x]=o.split(":");return{host:g,port:F2(x)}}}function F2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function hC(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class mg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Oa("not implemented")}_getIdTokenResponse(e){return Oa("not implemented")}_linkToIdToken(e,t){return Oa("not implemented")}_getReauthenticationResolver(e){return Oa("not implemented")}}async function dC(s,e){return ra(s,"POST","/v1/accounts:update",e)}async function fC(s,e){return ra(s,"POST","/v1/accounts:signUp",e)}async function gC(s,e){return Pu(s,"POST","/v1/accounts:signInWithPassword",ja(s,e))}async function tw(s,e){return ra(s,"POST","/v1/accounts:sendOobCode",ja(s,e))}async function mC(s,e){return tw(s,e)}async function pC(s,e){return tw(s,e)}async function yC(s,e){return Pu(s,"POST","/v1/accounts:signInWithEmailLink",ja(s,e))}async function xC(s,e){return Pu(s,"POST","/v1/accounts:signInWithEmailLink",ja(s,e))}class vu extends mg{constructor(e,t,o,u=null){super("password",o),this._email=e,this._password=t,this._tenantId=u}static _fromEmailAndPassword(e,t){return new vu(e,t,"password")}static _fromEmailAndCode(e,t,o=null){return new vu(e,t,"emailLink",o)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vd(e,t,"signInWithPassword",gC);case"emailLink":return yC(e,{email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const o={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vd(e,o,"signUpPassword",fC);case"emailLink":return xC(e,{idToken:t,email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ac(s,e){return Pu(s,"POST","/v1/accounts:signInWithIdp",ja(s,e))}const EC="http://localhost";class gl extends mg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ks("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:o,signInMethod:u,...g}=t;if(!o||!u)return null;const x=new gl(o,u);return x.idToken=g.idToken||void 0,x.accessToken=g.accessToken||void 0,x.secret=g.secret,x.nonce=g.nonce,x.pendingToken=g.pendingToken||null,x}_getIdTokenResponse(e){const t=this.buildRequest();return ac(e,t)}_linkToIdToken(e,t){const o=this.buildRequest();return o.idToken=t,ac(e,o)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ac(e,t)}buildRequest(){const e={requestUri:EC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ku(t)}return e}}function wC(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _C(s){const e=cu(uu(s)).link,t=e?cu(uu(e)).deep_link_id:null,o=cu(uu(s)).deep_link_id;return(o?cu(uu(o)).link:null)||o||t||e||s}class pg{constructor(e){const t=cu(uu(e)),o=t.apiKey??null,u=t.oobCode??null,g=wC(t.mode??null);Gt(o&&u&&g,"argument-error"),this.apiKey=o,this.operation=g,this.code=u,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=_C(e);try{return new pg(t)}catch{return null}}}class El{constructor(){this.providerId=El.PROVIDER_ID}static credential(e,t){return vu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const o=pg.parseLink(t);return Gt(o,"argument-error"),vu._fromEmailAndCode(e,o.code,o.tenantId)}}El.PROVIDER_ID="password";El.EMAIL_PASSWORD_SIGN_IN_METHOD="password";El.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class nw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Bu extends nw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class _o extends Bu{constructor(){super("facebook.com")}static credential(e){return gl._fromParams({providerId:_o.PROVIDER_ID,signInMethod:_o.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _o.credentialFromTaggedObject(e)}static credentialFromError(e){return _o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _o.credential(e.oauthAccessToken)}catch{return null}}}_o.FACEBOOK_SIGN_IN_METHOD="facebook.com";_o.PROVIDER_ID="facebook.com";class Ao extends Bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:o}=e;if(!t&&!o)return null;try{return Ao.credential(t,o)}catch{return null}}}Ao.GOOGLE_SIGN_IN_METHOD="google.com";Ao.PROVIDER_ID="google.com";class bo extends Bu{constructor(){super("github.com")}static credential(e){return gl._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bo.credential(e.oauthAccessToken)}catch{return null}}}bo.GITHUB_SIGN_IN_METHOD="github.com";bo.PROVIDER_ID="github.com";class vo extends Bu{constructor(){super("twitter.com")}static credential(e,t){return gl._fromParams({providerId:vo.PROVIDER_ID,signInMethod:vo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vo.credentialFromTaggedObject(e)}static credentialFromError(e){return vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:o}=e;if(!t||!o)return null;try{return vo.credential(t,o)}catch{return null}}}vo.TWITTER_SIGN_IN_METHOD="twitter.com";vo.PROVIDER_ID="twitter.com";async function AC(s,e){return Pu(s,"POST","/v1/accounts:signUp",ja(s,e))}class ml{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,o,u=!1){const g=await Ms._fromIdTokenResponse(e,o,u),x=j2(o);return new ml({user:g,providerId:x,_tokenResponse:o,operationType:t})}static async _forOperation(e,t,o){await e._updateTokensIfNecessary(o,!0);const u=j2(o);return new ml({user:e,providerId:u,_tokenResponse:o,operationType:t})}}function j2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Td extends na{constructor(e,t,o,u){super(t.code,t.message),this.operationType=o,this.user=u,Object.setPrototypeOf(this,Td.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:o}}static _fromErrorAndOperation(e,t,o,u){return new Td(e,t,o,u)}}function rw(s,e,t,o){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(g=>{throw g.code==="auth/multi-factor-auth-required"?Td._fromErrorAndOperation(s,g,e,o):g})}async function bC(s,e,t=!1){const o=await cc(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return ml._forOperation(s,"link",o)}async function iw(s,e,t=!1){const{auth:o}=s;if(cs(o.app))return Promise.reject(Ma(o));const u="reauthenticate";try{const g=await cc(s,rw(o,u,e,s),t);Gt(g.idToken,o,"internal-error");const x=fg(g.idToken);Gt(x,o,"internal-error");const{sub:T}=x;return Gt(s.uid===T,o,"user-mismatch"),ml._forOperation(s,u,g)}catch(g){throw g?.code==="auth/user-not-found"&&ks(o,"user-mismatch"),g}}async function sw(s,e,t=!1){if(cs(s.app))return Promise.reject(Ma(s));const o="signIn",u=await rw(s,o,e),g=await ml._fromIdTokenResponse(s,o,u);return t||await s._updateCurrentUser(g.user),g}async function vC(s,e){return sw(Uo(s),e)}async function TC(s,e){return iw(ir(s),e)}async function aw(s){const e=Uo(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function CC(s,e,t){const o=Uo(s);await vd(o,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",mC)}async function cd(s,e,t){if(cs(s.app))return Promise.reject(Ma(s));const o=Uo(s),x=await vd(o,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",AC).catch(b=>{throw b.code==="auth/password-does-not-meet-requirements"&&aw(s),b}),T=await ml._fromIdTokenResponse(o,"signIn",x);return await o._updateCurrentUser(T.user),T}function SC(s,e,t){return cs(s.app)?Promise.reject(Ma(s)):vC(ir(s),El.credential(e,t)).catch(async o=>{throw o.code==="auth/password-does-not-meet-requirements"&&aw(s),o})}async function z2(s,e,t){const o=ir(s),g={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await s.getIdToken(),newEmail:e},{email:x}=await pC(o.auth,g);x!==s.email&&await s.reload()}function IC(s,e){return RC(ir(s),null,e)}async function RC(s,e,t){const{auth:o}=s,g={idToken:await s.getIdToken(),returnSecureToken:!0};t&&(g.password=t);const x=await cc(s,dC(o,g));await s._updateTokensIfNecessary(x,!0)}function NC(s,e,t,o){return ir(s).onIdTokenChanged(e,t,o)}function OC(s,e,t){return ir(s).beforeAuthStateChanged(e,t)}function DC(s,e,t,o){return ir(s).onAuthStateChanged(e,t,o)}function MC(s){return ir(s).signOut()}const Cd="__sak";class ow{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Cd,"1"),this.storage.removeItem(Cd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const kC=1e3,LC=10;class lw extends ow{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=QE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const o=this.storage.getItem(t),u=this.localCache[t];o!==u&&e(t,u,o)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((x,T,b)=>{this.notifyListeners(x,b)});return}const o=e.key;t?this.detachListener():this.stopPolling();const u=()=>{const x=this.storage.getItem(o);!t&&this.localCache[o]===x||this.notifyListeners(o,x)},g=this.storage.getItem(o);YT()&&g!==e.newValue&&e.newValue!==e.oldValue?setTimeout(u,LC):u()}notifyListeners(e,t){this.localCache[e]=t;const o=this.listeners[e];if(o)for(const u of Array.from(o))u(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,o)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:o}),!0)})},kC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}lw.type="LOCAL";const PC=lw;class cw extends ow{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}cw.type="SESSION";const uw=cw;function BC(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Zd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(u=>u.isListeningto(e));if(t)return t;const o=new Zd(e);return this.receivers.push(o),o}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:o,eventType:u,data:g}=t.data,x=this.handlersMap[u];if(!x?.size)return;t.ports[0].postMessage({status:"ack",eventId:o,eventType:u});const T=Array.from(x).map(async w=>w(t.origin,g)),b=await BC(T);t.ports[0].postMessage({status:"done",eventId:o,eventType:u,response:b})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zd.receivers=[];function yg(s="",e=10){let t="";for(let o=0;o<e;o++)t+=Math.floor(Math.random()*10);return s+t}class VC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,o=50){const u=typeof MessageChannel<"u"?new MessageChannel:null;if(!u)throw new Error("connection_unavailable");let g,x;return new Promise((T,b)=>{const w=yg("",20);u.port1.start();const C=setTimeout(()=>{b(new Error("unsupported_event"))},o);x={messageChannel:u,onMessage(R){const P=R;if(P.data.eventId===w)switch(P.data.status){case"ack":clearTimeout(C),g=setTimeout(()=>{b(new Error("timeout"))},3e3);break;case"done":clearTimeout(g),T(P.data.response);break;default:clearTimeout(C),clearTimeout(g),b(new Error("invalid_response"));break}}},this.handlers.add(x),u.port1.addEventListener("message",x.onMessage),this.target.postMessage({eventType:e,eventId:w,data:t},[u.port2])}).finally(()=>{x&&this.removeMessageHandler(x)})}}function Ws(){return window}function UC(s){Ws().location.href=s}function hw(){return typeof Ws().WorkerGlobalScope<"u"&&typeof Ws().importScripts=="function"}async function FC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jC(){return navigator?.serviceWorker?.controller||null}function zC(){return hw()?self:null}const dw="firebaseLocalStorageDb",HC=1,Sd="firebaseLocalStorage",fw="fbase_key";class Vu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Jd(s,e){return s.transaction([Sd],e?"readwrite":"readonly").objectStore(Sd)}function GC(){const s=indexedDB.deleteDatabase(dw);return new Vu(s).toPromise()}function P1(){const s=indexedDB.open(dw,HC);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const o=s.result;try{o.createObjectStore(Sd,{keyPath:fw})}catch(u){t(u)}}),s.addEventListener("success",async()=>{const o=s.result;o.objectStoreNames.contains(Sd)?e(o):(o.close(),await GC(),e(await P1()))})})}async function H2(s,e,t){const o=Jd(s,!0).put({[fw]:e,value:t});return new Vu(o).toPromise()}async function qC(s,e){const t=Jd(s,!1).get(e),o=await new Vu(t).toPromise();return o===void 0?null:o.value}function G2(s,e){const t=Jd(s,!0).delete(e);return new Vu(t).toPromise()}const XC=800,YC=3;class gw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await P1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const o=await this._openDb();return await e(o)}catch(o){if(t++>YC)throw o;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zd._getInstance(zC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await FC(),!this.activeServiceWorker)return;this.sender=new VC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await P1();return await H2(e,Cd,"1"),await G2(e,Cd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(o=>H2(o,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(o=>qC(o,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>G2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(u=>{const g=Jd(u,!1).getAll();return new Vu(g).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],o=new Set;if(e.length!==0)for(const{fbase_key:u,value:g}of e)o.add(u),JSON.stringify(this.localCache[u])!==JSON.stringify(g)&&(this.notifyListeners(u,g),t.push(u));for(const u of Object.keys(this.localCache))this.localCache[u]&&!o.has(u)&&(this.notifyListeners(u,null),t.push(u));return t}notifyListeners(e,t){this.localCache[e]=t;const o=this.listeners[e];if(o)for(const u of Array.from(o))u(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),XC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gw.type="LOCAL";const KC=gw;new Lu(3e4,6e4);function WC(s,e){return e?Da(e):(Gt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class xg extends mg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ac(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ac(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ac(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function QC(s){return sw(s.auth,new xg(s),s.bypassAuthState)}function ZC(s){const{auth:e,user:t}=s;return Gt(t,e,"internal-error"),iw(t,new xg(s),s.bypassAuthState)}async function JC(s){const{auth:e,user:t}=s;return Gt(t,e,"internal-error"),bC(t,new xg(s),s.bypassAuthState)}class mw{constructor(e,t,o,u,g=!1){this.auth=e,this.resolver=o,this.user=u,this.bypassAuthState=g,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(o){this.reject(o)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:o,postBody:u,tenantId:g,error:x,type:T}=e;if(x){this.reject(x);return}const b={auth:this.auth,requestUri:t,sessionId:o,tenantId:g||void 0,postBody:u||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(T)(b))}catch(w){this.reject(w)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QC;case"linkViaPopup":case"linkViaRedirect":return JC;case"reauthViaPopup":case"reauthViaRedirect":return ZC;default:ks(this.auth,"internal-error")}}resolve(e){Ba(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ba(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $C=new Lu(2e3,1e4);class tc extends mw{constructor(e,t,o,u,g){super(e,t,u,g),this.provider=o,this.authWindow=null,this.pollId=null,tc.currentPopupAction&&tc.currentPopupAction.cancel(),tc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Gt(e,this.auth,"internal-error"),e}async onExecution(){Ba(this.filter.length===1,"Popup operations only handle one event");const e=yg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ks(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ks(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ks(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$C.get())};e()}}tc.currentPopupAction=null;const e3="pendingRedirect",ud=new Map;class t3 extends mw{constructor(e,t,o=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,o),this.eventId=null}async execute(){let e=ud.get(this.auth._key());if(!e){try{const o=await n3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(o)}catch(t){e=()=>Promise.reject(t)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function n3(s,e){const t=s3(e),o=i3(s);if(!await o._isAvailable())return!1;const u=await o._get(t)==="true";return await o._remove(t),u}function r3(s,e){ud.set(s._key(),e)}function i3(s){return Da(s._redirectPersistence)}function s3(s){return ld(e3,s.config.apiKey,s.name)}async function a3(s,e,t=!1){if(cs(s.app))return Promise.reject(Ma(s));const o=Uo(s),u=WC(o,e),x=await new t3(o,u,t).execute();return x&&!t&&(delete x.user._redirectEventId,await o._persistUserIfCurrent(x.user),await o._setRedirectUser(null,e)),x}const o3=600*1e3;class l3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(o=>{this.isEventForConsumer(e,o)&&(t=!0,this.sendToConsumer(e,o),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c3(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!pw(e)){const o=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ks(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const o=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&o}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=o3&&this.cachedEventUids.clear(),this.cachedEventUids.has(q2(e))}saveEventToCache(e){this.cachedEventUids.add(q2(e)),this.lastProcessedEventTime=Date.now()}}function q2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function pw({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function c3(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pw(s);default:return!1}}async function u3(s,e={}){return ra(s,"GET","/v1/projects",e)}const h3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,d3=/^https?/;async function f3(s){if(s.config.emulator)return;const{authorizedDomains:e}=await u3(s);for(const t of e)try{if(g3(t))return}catch{}ks(s,"unauthorized-domain")}function g3(s){const e=k1(),{protocol:t,hostname:o}=new URL(e);if(s.startsWith("chrome-extension://")){const x=new URL(s);return x.hostname===""&&o===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&x.hostname===o}if(!d3.test(t))return!1;if(h3.test(s))return o===s;const u=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+u+"|"+u+")$","i").test(o)}const m3=new Lu(3e4,6e4);function X2(){const s=Ws().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function p3(s){return new Promise((e,t)=>{function o(){X2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{X2(),t(Ks(s,"network-request-failed"))},timeout:m3.get()})}if(Ws().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ws().gapi?.load)o();else{const u=nC("iframefcb");return Ws()[u]=()=>{gapi.load?o():t(Ks(s,"network-request-failed"))},JE(`${tC()}?onload=${u}`).catch(g=>t(g))}}).catch(e=>{throw hd=null,e})}let hd=null;function y3(s){return hd=hd||p3(s),hd}const x3=new Lu(5e3,15e3),E3="__/auth/iframe",w3="emulator/auth/iframe",_3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},A3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b3(s){const e=s.config;Gt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?dg(e,w3):`https://${s.config.authDomain}/${E3}`,o={apiKey:e.apiKey,appName:s.name,v:yc},u=A3.get(s.config.apiHost);u&&(o.eid=u);const g=s._getFrameworks();return g.length&&(o.fw=g.join(",")),`${t}?${ku(o).slice(1)}`}async function v3(s){const e=await y3(s),t=Ws().gapi;return Gt(t,s,"internal-error"),e.open({where:document.body,url:b3(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_3,dontclear:!0},o=>new Promise(async(u,g)=>{await o.restyle({setHideOnLeave:!1});const x=Ks(s,"network-request-failed"),T=Ws().setTimeout(()=>{g(x)},x3.get());function b(){Ws().clearTimeout(T),u(o)}o.ping(b).then(b,()=>{g(x)})}))}const T3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},C3=500,S3=600,I3="_blank",R3="http://localhost";class Y2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function N3(s,e,t,o=C3,u=S3){const g=Math.max((window.screen.availHeight-u)/2,0).toString(),x=Math.max((window.screen.availWidth-o)/2,0).toString();let T="";const b={...T3,width:o.toString(),height:u.toString(),top:g,left:x},w=vi().toLowerCase();t&&(T=qE(w)?I3:t),HE(w)&&(e=e||R3,b.scrollbars="yes");const C=Object.entries(b).reduce((P,[L,ee])=>`${P}${L}=${ee},`,"");if(XT(w)&&T!=="_self")return O3(e||"",T),new Y2(null);const R=window.open(e||"",T,C);Gt(R,s,"popup-blocked");try{R.focus()}catch{}return new Y2(R)}function O3(s,e){const t=document.createElement("a");t.href=s,t.target=e;const o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(o)}const D3="__/auth/handler",M3="emulator/auth/handler",k3=encodeURIComponent("fac");async function K2(s,e,t,o,u,g){Gt(s.config.authDomain,s,"auth-domain-config-required"),Gt(s.config.apiKey,s,"invalid-api-key");const x={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:o,v:yc,eventId:u};if(e instanceof nw){e.setDefaultLanguage(s.languageCode),x.providerId=e.providerId||"",dv(e.getCustomParameters())||(x.customParameters=JSON.stringify(e.getCustomParameters()));for(const[C,R]of Object.entries({}))x[C]=R}if(e instanceof Bu){const C=e.getScopes().filter(R=>R!=="");C.length>0&&(x.scopes=C.join(","))}s.tenantId&&(x.tid=s.tenantId);const T=x;for(const C of Object.keys(T))T[C]===void 0&&delete T[C];const b=await s._getAppCheckToken(),w=b?`#${k3}=${encodeURIComponent(b)}`:"";return`${L3(s)}?${ku(T).slice(1)}${w}`}function L3({config:s}){return s.emulator?dg(s,M3):`https://${s.authDomain}/${D3}`}const x1="webStorageSupport";class P3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uw,this._completeRedirectFn=a3,this._overrideRedirectResult=r3}async _openPopup(e,t,o,u){Ba(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const g=await K2(e,t,o,k1(),u);return N3(e,g,yg())}async _openRedirect(e,t,o,u){await this._originValidation(e);const g=await K2(e,t,o,k1(),u);return UC(g),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:u,promise:g}=this.eventManagers[t];return u?Promise.resolve(u):(Ba(g,"If manager is not set, promise should be"),g)}const o=this.initAndGetManager(e);return this.eventManagers[t]={promise:o},o.catch(()=>{delete this.eventManagers[t]}),o}async initAndGetManager(e){const t=await v3(e),o=new l3(e);return t.register("authEvent",u=>(Gt(u?.authEvent,e,"invalid-auth-event"),{status:o.onEvent(u.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:o},this.iframes[e._key()]=t,o}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(x1,{type:x1},u=>{const g=u?.[0]?.[x1];g!==void 0&&t(!!g),ks(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=f3(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return QE()||GE()||gg()}}const B3=P3;var W2="@firebase/auth",Q2="1.11.1";class V3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(o=>{e(o?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function U3(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function F3(s){fl(new Oo("auth",(e,{options:t})=>{const o=e.getProvider("app").getImmediate(),u=e.getProvider("heartbeat"),g=e.getProvider("app-check-internal"),{apiKey:x,authDomain:T}=o.options;Gt(x&&!x.includes(":"),"invalid-api-key",{appName:o.name});const b={apiKey:x,authDomain:T,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZE(s)},w=new JT(o,u,g,b);return lC(w,t),w},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,o)=>{e.getProvider("auth-internal").initialize()})),fl(new Oo("auth-internal",e=>{const t=Uo(e.getProvider("auth").getImmediate());return(o=>new V3(o))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ys(W2,Q2,U3(s)),Ys(W2,Q2,"esm2020")}const j3=300,z3=RE("authIdTokenMaxAge")||j3;let Z2=null;const H3=s=>async e=>{const t=e&&await e.getIdTokenResult(),o=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(o&&o>z3)return;const u=t?.token;Z2!==u&&(Z2=u,await fetch(s,{method:u?"POST":"DELETE",headers:u?{Authorization:`Bearer ${u}`}:{}}))};function yw(s=Wd()){const e=Kd(s,"auth");if(e.isInitialized())return e.getImmediate();const t=oC(s,{popupRedirectResolver:B3,persistence:[KC,PC,uw]}),o=RE("authTokenSyncURL");if(o&&typeof isSecureContext=="boolean"&&isSecureContext){const g=new URL(o,location.origin);if(location.origin===g.origin){const x=H3(g.toString());OC(t,x,()=>x(t.currentUser)),NC(t,T=>x(T))}}const u=CE("auth");return u&&cC(t,`http://${u}`),t}function G3(){return document.getElementsByTagName("head")?.[0]??document}$T({loadJS(s){return new Promise((e,t)=>{const o=document.createElement("script");o.setAttribute("src",s),o.onload=e,o.onerror=u=>{const g=Ks("internal-error");g.customData=u,t(g)},o.type="text/javascript",o.charset="UTF-8",G3().appendChild(o)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});F3("Browser");var J2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ro,xw;(function(){var s;function e(F,z){function U(){}U.prototype=z.prototype,F.F=z.prototype,F.prototype=new U,F.prototype.constructor=F,F.D=function(J,X,Y){for(var G=Array(arguments.length-2),at=2;at<arguments.length;at++)G[at-2]=arguments[at];return z.prototype[X].apply(J,G)}}function t(){this.blockSize=-1}function o(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(o,t),o.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function u(F,z,U){U||(U=0);const J=Array(16);if(typeof z=="string")for(var X=0;X<16;++X)J[X]=z.charCodeAt(U++)|z.charCodeAt(U++)<<8|z.charCodeAt(U++)<<16|z.charCodeAt(U++)<<24;else for(X=0;X<16;++X)J[X]=z[U++]|z[U++]<<8|z[U++]<<16|z[U++]<<24;z=F.g[0],U=F.g[1],X=F.g[2];let Y=F.g[3],G;G=z+(Y^U&(X^Y))+J[0]+3614090360&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[1]+3905402710&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[2]+606105819&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[3]+3250441966&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(Y^U&(X^Y))+J[4]+4118548399&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[5]+1200080426&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[6]+2821735955&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[7]+4249261313&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(Y^U&(X^Y))+J[8]+1770035416&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[9]+2336552879&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[10]+4294925233&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[11]+2304563134&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(Y^U&(X^Y))+J[12]+1804603682&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[13]+4254626195&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[14]+2792965006&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[15]+1236535329&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(X^Y&(U^X))+J[1]+4129170786&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[6]+3225465664&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[11]+643717713&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[0]+3921069994&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(X^Y&(U^X))+J[5]+3593408605&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[10]+38016083&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[15]+3634488961&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[4]+3889429448&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(X^Y&(U^X))+J[9]+568446438&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[14]+3275163606&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[3]+4107603335&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[8]+1163531501&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(X^Y&(U^X))+J[13]+2850285829&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[2]+4243563512&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[7]+1735328473&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[12]+2368359562&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(U^X^Y)+J[5]+4294588738&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[8]+2272392833&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[11]+1839030562&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[14]+4259657740&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(U^X^Y)+J[1]+2763975236&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[4]+1272893353&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[7]+4139469664&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[10]+3200236656&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(U^X^Y)+J[13]+681279174&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[0]+3936430074&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[3]+3572445317&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[6]+76029189&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(U^X^Y)+J[9]+3654602809&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[12]+3873151461&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[15]+530742520&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[2]+3299628645&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(X^(U|~Y))+J[0]+4096336452&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[7]+1126891415&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[14]+2878612391&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[5]+4237533241&4294967295,U=X+(G<<21&4294967295|G>>>11),G=z+(X^(U|~Y))+J[12]+1700485571&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[3]+2399980690&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[10]+4293915773&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[1]+2240044497&4294967295,U=X+(G<<21&4294967295|G>>>11),G=z+(X^(U|~Y))+J[8]+1873313359&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[15]+4264355552&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[6]+2734768916&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[13]+1309151649&4294967295,U=X+(G<<21&4294967295|G>>>11),G=z+(X^(U|~Y))+J[4]+4149444226&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[11]+3174756917&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[2]+718787259&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[9]+3951481745&4294967295,F.g[0]=F.g[0]+z&4294967295,F.g[1]=F.g[1]+(X+(G<<21&4294967295|G>>>11))&4294967295,F.g[2]=F.g[2]+X&4294967295,F.g[3]=F.g[3]+Y&4294967295}o.prototype.v=function(F,z){z===void 0&&(z=F.length);const U=z-this.blockSize,J=this.C;let X=this.h,Y=0;for(;Y<z;){if(X==0)for(;Y<=U;)u(this,F,Y),Y+=this.blockSize;if(typeof F=="string"){for(;Y<z;)if(J[X++]=F.charCodeAt(Y++),X==this.blockSize){u(this,J),X=0;break}}else for(;Y<z;)if(J[X++]=F[Y++],X==this.blockSize){u(this,J),X=0;break}}this.h=X,this.o+=z},o.prototype.A=function(){var F=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);F[0]=128;for(var z=1;z<F.length-8;++z)F[z]=0;z=this.o*8;for(var U=F.length-8;U<F.length;++U)F[U]=z&255,z/=256;for(this.v(F),F=Array(16),z=0,U=0;U<4;++U)for(let J=0;J<32;J+=8)F[z++]=this.g[U]>>>J&255;return F};function g(F,z){var U=T;return Object.prototype.hasOwnProperty.call(U,F)?U[F]:U[F]=z(F)}function x(F,z){this.h=z;const U=[];let J=!0;for(let X=F.length-1;X>=0;X--){const Y=F[X]|0;J&&Y==z||(U[X]=Y,J=!1)}this.g=U}var T={};function b(F){return-128<=F&&F<128?g(F,function(z){return new x([z|0],z<0?-1:0)}):new x([F|0],F<0?-1:0)}function w(F){if(isNaN(F)||!isFinite(F))return R;if(F<0)return se(w(-F));const z=[];let U=1;for(let J=0;F>=U;J++)z[J]=F/U|0,U*=4294967296;return new x(z,0)}function C(F,z){if(F.length==0)throw Error("number format error: empty string");if(z=z||10,z<2||36<z)throw Error("radix out of range: "+z);if(F.charAt(0)=="-")return se(C(F.substring(1),z));if(F.indexOf("-")>=0)throw Error('number format error: interior "-" character');const U=w(Math.pow(z,8));let J=R;for(let Y=0;Y<F.length;Y+=8){var X=Math.min(8,F.length-Y);const G=parseInt(F.substring(Y,Y+X),z);X<8?(X=w(Math.pow(z,X)),J=J.j(X).add(w(G))):(J=J.j(U),J=J.add(w(G)))}return J}var R=b(0),P=b(1),L=b(16777216);s=x.prototype,s.m=function(){if(re(this))return-se(this).m();let F=0,z=1;for(let U=0;U<this.g.length;U++){const J=this.i(U);F+=(J>=0?J:4294967296+J)*z,z*=4294967296}return F},s.toString=function(F){if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(ee(this))return"0";if(re(this))return"-"+se(this).toString(F);const z=w(Math.pow(F,6));var U=this;let J="";for(;;){const X=Ue(U,z).g;U=Ye(U,X.j(z));let Y=((U.g.length>0?U.g[0]:U.h)>>>0).toString(F);if(U=X,ee(U))return Y+J;for(;Y.length<6;)Y="0"+Y;J=Y+J}},s.i=function(F){return F<0?0:F<this.g.length?this.g[F]:this.h};function ee(F){if(F.h!=0)return!1;for(let z=0;z<F.g.length;z++)if(F.g[z]!=0)return!1;return!0}function re(F){return F.h==-1}s.l=function(F){return F=Ye(this,F),re(F)?-1:ee(F)?0:1};function se(F){const z=F.g.length,U=[];for(let J=0;J<z;J++)U[J]=~F.g[J];return new x(U,~F.h).add(P)}s.abs=function(){return re(this)?se(this):this},s.add=function(F){const z=Math.max(this.g.length,F.g.length),U=[];let J=0;for(let X=0;X<=z;X++){let Y=J+(this.i(X)&65535)+(F.i(X)&65535),G=(Y>>>16)+(this.i(X)>>>16)+(F.i(X)>>>16);J=G>>>16,Y&=65535,G&=65535,U[X]=G<<16|Y}return new x(U,U[U.length-1]&-2147483648?-1:0)};function Ye(F,z){return F.add(se(z))}s.j=function(F){if(ee(this)||ee(F))return R;if(re(this))return re(F)?se(this).j(se(F)):se(se(this).j(F));if(re(F))return se(this.j(se(F)));if(this.l(L)<0&&F.l(L)<0)return w(this.m()*F.m());const z=this.g.length+F.g.length,U=[];for(var J=0;J<2*z;J++)U[J]=0;for(J=0;J<this.g.length;J++)for(let X=0;X<F.g.length;X++){const Y=this.i(J)>>>16,G=this.i(J)&65535,at=F.i(X)>>>16,ce=F.i(X)&65535;U[2*J+2*X]+=G*ce,Oe(U,2*J+2*X),U[2*J+2*X+1]+=Y*ce,Oe(U,2*J+2*X+1),U[2*J+2*X+1]+=G*at,Oe(U,2*J+2*X+1),U[2*J+2*X+2]+=Y*at,Oe(U,2*J+2*X+2)}for(F=0;F<z;F++)U[F]=U[2*F+1]<<16|U[2*F];for(F=z;F<2*z;F++)U[F]=0;return new x(U,0)};function Oe(F,z){for(;(F[z]&65535)!=F[z];)F[z+1]+=F[z]>>>16,F[z]&=65535,z++}function le(F,z){this.g=F,this.h=z}function Ue(F,z){if(ee(z))throw Error("division by zero");if(ee(F))return new le(R,R);if(re(F))return z=Ue(se(F),z),new le(se(z.g),se(z.h));if(re(z))return z=Ue(F,se(z)),new le(se(z.g),z.h);if(F.g.length>30){if(re(F)||re(z))throw Error("slowDivide_ only works with positive integers.");for(var U=P,J=z;J.l(F)<=0;)U=dt(U),J=dt(J);var X=Ze(U,1),Y=Ze(J,1);for(J=Ze(J,2),U=Ze(U,2);!ee(J);){var G=Y.add(J);G.l(F)<=0&&(X=X.add(U),Y=G),J=Ze(J,1),U=Ze(U,1)}return z=Ye(F,X.j(z)),new le(X,z)}for(X=R;F.l(z)>=0;){for(U=Math.max(1,Math.floor(F.m()/z.m())),J=Math.ceil(Math.log(U)/Math.LN2),J=J<=48?1:Math.pow(2,J-48),Y=w(U),G=Y.j(z);re(G)||G.l(F)>0;)U-=J,Y=w(U),G=Y.j(z);ee(Y)&&(Y=P),X=X.add(Y),F=Ye(F,G)}return new le(X,F)}s.B=function(F){return Ue(this,F).h},s.and=function(F){const z=Math.max(this.g.length,F.g.length),U=[];for(let J=0;J<z;J++)U[J]=this.i(J)&F.i(J);return new x(U,this.h&F.h)},s.or=function(F){const z=Math.max(this.g.length,F.g.length),U=[];for(let J=0;J<z;J++)U[J]=this.i(J)|F.i(J);return new x(U,this.h|F.h)},s.xor=function(F){const z=Math.max(this.g.length,F.g.length),U=[];for(let J=0;J<z;J++)U[J]=this.i(J)^F.i(J);return new x(U,this.h^F.h)};function dt(F){const z=F.g.length+1,U=[];for(let J=0;J<z;J++)U[J]=F.i(J)<<1|F.i(J-1)>>>31;return new x(U,F.h)}function Ze(F,z){const U=z>>5;z%=32;const J=F.g.length-U,X=[];for(let Y=0;Y<J;Y++)X[Y]=z>0?F.i(Y+U)>>>z|F.i(Y+U+1)<<32-z:F.i(Y+U);return new x(X,F.h)}o.prototype.digest=o.prototype.A,o.prototype.reset=o.prototype.u,o.prototype.update=o.prototype.v,xw=o,x.prototype.add=x.prototype.add,x.prototype.multiply=x.prototype.j,x.prototype.modulo=x.prototype.B,x.prototype.compare=x.prototype.l,x.prototype.toNumber=x.prototype.m,x.prototype.toString=x.prototype.toString,x.prototype.getBits=x.prototype.i,x.fromNumber=w,x.fromString=C,Ro=x}).apply(typeof J2<"u"?J2:typeof self<"u"?self:typeof window<"u"?window:{});var td=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ew,hu,ww,dd,B1,_w,Aw,bw;(function(){var s,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof td=="object"&&td];for(var S=0;S<p.length;++S){var D=p[S];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var o=t(this);function u(p,S){if(S)e:{var D=o;p=p.split(".");for(var j=0;j<p.length-1;j++){var he=p[j];if(!(he in D))break e;D=D[he]}p=p[p.length-1],j=D[p],S=S(j),S!=j&&S!=null&&e(D,p,{configurable:!0,writable:!0,value:S})}}u("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),u("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),u("Object.entries",function(p){return p||function(S){var D=[],j;for(j in S)Object.prototype.hasOwnProperty.call(S,j)&&D.push([j,S[j]]);return D}});var g=g||{},x=this||self;function T(p){var S=typeof p;return S=="object"&&p!=null||S=="function"}function b(p,S,D){return p.call.apply(p.bind,arguments)}function w(p,S,D){return w=b,w.apply(null,arguments)}function C(p,S){var D=Array.prototype.slice.call(arguments,1);return function(){var j=D.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function R(p,S){function D(){}D.prototype=S.prototype,p.Z=S.prototype,p.prototype=new D,p.prototype.constructor=p,p.Ob=function(j,he,Ae){for(var et=Array(arguments.length-2),Yt=2;Yt<arguments.length;Yt++)et[Yt-2]=arguments[Yt];return S.prototype[he].apply(j,et)}}var P=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function L(p){const S=p.length;if(S>0){const D=Array(S);for(let j=0;j<S;j++)D[j]=p[j];return D}return[]}function ee(p,S){for(let j=1;j<arguments.length;j++){const he=arguments[j];var D=typeof he;if(D=D!="object"?D:he?Array.isArray(he)?"array":D:"null",D=="array"||D=="object"&&typeof he.length=="number"){D=p.length||0;const Ae=he.length||0;p.length=D+Ae;for(let et=0;et<Ae;et++)p[D+et]=he[et]}else p.push(he)}}class re{constructor(S,D){this.i=S,this.j=D,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function se(p){x.setTimeout(()=>{throw p},0)}function Ye(){var p=F;let S=null;return p.g&&(S=p.g,p.g=p.g.next,p.g||(p.h=null),S.next=null),S}class Oe{constructor(){this.h=this.g=null}add(S,D){const j=le.get();j.set(S,D),this.h?this.h.next=j:this.g=j,this.h=j}}var le=new re(()=>new Ue,p=>p.reset());class Ue{constructor(){this.next=this.g=this.h=null}set(S,D){this.h=S,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let dt,Ze=!1,F=new Oe,z=()=>{const p=Promise.resolve(void 0);dt=()=>{p.then(U)}};function U(){for(var p;p=Ye();){try{p.h.call(p.g)}catch(D){se(D)}var S=le;S.j(p),S.h<100&&(S.h++,p.next=S.g,S.g=p)}Ze=!1}function J(){this.u=this.u,this.C=this.C}J.prototype.u=!1,J.prototype.dispose=function(){this.u||(this.u=!0,this.N())},J.prototype[Symbol.dispose]=function(){this.dispose()},J.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(p,S){this.type=p,this.g=this.target=S,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var Y=(function(){if(!x.addEventListener||!Object.defineProperty)return!1;var p=!1,S=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const D=()=>{};x.addEventListener("test",D,S),x.removeEventListener("test",D,S)}catch{}return p})();function G(p){return/^[\s\xa0]*$/.test(p)}function at(p,S){X.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,S)}R(at,X),at.prototype.init=function(p,S){const D=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=S,S=p.relatedTarget,S||(D=="mouseover"?S=p.fromElement:D=="mouseout"&&(S=p.toElement)),this.relatedTarget=S,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&at.Z.h.call(this)},at.prototype.h=function(){at.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var ce="closure_listenable_"+(Math.random()*1e6|0),ue=0;function Ee(p,S,D,j,he){this.listener=p,this.proxy=null,this.src=S,this.type=D,this.capture=!!j,this.ha=he,this.key=++ue,this.da=this.fa=!1}function We(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function qe(p,S,D){for(const j in p)S.call(D,p[j],j,p)}function ot(p,S){for(const D in p)S.call(void 0,p[D],D,p)}function Q(p){const S={};for(const D in p)S[D]=p[D];return S}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pe(p,S){let D,j;for(let he=1;he<arguments.length;he++){j=arguments[he];for(D in j)p[D]=j[D];for(let Ae=0;Ae<$.length;Ae++)D=$[Ae],Object.prototype.hasOwnProperty.call(j,D)&&(p[D]=j[D])}}function Te(p){this.src=p,this.g={},this.h=0}Te.prototype.add=function(p,S,D,j,he){const Ae=p.toString();p=this.g[Ae],p||(p=this.g[Ae]=[],this.h++);const et=ve(p,S,j,he);return et>-1?(S=p[et],D||(S.fa=!1)):(S=new Ee(S,this.src,Ae,!!j,he),S.fa=D,p.push(S)),S};function nt(p,S){const D=S.type;if(D in p.g){var j=p.g[D],he=Array.prototype.indexOf.call(j,S,void 0),Ae;(Ae=he>=0)&&Array.prototype.splice.call(j,he,1),Ae&&(We(S),p.g[D].length==0&&(delete p.g[D],p.h--))}}function ve(p,S,D,j){for(let he=0;he<p.length;++he){const Ae=p[he];if(!Ae.da&&Ae.listener==S&&Ae.capture==!!D&&Ae.ha==j)return he}return-1}var st="closure_lm_"+(Math.random()*1e6|0),xt={};function kt(p,S,D,j,he){if(Array.isArray(S)){for(let Ae=0;Ae<S.length;Ae++)kt(p,S[Ae],D,j,he);return null}return D=Re(D),p&&p[ce]?p.J(S,D,T(j)?!!j.capture:!1,he):cn(p,S,D,!1,j,he)}function cn(p,S,D,j,he,Ae){if(!S)throw Error("Invalid event type");const et=T(he)?!!he.capture:!!he;let Yt=De(p);if(Yt||(p[st]=Yt=new Te(p)),D=Yt.add(S,D,j,et,Ae),D.proxy)return D;if(j=en(),D.proxy=j,j.src=p,j.listener=D,p.addEventListener)Y||(he=et),he===void 0&&(he=!1),p.addEventListener(S.toString(),j,he);else if(p.attachEvent)p.attachEvent(hn(S.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return D}function en(){function p(D){return S.call(p.src,p.listener,D)}const S=wn;return p}function En(p,S,D,j,he){if(Array.isArray(S))for(var Ae=0;Ae<S.length;Ae++)En(p,S[Ae],D,j,he);else j=T(j)?!!j.capture:!!j,D=Re(D),p&&p[ce]?(p=p.i,Ae=String(S).toString(),Ae in p.g&&(S=p.g[Ae],D=ve(S,D,j,he),D>-1&&(We(S[D]),Array.prototype.splice.call(S,D,1),S.length==0&&(delete p.g[Ae],p.h--)))):p&&(p=De(p))&&(S=p.g[S.toString()],p=-1,S&&(p=ve(S,D,j,he)),(D=p>-1?S[p]:null)&&Lt(D))}function Lt(p){if(typeof p!="number"&&p&&!p.da){var S=p.src;if(S&&S[ce])nt(S.i,p);else{var D=p.type,j=p.proxy;S.removeEventListener?S.removeEventListener(D,j,p.capture):S.detachEvent?S.detachEvent(hn(D),j):S.addListener&&S.removeListener&&S.removeListener(j),(D=De(S))?(nt(D,p),D.h==0&&(D.src=null,S[st]=null)):We(p)}}}function hn(p){return p in xt?xt[p]:xt[p]="on"+p}function wn(p,S){if(p.da)p=!0;else{S=new at(S,this);const D=p.listener,j=p.ha||p.src;p.fa&&Lt(p),p=D.call(j,S)}return p}function De(p){return p=p[st],p instanceof Te?p:null}var ge="__closure_events_fn_"+(Math.random()*1e9>>>0);function Re(p){return typeof p=="function"?p:(p[ge]||(p[ge]=function(S){return p.handleEvent(S)}),p[ge])}function Fe(){J.call(this),this.i=new Te(this),this.M=this,this.G=null}R(Fe,J),Fe.prototype[ce]=!0,Fe.prototype.removeEventListener=function(p,S,D,j){En(this,p,S,D,j)};function ke(p,S){var D,j=p.G;if(j)for(D=[];j;j=j.G)D.push(j);if(p=p.M,j=S.type||S,typeof S=="string")S=new X(S,p);else if(S instanceof X)S.target=S.target||p;else{var he=S;S=new X(j,p),pe(S,he)}he=!0;let Ae,et;if(D)for(et=D.length-1;et>=0;et--)Ae=S.g=D[et],he=be(Ae,j,!0,S)&&he;if(Ae=S.g=p,he=be(Ae,j,!0,S)&&he,he=be(Ae,j,!1,S)&&he,D)for(et=0;et<D.length;et++)Ae=S.g=D[et],he=be(Ae,j,!1,S)&&he}Fe.prototype.N=function(){if(Fe.Z.N.call(this),this.i){var p=this.i;for(const S in p.g){const D=p.g[S];for(let j=0;j<D.length;j++)We(D[j]);delete p.g[S],p.h--}}this.G=null},Fe.prototype.J=function(p,S,D,j){return this.i.add(String(p),S,!1,D,j)},Fe.prototype.K=function(p,S,D,j){return this.i.add(String(p),S,!0,D,j)};function be(p,S,D,j){if(S=p.i.g[String(S)],!S)return!0;S=S.concat();let he=!0;for(let Ae=0;Ae<S.length;++Ae){const et=S[Ae];if(et&&!et.da&&et.capture==D){const Yt=et.listener,mr=et.ha||et.src;et.fa&&nt(p.i,et),he=Yt.call(mr,j)!==!1&&he}}return he&&!j.defaultPrevented}function Pt(p,S){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=w(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:x.setTimeout(p,S||0)}function vt(p){p.g=Pt(()=>{p.g=null,p.i&&(p.i=!1,vt(p))},p.l);const S=p.h;p.h=null,p.m.apply(null,S)}class Rt extends J{constructor(S,D){super(),this.m=S,this.l=D,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:vt(this)}N(){super.N(),this.g&&(x.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fn(p){J.call(this),this.h=p,this.g={}}R(Fn,J);var Xt=[];function yr(p){qe(p.g,function(S,D){this.g.hasOwnProperty(D)&&Lt(S)},p),p.g={}}Fn.prototype.N=function(){Fn.Z.N.call(this),yr(this)},Fn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xr=x.JSON.stringify,or=x.JSON.parse,Zr=class{stringify(p){return x.JSON.stringify(p,void 0)}parse(p){return x.JSON.parse(p,void 0)}};function Ti(){}function ki(){}var tn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ze(){X.call(this,"d")}R(ze,X);function zt(){X.call(this,"c")}R(zt,X);var wt={},_n=null;function vr(){return _n=_n||new Fe}wt.Ia="serverreachability";function Xr(p){X.call(this,wt.Ia,p)}R(Xr,X);function Tr(p){const S=vr();ke(S,new Xr(S))}wt.STAT_EVENT="statevent";function Bt(p,S){X.call(this,wt.STAT_EVENT,p),this.stat=S}R(Bt,X);function Qt(p){const S=vr();ke(S,new Bt(S,p))}wt.Ja="timingevent";function jn(p,S){X.call(this,wt.Ja,p),this.size=S}R(jn,X);function Mr(p,S){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){p()},S)}function ut(){this.g=!0}ut.prototype.ua=function(){this.g=!1};function nn(p,S,D,j,he,Ae){p.info(function(){if(p.g)if(Ae){var et="",Yt=Ae.split("&");for(let Nn=0;Nn<Yt.length;Nn++){var mr=Yt[Nn].split("=");if(mr.length>1){const nr=mr[0];mr=mr[1];const Ii=nr.split("_");et=Ii.length>=2&&Ii[1]=="type"?et+(nr+"="+mr+"&"):et+(nr+"=redacted&")}}}else et=null;else et=Ae;return"XMLHTTP REQ ("+j+") [attempt "+he+"]: "+S+`
`+D+`
`+et})}function ie(p,S,D,j,he,Ae,et){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+he+"]: "+S+`
`+D+`
`+Ae+" "+et})}function Ie(p,S,D,j){p.info(function(){return"XMLHTTP TEXT ("+S+"): "+Xe(p,D)+(j?" "+j:"")})}function He(p,S){p.info(function(){return"TIMEOUT: "+S})}ut.prototype.info=function(){};function Xe(p,S){if(!p.g)return S;if(!S)return null;try{const Ae=JSON.parse(S);if(Ae){for(p=0;p<Ae.length;p++)if(Array.isArray(Ae[p])){var D=Ae[p];if(!(D.length<2)){var j=D[1];if(Array.isArray(j)&&!(j.length<1)){var he=j[0];if(he!="noop"&&he!="stop"&&he!="close")for(let et=1;et<j.length;et++)j[et]=""}}}}return xr(Ae)}catch{return S}}var rt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ft={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},it;function Ht(){}R(Ht,Ti),Ht.prototype.g=function(){return new XMLHttpRequest},it=new Ht;function St(p){return encodeURIComponent(String(p))}function Vt(p){var S=1;p=p.split(":");const D=[];for(;S>0&&p.length;)D.push(p.shift()),S--;return p.length&&D.push(p.join(":")),D}function Me(p,S,D,j){this.j=p,this.i=S,this.l=D,this.S=j||1,this.V=new Fn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new sn}function sn(){this.i=null,this.g="",this.h=!1}var gt={},Ot={};function $n(p,S,D){p.M=1,p.A=er(Rn(S)),p.u=D,p.R=!0,fi(p,null)}function fi(p,S){p.F=Date.now(),Li(p),p.B=Rn(p.A);var D=p.B,j=p.S;Array.isArray(j)||(j=[String(j)]),zn(D.i,"t",j),p.C=0,D=p.j.L,p.h=new sn,p.g=Ka(p.j,D?S:null,!p.u),p.P>0&&(p.O=new Rt(w(p.Y,p,p.g),p.P)),S=p.V,D=p.g,j=p.ba;var he="readystatechange";Array.isArray(he)||(he&&(Xt[0]=he.toString()),he=Xt);for(let Ae=0;Ae<he.length;Ae++){const et=kt(D,he[Ae],j||S.handleEvent,!1,S.h||S);if(!et)break;S.g[et.key]=et}S=p.J?Q(p.J):{},p.u?(p.v||(p.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,S)):(p.v="GET",p.g.ea(p.B,p.v,null,S)),Tr(),nn(p.i,p.v,p.B,p.l,p.S,p.u)}Me.prototype.ba=function(p){p=p.target;const S=this.O;S&&Vi(p)==3?S.j():this.Y(p)},Me.prototype.Y=function(p){try{if(p==this.g)e:{const Yt=Vi(this.g),mr=this.g.ya(),Nn=this.g.ca();if(!(Yt<3)&&(Yt!=3||this.g&&(this.h.h||this.g.la()||_r(this.g)))){this.K||Yt!=4||mr==7||(mr==8||Nn<=0?Tr(3):Tr(2)),Wn(this);var S=this.g.ca();this.X=S;var D=Ps(this);if(this.o=S==200,ie(this.i,this.v,this.B,this.l,this.S,Yt,S),this.o){if(this.U&&!this.L){t:{if(this.g){var j,he=this.g;if((j=he.g?he.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(j)){var Ae=j;break t}}Ae=null}if(p=Ae)Ie(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,kr(this,p);else{this.o=!1,this.m=3,Qt(12),Jr(this),un(this);break e}}if(this.R){p=!0;let nr;for(;!this.K&&this.C<D.length;)if(nr=Ha(this,D),nr==Ot){Yt==4&&(this.m=4,Qt(14),p=!1),Ie(this.i,this.l,null,"[Incomplete Response]");break}else if(nr==gt){this.m=4,Qt(15),Ie(this.i,this.l,D,"[Invalid Chunk]"),p=!1;break}else Ie(this.i,this.l,nr,null),kr(this,nr);if(ri(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yt!=4||D.length!=0||this.h.h||(this.m=1,Qt(16),p=!1),this.o=this.o&&p,!p)Ie(this.i,this.l,D,"[Invalid Chunked Response]"),Jr(this),un(this);else if(D.length>0&&!this.W){this.W=!0;var et=this.j;et.g==this&&et.aa&&!et.P&&(et.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),we(et),et.P=!0,Qt(11))}}else Ie(this.i,this.l,D,null),kr(this,D);Yt==4&&Jr(this),this.o&&!this.K&&(Yt==4?ca(this.j,this):(this.o=!1,Li(this)))}else Si(this.g),S==400&&D.indexOf("Unknown SID")>0?(this.m=3,Qt(12)):(this.m=0,Qt(13)),Jr(this),un(this)}}}catch{}finally{}};function Ps(p){if(!ri(p))return p.g.la();const S=_r(p.g);if(S==="")return"";let D="";const j=S.length,he=Vi(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Jr(p),un(p),"";p.h.i=new x.TextDecoder}for(let Ae=0;Ae<j;Ae++)p.h.h=!0,D+=p.h.i.decode(S[Ae],{stream:!(he&&Ae==j-1)});return S.length=0,p.h.g+=D,p.C=0,p.h.g}function ri(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Ha(p,S){var D=p.C,j=S.indexOf(`
`,D);return j==-1?Ot:(D=Number(S.substring(D,j)),isNaN(D)?gt:(j+=1,j+D>S.length?Ot:(S=S.slice(j,j+D),p.C=j+D,S)))}Me.prototype.cancel=function(){this.K=!0,Jr(this)};function Li(p){p.T=Date.now()+p.H,Yr(p,p.H)}function Yr(p,S){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Mr(w(p.aa,p),S)}function Wn(p){p.D&&(x.clearTimeout(p.D),p.D=null)}Me.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(He(this.i,this.B),this.M!=2&&(Tr(),Qt(17)),Jr(this),this.m=2,un(this)):Yr(this,this.T-p)};function un(p){p.j.I==0||p.K||ca(p.j,p)}function Jr(p){Wn(p);var S=p.O;S&&typeof S.dispose=="function"&&S.dispose(),p.O=null,yr(p.V),p.g&&(S=p.g,p.g=null,S.abort(),S.dispose())}function kr(p,S){try{var D=p.j;if(D.I!=0&&(D.g==p||$e(D.h,p))){if(!p.L&&$e(D.h,p)&&D.I==3){try{var j=D.Ba.g.parse(S)}catch{j=null}if(Array.isArray(j)&&j.length==3){var he=j;if(he[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<p.F)fr(D),Is(D);else break e;la(D),Qt(18)}}else D.xa=he[1],0<D.xa-D.K&&he[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Mr(w(D.Va,D),6e3));Se(D.h)<=1&&D.ta&&(D.ta=void 0)}else ds(D,11)}else if((p.L||D.g==p)&&fr(D),!G(S))for(he=D.Ba.g.parse(S),S=0;S<he.length;S++){let Nn=he[S];const nr=Nn[0];if(!(nr<=D.K))if(D.K=nr,Nn=Nn[1],D.I==2)if(Nn[0]=="c"){D.M=Nn[1],D.ba=Nn[2];const Ii=Nn[3];Ii!=null&&(D.ka=Ii,D.j.info("VER="+D.ka));const ms=Nn[4];ms!=null&&(D.za=ms,D.j.info("SVER="+D.za));const ei=Nn[5];ei!=null&&typeof ei=="number"&&ei>0&&(j=1.5*ei,D.O=j,D.j.info("backChannelRequestTimeoutMs_="+j)),j=D;const Ri=p.g;if(Ri){const ha=Ri.g?Ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ha){var Ae=j.h;Ae.g||ha.indexOf("spdy")==-1&&ha.indexOf("quic")==-1&&ha.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(mt(Ae,Ae.h),Ae.h=null))}if(j.G){const ps=Ri.g?Ri.g.getResponseHeader("X-HTTP-Session-Id"):null;ps&&(j.wa=ps,It(j.J,j.G,ps))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-p.F,D.j.info("Handshake RTT: "+D.T+"ms")),j=D;var et=p;if(j.na=bl(j,j.L?j.ba:null,j.W),et.L){tt(j.h,et);var Yt=et,mr=j.O;mr&&(Yt.H=mr),Yt.D&&(Wn(Yt),Li(Yt)),j.g=et}else $i(j);D.i.length>0&&hs(D)}else Nn[0]!="stop"&&Nn[0]!="close"||ds(D,7);else D.I==3&&(Nn[0]=="stop"||Nn[0]=="close"?Nn[0]=="stop"?ds(D,7):qa(D):Nn[0]!="noop"&&D.l&&D.l.qa(Nn),D.A=0)}}Tr(4)}catch{}}var sr=class{constructor(p,S){this.g=p,this.map=S}};function Ve(p){this.l=p||10,x.PerformanceNavigationTiming?(p=x.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(x.chrome&&x.chrome.loadTimes&&x.chrome.loadTimes()&&x.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function K(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Se(p){return p.h?1:p.g?p.g.size:0}function $e(p,S){return p.h?p.h==S:p.g?p.g.has(S):!1}function mt(p,S){p.g?p.g.add(S):p.h=S}function tt(p,S){p.h&&p.h==S?p.h=null:p.g&&p.g.has(S)&&p.g.delete(S)}Ve.prototype.cancel=function(){if(this.i=lt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function lt(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let S=p.i;for(const D of p.g.values())S=S.concat(D.G);return S}return L(p.i)}var ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dn(p,S){if(p){p=p.split("&");for(let D=0;D<p.length;D++){const j=p[D].indexOf("=");let he,Ae=null;j>=0?(he=p[D].substring(0,j),Ae=p[D].substring(j+1)):he=p[D],S(he,Ae?decodeURIComponent(Ae.replace(/\+/g," ")):"")}}}function fn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;p instanceof fn?(this.l=p.l,Ft(this,p.j),this.o=p.o,this.g=p.g,kn(this,p.u),this.h=p.h,Pi(this,zo(p.i)),this.m=p.m):p&&(S=String(p).match(ht))?(this.l=!1,Ft(this,S[1]||"",!0),this.o=Cr(S[2]||""),this.g=Cr(S[3]||"",!0),kn(this,S[4]),this.h=Cr(S[5]||"",!0),Pi(this,S[6]||"",!0),this.m=Cr(S[7]||"")):(this.l=!1,this.i=new Lr(null,this.l))}fn.prototype.toString=function(){const p=[];var S=this.j;S&&p.push(gi(S,Er,!0),":");var D=this.g;return(D||S=="file")&&(p.push("//"),(S=this.o)&&p.push(gi(S,Er,!0),"@"),p.push(St(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&p.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&p.push("/"),p.push(gi(D,D.charAt(0)=="/"?H:fe,!0))),(D=this.i.toString())&&p.push("?",D),(D=this.m)&&p.push("#",gi(D,wr)),p.join("")},fn.prototype.resolve=function(p){const S=Rn(this);let D=!!p.j;D?Ft(S,p.j):D=!!p.o,D?S.o=p.o:D=!!p.g,D?S.g=p.g:D=p.u!=null;var j=p.h;if(D)kn(S,p.u);else if(D=!!p.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var he=S.h.lastIndexOf("/");he!=-1&&(j=S.h.slice(0,he+1)+j)}if(he=j,he==".."||he==".")j="";else if(he.indexOf("./")!=-1||he.indexOf("/.")!=-1){j=he.lastIndexOf("/",0)==0,he=he.split("/");const Ae=[];for(let et=0;et<he.length;){const Yt=he[et++];Yt=="."?j&&et==he.length&&Ae.push(""):Yt==".."?((Ae.length>1||Ae.length==1&&Ae[0]!="")&&Ae.pop(),j&&et==he.length&&Ae.push("")):(Ae.push(Yt),j=!0)}j=Ae.join("/")}else j=he}return D?S.h=j:D=p.i.toString()!=="",D?Pi(S,zo(p.i)):D=!!p.m,D&&(S.m=p.m),S};function Rn(p){return new fn(p)}function Ft(p,S,D){p.j=D?Cr(S,!0):S,p.j&&(p.j=p.j.replace(/:$/,""))}function kn(p,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);p.u=S}else p.u=null}function Pi(p,S,D){S instanceof Lr?(p.i=S,Vs(p.i,p.l)):(D||(S=gi(S,_t)),p.i=new Lr(S,p.l))}function It(p,S,D){p.i.set(S,D)}function er(p){return It(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Cr(p,S){return p?S?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function gi(p,S,D){return typeof p=="string"?(p=encodeURI(p).replace(S,an),D&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function an(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Er=/[#\/\?@]/g,fe=/[#\?:]/g,H=/[#\?]/g,_t=/[#\?@]/g,wr=/#/g;function Lr(p,S){this.h=this.g=null,this.i=p||null,this.j=!!S}function mi(p){p.g||(p.g=new Map,p.h=0,p.i&&dn(p.i,function(S,D){p.add(decodeURIComponent(S.replace(/\+/g," ")),D)}))}s=Lr.prototype,s.add=function(p,S){mi(this),this.i=null,p=Bs(this,p);let D=this.g.get(p);return D||this.g.set(p,D=[]),D.push(S),this.h+=1,this};function Ga(p,S){mi(p),S=Bs(p,S),p.g.has(S)&&(p.i=null,p.h-=p.g.get(S).length,p.g.delete(S))}function $r(p,S){return mi(p),S=Bs(p,S),p.g.has(S)}s.forEach=function(p,S){mi(this),this.g.forEach(function(D,j){D.forEach(function(he){p.call(S,he,j,this)},this)},this)};function Tt(p,S){mi(p);let D=[];if(typeof S=="string")$r(p,S)&&(D=D.concat(p.g.get(Bs(p,S))));else for(p=Array.from(p.g.values()),S=0;S<p.length;S++)D=D.concat(p[S]);return D}s.set=function(p,S){return mi(this),this.i=null,p=Bs(this,p),$r(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[S]),this.h+=1,this},s.get=function(p,S){return p?(p=Tt(this,p),p.length>0?String(p[0]):S):S};function zn(p,S,D){Ga(p,S),D.length>0&&(p.i=null,p.g.set(Bs(p,S),L(D)),p.h+=D.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],S=Array.from(this.g.keys());for(let j=0;j<S.length;j++){var D=S[j];const he=St(D);D=Tt(this,D);for(let Ae=0;Ae<D.length;Ae++){let et=he;D[Ae]!==""&&(et+="="+St(D[Ae])),p.push(et)}}return this.i=p.join("&")};function zo(p){const S=new Lr;return S.i=p.i,p.g&&(S.g=new Map(p.g),S.h=p.h),S}function Bs(p,S){return S=String(S),p.j&&(S=S.toLowerCase()),S}function Vs(p,S){S&&!p.j&&(mi(p),p.i=null,p.g.forEach(function(D,j){const he=j.toLowerCase();j!=he&&(Ga(this,j),zn(this,he,D))},p)),p.j=S}function pi(p,S){const D=new ut;if(x.Image){const j=new Image;j.onload=C(Bi,D,"TestLoadImage: loaded",!0,S,j),j.onerror=C(Bi,D,"TestLoadImage: error",!1,S,j),j.onabort=C(Bi,D,"TestLoadImage: abort",!1,S,j),j.ontimeout=C(Bi,D,"TestLoadImage: timeout",!1,S,j),x.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else S(!1)}function ia(p,S){const D=new ut,j=new AbortController,he=setTimeout(()=>{j.abort(),Bi(D,"TestPingServer: timeout",!1,S)},1e4);fetch(p,{signal:j.signal}).then(Ae=>{clearTimeout(he),Ae.ok?Bi(D,"TestPingServer: ok",!0,S):Bi(D,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(he),Bi(D,"TestPingServer: error",!1,S)})}function Bi(p,S,D,j,he){try{he&&(he.onload=null,he.onerror=null,he.onabort=null,he.ontimeout=null),j(D)}catch{}}function tr(){this.g=new Zr}function yi(p){this.i=p.Sb||null,this.h=p.ab||!1}R(yi,Ti),yi.prototype.g=function(){return new xi(this.i,this.h)};function xi(p,S){Fe.call(this),this.H=p,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}R(xi,Fe),s=xi.prototype,s.open=function(p,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=S,this.readyState=1,Ut(this)},s.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(S.body=p),(this.H||x).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Us(this)),this.readyState=0},s.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Ut(this)),this.g&&(this.readyState=3,Ut(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof x.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Nt(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Nt(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}s.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var S=p.value?p.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!p.done}))&&(this.response=this.responseText+=S)}p.done?Us(this):Ut(this),this.readyState==3&&Nt(this)}},s.Oa=function(p){this.g&&(this.response=this.responseText=p,Us(this))},s.Na=function(p){this.g&&(this.response=p,Us(this))},s.ga=function(){this.g&&Us(this)};function Us(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Ut(p)}s.setRequestHeader=function(p,S){this.A.append(p,S)},s.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],S=this.h.entries();for(var D=S.next();!D.done;)D=D.value,p.push(D[0]+": "+D[1]),D=S.next();return p.join(`\r
`)};function Ut(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(xi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Hn(p){let S="";return qe(p,function(D,j){S+=j,S+=":",S+=D,S+=`\r
`}),S}function sa(p,S,D){e:{for(j in D){var j=!1;break e}j=!0}j||(D=Hn(D),typeof p=="string"?D!=null&&St(D):It(p,S,D))}function Ln(p){Fe.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}R(Ln,Fe);var Qi=/^https?$/i,Zi=["POST","PUT"];s=Ln.prototype,s.Fa=function(p){this.H=p},s.ea=function(p,S,D,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);S=S?S.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():it.g(),this.g.onreadystatechange=P(w(this.Ca,this));try{this.B=!0,this.g.open(S,String(p),!0),this.B=!1}catch(Ae){aa(this,Ae);return}if(p=D||"",D=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var he in j)D.set(he,j[he]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const Ae of j.keys())D.set(Ae,j.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(D.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),he=x.FormData&&p instanceof x.FormData,!(Array.prototype.indexOf.call(Zi,S,void 0)>=0)||j||he||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,et]of D)this.g.setRequestHeader(Ae,et);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Ae){aa(this,Ae)}};function aa(p,S){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=S,p.o=5,Cs(p),Ci(p)}function Cs(p){p.A||(p.A=!0,ke(p,"complete"),ke(p,"error"))}s.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,ke(this,"complete"),ke(this,"abort"),Ci(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ci(this,!0)),Ln.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ji(this):this.Xa())},s.Xa=function(){Ji(this)};function Ji(p){if(p.h&&typeof g<"u"){if(p.v&&Vi(p)==4)setTimeout(p.Ca.bind(p),0);else if(ke(p,"readystatechange"),Vi(p)==4){p.h=!1;try{const Ae=p.ca();e:switch(Ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var D;if(!(D=S)){var j;if(j=Ae===0){let et=String(p.D).match(ht)[1]||null;!et&&x.self&&x.self.location&&(et=x.self.location.protocol.slice(0,-1)),j=!Qi.test(et?et.toLowerCase():"")}D=j}if(D)ke(p,"complete"),ke(p,"success");else{p.o=6;try{var he=Vi(p)>2?p.g.statusText:""}catch{he=""}p.l=he+" ["+p.ca()+"]",Cs(p)}}finally{Ci(p)}}}}function Ci(p,S){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const D=p.g;p.g=null,S||ke(p,"ready");try{D.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Vi(p){return p.g?p.g.readyState:0}s.ca=function(){try{return Vi(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(p){if(this.g){var S=this.g.responseText;return p&&S.indexOf(p)==0&&(S=S.substring(p.length)),or(S)}};function _r(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Si(p){const S={};p=(p.g&&Vi(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(G(p[j]))continue;var D=Vt(p[j]);const he=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Ae=S[he]||[];S[he]=Ae,Ae.push(D)}ot(S,function(j){return j.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function lr(p,S,D){return D&&D.internalChannelParams&&D.internalChannelParams[p]||S}function Ss(p){this.za=0,this.i=[],this.j=new ut,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=lr("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=lr("baseRetryDelayMs",5e3,p),this.Za=lr("retryDelaySeedMs",1e4,p),this.Ta=lr("forwardChannelMaxRetries",2,p),this.va=lr("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Ve(p&&p.concurrentRequestLimit),this.Ba=new tr,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Ss.prototype,s.ka=8,s.I=1,s.connect=function(p,S,D,j){Qt(0),this.W=p,this.H=S||{},D&&j!==void 0&&(this.H.OSID=D,this.H.OAID=j),this.F=this.X,this.J=bl(this,null,this.W),hs(this)};function qa(p){if(Xa(p),p.I==3){var S=p.V++,D=Rn(p.J);if(It(D,"SID",p.M),It(D,"RID",S),It(D,"TYPE","terminate"),Fs(p,D),S=new Me(p,p.j,S),S.M=2,S.A=er(Rn(D)),D=!1,x.navigator&&x.navigator.sendBeacon)try{D=x.navigator.sendBeacon(S.A.toString(),"")}catch{}!D&&x.Image&&(new Image().src=S.A,D=!0),D||(S.g=Ka(S.j,null),S.g.ea(S.A)),S.F=Date.now(),Li(S)}Al(p)}function Is(p){p.g&&(we(p),p.g.cancel(),p.g=null)}function Xa(p){Is(p),p.v&&(x.clearTimeout(p.v),p.v=null),fr(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&x.clearTimeout(p.m),p.m=null)}function hs(p){if(!K(p.h)&&!p.m){p.m=!0;var S=p.Ea;dt||z(),Ze||(dt(),Ze=!0),F.add(S,p),p.D=0}}function Ya(p,S){return Se(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=S.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Mr(w(p.Ea,p,S),Ho(p,p.D)),p.D++,!0)}s.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const he=new Me(this,this.j,p);let Ae=this.o;if(this.U&&(Ae?(Ae=Q(Ae),pe(Ae,this.U)):Ae=this.U),this.u!==null||this.R||(he.J=Ae,Ae=null),this.S)e:{for(var S=0,D=0;D<this.i.length;D++){t:{var j=this.i[D];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(S+=j,S>4096){S=D;break e}if(S===4096||D===this.i.length-1){S=D+1;break e}}S=1e3}else S=1e3;S=oa(this,he,S),D=Rn(this.J),It(D,"RID",p),It(D,"CVER",22),this.G&&It(D,"X-HTTP-Session-Id",this.G),Fs(this,D),Ae&&(this.R?S="headers="+St(Hn(Ae))+"&"+S:this.u&&sa(D,this.u,Ae)),mt(this.h,he),this.Ra&&It(D,"TYPE","init"),this.S?(It(D,"$req",S),It(D,"SID","null"),he.U=!0,$n(he,D,null)):$n(he,D,S),this.I=2}}else this.I==3&&(p?Dn(this,p):this.i.length==0||K(this.h)||Dn(this))};function Dn(p,S){var D;S?D=S.l:D=p.V++;const j=Rn(p.J);It(j,"SID",p.M),It(j,"RID",D),It(j,"AID",p.K),Fs(p,j),p.u&&p.o&&sa(j,p.u,p.o),D=new Me(p,p.j,D,p.D+1),p.u===null&&(D.J=p.o),S&&(p.i=S.G.concat(p.i)),S=oa(p,D,1e3),D.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),mt(p.h,D),$n(D,j,S)}function Fs(p,S){p.H&&qe(p.H,function(D,j){It(S,j,D)}),p.l&&qe({},function(D,j){It(S,j,D)})}function oa(p,S,D){D=Math.min(p.i.length,D);const j=p.l?w(p.l.Ka,p.l,p):null;e:{var he=p.i;let Yt=-1;for(;;){const mr=["count="+D];Yt==-1?D>0?(Yt=he[0].g,mr.push("ofs="+Yt)):Yt=0:mr.push("ofs="+Yt);let Nn=!0;for(let nr=0;nr<D;nr++){var Ae=he[nr].g;const Ii=he[nr].map;if(Ae-=Yt,Ae<0)Yt=Math.max(0,he[nr].g-100),Nn=!1;else try{Ae="req"+Ae+"_"||"";try{var et=Ii instanceof Map?Ii:Object.entries(Ii);for(const[ms,ei]of et){let Ri=ei;T(ei)&&(Ri=xr(ei)),mr.push(Ae+ms+"="+encodeURIComponent(Ri))}}catch(ms){throw mr.push(Ae+"type="+encodeURIComponent("_badmap")),ms}}catch{j&&j(Ii)}}if(Nn){et=mr.join("&");break e}}et=void 0}return p=p.i.splice(0,D),S.G=p,et}function $i(p){if(!p.g&&!p.v){p.Y=1;var S=p.Da;dt||z(),Ze||(dt(),Ze=!0),F.add(S,p),p.A=0}}function la(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Mr(w(p.Da,p),Ho(p,p.A)),p.A++,!0)}s.Da=function(){if(this.v=null,Zt(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Mr(w(this.Wa,this),p)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Qt(10),Is(this),Zt(this))};function we(p){p.B!=null&&(x.clearTimeout(p.B),p.B=null)}function Zt(p){p.g=new Me(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var S=Rn(p.na);It(S,"RID","rpc"),It(S,"SID",p.M),It(S,"AID",p.K),It(S,"CI",p.F?"0":"1"),!p.F&&p.ia&&It(S,"TO",p.ia),It(S,"TYPE","xmlhttp"),Fs(p,S),p.u&&p.o&&sa(S,p.u,p.o),p.O&&(p.g.H=p.O);var D=p.g;p=p.ba,D.M=1,D.A=er(Rn(S)),D.u=null,D.R=!0,fi(D,p)}s.Va=function(){this.C!=null&&(this.C=null,Is(this),la(this),Qt(19))};function fr(p){p.C!=null&&(x.clearTimeout(p.C),p.C=null)}function ca(p,S){var D=null;if(p.g==S){fr(p),we(p),p.g=null;var j=2}else if($e(p.h,S))D=S.G,tt(p.h,S),j=1;else return;if(p.I!=0){if(S.o)if(j==1){D=S.u?S.u.length:0,S=Date.now()-S.F;var he=p.D;j=vr(),ke(j,new jn(j,D)),hs(p)}else $i(p);else if(he=S.m,he==3||he==0&&S.X>0||!(j==1&&Ya(p,S)||j==2&&la(p)))switch(D&&D.length>0&&(S=p.h,S.i=S.i.concat(D)),he){case 1:ds(p,5);break;case 4:ds(p,10);break;case 3:ds(p,6);break;default:ds(p,2)}}}function Ho(p,S){let D=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(D*=2),D*S}function ds(p,S){if(p.j.info("Error code "+S),S==2){var D=w(p.bb,p),j=p.Ua;const he=!j;j=new fn(j||"//www.google.com/images/cleardot.gif"),x.location&&x.location.protocol=="http"||Ft(j,"https"),er(j),he?pi(j.toString(),D):ia(j.toString(),D)}else Qt(2);p.I=0,p.l&&p.l.pa(S),Al(p),Xa(p)}s.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function Al(p){if(p.I=0,p.ja=[],p.l){const S=lt(p.h);(S.length!=0||p.i.length!=0)&&(ee(p.ja,S),ee(p.ja,p.i),p.h.i.length=0,L(p.i),p.i.length=0),p.l.oa()}}function bl(p,S,D){var j=D instanceof fn?Rn(D):new fn(D);if(j.g!="")S&&(j.g=S+"."+j.g),kn(j,j.u);else{var he=x.location;j=he.protocol,S=S?S+"."+he.hostname:he.hostname,he=+he.port;const Ae=new fn(null);j&&Ft(Ae,j),S&&(Ae.g=S),he&&kn(Ae,he),D&&(Ae.h=D),j=Ae}return D=p.G,S=p.wa,D&&S&&It(j,D,S),It(j,"VER",p.ka),Fs(p,j),j}function Ka(p,S,D){if(S&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=p.Aa&&!p.ma?new Ln(new yi({ab:D})):new Ln(p.ma),S.Fa(p.L),S}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function gr(){}s=gr.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function fs(){}fs.prototype.g=function(p,S){return new gn(p,S)};function gn(p,S){Fe.call(this),this.g=new Ss(S),this.l=p,this.h=S&&S.messageUrlParams||null,p=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(p?p["X-WebChannel-Content-Type"]=S.messageContentType:p={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(p?p["X-WebChannel-Client-Profile"]=S.sa:p={"X-WebChannel-Client-Profile":S.sa}),this.g.U=p,(p=S&&S.Qb)&&!G(p)&&(this.g.u=p),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!G(S)&&(this.g.G=S,p=this.h,p!==null&&S in p&&(p=this.h,S in p&&delete p[S])),this.j=new mn(this)}R(gn,Fe),gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){qa(this.g)},gn.prototype.o=function(p){var S=this.g;if(typeof p=="string"){var D={};D.__data__=p,p=D}else this.v&&(D={},D.__data__=xr(p),p=D);S.i.push(new sr(S.Ya++,p)),S.I==3&&hs(S)},gn.prototype.N=function(){this.g.l=null,delete this.j,qa(this.g),delete this.g,gn.Z.N.call(this)};function ua(p){ze.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var S=p.__sm__;if(S){e:{for(const D in S){p=D;break e}p=void 0}(this.i=p)&&(p=this.i,S=S!==null&&p in S?S[p]:void 0),this.data=S}else this.data=p}R(ua,ze);function gs(){zt.call(this),this.status=1}R(gs,zt);function mn(p){this.g=p}R(mn,gr),mn.prototype.ra=function(){ke(this.g,"a")},mn.prototype.qa=function(p){ke(this.g,new ua(p))},mn.prototype.pa=function(p){ke(this.g,new gs)},mn.prototype.oa=function(){ke(this.g,"b")},fs.prototype.createWebChannel=fs.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,bw=function(){return new fs},Aw=function(){return vr()},_w=wt,B1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rt.NO_ERROR=0,rt.TIMEOUT=8,rt.HTTP_ERROR=6,dd=rt,ft.COMPLETE="complete",ww=ft,ki.EventType=tn,tn.OPEN="a",tn.CLOSE="b",tn.ERROR="c",tn.MESSAGE="d",Fe.prototype.listen=Fe.prototype.J,hu=ki,Ln.prototype.listenOnce=Ln.prototype.K,Ln.prototype.getLastError=Ln.prototype.Ha,Ln.prototype.getLastErrorCode=Ln.prototype.ya,Ln.prototype.getStatus=Ln.prototype.ca,Ln.prototype.getResponseJson=Ln.prototype.La,Ln.prototype.getResponseText=Ln.prototype.la,Ln.prototype.send=Ln.prototype.ea,Ln.prototype.setWithCredentials=Ln.prototype.Fa,Ew=Ln}).apply(typeof td<"u"?td:typeof self<"u"?self:typeof window<"u"?window:{});const $2="@firebase/firestore",ex="4.9.2";class _i{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_i.UNAUTHENTICATED=new _i(null),_i.GOOGLE_CREDENTIALS=new _i("google-credentials-uid"),_i.FIRST_PARTY=new _i("first-party-uid"),_i.MOCK_USER=new _i("mock-user");let xc="12.3.0";const pl=new lg("@firebase/firestore");function Zl(){return pl.logLevel}function yt(s,...e){if(pl.logLevel<=Tn.DEBUG){const t=e.map(Eg);pl.debug(`Firestore (${xc}): ${s}`,...t)}}function Va(s,...e){if(pl.logLevel<=Tn.ERROR){const t=e.map(Eg);pl.error(`Firestore (${xc}): ${s}`,...t)}}function uc(s,...e){if(pl.logLevel<=Tn.WARN){const t=e.map(Eg);pl.warn(`Firestore (${xc}): ${s}`,...t)}}function Eg(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function qt(s,e,t){let o="Unexpected state";typeof e=="string"?o=e:t=e,vw(s,o,t)}function vw(s,e,t){let o=`FIRESTORE (${xc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{o+=" CONTEXT: "+JSON.stringify(t)}catch{o+=" CONTEXT: "+t}throw Va(o),new Error(o)}function qn(s,e,t,o){let u="Unexpected state";typeof t=="string"?u=t:o=t,s||vw(e,u,o)}function $t(s,e){return s}const Le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ct extends na{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ka{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Tw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(_i.UNAUTHENTICATED)))}shutdown(){}}class X3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Y3{constructor(e){this.t=e,this.currentUser=_i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){qn(this.o===void 0,42304);let o=this.i;const u=b=>this.i!==o?(o=this.i,t(b)):Promise.resolve();let g=new ka;this.o=()=>{this.i++,this.currentUser=this.u(),g.resolve(),g=new ka,e.enqueueRetryable((()=>u(this.currentUser)))};const x=()=>{const b=g;e.enqueueRetryable((async()=>{await b.promise,await u(this.currentUser)}))},T=b=>{yt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=b,this.o&&(this.auth.addAuthTokenListener(this.o),x())};this.t.onInit((b=>T(b))),setTimeout((()=>{if(!this.auth){const b=this.t.getImmediate({optional:!0});b?T(b):(yt("FirebaseAuthCredentialsProvider","Auth not yet detected"),g.resolve(),g=new ka)}}),0),x()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((o=>this.i!==e?(yt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(qn(typeof o.accessToken=="string",31837,{l:o}),new Tw(o.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qn(e===null||typeof e=="string",2055,{h:e}),new _i(e)}}class K3{constructor(e,t,o){this.P=e,this.T=t,this.I=o,this.type="FirstParty",this.user=_i.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class W3{constructor(e,t,o){this.P=e,this.T=t,this.I=o}getToken(){return Promise.resolve(new K3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(_i.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Q3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,cs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){qn(this.o===void 0,3512);const o=g=>{g.error!=null&&yt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${g.error.message}`);const x=g.token!==this.m;return this.m=g.token,yt("FirebaseAppCheckTokenProvider",`Received ${x?"new":"existing"} token.`),x?t(g.token):Promise.resolve()};this.o=g=>{e.enqueueRetryable((()=>o(g)))};const u=g=>{yt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=g,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((g=>u(g))),setTimeout((()=>{if(!this.appCheck){const g=this.V.getImmediate({optional:!0});g?u(g):yt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(qn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Z3(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let o=0;o<s;o++)t[o]=Math.floor(256*Math.random());return t}class wg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let o="";for(;o.length<20;){const u=Z3(40);for(let g=0;g<u.length;++g)o.length<20&&u[g]<t&&(o+=e.charAt(u[g]%62))}return o}}function Sn(s,e){return s<e?-1:s>e?1:0}function V1(s,e){const t=Math.min(s.length,e.length);for(let o=0;o<t;o++){const u=s.charAt(o),g=e.charAt(o);if(u!==g)return E1(u)===E1(g)?Sn(u,g):E1(u)?1:-1}return Sn(s.length,e.length)}const J3=55296,$3=57343;function E1(s){const e=s.charCodeAt(0);return e>=J3&&e<=$3}function hc(s,e,t){return s.length===e.length&&s.every(((o,u)=>t(o,e[u])))}const nx="__name__";class Xs{constructor(e,t,o){t===void 0?t=0:t>e.length&&qt(637,{offset:t,range:e.length}),o===void 0?o=e.length-t:o>e.length-t&&qt(1746,{length:o,range:e.length-t}),this.segments=e,this.offset=t,this.len=o}get length(){return this.len}isEqual(e){return Xs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Xs?e.forEach((o=>{t.push(o)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,o=this.limit();t<o;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const o=Math.min(e.length,t.length);for(let u=0;u<o;u++){const g=Xs.compareSegments(e.get(u),t.get(u));if(g!==0)return g}return Sn(e.length,t.length)}static compareSegments(e,t){const o=Xs.isNumericId(e),u=Xs.isNumericId(t);return o&&!u?-1:!o&&u?1:o&&u?Xs.extractNumericId(e).compare(Xs.extractNumericId(t)):V1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ro.fromString(e.substring(4,e.length-2))}}class ar extends Xs{construct(e,t,o){return new ar(e,t,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const o of e){if(o.indexOf("//")>=0)throw new ct(Le.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);t.push(...o.split("/").filter((u=>u.length>0)))}return new ar(t)}static emptyPath(){return new ar([])}}const eS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hi extends Xs{construct(e,t,o){return new hi(e,t,o)}static isValidIdentifier(e){return eS.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hi.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nx}static keyField(){return new hi([nx])}static fromServerFormat(e){const t=[];let o="",u=0;const g=()=>{if(o.length===0)throw new ct(Le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(o),o=""};let x=!1;for(;u<e.length;){const T=e[u];if(T==="\\"){if(u+1===e.length)throw new ct(Le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const b=e[u+1];if(b!=="\\"&&b!=="."&&b!=="`")throw new ct(Le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);o+=b,u+=2}else T==="`"?(x=!x,u++):T!=="."||x?(o+=T,u++):(g(),u++)}if(g(),x)throw new ct(Le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hi(t)}static emptyPath(){return new hi([])}}class Mt{constructor(e){this.path=e}static fromPath(e){return new Mt(ar.fromString(e))}static fromName(e){return new Mt(ar.fromString(e).popFirst(5))}static empty(){return new Mt(ar.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ar.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ar.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Mt(new ar(e.slice()))}}function Cw(s,e,t){if(!t)throw new ct(Le.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function tS(s,e,t,o){if(e===!0&&o===!0)throw new ct(Le.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function rx(s){if(!Mt.isDocumentKey(s))throw new ct(Le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function ix(s){if(Mt.isDocumentKey(s))throw new ct(Le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Sw(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function $d(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(o){return o.constructor?o.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":qt(12329,{type:typeof s})}function Di(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new ct(Le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$d(s);throw new ct(Le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function nS(s,e){if(e<=0)throw new ct(Le.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function qr(s,e){const t={typeString:s};return e&&(t.value=e),t}function Uu(s,e){if(!Sw(s))throw new ct(Le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const o in e)if(e[o]){const u=e[o].typeString,g="value"in e[o]?{value:e[o].value}:void 0;if(!(o in s)){t=`JSON missing required field: '${o}'`;break}const x=s[o];if(u&&typeof x!==u){t=`JSON field '${o}' must be a ${u}.`;break}if(g!==void 0&&x!==g.value){t=`Expected '${o}' field to equal '${g.value}'`;break}}if(t)throw new ct(Le.INVALID_ARGUMENT,t);return!0}const sx=-62135596800,ax=1e6;class Vn{static now(){return Vn.fromMillis(Date.now())}static fromDate(e){return Vn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),o=Math.floor((e-1e3*t)*ax);return new Vn(t,o)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ct(Le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ct(Le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<sx)throw new ct(Le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ct(Le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ax}_compareTo(e){return this.seconds===e.seconds?Sn(this.nanoseconds,e.nanoseconds):Sn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Vn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Uu(e,Vn._jsonSchema))return new Vn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Vn._jsonSchemaVersion="firestore/timestamp/1.0",Vn._jsonSchema={type:qr("string",Vn._jsonSchemaVersion),seconds:qr("number"),nanoseconds:qr("number")};class Wt{static fromTimestamp(e){return new Wt(e)}static min(){return new Wt(new Vn(0,0))}static max(){return new Wt(new Vn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Tu=-1;function rS(s,e){const t=s.toTimestamp().seconds,o=s.toTimestamp().nanoseconds+1,u=Wt.fromTimestamp(o===1e9?new Vn(t+1,0):new Vn(t,o));return new Do(u,Mt.empty(),e)}function iS(s){return new Do(s.readTime,s.key,Tu)}class Do{constructor(e,t,o){this.readTime=e,this.documentKey=t,this.largestBatchId=o}static min(){return new Do(Wt.min(),Mt.empty(),Tu)}static max(){return new Do(Wt.max(),Mt.empty(),Tu)}}function sS(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Mt.comparator(s.documentKey,e.documentKey),t!==0?t:Sn(s.largestBatchId,e.largestBatchId))}const aS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ec(s){if(s.code!==Le.FAILED_PRECONDITION||s.message!==aS)throw s;yt("LocalStore","Unexpectedly lost primary lease")}class je{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&qt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new je(((o,u)=>{this.nextCallback=g=>{this.wrapSuccess(e,g).next(o,u)},this.catchCallback=g=>{this.wrapFailure(t,g).next(o,u)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof je?t:je.resolve(t)}catch(t){return je.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):je.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):je.reject(t)}static resolve(e){return new je(((t,o)=>{t(e)}))}static reject(e){return new je(((t,o)=>{o(e)}))}static waitFor(e){return new je(((t,o)=>{let u=0,g=0,x=!1;e.forEach((T=>{++u,T.next((()=>{++g,x&&g===u&&t()}),(b=>o(b)))})),x=!0,g===u&&t()}))}static or(e){let t=je.resolve(!1);for(const o of e)t=t.next((u=>u?je.resolve(u):o()));return t}static forEach(e,t){const o=[];return e.forEach(((u,g)=>{o.push(t.call(this,u,g))})),this.waitFor(o)}static mapArray(e,t){return new je(((o,u)=>{const g=e.length,x=new Array(g);let T=0;for(let b=0;b<g;b++){const w=b;t(e[w]).next((C=>{x[w]=C,++T,T===g&&o(x)}),(C=>u(C)))}}))}static doWhile(e,t){return new je(((o,u)=>{const g=()=>{e()===!0?t().next((()=>{g()}),u):o()};g()}))}}function lS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function wc(s){return s.name==="IndexedDbTransactionError"}class ef{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=o=>this.ae(o),this.ue=o=>t.writeSequenceNumber(o))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ef.ce=-1;const _g=-1;function tf(s){return s==null}function Id(s){return s===0&&1/s==-1/0}function cS(s){return typeof s=="number"&&Number.isInteger(s)&&!Id(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Iw="";function uS(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=ox(e)),e=hS(s.get(t),e);return ox(e)}function hS(s,e){let t=e;const o=s.length;for(let u=0;u<o;u++){const g=s.charAt(u);switch(g){case"\0":t+="";break;case Iw:t+="";break;default:t+=g}}return t}function ox(s){return s+Iw+""}function lx(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Fo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function Rw(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class br{constructor(e,t){this.comparator=e,this.root=t||ci.EMPTY}insert(e,t){return new br(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ci.BLACK,null,null))}remove(e){return new br(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ci.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const o=this.comparator(e,t.key);if(o===0)return t.value;o<0?t=t.left:o>0&&(t=t.right)}return null}indexOf(e){let t=0,o=this.root;for(;!o.isEmpty();){const u=this.comparator(e,o.key);if(u===0)return t+o.left.size;u<0?o=o.left:(t+=o.left.size+1,o=o.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,o)=>(e(t,o),!1)))}toString(){const e=[];return this.inorderTraversal(((t,o)=>(e.push(`${t}:${o}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nd(this.root,e,this.comparator,!1)}getReverseIterator(){return new nd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nd(this.root,e,this.comparator,!0)}}class nd{constructor(e,t,o,u){this.isReverse=u,this.nodeStack=[];let g=1;for(;!e.isEmpty();)if(g=t?o(e.key,t):1,t&&u&&(g*=-1),g<0)e=this.isReverse?e.left:e.right;else{if(g===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ci{constructor(e,t,o,u,g){this.key=e,this.value=t,this.color=o??ci.RED,this.left=u??ci.EMPTY,this.right=g??ci.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,o,u,g){return new ci(e??this.key,t??this.value,o??this.color,u??this.left,g??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,o){let u=this;const g=o(e,u.key);return u=g<0?u.copy(null,null,null,u.left.insert(e,t,o),null):g===0?u.copy(null,t,null,null,null):u.copy(null,null,null,null,u.right.insert(e,t,o)),u.fixUp()}removeMin(){if(this.left.isEmpty())return ci.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let o,u=this;if(t(e,u.key)<0)u.left.isEmpty()||u.left.isRed()||u.left.left.isRed()||(u=u.moveRedLeft()),u=u.copy(null,null,null,u.left.remove(e,t),null);else{if(u.left.isRed()&&(u=u.rotateRight()),u.right.isEmpty()||u.right.isRed()||u.right.left.isRed()||(u=u.moveRedRight()),t(e,u.key)===0){if(u.right.isEmpty())return ci.EMPTY;o=u.right.min(),u=u.copy(o.key,o.value,null,null,u.right.removeMin())}u=u.copy(null,null,null,null,u.right.remove(e,t))}return u.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw qt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw qt(27949);return e+(this.isRed()?0:1)}}ci.EMPTY=null,ci.RED=!0,ci.BLACK=!1;ci.EMPTY=new class{constructor(){this.size=0}get key(){throw qt(57766)}get value(){throw qt(16141)}get color(){throw qt(16727)}get left(){throw qt(29726)}get right(){throw qt(36894)}copy(e,t,o,u,g){return this}insert(e,t,o){return new ci(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qr{constructor(e){this.comparator=e,this.data=new br(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,o)=>(e(t),!1)))}forEachInRange(e,t){const o=this.data.getIteratorFrom(e[0]);for(;o.hasNext();){const u=o.getNext();if(this.comparator(u.key,e[1])>=0)return;t(u.key)}}forEachWhile(e,t){let o;for(o=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();o.hasNext();)if(!e(o.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cx(this.data.getIterator())}getIteratorFrom(e){return new cx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((o=>{t=t.add(o)})),t}isEqual(e){if(!(e instanceof Qr)||this.size!==e.size)return!1;const t=this.data.getIterator(),o=e.data.getIterator();for(;t.hasNext();){const u=t.getNext().key,g=o.getNext().key;if(this.comparator(u,g)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qr(this.comparator);return t.data=e,t}}class cx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class us{constructor(e){this.fields=e,e.sort(hi.comparator)}static empty(){return new us([])}unionWith(e){let t=new Qr(hi.comparator);for(const o of this.fields)t=t.add(o);for(const o of e)t=t.add(o);return new us(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hc(this.fields,e.fields,((t,o)=>t.isEqual(o)))}}class Nw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class di{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(u){try{return atob(u)}catch(g){throw typeof DOMException<"u"&&g instanceof DOMException?new Nw("Invalid base64 string: "+g):g}})(e);return new di(t)}static fromUint8Array(e){const t=(function(u){let g="";for(let x=0;x<u.length;++x)g+=String.fromCharCode(u[x]);return g})(e);return new di(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const o=new Uint8Array(t.length);for(let u=0;u<t.length;u++)o[u]=t.charCodeAt(u);return o})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Sn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}di.EMPTY_BYTE_STRING=new di("");const dS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mo(s){if(qn(!!s,39018),typeof s=="string"){let e=0;const t=dS.exec(s);if(qn(!!t,46558,{timestamp:s}),t[1]){let u=t[1];u=(u+"000000000").substr(0,9),e=Number(u)}const o=new Date(s);return{seconds:Math.floor(o.getTime()/1e3),nanos:e}}return{seconds:Vr(s.seconds),nanos:Vr(s.nanos)}}function Vr(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function ko(s){return typeof s=="string"?di.fromBase64String(s):di.fromUint8Array(s)}const Ow="server_timestamp",Dw="__type__",Mw="__previous_value__",kw="__local_write_time__";function Ag(s){return(s?.mapValue?.fields||{})[Dw]?.stringValue===Ow}function nf(s){const e=s.mapValue.fields[Mw];return Ag(e)?nf(e):e}function Cu(s){const e=Mo(s.mapValue.fields[kw].timestampValue);return new Vn(e.seconds,e.nanos)}class fS{constructor(e,t,o,u,g,x,T,b,w,C){this.databaseId=e,this.appId=t,this.persistenceKey=o,this.host=u,this.ssl=g,this.forceLongPolling=x,this.autoDetectLongPolling=T,this.longPollingOptions=b,this.useFetchStreams=w,this.isUsingEmulator=C}}const Rd="(default)";class Su{constructor(e,t){this.projectId=e,this.database=t||Rd}static empty(){return new Su("","")}get isDefaultDatabase(){return this.database===Rd}isEqual(e){return e instanceof Su&&e.projectId===this.projectId&&e.database===this.database}}const Lw="__type__",gS="__max__",rd={mapValue:{}},Pw="__vector__",Nd="value";function Lo(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Ag(s)?4:pS(s)?9007199254740991:mS(s)?10:11:qt(28295,{value:s})}function ea(s,e){if(s===e)return!0;const t=Lo(s);if(t!==Lo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Cu(s).isEqual(Cu(e));case 3:return(function(u,g){if(typeof u.timestampValue=="string"&&typeof g.timestampValue=="string"&&u.timestampValue.length===g.timestampValue.length)return u.timestampValue===g.timestampValue;const x=Mo(u.timestampValue),T=Mo(g.timestampValue);return x.seconds===T.seconds&&x.nanos===T.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(u,g){return ko(u.bytesValue).isEqual(ko(g.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(u,g){return Vr(u.geoPointValue.latitude)===Vr(g.geoPointValue.latitude)&&Vr(u.geoPointValue.longitude)===Vr(g.geoPointValue.longitude)})(s,e);case 2:return(function(u,g){if("integerValue"in u&&"integerValue"in g)return Vr(u.integerValue)===Vr(g.integerValue);if("doubleValue"in u&&"doubleValue"in g){const x=Vr(u.doubleValue),T=Vr(g.doubleValue);return x===T?Id(x)===Id(T):isNaN(x)&&isNaN(T)}return!1})(s,e);case 9:return hc(s.arrayValue.values||[],e.arrayValue.values||[],ea);case 10:case 11:return(function(u,g){const x=u.mapValue.fields||{},T=g.mapValue.fields||{};if(lx(x)!==lx(T))return!1;for(const b in x)if(x.hasOwnProperty(b)&&(T[b]===void 0||!ea(x[b],T[b])))return!1;return!0})(s,e);default:return qt(52216,{left:s})}}function Iu(s,e){return(s.values||[]).find((t=>ea(t,e)))!==void 0}function dc(s,e){if(s===e)return 0;const t=Lo(s),o=Lo(e);if(t!==o)return Sn(t,o);switch(t){case 0:case 9007199254740991:return 0;case 1:return Sn(s.booleanValue,e.booleanValue);case 2:return(function(g,x){const T=Vr(g.integerValue||g.doubleValue),b=Vr(x.integerValue||x.doubleValue);return T<b?-1:T>b?1:T===b?0:isNaN(T)?isNaN(b)?0:-1:1})(s,e);case 3:return ux(s.timestampValue,e.timestampValue);case 4:return ux(Cu(s),Cu(e));case 5:return V1(s.stringValue,e.stringValue);case 6:return(function(g,x){const T=ko(g),b=ko(x);return T.compareTo(b)})(s.bytesValue,e.bytesValue);case 7:return(function(g,x){const T=g.split("/"),b=x.split("/");for(let w=0;w<T.length&&w<b.length;w++){const C=Sn(T[w],b[w]);if(C!==0)return C}return Sn(T.length,b.length)})(s.referenceValue,e.referenceValue);case 8:return(function(g,x){const T=Sn(Vr(g.latitude),Vr(x.latitude));return T!==0?T:Sn(Vr(g.longitude),Vr(x.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return hx(s.arrayValue,e.arrayValue);case 10:return(function(g,x){const T=g.fields||{},b=x.fields||{},w=T[Nd]?.arrayValue,C=b[Nd]?.arrayValue,R=Sn(w?.values?.length||0,C?.values?.length||0);return R!==0?R:hx(w,C)})(s.mapValue,e.mapValue);case 11:return(function(g,x){if(g===rd.mapValue&&x===rd.mapValue)return 0;if(g===rd.mapValue)return 1;if(x===rd.mapValue)return-1;const T=g.fields||{},b=Object.keys(T),w=x.fields||{},C=Object.keys(w);b.sort(),C.sort();for(let R=0;R<b.length&&R<C.length;++R){const P=V1(b[R],C[R]);if(P!==0)return P;const L=dc(T[b[R]],w[C[R]]);if(L!==0)return L}return Sn(b.length,C.length)})(s.mapValue,e.mapValue);default:throw qt(23264,{he:t})}}function ux(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Sn(s,e);const t=Mo(s),o=Mo(e),u=Sn(t.seconds,o.seconds);return u!==0?u:Sn(t.nanos,o.nanos)}function hx(s,e){const t=s.values||[],o=e.values||[];for(let u=0;u<t.length&&u<o.length;++u){const g=dc(t[u],o[u]);if(g)return g}return Sn(t.length,o.length)}function fc(s){return U1(s)}function U1(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const o=Mo(t);return`time(${o.seconds},${o.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return ko(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Mt.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let o="[",u=!0;for(const g of t.values||[])u?u=!1:o+=",",o+=U1(g);return o+"]"})(s.arrayValue):"mapValue"in s?(function(t){const o=Object.keys(t.fields||{}).sort();let u="{",g=!0;for(const x of o)g?g=!1:u+=",",u+=`${x}:${U1(t.fields[x])}`;return u+"}"})(s.mapValue):qt(61005,{value:s})}function fd(s){switch(Lo(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nf(s);return e?16+fd(e):16;case 5:return 2*s.stringValue.length;case 6:return ko(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(o){return(o.values||[]).reduce(((u,g)=>u+fd(g)),0)})(s.arrayValue);case 10:case 11:return(function(o){let u=0;return Fo(o.fields,((g,x)=>{u+=g.length+fd(x)})),u})(s.mapValue);default:throw qt(13486,{value:s})}}function dx(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function F1(s){return!!s&&"integerValue"in s}function bg(s){return!!s&&"arrayValue"in s}function fx(s){return!!s&&"nullValue"in s}function gx(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function gd(s){return!!s&&"mapValue"in s}function mS(s){return(s?.mapValue?.fields||{})[Lw]?.stringValue===Pw}function xu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Fo(s.mapValue.fields,((t,o)=>e.mapValue.fields[t]=xu(o))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=xu(s.arrayValue.values[t]);return e}return{...s}}function pS(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===gS}class Ki{constructor(e){this.value=e}static empty(){return new Ki({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let o=0;o<e.length-1;++o)if(t=(t.mapValue.fields||{})[e.get(o)],!gd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xu(t)}setAll(e){let t=hi.emptyPath(),o={},u=[];e.forEach(((x,T)=>{if(!t.isImmediateParentOf(T)){const b=this.getFieldsMap(t);this.applyChanges(b,o,u),o={},u=[],t=T.popLast()}x?o[T.lastSegment()]=xu(x):u.push(T.lastSegment())}));const g=this.getFieldsMap(t);this.applyChanges(g,o,u)}delete(e){const t=this.field(e.popLast());gd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ea(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let o=0;o<e.length;++o){let u=t.mapValue.fields[e.get(o)];gd(u)&&u.mapValue.fields||(u={mapValue:{fields:{}}},t.mapValue.fields[e.get(o)]=u),t=u}return t.mapValue.fields}applyChanges(e,t,o){Fo(t,((u,g)=>e[u]=g));for(const u of o)delete e[u]}clone(){return new Ki(xu(this.value))}}function Bw(s){const e=[];return Fo(s.fields,((t,o)=>{const u=new hi([t]);if(gd(o)){const g=Bw(o.mapValue).fields;if(g.length===0)e.push(u);else for(const x of g)e.push(u.child(x))}else e.push(u)})),new us(e)}class Ai{constructor(e,t,o,u,g,x,T){this.key=e,this.documentType=t,this.version=o,this.readTime=u,this.createTime=g,this.data=x,this.documentState=T}static newInvalidDocument(e){return new Ai(e,0,Wt.min(),Wt.min(),Wt.min(),Ki.empty(),0)}static newFoundDocument(e,t,o,u){return new Ai(e,1,t,Wt.min(),o,u,0)}static newNoDocument(e,t){return new Ai(e,2,t,Wt.min(),Wt.min(),Ki.empty(),0)}static newUnknownDocument(e,t){return new Ai(e,3,t,Wt.min(),Wt.min(),Ki.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Wt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ki.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ki.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Wt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ai&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ai(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Od{constructor(e,t){this.position=e,this.inclusive=t}}function mx(s,e,t){let o=0;for(let u=0;u<s.position.length;u++){const g=e[u],x=s.position[u];if(g.field.isKeyField()?o=Mt.comparator(Mt.fromName(x.referenceValue),t.key):o=dc(x,t.data.field(g.field)),g.dir==="desc"&&(o*=-1),o!==0)break}return o}function px(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!ea(s.position[t],e.position[t]))return!1;return!0}class Ru{constructor(e,t="asc"){this.field=e,this.dir=t}}function yS(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Vw{}class Gr extends Vw{constructor(e,t,o){super(),this.field=e,this.op=t,this.value=o}static create(e,t,o){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,o):new ES(e,t,o):t==="array-contains"?new AS(e,o):t==="in"?new bS(e,o):t==="not-in"?new vS(e,o):t==="array-contains-any"?new TS(e,o):new Gr(e,t,o)}static createKeyFieldInFilter(e,t,o){return t==="in"?new wS(e,o):new _S(e,o)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(dc(t,this.value)):t!==null&&Lo(this.value)===Lo(t)&&this.matchesComparison(dc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return qt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ls extends Vw{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ls(e,t)}matches(e){return Uw(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Uw(s){return s.op==="and"}function Fw(s){return xS(s)&&Uw(s)}function xS(s){for(const e of s.filters)if(e instanceof Ls)return!1;return!0}function j1(s){if(s instanceof Gr)return s.field.canonicalString()+s.op.toString()+fc(s.value);if(Fw(s))return s.filters.map((e=>j1(e))).join(",");{const e=s.filters.map((t=>j1(t))).join(",");return`${s.op}(${e})`}}function jw(s,e){return s instanceof Gr?(function(o,u){return u instanceof Gr&&o.op===u.op&&o.field.isEqual(u.field)&&ea(o.value,u.value)})(s,e):s instanceof Ls?(function(o,u){return u instanceof Ls&&o.op===u.op&&o.filters.length===u.filters.length?o.filters.reduce(((g,x,T)=>g&&jw(x,u.filters[T])),!0):!1})(s,e):void qt(19439)}function zw(s){return s instanceof Gr?(function(t){return`${t.field.canonicalString()} ${t.op} ${fc(t.value)}`})(s):s instanceof Ls?(function(t){return t.op.toString()+" {"+t.getFilters().map(zw).join(" ,")+"}"})(s):"Filter"}class ES extends Gr{constructor(e,t,o){super(e,t,o),this.key=Mt.fromName(o.referenceValue)}matches(e){const t=Mt.comparator(e.key,this.key);return this.matchesComparison(t)}}class wS extends Gr{constructor(e,t){super(e,"in",t),this.keys=Hw("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class _S extends Gr{constructor(e,t){super(e,"not-in",t),this.keys=Hw("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Hw(s,e){return(e.arrayValue?.values||[]).map((t=>Mt.fromName(t.referenceValue)))}class AS extends Gr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bg(t)&&Iu(t.arrayValue,this.value)}}class bS extends Gr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Iu(this.value.arrayValue,t)}}class vS extends Gr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Iu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Iu(this.value.arrayValue,t)}}class TS extends Gr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((o=>Iu(this.value.arrayValue,o)))}}class CS{constructor(e,t=null,o=[],u=[],g=null,x=null,T=null){this.path=e,this.collectionGroup=t,this.orderBy=o,this.filters=u,this.limit=g,this.startAt=x,this.endAt=T,this.Te=null}}function yx(s,e=null,t=[],o=[],u=null,g=null,x=null){return new CS(s,e,t,o,u,g,x)}function vg(s){const e=$t(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((o=>j1(o))).join(","),t+="|ob:",t+=e.orderBy.map((o=>(function(g){return g.field.canonicalString()+g.dir})(o))).join(","),tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((o=>fc(o))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((o=>fc(o))).join(",")),e.Te=t}return e.Te}function Tg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!yS(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!jw(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!px(s.startAt,e.startAt)&&px(s.endAt,e.endAt)}function z1(s){return Mt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class _c{constructor(e,t=null,o=[],u=[],g=null,x="F",T=null,b=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=o,this.filters=u,this.limit=g,this.limitType=x,this.startAt=T,this.endAt=b,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function SS(s,e,t,o,u,g,x,T){return new _c(s,e,t,o,u,g,x,T)}function rf(s){return new _c(s)}function xx(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Gw(s){return s.collectionGroup!==null}function Eu(s){const e=$t(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const g of e.explicitOrderBy)e.Ie.push(g),t.add(g.field.canonicalString());const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(x){let T=new Qr(hi.comparator);return x.filters.forEach((b=>{b.getFlattenedFilters().forEach((w=>{w.isInequality()&&(T=T.add(w.field))}))})),T})(e).forEach((g=>{t.has(g.canonicalString())||g.isKeyField()||e.Ie.push(new Ru(g,o))})),t.has(hi.keyField().canonicalString())||e.Ie.push(new Ru(hi.keyField(),o))}return e.Ie}function Qs(s){const e=$t(s);return e.Ee||(e.Ee=IS(e,Eu(s))),e.Ee}function IS(s,e){if(s.limitType==="F")return yx(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((u=>{const g=u.dir==="desc"?"asc":"desc";return new Ru(u.field,g)}));const t=s.endAt?new Od(s.endAt.position,s.endAt.inclusive):null,o=s.startAt?new Od(s.startAt.position,s.startAt.inclusive):null;return yx(s.path,s.collectionGroup,e,s.filters,s.limit,t,o)}}function H1(s,e){const t=s.filters.concat([e]);return new _c(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function Dd(s,e,t){return new _c(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function sf(s,e){return Tg(Qs(s),Qs(e))&&s.limitType===e.limitType}function qw(s){return`${vg(Qs(s))}|lt:${s.limitType}`}function Jl(s){return`Query(target=${(function(t){let o=t.path.canonicalString();return t.collectionGroup!==null&&(o+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(o+=`, filters: [${t.filters.map((u=>zw(u))).join(", ")}]`),tf(t.limit)||(o+=", limit: "+t.limit),t.orderBy.length>0&&(o+=`, orderBy: [${t.orderBy.map((u=>(function(x){return`${x.field.canonicalString()} (${x.dir})`})(u))).join(", ")}]`),t.startAt&&(o+=", startAt: ",o+=t.startAt.inclusive?"b:":"a:",o+=t.startAt.position.map((u=>fc(u))).join(",")),t.endAt&&(o+=", endAt: ",o+=t.endAt.inclusive?"a:":"b:",o+=t.endAt.position.map((u=>fc(u))).join(",")),`Target(${o})`})(Qs(s))}; limitType=${s.limitType})`}function af(s,e){return e.isFoundDocument()&&(function(o,u){const g=u.key.path;return o.collectionGroup!==null?u.key.hasCollectionId(o.collectionGroup)&&o.path.isPrefixOf(g):Mt.isDocumentKey(o.path)?o.path.isEqual(g):o.path.isImmediateParentOf(g)})(s,e)&&(function(o,u){for(const g of Eu(o))if(!g.field.isKeyField()&&u.data.field(g.field)===null)return!1;return!0})(s,e)&&(function(o,u){for(const g of o.filters)if(!g.matches(u))return!1;return!0})(s,e)&&(function(o,u){return!(o.startAt&&!(function(x,T,b){const w=mx(x,T,b);return x.inclusive?w<=0:w<0})(o.startAt,Eu(o),u)||o.endAt&&!(function(x,T,b){const w=mx(x,T,b);return x.inclusive?w>=0:w>0})(o.endAt,Eu(o),u))})(s,e)}function RS(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Xw(s){return(e,t)=>{let o=!1;for(const u of Eu(s)){const g=NS(u,e,t);if(g!==0)return g;o=o||u.field.isKeyField()}return 0}}function NS(s,e,t){const o=s.field.isKeyField()?Mt.comparator(e.key,t.key):(function(g,x,T){const b=x.data.field(g),w=T.data.field(g);return b!==null&&w!==null?dc(b,w):qt(42886)})(s.field,e,t);switch(s.dir){case"asc":return o;case"desc":return-1*o;default:return qt(19790,{direction:s.dir})}}class wl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),o=this.inner[t];if(o!==void 0){for(const[u,g]of o)if(this.equalsFn(u,e))return g}}has(e){return this.get(e)!==void 0}set(e,t){const o=this.mapKeyFn(e),u=this.inner[o];if(u===void 0)return this.inner[o]=[[e,t]],void this.innerSize++;for(let g=0;g<u.length;g++)if(this.equalsFn(u[g][0],e))return void(u[g]=[e,t]);u.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),o=this.inner[t];if(o===void 0)return!1;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return o.length===1?delete this.inner[t]:o.splice(u,1),this.innerSize--,!0;return!1}forEach(e){Fo(this.inner,((t,o)=>{for(const[u,g]of o)e(u,g)}))}isEmpty(){return Rw(this.inner)}size(){return this.innerSize}}const OS=new br(Mt.comparator);function Ua(){return OS}const Yw=new br(Mt.comparator);function du(...s){let e=Yw;for(const t of s)e=e.insert(t.key,t);return e}function Kw(s){let e=Yw;return s.forEach(((t,o)=>e=e.insert(t,o.overlayedDocument))),e}function ll(){return wu()}function Ww(){return wu()}function wu(){return new wl((s=>s.toString()),((s,e)=>s.isEqual(e)))}const DS=new br(Mt.comparator),MS=new Qr(Mt.comparator);function In(...s){let e=MS;for(const t of s)e=e.add(t);return e}const kS=new Qr(Sn);function LS(){return kS}function Cg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Id(e)?"-0":e}}function Qw(s){return{integerValue:""+s}}function PS(s,e){return cS(e)?Qw(e):Cg(s,e)}class of{constructor(){this._=void 0}}function BS(s,e,t){return s instanceof Nu?(function(u,g){const x={fields:{[Dw]:{stringValue:Ow},[kw]:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}};return g&&Ag(g)&&(g=nf(g)),g&&(x.fields[Mw]=g),{mapValue:x}})(t,e):s instanceof Ou?Jw(s,e):s instanceof Du?$w(s,e):(function(u,g){const x=Zw(u,g),T=Ex(x)+Ex(u.Ae);return F1(x)&&F1(u.Ae)?Qw(T):Cg(u.serializer,T)})(s,e)}function VS(s,e,t){return s instanceof Ou?Jw(s,e):s instanceof Du?$w(s,e):t}function Zw(s,e){return s instanceof Md?(function(o){return F1(o)||(function(g){return!!g&&"doubleValue"in g})(o)})(e)?e:{integerValue:0}:null}class Nu extends of{}class Ou extends of{constructor(e){super(),this.elements=e}}function Jw(s,e){const t=e_(e);for(const o of s.elements)t.some((u=>ea(u,o)))||t.push(o);return{arrayValue:{values:t}}}class Du extends of{constructor(e){super(),this.elements=e}}function $w(s,e){let t=e_(e);for(const o of s.elements)t=t.filter((u=>!ea(u,o)));return{arrayValue:{values:t}}}class Md extends of{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ex(s){return Vr(s.integerValue||s.doubleValue)}function e_(s){return bg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class US{constructor(e,t){this.field=e,this.transform=t}}function FS(s,e){return s.field.isEqual(e.field)&&(function(o,u){return o instanceof Ou&&u instanceof Ou||o instanceof Du&&u instanceof Du?hc(o.elements,u.elements,ea):o instanceof Md&&u instanceof Md?ea(o.Ae,u.Ae):o instanceof Nu&&u instanceof Nu})(s.transform,e.transform)}class jS{constructor(e,t){this.version=e,this.transformResults=t}}class Mi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Mi}static exists(e){return new Mi(void 0,e)}static updateTime(e){return new Mi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function md(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class lf{}function t_(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new cf(s.key,Mi.none()):new Fu(s.key,s.data,Mi.none());{const t=s.data,o=Ki.empty();let u=new Qr(hi.comparator);for(let g of e.fields)if(!u.has(g)){let x=t.field(g);x===null&&g.length>1&&(g=g.popLast(),x=t.field(g)),x===null?o.delete(g):o.set(g,x),u=u.add(g)}return new jo(s.key,o,new us(u.toArray()),Mi.none())}}function zS(s,e,t){s instanceof Fu?(function(u,g,x){const T=u.value.clone(),b=_x(u.fieldTransforms,g,x.transformResults);T.setAll(b),g.convertToFoundDocument(x.version,T).setHasCommittedMutations()})(s,e,t):s instanceof jo?(function(u,g,x){if(!md(u.precondition,g))return void g.convertToUnknownDocument(x.version);const T=_x(u.fieldTransforms,g,x.transformResults),b=g.data;b.setAll(n_(u)),b.setAll(T),g.convertToFoundDocument(x.version,b).setHasCommittedMutations()})(s,e,t):(function(u,g,x){g.convertToNoDocument(x.version).setHasCommittedMutations()})(0,e,t)}function _u(s,e,t,o){return s instanceof Fu?(function(g,x,T,b){if(!md(g.precondition,x))return T;const w=g.value.clone(),C=Ax(g.fieldTransforms,b,x);return w.setAll(C),x.convertToFoundDocument(x.version,w).setHasLocalMutations(),null})(s,e,t,o):s instanceof jo?(function(g,x,T,b){if(!md(g.precondition,x))return T;const w=Ax(g.fieldTransforms,b,x),C=x.data;return C.setAll(n_(g)),C.setAll(w),x.convertToFoundDocument(x.version,C).setHasLocalMutations(),T===null?null:T.unionWith(g.fieldMask.fields).unionWith(g.fieldTransforms.map((R=>R.field)))})(s,e,t,o):(function(g,x,T){return md(g.precondition,x)?(x.convertToNoDocument(x.version).setHasLocalMutations(),null):T})(s,e,t)}function HS(s,e){let t=null;for(const o of s.fieldTransforms){const u=e.data.field(o.field),g=Zw(o.transform,u||null);g!=null&&(t===null&&(t=Ki.empty()),t.set(o.field,g))}return t||null}function wx(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(o,u){return o===void 0&&u===void 0||!(!o||!u)&&hc(o,u,((g,x)=>FS(g,x)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Fu extends lf{constructor(e,t,o,u=[]){super(),this.key=e,this.value=t,this.precondition=o,this.fieldTransforms=u,this.type=0}getFieldMask(){return null}}class jo extends lf{constructor(e,t,o,u,g=[]){super(),this.key=e,this.data=t,this.fieldMask=o,this.precondition=u,this.fieldTransforms=g,this.type=1}getFieldMask(){return this.fieldMask}}function n_(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const o=s.data.field(t);e.set(t,o)}})),e}function _x(s,e,t){const o=new Map;qn(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let u=0;u<t.length;u++){const g=s[u],x=g.transform,T=e.data.field(g.field);o.set(g.field,VS(x,T,t[u]))}return o}function Ax(s,e,t){const o=new Map;for(const u of s){const g=u.transform,x=t.data.field(u.field);o.set(u.field,BS(g,x,e))}return o}class cf extends lf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GS extends lf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qS{constructor(e,t,o,u){this.batchId=e,this.localWriteTime=t,this.baseMutations=o,this.mutations=u}applyToRemoteDocument(e,t){const o=t.mutationResults;for(let u=0;u<this.mutations.length;u++){const g=this.mutations[u];g.key.isEqual(e.key)&&zS(g,e,o[u])}}applyToLocalView(e,t){for(const o of this.baseMutations)o.key.isEqual(e.key)&&(t=_u(o,e,t,this.localWriteTime));for(const o of this.mutations)o.key.isEqual(e.key)&&(t=_u(o,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const o=Ww();return this.mutations.forEach((u=>{const g=e.get(u.key),x=g.overlayedDocument;let T=this.applyToLocalView(x,g.mutatedFields);T=t.has(u.key)?null:T;const b=t_(x,T);b!==null&&o.set(u.key,b),x.isValidDocument()||x.convertToNoDocument(Wt.min())})),o}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),In())}isEqual(e){return this.batchId===e.batchId&&hc(this.mutations,e.mutations,((t,o)=>wx(t,o)))&&hc(this.baseMutations,e.baseMutations,((t,o)=>wx(t,o)))}}class Sg{constructor(e,t,o,u){this.batch=e,this.commitVersion=t,this.mutationResults=o,this.docVersions=u}static from(e,t,o){qn(e.mutations.length===o.length,58842,{me:e.mutations.length,fe:o.length});let u=(function(){return DS})();const g=e.mutations;for(let x=0;x<g.length;x++)u=u.insert(g[x].key,o[x].version);return new Sg(e,t,o,u)}}class XS{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class YS{constructor(e,t){this.count=e,this.unchangedNames=t}}var Hr,Mn;function KS(s){switch(s){case Le.OK:return qt(64938);case Le.CANCELLED:case Le.UNKNOWN:case Le.DEADLINE_EXCEEDED:case Le.RESOURCE_EXHAUSTED:case Le.INTERNAL:case Le.UNAVAILABLE:case Le.UNAUTHENTICATED:return!1;case Le.INVALID_ARGUMENT:case Le.NOT_FOUND:case Le.ALREADY_EXISTS:case Le.PERMISSION_DENIED:case Le.FAILED_PRECONDITION:case Le.ABORTED:case Le.OUT_OF_RANGE:case Le.UNIMPLEMENTED:case Le.DATA_LOSS:return!0;default:return qt(15467,{code:s})}}function r_(s){if(s===void 0)return Va("GRPC error has no .code"),Le.UNKNOWN;switch(s){case Hr.OK:return Le.OK;case Hr.CANCELLED:return Le.CANCELLED;case Hr.UNKNOWN:return Le.UNKNOWN;case Hr.DEADLINE_EXCEEDED:return Le.DEADLINE_EXCEEDED;case Hr.RESOURCE_EXHAUSTED:return Le.RESOURCE_EXHAUSTED;case Hr.INTERNAL:return Le.INTERNAL;case Hr.UNAVAILABLE:return Le.UNAVAILABLE;case Hr.UNAUTHENTICATED:return Le.UNAUTHENTICATED;case Hr.INVALID_ARGUMENT:return Le.INVALID_ARGUMENT;case Hr.NOT_FOUND:return Le.NOT_FOUND;case Hr.ALREADY_EXISTS:return Le.ALREADY_EXISTS;case Hr.PERMISSION_DENIED:return Le.PERMISSION_DENIED;case Hr.FAILED_PRECONDITION:return Le.FAILED_PRECONDITION;case Hr.ABORTED:return Le.ABORTED;case Hr.OUT_OF_RANGE:return Le.OUT_OF_RANGE;case Hr.UNIMPLEMENTED:return Le.UNIMPLEMENTED;case Hr.DATA_LOSS:return Le.DATA_LOSS;default:return qt(39323,{code:s})}}(Mn=Hr||(Hr={}))[Mn.OK=0]="OK",Mn[Mn.CANCELLED=1]="CANCELLED",Mn[Mn.UNKNOWN=2]="UNKNOWN",Mn[Mn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mn[Mn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mn[Mn.NOT_FOUND=5]="NOT_FOUND",Mn[Mn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mn[Mn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mn[Mn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mn[Mn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mn[Mn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mn[Mn.ABORTED=10]="ABORTED",Mn[Mn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mn[Mn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mn[Mn.INTERNAL=13]="INTERNAL",Mn[Mn.UNAVAILABLE=14]="UNAVAILABLE",Mn[Mn.DATA_LOSS=15]="DATA_LOSS";function WS(){return new TextEncoder}const QS=new Ro([4294967295,4294967295],0);function bx(s){const e=WS().encode(s),t=new xw;return t.update(e),new Uint8Array(t.digest())}function vx(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),o=e.getUint32(4,!0),u=e.getUint32(8,!0),g=e.getUint32(12,!0);return[new Ro([t,o],0),new Ro([u,g],0)]}class Ig{constructor(e,t,o){if(this.bitmap=e,this.padding=t,this.hashCount=o,t<0||t>=8)throw new fu(`Invalid padding: ${t}`);if(o<0)throw new fu(`Invalid hash count: ${o}`);if(e.length>0&&this.hashCount===0)throw new fu(`Invalid hash count: ${o}`);if(e.length===0&&t!==0)throw new fu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ro.fromNumber(this.ge)}ye(e,t,o){let u=e.add(t.multiply(Ro.fromNumber(o)));return u.compare(QS)===1&&(u=new Ro([u.getBits(0),u.getBits(1)],0)),u.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=bx(e),[o,u]=vx(t);for(let g=0;g<this.hashCount;g++){const x=this.ye(o,u,g);if(!this.we(x))return!1}return!0}static create(e,t,o){const u=e%8==0?0:8-e%8,g=new Uint8Array(Math.ceil(e/8)),x=new Ig(g,u,t);return o.forEach((T=>x.insert(T))),x}insert(e){if(this.ge===0)return;const t=bx(e),[o,u]=vx(t);for(let g=0;g<this.hashCount;g++){const x=this.ye(o,u,g);this.Se(x)}}Se(e){const t=Math.floor(e/8),o=e%8;this.bitmap[t]|=1<<o}}class fu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class uf{constructor(e,t,o,u,g){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=o,this.documentUpdates=u,this.resolvedLimboDocuments=g}static createSynthesizedRemoteEventForCurrentChange(e,t,o){const u=new Map;return u.set(e,ju.createSynthesizedTargetChangeForCurrentChange(e,t,o)),new uf(Wt.min(),u,new br(Sn),Ua(),In())}}class ju{constructor(e,t,o,u,g){this.resumeToken=e,this.current=t,this.addedDocuments=o,this.modifiedDocuments=u,this.removedDocuments=g}static createSynthesizedTargetChangeForCurrentChange(e,t,o){return new ju(o,t,In(),In(),In())}}class pd{constructor(e,t,o,u){this.be=e,this.removedTargetIds=t,this.key=o,this.De=u}}class i_{constructor(e,t){this.targetId=e,this.Ce=t}}class s_{constructor(e,t,o=di.EMPTY_BYTE_STRING,u=null){this.state=e,this.targetIds=t,this.resumeToken=o,this.cause=u}}class Tx{constructor(){this.ve=0,this.Fe=Cx(),this.Me=di.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=In(),t=In(),o=In();return this.Fe.forEach(((u,g)=>{switch(g){case 0:e=e.add(u);break;case 2:t=t.add(u);break;case 1:o=o.add(u);break;default:qt(38017,{changeType:g})}})),new ju(this.Me,this.xe,e,t,o)}qe(){this.Oe=!1,this.Fe=Cx()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,qn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class ZS{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ua(),this.Je=id(),this.He=id(),this.Ye=new br(Sn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const o=this.nt(t);switch(e.state){case 0:this.rt(t)&&o.Le(e.resumeToken);break;case 1:o.Ke(),o.Ne||o.qe(),o.Le(e.resumeToken);break;case 2:o.Ke(),o.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(o.We(),o.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),o.Le(e.resumeToken));break;default:qt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((o,u)=>{this.rt(u)&&t(u)}))}st(e){const t=e.targetId,o=e.Ce.count,u=this.ot(t);if(u){const g=u.target;if(z1(g))if(o===0){const x=new Mt(g.path);this.et(t,x,Ai.newNoDocument(x,Wt.min()))}else qn(o===1,20013,{expectedCount:o});else{const x=this._t(t);if(x!==o){const T=this.ut(e),b=T?this.ct(T,e,x):1;if(b!==0){this.it(t);const w=b===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,w)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:o="",padding:u=0},hashCount:g=0}=t;let x,T;try{x=ko(o).toUint8Array()}catch(b){if(b instanceof Nw)return uc("Decoding the base64 bloom filter in existence filter failed ("+b.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw b}try{T=new Ig(x,u,g)}catch(b){return uc(b instanceof fu?"BloomFilter error: ":"Applying bloom filter failed: ",b),null}return T.ge===0?null:T}ct(e,t,o){return t.Ce.count===o-this.Pt(e,t.targetId)?0:2}Pt(e,t){const o=this.Ge.getRemoteKeysForTarget(t);let u=0;return o.forEach((g=>{const x=this.Ge.ht(),T=`projects/${x.projectId}/databases/${x.database}/documents/${g.path.canonicalString()}`;e.mightContain(T)||(this.et(t,g,null),u++)})),u}Tt(e){const t=new Map;this.ze.forEach(((g,x)=>{const T=this.ot(x);if(T){if(g.current&&z1(T.target)){const b=new Mt(T.target.path);this.It(b).has(x)||this.Et(x,b)||this.et(x,b,Ai.newNoDocument(b,e))}g.Be&&(t.set(x,g.ke()),g.qe())}}));let o=In();this.He.forEach(((g,x)=>{let T=!0;x.forEachWhile((b=>{const w=this.ot(b);return!w||w.purpose==="TargetPurposeLimboResolution"||(T=!1,!1)})),T&&(o=o.add(g))})),this.je.forEach(((g,x)=>x.setReadTime(e)));const u=new uf(e,t,this.Ye,this.je,o);return this.je=Ua(),this.Je=id(),this.He=id(),this.Ye=new br(Sn),u}Xe(e,t){if(!this.rt(e))return;const o=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,o),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,o){if(!this.rt(e))return;const u=this.nt(e);this.Et(e,t)?u.Qe(t,1):u.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),o&&(this.je=this.je.insert(t,o))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Tx,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Qr(Sn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Qr(Sn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||yt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Tx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function id(){return new br(Mt.comparator)}function Cx(){return new br(Mt.comparator)}const JS={asc:"ASCENDING",desc:"DESCENDING"},$S={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eI={and:"AND",or:"OR"};class tI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function G1(s,e){return s.useProto3Json||tf(e)?e:{value:e}}function kd(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function a_(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function nI(s,e){return kd(s,e.toTimestamp())}function Zs(s){return qn(!!s,49232),Wt.fromTimestamp((function(t){const o=Mo(t);return new Vn(o.seconds,o.nanos)})(s))}function Rg(s,e){return q1(s,e).canonicalString()}function q1(s,e){const t=(function(u){return new ar(["projects",u.projectId,"databases",u.database])})(s).child("documents");return e===void 0?t:t.child(e)}function o_(s){const e=ar.fromString(s);return qn(d_(e),10190,{key:e.toString()}),e}function X1(s,e){return Rg(s.databaseId,e.path)}function w1(s,e){const t=o_(e);if(t.get(1)!==s.databaseId.projectId)throw new ct(Le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new ct(Le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Mt(c_(t))}function l_(s,e){return Rg(s.databaseId,e)}function rI(s){const e=o_(s);return e.length===4?ar.emptyPath():c_(e)}function Y1(s){return new ar(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function c_(s){return qn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Sx(s,e,t){return{name:X1(s,e),fields:t.value.mapValue.fields}}function iI(s,e){let t;if("targetChange"in e){e.targetChange;const o=(function(w){return w==="NO_CHANGE"?0:w==="ADD"?1:w==="REMOVE"?2:w==="CURRENT"?3:w==="RESET"?4:qt(39313,{state:w})})(e.targetChange.targetChangeType||"NO_CHANGE"),u=e.targetChange.targetIds||[],g=(function(w,C){return w.useProto3Json?(qn(C===void 0||typeof C=="string",58123),di.fromBase64String(C||"")):(qn(C===void 0||C instanceof Buffer||C instanceof Uint8Array,16193),di.fromUint8Array(C||new Uint8Array))})(s,e.targetChange.resumeToken),x=e.targetChange.cause,T=x&&(function(w){const C=w.code===void 0?Le.UNKNOWN:r_(w.code);return new ct(C,w.message||"")})(x);t=new s_(o,u,g,T||null)}else if("documentChange"in e){e.documentChange;const o=e.documentChange;o.document,o.document.name,o.document.updateTime;const u=w1(s,o.document.name),g=Zs(o.document.updateTime),x=o.document.createTime?Zs(o.document.createTime):Wt.min(),T=new Ki({mapValue:{fields:o.document.fields}}),b=Ai.newFoundDocument(u,g,x,T),w=o.targetIds||[],C=o.removedTargetIds||[];t=new pd(w,C,b.key,b)}else if("documentDelete"in e){e.documentDelete;const o=e.documentDelete;o.document;const u=w1(s,o.document),g=o.readTime?Zs(o.readTime):Wt.min(),x=Ai.newNoDocument(u,g),T=o.removedTargetIds||[];t=new pd([],T,x.key,x)}else if("documentRemove"in e){e.documentRemove;const o=e.documentRemove;o.document;const u=w1(s,o.document),g=o.removedTargetIds||[];t=new pd([],g,u,null)}else{if(!("filter"in e))return qt(11601,{Rt:e});{e.filter;const o=e.filter;o.targetId;const{count:u=0,unchangedNames:g}=o,x=new YS(u,g),T=o.targetId;t=new i_(T,x)}}return t}function sI(s,e){let t;if(e instanceof Fu)t={update:Sx(s,e.key,e.value)};else if(e instanceof cf)t={delete:X1(s,e.key)};else if(e instanceof jo)t={update:Sx(s,e.key,e.data),updateMask:gI(e.fieldMask)};else{if(!(e instanceof GS))return qt(16599,{Vt:e.type});t={verify:X1(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((o=>(function(g,x){const T=x.transform;if(T instanceof Nu)return{fieldPath:x.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(T instanceof Ou)return{fieldPath:x.field.canonicalString(),appendMissingElements:{values:T.elements}};if(T instanceof Du)return{fieldPath:x.field.canonicalString(),removeAllFromArray:{values:T.elements}};if(T instanceof Md)return{fieldPath:x.field.canonicalString(),increment:T.Ae};throw qt(20930,{transform:x.transform})})(0,o)))),e.precondition.isNone||(t.currentDocument=(function(u,g){return g.updateTime!==void 0?{updateTime:nI(u,g.updateTime)}:g.exists!==void 0?{exists:g.exists}:qt(27497)})(s,e.precondition)),t}function aI(s,e){return s&&s.length>0?(qn(e!==void 0,14353),s.map((t=>(function(u,g){let x=u.updateTime?Zs(u.updateTime):Zs(g);return x.isEqual(Wt.min())&&(x=Zs(g)),new jS(x,u.transformResults||[])})(t,e)))):[]}function oI(s,e){return{documents:[l_(s,e.path)]}}function lI(s,e){const t={structuredQuery:{}},o=e.path;let u;e.collectionGroup!==null?(u=o,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(u=o.popLast(),t.structuredQuery.from=[{collectionId:o.lastSegment()}]),t.parent=l_(s,u);const g=(function(w){if(w.length!==0)return h_(Ls.create(w,"and"))})(e.filters);g&&(t.structuredQuery.where=g);const x=(function(w){if(w.length!==0)return w.map((C=>(function(P){return{field:$l(P.field),direction:hI(P.dir)}})(C)))})(e.orderBy);x&&(t.structuredQuery.orderBy=x);const T=G1(s,e.limit);return T!==null&&(t.structuredQuery.limit=T),e.startAt&&(t.structuredQuery.startAt=(function(w){return{before:w.inclusive,values:w.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(w){return{before:!w.inclusive,values:w.position}})(e.endAt)),{ft:t,parent:u}}function cI(s){let e=rI(s.parent);const t=s.structuredQuery,o=t.from?t.from.length:0;let u=null;if(o>0){qn(o===1,65062);const C=t.from[0];C.allDescendants?u=C.collectionId:e=e.child(C.collectionId)}let g=[];t.where&&(g=(function(R){const P=u_(R);return P instanceof Ls&&Fw(P)?P.getFilters():[P]})(t.where));let x=[];t.orderBy&&(x=(function(R){return R.map((P=>(function(ee){return new Ru(ec(ee.field),(function(se){switch(se){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(ee.direction))})(P)))})(t.orderBy));let T=null;t.limit&&(T=(function(R){let P;return P=typeof R=="object"?R.value:R,tf(P)?null:P})(t.limit));let b=null;t.startAt&&(b=(function(R){const P=!!R.before,L=R.values||[];return new Od(L,P)})(t.startAt));let w=null;return t.endAt&&(w=(function(R){const P=!R.before,L=R.values||[];return new Od(L,P)})(t.endAt)),SS(e,u,x,g,T,"F",b,w)}function uI(s,e){const t=(function(u){switch(u){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return qt(28987,{purpose:u})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function u_(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const o=ec(t.unaryFilter.field);return Gr.create(o,"==",{doubleValue:NaN});case"IS_NULL":const u=ec(t.unaryFilter.field);return Gr.create(u,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const g=ec(t.unaryFilter.field);return Gr.create(g,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const x=ec(t.unaryFilter.field);return Gr.create(x,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return qt(61313);default:return qt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return Gr.create(ec(t.fieldFilter.field),(function(u){switch(u){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return qt(58110);default:return qt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return Ls.create(t.compositeFilter.filters.map((o=>u_(o))),(function(u){switch(u){case"AND":return"and";case"OR":return"or";default:return qt(1026)}})(t.compositeFilter.op))})(s):qt(30097,{filter:s})}function hI(s){return JS[s]}function dI(s){return $S[s]}function fI(s){return eI[s]}function $l(s){return{fieldPath:s.canonicalString()}}function ec(s){return hi.fromServerFormat(s.fieldPath)}function h_(s){return s instanceof Gr?(function(t){if(t.op==="=="){if(gx(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NAN"}};if(fx(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(gx(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NOT_NAN"}};if(fx(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$l(t.field),op:dI(t.op),value:t.value}}})(s):s instanceof Ls?(function(t){const o=t.getFilters().map((u=>h_(u)));return o.length===1?o[0]:{compositeFilter:{op:fI(t.op),filters:o}}})(s):qt(54877,{filter:s})}function gI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function d_(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}class To{constructor(e,t,o,u,g=Wt.min(),x=Wt.min(),T=di.EMPTY_BYTE_STRING,b=null){this.target=e,this.targetId=t,this.purpose=o,this.sequenceNumber=u,this.snapshotVersion=g,this.lastLimboFreeSnapshotVersion=x,this.resumeToken=T,this.expectedCount=b}withSequenceNumber(e){return new To(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new To(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new To(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new To(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class mI{constructor(e){this.yt=e}}function pI(s){const e=cI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Dd(e,e.limit,"L"):e}class yI{constructor(){this.Cn=new xI}addToCollectionParentIndex(e,t){return this.Cn.add(t),je.resolve()}getCollectionParents(e,t){return je.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return je.resolve()}deleteFieldIndex(e,t){return je.resolve()}deleteAllFieldIndexes(e){return je.resolve()}createTargetIndexes(e,t){return je.resolve()}getDocumentsMatchingTarget(e,t){return je.resolve(null)}getIndexType(e,t){return je.resolve(0)}getFieldIndexes(e,t){return je.resolve([])}getNextCollectionGroupToUpdate(e){return je.resolve(null)}getMinOffset(e,t){return je.resolve(Do.min())}getMinOffsetFromCollectionGroup(e,t){return je.resolve(Do.min())}updateCollectionGroup(e,t,o){return je.resolve()}updateIndexEntries(e,t){return je.resolve()}}class xI{constructor(){this.index={}}add(e){const t=e.lastSegment(),o=e.popLast(),u=this.index[t]||new Qr(ar.comparator),g=!u.has(o);return this.index[t]=u.add(o),g}has(e){const t=e.lastSegment(),o=e.popLast(),u=this.index[t];return u&&u.has(o)}getEntries(e){return(this.index[e]||new Qr(ar.comparator)).toArray()}}const Ix={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},f_=41943040;class Yi{static withCacheSize(e){return new Yi(e,Yi.DEFAULT_COLLECTION_PERCENTILE,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,o){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=o}}Yi.DEFAULT_COLLECTION_PERCENTILE=10,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yi.DEFAULT=new Yi(f_,Yi.DEFAULT_COLLECTION_PERCENTILE,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yi.DISABLED=new Yi(-1,0,0);class gc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new gc(0)}static cr(){return new gc(-1)}}const Rx="LruGarbageCollector",EI=1048576;function Nx([s,e],[t,o]){const u=Sn(s,t);return u===0?Sn(e,o):u}class wI{constructor(e){this.Ir=e,this.buffer=new Qr(Nx),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const o=this.buffer.last();Nx(t,o)<0&&(this.buffer=this.buffer.delete(o).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _I{constructor(e,t,o){this.garbageCollector=e,this.asyncQueue=t,this.localStore=o,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){yt(Rx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){wc(t)?yt(Rx,"Ignoring IndexedDB error during garbage collection: ",t):await Ec(t)}await this.Vr(3e5)}))}}class AI{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((o=>Math.floor(t/100*o)))}nthSequenceNumber(e,t){if(t===0)return je.resolve(ef.ce);const o=new wI(t);return this.mr.forEachTarget(e,(u=>o.Ar(u.sequenceNumber))).next((()=>this.mr.pr(e,(u=>o.Ar(u))))).next((()=>o.maxValue))}removeTargets(e,t,o){return this.mr.removeTargets(e,t,o)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(yt("LruGarbageCollector","Garbage collection skipped; disabled"),je.resolve(Ix)):this.getCacheSize(e).next((o=>o<this.params.cacheSizeCollectionThreshold?(yt("LruGarbageCollector",`Garbage collection skipped; Cache size ${o} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ix):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let o,u,g,x,T,b,w;const C=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((R=>(R>this.params.maximumSequenceNumbersToCollect?(yt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${R}`),u=this.params.maximumSequenceNumbersToCollect):u=R,x=Date.now(),this.nthSequenceNumber(e,u)))).next((R=>(o=R,T=Date.now(),this.removeTargets(e,o,t)))).next((R=>(g=R,b=Date.now(),this.removeOrphanedDocuments(e,o)))).next((R=>(w=Date.now(),Zl()<=Tn.DEBUG&&yt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${x-C}ms
	Determined least recently used ${u} in `+(T-x)+`ms
	Removed ${g} targets in `+(b-T)+`ms
	Removed ${R} documents in `+(w-b)+`ms
Total Duration: ${w-C}ms`),je.resolve({didRun:!0,sequenceNumbersCollected:u,targetsRemoved:g,documentsRemoved:R}))))}}function bI(s,e){return new AI(s,e)}class vI{constructor(){this.changes=new wl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ai.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const o=this.changes.get(t);return o!==void 0?je.resolve(o):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class TI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class CI{constructor(e,t,o,u){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=o,this.indexManager=u}getDocument(e,t){let o=null;return this.documentOverlayCache.getOverlay(e,t).next((u=>(o=u,this.remoteDocumentCache.getEntry(e,t)))).next((u=>(o!==null&&_u(o.mutation,u,us.empty(),Vn.now()),u)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((o=>this.getLocalViewOfDocuments(e,o,In()).next((()=>o))))}getLocalViewOfDocuments(e,t,o=In()){const u=ll();return this.populateOverlays(e,u,t).next((()=>this.computeViews(e,t,u,o).next((g=>{let x=du();return g.forEach(((T,b)=>{x=x.insert(T,b.overlayedDocument)})),x}))))}getOverlayedDocuments(e,t){const o=ll();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,In())))}populateOverlays(e,t,o){const u=[];return o.forEach((g=>{t.has(g)||u.push(g)})),this.documentOverlayCache.getOverlays(e,u).next((g=>{g.forEach(((x,T)=>{t.set(x,T)}))}))}computeViews(e,t,o,u){let g=Ua();const x=wu(),T=(function(){return wu()})();return t.forEach(((b,w)=>{const C=o.get(w.key);u.has(w.key)&&(C===void 0||C.mutation instanceof jo)?g=g.insert(w.key,w):C!==void 0?(x.set(w.key,C.mutation.getFieldMask()),_u(C.mutation,w,C.mutation.getFieldMask(),Vn.now())):x.set(w.key,us.empty())})),this.recalculateAndSaveOverlays(e,g).next((b=>(b.forEach(((w,C)=>x.set(w,C))),t.forEach(((w,C)=>T.set(w,new TI(C,x.get(w)??null)))),T)))}recalculateAndSaveOverlays(e,t){const o=wu();let u=new br(((x,T)=>x-T)),g=In();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((x=>{for(const T of x)T.keys().forEach((b=>{const w=t.get(b);if(w===null)return;let C=o.get(b)||us.empty();C=T.applyToLocalView(w,C),o.set(b,C);const R=(u.get(T.batchId)||In()).add(b);u=u.insert(T.batchId,R)}))})).next((()=>{const x=[],T=u.getReverseIterator();for(;T.hasNext();){const b=T.getNext(),w=b.key,C=b.value,R=Ww();C.forEach((P=>{if(!g.has(P)){const L=t_(t.get(P),o.get(P));L!==null&&R.set(P,L),g=g.add(P)}})),x.push(this.documentOverlayCache.saveOverlays(e,w,R))}return je.waitFor(x)})).next((()=>o))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((o=>this.recalculateAndSaveOverlays(e,o)))}getDocumentsMatchingQuery(e,t,o,u){return(function(x){return Mt.isDocumentKey(x.path)&&x.collectionGroup===null&&x.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Gw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,o,u):this.getDocumentsMatchingCollectionQuery(e,t,o,u)}getNextDocuments(e,t,o,u){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,o,u).next((g=>{const x=u-g.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,o.largestBatchId,u-g.size):je.resolve(ll());let T=Tu,b=g;return x.next((w=>je.forEach(w,((C,R)=>(T<R.largestBatchId&&(T=R.largestBatchId),g.get(C)?je.resolve():this.remoteDocumentCache.getEntry(e,C).next((P=>{b=b.insert(C,P)}))))).next((()=>this.populateOverlays(e,w,g))).next((()=>this.computeViews(e,b,w,In()))).next((C=>({batchId:T,changes:Kw(C)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Mt(t)).next((o=>{let u=du();return o.isFoundDocument()&&(u=u.insert(o.key,o)),u}))}getDocumentsMatchingCollectionGroupQuery(e,t,o,u){const g=t.collectionGroup;let x=du();return this.indexManager.getCollectionParents(e,g).next((T=>je.forEach(T,(b=>{const w=(function(R,P){return new _c(P,null,R.explicitOrderBy.slice(),R.filters.slice(),R.limit,R.limitType,R.startAt,R.endAt)})(t,b.child(g));return this.getDocumentsMatchingCollectionQuery(e,w,o,u).next((C=>{C.forEach(((R,P)=>{x=x.insert(R,P)}))}))})).next((()=>x))))}getDocumentsMatchingCollectionQuery(e,t,o,u){let g;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,o.largestBatchId).next((x=>(g=x,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,o,g,u)))).next((x=>{g.forEach(((b,w)=>{const C=w.getKey();x.get(C)===null&&(x=x.insert(C,Ai.newInvalidDocument(C)))}));let T=du();return x.forEach(((b,w)=>{const C=g.get(b);C!==void 0&&_u(C.mutation,w,us.empty(),Vn.now()),af(t,w)&&(T=T.insert(b,w))})),T}))}}class SI{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return je.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(u){return{id:u.id,version:u.version,createTime:Zs(u.createTime)}})(t)),je.resolve()}getNamedQuery(e,t){return je.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(u){return{name:u.name,query:pI(u.bundledQuery),readTime:Zs(u.readTime)}})(t)),je.resolve()}}class II{constructor(){this.overlays=new br(Mt.comparator),this.qr=new Map}getOverlay(e,t){return je.resolve(this.overlays.get(t))}getOverlays(e,t){const o=ll();return je.forEach(t,(u=>this.getOverlay(e,u).next((g=>{g!==null&&o.set(u,g)})))).next((()=>o))}saveOverlays(e,t,o){return o.forEach(((u,g)=>{this.St(e,t,g)})),je.resolve()}removeOverlaysForBatchId(e,t,o){const u=this.qr.get(o);return u!==void 0&&(u.forEach((g=>this.overlays=this.overlays.remove(g))),this.qr.delete(o)),je.resolve()}getOverlaysForCollection(e,t,o){const u=ll(),g=t.length+1,x=new Mt(t.child("")),T=this.overlays.getIteratorFrom(x);for(;T.hasNext();){const b=T.getNext().value,w=b.getKey();if(!t.isPrefixOf(w.path))break;w.path.length===g&&b.largestBatchId>o&&u.set(b.getKey(),b)}return je.resolve(u)}getOverlaysForCollectionGroup(e,t,o,u){let g=new br(((w,C)=>w-C));const x=this.overlays.getIterator();for(;x.hasNext();){const w=x.getNext().value;if(w.getKey().getCollectionGroup()===t&&w.largestBatchId>o){let C=g.get(w.largestBatchId);C===null&&(C=ll(),g=g.insert(w.largestBatchId,C)),C.set(w.getKey(),w)}}const T=ll(),b=g.getIterator();for(;b.hasNext()&&(b.getNext().value.forEach(((w,C)=>T.set(w,C))),!(T.size()>=u)););return je.resolve(T)}St(e,t,o){const u=this.overlays.get(o.key);if(u!==null){const x=this.qr.get(u.largestBatchId).delete(o.key);this.qr.set(u.largestBatchId,x)}this.overlays=this.overlays.insert(o.key,new XS(t,o));let g=this.qr.get(t);g===void 0&&(g=In(),this.qr.set(t,g)),this.qr.set(t,g.add(o.key))}}class RI{constructor(){this.sessionToken=di.EMPTY_BYTE_STRING}getSessionToken(e){return je.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,je.resolve()}}class Ng{constructor(){this.Qr=new Qr(ni.$r),this.Ur=new Qr(ni.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const o=new ni(e,t);this.Qr=this.Qr.add(o),this.Ur=this.Ur.add(o)}Wr(e,t){e.forEach((o=>this.addReference(o,t)))}removeReference(e,t){this.Gr(new ni(e,t))}zr(e,t){e.forEach((o=>this.removeReference(o,t)))}jr(e){const t=new Mt(new ar([])),o=new ni(t,e),u=new ni(t,e+1),g=[];return this.Ur.forEachInRange([o,u],(x=>{this.Gr(x),g.push(x.key)})),g}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Mt(new ar([])),o=new ni(t,e),u=new ni(t,e+1);let g=In();return this.Ur.forEachInRange([o,u],(x=>{g=g.add(x.key)})),g}containsKey(e){const t=new ni(e,0),o=this.Qr.firstAfterOrEqual(t);return o!==null&&e.isEqual(o.key)}}class ni{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Mt.comparator(e.key,t.key)||Sn(e.Yr,t.Yr)}static Kr(e,t){return Sn(e.Yr,t.Yr)||Mt.comparator(e.key,t.key)}}class NI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Qr(ni.$r)}checkEmpty(e){return je.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,o,u){const g=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const x=new qS(g,t,o,u);this.mutationQueue.push(x);for(const T of u)this.Zr=this.Zr.add(new ni(T.key,g)),this.indexManager.addToCollectionParentIndex(e,T.key.path.popLast());return je.resolve(x)}lookupMutationBatch(e,t){return je.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const o=t+1,u=this.ei(o),g=u<0?0:u;return je.resolve(this.mutationQueue.length>g?this.mutationQueue[g]:null)}getHighestUnacknowledgedBatchId(){return je.resolve(this.mutationQueue.length===0?_g:this.tr-1)}getAllMutationBatches(e){return je.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const o=new ni(t,0),u=new ni(t,Number.POSITIVE_INFINITY),g=[];return this.Zr.forEachInRange([o,u],(x=>{const T=this.Xr(x.Yr);g.push(T)})),je.resolve(g)}getAllMutationBatchesAffectingDocumentKeys(e,t){let o=new Qr(Sn);return t.forEach((u=>{const g=new ni(u,0),x=new ni(u,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([g,x],(T=>{o=o.add(T.Yr)}))})),je.resolve(this.ti(o))}getAllMutationBatchesAffectingQuery(e,t){const o=t.path,u=o.length+1;let g=o;Mt.isDocumentKey(g)||(g=g.child(""));const x=new ni(new Mt(g),0);let T=new Qr(Sn);return this.Zr.forEachWhile((b=>{const w=b.key.path;return!!o.isPrefixOf(w)&&(w.length===u&&(T=T.add(b.Yr)),!0)}),x),je.resolve(this.ti(T))}ti(e){const t=[];return e.forEach((o=>{const u=this.Xr(o);u!==null&&t.push(u)})),t}removeMutationBatch(e,t){qn(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let o=this.Zr;return je.forEach(t.mutations,(u=>{const g=new ni(u.key,t.batchId);return o=o.delete(g),this.referenceDelegate.markPotentiallyOrphaned(e,u.key)})).next((()=>{this.Zr=o}))}ir(e){}containsKey(e,t){const o=new ni(t,0),u=this.Zr.firstAfterOrEqual(o);return je.resolve(t.isEqual(u&&u.key))}performConsistencyCheck(e){return this.mutationQueue.length,je.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class OI{constructor(e){this.ri=e,this.docs=(function(){return new br(Mt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const o=t.key,u=this.docs.get(o),g=u?u.size:0,x=this.ri(t);return this.docs=this.docs.insert(o,{document:t.mutableCopy(),size:x}),this.size+=x-g,this.indexManager.addToCollectionParentIndex(e,o.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const o=this.docs.get(t);return je.resolve(o?o.document.mutableCopy():Ai.newInvalidDocument(t))}getEntries(e,t){let o=Ua();return t.forEach((u=>{const g=this.docs.get(u);o=o.insert(u,g?g.document.mutableCopy():Ai.newInvalidDocument(u))})),je.resolve(o)}getDocumentsMatchingQuery(e,t,o,u){let g=Ua();const x=t.path,T=new Mt(x.child("__id-9223372036854775808__")),b=this.docs.getIteratorFrom(T);for(;b.hasNext();){const{key:w,value:{document:C}}=b.getNext();if(!x.isPrefixOf(w.path))break;w.path.length>x.length+1||sS(iS(C),o)<=0||(u.has(C.key)||af(t,C))&&(g=g.insert(C.key,C.mutableCopy()))}return je.resolve(g)}getAllFromCollectionGroup(e,t,o,u){qt(9500)}ii(e,t){return je.forEach(this.docs,(o=>t(o)))}newChangeBuffer(e){return new DI(this)}getSize(e){return je.resolve(this.size)}}class DI extends vI{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((o,u)=>{u.isValidDocument()?t.push(this.Nr.addEntry(e,u)):this.Nr.removeEntry(o)})),je.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class MI{constructor(e){this.persistence=e,this.si=new wl((t=>vg(t)),Tg),this.lastRemoteSnapshotVersion=Wt.min(),this.highestTargetId=0,this.oi=0,this._i=new Ng,this.targetCount=0,this.ai=gc.ur()}forEachTarget(e,t){return this.si.forEach(((o,u)=>t(u))),je.resolve()}getLastRemoteSnapshotVersion(e){return je.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return je.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),je.resolve(this.highestTargetId)}setTargetsMetadata(e,t,o){return o&&(this.lastRemoteSnapshotVersion=o),t>this.oi&&(this.oi=t),je.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new gc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,je.resolve()}updateTargetData(e,t){return this.Pr(t),je.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,je.resolve()}removeTargets(e,t,o){let u=0;const g=[];return this.si.forEach(((x,T)=>{T.sequenceNumber<=t&&o.get(T.targetId)===null&&(this.si.delete(x),g.push(this.removeMatchingKeysForTargetId(e,T.targetId)),u++)})),je.waitFor(g).next((()=>u))}getTargetCount(e){return je.resolve(this.targetCount)}getTargetData(e,t){const o=this.si.get(t)||null;return je.resolve(o)}addMatchingKeys(e,t,o){return this._i.Wr(t,o),je.resolve()}removeMatchingKeys(e,t,o){this._i.zr(t,o);const u=this.persistence.referenceDelegate,g=[];return u&&t.forEach((x=>{g.push(u.markPotentiallyOrphaned(e,x))})),je.waitFor(g)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),je.resolve()}getMatchingKeysForTargetId(e,t){const o=this._i.Hr(t);return je.resolve(o)}containsKey(e,t){return je.resolve(this._i.containsKey(t))}}class g_{constructor(e,t){this.ui={},this.overlays={},this.ci=new ef(0),this.li=!1,this.li=!0,this.hi=new RI,this.referenceDelegate=e(this),this.Pi=new MI(this),this.indexManager=new yI,this.remoteDocumentCache=(function(u){return new OI(u)})((o=>this.referenceDelegate.Ti(o))),this.serializer=new mI(t),this.Ii=new SI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new II,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let o=this.ui[e.toKey()];return o||(o=new NI(t,this.referenceDelegate),this.ui[e.toKey()]=o),o}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,o){yt("MemoryPersistence","Starting transaction:",e);const u=new kI(this.ci.next());return this.referenceDelegate.Ei(),o(u).next((g=>this.referenceDelegate.di(u).next((()=>g)))).toPromise().then((g=>(u.raiseOnCommittedEvent(),g)))}Ai(e,t){return je.or(Object.values(this.ui).map((o=>()=>o.containsKey(e,t))))}}class kI extends oS{constructor(e){super(),this.currentSequenceNumber=e}}class Og{constructor(e){this.persistence=e,this.Ri=new Ng,this.Vi=null}static mi(e){return new Og(e)}get fi(){if(this.Vi)return this.Vi;throw qt(60996)}addReference(e,t,o){return this.Ri.addReference(o,t),this.fi.delete(o.toString()),je.resolve()}removeReference(e,t,o){return this.Ri.removeReference(o,t),this.fi.add(o.toString()),je.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),je.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((u=>this.fi.add(u.toString())));const o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(e,t.targetId).next((u=>{u.forEach((g=>this.fi.add(g.toString())))})).next((()=>o.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return je.forEach(this.fi,(o=>{const u=Mt.fromPath(o);return this.gi(e,u).next((g=>{g||t.removeEntry(u,Wt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((o=>{o?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return je.or([()=>je.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ld{constructor(e,t){this.persistence=e,this.pi=new wl((o=>uS(o.path)),((o,u)=>o.isEqual(u))),this.garbageCollector=bI(this,t)}static mi(e,t){return new Ld(e,t)}Ei(){}di(e){return je.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((o=>t.next((u=>o+u))))}wr(e){let t=0;return this.pr(e,(o=>{t++})).next((()=>t))}pr(e,t){return je.forEach(this.pi,((o,u)=>this.br(e,o,u).next((g=>g?je.resolve():t(u)))))}removeTargets(e,t,o){return this.persistence.getTargetCache().removeTargets(e,t,o)}removeOrphanedDocuments(e,t){let o=0;const u=this.persistence.getRemoteDocumentCache(),g=u.newChangeBuffer();return u.ii(e,(x=>this.br(e,x,t).next((T=>{T||(o++,g.removeEntry(x,Wt.min()))})))).next((()=>g.apply(e))).next((()=>o))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}removeTarget(e,t){const o=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,o)}addReference(e,t,o){return this.pi.set(o,e.currentSequenceNumber),je.resolve()}removeReference(e,t,o){return this.pi.set(o,e.currentSequenceNumber),je.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=fd(e.data.value)),t}br(e,t,o){return je.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const u=this.pi.get(t);return je.resolve(u!==void 0&&u>o)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Dg{constructor(e,t,o,u){this.targetId=e,this.fromCache=t,this.Es=o,this.ds=u}static As(e,t){let o=In(),u=In();for(const g of t.docChanges)switch(g.type){case 0:o=o.add(g.doc.key);break;case 1:u=u.add(g.doc.key)}return new Dg(e,t.fromCache,o,u)}}class LI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class PI{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return av()?8:lS(vi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,o,u){const g={result:null};return this.ys(e,t).next((x=>{g.result=x})).next((()=>{if(!g.result)return this.ws(e,t,u,o).next((x=>{g.result=x}))})).next((()=>{if(g.result)return;const x=new LI;return this.Ss(e,t,x).next((T=>{if(g.result=T,this.Vs)return this.bs(e,t,x,T.size)}))})).next((()=>g.result))}bs(e,t,o,u){return o.documentReadCount<this.fs?(Zl()<=Tn.DEBUG&&yt("QueryEngine","SDK will not create cache indexes for query:",Jl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),je.resolve()):(Zl()<=Tn.DEBUG&&yt("QueryEngine","Query:",Jl(t),"scans",o.documentReadCount,"local documents and returns",u,"documents as results."),o.documentReadCount>this.gs*u?(Zl()<=Tn.DEBUG&&yt("QueryEngine","The SDK decides to create cache indexes for query:",Jl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qs(t))):je.resolve())}ys(e,t){if(xx(t))return je.resolve(null);let o=Qs(t);return this.indexManager.getIndexType(e,o).next((u=>u===0?null:(t.limit!==null&&u===1&&(t=Dd(t,null,"F"),o=Qs(t)),this.indexManager.getDocumentsMatchingTarget(e,o).next((g=>{const x=In(...g);return this.ps.getDocuments(e,x).next((T=>this.indexManager.getMinOffset(e,o).next((b=>{const w=this.Ds(t,T);return this.Cs(t,w,x,b.readTime)?this.ys(e,Dd(t,null,"F")):this.vs(e,w,t,b)}))))})))))}ws(e,t,o,u){return xx(t)||u.isEqual(Wt.min())?je.resolve(null):this.ps.getDocuments(e,o).next((g=>{const x=this.Ds(t,g);return this.Cs(t,x,o,u)?je.resolve(null):(Zl()<=Tn.DEBUG&&yt("QueryEngine","Re-using previous result from %s to execute query: %s",u.toString(),Jl(t)),this.vs(e,x,t,rS(u,Tu)).next((T=>T)))}))}Ds(e,t){let o=new Qr(Xw(e));return t.forEach(((u,g)=>{af(e,g)&&(o=o.add(g))})),o}Cs(e,t,o,u){if(e.limit===null)return!1;if(o.size!==t.size)return!0;const g=e.limitType==="F"?t.last():t.first();return!!g&&(g.hasPendingWrites||g.version.compareTo(u)>0)}Ss(e,t,o){return Zl()<=Tn.DEBUG&&yt("QueryEngine","Using full collection scan to execute query:",Jl(t)),this.ps.getDocumentsMatchingQuery(e,t,Do.min(),o)}vs(e,t,o,u){return this.ps.getDocumentsMatchingQuery(e,o,u).next((g=>(t.forEach((x=>{g=g.insert(x.key,x)})),g)))}}const Mg="LocalStore",BI=3e8;class VI{constructor(e,t,o,u){this.persistence=e,this.Fs=t,this.serializer=u,this.Ms=new br(Sn),this.xs=new wl((g=>vg(g)),Tg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(o)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function UI(s,e,t,o){return new VI(s,e,t,o)}async function m_(s,e){const t=$t(s);return await t.persistence.runTransaction("Handle user change","readonly",(o=>{let u;return t.mutationQueue.getAllMutationBatches(o).next((g=>(u=g,t.Bs(e),t.mutationQueue.getAllMutationBatches(o)))).next((g=>{const x=[],T=[];let b=In();for(const w of u){x.push(w.batchId);for(const C of w.mutations)b=b.add(C.key)}for(const w of g){T.push(w.batchId);for(const C of w.mutations)b=b.add(C.key)}return t.localDocuments.getDocuments(o,b).next((w=>({Ls:w,removedBatchIds:x,addedBatchIds:T})))}))}))}function FI(s,e){const t=$t(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(o=>{const u=e.batch.keys(),g=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(T,b,w,C){const R=w.batch,P=R.keys();let L=je.resolve();return P.forEach((ee=>{L=L.next((()=>C.getEntry(b,ee))).next((re=>{const se=w.docVersions.get(ee);qn(se!==null,48541),re.version.compareTo(se)<0&&(R.applyToRemoteDocument(re,w),re.isValidDocument()&&(re.setReadTime(w.commitVersion),C.addEntry(re)))}))})),L.next((()=>T.mutationQueue.removeMutationBatch(b,R)))})(t,o,e,g).next((()=>g.apply(o))).next((()=>t.mutationQueue.performConsistencyCheck(o))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(o,u,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(o,(function(T){let b=In();for(let w=0;w<T.mutationResults.length;++w)T.mutationResults[w].transformResults.length>0&&(b=b.add(T.batch.mutations[w].key));return b})(e)))).next((()=>t.localDocuments.getDocuments(o,u)))}))}function p_(s){const e=$t(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function jI(s,e){const t=$t(s),o=e.snapshotVersion;let u=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(g=>{const x=t.Ns.newChangeBuffer({trackRemovals:!0});u=t.Ms;const T=[];e.targetChanges.forEach(((C,R)=>{const P=u.get(R);if(!P)return;T.push(t.Pi.removeMatchingKeys(g,C.removedDocuments,R).next((()=>t.Pi.addMatchingKeys(g,C.addedDocuments,R))));let L=P.withSequenceNumber(g.currentSequenceNumber);e.targetMismatches.get(R)!==null?L=L.withResumeToken(di.EMPTY_BYTE_STRING,Wt.min()).withLastLimboFreeSnapshotVersion(Wt.min()):C.resumeToken.approximateByteSize()>0&&(L=L.withResumeToken(C.resumeToken,o)),u=u.insert(R,L),(function(re,se,Ye){return re.resumeToken.approximateByteSize()===0||se.snapshotVersion.toMicroseconds()-re.snapshotVersion.toMicroseconds()>=BI?!0:Ye.addedDocuments.size+Ye.modifiedDocuments.size+Ye.removedDocuments.size>0})(P,L,C)&&T.push(t.Pi.updateTargetData(g,L))}));let b=Ua(),w=In();if(e.documentUpdates.forEach((C=>{e.resolvedLimboDocuments.has(C)&&T.push(t.persistence.referenceDelegate.updateLimboDocument(g,C))})),T.push(zI(g,x,e.documentUpdates).next((C=>{b=C.ks,w=C.qs}))),!o.isEqual(Wt.min())){const C=t.Pi.getLastRemoteSnapshotVersion(g).next((R=>t.Pi.setTargetsMetadata(g,g.currentSequenceNumber,o)));T.push(C)}return je.waitFor(T).next((()=>x.apply(g))).next((()=>t.localDocuments.getLocalViewOfDocuments(g,b,w))).next((()=>b))})).then((g=>(t.Ms=u,g)))}function zI(s,e,t){let o=In(),u=In();return t.forEach((g=>o=o.add(g))),e.getEntries(s,o).next((g=>{let x=Ua();return t.forEach(((T,b)=>{const w=g.get(T);b.isFoundDocument()!==w.isFoundDocument()&&(u=u.add(T)),b.isNoDocument()&&b.version.isEqual(Wt.min())?(e.removeEntry(T,b.readTime),x=x.insert(T,b)):!w.isValidDocument()||b.version.compareTo(w.version)>0||b.version.compareTo(w.version)===0&&w.hasPendingWrites?(e.addEntry(b),x=x.insert(T,b)):yt(Mg,"Ignoring outdated watch update for ",T,". Current version:",w.version," Watch version:",b.version)})),{ks:x,qs:u}}))}function HI(s,e){const t=$t(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(o=>(e===void 0&&(e=_g),t.mutationQueue.getNextMutationBatchAfterBatchId(o,e))))}function GI(s,e){const t=$t(s);return t.persistence.runTransaction("Allocate target","readwrite",(o=>{let u;return t.Pi.getTargetData(o,e).next((g=>g?(u=g,je.resolve(u)):t.Pi.allocateTargetId(o).next((x=>(u=new To(e,x,"TargetPurposeListen",o.currentSequenceNumber),t.Pi.addTargetData(o,u).next((()=>u)))))))})).then((o=>{const u=t.Ms.get(o.targetId);return(u===null||o.snapshotVersion.compareTo(u.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(o.targetId,o),t.xs.set(e,o.targetId)),o}))}async function K1(s,e,t){const o=$t(s),u=o.Ms.get(e),g=t?"readwrite":"readwrite-primary";try{t||await o.persistence.runTransaction("Release target",g,(x=>o.persistence.referenceDelegate.removeTarget(x,u)))}catch(x){if(!wc(x))throw x;yt(Mg,`Failed to update sequence numbers for target ${e}: ${x}`)}o.Ms=o.Ms.remove(e),o.xs.delete(u.target)}function Ox(s,e,t){const o=$t(s);let u=Wt.min(),g=In();return o.persistence.runTransaction("Execute query","readwrite",(x=>(function(b,w,C){const R=$t(b),P=R.xs.get(C);return P!==void 0?je.resolve(R.Ms.get(P)):R.Pi.getTargetData(w,C)})(o,x,Qs(e)).next((T=>{if(T)return u=T.lastLimboFreeSnapshotVersion,o.Pi.getMatchingKeysForTargetId(x,T.targetId).next((b=>{g=b}))})).next((()=>o.Fs.getDocumentsMatchingQuery(x,e,t?u:Wt.min(),t?g:In()))).next((T=>(qI(o,RS(e),T),{documents:T,Qs:g})))))}function qI(s,e,t){let o=s.Os.get(e)||Wt.min();t.forEach(((u,g)=>{g.readTime.compareTo(o)>0&&(o=g.readTime)})),s.Os.set(e,o)}class Dx{constructor(){this.activeTargetIds=LS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XI{constructor(){this.Mo=new Dx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,o){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,o){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Dx,Promise.resolve()}handleUserChange(e,t,o){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class YI{Oo(e){}shutdown(){}}const Mx="ConnectivityMonitor";class kx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){yt(Mx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){yt(Mx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let sd=null;function W1(){return sd===null?sd=(function(){return 268435456+Math.round(2147483648*Math.random())})():sd++,"0x"+sd.toString(16)}const _1="RestConnection",KI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class WI{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),u=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${o}/databases/${u}`,this.Wo=this.databaseId.database===Rd?`project_id=${o}`:`project_id=${o}&database_id=${u}`}Go(e,t,o,u,g){const x=W1(),T=this.zo(e,t.toUriEncodedString());yt(_1,`Sending RPC '${e}' ${x}:`,T,o);const b={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(b,u,g);const{host:w}=new URL(T),C=Vo(w);return this.Jo(e,T,b,o,C).then((R=>(yt(_1,`Received RPC '${e}' ${x}: `,R),R)),(R=>{throw uc(_1,`RPC '${e}' ${x} failed with error: `,R,"url: ",T,"request:",o),R}))}Ho(e,t,o,u,g,x){return this.Go(e,t,o,u,g)}jo(e,t,o){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+xc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((u,g)=>e[g]=u)),o&&o.headers.forEach(((u,g)=>e[g]=u))}zo(e,t){const o=KI[e];return`${this.Uo}/v1/${t}:${o}`}terminate(){}}class QI{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const wi="WebChannelConnection";class ZI extends WI{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,o,u,g){const x=W1();return new Promise(((T,b)=>{const w=new Ew;w.setWithCredentials(!0),w.listenOnce(ww.COMPLETE,(()=>{try{switch(w.getLastErrorCode()){case dd.NO_ERROR:const R=w.getResponseJson();yt(wi,`XHR for RPC '${e}' ${x} received:`,JSON.stringify(R)),T(R);break;case dd.TIMEOUT:yt(wi,`RPC '${e}' ${x} timed out`),b(new ct(Le.DEADLINE_EXCEEDED,"Request time out"));break;case dd.HTTP_ERROR:const P=w.getStatus();if(yt(wi,`RPC '${e}' ${x} failed with status:`,P,"response text:",w.getResponseText()),P>0){let L=w.getResponseJson();Array.isArray(L)&&(L=L[0]);const ee=L?.error;if(ee&&ee.status&&ee.message){const re=(function(Ye){const Oe=Ye.toLowerCase().replace(/_/g,"-");return Object.values(Le).indexOf(Oe)>=0?Oe:Le.UNKNOWN})(ee.status);b(new ct(re,ee.message))}else b(new ct(Le.UNKNOWN,"Server responded with status "+w.getStatus()))}else b(new ct(Le.UNAVAILABLE,"Connection failed."));break;default:qt(9055,{l_:e,streamId:x,h_:w.getLastErrorCode(),P_:w.getLastError()})}}finally{yt(wi,`RPC '${e}' ${x} completed.`)}}));const C=JSON.stringify(u);yt(wi,`RPC '${e}' ${x} sending request:`,u),w.send(t,"POST",C,o,15)}))}T_(e,t,o){const u=W1(),g=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],x=bw(),T=Aw(),b={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},w=this.longPollingOptions.timeoutSeconds;w!==void 0&&(b.longPollingTimeout=Math.round(1e3*w)),this.useFetchStreams&&(b.useFetchStreams=!0),this.jo(b.initMessageHeaders,t,o),b.encodeInitMessageHeaders=!0;const C=g.join("");yt(wi,`Creating RPC '${e}' stream ${u}: ${C}`,b);const R=x.createWebChannel(C,b);this.I_(R);let P=!1,L=!1;const ee=new QI({Yo:se=>{L?yt(wi,`Not sending because RPC '${e}' stream ${u} is closed:`,se):(P||(yt(wi,`Opening RPC '${e}' stream ${u} transport.`),R.open(),P=!0),yt(wi,`RPC '${e}' stream ${u} sending:`,se),R.send(se))},Zo:()=>R.close()}),re=(se,Ye,Oe)=>{se.listen(Ye,(le=>{try{Oe(le)}catch(Ue){setTimeout((()=>{throw Ue}),0)}}))};return re(R,hu.EventType.OPEN,(()=>{L||(yt(wi,`RPC '${e}' stream ${u} transport opened.`),ee.o_())})),re(R,hu.EventType.CLOSE,(()=>{L||(L=!0,yt(wi,`RPC '${e}' stream ${u} transport closed`),ee.a_(),this.E_(R))})),re(R,hu.EventType.ERROR,(se=>{L||(L=!0,uc(wi,`RPC '${e}' stream ${u} transport errored. Name:`,se.name,"Message:",se.message),ee.a_(new ct(Le.UNAVAILABLE,"The operation could not be completed")))})),re(R,hu.EventType.MESSAGE,(se=>{if(!L){const Ye=se.data[0];qn(!!Ye,16349);const Oe=Ye,le=Oe?.error||Oe[0]?.error;if(le){yt(wi,`RPC '${e}' stream ${u} received error:`,le);const Ue=le.status;let dt=(function(z){const U=Hr[z];if(U!==void 0)return r_(U)})(Ue),Ze=le.message;dt===void 0&&(dt=Le.INTERNAL,Ze="Unknown error status: "+Ue+" with message "+le.message),L=!0,ee.a_(new ct(dt,Ze)),R.close()}else yt(wi,`RPC '${e}' stream ${u} received:`,Ye),ee.u_(Ye)}})),re(T,_w.STAT_EVENT,(se=>{se.stat===B1.PROXY?yt(wi,`RPC '${e}' stream ${u} detected buffering proxy`):se.stat===B1.NOPROXY&&yt(wi,`RPC '${e}' stream ${u} detected no buffering proxy`)})),setTimeout((()=>{ee.__()}),0),ee}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function A1(){return typeof document<"u"?document:null}function hf(s){return new tI(s,!0)}class y_{constructor(e,t,o=1e3,u=1.5,g=6e4){this.Mi=e,this.timerId=t,this.d_=o,this.A_=u,this.R_=g,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),o=Math.max(0,Date.now()-this.f_),u=Math.max(0,t-o);u>0&&yt("ExponentialBackoff",`Backing off for ${u} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${o} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,u,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Lx="PersistentStream";class x_{constructor(e,t,o,u,g,x,T,b){this.Mi=e,this.S_=o,this.b_=u,this.connection=g,this.authCredentialsProvider=x,this.appCheckCredentialsProvider=T,this.listener=b,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new y_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Le.RESOURCE_EXHAUSTED?(Va(t.toString()),Va("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([o,u])=>{this.D_===t&&this.G_(o,u)}),(o=>{e((()=>{const u=new ct(Le.UNKNOWN,"Fetching auth token failed: "+o.message);return this.z_(u)}))}))}G_(e,t){const o=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{o((()=>this.listener.Xo()))})),this.stream.t_((()=>{o((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((u=>{o((()=>this.z_(u)))})),this.stream.onMessage((u=>{o((()=>++this.F_==1?this.J_(u):this.onNext(u)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return yt(Lx,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(yt(Lx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class JI extends x_{constructor(e,t,o,u,g,x){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,o,u,x),this.serializer=g}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=iI(this.serializer,e),o=(function(g){if(!("targetChange"in g))return Wt.min();const x=g.targetChange;return x.targetIds&&x.targetIds.length?Wt.min():x.readTime?Zs(x.readTime):Wt.min()})(e);return this.listener.H_(t,o)}Y_(e){const t={};t.database=Y1(this.serializer),t.addTarget=(function(g,x){let T;const b=x.target;if(T=z1(b)?{documents:oI(g,b)}:{query:lI(g,b).ft},T.targetId=x.targetId,x.resumeToken.approximateByteSize()>0){T.resumeToken=a_(g,x.resumeToken);const w=G1(g,x.expectedCount);w!==null&&(T.expectedCount=w)}else if(x.snapshotVersion.compareTo(Wt.min())>0){T.readTime=kd(g,x.snapshotVersion.toTimestamp());const w=G1(g,x.expectedCount);w!==null&&(T.expectedCount=w)}return T})(this.serializer,e);const o=uI(this.serializer,e);o&&(t.labels=o),this.q_(t)}Z_(e){const t={};t.database=Y1(this.serializer),t.removeTarget=e,this.q_(t)}}class $I extends x_{constructor(e,t,o,u,g,x){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,o,u,x),this.serializer=g}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return qn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=aI(e.writeResults,e.commitTime),o=Zs(e.commitTime);return this.listener.na(o,t)}ra(){const e={};e.database=Y1(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((o=>sI(this.serializer,o)))};this.q_(t)}}class e4{}class t4 extends e4{constructor(e,t,o,u){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=o,this.serializer=u,this.ia=!1}sa(){if(this.ia)throw new ct(Le.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,o,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([g,x])=>this.connection.Go(e,q1(t,o),u,g,x))).catch((g=>{throw g.name==="FirebaseError"?(g.code===Le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),g):new ct(Le.UNKNOWN,g.toString())}))}Ho(e,t,o,u,g){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([x,T])=>this.connection.Ho(e,q1(t,o),u,x,T,g))).catch((x=>{throw x.name==="FirebaseError"?(x.code===Le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),x):new ct(Le.UNKNOWN,x.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class n4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Va(t),this.aa=!1):yt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const yl="RemoteStore";class r4{constructor(e,t,o,u,g){this.localStore=e,this.datastore=t,this.asyncQueue=o,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=g,this.Aa.Oo((x=>{o.enqueueAndForget((async()=>{_l(this)&&(yt(yl,"Restarting streams for network reachability change."),await(async function(b){const w=$t(b);w.Ea.add(4),await zu(w),w.Ra.set("Unknown"),w.Ea.delete(4),await df(w)})(this))}))})),this.Ra=new n4(o,u)}}async function df(s){if(_l(s))for(const e of s.da)await e(!0)}async function zu(s){for(const e of s.da)await e(!1)}function E_(s,e){const t=$t(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Bg(t)?Pg(t):Ac(t).O_()&&Lg(t,e))}function kg(s,e){const t=$t(s),o=Ac(t);t.Ia.delete(e),o.O_()&&w_(t,e),t.Ia.size===0&&(o.O_()?o.L_():_l(t)&&t.Ra.set("Unknown"))}function Lg(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Wt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ac(s).Y_(e)}function w_(s,e){s.Va.Ue(e),Ac(s).Z_(e)}function Pg(s){s.Va=new ZS({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Ac(s).start(),s.Ra.ua()}function Bg(s){return _l(s)&&!Ac(s).x_()&&s.Ia.size>0}function _l(s){return $t(s).Ea.size===0}function __(s){s.Va=void 0}async function i4(s){s.Ra.set("Online")}async function s4(s){s.Ia.forEach(((e,t)=>{Lg(s,e)}))}async function a4(s,e){__(s),Bg(s)?(s.Ra.ha(e),Pg(s)):s.Ra.set("Unknown")}async function o4(s,e,t){if(s.Ra.set("Online"),e instanceof s_&&e.state===2&&e.cause)try{await(async function(u,g){const x=g.cause;for(const T of g.targetIds)u.Ia.has(T)&&(await u.remoteSyncer.rejectListen(T,x),u.Ia.delete(T),u.Va.removeTarget(T))})(s,e)}catch(o){yt(yl,"Failed to remove targets %s: %s ",e.targetIds.join(","),o),await Pd(s,o)}else if(e instanceof pd?s.Va.Ze(e):e instanceof i_?s.Va.st(e):s.Va.tt(e),!t.isEqual(Wt.min()))try{const o=await p_(s.localStore);t.compareTo(o)>=0&&await(function(g,x){const T=g.Va.Tt(x);return T.targetChanges.forEach(((b,w)=>{if(b.resumeToken.approximateByteSize()>0){const C=g.Ia.get(w);C&&g.Ia.set(w,C.withResumeToken(b.resumeToken,x))}})),T.targetMismatches.forEach(((b,w)=>{const C=g.Ia.get(b);if(!C)return;g.Ia.set(b,C.withResumeToken(di.EMPTY_BYTE_STRING,C.snapshotVersion)),w_(g,b);const R=new To(C.target,b,w,C.sequenceNumber);Lg(g,R)})),g.remoteSyncer.applyRemoteEvent(T)})(s,t)}catch(o){yt(yl,"Failed to raise snapshot:",o),await Pd(s,o)}}async function Pd(s,e,t){if(!wc(e))throw e;s.Ea.add(1),await zu(s),s.Ra.set("Offline"),t||(t=()=>p_(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{yt(yl,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await df(s)}))}function A_(s,e){return e().catch((t=>Pd(s,t,e)))}async function ff(s){const e=$t(s),t=Po(e);let o=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:_g;for(;l4(e);)try{const u=await HI(e.localStore,o);if(u===null){e.Ta.length===0&&t.L_();break}o=u.batchId,c4(e,u)}catch(u){await Pd(e,u)}b_(e)&&v_(e)}function l4(s){return _l(s)&&s.Ta.length<10}function c4(s,e){s.Ta.push(e);const t=Po(s);t.O_()&&t.X_&&t.ea(e.mutations)}function b_(s){return _l(s)&&!Po(s).x_()&&s.Ta.length>0}function v_(s){Po(s).start()}async function u4(s){Po(s).ra()}async function h4(s){const e=Po(s);for(const t of s.Ta)e.ea(t.mutations)}async function d4(s,e,t){const o=s.Ta.shift(),u=Sg.from(o,e,t);await A_(s,(()=>s.remoteSyncer.applySuccessfulWrite(u))),await ff(s)}async function f4(s,e){e&&Po(s).X_&&await(async function(o,u){if((function(x){return KS(x)&&x!==Le.ABORTED})(u.code)){const g=o.Ta.shift();Po(o).B_(),await A_(o,(()=>o.remoteSyncer.rejectFailedWrite(g.batchId,u))),await ff(o)}})(s,e),b_(s)&&v_(s)}async function Px(s,e){const t=$t(s);t.asyncQueue.verifyOperationInProgress(),yt(yl,"RemoteStore received new credentials");const o=_l(t);t.Ea.add(3),await zu(t),o&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await df(t)}async function g4(s,e){const t=$t(s);e?(t.Ea.delete(2),await df(t)):e||(t.Ea.add(2),await zu(t),t.Ra.set("Unknown"))}function Ac(s){return s.ma||(s.ma=(function(t,o,u){const g=$t(t);return g.sa(),new JI(o,g.connection,g.authCredentials,g.appCheckCredentials,g.serializer,u)})(s.datastore,s.asyncQueue,{Xo:i4.bind(null,s),t_:s4.bind(null,s),r_:a4.bind(null,s),H_:o4.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),Bg(s)?Pg(s):s.Ra.set("Unknown")):(await s.ma.stop(),__(s))}))),s.ma}function Po(s){return s.fa||(s.fa=(function(t,o,u){const g=$t(t);return g.sa(),new $I(o,g.connection,g.authCredentials,g.appCheckCredentials,g.serializer,u)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:u4.bind(null,s),r_:f4.bind(null,s),ta:h4.bind(null,s),na:d4.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await ff(s)):(await s.fa.stop(),s.Ta.length>0&&(yt(yl,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Vg{constructor(e,t,o,u,g){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=o,this.op=u,this.removalCallback=g,this.deferred=new ka,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((x=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,o,u,g){const x=Date.now()+o,T=new Vg(e,t,x,u,g);return T.start(o),T}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ct(Le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ug(s,e){if(Va("AsyncQueue",`${e}: ${s}`),wc(s))return new ct(Le.UNAVAILABLE,`${e}: ${s}`);throw s}class oc{static emptySet(e){return new oc(e.comparator)}constructor(e){this.comparator=e?(t,o)=>e(t,o)||Mt.comparator(t.key,o.key):(t,o)=>Mt.comparator(t.key,o.key),this.keyedMap=du(),this.sortedSet=new br(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,o)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof oc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),o=e.sortedSet.getIterator();for(;t.hasNext();){const u=t.getNext().key,g=o.getNext().key;if(!u.isEqual(g))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const o=new oc;return o.comparator=this.comparator,o.keyedMap=e,o.sortedSet=t,o}}class Bx{constructor(){this.ga=new br(Mt.comparator)}track(e){const t=e.doc.key,o=this.ga.get(t);o?e.type!==0&&o.type===3?this.ga=this.ga.insert(t,e):e.type===3&&o.type!==1?this.ga=this.ga.insert(t,{type:o.type,doc:e.doc}):e.type===2&&o.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&o.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&o.type===0?this.ga=this.ga.remove(t):e.type===1&&o.type===2?this.ga=this.ga.insert(t,{type:1,doc:o.doc}):e.type===0&&o.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):qt(63341,{Rt:e,pa:o}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,o)=>{e.push(o)})),e}}class mc{constructor(e,t,o,u,g,x,T,b,w){this.query=e,this.docs=t,this.oldDocs=o,this.docChanges=u,this.mutatedKeys=g,this.fromCache=x,this.syncStateChanged=T,this.excludesMetadataChanges=b,this.hasCachedResults=w}static fromInitialDocuments(e,t,o,u,g){const x=[];return t.forEach((T=>{x.push({type:0,doc:T})})),new mc(e,t,oc.emptySet(t),x,o,u,!0,!1,g)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,o=e.docChanges;if(t.length!==o.length)return!1;for(let u=0;u<t.length;u++)if(t[u].type!==o[u].type||!t[u].doc.isEqual(o[u].doc))return!1;return!0}}class m4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class p4{constructor(){this.queries=Vx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,o){const u=$t(t),g=u.queries;u.queries=Vx(),g.forEach(((x,T)=>{for(const b of T.Sa)b.onError(o)}))})(this,new ct(Le.ABORTED,"Firestore shutting down"))}}function Vx(){return new wl((s=>qw(s)),sf)}async function Fg(s,e){const t=$t(s);let o=3;const u=e.query;let g=t.queries.get(u);g?!g.ba()&&e.Da()&&(o=2):(g=new m4,o=e.Da()?0:1);try{switch(o){case 0:g.wa=await t.onListen(u,!0);break;case 1:g.wa=await t.onListen(u,!1);break;case 2:await t.onFirstRemoteStoreListen(u)}}catch(x){const T=Ug(x,`Initialization of query '${Jl(e.query)}' failed`);return void e.onError(T)}t.queries.set(u,g),g.Sa.push(e),e.va(t.onlineState),g.wa&&e.Fa(g.wa)&&zg(t)}async function jg(s,e){const t=$t(s),o=e.query;let u=3;const g=t.queries.get(o);if(g){const x=g.Sa.indexOf(e);x>=0&&(g.Sa.splice(x,1),g.Sa.length===0?u=e.Da()?0:1:!g.ba()&&e.Da()&&(u=2))}switch(u){case 0:return t.queries.delete(o),t.onUnlisten(o,!0);case 1:return t.queries.delete(o),t.onUnlisten(o,!1);case 2:return t.onLastRemoteStoreUnlisten(o);default:return}}function y4(s,e){const t=$t(s);let o=!1;for(const u of e){const g=u.query,x=t.queries.get(g);if(x){for(const T of x.Sa)T.Fa(u)&&(o=!0);x.wa=u}}o&&zg(t)}function x4(s,e,t){const o=$t(s),u=o.queries.get(e);if(u)for(const g of u.Sa)g.onError(t);o.queries.delete(e)}function zg(s){s.Ca.forEach((e=>{e.next()}))}var Q1,Ux;(Ux=Q1||(Q1={})).Ma="default",Ux.Cache="cache";class Hg{constructor(e,t,o){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=o||{}}Fa(e){if(!this.options.includeMetadataChanges){const o=[];for(const u of e.docChanges)u.type!==3&&o.push(u);e=new mc(e.query,e.docs,e.oldDocs,o,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const o=t!=="Offline";return(!this.options.qa||!o)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=mc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Q1.Cache}}class T_{constructor(e){this.key=e}}class C_{constructor(e){this.key=e}}class E4{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=In(),this.mutatedKeys=In(),this.eu=Xw(e),this.tu=new oc(this.eu)}get nu(){return this.Ya}ru(e,t){const o=t?t.iu:new Bx,u=t?t.tu:this.tu;let g=t?t.mutatedKeys:this.mutatedKeys,x=u,T=!1;const b=this.query.limitType==="F"&&u.size===this.query.limit?u.last():null,w=this.query.limitType==="L"&&u.size===this.query.limit?u.first():null;if(e.inorderTraversal(((C,R)=>{const P=u.get(C),L=af(this.query,R)?R:null,ee=!!P&&this.mutatedKeys.has(P.key),re=!!L&&(L.hasLocalMutations||this.mutatedKeys.has(L.key)&&L.hasCommittedMutations);let se=!1;P&&L?P.data.isEqual(L.data)?ee!==re&&(o.track({type:3,doc:L}),se=!0):this.su(P,L)||(o.track({type:2,doc:L}),se=!0,(b&&this.eu(L,b)>0||w&&this.eu(L,w)<0)&&(T=!0)):!P&&L?(o.track({type:0,doc:L}),se=!0):P&&!L&&(o.track({type:1,doc:P}),se=!0,(b||w)&&(T=!0)),se&&(L?(x=x.add(L),g=re?g.add(C):g.delete(C)):(x=x.delete(C),g=g.delete(C)))})),this.query.limit!==null)for(;x.size>this.query.limit;){const C=this.query.limitType==="F"?x.last():x.first();x=x.delete(C.key),g=g.delete(C.key),o.track({type:1,doc:C})}return{tu:x,iu:o,Cs:T,mutatedKeys:g}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,o,u){const g=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const x=e.iu.ya();x.sort(((C,R)=>(function(L,ee){const re=se=>{switch(se){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qt(20277,{Rt:se})}};return re(L)-re(ee)})(C.type,R.type)||this.eu(C.doc,R.doc))),this.ou(o),u=u??!1;const T=t&&!u?this._u():[],b=this.Xa.size===0&&this.current&&!u?1:0,w=b!==this.Za;return this.Za=b,x.length!==0||w?{snapshot:new mc(this.query,e.tu,g,x,e.mutatedKeys,b===0,w,!1,!!o&&o.resumeToken.approximateByteSize()>0),au:T}:{au:T}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Bx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=In(),this.tu.forEach((o=>{this.uu(o.key)&&(this.Xa=this.Xa.add(o.key))}));const t=[];return e.forEach((o=>{this.Xa.has(o)||t.push(new C_(o))})),this.Xa.forEach((o=>{e.has(o)||t.push(new T_(o))})),t}cu(e){this.Ya=e.Qs,this.Xa=In();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return mc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Gg="SyncEngine";class w4{constructor(e,t,o){this.query=e,this.targetId=t,this.view=o}}class _4{constructor(e){this.key=e,this.hu=!1}}class A4{constructor(e,t,o,u,g,x){this.localStore=e,this.remoteStore=t,this.eventManager=o,this.sharedClientState=u,this.currentUser=g,this.maxConcurrentLimboResolutions=x,this.Pu={},this.Tu=new wl((T=>qw(T)),sf),this.Iu=new Map,this.Eu=new Set,this.du=new br(Mt.comparator),this.Au=new Map,this.Ru=new Ng,this.Vu={},this.mu=new Map,this.fu=gc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function b4(s,e,t=!0){const o=D_(s);let u;const g=o.Tu.get(e);return g?(o.sharedClientState.addLocalQueryTarget(g.targetId),u=g.view.lu()):u=await S_(o,e,t,!0),u}async function v4(s,e){const t=D_(s);await S_(t,e,!0,!1)}async function S_(s,e,t,o){const u=await GI(s.localStore,Qs(e)),g=u.targetId,x=s.sharedClientState.addLocalQueryTarget(g,t);let T;return o&&(T=await T4(s,e,g,x==="current",u.resumeToken)),s.isPrimaryClient&&t&&E_(s.remoteStore,u),T}async function T4(s,e,t,o,u){s.pu=(R,P,L)=>(async function(re,se,Ye,Oe){let le=se.view.ru(Ye);le.Cs&&(le=await Ox(re.localStore,se.query,!1).then((({documents:F})=>se.view.ru(F,le))));const Ue=Oe&&Oe.targetChanges.get(se.targetId),dt=Oe&&Oe.targetMismatches.get(se.targetId)!=null,Ze=se.view.applyChanges(le,re.isPrimaryClient,Ue,dt);return jx(re,se.targetId,Ze.au),Ze.snapshot})(s,R,P,L);const g=await Ox(s.localStore,e,!0),x=new E4(e,g.Qs),T=x.ru(g.documents),b=ju.createSynthesizedTargetChangeForCurrentChange(t,o&&s.onlineState!=="Offline",u),w=x.applyChanges(T,s.isPrimaryClient,b);jx(s,t,w.au);const C=new w4(e,t,x);return s.Tu.set(e,C),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),w.snapshot}async function C4(s,e,t){const o=$t(s),u=o.Tu.get(e),g=o.Iu.get(u.targetId);if(g.length>1)return o.Iu.set(u.targetId,g.filter((x=>!sf(x,e)))),void o.Tu.delete(e);o.isPrimaryClient?(o.sharedClientState.removeLocalQueryTarget(u.targetId),o.sharedClientState.isActiveQueryTarget(u.targetId)||await K1(o.localStore,u.targetId,!1).then((()=>{o.sharedClientState.clearQueryState(u.targetId),t&&kg(o.remoteStore,u.targetId),Z1(o,u.targetId)})).catch(Ec)):(Z1(o,u.targetId),await K1(o.localStore,u.targetId,!0))}async function S4(s,e){const t=$t(s),o=t.Tu.get(e),u=t.Iu.get(o.targetId);t.isPrimaryClient&&u.length===1&&(t.sharedClientState.removeLocalQueryTarget(o.targetId),kg(t.remoteStore,o.targetId))}async function I4(s,e,t){const o=L4(s);try{const u=await(function(x,T){const b=$t(x),w=Vn.now(),C=T.reduce(((L,ee)=>L.add(ee.key)),In());let R,P;return b.persistence.runTransaction("Locally write mutations","readwrite",(L=>{let ee=Ua(),re=In();return b.Ns.getEntries(L,C).next((se=>{ee=se,ee.forEach(((Ye,Oe)=>{Oe.isValidDocument()||(re=re.add(Ye))}))})).next((()=>b.localDocuments.getOverlayedDocuments(L,ee))).next((se=>{R=se;const Ye=[];for(const Oe of T){const le=HS(Oe,R.get(Oe.key).overlayedDocument);le!=null&&Ye.push(new jo(Oe.key,le,Bw(le.value.mapValue),Mi.exists(!0)))}return b.mutationQueue.addMutationBatch(L,w,Ye,T)})).next((se=>{P=se;const Ye=se.applyToLocalDocumentSet(R,re);return b.documentOverlayCache.saveOverlays(L,se.batchId,Ye)}))})).then((()=>({batchId:P.batchId,changes:Kw(R)})))})(o.localStore,e);o.sharedClientState.addPendingMutation(u.batchId),(function(x,T,b){let w=x.Vu[x.currentUser.toKey()];w||(w=new br(Sn)),w=w.insert(T,b),x.Vu[x.currentUser.toKey()]=w})(o,u.batchId,t),await Hu(o,u.changes),await ff(o.remoteStore)}catch(u){const g=Ug(u,"Failed to persist write");t.reject(g)}}async function I_(s,e){const t=$t(s);try{const o=await jI(t.localStore,e);e.targetChanges.forEach(((u,g)=>{const x=t.Au.get(g);x&&(qn(u.addedDocuments.size+u.modifiedDocuments.size+u.removedDocuments.size<=1,22616),u.addedDocuments.size>0?x.hu=!0:u.modifiedDocuments.size>0?qn(x.hu,14607):u.removedDocuments.size>0&&(qn(x.hu,42227),x.hu=!1))})),await Hu(t,o,e)}catch(o){await Ec(o)}}function Fx(s,e,t){const o=$t(s);if(o.isPrimaryClient&&t===0||!o.isPrimaryClient&&t===1){const u=[];o.Tu.forEach(((g,x)=>{const T=x.view.va(e);T.snapshot&&u.push(T.snapshot)})),(function(x,T){const b=$t(x);b.onlineState=T;let w=!1;b.queries.forEach(((C,R)=>{for(const P of R.Sa)P.va(T)&&(w=!0)})),w&&zg(b)})(o.eventManager,e),u.length&&o.Pu.H_(u),o.onlineState=e,o.isPrimaryClient&&o.sharedClientState.setOnlineState(e)}}async function R4(s,e,t){const o=$t(s);o.sharedClientState.updateQueryState(e,"rejected",t);const u=o.Au.get(e),g=u&&u.key;if(g){let x=new br(Mt.comparator);x=x.insert(g,Ai.newNoDocument(g,Wt.min()));const T=In().add(g),b=new uf(Wt.min(),new Map,new br(Sn),x,T);await I_(o,b),o.du=o.du.remove(g),o.Au.delete(e),qg(o)}else await K1(o.localStore,e,!1).then((()=>Z1(o,e,t))).catch(Ec)}async function N4(s,e){const t=$t(s),o=e.batch.batchId;try{const u=await FI(t.localStore,e);N_(t,o,null),R_(t,o),t.sharedClientState.updateMutationState(o,"acknowledged"),await Hu(t,u)}catch(u){await Ec(u)}}async function O4(s,e,t){const o=$t(s);try{const u=await(function(x,T){const b=$t(x);return b.persistence.runTransaction("Reject batch","readwrite-primary",(w=>{let C;return b.mutationQueue.lookupMutationBatch(w,T).next((R=>(qn(R!==null,37113),C=R.keys(),b.mutationQueue.removeMutationBatch(w,R)))).next((()=>b.mutationQueue.performConsistencyCheck(w))).next((()=>b.documentOverlayCache.removeOverlaysForBatchId(w,C,T))).next((()=>b.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(w,C))).next((()=>b.localDocuments.getDocuments(w,C)))}))})(o.localStore,e);N_(o,e,t),R_(o,e),o.sharedClientState.updateMutationState(e,"rejected",t),await Hu(o,u)}catch(u){await Ec(u)}}function R_(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function N_(s,e,t){const o=$t(s);let u=o.Vu[o.currentUser.toKey()];if(u){const g=u.get(e);g&&(t?g.reject(t):g.resolve(),u=u.remove(e)),o.Vu[o.currentUser.toKey()]=u}}function Z1(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const o of s.Iu.get(e))s.Tu.delete(o),t&&s.Pu.yu(o,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((o=>{s.Ru.containsKey(o)||O_(s,o)}))}function O_(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(kg(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),qg(s))}function jx(s,e,t){for(const o of t)o instanceof T_?(s.Ru.addReference(o.key,e),D4(s,o)):o instanceof C_?(yt(Gg,"Document no longer in limbo: "+o.key),s.Ru.removeReference(o.key,e),s.Ru.containsKey(o.key)||O_(s,o.key)):qt(19791,{wu:o})}function D4(s,e){const t=e.key,o=t.path.canonicalString();s.du.get(t)||s.Eu.has(o)||(yt(Gg,"New document in limbo: "+t),s.Eu.add(o),qg(s))}function qg(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Mt(ar.fromString(e)),o=s.fu.next();s.Au.set(o,new _4(t)),s.du=s.du.insert(t,o),E_(s.remoteStore,new To(Qs(rf(t.path)),o,"TargetPurposeLimboResolution",ef.ce))}}async function Hu(s,e,t){const o=$t(s),u=[],g=[],x=[];o.Tu.isEmpty()||(o.Tu.forEach(((T,b)=>{x.push(o.pu(b,e,t).then((w=>{if((w||t)&&o.isPrimaryClient){const C=w?!w.fromCache:t?.targetChanges.get(b.targetId)?.current;o.sharedClientState.updateQueryState(b.targetId,C?"current":"not-current")}if(w){u.push(w);const C=Dg.As(b.targetId,w);g.push(C)}})))})),await Promise.all(x),o.Pu.H_(u),await(async function(b,w){const C=$t(b);try{await C.persistence.runTransaction("notifyLocalViewChanges","readwrite",(R=>je.forEach(w,(P=>je.forEach(P.Es,(L=>C.persistence.referenceDelegate.addReference(R,P.targetId,L))).next((()=>je.forEach(P.ds,(L=>C.persistence.referenceDelegate.removeReference(R,P.targetId,L)))))))))}catch(R){if(!wc(R))throw R;yt(Mg,"Failed to update sequence numbers: "+R)}for(const R of w){const P=R.targetId;if(!R.fromCache){const L=C.Ms.get(P),ee=L.snapshotVersion,re=L.withLastLimboFreeSnapshotVersion(ee);C.Ms=C.Ms.insert(P,re)}}})(o.localStore,g))}async function M4(s,e){const t=$t(s);if(!t.currentUser.isEqual(e)){yt(Gg,"User change. New user:",e.toKey());const o=await m_(t.localStore,e);t.currentUser=e,(function(g,x){g.mu.forEach((T=>{T.forEach((b=>{b.reject(new ct(Le.CANCELLED,x))}))})),g.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,o.removedBatchIds,o.addedBatchIds),await Hu(t,o.Ls)}}function k4(s,e){const t=$t(s),o=t.Au.get(e);if(o&&o.hu)return In().add(o.key);{let u=In();const g=t.Iu.get(e);if(!g)return u;for(const x of g){const T=t.Tu.get(x);u=u.unionWith(T.view.nu)}return u}}function D_(s){const e=$t(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=I_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=k4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=R4.bind(null,e),e.Pu.H_=y4.bind(null,e.eventManager),e.Pu.yu=x4.bind(null,e.eventManager),e}function L4(s){const e=$t(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=N4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=O4.bind(null,e),e}class Bd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return UI(this.persistence,new PI,e.initialUser,this.serializer)}Cu(e){return new g_(Og.mi,this.serializer)}Du(e){return new XI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bd.provider={build:()=>new Bd};class P4 extends Bd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){qn(this.persistence.referenceDelegate instanceof Ld,46915);const o=this.persistence.referenceDelegate.garbageCollector;return new _I(o,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Yi.withCacheSize(this.cacheSizeBytes):Yi.DEFAULT;return new g_((o=>Ld.mi(o,t)),this.serializer)}}class J1{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=o=>Fx(this.syncEngine,o,1),this.remoteStore.remoteSyncer.handleCredentialChange=M4.bind(null,this.syncEngine),await g4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new p4})()}createDatastore(e){const t=hf(e.databaseInfo.databaseId),o=(function(g){return new ZI(g)})(e.databaseInfo);return(function(g,x,T,b){return new t4(g,x,T,b)})(e.authCredentials,e.appCheckCredentials,o,t)}createRemoteStore(e){return(function(o,u,g,x,T){return new r4(o,u,g,x,T)})(this.localStore,this.datastore,e.asyncQueue,(t=>Fx(this.syncEngine,t,0)),(function(){return kx.v()?new kx:new YI})())}createSyncEngine(e,t){return(function(u,g,x,T,b,w,C){const R=new A4(u,g,x,T,b,w);return C&&(R.gu=!0),R})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const o=$t(t);yt(yl,"RemoteStore shutting down."),o.Ea.add(5),await zu(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}J1.provider={build:()=>new J1};class Xg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Va("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Bo="FirestoreClient";class B4{constructor(e,t,o,u,g){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=o,this.databaseInfo=u,this.user=_i.UNAUTHENTICATED,this.clientId=wg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=g,this.authCredentials.start(o,(async x=>{yt(Bo,"Received user=",x.uid),await this.authCredentialListener(x),this.user=x})),this.appCheckCredentials.start(o,(x=>(yt(Bo,"Received new app check token=",x),this.appCheckCredentialListener(x,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ka;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const o=Ug(t,"Failed to shutdown persistence");e.reject(o)}})),e.promise}}async function b1(s,e){s.asyncQueue.verifyOperationInProgress(),yt(Bo,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let o=t.initialUser;s.setCredentialChangeListener((async u=>{o.isEqual(u)||(await m_(e.localStore,u),o=u)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function zx(s,e){s.asyncQueue.verifyOperationInProgress();const t=await V4(s);yt(Bo,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((o=>Px(e.remoteStore,o))),s.setAppCheckTokenChangeListener(((o,u)=>Px(e.remoteStore,u))),s._onlineComponents=e}async function V4(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){yt(Bo,"Using user provided OfflineComponentProvider");try{await b1(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(u){return u.name==="FirebaseError"?u.code===Le.FAILED_PRECONDITION||u.code===Le.UNIMPLEMENTED:!(typeof DOMException<"u"&&u instanceof DOMException)||u.code===22||u.code===20||u.code===11})(t))throw t;uc("Error using user provided cache. Falling back to memory cache: "+t),await b1(s,new Bd)}}else yt(Bo,"Using default OfflineComponentProvider"),await b1(s,new P4(void 0));return s._offlineComponents}async function M_(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(yt(Bo,"Using user provided OnlineComponentProvider"),await zx(s,s._uninitializedComponentsProvider._online)):(yt(Bo,"Using default OnlineComponentProvider"),await zx(s,new J1))),s._onlineComponents}function U4(s){return M_(s).then((e=>e.syncEngine))}async function Vd(s){const e=await M_(s),t=e.eventManager;return t.onListen=b4.bind(null,e.syncEngine),t.onUnlisten=C4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=v4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=S4.bind(null,e.syncEngine),t}function F4(s,e,t={}){const o=new ka;return s.asyncQueue.enqueueAndForget((async()=>(function(g,x,T,b,w){const C=new Xg({next:P=>{C.Nu(),x.enqueueAndForget((()=>jg(g,R)));const L=P.docs.has(T);!L&&P.fromCache?w.reject(new ct(Le.UNAVAILABLE,"Failed to get document because the client is offline.")):L&&P.fromCache&&b&&b.source==="server"?w.reject(new ct(Le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):w.resolve(P)},error:P=>w.reject(P)}),R=new Hg(rf(T.path),C,{includeMetadataChanges:!0,qa:!0});return Fg(g,R)})(await Vd(s),s.asyncQueue,e,t,o))),o.promise}function j4(s,e,t={}){const o=new ka;return s.asyncQueue.enqueueAndForget((async()=>(function(g,x,T,b,w){const C=new Xg({next:P=>{C.Nu(),x.enqueueAndForget((()=>jg(g,R))),P.fromCache&&b.source==="server"?w.reject(new ct(Le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):w.resolve(P)},error:P=>w.reject(P)}),R=new Hg(T,C,{includeMetadataChanges:!0,qa:!0});return Fg(g,R)})(await Vd(s),s.asyncQueue,e,t,o))),o.promise}function k_(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const Hx=new Map;const L_="firestore.googleapis.com",Gx=!0;class qx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ct(Le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=L_,this.ssl=Gx}else this.host=e.host,this.ssl=e.ssl??Gx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=f_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<EI)throw new ct(Le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}tS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=k_(e.experimentalLongPollingOptions??{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ct(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ct(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ct(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(o,u){return o.timeoutSeconds===u.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gf{constructor(e,t,o,u){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=o,this._app=u,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ct(Le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ct(Le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(o){if(!o)return new q3;switch(o.type){case"firstParty":return new W3(o.sessionIndex||"0",o.iamToken||null,o.authTokenFactory||null);case"provider":return o.client;default:throw new ct(Le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const o=Hx.get(t);o&&(yt("ComponentProvider","Removing Datastore"),Hx.delete(t),o.terminate())})(this),Promise.resolve()}}function z4(s,e,t,o={}){s=Di(s,gf);const u=Vo(e),g=s._getSettings(),x={...g,emulatorOptions:s._getEmulatorOptions()},T=`${e}:${t}`;u&&(ag(`https://${T}`),og("Firestore",!0)),g.host!==L_&&g.host!==T&&uc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const b={...g,host:T,ssl:u,emulatorOptions:o};if(!dl(b,x)&&(s._setSettings(b),o.mockUserToken)){let w,C;if(typeof o.mockUserToken=="string")w=o.mockUserToken,C=_i.MOCK_USER;else{w=Zb(o.mockUserToken,s._app?.options.projectId);const R=o.mockUserToken.sub||o.mockUserToken.user_id;if(!R)throw new ct(Le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");C=new _i(R)}s._authCredentials=new X3(new Tw(w,C))}}class za{constructor(e,t,o){this.converter=t,this._query=o,this.type="query",this.firestore=e}withConverter(e){return new za(this.firestore,e,this._query)}}class Dr{constructor(e,t,o){this.converter=t,this._key=o,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new No(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dr(this.firestore,e,this._key)}toJSON(){return{type:Dr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,o){if(Uu(t,Dr._jsonSchema))return new Dr(e,o||null,new Mt(ar.fromString(t.referencePath)))}}Dr._jsonSchemaVersion="firestore/documentReference/1.0",Dr._jsonSchema={type:qr("string",Dr._jsonSchemaVersion),referencePath:qr("string")};class No extends za{constructor(e,t,o){super(e,t,rf(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dr(this.firestore,null,new Mt(e))}withConverter(e){return new No(this.firestore,e,this._path)}}function Kn(s,e,...t){if(s=ir(s),Cw("collection","path",e),s instanceof gf){const o=ar.fromString(e,...t);return ix(o),new No(s,null,o)}{if(!(s instanceof Dr||s instanceof No))throw new ct(Le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(ar.fromString(e,...t));return ix(o),new No(s.firestore,null,o)}}function Cn(s,e,...t){if(s=ir(s),arguments.length===1&&(e=wg.newId()),Cw("doc","path",e),s instanceof gf){const o=ar.fromString(e,...t);return rx(o),new Dr(s,null,new Mt(o))}{if(!(s instanceof Dr||s instanceof No))throw new ct(Le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(ar.fromString(e,...t));return rx(o),new Dr(s.firestore,s instanceof No?s.converter:null,new Mt(o))}}const Xx="AsyncQueue";class Yx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new y_(this,"async_queue_retry"),this._c=()=>{const o=A1();o&&yt(Xx,"Visibility state changed to "+o.visibilityState),this.M_.w_()},this.ac=e;const t=A1();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=A1();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ka;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!wc(e))throw e;yt(Xx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((o=>{throw this.nc=o,this.rc=!1,Va("INTERNAL UNHANDLED ERROR: ",Kx(o)),o})).then((o=>(this.rc=!1,o))))));return this.ac=t,t}enqueueAfterDelay(e,t,o){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const u=Vg.createAndSchedule(this,e,t,o,(g=>this.hc(g)));return this.tc.push(u),u}uc(){this.nc&&qt(47125,{Pc:Kx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,o)=>t.targetTimeMs-o.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Kx(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}function Wx(s){return(function(t,o){if(typeof t!="object"||t===null)return!1;const u=t;for(const g of o)if(g in u&&typeof u[g]=="function")return!0;return!1})(s,["next","error","complete"])}class ta extends gf{constructor(e,t,o,u){super(e,t,o,u),this.type="firestore",this._queue=new Yx,this._persistenceKey=u?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Yx(e),this._firestoreClient=void 0,await e}}}function H4(s,e){const t=typeof s=="object"?s:Wd(),o=typeof s=="string"?s:Rd,u=Kd(t,"firestore").getImmediate({identifier:o});if(!u._initialized){const g=SE("firestore");g&&z4(u,...g)}return u}function Gu(s){if(s._terminated)throw new ct(Le.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||G4(s),s._firestoreClient}function G4(s){const e=s._freezeSettings(),t=(function(u,g,x,T){return new fS(u,g,x,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,k_(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new B4(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(u){const g=u?._online.build();return{_offline:u?._offline.build(g),_online:g}})(s._componentsProvider))}class Ts{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ts(di.fromBase64String(e))}catch(t){throw new ct(Le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ts(di.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ts._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Uu(e,Ts._jsonSchema))return Ts.fromBase64String(e.bytes)}}Ts._jsonSchemaVersion="firestore/bytes/1.0",Ts._jsonSchema={type:qr("string",Ts._jsonSchemaVersion),bytes:qr("string")};class qu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ct(Le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hi(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class mf{constructor(e){this._methodName=e}}class Js{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ct(Le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ct(Le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Sn(this._lat,e._lat)||Sn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Js._jsonSchemaVersion}}static fromJSON(e){if(Uu(e,Js._jsonSchema))return new Js(e.latitude,e.longitude)}}Js._jsonSchemaVersion="firestore/geoPoint/1.0",Js._jsonSchema={type:qr("string",Js._jsonSchemaVersion),latitude:qr("number"),longitude:qr("number")};class $s{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(o,u){if(o.length!==u.length)return!1;for(let g=0;g<o.length;++g)if(o[g]!==u[g])return!1;return!0})(this._values,e._values)}toJSON(){return{type:$s._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Uu(e,$s._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new $s(e.vectorValues);throw new ct(Le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$s._jsonSchemaVersion="firestore/vectorValue/1.0",$s._jsonSchema={type:qr("string",$s._jsonSchemaVersion),vectorValues:qr("object")};const q4=/^__.*__$/;class X4{constructor(e,t,o){this.data=e,this.fieldMask=t,this.fieldTransforms=o}toMutation(e,t){return this.fieldMask!==null?new jo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fu(e,this.data,t,this.fieldTransforms)}}class P_{constructor(e,t,o){this.data=e,this.fieldMask=t,this.fieldTransforms=o}toMutation(e,t){return new jo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function B_(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qt(40011,{Ac:s})}}class Yg{constructor(e,t,o,u,g,x){this.settings=e,this.databaseId=t,this.serializer=o,this.ignoreUndefinedProperties=u,g===void 0&&this.Rc(),this.fieldTransforms=g||[],this.fieldMask=x||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Yg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),o=this.Vc({path:t,fc:!1});return o.gc(e),o}yc(e){const t=this.path?.child(e),o=this.Vc({path:t,fc:!1});return o.Rc(),o}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ud(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(B_(this.Ac)&&q4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Y4{constructor(e,t,o){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=o||hf(e)}Cc(e,t,o,u=!1){return new Yg({Ac:e,methodName:t,Dc:o,path:hi.emptyPath(),fc:!1,bc:u},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(s){const e=s._freezeSettings(),t=hf(s._databaseId);return new Y4(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Kg(s,e,t,o,u,g={}){const x=s.Cc(g.merge||g.mergeFields?2:0,e,t,u);Qg("Data must be an object, but it was:",x,o);const T=F_(o,x);let b,w;if(g.merge)b=new us(x.fieldMask),w=x.fieldTransforms;else if(g.mergeFields){const C=[];for(const R of g.mergeFields){const P=$1(e,R,t);if(!x.contains(P))throw new ct(Le.INVALID_ARGUMENT,`Field '${P}' is specified in your field mask but missing from your input data.`);z_(C,P)||C.push(P)}b=new us(C),w=x.fieldTransforms.filter((R=>b.covers(R.field)))}else b=null,w=x.fieldTransforms;return new X4(new Ki(T),b,w)}class pf extends mf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pf}}class Wg extends mf{_toFieldTransform(e){return new US(e.path,new Nu)}isEqual(e){return e instanceof Wg}}function V_(s,e,t,o){const u=s.Cc(1,e,t);Qg("Data must be an object, but it was:",u,o);const g=[],x=Ki.empty();Fo(o,((b,w)=>{const C=Zg(e,b,t);w=ir(w);const R=u.yc(C);if(w instanceof pf)g.push(C);else{const P=Yu(w,R);P!=null&&(g.push(C),x.set(C,P))}}));const T=new us(g);return new P_(x,T,u.fieldTransforms)}function U_(s,e,t,o,u,g){const x=s.Cc(1,e,t),T=[$1(e,o,t)],b=[u];if(g.length%2!=0)throw new ct(Le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let P=0;P<g.length;P+=2)T.push($1(e,g[P])),b.push(g[P+1]);const w=[],C=Ki.empty();for(let P=T.length-1;P>=0;--P)if(!z_(w,T[P])){const L=T[P];let ee=b[P];ee=ir(ee);const re=x.yc(L);if(ee instanceof pf)w.push(L);else{const se=Yu(ee,re);se!=null&&(w.push(L),C.set(L,se))}}const R=new us(w);return new P_(C,R,x.fieldTransforms)}function K4(s,e,t,o=!1){return Yu(t,s.Cc(o?4:3,e))}function Yu(s,e){if(j_(s=ir(s)))return Qg("Unsupported field value:",e,s),F_(s,e);if(s instanceof mf)return(function(o,u){if(!B_(u.Ac))throw u.Sc(`${o._methodName}() can only be used with update() and set()`);if(!u.path)throw u.Sc(`${o._methodName}() is not currently supported inside arrays`);const g=o._toFieldTransform(u);g&&u.fieldTransforms.push(g)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(o,u){const g=[];let x=0;for(const T of o){let b=Yu(T,u.wc(x));b==null&&(b={nullValue:"NULL_VALUE"}),g.push(b),x++}return{arrayValue:{values:g}}})(s,e)}return(function(o,u){if((o=ir(o))===null)return{nullValue:"NULL_VALUE"};if(typeof o=="number")return PS(u.serializer,o);if(typeof o=="boolean")return{booleanValue:o};if(typeof o=="string")return{stringValue:o};if(o instanceof Date){const g=Vn.fromDate(o);return{timestampValue:kd(u.serializer,g)}}if(o instanceof Vn){const g=new Vn(o.seconds,1e3*Math.floor(o.nanoseconds/1e3));return{timestampValue:kd(u.serializer,g)}}if(o instanceof Js)return{geoPointValue:{latitude:o.latitude,longitude:o.longitude}};if(o instanceof Ts)return{bytesValue:a_(u.serializer,o._byteString)};if(o instanceof Dr){const g=u.databaseId,x=o.firestore._databaseId;if(!x.isEqual(g))throw u.Sc(`Document reference is for database ${x.projectId}/${x.database} but should be for database ${g.projectId}/${g.database}`);return{referenceValue:Rg(o.firestore._databaseId||u.databaseId,o._key.path)}}if(o instanceof $s)return(function(x,T){return{mapValue:{fields:{[Lw]:{stringValue:Pw},[Nd]:{arrayValue:{values:x.toArray().map((w=>{if(typeof w!="number")throw T.Sc("VectorValues must only contain numeric values.");return Cg(T.serializer,w)}))}}}}}})(o,u);throw u.Sc(`Unsupported field value: ${$d(o)}`)})(s,e)}function F_(s,e){const t={};return Rw(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fo(s,((o,u)=>{const g=Yu(u,e.mc(o));g!=null&&(t[o]=g)})),{mapValue:{fields:t}}}function j_(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Vn||s instanceof Js||s instanceof Ts||s instanceof Dr||s instanceof mf||s instanceof $s)}function Qg(s,e,t){if(!j_(t)||!Sw(t)){const o=$d(t);throw o==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+o)}}function $1(s,e,t){if((e=ir(e))instanceof qu)return e._internalPath;if(typeof e=="string")return Zg(s,e);throw Ud("Field path arguments must be of type string or ",s,!1,void 0,t)}const W4=new RegExp("[~\\*/\\[\\]]");function Zg(s,e,t){if(e.search(W4)>=0)throw Ud(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new qu(...e.split("."))._internalPath}catch{throw Ud(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Ud(s,e,t,o,u){const g=o&&!o.isEmpty(),x=u!==void 0;let T=`Function ${e}() called with invalid data`;t&&(T+=" (via `toFirestore()`)"),T+=". ";let b="";return(g||x)&&(b+=" (found",g&&(b+=` in field ${o}`),x&&(b+=` in document ${u}`),b+=")"),new ct(Le.INVALID_ARGUMENT,T+s+b)}function z_(s,e){return s.some((t=>t.isEqual(e)))}class H_{constructor(e,t,o,u,g){this._firestore=e,this._userDataWriter=t,this._key=o,this._document=u,this._converter=g}get id(){return this._key.path.lastSegment()}get ref(){return new Dr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Q4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(yf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Q4 extends H_{data(){return super.data()}}function yf(s,e){return typeof e=="string"?Zg(s,e):e instanceof qu?e._internalPath:e._delegate._internalPath}function G_(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new ct(Le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jg{}class $g extends Jg{}function ui(s,e,...t){let o=[];e instanceof Jg&&o.push(e),o=o.concat(t),(function(g){const x=g.filter((b=>b instanceof em)).length,T=g.filter((b=>b instanceof xf)).length;if(x>1||x>0&&T>0)throw new ct(Le.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(o);for(const u of o)s=u._apply(s);return s}class xf extends $g{constructor(e,t,o){super(),this._field=e,this._op=t,this._value=o,this.type="where"}static _create(e,t,o){return new xf(e,t,o)}_apply(e){const t=this._parse(e);return q_(e._query,t),new za(e.firestore,e.converter,H1(e._query,t))}_parse(e){const t=Xu(e.firestore);return(function(g,x,T,b,w,C,R){let P;if(w.isKeyField()){if(C==="array-contains"||C==="array-contains-any")throw new ct(Le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${C}' queries on documentId().`);if(C==="in"||C==="not-in"){$x(R,C);const ee=[];for(const re of R)ee.push(Jx(b,g,re));P={arrayValue:{values:ee}}}else P=Jx(b,g,R)}else C!=="in"&&C!=="not-in"&&C!=="array-contains-any"||$x(R,C),P=K4(T,x,R,C==="in"||C==="not-in");return Gr.create(w,C,P)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ar(s,e,t){const o=e,u=yf("where",s);return xf._create(u,o,t)}class em extends Jg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new em(e,t)}_parse(e){const t=this._queryConstraints.map((o=>o._parse(e))).filter((o=>o.getFilters().length>0));return t.length===1?t[0]:Ls.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(u,g){let x=u;const T=g.getFlattenedFilters();for(const b of T)q_(x,b),x=H1(x,b)})(e._query,t),new za(e.firestore,e.converter,H1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class tm extends $g{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new tm(e,t)}_apply(e){const t=(function(u,g,x){if(u.startAt!==null)throw new ct(Le.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(u.endAt!==null)throw new ct(Le.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ru(g,x)})(e._query,this._field,this._direction);return new za(e.firestore,e.converter,(function(u,g){const x=u.explicitOrderBy.concat([g]);return new _c(u.path,u.collectionGroup,x,u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)})(e._query,t))}}function Qx(s,e="asc"){const t=e,o=yf("orderBy",s);return tm._create(o,t)}class nm extends $g{constructor(e,t,o){super(),this.type=e,this._limit=t,this._limitType=o}static _create(e,t,o){return new nm(e,t,o)}_apply(e){return new za(e.firestore,e.converter,Dd(e._query,this._limit,this._limitType))}}function Zx(s){return nS("limit",s),nm._create("limit",s,"F")}function Jx(s,e,t){if(typeof(t=ir(t))=="string"){if(t==="")throw new ct(Le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Gw(e)&&t.indexOf("/")!==-1)throw new ct(Le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const o=e.path.child(ar.fromString(t));if(!Mt.isDocumentKey(o))throw new ct(Le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${o}' is not because it has an odd number of segments (${o.length}).`);return dx(s,new Mt(o))}if(t instanceof Dr)return dx(s,t._key);throw new ct(Le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$d(t)}.`)}function $x(s,e){if(!Array.isArray(s)||s.length===0)throw new ct(Le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function q_(s,e){const t=(function(u,g){for(const x of u)for(const T of x.getFlattenedFilters())if(g.indexOf(T.op)>=0)return T.op;return null})(s.filters,(function(u){switch(u){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ct(Le.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ct(Le.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Z4{convertValue(e,t="none"){switch(Lo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ko(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw qt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const o={};return Fo(e,((u,g)=>{o[u]=this.convertValue(g,t)})),o}convertVectorValue(e){const t=e.fields?.[Nd].arrayValue?.values?.map((o=>Vr(o.doubleValue)));return new $s(t)}convertGeoPoint(e){return new Js(Vr(e.latitude),Vr(e.longitude))}convertArray(e,t){return(e.values||[]).map((o=>this.convertValue(o,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const o=nf(e);return o==null?null:this.convertValue(o,t);case"estimate":return this.convertTimestamp(Cu(e));default:return null}}convertTimestamp(e){const t=Mo(e);return new Vn(t.seconds,t.nanos)}convertDocumentKey(e,t){const o=ar.fromString(e);qn(d_(o),9688,{name:e});const u=new Su(o.get(1),o.get(3)),g=new Mt(o.popFirst(5));return u.isEqual(t)||Va(`Document ${g} contains a document reference within a different database (${u.projectId}/${u.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),g}}function rm(s,e,t){let o;return o=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,o}class gu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cl extends H_{constructor(e,t,o,u,g,x){super(e,t,o,u,x),this._firestore=e,this._firestoreImpl=e,this.metadata=g}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new yd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const o=this._document.data.field(yf("DocumentSnapshot.get",e));if(o!==null)return this._userDataWriter.convertValue(o,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=cl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}cl._jsonSchemaVersion="firestore/documentSnapshot/1.0",cl._jsonSchema={type:qr("string",cl._jsonSchemaVersion),bundleSource:qr("string","DocumentSnapshot"),bundleName:qr("string"),bundle:qr("string")};class yd extends cl{data(e={}){return super.data(e)}}class ul{constructor(e,t,o,u){this._firestore=e,this._userDataWriter=t,this._snapshot=u,this.metadata=new gu(u.hasPendingWrites,u.fromCache),this.query=o}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((o=>{e.call(t,new yd(this._firestore,this._userDataWriter,o.key,o,new gu(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ct(Le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(u,g){if(u._snapshot.oldDocs.isEmpty()){let x=0;return u._snapshot.docChanges.map((T=>{const b=new yd(u._firestore,u._userDataWriter,T.doc.key,T.doc,new gu(u._snapshot.mutatedKeys.has(T.doc.key),u._snapshot.fromCache),u.query.converter);return T.doc,{type:"added",doc:b,oldIndex:-1,newIndex:x++}}))}{let x=u._snapshot.oldDocs;return u._snapshot.docChanges.filter((T=>g||T.type!==3)).map((T=>{const b=new yd(u._firestore,u._userDataWriter,T.doc.key,T.doc,new gu(u._snapshot.mutatedKeys.has(T.doc.key),u._snapshot.fromCache),u.query.converter);let w=-1,C=-1;return T.type!==0&&(w=x.indexOf(T.doc.key),x=x.delete(T.doc.key)),T.type!==1&&(x=x.add(T.doc),C=x.indexOf(T.doc.key)),{type:J4(T.type),doc:b,oldIndex:w,newIndex:C}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ul._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],o=[],u=[];return this.docs.forEach((g=>{g._document!==null&&(t.push(g._document),o.push(this._userDataWriter.convertObjectMap(g._document.data.value.mapValue.fields,"previous")),u.push(g.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function J4(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return qt(61501,{type:s})}}function Fa(s){s=Di(s,Dr);const e=Di(s.firestore,ta);return F4(Gu(e),s._key).then((t=>Y_(e,s,t)))}ul._jsonSchemaVersion="firestore/querySnapshot/1.0",ul._jsonSchema={type:qr("string",ul._jsonSchemaVersion),bundleSource:qr("string","QuerySnapshot"),bundleName:qr("string"),bundle:qr("string")};class im extends Z4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ts(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Dr(this.firestore,null,t)}}function dr(s){s=Di(s,za);const e=Di(s.firestore,ta),t=Gu(e),o=new im(e);return G_(s._query),j4(t,s._query).then((u=>new ul(e,o,s,u)))}function hl(s,e,t){s=Di(s,Dr);const o=Di(s.firestore,ta),u=rm(s.converter,e,t);return Ku(o,[Kg(Xu(o),"setDoc",s._key,u,s.converter!==null,t).toMutation(s._key,Mi.none())])}function bi(s,e,t,...o){s=Di(s,Dr);const u=Di(s.firestore,ta),g=Xu(u);let x;return x=typeof(e=ir(e))=="string"||e instanceof qu?U_(g,"updateDoc",s._key,e,t,o):V_(g,"updateDoc",s._key,e),Ku(u,[x.toMutation(s._key,Mi.exists(!0))])}function X_(s){return Ku(Di(s.firestore,ta),[new cf(s._key,Mi.none())])}function xd(s,e){const t=Di(s.firestore,ta),o=Cn(s),u=rm(s.converter,e);return Ku(t,[Kg(Xu(s.firestore),"addDoc",o._key,u,s.converter!==null,{}).toMutation(o._key,Mi.exists(!1))]).then((()=>o))}function eE(s,...e){s=ir(s);let t={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Wx(e[o])||(t=e[o++]);const u={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Wx(e[o])){const b=e[o];e[o]=b.next?.bind(b),e[o+1]=b.error?.bind(b),e[o+2]=b.complete?.bind(b)}let g,x,T;if(s instanceof Dr)x=Di(s.firestore,ta),T=rf(s._key.path),g={next:b=>{e[o]&&e[o](Y_(x,s,b))},error:e[o+1],complete:e[o+2]};else{const b=Di(s,za);x=Di(b.firestore,ta),T=b._query;const w=new im(x);g={next:C=>{e[o]&&e[o](new ul(x,w,b,C))},error:e[o+1],complete:e[o+2]},G_(s._query)}return(function(w,C,R,P){const L=new Xg(P),ee=new Hg(C,L,R);return w.asyncQueue.enqueueAndForget((async()=>Fg(await Vd(w),ee))),()=>{L.Nu(),w.asyncQueue.enqueueAndForget((async()=>jg(await Vd(w),ee)))}})(Gu(x),T,u,g)}function Ku(s,e){return(function(o,u){const g=new ka;return o.asyncQueue.enqueueAndForget((async()=>I4(await U4(o),u,g))),g.promise})(Gu(s),e)}function Y_(s,e,t){const o=t.docs.get(e._key),u=new im(s);return new cl(s,u,e._key,o,new gu(t.hasPendingWrites,t.fromCache),e.converter)}class $4{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,t,o){this._verifyNotCommitted();const u=v1(e,this._firestore),g=rm(u.converter,t,o),x=Kg(this._dataReader,"WriteBatch.set",u._key,g,u.converter!==null,o);return this._mutations.push(x.toMutation(u._key,Mi.none())),this}update(e,t,o,...u){this._verifyNotCommitted();const g=v1(e,this._firestore);let x;return x=typeof(t=ir(t))=="string"||t instanceof qu?U_(this._dataReader,"WriteBatch.update",g._key,t,o,u):V_(this._dataReader,"WriteBatch.update",g._key,t),this._mutations.push(x.toMutation(g._key,Mi.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=v1(e,this._firestore);return this._mutations=this._mutations.concat(new cf(t._key,Mi.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ct(Le.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function v1(s,e){if((s=ir(s)).firestore!==e)throw new ct(Le.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function Ed(){return new Wg("serverTimestamp")}function au(s){return Gu(s=Di(s,ta)),new $4(s,(e=>Ku(s,e)))}(function(e,t=!0){(function(u){xc=u})(yc),fl(new Oo("firestore",((o,{instanceIdentifier:u,options:g})=>{const x=o.getProvider("app").getImmediate(),T=new ta(new Y3(o.getProvider("auth-internal")),new Q3(x,o.getProvider("app-check-internal")),(function(w,C){if(!Object.prototype.hasOwnProperty.apply(w.options,["projectId"]))throw new ct(Le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Su(w.options.projectId,C)})(x,u),x);return g={useFetchStreams:t,...g},T._setSettings(g),T}),"PUBLIC").setMultipleInstances(!0)),Ys($2,ex,e),Ys($2,ex,"esm2020")})();const K_={apiKey:"AIzaSyARwb6K0M4l-hWKi8FrOLEVqRqeHRf8JR4",authDomain:"oppmoteboka.firebaseapp.com",projectId:"oppmoteboka",storageBucket:"oppmoteboka.firebasestorage.app",messagingSenderId:"732911922070",appId:"1:732911922070:web:b16d9de65062395c018bb7"},W_=DE().length?Wd():ug(K_),Co=yw(W_),pt=H4(W_),e8=DE().find(s=>s.name==="secondary")??ug(K_,"secondary"),T1=yw(e8);function bc(){const[s,e]=oe.useState(null),[t,o]=oe.useState(!0);return oe.useEffect(()=>{const T=DC(Co,async b=>{if(!b){e(null),o(!1);return}try{const w=Cn(pt,"users",b.uid);let C=await Fa(w);if(!C.exists()){const ee={uid:b.uid,email:b.email??"",displayName:b.displayName??b.email??"",role:"student",term:null,termLabel:null,semesterStatus:"aktiv"};await hl(w,{...ee,createdAt:Ed()}),e(ee),o(!1);return}const R=C.data();let P=R?.email??b.email??"";if(b.email&&R?.email!==b.email)try{await bi(w,{email:b.email}),P=b.email}catch(ee){console.warn("Kunne ikke synkronisere epost til Firestore:",ee)}const L={uid:b.uid,email:P,role:R?.role??"student",term:R?.term??null,termLabel:R?.termLabel??null,semesterStatus:R?.semesterStatus??null,displayName:R?.name??R?.displayName??b.displayName??b.email??""};e(L)}catch(w){console.error("Feil ved henting/oppretting av bruker:",w),e(null)}finally{o(!1)}});return()=>T()},[]),{user:s,loading:t,login:async(T,b)=>{await SC(Co,T,b)},register:async(T,b)=>{await cd(Co,T,b)},logout:async()=>{await MC(Co)}}}var t8=AE();const n8=Xd(t8);var r8=s=>{switch(s){case"success":return a8;case"info":return l8;case"warning":return o8;case"error":return c8;default:return null}},i8=Array(12).fill(0),s8=({visible:s,className:e})=>Qe.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":s},Qe.createElement("div",{className:"sonner-spinner"},i8.map((t,o)=>Qe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${o}`})))),a8=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),o8=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),l8=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),c8=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Qe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),u8=Qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Qe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Qe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),h8=()=>{let[s,e]=Qe.useState(document.hidden);return Qe.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),s},eg=1,d8=class{constructor(){this.subscribe=s=>(this.subscribers.push(s),()=>{let e=this.subscribers.indexOf(s);this.subscribers.splice(e,1)}),this.publish=s=>{this.subscribers.forEach(e=>e(s))},this.addToast=s=>{this.publish(s),this.toasts=[...this.toasts,s]},this.create=s=>{var e;let{message:t,...o}=s,u=typeof s?.id=="number"||((e=s.id)==null?void 0:e.length)>0?s.id:eg++,g=this.toasts.find(T=>T.id===u),x=s.dismissible===void 0?!0:s.dismissible;return this.dismissedToasts.has(u)&&this.dismissedToasts.delete(u),g?this.toasts=this.toasts.map(T=>T.id===u?(this.publish({...T,...s,id:u,title:t}),{...T,...s,id:u,dismissible:x,title:t}):T):this.addToast({title:t,...o,dismissible:x,id:u}),u},this.dismiss=s=>(this.dismissedToasts.add(s),s||this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:s,dismiss:!0})),s),this.message=(s,e)=>this.create({...e,message:s}),this.error=(s,e)=>this.create({...e,message:s,type:"error"}),this.success=(s,e)=>this.create({...e,type:"success",message:s}),this.info=(s,e)=>this.create({...e,type:"info",message:s}),this.warning=(s,e)=>this.create({...e,type:"warning",message:s}),this.loading=(s,e)=>this.create({...e,type:"loading",message:s}),this.promise=(s,e)=>{if(!e)return;let t;e.loading!==void 0&&(t=this.create({...e,promise:s,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let o=s instanceof Promise?s:s(),u=t!==void 0,g,x=o.then(async b=>{if(g=["resolve",b],Qe.isValidElement(b))u=!1,this.create({id:t,type:"default",message:b});else if(g8(b)&&!b.ok){u=!1;let w=typeof e.error=="function"?await e.error(`HTTP error! status: ${b.status}`):e.error,C=typeof e.description=="function"?await e.description(`HTTP error! status: ${b.status}`):e.description;this.create({id:t,type:"error",message:w,description:C})}else if(e.success!==void 0){u=!1;let w=typeof e.success=="function"?await e.success(b):e.success,C=typeof e.description=="function"?await e.description(b):e.description;this.create({id:t,type:"success",message:w,description:C})}}).catch(async b=>{if(g=["reject",b],e.error!==void 0){u=!1;let w=typeof e.error=="function"?await e.error(b):e.error,C=typeof e.description=="function"?await e.description(b):e.description;this.create({id:t,type:"error",message:w,description:C})}}).finally(()=>{var b;u&&(this.dismiss(t),t=void 0),(b=e.finally)==null||b.call(e)}),T=()=>new Promise((b,w)=>x.then(()=>g[0]==="reject"?w(g[1]):b(g[1])).catch(w));return typeof t!="string"&&typeof t!="number"?{unwrap:T}:Object.assign(t,{unwrap:T})},this.custom=(s,e)=>{let t=e?.id||eg++;return this.create({jsx:s(t),id:t,...e}),t},this.getActiveToasts=()=>this.toasts.filter(s=>!this.dismissedToasts.has(s.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Xi=new d8,f8=(s,e)=>{let t=e?.id||eg++;return Xi.addToast({title:s,...e,id:t}),t},g8=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",m8=f8,p8=()=>Xi.toasts,y8=()=>Xi.getActiveToasts(),Ct=Object.assign(m8,{success:Xi.success,info:Xi.info,warning:Xi.warning,error:Xi.error,custom:Xi.custom,message:Xi.message,promise:Xi.promise,dismiss:Xi.dismiss,loading:Xi.loading},{getHistory:p8,getToasts:y8});function x8(s,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",e==="top"&&t.firstChild?t.insertBefore(o,t.firstChild):t.appendChild(o),o.styleSheet?o.styleSheet.cssText=s:o.appendChild(document.createTextNode(s))}x8(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ad(s){return s.label!==void 0}var E8=3,w8="32px",_8="16px",tE=4e3,A8=356,b8=14,v8=20,T8=200;function Ds(...s){return s.filter(Boolean).join(" ")}function C8(s){let[e,t]=s.split("-"),o=[];return e&&o.push(e),t&&o.push(t),o}var S8=s=>{var e,t,o,u,g,x,T,b,w,C,R;let{invert:P,toast:L,unstyled:ee,interacting:re,setHeights:se,visibleToasts:Ye,heights:Oe,index:le,toasts:Ue,expanded:dt,removeToast:Ze,defaultRichColors:F,closeButton:z,style:U,cancelButtonStyle:J,actionButtonStyle:X,className:Y="",descriptionClassName:G="",duration:at,position:ce,gap:ue,loadingIcon:Ee,expandByDefault:We,classNames:qe,icons:ot,closeButtonAriaLabel:Q="Close toast",pauseWhenPageIsHidden:$}=s,[pe,Te]=Qe.useState(null),[nt,ve]=Qe.useState(null),[st,xt]=Qe.useState(!1),[kt,cn]=Qe.useState(!1),[en,En]=Qe.useState(!1),[Lt,hn]=Qe.useState(!1),[wn,De]=Qe.useState(!1),[ge,Re]=Qe.useState(0),[Fe,ke]=Qe.useState(0),be=Qe.useRef(L.duration||at||tE),Pt=Qe.useRef(null),vt=Qe.useRef(null),Rt=le===0,Fn=le+1<=Ye,Xt=L.type,yr=L.dismissible!==!1,xr=L.className||"",or=L.descriptionClassName||"",Zr=Qe.useMemo(()=>Oe.findIndex(ut=>ut.toastId===L.id)||0,[Oe,L.id]),Ti=Qe.useMemo(()=>{var ut;return(ut=L.closeButton)!=null?ut:z},[L.closeButton,z]),ki=Qe.useMemo(()=>L.duration||at||tE,[L.duration,at]),tn=Qe.useRef(0),ze=Qe.useRef(0),zt=Qe.useRef(0),wt=Qe.useRef(null),[_n,vr]=ce.split("-"),Xr=Qe.useMemo(()=>Oe.reduce((ut,nn,ie)=>ie>=Zr?ut:ut+nn.height,0),[Oe,Zr]),Tr=h8(),Bt=L.invert||P,Qt=Xt==="loading";ze.current=Qe.useMemo(()=>Zr*ue+Xr,[Zr,Xr]),Qe.useEffect(()=>{be.current=ki},[ki]),Qe.useEffect(()=>{xt(!0)},[]),Qe.useEffect(()=>{let ut=vt.current;if(ut){let nn=ut.getBoundingClientRect().height;return ke(nn),se(ie=>[{toastId:L.id,height:nn,position:L.position},...ie]),()=>se(ie=>ie.filter(Ie=>Ie.toastId!==L.id))}},[se,L.id]),Qe.useLayoutEffect(()=>{if(!st)return;let ut=vt.current,nn=ut.style.height;ut.style.height="auto";let ie=ut.getBoundingClientRect().height;ut.style.height=nn,ke(ie),se(Ie=>Ie.find(He=>He.toastId===L.id)?Ie.map(He=>He.toastId===L.id?{...He,height:ie}:He):[{toastId:L.id,height:ie,position:L.position},...Ie])},[st,L.title,L.description,se,L.id]);let jn=Qe.useCallback(()=>{cn(!0),Re(ze.current),se(ut=>ut.filter(nn=>nn.toastId!==L.id)),setTimeout(()=>{Ze(L)},T8)},[L,Ze,se,ze]);Qe.useEffect(()=>{if(L.promise&&Xt==="loading"||L.duration===1/0||L.type==="loading")return;let ut;return dt||re||$&&Tr?(()=>{if(zt.current<tn.current){let nn=new Date().getTime()-tn.current;be.current=be.current-nn}zt.current=new Date().getTime()})():be.current!==1/0&&(tn.current=new Date().getTime(),ut=setTimeout(()=>{var nn;(nn=L.onAutoClose)==null||nn.call(L,L),jn()},be.current)),()=>clearTimeout(ut)},[dt,re,L,Xt,$,Tr,jn]),Qe.useEffect(()=>{L.delete&&jn()},[jn,L.delete]);function Mr(){var ut,nn,ie;return ot!=null&&ot.loading?Qe.createElement("div",{className:Ds(qe?.loader,(ut=L?.classNames)==null?void 0:ut.loader,"sonner-loader"),"data-visible":Xt==="loading"},ot.loading):Ee?Qe.createElement("div",{className:Ds(qe?.loader,(nn=L?.classNames)==null?void 0:nn.loader,"sonner-loader"),"data-visible":Xt==="loading"},Ee):Qe.createElement(s8,{className:Ds(qe?.loader,(ie=L?.classNames)==null?void 0:ie.loader),visible:Xt==="loading"})}return Qe.createElement("li",{tabIndex:0,ref:vt,className:Ds(Y,xr,qe?.toast,(e=L?.classNames)==null?void 0:e.toast,qe?.default,qe?.[Xt],(t=L?.classNames)==null?void 0:t[Xt]),"data-sonner-toast":"","data-rich-colors":(o=L.richColors)!=null?o:F,"data-styled":!(L.jsx||L.unstyled||ee),"data-mounted":st,"data-promise":!!L.promise,"data-swiped":wn,"data-removed":kt,"data-visible":Fn,"data-y-position":_n,"data-x-position":vr,"data-index":le,"data-front":Rt,"data-swiping":en,"data-dismissible":yr,"data-type":Xt,"data-invert":Bt,"data-swipe-out":Lt,"data-swipe-direction":nt,"data-expanded":!!(dt||We&&st),style:{"--index":le,"--toasts-before":le,"--z-index":Ue.length-le,"--offset":`${kt?ge:ze.current}px`,"--initial-height":We?"auto":`${Fe}px`,...U,...L.style},onDragEnd:()=>{En(!1),Te(null),wt.current=null},onPointerDown:ut=>{Qt||!yr||(Pt.current=new Date,Re(ze.current),ut.target.setPointerCapture(ut.pointerId),ut.target.tagName!=="BUTTON"&&(En(!0),wt.current={x:ut.clientX,y:ut.clientY}))},onPointerUp:()=>{var ut,nn,ie,Ie;if(Lt||!yr)return;wt.current=null;let He=Number(((ut=vt.current)==null?void 0:ut.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Xe=Number(((nn=vt.current)==null?void 0:nn.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),rt=new Date().getTime()-((ie=Pt.current)==null?void 0:ie.getTime()),ft=pe==="x"?He:Xe,it=Math.abs(ft)/rt;if(Math.abs(ft)>=v8||it>.11){Re(ze.current),(Ie=L.onDismiss)==null||Ie.call(L,L),ve(pe==="x"?He>0?"right":"left":Xe>0?"down":"up"),jn(),hn(!0),De(!1);return}En(!1),Te(null)},onPointerMove:ut=>{var nn,ie,Ie,He;if(!wt.current||!yr||((nn=window.getSelection())==null?void 0:nn.toString().length)>0)return;let Xe=ut.clientY-wt.current.y,rt=ut.clientX-wt.current.x,ft=(ie=s.swipeDirections)!=null?ie:C8(ce);!pe&&(Math.abs(rt)>1||Math.abs(Xe)>1)&&Te(Math.abs(rt)>Math.abs(Xe)?"x":"y");let it={x:0,y:0};pe==="y"?(ft.includes("top")||ft.includes("bottom"))&&(ft.includes("top")&&Xe<0||ft.includes("bottom")&&Xe>0)&&(it.y=Xe):pe==="x"&&(ft.includes("left")||ft.includes("right"))&&(ft.includes("left")&&rt<0||ft.includes("right")&&rt>0)&&(it.x=rt),(Math.abs(it.x)>0||Math.abs(it.y)>0)&&De(!0),(Ie=vt.current)==null||Ie.style.setProperty("--swipe-amount-x",`${it.x}px`),(He=vt.current)==null||He.style.setProperty("--swipe-amount-y",`${it.y}px`)}},Ti&&!L.jsx?Qe.createElement("button",{"aria-label":Q,"data-disabled":Qt,"data-close-button":!0,onClick:Qt||!yr?()=>{}:()=>{var ut;jn(),(ut=L.onDismiss)==null||ut.call(L,L)},className:Ds(qe?.closeButton,(u=L?.classNames)==null?void 0:u.closeButton)},(g=ot?.close)!=null?g:u8):null,L.jsx||oe.isValidElement(L.title)?L.jsx?L.jsx:typeof L.title=="function"?L.title():L.title:Qe.createElement(Qe.Fragment,null,Xt||L.icon||L.promise?Qe.createElement("div",{"data-icon":"",className:Ds(qe?.icon,(x=L?.classNames)==null?void 0:x.icon)},L.promise||L.type==="loading"&&!L.icon?L.icon||Mr():null,L.type!=="loading"?L.icon||ot?.[Xt]||r8(Xt):null):null,Qe.createElement("div",{"data-content":"",className:Ds(qe?.content,(T=L?.classNames)==null?void 0:T.content)},Qe.createElement("div",{"data-title":"",className:Ds(qe?.title,(b=L?.classNames)==null?void 0:b.title)},typeof L.title=="function"?L.title():L.title),L.description?Qe.createElement("div",{"data-description":"",className:Ds(G,or,qe?.description,(w=L?.classNames)==null?void 0:w.description)},typeof L.description=="function"?L.description():L.description):null),oe.isValidElement(L.cancel)?L.cancel:L.cancel&&ad(L.cancel)?Qe.createElement("button",{"data-button":!0,"data-cancel":!0,style:L.cancelButtonStyle||J,onClick:ut=>{var nn,ie;ad(L.cancel)&&yr&&((ie=(nn=L.cancel).onClick)==null||ie.call(nn,ut),jn())},className:Ds(qe?.cancelButton,(C=L?.classNames)==null?void 0:C.cancelButton)},L.cancel.label):null,oe.isValidElement(L.action)?L.action:L.action&&ad(L.action)?Qe.createElement("button",{"data-button":!0,"data-action":!0,style:L.actionButtonStyle||X,onClick:ut=>{var nn,ie;ad(L.action)&&((ie=(nn=L.action).onClick)==null||ie.call(nn,ut),!ut.defaultPrevented&&jn())},className:Ds(qe?.actionButton,(R=L?.classNames)==null?void 0:R.actionButton)},L.action.label):null))};function nE(){if(typeof window>"u"||typeof document>"u")return"ltr";let s=document.documentElement.getAttribute("dir");return s==="auto"||!s?window.getComputedStyle(document.documentElement).direction:s}function I8(s,e){let t={};return[s,e].forEach((o,u)=>{let g=u===1,x=g?"--mobile-offset":"--offset",T=g?_8:w8;function b(w){["top","right","bottom","left"].forEach(C=>{t[`${x}-${C}`]=typeof w=="number"?`${w}px`:w})}typeof o=="number"||typeof o=="string"?b(o):typeof o=="object"?["top","right","bottom","left"].forEach(w=>{o[w]===void 0?t[`${x}-${w}`]=T:t[`${x}-${w}`]=typeof o[w]=="number"?`${o[w]}px`:o[w]}):b(T)}),t}var R8=oe.forwardRef(function(s,e){let{invert:t,position:o="bottom-right",hotkey:u=["altKey","KeyT"],expand:g,closeButton:x,className:T,offset:b,mobileOffset:w,theme:C="light",richColors:R,duration:P,style:L,visibleToasts:ee=E8,toastOptions:re,dir:se=nE(),gap:Ye=b8,loadingIcon:Oe,icons:le,containerAriaLabel:Ue="Notifications",pauseWhenPageIsHidden:dt}=s,[Ze,F]=Qe.useState([]),z=Qe.useMemo(()=>Array.from(new Set([o].concat(Ze.filter($=>$.position).map($=>$.position)))),[Ze,o]),[U,J]=Qe.useState([]),[X,Y]=Qe.useState(!1),[G,at]=Qe.useState(!1),[ce,ue]=Qe.useState(C!=="system"?C:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Ee=Qe.useRef(null),We=u.join("+").replace(/Key/g,"").replace(/Digit/g,""),qe=Qe.useRef(null),ot=Qe.useRef(!1),Q=Qe.useCallback($=>{F(pe=>{var Te;return(Te=pe.find(nt=>nt.id===$.id))!=null&&Te.delete||Xi.dismiss($.id),pe.filter(({id:nt})=>nt!==$.id)})},[]);return Qe.useEffect(()=>Xi.subscribe($=>{if($.dismiss){F(pe=>pe.map(Te=>Te.id===$.id?{...Te,delete:!0}:Te));return}setTimeout(()=>{n8.flushSync(()=>{F(pe=>{let Te=pe.findIndex(nt=>nt.id===$.id);return Te!==-1?[...pe.slice(0,Te),{...pe[Te],...$},...pe.slice(Te+1)]:[$,...pe]})})})}),[]),Qe.useEffect(()=>{if(C!=="system"){ue(C);return}if(C==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ue("dark"):ue("light")),typeof window>"u")return;let $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:pe})=>{ue(pe?"dark":"light")})}catch{$.addListener(({matches:Te})=>{try{ue(Te?"dark":"light")}catch(nt){console.error(nt)}})}},[C]),Qe.useEffect(()=>{Ze.length<=1&&Y(!1)},[Ze]),Qe.useEffect(()=>{let $=pe=>{var Te,nt;u.every(ve=>pe[ve]||pe.code===ve)&&(Y(!0),(Te=Ee.current)==null||Te.focus()),pe.code==="Escape"&&(document.activeElement===Ee.current||(nt=Ee.current)!=null&&nt.contains(document.activeElement))&&Y(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[u]),Qe.useEffect(()=>{if(Ee.current)return()=>{qe.current&&(qe.current.focus({preventScroll:!0}),qe.current=null,ot.current=!1)}},[Ee.current]),Qe.createElement("section",{ref:e,"aria-label":`${Ue} ${We}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},z.map(($,pe)=>{var Te;let[nt,ve]=$.split("-");return Ze.length?Qe.createElement("ol",{key:$,dir:se==="auto"?nE():se,tabIndex:-1,ref:Ee,className:T,"data-sonner-toaster":!0,"data-theme":ce,"data-y-position":nt,"data-lifted":X&&Ze.length>1&&!g,"data-x-position":ve,style:{"--front-toast-height":`${((Te=U[0])==null?void 0:Te.height)||0}px`,"--width":`${A8}px`,"--gap":`${Ye}px`,...L,...I8(b,w)},onBlur:st=>{ot.current&&!st.currentTarget.contains(st.relatedTarget)&&(ot.current=!1,qe.current&&(qe.current.focus({preventScroll:!0}),qe.current=null))},onFocus:st=>{st.target instanceof HTMLElement&&st.target.dataset.dismissible==="false"||ot.current||(ot.current=!0,qe.current=st.relatedTarget)},onMouseEnter:()=>Y(!0),onMouseMove:()=>Y(!0),onMouseLeave:()=>{G||Y(!1)},onDragEnd:()=>Y(!1),onPointerDown:st=>{st.target instanceof HTMLElement&&st.target.dataset.dismissible==="false"||at(!0)},onPointerUp:()=>at(!1)},Ze.filter(st=>!st.position&&pe===0||st.position===$).map((st,xt)=>{var kt,cn;return Qe.createElement(S8,{key:st.id,icons:le,index:xt,toast:st,defaultRichColors:R,duration:(kt=re?.duration)!=null?kt:P,className:re?.className,descriptionClassName:re?.descriptionClassName,invert:t,visibleToasts:ee,closeButton:(cn=re?.closeButton)!=null?cn:x,interacting:G,position:$,style:re?.style,unstyled:re?.unstyled,classNames:re?.classNames,cancelButtonStyle:re?.cancelButtonStyle,actionButtonStyle:re?.actionButtonStyle,removeToast:Q,toasts:Ze.filter(en=>en.position==st.position),heights:U.filter(en=>en.position==st.position),setHeights:J,expandByDefault:g,gap:Ye,loadingIcon:Oe,expanded:X,pauseWhenPageIsHidden:dt,swipeDirections:s.swipeDirections})})):null}))}),Et;(function(s){s[s.QR_CODE=0]="QR_CODE",s[s.AZTEC=1]="AZTEC",s[s.CODABAR=2]="CODABAR",s[s.CODE_39=3]="CODE_39",s[s.CODE_93=4]="CODE_93",s[s.CODE_128=5]="CODE_128",s[s.DATA_MATRIX=6]="DATA_MATRIX",s[s.MAXICODE=7]="MAXICODE",s[s.ITF=8]="ITF",s[s.EAN_13=9]="EAN_13",s[s.EAN_8=10]="EAN_8",s[s.PDF_417=11]="PDF_417",s[s.RSS_14=12]="RSS_14",s[s.RSS_EXPANDED=13]="RSS_EXPANDED",s[s.UPC_A=14]="UPC_A",s[s.UPC_E=15]="UPC_E",s[s.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Et||(Et={}));var rE=new Map([[Et.QR_CODE,"QR_CODE"],[Et.AZTEC,"AZTEC"],[Et.CODABAR,"CODABAR"],[Et.CODE_39,"CODE_39"],[Et.CODE_93,"CODE_93"],[Et.CODE_128,"CODE_128"],[Et.DATA_MATRIX,"DATA_MATRIX"],[Et.MAXICODE,"MAXICODE"],[Et.ITF,"ITF"],[Et.EAN_13,"EAN_13"],[Et.EAN_8,"EAN_8"],[Et.PDF_417,"PDF_417"],[Et.RSS_14,"RSS_14"],[Et.RSS_EXPANDED,"RSS_EXPANDED"],[Et.UPC_A,"UPC_A"],[Et.UPC_E,"UPC_E"],[Et.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),iE;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.URL=1]="URL"})(iE||(iE={}));function N8(s){return Object.values(Et).includes(s)}var Fd;(function(s){s[s.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",s[s.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Fd||(Fd={}));var O8=(function(){function s(){}return s.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",s.SCAN_DEFAULT_FPS=2,s.DEFAULT_DISABLE_FLIP=!1,s.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,s.DEFAULT_SUPPORTED_SCAN_TYPE=[Fd.SCAN_TYPE_CAMERA,Fd.SCAN_TYPE_FILE],s})(),Q_=(function(){function s(e,t){this.format=e,this.formatName=t}return s.prototype.toString=function(){return this.formatName},s.create=function(e){if(!rE.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new s(e,rE.get(e))},s})(),sE=(function(){function s(){}return s.createFromText=function(e){var t={text:e};return{decodedText:e,result:t}},s.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},s})(),tg;(function(s){s[s.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",s[s.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",s[s.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(tg||(tg={}));var D8=(function(){function s(){}return s.createFrom=function(e){return{errorMessage:e,type:tg.UNKWOWN_ERROR}},s})(),M8=(function(){function s(e){this.verbose=e}return s.prototype.log=function(e){this.verbose&&console.log(e)},s.prototype.warn=function(e){this.verbose&&console.warn(e)},s.prototype.logError=function(e,t){(this.verbose||t===!0)&&console.error(e)},s.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},s})();function Na(s){return typeof s>"u"||s===null}var nc=(function(){function s(){}return s.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},s.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},s.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},s.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},s.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},s.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},s.scannerPaused=function(){return"Scanner paused"},s})(),Z_=(function(){function s(){}return s.isMediaStreamConstraintsValid=function(e,t){if(typeof e!="object"){var o=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(o,"."),!0),!1}for(var u=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],g=new Set(u),x=Object.keys(e),T=0,b=x;T<b.length;T++){var w=b[T];if(g.has(w))return t.logError("".concat(w," is not supported videoConstaints."),!0),!1}return!0},s})(),mu={exports:{}},k8=mu.exports,aE;function L8(){return aE||(aE=1,(function(s,e){(function(t,o){o(e)})(k8,(function(t){function o(M){return M==null}var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,r){M.__proto__=r}||function(M,r){for(var a in r)r.hasOwnProperty(a)&&(M[a]=r[a])};function g(M,r){u(M,r);function a(){this.constructor=M}M.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}function x(M,r){var a=Object.setPrototypeOf;a?a(M,r):M.__proto__=r}function T(M,r){r===void 0&&(r=M.constructor);var a=Error.captureStackTrace;a&&a(M,r)}var b=(function(M){g(r,M);function r(a){var l=this.constructor,h=M.call(this,a)||this;return Object.defineProperty(h,"name",{value:l.name,enumerable:!1}),x(h,l.prototype),T(h),h}return r})(Error);class w extends b{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}w.kind="Exception";class C extends w{}C.kind="ArgumentException";class R extends w{}R.kind="IllegalArgumentException";class P{constructor(r){if(this.binarizer=r,r===null)throw new R("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,a){return this.binarizer.getBlackRow(r,a)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,a,l,h){const d=this.binarizer.getLuminanceSource().crop(r,a,l,h);return new P(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new P(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new P(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class L extends w{static getChecksumInstance(){return new L}}L.kind="ChecksumException";class ee{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class re{static arraycopy(r,a,l,h,d){for(;d--;)l[h++]=r[a++]}static currentTimeMillis(){return Date.now()}}class se extends w{}se.kind="IndexOutOfBoundsException";class Ye extends se{constructor(r=void 0,a=void 0){super(a),this.index=r,this.message=a}}Ye.kind="ArrayIndexOutOfBoundsException";class Oe{static fill(r,a){for(let l=0,h=r.length;l<h;l++)r[l]=a}static fillWithin(r,a,l,h){Oe.rangeCheck(r.length,a,l);for(let d=a;d<l;d++)r[d]=h}static rangeCheck(r,a,l){if(a>l)throw new R("fromIndex("+a+") > toIndex("+l+")");if(a<0)throw new Ye(a);if(l>r)throw new Ye(l)}static asList(...r){return r}static create(r,a,l){return Array.from({length:r}).map(d=>Array.from({length:a}).fill(l))}static createInt32Array(r,a,l){return Array.from({length:r}).map(d=>Int32Array.from({length:a}).fill(l))}static equals(r,a){if(!r||!a||!r.length||!a.length||r.length!==a.length)return!1;for(let l=0,h=r.length;l<h;l++)if(r[l]!==a[l])return!1;return!0}static hashCode(r){if(r===null)return 0;let a=1;for(const l of r)a=31*a+l;return a}static fillUint8Array(r,a){for(let l=0;l!==r.length;l++)r[l]=a}static copyOf(r,a){return r.slice(0,a)}static copyOfUint8Array(r,a){if(r.length<=a){const l=new Uint8Array(a);return l.set(r),l}return r.slice(0,a)}static copyOfRange(r,a,l){const h=l-a,d=new Int32Array(h);return re.arraycopy(r,a,d,0,h),d}static binarySearch(r,a,l){l===void 0&&(l=Oe.numberComparator);let h=0,d=r.length-1;for(;h<=d;){const m=d+h>>1,y=l(a,r[m]);if(y>0)h=m+1;else if(y<0)d=m-1;else return m}return-h-1}static numberComparator(r,a){return r-a}}class le{static numberOfTrailingZeros(r){let a;if(r===0)return 32;let l=31;return a=r<<16,a!==0&&(l-=16,r=a),a=r<<8,a!==0&&(l-=8,r=a),a=r<<4,a!==0&&(l-=4,r=a),a=r<<2,a!==0&&(l-=2,r=a),l-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let a=1;return r>>>16||(a+=16,r<<=16),r>>>24||(a+=8,r<<=8),r>>>28||(a+=4,r<<=4),r>>>30||(a+=2,r<<=2),a-=r>>>31,a}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,a){return Math.trunc(r/a)}static parseInt(r,a=void 0){return parseInt(r,a)}}le.MIN_VALUE_32_BITS=-2147483648,le.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ue{constructor(r,a){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,a==null?this.bits=Ue.makeArray(r):this.bits=a)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const a=Ue.makeArray(r);re.arraycopy(this.bits,0,a,0,this.bits.length),this.bits=a}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const a=this.size;if(r>=a)return a;const l=this.bits;let h=Math.floor(r/32),d=l[h];d&=~((1<<(r&31))-1);const m=l.length;for(;d===0;){if(++h===m)return a;d=l[h]}const y=h*32+le.numberOfTrailingZeros(d);return y>a?a:y}getNextUnset(r){const a=this.size;if(r>=a)return a;const l=this.bits;let h=Math.floor(r/32),d=~l[h];d&=~((1<<(r&31))-1);const m=l.length;for(;d===0;){if(++h===m)return a;d=~l[h]}const y=h*32+le.numberOfTrailingZeros(d);return y>a?a:y}setBulk(r,a){this.bits[Math.floor(r/32)]=a}setRange(r,a){if(a<r||r<0||a>this.size)throw new R;if(a===r)return;a--;const l=Math.floor(r/32),h=Math.floor(a/32),d=this.bits;for(let m=l;m<=h;m++){const y=m>l?0:r&31,v=(2<<(m<h?31:a&31))-(1<<y);d[m]|=v}}clear(){const r=this.bits.length,a=this.bits;for(let l=0;l<r;l++)a[l]=0}isRange(r,a,l){if(a<r||r<0||a>this.size)throw new R;if(a===r)return!0;a--;const h=Math.floor(r/32),d=Math.floor(a/32),m=this.bits;for(let y=h;y<=d;y++){const _=y>h?0:r&31,N=(2<<(y<d?31:a&31))-(1<<_)&4294967295;if((m[y]&N)!==(l?N:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,a){if(a<0||a>32)throw new R("Num bits must be between 0 and 32");this.ensureCapacity(this.size+a);for(let l=a;l>0;l--)this.appendBit((r>>l-1&1)===1)}appendBitArray(r){const a=r.size;this.ensureCapacity(this.size+a);for(let l=0;l<a;l++)this.appendBit(r.get(l))}xor(r){if(this.size!==r.size)throw new R("Sizes don't match");const a=this.bits;for(let l=0,h=a.length;l<h;l++)a[l]^=r.bits[l]}toBytes(r,a,l,h){for(let d=0;d<h;d++){let m=0;for(let y=0;y<8;y++)this.get(r)&&(m|=1<<7-y),r++;a[l+d]=m}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),a=Math.floor((this.size-1)/32),l=a+1,h=this.bits;for(let d=0;d<l;d++){let m=h[d];m=m>>1&1431655765|(m&1431655765)<<1,m=m>>2&858993459|(m&858993459)<<2,m=m>>4&252645135|(m&252645135)<<4,m=m>>8&16711935|(m&16711935)<<8,m=m>>16&65535|(m&65535)<<16,r[a-d]=m}if(this.size!==l*32){const d=l*32-this.size;let m=r[0]>>>d;for(let y=1;y<l;y++){const _=r[y];m|=_<<32-d,r[y-1]=m,m=_>>>d}r[l-1]=m}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof Ue))return!1;const a=r;return this.size===a.size&&Oe.equals(this.bits,a.bits)}hashCode(){return 31*this.size+Oe.hashCode(this.bits)}toString(){let r="";for(let a=0,l=this.size;a<l;a++)(a&7)===0&&(r+=" "),r+=this.get(a)?"X":".";return r}clone(){return new Ue(this.size,this.bits.slice())}}var dt;(function(M){M[M.OTHER=0]="OTHER",M[M.PURE_BARCODE=1]="PURE_BARCODE",M[M.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",M[M.TRY_HARDER=3]="TRY_HARDER",M[M.CHARACTER_SET=4]="CHARACTER_SET",M[M.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",M[M.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",M[M.ASSUME_GS1=7]="ASSUME_GS1",M[M.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",M[M.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",M[M.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(dt||(dt={}));var Ze=dt;class F extends w{static getFormatInstance(){return new F}}F.kind="FormatException";var z;(function(M){M[M.Cp437=0]="Cp437",M[M.ISO8859_1=1]="ISO8859_1",M[M.ISO8859_2=2]="ISO8859_2",M[M.ISO8859_3=3]="ISO8859_3",M[M.ISO8859_4=4]="ISO8859_4",M[M.ISO8859_5=5]="ISO8859_5",M[M.ISO8859_6=6]="ISO8859_6",M[M.ISO8859_7=7]="ISO8859_7",M[M.ISO8859_8=8]="ISO8859_8",M[M.ISO8859_9=9]="ISO8859_9",M[M.ISO8859_10=10]="ISO8859_10",M[M.ISO8859_11=11]="ISO8859_11",M[M.ISO8859_13=12]="ISO8859_13",M[M.ISO8859_14=13]="ISO8859_14",M[M.ISO8859_15=14]="ISO8859_15",M[M.ISO8859_16=15]="ISO8859_16",M[M.SJIS=16]="SJIS",M[M.Cp1250=17]="Cp1250",M[M.Cp1251=18]="Cp1251",M[M.Cp1252=19]="Cp1252",M[M.Cp1256=20]="Cp1256",M[M.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",M[M.UTF8=22]="UTF8",M[M.ASCII=23]="ASCII",M[M.Big5=24]="Big5",M[M.GB18030=25]="GB18030",M[M.EUC_KR=26]="EUC_KR"})(z||(z={}));class U{constructor(r,a,l,...h){this.valueIdentifier=r,this.name=l,typeof a=="number"?this.values=Int32Array.from([a]):this.values=a,this.otherEncodingNames=h,U.VALUE_IDENTIFIER_TO_ECI.set(r,this),U.NAME_TO_ECI.set(l,this);const d=this.values;for(let m=0,y=d.length;m!==y;m++){const _=d[m];U.VALUES_TO_ECI.set(_,this)}for(const m of h)U.NAME_TO_ECI.set(m,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new F("incorect value");const a=U.VALUES_TO_ECI.get(r);if(a===void 0)throw new F("incorect value");return a}static getCharacterSetECIByName(r){const a=U.NAME_TO_ECI.get(r);if(a===void 0)throw new F("incorect value");return a}equals(r){if(!(r instanceof U))return!1;const a=r;return this.getName()===a.getName()}}U.VALUE_IDENTIFIER_TO_ECI=new Map,U.VALUES_TO_ECI=new Map,U.NAME_TO_ECI=new Map,U.Cp437=new U(z.Cp437,Int32Array.from([0,2]),"Cp437"),U.ISO8859_1=new U(z.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),U.ISO8859_2=new U(z.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),U.ISO8859_3=new U(z.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),U.ISO8859_4=new U(z.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),U.ISO8859_5=new U(z.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),U.ISO8859_6=new U(z.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),U.ISO8859_7=new U(z.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),U.ISO8859_8=new U(z.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),U.ISO8859_9=new U(z.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),U.ISO8859_10=new U(z.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),U.ISO8859_11=new U(z.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),U.ISO8859_13=new U(z.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),U.ISO8859_14=new U(z.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),U.ISO8859_15=new U(z.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),U.ISO8859_16=new U(z.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),U.SJIS=new U(z.SJIS,20,"SJIS","Shift_JIS"),U.Cp1250=new U(z.Cp1250,21,"Cp1250","windows-1250"),U.Cp1251=new U(z.Cp1251,22,"Cp1251","windows-1251"),U.Cp1252=new U(z.Cp1252,23,"Cp1252","windows-1252"),U.Cp1256=new U(z.Cp1256,24,"Cp1256","windows-1256"),U.UnicodeBigUnmarked=new U(z.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),U.UTF8=new U(z.UTF8,26,"UTF8","UTF-8"),U.ASCII=new U(z.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),U.Big5=new U(z.Big5,28,"Big5"),U.GB18030=new U(z.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),U.EUC_KR=new U(z.EUC_KR,30,"EUC_KR","EUC-KR");class J extends w{}J.kind="UnsupportedOperationException";class X{static decode(r,a){const l=this.encodingName(a);return this.customDecoder?this.customDecoder(r,l):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(l)?this.decodeFallback(r,l):new TextDecoder(l).decode(r)}static shouldDecodeOnFallback(r){return!X.isBrowser()&&r==="ISO-8859-1"}static encode(r,a){const l=this.encodingName(a);return this.customEncoder?this.customEncoder(r,l):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof U?r:U.getCharacterSetECIByName(r)}static decodeFallback(r,a){const l=this.encodingCharacterSet(a);if(X.isDecodeFallbackSupported(l)){let h="";for(let d=0,m=r.length;d<m;d++){let y=r[d].toString(16);y.length<2&&(y="0"+y),h+="%"+y}return decodeURIComponent(h)}if(l.equals(U.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new J(`Encoding ${this.encodingName(a)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(U.UTF8)||r.equals(U.ISO8859_1)||r.equals(U.ASCII)}static encodeFallback(r){const l=btoa(unescape(encodeURIComponent(r))).split(""),h=[];for(let d=0;d<l.length;d++)h.push(l[d].charCodeAt(0));return new Uint8Array(h)}}class Y{static castAsNonUtf8Char(r,a=null){const l=a?a.getName():this.ISO88591;return X.decode(new Uint8Array([r]),l)}static guessEncoding(r,a){if(a!=null&&a.get(Ze.CHARACTER_SET)!==void 0)return a.get(Ze.CHARACTER_SET).toString();const l=r.length;let h=!0,d=!0,m=!0,y=0,_=0,v=0,N=0,k=0,B=0,q=0,Z=0,te=0,de=0,_e=0;const Je=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let Ke=0;Ke<l&&(h||d||m);Ke++){const Ge=r[Ke]&255;m&&(y>0?(Ge&128)===0?m=!1:y--:(Ge&128)!==0&&((Ge&64)===0?m=!1:(y++,(Ge&32)===0?_++:(y++,(Ge&16)===0?v++:(y++,(Ge&8)===0?N++:m=!1))))),h&&(Ge>127&&Ge<160?h=!1:Ge>159&&(Ge<192||Ge===215||Ge===247)&&_e++),d&&(k>0?Ge<64||Ge===127||Ge>252?d=!1:k--:Ge===128||Ge===160||Ge>239?d=!1:Ge>160&&Ge<224?(B++,Z=0,q++,q>te&&(te=q)):Ge>127?(k++,q=0,Z++,Z>de&&(de=Z)):(q=0,Z=0))}return m&&y>0&&(m=!1),d&&k>0&&(d=!1),m&&(Je||_+v+N>0)?Y.UTF8:d&&(Y.ASSUME_SHIFT_JIS||te>=3||de>=3)?Y.SHIFT_JIS:h&&d?te===2&&B===2||_e*10>=l?Y.SHIFT_JIS:Y.ISO88591:h?Y.ISO88591:d?Y.SHIFT_JIS:m?Y.UTF8:Y.PLATFORM_DEFAULT_ENCODING}static format(r,...a){let l=-1;function h(m,y,_,v,N,k){if(m==="%%")return"%";if(a[++l]===void 0)return;m=v?parseInt(v.substr(1)):void 0;let B=N?parseInt(N.substr(1)):void 0,q;switch(k){case"s":q=a[l];break;case"c":q=a[l][0];break;case"f":q=parseFloat(a[l]).toFixed(m);break;case"p":q=parseFloat(a[l]).toPrecision(m);break;case"e":q=parseFloat(a[l]).toExponential(m);break;case"x":q=parseInt(a[l]).toString(B||16);break;case"d":q=parseFloat(parseInt(a[l],B||10).toPrecision(m)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(B);let Z=parseInt(_),te=_&&_[0]+""=="0"?"0":" ";for(;q.length<Z;)q=y!==void 0?q+te:te+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,h)}static getBytes(r,a){return X.encode(r,a)}static getCharCode(r,a=0){return r.charCodeAt(a)}static getCharAt(r){return String.fromCharCode(r)}}Y.SHIFT_JIS=U.SJIS.getName(),Y.GB2312="GB2312",Y.ISO88591=U.ISO8859_1.getName(),Y.EUC_JP="EUC_JP",Y.UTF8=U.UTF8.getName(),Y.PLATFORM_DEFAULT_ENCODING=Y.UTF8,Y.ASSUME_SHIFT_JIS=!1;class G{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=Y.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,a,l){for(let h=a;a<a+l;h++)this.append(r[h]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,a){this.value=this.value.substr(0,r)+a+this.value.substr(r+1)}substring(r,a){return this.value.substring(r,a)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,a){this.value=this.value.substr(0,r)+a+this.value.substr(r+a.length)}}class at{constructor(r,a,l,h){if(this.width=r,this.height=a,this.rowSize=l,this.bits=h,a==null&&(a=r),this.height=a,r<1||a<1)throw new R("Both dimensions must be greater than 0");l==null&&(l=Math.floor((r+31)/32)),this.rowSize=l,h==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const a=r.length,l=r[0].length,h=new at(l,a);for(let d=0;d<a;d++){const m=r[d];for(let y=0;y<l;y++)m[y]&&h.set(y,d)}return h}static parseFromString(r,a,l){if(r===null)throw new R("stringRepresentation cannot be null");const h=new Array(r.length);let d=0,m=0,y=-1,_=0,v=0;for(;v<r.length;)if(r.charAt(v)===`
`||r.charAt(v)==="\r"){if(d>m){if(y===-1)y=d-m;else if(d-m!==y)throw new R("row lengths do not match");m=d,_++}v++}else if(r.substring(v,v+a.length)===a)v+=a.length,h[d]=!0,d++;else if(r.substring(v,v+l.length)===l)v+=l.length,h[d]=!1,d++;else throw new R("illegal character encountered: "+r.substring(v));if(d>m){if(y===-1)y=d-m;else if(d-m!==y)throw new R("row lengths do not match");_++}const N=new at(y,_);for(let k=0;k<d;k++)h[k]&&N.set(Math.floor(k%y),Math.floor(k/y));return N}get(r,a){const l=a*this.rowSize+Math.floor(r/32);return(this.bits[l]>>>(r&31)&1)!==0}set(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]|=1<<(r&31)&4294967295}unset(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]&=~(1<<(r&31)&4294967295)}flip(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new R("input matrix dimensions do not match");const a=new Ue(Math.floor(this.width/32)+1),l=this.rowSize,h=this.bits;for(let d=0,m=this.height;d<m;d++){const y=d*l,_=r.getRow(d,a).getBitArray();for(let v=0;v<l;v++)h[y+v]^=_[v]}}clear(){const r=this.bits,a=r.length;for(let l=0;l<a;l++)r[l]=0}setRegion(r,a,l,h){if(a<0||r<0)throw new R("Left and top must be nonnegative");if(h<1||l<1)throw new R("Height and width must be at least 1");const d=r+l,m=a+h;if(m>this.height||d>this.width)throw new R("The region must fit inside the matrix");const y=this.rowSize,_=this.bits;for(let v=a;v<m;v++){const N=v*y;for(let k=r;k<d;k++)_[N+Math.floor(k/32)]|=1<<(k&31)&4294967295}}getRow(r,a){a==null||a.getSize()<this.width?a=new Ue(this.width):a.clear();const l=this.rowSize,h=this.bits,d=r*l;for(let m=0;m<l;m++)a.setBulk(m*32,h[d+m]);return a}setRow(r,a){re.arraycopy(a.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),a=this.getHeight();let l=new Ue(r),h=new Ue(r);for(let d=0,m=Math.floor((a+1)/2);d<m;d++)l=this.getRow(d,l),h=this.getRow(a-1-d,h),l.reverse(),h.reverse(),this.setRow(d,h),this.setRow(a-1-d,l)}getEnclosingRectangle(){const r=this.width,a=this.height,l=this.rowSize,h=this.bits;let d=r,m=a,y=-1,_=-1;for(let v=0;v<a;v++)for(let N=0;N<l;N++){const k=h[v*l+N];if(k!==0){if(v<m&&(m=v),v>_&&(_=v),N*32<d){let B=0;for(;(k<<31-B&4294967295)===0;)B++;N*32+B<d&&(d=N*32+B)}if(N*32+31>y){let B=31;for(;!(k>>>B);)B--;N*32+B>y&&(y=N*32+B)}}}return y<d||_<m?null:Int32Array.from([d,m,y-d+1,_-m+1])}getTopLeftOnBit(){const r=this.rowSize,a=this.bits;let l=0;for(;l<a.length&&a[l]===0;)l++;if(l===a.length)return null;const h=l/r;let d=l%r*32;const m=a[l];let y=0;for(;(m<<31-y&4294967295)===0;)y++;return d+=y,Int32Array.from([d,h])}getBottomRightOnBit(){const r=this.rowSize,a=this.bits;let l=a.length-1;for(;l>=0&&a[l]===0;)l--;if(l<0)return null;const h=Math.floor(l/r);let d=Math.floor(l%r)*32;const m=a[l];let y=31;for(;!(m>>>y);)y--;return d+=y,Int32Array.from([d,h])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof at))return!1;const a=r;return this.width===a.width&&this.height===a.height&&this.rowSize===a.rowSize&&Oe.equals(this.bits,a.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+Oe.hashCode(this.bits),r}toString(r="X ",a="  ",l=`
`){return this.buildToString(r,a,l)}buildToString(r,a,l){let h=new G;for(let d=0,m=this.height;d<m;d++){for(let y=0,_=this.width;y<_;y++)h.append(this.get(y,d)?r:a);h.append(l)}return h.toString()}clone(){return new at(this.width,this.height,this.rowSize,this.bits.slice())}}class ce extends w{static getNotFoundInstance(){return new ce}}ce.kind="NotFoundException";class ue extends ee{constructor(r){super(r),this.luminances=ue.EMPTY,this.buckets=new Int32Array(ue.LUMINANCE_BUCKETS)}getBlackRow(r,a){const l=this.getLuminanceSource(),h=l.getWidth();a==null||a.getSize()<h?a=new Ue(h):a.clear(),this.initArrays(h);const d=l.getRow(r,this.luminances),m=this.buckets;for(let _=0;_<h;_++)m[(d[_]&255)>>ue.LUMINANCE_SHIFT]++;const y=ue.estimateBlackPoint(m);if(h<3)for(let _=0;_<h;_++)(d[_]&255)<y&&a.set(_);else{let _=d[0]&255,v=d[1]&255;for(let N=1;N<h-1;N++){const k=d[N+1]&255;(v*4-_-k)/2<y&&a.set(N),_=v,v=k}}return a}getBlackMatrix(){const r=this.getLuminanceSource(),a=r.getWidth(),l=r.getHeight(),h=new at(a,l);this.initArrays(a);const d=this.buckets;for(let _=1;_<5;_++){const v=Math.floor(l*_/5),N=r.getRow(v,this.luminances),k=Math.floor(a*4/5);for(let B=Math.floor(a/5);B<k;B++){const q=N[B]&255;d[q>>ue.LUMINANCE_SHIFT]++}}const m=ue.estimateBlackPoint(d),y=r.getMatrix();for(let _=0;_<l;_++){const v=_*a;for(let N=0;N<a;N++)(y[v+N]&255)<m&&h.set(N,_)}return h}createBinarizer(r){return new ue(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const a=this.buckets;for(let l=0;l<ue.LUMINANCE_BUCKETS;l++)a[l]=0}static estimateBlackPoint(r){const a=r.length;let l=0,h=0,d=0;for(let N=0;N<a;N++)r[N]>d&&(h=N,d=r[N]),r[N]>l&&(l=r[N]);let m=0,y=0;for(let N=0;N<a;N++){const k=N-h,B=r[N]*k*k;B>y&&(m=N,y=B)}if(h>m){const N=h;h=m,m=N}if(m-h<=a/16)throw new ce;let _=m-1,v=-1;for(let N=m-1;N>h;N--){const k=N-h,B=k*k*(m-N)*(l-r[N]);B>v&&(_=N,v=B)}return _<<ue.LUMINANCE_SHIFT}}ue.LUMINANCE_BITS=5,ue.LUMINANCE_SHIFT=8-ue.LUMINANCE_BITS,ue.LUMINANCE_BUCKETS=1<<ue.LUMINANCE_BITS,ue.EMPTY=Uint8ClampedArray.from([0]);class Ee extends ue{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),a=r.getWidth(),l=r.getHeight();if(a>=Ee.MINIMUM_DIMENSION&&l>=Ee.MINIMUM_DIMENSION){const h=r.getMatrix();let d=a>>Ee.BLOCK_SIZE_POWER;(a&Ee.BLOCK_SIZE_MASK)!==0&&d++;let m=l>>Ee.BLOCK_SIZE_POWER;(l&Ee.BLOCK_SIZE_MASK)!==0&&m++;const y=Ee.calculateBlackPoints(h,d,m,a,l),_=new at(a,l);Ee.calculateThresholdForBlock(h,d,m,a,l,y,_),this.matrix=_}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new Ee(r)}static calculateThresholdForBlock(r,a,l,h,d,m,y){const _=d-Ee.BLOCK_SIZE,v=h-Ee.BLOCK_SIZE;for(let N=0;N<l;N++){let k=N<<Ee.BLOCK_SIZE_POWER;k>_&&(k=_);const B=Ee.cap(N,2,l-3);for(let q=0;q<a;q++){let Z=q<<Ee.BLOCK_SIZE_POWER;Z>v&&(Z=v);const te=Ee.cap(q,2,a-3);let de=0;for(let Je=-2;Je<=2;Je++){const Ke=m[B+Je];de+=Ke[te-2]+Ke[te-1]+Ke[te]+Ke[te+1]+Ke[te+2]}const _e=de/25;Ee.thresholdBlock(r,Z,k,_e,h,y)}}}static cap(r,a,l){return r<a?a:r>l?l:r}static thresholdBlock(r,a,l,h,d,m){for(let y=0,_=l*d+a;y<Ee.BLOCK_SIZE;y++,_+=d)for(let v=0;v<Ee.BLOCK_SIZE;v++)(r[_+v]&255)<=h&&m.set(a+v,l+y)}static calculateBlackPoints(r,a,l,h,d){const m=d-Ee.BLOCK_SIZE,y=h-Ee.BLOCK_SIZE,_=new Array(l);for(let v=0;v<l;v++){_[v]=new Int32Array(a);let N=v<<Ee.BLOCK_SIZE_POWER;N>m&&(N=m);for(let k=0;k<a;k++){let B=k<<Ee.BLOCK_SIZE_POWER;B>y&&(B=y);let q=0,Z=255,te=0;for(let _e=0,Je=N*h+B;_e<Ee.BLOCK_SIZE;_e++,Je+=h){for(let Ke=0;Ke<Ee.BLOCK_SIZE;Ke++){const Ge=r[Je+Ke]&255;q+=Ge,Ge<Z&&(Z=Ge),Ge>te&&(te=Ge)}if(te-Z>Ee.MIN_DYNAMIC_RANGE)for(_e++,Je+=h;_e<Ee.BLOCK_SIZE;_e++,Je+=h)for(let Ke=0;Ke<Ee.BLOCK_SIZE;Ke++)q+=r[Je+Ke]&255}let de=q>>Ee.BLOCK_SIZE_POWER*2;if(te-Z<=Ee.MIN_DYNAMIC_RANGE&&(de=Z/2,v>0&&k>0)){const _e=(_[v-1][k]+2*_[v][k-1]+_[v-1][k-1])/4;Z<_e&&(de=_e)}_[v][k]=de}}return _}}Ee.BLOCK_SIZE_POWER=3,Ee.BLOCK_SIZE=1<<Ee.BLOCK_SIZE_POWER,Ee.BLOCK_SIZE_MASK=Ee.BLOCK_SIZE-1,Ee.MINIMUM_DIMENSION=Ee.BLOCK_SIZE*5,Ee.MIN_DYNAMIC_RANGE=24;class We{constructor(r,a){this.width=r,this.height=a}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,a,l,h){throw new J("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new J("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new J("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let a=new G;for(let l=0;l<this.height;l++){const h=this.getRow(l,r);for(let d=0;d<this.width;d++){const m=h[d]&255;let y;m<64?y="#":m<128?y="+":m<192?y=".":y=" ",a.append(y)}a.append(`
`)}return a.toString()}}class qe extends We{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,a){const l=this.delegate.getRow(r,a),h=this.getWidth();for(let d=0;d<h;d++)l[d]=255-(l[d]&255);return l}getMatrix(){const r=this.delegate.getMatrix(),a=this.getWidth()*this.getHeight(),l=new Uint8ClampedArray(a);for(let h=0;h<a;h++)l[h]=255-(r[h]&255);return l}isCropSupported(){return this.delegate.isCropSupported()}crop(r,a,l,h){return new qe(this.delegate.crop(r,a,l,h))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new qe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new qe(this.delegate.rotateCounterClockwise45())}}class ot extends We{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=ot.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const a=r.getContext("2d").getImageData(0,0,r.width,r.height);return ot.toGrayscaleBuffer(a.data,r.width,r.height)}static toGrayscaleBuffer(r,a,l){const h=new Uint8ClampedArray(a*l);for(let d=0,m=0,y=r.length;d<y;d+=4,m++){let _;if(r[d+3]===0)_=255;else{const N=r[d],k=r[d+1],B=r[d+2];_=306*N+601*k+117*B+512>>10}h[m]=_}return h}getRow(r,a){if(r<0||r>=this.getHeight())throw new R("Requested row is outside the image: "+r);const l=this.getWidth(),h=r*l;return a===null?a=this.buffer.slice(h,h+l):(a.length<l&&(a=new Uint8ClampedArray(l)),a.set(this.buffer.slice(h,h+l))),a}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,a,l,h){return super.crop(r,a,l,h),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const a=this.getTempCanvasElement(),l=a.getContext("2d"),h=r*ot.DEGREE_TO_RADIANS,d=this.canvas.width,m=this.canvas.height,y=Math.ceil(Math.abs(Math.cos(h))*d+Math.abs(Math.sin(h))*m),_=Math.ceil(Math.abs(Math.sin(h))*d+Math.abs(Math.cos(h))*m);return a.width=y,a.height=_,l.translate(y/2,_/2),l.rotate(h),l.drawImage(this.canvas,d/-2,m/-2),this.buffer=ot.makeBufferFromCanvasImageData(a),this}invert(){return new qe(this)}}ot.DEGREE_TO_RADIANS=Math.PI/180;class Q{constructor(r,a,l){this.deviceId=r,this.label=a,this.kind="videoinput",this.groupId=l||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var $=(globalThis||$h||self||window||void 0)&&(globalThis||$h||self||window||void 0).__awaiter||function(M,r,a,l){function h(d){return d instanceof a?d:new a(function(m){m(d)})}return new(a||(a=Promise))(function(d,m){function y(N){try{v(l.next(N))}catch(k){m(k)}}function _(N){try{v(l.throw(N))}catch(k){m(k)}}function v(N){N.done?d(N.value):h(N.value).then(y,_)}v((l=l.apply(M,r||[])).next())})};class pe{constructor(r,a=500,l){this.reader=r,this.timeBetweenScansMillis=a,this._hints=l,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return $(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),a=[];for(const l of r){const h=l.kind==="video"?"videoinput":l.kind;if(h!=="videoinput")continue;const d=l.deviceId||l.id,m=l.label||`Video device ${a.length+1}`,y=l.groupId,_={deviceId:d,label:m,kind:h,groupId:y};a.push(_)}return a})}getVideoInputDevices(){return $(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(a=>new Q(a.deviceId,a.label))})}findDeviceById(r){return $(this,void 0,void 0,function*(){const a=yield this.listVideoInputDevices();return a?a.find(l=>l.deviceId===r):null})}decodeFromInputVideoDevice(r,a){return $(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,a)})}decodeOnceFromVideoDevice(r,a){return $(this,void 0,void 0,function*(){this.reset();let l;r?l={deviceId:{exact:r}}:l={facingMode:"environment"};const h={video:l};return yield this.decodeOnceFromConstraints(h,a)})}decodeOnceFromConstraints(r,a){return $(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(l,a)})}decodeOnceFromStream(r,a){return $(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(r,a);return yield this.decodeOnce(l)})}decodeFromInputVideoDeviceContinuously(r,a,l){return $(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,a,l)})}decodeFromVideoDevice(r,a,l){return $(this,void 0,void 0,function*(){let h;r?h={deviceId:{exact:r}}:h={facingMode:"environment"};const d={video:h};return yield this.decodeFromConstraints(d,a,l)})}decodeFromConstraints(r,a,l){return $(this,void 0,void 0,function*(){const h=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(h,a,l)})}decodeFromStream(r,a,l){return $(this,void 0,void 0,function*(){this.reset();const h=yield this.attachStreamToVideo(r,a);return yield this.decodeContinuously(h,l)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,a){return $(this,void 0,void 0,function*(){const l=this.prepareVideoElement(a);return this.addVideoSource(l,r),this.videoElement=l,this.stream=r,yield this.playVideoOnLoadAsync(l),l})}playVideoOnLoadAsync(r){return new Promise((a,l)=>this.playVideoOnLoad(r,()=>a()))}playVideoOnLoad(r,a){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",a),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return $(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,a){const l=document.getElementById(r);if(!l)throw new C(`element with id '${r}' not found`);if(l.nodeName.toLowerCase()!==a.toLowerCase())throw new C(`element with id '${r}' must be an ${a} element`);return l}decodeFromImage(r,a){if(!r&&!a)throw new C("either imageElement with a src set or an url must be provided");return a&&!r?this.decodeFromImageUrl(a):this.decodeFromImageElement(r)}decodeFromVideo(r,a){if(!r&&!a)throw new C("Either an element with a src set or an URL must be provided");return a&&!r?this.decodeFromVideoUrl(a):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,a,l){if(r===void 0&&a===void 0)throw new C("Either an element with a src set or an URL must be provided");return a&&!r?this.decodeFromVideoUrlContinuously(a,l):this.decodeFromVideoElementContinuously(r,l)}decodeFromImageElement(r){if(!r)throw new C("An image element must be provided.");this.reset();const a=this.prepareImageElement(r);this.imageElement=a;let l;return this.isImageLoaded(a)?l=this.decodeOnce(a,!1,!0):l=this._decodeOnLoadImage(a),l}decodeFromVideoElement(r){const a=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(a)}decodeFromVideoElementContinuously(r,a){const l=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(l,a)}_decodeFromVideoElementSetup(r){if(!r)throw new C("A video element must be provided.");this.reset();const a=this.prepareVideoElement(r);return this.videoElement=a,a}decodeFromImageUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const a=this.prepareImageElement();this.imageElement=a;const l=this._decodeOnLoadImage(a);return a.src=r,l}decodeFromVideoUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),l=this.decodeFromVideoElement(a);return a.src=r,l}decodeFromVideoUrlContinuously(r,a){if(!r)throw new C("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),h=this.decodeFromVideoElementContinuously(l,a);return l.src=r,h}_decodeOnLoadImage(r){return new Promise((a,l)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(a,l),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return $(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,a){return $(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,a)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let a;return typeof r>"u"&&(a=document.createElement("img"),a.width=200,a.height=200),typeof r=="string"&&(a=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(a=r),a}prepareVideoElement(r){let a;return!r&&typeof document<"u"&&(a=document.createElement("video"),a.width=200,a.height=200),typeof r=="string"&&(a=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(a=r),a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),a.setAttribute("playsinline","true"),a}decodeOnce(r,a=!0,l=!0){this._stopAsyncDecode=!1;const h=(d,m)=>{if(this._stopAsyncDecode){m(new ce("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const y=this.decode(r);d(y)}catch(y){const _=a&&y instanceof ce,N=(y instanceof L||y instanceof F)&&l;if(_||N)return setTimeout(h,this._timeBetweenDecodingAttempts,d,m);m(y)}};return new Promise((d,m)=>h(d,m))}decodeContinuously(r,a){this._stopContinuousDecode=!1;const l=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const h=this.decode(r);a(h,null),setTimeout(l,this.timeBetweenScansMillis)}catch(h){a(null,h);const d=h instanceof L||h instanceof F,m=h instanceof ce;(d||m)&&setTimeout(l,this._timeBetweenDecodingAttempts)}};l()}decode(r){const a=this.createBinaryBitmap(r);return this.decodeBitmap(a)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,a,l){a||(a={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),l||(l=this.captureCanvasContext),l.drawImage(r,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}drawImageOnCanvas(r,a,l=this.captureCanvasContext){a||(a={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),l||(l=this.captureCanvasContext),l.drawImage(r,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const a=this.getCaptureCanvas(r),l=new ot(a),h=new Ee(l);return new P(h)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const l=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=l}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const a=this.createCaptureCanvas(r);this.captureCanvas=a}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const a=document.createElement("canvas");let l,h;return typeof r<"u"&&(r instanceof HTMLVideoElement?(l=r.videoWidth,h=r.videoHeight):r instanceof HTMLImageElement&&(l=r.naturalWidth||r.width,h=r.naturalHeight||r.height)),a.style.width=l+"px",a.style.height=h+"px",a.width=l,a.height=h,a}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,a){try{r.srcObject=a}catch{r.src=URL.createObjectURL(a)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class Te{constructor(r,a,l=a==null?0:8*a.length,h,d,m=re.currentTimeMillis()){this.text=r,this.rawBytes=a,this.numBits=l,this.resultPoints=h,this.format=d,this.timestamp=m,this.text=r,this.rawBytes=a,l==null?this.numBits=a==null?0:8*a.length:this.numBits=l,this.resultPoints=h,this.format=d,this.resultMetadata=null,m==null?this.timestamp=re.currentTimeMillis():this.timestamp=m}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,a){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,a)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const a=this.resultPoints;if(a===null)this.resultPoints=r;else if(r!==null&&r.length>0){const l=new Array(a.length+r.length);re.arraycopy(a,0,l,0,a.length),re.arraycopy(r,0,l,a.length,r.length),this.resultPoints=l}}getTimestamp(){return this.timestamp}toString(){return this.text}}var nt;(function(M){M[M.AZTEC=0]="AZTEC",M[M.CODABAR=1]="CODABAR",M[M.CODE_39=2]="CODE_39",M[M.CODE_93=3]="CODE_93",M[M.CODE_128=4]="CODE_128",M[M.DATA_MATRIX=5]="DATA_MATRIX",M[M.EAN_8=6]="EAN_8",M[M.EAN_13=7]="EAN_13",M[M.ITF=8]="ITF",M[M.MAXICODE=9]="MAXICODE",M[M.PDF_417=10]="PDF_417",M[M.QR_CODE=11]="QR_CODE",M[M.RSS_14=12]="RSS_14",M[M.RSS_EXPANDED=13]="RSS_EXPANDED",M[M.UPC_A=14]="UPC_A",M[M.UPC_E=15]="UPC_E",M[M.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(nt||(nt={}));var ve=nt,st;(function(M){M[M.OTHER=0]="OTHER",M[M.ORIENTATION=1]="ORIENTATION",M[M.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",M[M.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",M[M.ISSUE_NUMBER=4]="ISSUE_NUMBER",M[M.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",M[M.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",M[M.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",M[M.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",M[M.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",M[M.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(st||(st={}));var xt=st;class kt{constructor(r,a,l,h,d=-1,m=-1){this.rawBytes=r,this.text=a,this.byteSegments=l,this.ecLevel=h,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=m,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class cn{exp(r){return this.expTable[r]}log(r){if(r===0)throw new R;return this.logTable[r]}static addOrSubtract(r,a){return r^a}}class en{constructor(r,a){if(a.length===0)throw new R;this.field=r;const l=a.length;if(l>1&&a[0]===0){let h=1;for(;h<l&&a[h]===0;)h++;h===l?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(l-h),re.arraycopy(a,h,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const a=this.coefficients;let l;if(r===1){l=0;for(let m=0,y=a.length;m!==y;m++){const _=a[m];l=cn.addOrSubtract(l,_)}return l}l=a[0];const h=a.length,d=this.field;for(let m=1;m<h;m++)l=cn.addOrSubtract(d.multiply(r,l),a[m]);return l}addOrSubtract(r){if(!this.field.equals(r.field))throw new R("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let a=this.coefficients,l=r.coefficients;if(a.length>l.length){const m=a;a=l,l=m}let h=new Int32Array(l.length);const d=l.length-a.length;re.arraycopy(l,0,h,0,d);for(let m=d;m<l.length;m++)h[m]=cn.addOrSubtract(a[m-d],l[m]);return new en(this.field,h)}multiply(r){if(!this.field.equals(r.field))throw new R("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const a=this.coefficients,l=a.length,h=r.coefficients,d=h.length,m=new Int32Array(l+d-1),y=this.field;for(let _=0;_<l;_++){const v=a[_];for(let N=0;N<d;N++)m[_+N]=cn.addOrSubtract(m[_+N],y.multiply(v,h[N]))}return new en(y,m)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const a=this.coefficients.length,l=this.field,h=new Int32Array(a),d=this.coefficients;for(let m=0;m<a;m++)h[m]=l.multiply(d[m],r);return new en(l,h)}multiplyByMonomial(r,a){if(r<0)throw new R;if(a===0)return this.field.getZero();const l=this.coefficients,h=l.length,d=new Int32Array(h+r),m=this.field;for(let y=0;y<h;y++)d[y]=m.multiply(l[y],a);return new en(m,d)}divide(r){if(!this.field.equals(r.field))throw new R("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new R("Divide by 0");const a=this.field;let l=a.getZero(),h=this;const d=r.getCoefficient(r.getDegree()),m=a.inverse(d);for(;h.getDegree()>=r.getDegree()&&!h.isZero();){const y=h.getDegree()-r.getDegree(),_=a.multiply(h.getCoefficient(h.getDegree()),m),v=r.multiplyByMonomial(y,_),N=a.buildMonomial(y,_);l=l.addOrSubtract(N),h=h.addOrSubtract(v)}return[l,h]}toString(){let r="";for(let a=this.getDegree();a>=0;a--){let l=this.getCoefficient(a);if(l!==0){if(l<0?(r+=" - ",l=-l):r.length>0&&(r+=" + "),a===0||l!==1){const h=this.field.log(l);h===0?r+="1":h===1?r+="a":(r+="a^",r+=h)}a!==0&&(a===1?r+="x":(r+="x^",r+=a))}}return r}}class En extends w{}En.kind="ArithmeticException";class Lt extends cn{constructor(r,a,l){super(),this.primitive=r,this.size=a,this.generatorBase=l;const h=new Int32Array(a);let d=1;for(let y=0;y<a;y++)h[y]=d,d*=2,d>=a&&(d^=r,d&=a-1);this.expTable=h;const m=new Int32Array(a);for(let y=0;y<a-1;y++)m[h[y]]=y;this.logTable=m,this.zero=new en(this,Int32Array.from([0])),this.one=new en(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,a){if(r<0)throw new R;if(a===0)return this.zero;const l=new Int32Array(r+1);return l[0]=a,new en(this,l)}inverse(r){if(r===0)throw new En;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,a){return r===0||a===0?0:this.expTable[(this.logTable[r]+this.logTable[a])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+le.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}Lt.AZTEC_DATA_12=new Lt(4201,4096,1),Lt.AZTEC_DATA_10=new Lt(1033,1024,1),Lt.AZTEC_DATA_6=new Lt(67,64,1),Lt.AZTEC_PARAM=new Lt(19,16,1),Lt.QR_CODE_FIELD_256=new Lt(285,256,0),Lt.DATA_MATRIX_FIELD_256=new Lt(301,256,1),Lt.AZTEC_DATA_8=Lt.DATA_MATRIX_FIELD_256,Lt.MAXICODE_FIELD_64=Lt.AZTEC_DATA_6;class hn extends w{}hn.kind="ReedSolomonException";class wn extends w{}wn.kind="IllegalStateException";class De{constructor(r){this.field=r}decode(r,a){const l=this.field,h=new en(l,r),d=new Int32Array(a);let m=!0;for(let q=0;q<a;q++){const Z=h.evaluateAt(l.exp(q+l.getGeneratorBase()));d[d.length-1-q]=Z,Z!==0&&(m=!1)}if(m)return;const y=new en(l,d),_=this.runEuclideanAlgorithm(l.buildMonomial(a,1),y,a),v=_[0],N=_[1],k=this.findErrorLocations(v),B=this.findErrorMagnitudes(N,k);for(let q=0;q<k.length;q++){const Z=r.length-1-l.log(k[q]);if(Z<0)throw new hn("Bad error location");r[Z]=Lt.addOrSubtract(r[Z],B[q])}}runEuclideanAlgorithm(r,a,l){if(r.getDegree()<a.getDegree()){const q=r;r=a,a=q}const h=this.field;let d=r,m=a,y=h.getZero(),_=h.getOne();for(;m.getDegree()>=(l/2|0);){let q=d,Z=y;if(d=m,y=_,d.isZero())throw new hn("r_{i-1} was zero");m=q;let te=h.getZero();const de=d.getCoefficient(d.getDegree()),_e=h.inverse(de);for(;m.getDegree()>=d.getDegree()&&!m.isZero();){const Je=m.getDegree()-d.getDegree(),Ke=h.multiply(m.getCoefficient(m.getDegree()),_e);te=te.addOrSubtract(h.buildMonomial(Je,Ke)),m=m.addOrSubtract(d.multiplyByMonomial(Je,Ke))}if(_=te.multiply(y).addOrSubtract(Z),m.getDegree()>=d.getDegree())throw new wn("Division algorithm failed to reduce polynomial?")}const v=_.getCoefficient(0);if(v===0)throw new hn("sigmaTilde(0) was zero");const N=h.inverse(v),k=_.multiplyScalar(N),B=m.multiplyScalar(N);return[k,B]}findErrorLocations(r){const a=r.getDegree();if(a===1)return Int32Array.from([r.getCoefficient(1)]);const l=new Int32Array(a);let h=0;const d=this.field;for(let m=1;m<d.getSize()&&h<a;m++)r.evaluateAt(m)===0&&(l[h]=d.inverse(m),h++);if(h!==a)throw new hn("Error locator degree does not match number of roots");return l}findErrorMagnitudes(r,a){const l=a.length,h=new Int32Array(l),d=this.field;for(let m=0;m<l;m++){const y=d.inverse(a[m]);let _=1;for(let v=0;v<l;v++)if(m!==v){const N=d.multiply(a[v],y),k=(N&1)===0?N|1:N&-2;_=d.multiply(_,k)}h[m]=d.multiply(r.evaluateAt(y),d.inverse(_)),d.getGeneratorBase()!==0&&(h[m]=d.multiply(h[m],y))}return h}}var ge;(function(M){M[M.UPPER=0]="UPPER",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.DIGIT=3]="DIGIT",M[M.PUNCT=4]="PUNCT",M[M.BINARY=5]="BINARY"})(ge||(ge={}));class Re{decode(r){this.ddata=r;let a=r.getBits(),l=this.extractBits(a),h=this.correctBits(l),d=Re.convertBoolArrayToByteArray(h),m=Re.getEncodedData(h),y=new kt(d,m,null,null);return y.setNumBits(h.length),y}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let a=r.length,l=ge.UPPER,h=ge.UPPER,d="",m=0;for(;m<a;)if(h===ge.BINARY){if(a-m<5)break;let y=Re.readCode(r,m,5);if(m+=5,y===0){if(a-m<11)break;y=Re.readCode(r,m,11)+31,m+=11}for(let _=0;_<y;_++){if(a-m<8){m=a;break}const v=Re.readCode(r,m,8);d+=Y.castAsNonUtf8Char(v),m+=8}h=l}else{let y=h===ge.DIGIT?4:5;if(a-m<y)break;let _=Re.readCode(r,m,y);m+=y;let v=Re.getCharacter(h,_);v.startsWith("CTRL_")?(l=h,h=Re.getTable(v.charAt(5)),v.charAt(6)==="L"&&(l=h)):(d+=v,h=l)}return d}static getTable(r){switch(r){case"L":return ge.LOWER;case"P":return ge.PUNCT;case"M":return ge.MIXED;case"D":return ge.DIGIT;case"B":return ge.BINARY;case"U":default:return ge.UPPER}}static getCharacter(r,a){switch(r){case ge.UPPER:return Re.UPPER_TABLE[a];case ge.LOWER:return Re.LOWER_TABLE[a];case ge.MIXED:return Re.MIXED_TABLE[a];case ge.PUNCT:return Re.PUNCT_TABLE[a];case ge.DIGIT:return Re.DIGIT_TABLE[a];default:throw new wn("Bad table")}}correctBits(r){let a,l;this.ddata.getNbLayers()<=2?(l=6,a=Lt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(l=8,a=Lt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(l=10,a=Lt.AZTEC_DATA_10):(l=12,a=Lt.AZTEC_DATA_12);let h=this.ddata.getNbDatablocks(),d=r.length/l;if(d<h)throw new F;let m=r.length%l,y=new Int32Array(d);for(let B=0;B<d;B++,m+=l)y[B]=Re.readCode(r,m,l);try{new De(a).decode(y,d-h)}catch(B){throw new F(B)}let _=(1<<l)-1,v=0;for(let B=0;B<h;B++){let q=y[B];if(q===0||q===_)throw new F;(q===1||q===_-1)&&v++}let N=new Array(h*l-v),k=0;for(let B=0;B<h;B++){let q=y[B];if(q===1||q===_-1)N.fill(q>1,k,k+l-1),k+=l-1;else for(let Z=l-1;Z>=0;--Z)N[k++]=(q&1<<Z)!==0}return N}extractBits(r){let a=this.ddata.isCompact(),l=this.ddata.getNbLayers(),h=(a?11:14)+l*4,d=new Int32Array(h),m=new Array(this.totalBitsInLayer(l,a));if(a)for(let y=0;y<d.length;y++)d[y]=y;else{let y=h+1+2*le.truncDivision(le.truncDivision(h,2)-1,15),_=h/2,v=le.truncDivision(y,2);for(let N=0;N<_;N++){let k=N+le.truncDivision(N,15);d[_-N-1]=v-k-1,d[_+N]=v+k+1}}for(let y=0,_=0;y<l;y++){let v=(l-y)*4+(a?9:12),N=y*2,k=h-1-N;for(let B=0;B<v;B++){let q=B*2;for(let Z=0;Z<2;Z++)m[_+q+Z]=r.get(d[N+Z],d[N+B]),m[_+2*v+q+Z]=r.get(d[N+B],d[k-Z]),m[_+4*v+q+Z]=r.get(d[k-Z],d[k-B]),m[_+6*v+q+Z]=r.get(d[k-B],d[N+Z])}_+=v*8}return m}static readCode(r,a,l){let h=0;for(let d=a;d<a+l;d++)h<<=1,r[d]&&(h|=1);return h}static readByte(r,a){let l=r.length-a;return l>=8?Re.readCode(r,a,8):Re.readCode(r,a,l)<<8-l}static convertBoolArrayToByteArray(r){let a=new Uint8Array((r.length+7)/8);for(let l=0;l<a.length;l++)a[l]=Re.readByte(r,8*l);return a}totalBitsInLayer(r,a){return((a?88:112)+16*r)*r}}Re.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Re.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Re.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Re.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Re.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Fe{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,a,l,h){const d=r-l,m=a-h;return Math.sqrt(d*d+m*m)}static sum(r){let a=0;for(let l=0,h=r.length;l!==h;l++){const d=r[l];a+=d}return a}}class ke{static floatToIntBits(r){return r}}ke.MAX_VALUE=Number.MAX_SAFE_INTEGER;class be{constructor(r,a){this.x=r,this.y=a}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof be){const a=r;return this.x===a.x&&this.y===a.y}return!1}hashCode(){return 31*ke.floatToIntBits(this.x)+ke.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const a=this.distance(r[0],r[1]),l=this.distance(r[1],r[2]),h=this.distance(r[0],r[2]);let d,m,y;if(l>=a&&l>=h?(m=r[0],d=r[1],y=r[2]):h>=l&&h>=a?(m=r[1],d=r[0],y=r[2]):(m=r[2],d=r[0],y=r[1]),this.crossProductZ(d,m,y)<0){const _=d;d=y,y=_}r[0]=d,r[1]=m,r[2]=y}static distance(r,a){return Fe.distance(r.x,r.y,a.x,a.y)}static crossProductZ(r,a,l){const h=a.x,d=a.y;return(l.x-h)*(r.y-d)-(l.y-d)*(r.x-h)}}class Pt{constructor(r,a){this.bits=r,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class vt extends Pt{constructor(r,a,l,h,d){super(r,a),this.compact=l,this.nbDatablocks=h,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Rt{constructor(r,a,l,h){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),a==null&&(a=Rt.INIT_SIZE),l==null&&(l=r.getWidth()/2|0),h==null&&(h=r.getHeight()/2|0);const d=a/2|0;if(this.leftInit=l-d,this.rightInit=l+d,this.upInit=h-d,this.downInit=h+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ce}detect(){let r=this.leftInit,a=this.rightInit,l=this.upInit,h=this.downInit,d=!1,m=!0,y=!1,_=!1,v=!1,N=!1,k=!1;const B=this.width,q=this.height;for(;m;){m=!1;let Z=!0;for(;(Z||!_)&&a<B;)Z=this.containsBlackPoint(l,h,a,!1),Z?(a++,m=!0,_=!0):_||a++;if(a>=B){d=!0;break}let te=!0;for(;(te||!v)&&h<q;)te=this.containsBlackPoint(r,a,h,!0),te?(h++,m=!0,v=!0):v||h++;if(h>=q){d=!0;break}let de=!0;for(;(de||!N)&&r>=0;)de=this.containsBlackPoint(l,h,r,!1),de?(r--,m=!0,N=!0):N||r--;if(r<0){d=!0;break}let _e=!0;for(;(_e||!k)&&l>=0;)_e=this.containsBlackPoint(r,a,l,!0),_e?(l--,m=!0,k=!0):k||l--;if(l<0){d=!0;break}m&&(y=!0)}if(!d&&y){const Z=a-r;let te=null;for(let Ke=1;te===null&&Ke<Z;Ke++)te=this.getBlackPointOnSegment(r,h-Ke,r+Ke,h);if(te==null)throw new ce;let de=null;for(let Ke=1;de===null&&Ke<Z;Ke++)de=this.getBlackPointOnSegment(r,l+Ke,r+Ke,l);if(de==null)throw new ce;let _e=null;for(let Ke=1;_e===null&&Ke<Z;Ke++)_e=this.getBlackPointOnSegment(a,l+Ke,a-Ke,l);if(_e==null)throw new ce;let Je=null;for(let Ke=1;Je===null&&Ke<Z;Ke++)Je=this.getBlackPointOnSegment(a,h-Ke,a-Ke,h);if(Je==null)throw new ce;return this.centerEdges(Je,te,_e,de)}else throw new ce}getBlackPointOnSegment(r,a,l,h){const d=Fe.round(Fe.distance(r,a,l,h)),m=(l-r)/d,y=(h-a)/d,_=this.image;for(let v=0;v<d;v++){const N=Fe.round(r+v*m),k=Fe.round(a+v*y);if(_.get(N,k))return new be(N,k)}return null}centerEdges(r,a,l,h){const d=r.getX(),m=r.getY(),y=a.getX(),_=a.getY(),v=l.getX(),N=l.getY(),k=h.getX(),B=h.getY(),q=Rt.CORR;return d<this.width/2?[new be(k-q,B+q),new be(y+q,_+q),new be(v-q,N-q),new be(d+q,m-q)]:[new be(k+q,B+q),new be(y+q,_-q),new be(v-q,N+q),new be(d-q,m-q)]}containsBlackPoint(r,a,l,h){const d=this.image;if(h){for(let m=r;m<=a;m++)if(d.get(m,l))return!0}else for(let m=r;m<=a;m++)if(d.get(l,m))return!0;return!1}}Rt.INIT_SIZE=10,Rt.CORR=1;class Fn{static checkAndNudgePoints(r,a){const l=r.getWidth(),h=r.getHeight();let d=!0;for(let m=0;m<a.length&&d;m+=2){const y=Math.floor(a[m]),_=Math.floor(a[m+1]);if(y<-1||y>l||_<-1||_>h)throw new ce;d=!1,y===-1?(a[m]=0,d=!0):y===l&&(a[m]=l-1,d=!0),_===-1?(a[m+1]=0,d=!0):_===h&&(a[m+1]=h-1,d=!0)}d=!0;for(let m=a.length-2;m>=0&&d;m-=2){const y=Math.floor(a[m]),_=Math.floor(a[m+1]);if(y<-1||y>l||_<-1||_>h)throw new ce;d=!1,y===-1?(a[m]=0,d=!0):y===l&&(a[m]=l-1,d=!0),_===-1?(a[m+1]=0,d=!0):_===h&&(a[m+1]=h-1,d=!0)}}}class Xt{constructor(r,a,l,h,d,m,y,_,v){this.a11=r,this.a21=a,this.a31=l,this.a12=h,this.a22=d,this.a32=m,this.a13=y,this.a23=_,this.a33=v}static quadrilateralToQuadrilateral(r,a,l,h,d,m,y,_,v,N,k,B,q,Z,te,de){const _e=Xt.quadrilateralToSquare(r,a,l,h,d,m,y,_);return Xt.squareToQuadrilateral(v,N,k,B,q,Z,te,de).times(_e)}transformPoints(r){const a=r.length,l=this.a11,h=this.a12,d=this.a13,m=this.a21,y=this.a22,_=this.a23,v=this.a31,N=this.a32,k=this.a33;for(let B=0;B<a;B+=2){const q=r[B],Z=r[B+1],te=d*q+_*Z+k;r[B]=(l*q+m*Z+v)/te,r[B+1]=(h*q+y*Z+N)/te}}transformPointsWithValues(r,a){const l=this.a11,h=this.a12,d=this.a13,m=this.a21,y=this.a22,_=this.a23,v=this.a31,N=this.a32,k=this.a33,B=r.length;for(let q=0;q<B;q++){const Z=r[q],te=a[q],de=d*Z+_*te+k;r[q]=(l*Z+m*te+v)/de,a[q]=(h*Z+y*te+N)/de}}static squareToQuadrilateral(r,a,l,h,d,m,y,_){const v=r-l+d-y,N=a-h+m-_;if(v===0&&N===0)return new Xt(l-r,d-l,r,h-a,m-h,a,0,0,1);{const k=l-d,B=y-d,q=h-m,Z=_-m,te=k*Z-B*q,de=(v*Z-B*N)/te,_e=(k*N-v*q)/te;return new Xt(l-r+de*l,y-r+_e*y,r,h-a+de*h,_-a+_e*_,a,de,_e,1)}}static quadrilateralToSquare(r,a,l,h,d,m,y,_){return Xt.squareToQuadrilateral(r,a,l,h,d,m,y,_).buildAdjoint()}buildAdjoint(){return new Xt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new Xt(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class yr extends Fn{sampleGrid(r,a,l,h,d,m,y,_,v,N,k,B,q,Z,te,de,_e,Je,Ke){const Ge=Xt.quadrilateralToQuadrilateral(h,d,m,y,_,v,N,k,B,q,Z,te,de,_e,Je,Ke);return this.sampleGridWithTransform(r,a,l,Ge)}sampleGridWithTransform(r,a,l,h){if(a<=0||l<=0)throw new ce;const d=new at(a,l),m=new Float32Array(2*a);for(let y=0;y<l;y++){const _=m.length,v=y+.5;for(let N=0;N<_;N+=2)m[N]=N/2+.5,m[N+1]=v;h.transformPoints(m),Fn.checkAndNudgePoints(r,m);try{for(let N=0;N<_;N+=2)r.get(Math.floor(m[N]),Math.floor(m[N+1]))&&d.set(N/2,y)}catch{throw new ce}}return d}}class xr{static setGridSampler(r){xr.gridSampler=r}static getInstance(){return xr.gridSampler}}xr.gridSampler=new yr;class or{constructor(r,a){this.x=r,this.y=a}toResultPoint(){return new be(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Zr{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let a=this.getMatrixCenter(),l=this.getBullsEyeCorners(a);if(r){let m=l[0];l[0]=l[2],l[2]=m}this.extractParameters(l);let h=this.sampleGrid(this.image,l[this.shift%4],l[(this.shift+1)%4],l[(this.shift+2)%4],l[(this.shift+3)%4]),d=this.getMatrixCornerPoints(l);return new vt(h,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new ce;let a=2*this.nbCenterLayers,l=new Int32Array([this.sampleLine(r[0],r[1],a),this.sampleLine(r[1],r[2],a),this.sampleLine(r[2],r[3],a),this.sampleLine(r[3],r[0],a)]);this.shift=this.getRotation(l,a);let h=0;for(let m=0;m<4;m++){let y=l[(this.shift+m)%4];this.compact?(h<<=7,h+=y>>1&127):(h<<=10,h+=(y>>2&992)+(y>>1&31))}let d=this.getCorrectedParameterData(h,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(r,a){let l=0;r.forEach((h,d,m)=>{let y=(h>>a-2<<1)+(h&1);l=(l<<3)+y}),l=((l&1)<<11)+(l>>1);for(let h=0;h<4;h++)if(le.bitCount(l^this.EXPECTED_CORNER_BITS[h])<=2)return h;throw new ce}getCorrectedParameterData(r,a){let l,h;a?(l=7,h=2):(l=10,h=4);let d=l-h,m=new Int32Array(l);for(let _=l-1;_>=0;--_)m[_]=r&15,r>>=4;try{new De(Lt.AZTEC_PARAM).decode(m,d)}catch{throw new ce}let y=0;for(let _=0;_<h;_++)y=(y<<4)+m[_];return y}getBullsEyeCorners(r){let a=r,l=r,h=r,d=r,m=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let k=this.getFirstDifferent(a,m,1,-1),B=this.getFirstDifferent(l,m,1,1),q=this.getFirstDifferent(h,m,-1,1),Z=this.getFirstDifferent(d,m,-1,-1);if(this.nbCenterLayers>2){let te=this.distancePoint(Z,k)*this.nbCenterLayers/(this.distancePoint(d,a)*(this.nbCenterLayers+2));if(te<.75||te>1.25||!this.isWhiteOrBlackRectangle(k,B,q,Z))break}a=k,l=B,h=q,d=Z,m=!m}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ce;this.compact=this.nbCenterLayers===5;let y=new be(a.getX()+.5,a.getY()-.5),_=new be(l.getX()+.5,l.getY()+.5),v=new be(h.getX()-.5,h.getY()+.5),N=new be(d.getX()-.5,d.getY()-.5);return this.expandSquare([y,_,v,N],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,a,l,h;try{let y=new Rt(this.image).detect();r=y[0],a=y[1],l=y[2],h=y[3]}catch{let _=this.image.getWidth()/2,v=this.image.getHeight()/2;r=this.getFirstDifferent(new or(_+7,v-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new or(_+7,v+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new or(_-7,v+7),!1,-1,1).toResultPoint(),h=this.getFirstDifferent(new or(_-7,v-7),!1,-1,-1).toResultPoint()}let d=Fe.round((r.getX()+h.getX()+a.getX()+l.getX())/4),m=Fe.round((r.getY()+h.getY()+a.getY()+l.getY())/4);try{let y=new Rt(this.image,15,d,m).detect();r=y[0],a=y[1],l=y[2],h=y[3]}catch{r=this.getFirstDifferent(new or(d+7,m-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new or(d+7,m+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new or(d-7,m+7),!1,-1,1).toResultPoint(),h=this.getFirstDifferent(new or(d-7,m-7),!1,-1,-1).toResultPoint()}return d=Fe.round((r.getX()+h.getX()+a.getX()+l.getX())/4),m=Fe.round((r.getY()+h.getY()+a.getY()+l.getY())/4),new or(d,m)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,a,l,h,d){let m=xr.getInstance(),y=this.getDimension(),_=y/2-this.nbCenterLayers,v=y/2+this.nbCenterLayers;return m.sampleGrid(r,y,y,_,_,v,_,v,v,_,v,a.getX(),a.getY(),l.getX(),l.getY(),h.getX(),h.getY(),d.getX(),d.getY())}sampleLine(r,a,l){let h=0,d=this.distanceResultPoint(r,a),m=d/l,y=r.getX(),_=r.getY(),v=m*(a.getX()-r.getX())/d,N=m*(a.getY()-r.getY())/d;for(let k=0;k<l;k++)this.image.get(Fe.round(y+k*v),Fe.round(_+k*N))&&(h|=1<<l-k-1);return h}isWhiteOrBlackRectangle(r,a,l,h){let d=3;r=new or(r.getX()-d,r.getY()+d),a=new or(a.getX()-d,a.getY()-d),l=new or(l.getX()+d,l.getY()-d),h=new or(h.getX()+d,h.getY()+d);let m=this.getColor(h,r);if(m===0)return!1;let y=this.getColor(r,a);return y!==m||(y=this.getColor(a,l),y!==m)?!1:(y=this.getColor(l,h),y===m)}getColor(r,a){let l=this.distancePoint(r,a),h=(a.getX()-r.getX())/l,d=(a.getY()-r.getY())/l,m=0,y=r.getX(),_=r.getY(),v=this.image.get(r.getX(),r.getY()),N=Math.ceil(l);for(let B=0;B<N;B++)y+=h,_+=d,this.image.get(Fe.round(y),Fe.round(_))!==v&&m++;let k=m/l;return k>.1&&k<.9?0:k<=.1===v?1:-1}getFirstDifferent(r,a,l,h){let d=r.getX()+l,m=r.getY()+h;for(;this.isValid(d,m)&&this.image.get(d,m)===a;)d+=l,m+=h;for(d-=l,m-=h;this.isValid(d,m)&&this.image.get(d,m)===a;)d+=l;for(d-=l;this.isValid(d,m)&&this.image.get(d,m)===a;)m+=h;return m-=h,new or(d,m)}expandSquare(r,a,l){let h=l/(2*a),d=r[0].getX()-r[2].getX(),m=r[0].getY()-r[2].getY(),y=(r[0].getX()+r[2].getX())/2,_=(r[0].getY()+r[2].getY())/2,v=new be(y+h*d,_+h*m),N=new be(y-h*d,_-h*m);d=r[1].getX()-r[3].getX(),m=r[1].getY()-r[3].getY(),y=(r[1].getX()+r[3].getX())/2,_=(r[1].getY()+r[3].getY())/2;let k=new be(y+h*d,_+h*m),B=new be(y-h*d,_-h*m);return[v,k,N,B]}isValid(r,a){return r>=0&&r<this.image.getWidth()&&a>0&&a<this.image.getHeight()}isValidPoint(r){let a=Fe.round(r.getX()),l=Fe.round(r.getY());return this.isValid(a,l)}distancePoint(r,a){return Fe.distance(r.getX(),r.getY(),a.getX(),a.getY())}distanceResultPoint(r,a){return Fe.distance(r.getX(),r.getY(),a.getX(),a.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(le.truncDivision(this.nbLayers-4,8)+1)+15}}class Ti{decode(r,a=null){let l=null,h=new Zr(r.getBlackMatrix()),d=null,m=null;try{let N=h.detectMirror(!1);d=N.getPoints(),this.reportFoundResultPoints(a,d),m=new Re().decode(N)}catch(N){l=N}if(m==null)try{let N=h.detectMirror(!0);d=N.getPoints(),this.reportFoundResultPoints(a,d),m=new Re().decode(N)}catch(N){throw l??N}let y=new Te(m.getText(),m.getRawBytes(),m.getNumBits(),d,ve.AZTEC,re.currentTimeMillis()),_=m.getByteSegments();_!=null&&y.putMetadata(xt.BYTE_SEGMENTS,_);let v=m.getECLevel();return v!=null&&y.putMetadata(xt.ERROR_CORRECTION_LEVEL,v),y}reportFoundResultPoints(r,a){if(r!=null){let l=r.get(Ze.NEED_RESULT_POINT_CALLBACK);l!=null&&a.forEach((h,d,m)=>{l.foundPossibleResultPoint(h)})}}reset(){}}class ki extends pe{constructor(r=500){super(new Ti,r)}}class tn{decode(r,a){try{return this.doDecode(r,a)}catch{if(a&&a.get(Ze.TRY_HARDER)===!0&&r.isRotateSupported()){const d=r.rotateCounterClockwise(),m=this.doDecode(d,a),y=m.getResultMetadata();let _=270;y!==null&&y.get(xt.ORIENTATION)===!0&&(_=_+y.get(xt.ORIENTATION)%360),m.putMetadata(xt.ORIENTATION,_);const v=m.getResultPoints();if(v!==null){const N=d.getHeight();for(let k=0;k<v.length;k++)v[k]=new be(N-v[k].getY()-1,v[k].getX())}return m}else throw new ce}}reset(){}doDecode(r,a){const l=r.getWidth(),h=r.getHeight();let d=new Ue(l);const m=a&&a.get(Ze.TRY_HARDER)===!0,y=Math.max(1,h>>(m?8:5));let _;m?_=h:_=15;const v=Math.trunc(h/2);for(let N=0;N<_;N++){const k=Math.trunc((N+1)/2),B=(N&1)===0,q=v+y*(B?k:-k);if(q<0||q>=h)break;try{d=r.getBlackRow(q,d)}catch{continue}for(let Z=0;Z<2;Z++){if(Z===1&&(d.reverse(),a&&a.get(Ze.NEED_RESULT_POINT_CALLBACK)===!0)){const te=new Map;a.forEach((de,_e)=>te.set(_e,de)),te.delete(Ze.NEED_RESULT_POINT_CALLBACK),a=te}try{const te=this.decodeRow(q,d,a);if(Z===1){te.putMetadata(xt.ORIENTATION,180);const de=te.getResultPoints();de!==null&&(de[0]=new be(l-de[0].getX()-1,de[0].getY()),de[1]=new be(l-de[1].getX()-1,de[1].getY()))}return te}catch{}}}throw new ce}static recordPattern(r,a,l){const h=l.length;for(let v=0;v<h;v++)l[v]=0;const d=r.getSize();if(a>=d)throw new ce;let m=!r.get(a),y=0,_=a;for(;_<d;){if(r.get(_)!==m)l[y]++;else{if(++y===h)break;l[y]=1,m=!m}_++}if(!(y===h||y===h-1&&_===d))throw new ce}static recordPatternInReverse(r,a,l){let h=l.length,d=r.get(a);for(;a>0&&h>=0;)r.get(--a)!==d&&(h--,d=!d);if(h>=0)throw new ce;tn.recordPattern(r,a+1,l)}static patternMatchVariance(r,a,l){const h=r.length;let d=0,m=0;for(let v=0;v<h;v++)d+=r[v],m+=a[v];if(d<m)return Number.POSITIVE_INFINITY;const y=d/m;l*=y;let _=0;for(let v=0;v<h;v++){const N=r[v],k=a[v]*y,B=N>k?N-k:k-N;if(B>l)return Number.POSITIVE_INFINITY;_+=B}return _/d}}class ze extends tn{static findStartPattern(r){const a=r.getSize(),l=r.getNextSet(0);let h=0,d=Int32Array.from([0,0,0,0,0,0]),m=l,y=!1;const _=6;for(let v=l;v<a;v++)if(r.get(v)!==y)d[h]++;else{if(h===_-1){let N=ze.MAX_AVG_VARIANCE,k=-1;for(let B=ze.CODE_START_A;B<=ze.CODE_START_C;B++){const q=tn.patternMatchVariance(d,ze.CODE_PATTERNS[B],ze.MAX_INDIVIDUAL_VARIANCE);q<N&&(N=q,k=B)}if(k>=0&&r.isRange(Math.max(0,m-(v-m)/2),m,!1))return Int32Array.from([m,v,k]);m+=d[0]+d[1],d=d.slice(2,d.length-1),d[h-1]=0,d[h]=0,h--}else h++;d[h]=1,y=!y}throw new ce}static decodeCode(r,a,l){tn.recordPattern(r,l,a);let h=ze.MAX_AVG_VARIANCE,d=-1;for(let m=0;m<ze.CODE_PATTERNS.length;m++){const y=ze.CODE_PATTERNS[m],_=this.patternMatchVariance(a,y,ze.MAX_INDIVIDUAL_VARIANCE);_<h&&(h=_,d=m)}if(d>=0)return d;throw new ce}decodeRow(r,a,l){const h=l&&l.get(Ze.ASSUME_GS1)===!0,d=ze.findStartPattern(a),m=d[2];let y=0;const _=new Uint8Array(20);_[y++]=m;let v;switch(m){case ze.CODE_START_A:v=ze.CODE_CODE_A;break;case ze.CODE_START_B:v=ze.CODE_CODE_B;break;case ze.CODE_START_C:v=ze.CODE_CODE_C;break;default:throw new F}let N=!1,k=!1,B="",q=d[0],Z=d[1];const te=Int32Array.from([0,0,0,0,0,0]);let de=0,_e=0,Je=m,Ke=0,Ge=!0,ln=!1,Kt=!1;for(;!N;){const ga=k;switch(k=!1,de=_e,_e=ze.decodeCode(a,te,Z),_[y++]=_e,_e!==ze.CODE_STOP&&(Ge=!0),_e!==ze.CODE_STOP&&(Ke++,Je+=Ke*_e),q=Z,Z+=te.reduce((Qu,Tc)=>Qu+Tc,0),_e){case ze.CODE_START_A:case ze.CODE_START_B:case ze.CODE_START_C:throw new F}switch(v){case ze.CODE_CODE_A:if(_e<64)Kt===ln?B+=String.fromCharCode(32+_e):B+=String.fromCharCode(32+_e+128),Kt=!1;else if(_e<96)Kt===ln?B+=String.fromCharCode(_e-64):B+=String.fromCharCode(_e+64),Kt=!1;else switch(_e!==ze.CODE_STOP&&(Ge=!1),_e){case ze.CODE_FNC_1:h&&(B.length===0?B+="]C1":B+="");break;case ze.CODE_FNC_2:case ze.CODE_FNC_3:break;case ze.CODE_FNC_4_A:!ln&&Kt?(ln=!0,Kt=!1):ln&&Kt?(ln=!1,Kt=!1):Kt=!0;break;case ze.CODE_SHIFT:k=!0,v=ze.CODE_CODE_B;break;case ze.CODE_CODE_B:v=ze.CODE_CODE_B;break;case ze.CODE_CODE_C:v=ze.CODE_CODE_C;break;case ze.CODE_STOP:N=!0;break}break;case ze.CODE_CODE_B:if(_e<96)Kt===ln?B+=String.fromCharCode(32+_e):B+=String.fromCharCode(32+_e+128),Kt=!1;else switch(_e!==ze.CODE_STOP&&(Ge=!1),_e){case ze.CODE_FNC_1:h&&(B.length===0?B+="]C1":B+="");break;case ze.CODE_FNC_2:case ze.CODE_FNC_3:break;case ze.CODE_FNC_4_B:!ln&&Kt?(ln=!0,Kt=!1):ln&&Kt?(ln=!1,Kt=!1):Kt=!0;break;case ze.CODE_SHIFT:k=!0,v=ze.CODE_CODE_A;break;case ze.CODE_CODE_A:v=ze.CODE_CODE_A;break;case ze.CODE_CODE_C:v=ze.CODE_CODE_C;break;case ze.CODE_STOP:N=!0;break}break;case ze.CODE_CODE_C:if(_e<100)_e<10&&(B+="0"),B+=_e;else switch(_e!==ze.CODE_STOP&&(Ge=!1),_e){case ze.CODE_FNC_1:h&&(B.length===0?B+="]C1":B+="");break;case ze.CODE_CODE_A:v=ze.CODE_CODE_A;break;case ze.CODE_CODE_B:v=ze.CODE_CODE_B;break;case ze.CODE_STOP:N=!0;break}break}ga&&(v=v===ze.CODE_CODE_A?ze.CODE_CODE_B:ze.CODE_CODE_A)}const Sr=Z-q;if(Z=a.getNextUnset(Z),!a.isRange(Z,Math.min(a.getSize(),Z+(Z-q)/2),!1))throw new ce;if(Je-=Ke*de,Je%103!==de)throw new L;const Fi=B.length;if(Fi===0)throw new ce;Fi>0&&Ge&&(v===ze.CODE_CODE_C?B=B.substring(0,Fi-2):B=B.substring(0,Fi-1));const ii=(d[1]+d[0])/2,Gn=q+Sr/2,Kr=_.length,Ni=new Uint8Array(Kr);for(let ga=0;ga<Kr;ga++)Ni[ga]=_[ga];const Qa=[new be(ii,r),new be(Gn,r)];return new Te(B,Ni,0,Qa,ve.CODE_128,new Date().getTime())}}ze.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],ze.MAX_AVG_VARIANCE=.25,ze.MAX_INDIVIDUAL_VARIANCE=.7,ze.CODE_SHIFT=98,ze.CODE_CODE_C=99,ze.CODE_CODE_B=100,ze.CODE_CODE_A=101,ze.CODE_FNC_1=102,ze.CODE_FNC_2=97,ze.CODE_FNC_3=96,ze.CODE_FNC_4_A=101,ze.CODE_FNC_4_B=100,ze.CODE_START_A=103,ze.CODE_START_B=104,ze.CODE_START_C=105,ze.CODE_STOP=106;class zt extends tn{constructor(r=!1,a=!1){super(),this.usingCheckDigit=r,this.extendedMode=a,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,a,l){let h=this.counters;h.fill(0),this.decodeRowResult="";let d=zt.findAsteriskPattern(a,h),m=a.getNextSet(d[1]),y=a.getSize(),_,v;do{zt.recordPattern(a,m,h);let te=zt.toNarrowWidePattern(h);if(te<0)throw new ce;_=zt.patternToChar(te),this.decodeRowResult+=_,v=m;for(let de of h)m+=de;m=a.getNextSet(m)}while(_!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let N=0;for(let te of h)N+=te;let k=m-v-N;if(m!==y&&k*2<N)throw new ce;if(this.usingCheckDigit){let te=this.decodeRowResult.length-1,de=0;for(let _e=0;_e<te;_e++)de+=zt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(_e));if(this.decodeRowResult.charAt(te)!==zt.ALPHABET_STRING.charAt(de%43))throw new L;this.decodeRowResult=this.decodeRowResult.substring(0,te)}if(this.decodeRowResult.length===0)throw new ce;let B;this.extendedMode?B=zt.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;let q=(d[1]+d[0])/2,Z=v+N/2;return new Te(B,null,0,[new be(q,r),new be(Z,r)],ve.CODE_39,new Date().getTime())}static findAsteriskPattern(r,a){let l=r.getSize(),h=r.getNextSet(0),d=0,m=h,y=!1,_=a.length;for(let v=h;v<l;v++)if(r.get(v)!==y)a[d]++;else{if(d===_-1){if(this.toNarrowWidePattern(a)===zt.ASTERISK_ENCODING&&r.isRange(Math.max(0,m-Math.floor((v-m)/2)),m,!1))return[m,v];m+=a[0]+a[1],a.copyWithin(0,2,2+d-1),a[d-1]=0,a[d]=0,d--}else d++;a[d]=1,y=!y}throw new ce}static toNarrowWidePattern(r){let a=r.length,l=0,h;do{let d=2147483647;for(let _ of r)_<d&&_>l&&(d=_);l=d,h=0;let m=0,y=0;for(let _=0;_<a;_++){let v=r[_];v>l&&(y|=1<<a-1-_,h++,m+=v)}if(h===3){for(let _=0;_<a&&h>0;_++){let v=r[_];if(v>l&&(h--,v*2>=m))return-1}return y}}while(h>3);return-1}static patternToChar(r){for(let a=0;a<zt.CHARACTER_ENCODINGS.length;a++)if(zt.CHARACTER_ENCODINGS[a]===r)return zt.ALPHABET_STRING.charAt(a);if(r===zt.ASTERISK_ENCODING)return"*";throw new ce}static decodeExtended(r){let a=r.length,l="";for(let h=0;h<a;h++){let d=r.charAt(h);if(d==="+"||d==="$"||d==="%"||d==="/"){let m=r.charAt(h+1),y="\0";switch(d){case"+":if(m>="A"&&m<="Z")y=String.fromCharCode(m.charCodeAt(0)+32);else throw new F;break;case"$":if(m>="A"&&m<="Z")y=String.fromCharCode(m.charCodeAt(0)-64);else throw new F;break;case"%":if(m>="A"&&m<="E")y=String.fromCharCode(m.charCodeAt(0)-38);else if(m>="F"&&m<="J")y=String.fromCharCode(m.charCodeAt(0)-11);else if(m>="K"&&m<="O")y=String.fromCharCode(m.charCodeAt(0)+16);else if(m>="P"&&m<="T")y=String.fromCharCode(m.charCodeAt(0)+43);else if(m==="U")y="\0";else if(m==="V")y="@";else if(m==="W")y="`";else if(m==="X"||m==="Y"||m==="Z")y="";else throw new F;break;case"/":if(m>="A"&&m<="O")y=String.fromCharCode(m.charCodeAt(0)-32);else if(m==="Z")y=":";else throw new F;break}l+=y,h++}else l+=d}return l}}zt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",zt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],zt.ASTERISK_ENCODING=148;class wt extends tn{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,a,l){let h=this.decodeStart(a),d=this.decodeEnd(a),m=new G;wt.decodeMiddle(a,h[1],d[0],m);let y=m.toString(),_=null;l!=null&&(_=l.get(Ze.ALLOWED_LENGTHS)),_==null&&(_=wt.DEFAULT_ALLOWED_LENGTHS);let v=y.length,N=!1,k=0;for(let Z of _){if(v===Z){N=!0;break}Z>k&&(k=Z)}if(!N&&v>k&&(N=!0),!N)throw new F;const B=[new be(h[1],r),new be(d[0],r)];return new Te(y,null,0,B,ve.ITF,new Date().getTime())}static decodeMiddle(r,a,l,h){let d=new Int32Array(10),m=new Int32Array(5),y=new Int32Array(5);for(d.fill(0),m.fill(0),y.fill(0);a<l;){tn.recordPattern(r,a,d);for(let v=0;v<5;v++){let N=2*v;m[v]=d[N],y[v]=d[N+1]}let _=wt.decodeDigit(m);h.append(_.toString()),_=this.decodeDigit(y),h.append(_.toString()),d.forEach(function(v){a+=v})}}decodeStart(r){let a=wt.skipWhiteSpace(r),l=wt.findGuardPattern(r,a,wt.START_PATTERN);return this.narrowLineWidth=(l[1]-l[0])/4,this.validateQuietZone(r,l[0]),l}validateQuietZone(r,a){let l=this.narrowLineWidth*10;l=l<a?l:a;for(let h=a-1;l>0&&h>=0&&!r.get(h);h--)l--;if(l!==0)throw new ce}static skipWhiteSpace(r){const a=r.getSize(),l=r.getNextSet(0);if(l===a)throw new ce;return l}decodeEnd(r){r.reverse();try{let a=wt.skipWhiteSpace(r),l;try{l=wt.findGuardPattern(r,a,wt.END_PATTERN_REVERSED[0])}catch(d){d instanceof ce&&(l=wt.findGuardPattern(r,a,wt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,l[0]);let h=l[0];return l[0]=r.getSize()-l[1],l[1]=r.getSize()-h,l}finally{r.reverse()}}static findGuardPattern(r,a,l){let h=l.length,d=new Int32Array(h),m=r.getSize(),y=!1,_=0,v=a;d.fill(0);for(let N=a;N<m;N++)if(r.get(N)!==y)d[_]++;else{if(_===h-1){if(tn.patternMatchVariance(d,l,wt.MAX_INDIVIDUAL_VARIANCE)<wt.MAX_AVG_VARIANCE)return[v,N];v+=d[0]+d[1],re.arraycopy(d,2,d,0,_-1),d[_-1]=0,d[_]=0,_--}else _++;d[_]=1,y=!y}throw new ce}static decodeDigit(r){let a=wt.MAX_AVG_VARIANCE,l=-1,h=wt.PATTERNS.length;for(let d=0;d<h;d++){let m=wt.PATTERNS[d],y=tn.patternMatchVariance(r,m,wt.MAX_INDIVIDUAL_VARIANCE);y<a?(a=y,l=d):y===a&&(l=-1)}if(l>=0)return l%10;throw new ce}}wt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],wt.MAX_AVG_VARIANCE=.38,wt.MAX_INDIVIDUAL_VARIANCE=.5,wt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],wt.START_PATTERN=Int32Array.from([1,1,1,1]),wt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class _n extends tn{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let a=!1,l,h=0,d=Int32Array.from([0,0,0]);for(;!a;){d=Int32Array.from([0,0,0]),l=_n.findGuardPattern(r,h,!1,this.START_END_PATTERN,d);let m=l[0];h=l[1];let y=m-(h-m);y>=0&&(a=r.isRange(y,m,!1))}return l}static checkChecksum(r){return _n.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let a=r.length;if(a===0)return!1;let l=parseInt(r.charAt(a-1),10);return _n.getStandardUPCEANChecksum(r.substring(0,a-1))===l}static getStandardUPCEANChecksum(r){let a=r.length,l=0;for(let h=a-1;h>=0;h-=2){let d=r.charAt(h).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}l*=3;for(let h=a-2;h>=0;h-=2){let d=r.charAt(h).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}return(1e3-l)%10}static decodeEnd(r,a){return _n.findGuardPattern(r,a,!1,_n.START_END_PATTERN,new Int32Array(_n.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,a,l,h){return this.findGuardPattern(r,a,l,h,new Int32Array(h.length))}static findGuardPattern(r,a,l,h,d){let m=r.getSize();a=l?r.getNextUnset(a):r.getNextSet(a);let y=0,_=a,v=h.length,N=l;for(let k=a;k<m;k++)if(r.get(k)!==N)d[y]++;else{if(y===v-1){if(tn.patternMatchVariance(d,h,_n.MAX_INDIVIDUAL_VARIANCE)<_n.MAX_AVG_VARIANCE)return Int32Array.from([_,k]);_+=d[0]+d[1];let B=d.slice(2,d.length-1);for(let q=0;q<y-1;q++)d[q]=B[q];d[y-1]=0,d[y]=0,y--}else y++;d[y]=1,N=!N}throw new ce}static decodeDigit(r,a,l,h){this.recordPattern(r,l,a);let d=this.MAX_AVG_VARIANCE,m=-1,y=h.length;for(let _=0;_<y;_++){let v=h[_],N=tn.patternMatchVariance(a,v,_n.MAX_INDIVIDUAL_VARIANCE);N<d&&(d=N,m=_)}if(m>=0)return m;throw new ce}}_n.MAX_AVG_VARIANCE=.48,_n.MAX_INDIVIDUAL_VARIANCE=.7,_n.START_END_PATTERN=Int32Array.from([1,1,1]),_n.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),_n.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),_n.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class vr{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,a,l){let h=this.decodeRowStringBuffer,d=this.decodeMiddle(a,l,h),m=h.toString(),y=vr.parseExtensionString(m),_=[new be((l[0]+l[1])/2,r),new be(d,r)],v=new Te(m,null,0,_,ve.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&v.putAllMetadata(y),v}decodeMiddle(r,a,l){let h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let d=r.getSize(),m=a[1],y=0;for(let v=0;v<5&&m<d;v++){let N=_n.decodeDigit(r,h,m,_n.L_AND_G_PATTERNS);l+=String.fromCharCode(48+N%10);for(let k of h)m+=k;N>=10&&(y|=1<<4-v),v!==4&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(l.length!==5)throw new ce;let _=this.determineCheckDigit(y);if(vr.extensionChecksum(l.toString())!==_)throw new ce;return m}static extensionChecksum(r){let a=r.length,l=0;for(let h=a-2;h>=0;h-=2)l+=r.charAt(h).charCodeAt(0)-48;l*=3;for(let h=a-1;h>=0;h-=2)l+=r.charAt(h).charCodeAt(0)-48;return l*=3,l%10}determineCheckDigit(r){for(let a=0;a<10;a++)if(r===this.CHECK_DIGIT_ENCODINGS[a])return a;throw new ce}static parseExtensionString(r){if(r.length!==5)return null;let a=vr.parseExtension5String(r);return a==null?null:new Map([[xt.SUGGESTED_PRICE,a]])}static parseExtension5String(r){let a;switch(r.charAt(0)){case"0":a="";break;case"5":a="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}a="";break;default:a="";break}let l=parseInt(r.substring(1)),h=(l/100).toString(),d=l%100,m=d<10?"0"+d:d.toString();return a+h+"."+m}}class Xr{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,a,l){let h=this.decodeRowStringBuffer,d=this.decodeMiddle(a,l,h),m=h.toString(),y=Xr.parseExtensionString(m),_=[new be((l[0]+l[1])/2,r),new be(d,r)],v=new Te(m,null,0,_,ve.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&v.putAllMetadata(y),v}decodeMiddle(r,a,l){let h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let d=r.getSize(),m=a[1],y=0;for(let _=0;_<2&&m<d;_++){let v=_n.decodeDigit(r,h,m,_n.L_AND_G_PATTERNS);l+=String.fromCharCode(48+v%10);for(let N of h)m+=N;v>=10&&(y|=1<<1-_),_!==1&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(l.length!==2)throw new ce;if(parseInt(l.toString())%4!==y)throw new ce;return m}static parseExtensionString(r){return r.length!==2?null:new Map([[xt.ISSUE_NUMBER,parseInt(r)]])}}class Tr{static decodeRow(r,a,l){let h=_n.findGuardPattern(a,l,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new vr().decodeRow(r,a,h)}catch{return new Xr().decodeRow(r,a,h)}}}Tr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Bt extends _n{constructor(){super(),this.decodeRowStringBuffer="",Bt.L_AND_G_PATTERNS=Bt.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let a=Bt.L_PATTERNS[r-10],l=new Int32Array(a.length);for(let h=0;h<a.length;h++)l[h]=a[a.length-h-1];Bt.L_AND_G_PATTERNS[r]=l}}decodeRow(r,a,l){let h=Bt.findStartGuardPattern(a),d=l==null?null:l.get(Ze.NEED_RESULT_POINT_CALLBACK);if(d!=null){const Ge=new be((h[0]+h[1])/2,r);d.foundPossibleResultPoint(Ge)}let m=this.decodeMiddle(a,h,this.decodeRowStringBuffer),y=m.rowOffset,_=m.resultString;if(d!=null){const Ge=new be(y,r);d.foundPossibleResultPoint(Ge)}let v=this.decodeEnd(a,y);if(d!=null){const Ge=new be((v[0]+v[1])/2,r);d.foundPossibleResultPoint(Ge)}let N=v[1],k=N+(N-v[0]);if(k>=a.getSize()||!a.isRange(N,k,!1))throw new ce;let B=_.toString();if(B.length<8)throw new F;if(!Bt.checkChecksum(B))throw new L;let q=(h[1]+h[0])/2,Z=(v[1]+v[0])/2,te=this.getBarcodeFormat(),de=[new be(q,r),new be(Z,r)],_e=new Te(B,null,0,de,te,new Date().getTime()),Je=0;try{let Ge=Tr.decodeRow(r,a,v[1]);_e.putMetadata(xt.UPC_EAN_EXTENSION,Ge.getText()),_e.putAllMetadata(Ge.getResultMetadata()),_e.addResultPoints(Ge.getResultPoints()),Je=Ge.getText().length}catch{}let Ke=l==null?null:l.get(Ze.ALLOWED_EAN_EXTENSIONS);if(Ke!=null){let Ge=!1;for(let ln in Ke)if(Je.toString()===ln){Ge=!0;break}if(!Ge)throw new ce}return _e}decodeEnd(r,a){return Bt.findGuardPattern(r,a,!1,Bt.START_END_PATTERN,new Int32Array(Bt.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return Bt.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let a=r.length;if(a===0)return!1;let l=parseInt(r.charAt(a-1),10);return Bt.getStandardUPCEANChecksum(r.substring(0,a-1))===l}static getStandardUPCEANChecksum(r){let a=r.length,l=0;for(let h=a-1;h>=0;h-=2){let d=r.charAt(h).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}l*=3;for(let h=a-2;h>=0;h-=2){let d=r.charAt(h).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}return(1e3-l)%10}}class Qt extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,a,l){let h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let d=r.getSize(),m=a[1],y=0;for(let v=0;v<6&&m<d;v++){let N=Bt.decodeDigit(r,h,m,Bt.L_AND_G_PATTERNS);l+=String.fromCharCode(48+N%10);for(let k of h)m+=k;N>=10&&(y|=1<<5-v)}l=Qt.determineFirstDigit(l,y),m=Bt.findGuardPattern(r,m,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let v=0;v<6&&m<d;v++){let N=Bt.decodeDigit(r,h,m,Bt.L_PATTERNS);l+=String.fromCharCode(48+N);for(let k of h)m+=k}return{rowOffset:m,resultString:l}}getBarcodeFormat(){return ve.EAN_13}static determineFirstDigit(r,a){for(let l=0;l<10;l++)if(a===this.FIRST_DIGIT_ENCODINGS[l])return r=String.fromCharCode(48+l)+r,r;throw new ce}}Qt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class jn extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,a,l){const h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let d=r.getSize(),m=a[1];for(let _=0;_<4&&m<d;_++){let v=Bt.decodeDigit(r,h,m,Bt.L_PATTERNS);l+=String.fromCharCode(48+v);for(let N of h)m+=N}m=Bt.findGuardPattern(r,m,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let _=0;_<4&&m<d;_++){let v=Bt.decodeDigit(r,h,m,Bt.L_PATTERNS);l+=String.fromCharCode(48+v);for(let N of h)m+=N}return{rowOffset:m,resultString:l}}getBarcodeFormat(){return ve.EAN_8}}class Mr extends Bt{constructor(){super(...arguments),this.ean13Reader=new Qt}getBarcodeFormat(){return ve.UPC_A}decode(r,a){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,a,l){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,a,l))}decodeMiddle(r,a,l){return this.ean13Reader.decodeMiddle(r,a,l)}maybeReturnResult(r){let a=r.getText();if(a.charAt(0)==="0"){let l=new Te(a.substring(1),null,null,r.getResultPoints(),ve.UPC_A);return r.getResultMetadata()!=null&&l.putAllMetadata(r.getResultMetadata()),l}else throw new ce}reset(){this.ean13Reader.reset()}}class ut extends Bt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,a,l){const h=this.decodeMiddleCounters.map(v=>v);h[0]=0,h[1]=0,h[2]=0,h[3]=0;const d=r.getSize();let m=a[1],y=0;for(let v=0;v<6&&m<d;v++){const N=ut.decodeDigit(r,h,m,ut.L_AND_G_PATTERNS);l+=String.fromCharCode(48+N%10);for(let k of h)m+=k;N>=10&&(y|=1<<5-v)}let _=ut.determineNumSysAndCheckDigit(l,y);return{rowOffset:m,resultString:_}}decodeEnd(r,a){return ut.findGuardPatternWithoutCounters(r,a,!0,ut.MIDDLE_END_PATTERN)}checkChecksum(r){return Bt.checkChecksum(ut.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,a){for(let l=0;l<=1;l++)for(let h=0;h<10;h++)if(a===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[l][h]){let d=String.fromCharCode(48+l),m=String.fromCharCode(48+h);return d+r+m}throw ce.getNotFoundInstance()}getBarcodeFormat(){return ve.UPC_E}static convertUPCEtoUPCA(r){const a=r.slice(1,7).split("").map(d=>d.charCodeAt(0)),l=new G;l.append(r.charAt(0));let h=a[5];switch(h){case 0:case 1:case 2:l.appendChars(a,0,2),l.append(h),l.append("0000"),l.appendChars(a,2,3);break;case 3:l.appendChars(a,0,3),l.append("00000"),l.appendChars(a,3,2);break;case 4:l.appendChars(a,0,4),l.append("00000"),l.append(a[4]);break;default:l.appendChars(a,0,5),l.append("0000"),l.append(h);break}return r.length>=8&&l.append(r.charAt(7)),l.toString()}}ut.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ut.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class nn extends tn{constructor(r){super();let a=r==null?null:r.get(Ze.POSSIBLE_FORMATS),l=[];o(a)?(l.push(new Qt),l.push(new Mr),l.push(new jn),l.push(new ut)):(a.indexOf(ve.EAN_13)>-1&&l.push(new Qt),a.indexOf(ve.UPC_A)>-1&&l.push(new Mr),a.indexOf(ve.EAN_8)>-1&&l.push(new jn),a.indexOf(ve.UPC_E)>-1&&l.push(new ut)),this.readers=l}decodeRow(r,a,l){for(let h of this.readers)try{const d=h.decodeRow(r,a,l),m=d.getBarcodeFormat()===ve.EAN_13&&d.getText().charAt(0)==="0",y=l==null?null:l.get(Ze.POSSIBLE_FORMATS),_=y==null||y.includes(ve.UPC_A);if(m&&_){const v=d.getRawBytes(),N=new Te(d.getText().substring(1),v,v?v.length:null,d.getResultPoints(),ve.UPC_A);return N.putAllMetadata(d.getResultMetadata()),N}return d}catch{}throw new ce}reset(){for(let r of this.readers)r.reset()}}class ie extends tn{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,a){for(let l=0;l<a.length;l++)if(tn.patternMatchVariance(r,a[l],ie.MAX_INDIVIDUAL_VARIANCE)<ie.MAX_AVG_VARIANCE)return l;throw new ce}static count(r){return Fe.sum(new Int32Array(r))}static increment(r,a){let l=0,h=a[0];for(let d=1;d<r.length;d++)a[d]>h&&(h=a[d],l=d);r[l]++}static decrement(r,a){let l=0,h=a[0];for(let d=1;d<r.length;d++)a[d]<h&&(h=a[d],l=d);r[l]--}static isFinderPattern(r){let a=r[0]+r[1],l=a+r[2]+r[3],h=a/l;if(h>=ie.MIN_FINDER_PATTERN_RATIO&&h<=ie.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER;for(let y of r)y>m&&(m=y),y<d&&(d=y);return m<10*d}return!1}}ie.MAX_AVG_VARIANCE=.2,ie.MAX_INDIVIDUAL_VARIANCE=.45,ie.MIN_FINDER_PATTERN_RATIO=9.5/12,ie.MAX_FINDER_PATTERN_RATIO=12.5/14;class Ie{constructor(r,a){this.value=r,this.checksumPortion=a}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof Ie))return!1;const a=r;return this.value===a.value&&this.checksumPortion===a.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class He{constructor(r,a,l,h,d){this.value=r,this.startEnd=a,this.value=r,this.startEnd=a,this.resultPoints=new Array,this.resultPoints.push(new be(l,d)),this.resultPoints.push(new be(h,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof He))return!1;const a=r;return this.value===a.value}hashCode(){return this.value}}class Xe{constructor(){}static getRSSvalue(r,a,l){let h=0;for(let _ of r)h+=_;let d=0,m=0,y=r.length;for(let _=0;_<y-1;_++){let v;for(v=1,m|=1<<_;v<r[_];v++,m&=~(1<<_)){let N=Xe.combins(h-v-1,y-_-2);if(l&&m===0&&h-v-(y-_-1)>=y-_-1&&(N-=Xe.combins(h-v-(y-_),y-_-2)),y-_-1>1){let k=0;for(let B=h-v-(y-_-2);B>a;B--)k+=Xe.combins(h-v-B-1,y-_-3);N-=k*(y-1-_)}else h-v>a&&N--;d+=N}h-=v}return d}static combins(r,a){let l,h;r-a>a?(h=a,l=r-a):(h=r-a,l=a);let d=1,m=1;for(let y=r;y>l;y--)d*=y,m<=h&&(d/=m,m++);for(;m<=h;)d/=m,m++;return d}}class rt{static buildBitArray(r){let a=r.length*2-1;r[r.length-1].getRightChar()==null&&(a-=1);let l=12*a,h=new Ue(l),d=0,y=r[0].getRightChar().getValue();for(let _=11;_>=0;--_)(y&1<<_)!=0&&h.set(d),d++;for(let _=1;_<r.length;++_){let v=r[_],N=v.getLeftChar().getValue();for(let k=11;k>=0;--k)(N&1<<k)!=0&&h.set(d),d++;if(v.getRightChar()!=null){let k=v.getRightChar().getValue();for(let B=11;B>=0;--B)(k&1<<B)!=0&&h.set(d),d++}}return h}}class ft{constructor(r,a){a?this.decodedInformation=null:(this.finished=r,this.decodedInformation=a)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class it{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class Ht extends it{constructor(r,a){super(r),this.value=a}getValue(){return this.value}isFNC1(){return this.value===Ht.FNC1}}Ht.FNC1="$";class St extends it{constructor(r,a,l){super(r),l?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=a}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Vt extends it{constructor(r,a,l){if(super(r),a<0||a>10||l<0||l>10)throw new F;this.firstDigit=a,this.secondDigit=l}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Vt.FNC1}isSecondDigitFNC1(){return this.secondDigit===Vt.FNC1}isAnyFNC1(){return this.firstDigit===Vt.FNC1||this.secondDigit===Vt.FNC1}}Vt.FNC1=10;class Me{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new ce;let a=r.substring(0,2);for(let d of Me.TWO_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(2,d[2],r):Me.processFixedAI(2,d[1],r);if(r.length<3)throw new ce;let l=r.substring(0,3);for(let d of Me.THREE_DIGIT_DATA_LENGTH)if(d[0]===l)return d[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(3,d[2],r):Me.processFixedAI(3,d[1],r);for(let d of Me.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===l)return d[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(4,d[2],r):Me.processFixedAI(4,d[1],r);if(r.length<4)throw new ce;let h=r.substring(0,4);for(let d of Me.FOUR_DIGIT_DATA_LENGTH)if(d[0]===h)return d[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(4,d[2],r):Me.processFixedAI(4,d[1],r);throw new ce}static processFixedAI(r,a,l){if(l.length<r)throw new ce;let h=l.substring(0,r);if(l.length<r+a)throw new ce;let d=l.substring(r,r+a),m=l.substring(r+a),y="("+h+")"+d,_=Me.parseFieldsInGeneralPurpose(m);return _==null?y:y+_}static processVariableAI(r,a,l){let h=l.substring(0,r),d;l.length<r+a?d=l.length:d=r+a;let m=l.substring(r,d),y=l.substring(d),_="("+h+")"+m,v=Me.parseFieldsInGeneralPurpose(y);return v==null?_:_+v}}Me.VARIABLE_LENGTH=[],Me.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Me.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Me.VARIABLE_LENGTH,20],["22",Me.VARIABLE_LENGTH,29],["30",Me.VARIABLE_LENGTH,8],["37",Me.VARIABLE_LENGTH,8],["90",Me.VARIABLE_LENGTH,30],["91",Me.VARIABLE_LENGTH,30],["92",Me.VARIABLE_LENGTH,30],["93",Me.VARIABLE_LENGTH,30],["94",Me.VARIABLE_LENGTH,30],["95",Me.VARIABLE_LENGTH,30],["96",Me.VARIABLE_LENGTH,30],["97",Me.VARIABLE_LENGTH,3],["98",Me.VARIABLE_LENGTH,30],["99",Me.VARIABLE_LENGTH,30]],Me.THREE_DIGIT_DATA_LENGTH=[["240",Me.VARIABLE_LENGTH,30],["241",Me.VARIABLE_LENGTH,30],["242",Me.VARIABLE_LENGTH,6],["250",Me.VARIABLE_LENGTH,30],["251",Me.VARIABLE_LENGTH,30],["253",Me.VARIABLE_LENGTH,17],["254",Me.VARIABLE_LENGTH,20],["400",Me.VARIABLE_LENGTH,30],["401",Me.VARIABLE_LENGTH,30],["402",17],["403",Me.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Me.VARIABLE_LENGTH,20],["421",Me.VARIABLE_LENGTH,15],["422",3],["423",Me.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Me.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Me.VARIABLE_LENGTH,15],["391",Me.VARIABLE_LENGTH,18],["392",Me.VARIABLE_LENGTH,15],["393",Me.VARIABLE_LENGTH,18],["703",Me.VARIABLE_LENGTH,30]],Me.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Me.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Me.VARIABLE_LENGTH,20],["8003",Me.VARIABLE_LENGTH,30],["8004",Me.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Me.VARIABLE_LENGTH,30],["8008",Me.VARIABLE_LENGTH,12],["8018",18],["8020",Me.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Me.VARIABLE_LENGTH,70],["8200",Me.VARIABLE_LENGTH,70]];class sn{constructor(r){this.buffer=new G,this.information=r}decodeAllCodes(r,a){let l=a,h=null;do{let d=this.decodeGeneralPurposeField(l,h),m=Me.parseFieldsInGeneralPurpose(d.getNewString());if(m!=null&&r.append(m),d.isRemaining()?h=""+d.getRemainingValue():h=null,l===d.getNewPosition())break;l=d.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let a=r;a<r+3;++a)if(this.information.get(a))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(r,4);return d===0?new Vt(this.information.getSize(),Vt.FNC1,Vt.FNC1):new Vt(this.information.getSize(),d-1,Vt.FNC1)}let a=this.extractNumericValueFromBitArray(r,7),l=(a-8)/11,h=(a-8)%11;return new Vt(r+7,l,h)}extractNumericValueFromBitArray(r,a){return sn.extractNumericValueFromBitArray(this.information,r,a)}static extractNumericValueFromBitArray(r,a,l){let h=0;for(let d=0;d<l;++d)r.get(a+d)&&(h|=1<<l-d-1);return h}decodeGeneralPurposeField(r,a){this.buffer.setLengthToZero(),a!=null&&this.buffer.append(a),this.current.setPosition(r);let l=this.parseBlocks();return l!=null&&l.isRemaining()?new St(this.current.getPosition(),this.buffer.toString(),l.getRemainingValue()):new St(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,a;do{let l=this.current.getPosition();if(this.current.isAlpha()?(a=this.parseAlphaBlock(),r=a.isFinished()):this.current.isIsoIec646()?(a=this.parseIsoIec646Block(),r=a.isFinished()):(a=this.parseNumericBlock(),r=a.isFinished()),!(l!==this.current.getPosition())&&!r)break}while(!r);return a.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let a;return r.isSecondDigitFNC1()?a=new St(this.current.getPosition(),this.buffer.toString()):a=new St(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new ft(!0,a)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let a=new St(this.current.getPosition(),this.buffer.toString());return new ft(!0,a)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ft(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let a=new St(this.current.getPosition(),this.buffer.toString());return new ft(!0,a)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ft(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let a=new St(this.current.getPosition(),this.buffer.toString());return new ft(!0,a)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ft(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,5);if(a>=5&&a<16)return!0;if(r+7>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,7);if(l>=64&&l<116)return!0;if(r+8>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(r,8);return h>=232&&h<253}decodeIsoIec646(r){let a=this.extractNumericValueFromBitArray(r,5);if(a===15)return new Ht(r+5,Ht.FNC1);if(a>=5&&a<15)return new Ht(r+5,"0"+(a-5));let l=this.extractNumericValueFromBitArray(r,7);if(l>=64&&l<90)return new Ht(r+7,""+(l+1));if(l>=90&&l<116)return new Ht(r+7,""+(l+7));let h=this.extractNumericValueFromBitArray(r,8),d;switch(h){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new F}return new Ht(r+8,d)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,5);if(a>=5&&a<16)return!0;if(r+6>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,6);return l>=16&&l<63}decodeAlphanumeric(r){let a=this.extractNumericValueFromBitArray(r,5);if(a===15)return new Ht(r+5,Ht.FNC1);if(a>=5&&a<15)return new Ht(r+5,"0"+(a-5));let l=this.extractNumericValueFromBitArray(r,6);if(l>=32&&l<58)return new Ht(r+6,""+(l+33));let h;switch(l){case 58:h="*";break;case 59:h=",";break;case 60:h="-";break;case 61:h=".";break;case 62:h="/";break;default:throw new wn("Decoding invalid alphanumeric value: "+l)}return new Ht(r+6,h)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let a=0;a<5&&a+r<this.information.getSize();++a)if(a===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+a))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let a=r;a<r+3;++a)if(this.information.get(a))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let a=0;a<4&&a+r<this.information.getSize();++a)if(this.information.get(r+a))return!1;return!0}}class gt{constructor(r){this.information=r,this.generalDecoder=new sn(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Ot extends gt{constructor(r){super(r)}encodeCompressedGtin(r,a){r.append("(01)");let l=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,a,l)}encodeCompressedGtinWithoutAI(r,a,l){for(let h=0;h<4;++h){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(a+10*h,10);d/100===0&&r.append("0"),d/10===0&&r.append("0"),r.append(d)}Ot.appendCheckDigit(r,l)}static appendCheckDigit(r,a){let l=0;for(let h=0;h<13;h++){let d=r.charAt(h+a).charCodeAt(0)-48;l+=(h&1)===0?3*d:d}l=10-l%10,l===10&&(l=0),r.append(l)}}Ot.GTIN_SIZE=40;class $n extends Ot{constructor(r){super(r)}parseInformation(){let r=new G;r.append("(01)");let a=r.length(),l=this.getGeneralDecoder().extractNumericValueFromBitArray($n.HEADER_SIZE,4);return r.append(l),this.encodeCompressedGtinWithoutAI(r,$n.HEADER_SIZE+4,a),this.getGeneralDecoder().decodeAllCodes(r,$n.HEADER_SIZE+44)}}$n.HEADER_SIZE=4;class fi extends gt{constructor(r){super(r)}parseInformation(){let r=new G;return this.getGeneralDecoder().decodeAllCodes(r,fi.HEADER_SIZE)}}fi.HEADER_SIZE=5;class Ps extends Ot{constructor(r){super(r)}encodeCompressedWeight(r,a,l){let h=this.getGeneralDecoder().extractNumericValueFromBitArray(a,l);this.addWeightCode(r,h);let d=this.checkWeight(h),m=1e5;for(let y=0;y<5;++y)d/m===0&&r.append("0"),m/=10;r.append(d)}}class ri extends Ps{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=ri.HEADER_SIZE+Ps.GTIN_SIZE+ri.WEIGHT_SIZE)throw new ce;let r=new G;return this.encodeCompressedGtin(r,ri.HEADER_SIZE),this.encodeCompressedWeight(r,ri.HEADER_SIZE+Ps.GTIN_SIZE,ri.WEIGHT_SIZE),r.toString()}}ri.HEADER_SIZE=5,ri.WEIGHT_SIZE=15;class Ha extends ri{constructor(r){super(r)}addWeightCode(r,a){r.append("(3103)")}checkWeight(r){return r}}class Li extends ri{constructor(r){super(r)}addWeightCode(r,a){a<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class Yr extends Ot{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Yr.HEADER_SIZE+Ot.GTIN_SIZE)throw new ce;let r=new G;this.encodeCompressedGtin(r,Yr.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Yr.HEADER_SIZE+Ot.GTIN_SIZE,Yr.LAST_DIGIT_SIZE);r.append("(392"),r.append(a),r.append(")");let l=this.getGeneralDecoder().decodeGeneralPurposeField(Yr.HEADER_SIZE+Ot.GTIN_SIZE+Yr.LAST_DIGIT_SIZE,null);return r.append(l.getNewString()),r.toString()}}Yr.HEADER_SIZE=8,Yr.LAST_DIGIT_SIZE=2;class Wn extends Ot{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Wn.HEADER_SIZE+Ot.GTIN_SIZE)throw new ce;let r=new G;this.encodeCompressedGtin(r,Wn.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Wn.HEADER_SIZE+Ot.GTIN_SIZE,Wn.LAST_DIGIT_SIZE);r.append("(393"),r.append(a),r.append(")");let l=this.getGeneralDecoder().extractNumericValueFromBitArray(Wn.HEADER_SIZE+Ot.GTIN_SIZE+Wn.LAST_DIGIT_SIZE,Wn.FIRST_THREE_DIGITS_SIZE);l/100==0&&r.append("0"),l/10==0&&r.append("0"),r.append(l);let h=this.getGeneralDecoder().decodeGeneralPurposeField(Wn.HEADER_SIZE+Ot.GTIN_SIZE+Wn.LAST_DIGIT_SIZE+Wn.FIRST_THREE_DIGITS_SIZE,null);return r.append(h.getNewString()),r.toString()}}Wn.HEADER_SIZE=8,Wn.LAST_DIGIT_SIZE=2,Wn.FIRST_THREE_DIGITS_SIZE=10;class un extends Ps{constructor(r,a,l){super(r),this.dateCode=l,this.firstAIdigits=a}parseInformation(){if(this.getInformation().getSize()!=un.HEADER_SIZE+un.GTIN_SIZE+un.WEIGHT_SIZE+un.DATE_SIZE)throw new ce;let r=new G;return this.encodeCompressedGtin(r,un.HEADER_SIZE),this.encodeCompressedWeight(r,un.HEADER_SIZE+un.GTIN_SIZE,un.WEIGHT_SIZE),this.encodeCompressedDate(r,un.HEADER_SIZE+un.GTIN_SIZE+un.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,a){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(a,un.DATE_SIZE);if(l==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let h=l%32;l/=32;let d=l%12+1;l/=12;let m=l;m/10==0&&r.append("0"),r.append(m),d/10==0&&r.append("0"),r.append(d),h/10==0&&r.append("0"),r.append(h)}addWeightCode(r,a){r.append("("),r.append(this.firstAIdigits),r.append(a/1e5),r.append(")")}checkWeight(r){return r%1e5}}un.HEADER_SIZE=8,un.WEIGHT_SIZE=20,un.DATE_SIZE=16;function Jr(M){try{if(M.get(1))return new $n(M);if(!M.get(2))return new fi(M);switch(sn.extractNumericValueFromBitArray(M,1,4)){case 4:return new Ha(M);case 5:return new Li(M)}switch(sn.extractNumericValueFromBitArray(M,1,5)){case 12:return new Yr(M);case 13:return new Wn(M)}switch(sn.extractNumericValueFromBitArray(M,1,7)){case 56:return new un(M,"310","11");case 57:return new un(M,"320","11");case 58:return new un(M,"310","13");case 59:return new un(M,"320","13");case 60:return new un(M,"310","15");case 61:return new un(M,"320","15");case 62:return new un(M,"310","17");case 63:return new un(M,"320","17")}}catch(r){throw console.log(r),new wn("unknown decoder: "+M)}}class kr{constructor(r,a,l,h){this.leftchar=r,this.rightchar=a,this.finderpattern=l,this.maybeLast=h}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,a){return r instanceof kr?kr.equalsOrNull(r.leftchar,a.leftchar)&&kr.equalsOrNull(r.rightchar,a.rightchar)&&kr.equalsOrNull(r.finderpattern,a.finderpattern):!1}static equalsOrNull(r,a){return r===null?a===null:kr.equals(r,a)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class sr{constructor(r,a,l){this.pairs=r,this.rowNumber=a,this.wasReversed=l}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,a){return r instanceof sr?this.checkEqualitity(r,a)&&r.wasReversed===a.wasReversed:!1}checkEqualitity(r,a){if(!r||!a)return;let l;return r.forEach((h,d)=>{a.forEach(m=>{h.getLeftChar().getValue()===m.getLeftChar().getValue()&&h.getRightChar().getValue()===m.getRightChar().getValue()&&h.getFinderPatter().getValue()===m.getFinderPatter().getValue()&&(l=!0)})}),l}}class Ve extends ie{constructor(r){super(...arguments),this.pairs=new Array(Ve.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,a,l){this.pairs.length=0,this.startFromEven=!1;try{return Ve.constructResult(this.decodeRow2pairs(r,a))}catch(h){this.verbose&&console.log(h)}return this.pairs.length=0,this.startFromEven=!0,Ve.constructResult(this.decodeRow2pairs(r,a))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,a){let l=!1;for(;!l;)try{this.pairs.push(this.retrieveNextPair(a,this.pairs,r))}catch(d){if(d instanceof ce){if(!this.pairs.length)throw new ce;l=!0}}if(this.checkChecksum())return this.pairs;let h;if(this.rows.length?h=!0:h=!1,this.storeRow(r,!1),h){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new ce}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let a=null;try{a=this.checkRows(new Array,0)}catch(l){this.verbose&&console.log(l)}return r&&(this.rows=this.rows.reverse()),a}checkRows(r,a){for(let l=a;l<this.rows.length;l++){let h=this.rows[l];this.pairs.length=0;for(let m of r)this.pairs.push(m.getPairs());if(this.pairs.push(h.getPairs()),!Ve.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(r);d.push(h);try{return this.checkRows(d,l+1)}catch(m){this.verbose&&console.log(m)}}throw new ce}static isValidSequence(r){for(let a of Ve.FINDER_PATTERN_SEQUENCES){if(r.length>a.length)continue;let l=!0;for(let h=0;h<r.length;h++)if(r[h].getFinderPattern().getValue()!=a[h]){l=!1;break}if(l)return!0}return!1}storeRow(r,a){let l=0,h=!1,d=!1;for(;l<this.rows.length;){let m=this.rows[l];if(m.getRowNumber()>r){d=m.isEquivalent(this.pairs);break}h=m.isEquivalent(this.pairs),l++}d||h||Ve.isPartialRow(this.pairs,this.rows)||(this.rows.push(l,new sr(this.pairs,r,a)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,a){for(let l of a)if(l.getPairs().length!==r.length){for(let h of l.getPairs())for(let d of r)if(kr.equals(h,d))break}}static isPartialRow(r,a){for(let l of a){let h=!0;for(let d of r){let m=!1;for(let y of l.getPairs())if(d.equals(y)){m=!0;break}if(!m){h=!1;break}}if(h)return!0}return!1}getRows(){return this.rows}static constructResult(r){let a=rt.buildBitArray(r),h=Jr(a).parseInformation(),d=r[0].getFinderPattern().getResultPoints(),m=r[r.length-1].getFinderPattern().getResultPoints(),y=[d[0],d[1],m[0],m[1]];return new Te(h,null,null,y,ve.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),a=r.getLeftChar(),l=r.getRightChar();if(l==null)return!1;let h=l.getChecksumPortion(),d=2;for(let y=1;y<this.pairs.size();++y){let _=this.pairs.get(y);h+=_.getLeftChar().getChecksumPortion(),d++;let v=_.getRightChar();v!=null&&(h+=v.getChecksumPortion(),d++)}return h%=211,211*(d-4)+h==a.getValue()}static getNextSecondBar(r,a){let l;return r.get(a)?(l=r.getNextUnset(a),l=r.getNextSet(l)):(l=r.getNextSet(a),l=r.getNextUnset(l)),l}retrieveNextPair(r,a,l){let h=a.length%2==0;this.startFromEven&&(h=!h);let d,m=!0,y=-1;do this.findNextPair(r,a,y),d=this.parseFoundFinderPattern(r,l,h),d==null?y=Ve.getNextSecondBar(r,this.startEnd[0]):m=!1;while(m);let _=this.decodeDataCharacter(r,d,h,!0);if(!this.isEmptyPair(a)&&a[a.length-1].mustBeLast())throw new ce;let v;try{v=this.decodeDataCharacter(r,d,h,!1)}catch(N){v=null,this.verbose&&console.log(N)}return new kr(_,v,d,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,a,l){let h=this.getDecodeFinderCounters();h[0]=0,h[1]=0,h[2]=0,h[3]=0;let d=r.getSize(),m;l>=0?m=l:this.isEmptyPair(a)?m=0:m=a[a.length-1].getFinderPattern().getStartEnd()[1];let y=a.length%2!=0;this.startFromEven&&(y=!y);let _=!1;for(;m<d&&(_=!r.get(m),!!_);)m++;let v=0,N=m;for(let k=m;k<d;k++)if(r.get(k)!=_)h[v]++;else{if(v==3){if(y&&Ve.reverseCounters(h),Ve.isFinderPattern(h)){this.startEnd[0]=N,this.startEnd[1]=k;return}y&&Ve.reverseCounters(h),N+=h[0]+h[1],h[0]=h[2],h[1]=h[3],h[2]=0,h[3]=0,v--}else v++;h[v]=1,_=!_}throw new ce}static reverseCounters(r){let a=r.length;for(let l=0;l<a/2;++l){let h=r[l];r[l]=r[a-l-1],r[a-l-1]=h}}parseFoundFinderPattern(r,a,l){let h,d,m;if(l){let v=this.startEnd[0]-1;for(;v>=0&&!r.get(v);)v--;v++,h=this.startEnd[0]-v,d=v,m=this.startEnd[1]}else d=this.startEnd[0],m=r.getNextUnset(this.startEnd[1]+1),h=m-this.startEnd[1];let y=this.getDecodeFinderCounters();re.arraycopy(y,0,y,1,y.length-1),y[0]=h;let _;try{_=this.parseFinderValue(y,Ve.FINDER_PATTERNS)}catch{return null}return new He(_,[d,m],d,m,a)}decodeDataCharacter(r,a,l,h){let d=this.getDataCharacterCounters();for(let Gn=0;Gn<d.length;Gn++)d[Gn]=0;if(h)Ve.recordPatternInReverse(r,a.getStartEnd()[0],d);else{Ve.recordPattern(r,a.getStartEnd()[1],d);for(let Gn=0,Kr=d.length-1;Gn<Kr;Gn++,Kr--){let Ni=d[Gn];d[Gn]=d[Kr],d[Kr]=Ni}}let m=17,y=Fe.sum(new Int32Array(d))/m,_=(a.getStartEnd()[1]-a.getStartEnd()[0])/15;if(Math.abs(y-_)/_>.3)throw new ce;let v=this.getOddCounts(),N=this.getEvenCounts(),k=this.getOddRoundingErrors(),B=this.getEvenRoundingErrors();for(let Gn=0;Gn<d.length;Gn++){let Kr=1*d[Gn]/y,Ni=Kr+.5;if(Ni<1){if(Kr<.3)throw new ce;Ni=1}else if(Ni>8){if(Kr>8.7)throw new ce;Ni=8}let Qa=Gn/2;(Gn&1)==0?(v[Qa]=Ni,k[Qa]=Kr-Ni):(N[Qa]=Ni,B[Qa]=Kr-Ni)}this.adjustOddEvenCounts(m);let q=4*a.getValue()+(l?0:2)+(h?0:1)-1,Z=0,te=0;for(let Gn=v.length-1;Gn>=0;Gn--){if(Ve.isNotA1left(a,l,h)){let Kr=Ve.WEIGHTS[q][2*Gn];te+=v[Gn]*Kr}Z+=v[Gn]}let de=0;for(let Gn=N.length-1;Gn>=0;Gn--)if(Ve.isNotA1left(a,l,h)){let Kr=Ve.WEIGHTS[q][2*Gn+1];de+=N[Gn]*Kr}let _e=te+de;if((Z&1)!=0||Z>13||Z<4)throw new ce;let Je=(13-Z)/2,Ke=Ve.SYMBOL_WIDEST[Je],Ge=9-Ke,ln=Xe.getRSSvalue(v,Ke,!0),Kt=Xe.getRSSvalue(N,Ge,!1),Sr=Ve.EVEN_TOTAL_SUBSET[Je],Fi=Ve.GSUM[Je],ii=ln*Sr+Kt+Fi;return new Ie(ii,_e)}static isNotA1left(r,a,l){return!(r.getValue()==0&&a&&l)}adjustOddEvenCounts(r){let a=Fe.sum(new Int32Array(this.getOddCounts())),l=Fe.sum(new Int32Array(this.getEvenCounts())),h=!1,d=!1;a>13?d=!0:a<4&&(h=!0);let m=!1,y=!1;l>13?y=!0:l<4&&(m=!0);let _=a+l-r,v=(a&1)==1,N=(l&1)==0;if(_==1)if(v){if(N)throw new ce;d=!0}else{if(!N)throw new ce;y=!0}else if(_==-1)if(v){if(N)throw new ce;h=!0}else{if(!N)throw new ce;m=!0}else if(_==0){if(v){if(!N)throw new ce;a<l?(h=!0,y=!0):(d=!0,m=!0)}else if(N)throw new ce}else throw new ce;if(h){if(d)throw new ce;Ve.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Ve.decrement(this.getOddCounts(),this.getOddRoundingErrors()),m){if(y)throw new ce;Ve.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&Ve.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ve.SYMBOL_WIDEST=[7,5,4,3,1],Ve.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Ve.GSUM=[0,348,1388,2948,3988],Ve.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Ve.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Ve.FINDER_PAT_A=0,Ve.FINDER_PAT_B=1,Ve.FINDER_PAT_C=2,Ve.FINDER_PAT_D=3,Ve.FINDER_PAT_E=4,Ve.FINDER_PAT_F=5,Ve.FINDER_PATTERN_SEQUENCES=[[Ve.FINDER_PAT_A,Ve.FINDER_PAT_A],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_B,Ve.FINDER_PAT_B],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_C,Ve.FINDER_PAT_B,Ve.FINDER_PAT_D],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_E,Ve.FINDER_PAT_B,Ve.FINDER_PAT_D,Ve.FINDER_PAT_C],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_E,Ve.FINDER_PAT_B,Ve.FINDER_PAT_D,Ve.FINDER_PAT_D,Ve.FINDER_PAT_F],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_E,Ve.FINDER_PAT_B,Ve.FINDER_PAT_D,Ve.FINDER_PAT_E,Ve.FINDER_PAT_F,Ve.FINDER_PAT_F],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_A,Ve.FINDER_PAT_B,Ve.FINDER_PAT_B,Ve.FINDER_PAT_C,Ve.FINDER_PAT_C,Ve.FINDER_PAT_D,Ve.FINDER_PAT_D],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_A,Ve.FINDER_PAT_B,Ve.FINDER_PAT_B,Ve.FINDER_PAT_C,Ve.FINDER_PAT_C,Ve.FINDER_PAT_D,Ve.FINDER_PAT_E,Ve.FINDER_PAT_E],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_A,Ve.FINDER_PAT_B,Ve.FINDER_PAT_B,Ve.FINDER_PAT_C,Ve.FINDER_PAT_C,Ve.FINDER_PAT_D,Ve.FINDER_PAT_E,Ve.FINDER_PAT_F,Ve.FINDER_PAT_F],[Ve.FINDER_PAT_A,Ve.FINDER_PAT_A,Ve.FINDER_PAT_B,Ve.FINDER_PAT_B,Ve.FINDER_PAT_C,Ve.FINDER_PAT_D,Ve.FINDER_PAT_D,Ve.FINDER_PAT_E,Ve.FINDER_PAT_E,Ve.FINDER_PAT_F,Ve.FINDER_PAT_F]],Ve.MAX_PAIRS=11;class K extends Ie{constructor(r,a,l){super(r,a),this.count=0,this.finderPattern=l}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Se extends ie{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,a,l){const h=this.decodePair(a,!1,r,l);Se.addOrTally(this.possibleLeftPairs,h),a.reverse();let d=this.decodePair(a,!0,r,l);Se.addOrTally(this.possibleRightPairs,d),a.reverse();for(let m of this.possibleLeftPairs)if(m.getCount()>1){for(let y of this.possibleRightPairs)if(y.getCount()>1&&Se.checkChecksum(m,y))return Se.constructResult(m,y)}throw new ce}static addOrTally(r,a){if(a==null)return;let l=!1;for(let h of r)if(h.getValue()===a.getValue()){h.incrementCount(),l=!0;break}l||r.push(a)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,a){let l=4537077*r.getValue()+a.getValue(),h=new String(l).toString(),d=new G;for(let v=13-h.length;v>0;v--)d.append("0");d.append(h);let m=0;for(let v=0;v<13;v++){let N=d.charAt(v).charCodeAt(0)-48;m+=(v&1)===0?3*N:N}m=10-m%10,m===10&&(m=0),d.append(m.toString());let y=r.getFinderPattern().getResultPoints(),_=a.getFinderPattern().getResultPoints();return new Te(d.toString(),null,0,[y[0],y[1],_[0],_[1]],ve.RSS_14,new Date().getTime())}static checkChecksum(r,a){let l=(r.getChecksumPortion()+16*a.getChecksumPortion())%79,h=9*r.getFinderPattern().getValue()+a.getFinderPattern().getValue();return h>72&&h--,h>8&&h--,l===h}decodePair(r,a,l,h){try{let d=this.findFinderPattern(r,a),m=this.parseFoundFinderPattern(r,l,a,d),y=h==null?null:h.get(Ze.NEED_RESULT_POINT_CALLBACK);if(y!=null){let N=(d[0]+d[1])/2;a&&(N=r.getSize()-1-N),y.foundPossibleResultPoint(new be(N,l))}let _=this.decodeDataCharacter(r,m,!0),v=this.decodeDataCharacter(r,m,!1);return new K(1597*_.getValue()+v.getValue(),_.getChecksumPortion()+4*v.getChecksumPortion(),m)}catch{return null}}decodeDataCharacter(r,a,l){let h=this.getDataCharacterCounters();for(let de=0;de<h.length;de++)h[de]=0;if(l)tn.recordPatternInReverse(r,a.getStartEnd()[0],h);else{tn.recordPattern(r,a.getStartEnd()[1]+1,h);for(let de=0,_e=h.length-1;de<_e;de++,_e--){let Je=h[de];h[de]=h[_e],h[_e]=Je}}let d=l?16:15,m=Fe.sum(new Int32Array(h))/d,y=this.getOddCounts(),_=this.getEvenCounts(),v=this.getOddRoundingErrors(),N=this.getEvenRoundingErrors();for(let de=0;de<h.length;de++){let _e=h[de]/m,Je=Math.floor(_e+.5);Je<1?Je=1:Je>8&&(Je=8);let Ke=Math.floor(de/2);(de&1)===0?(y[Ke]=Je,v[Ke]=_e-Je):(_[Ke]=Je,N[Ke]=_e-Je)}this.adjustOddEvenCounts(l,d);let k=0,B=0;for(let de=y.length-1;de>=0;de--)B*=9,B+=y[de],k+=y[de];let q=0,Z=0;for(let de=_.length-1;de>=0;de--)q*=9,q+=_[de],Z+=_[de];let te=B+3*q;if(l){if((k&1)!==0||k>12||k<4)throw new ce;let de=(12-k)/2,_e=Se.OUTSIDE_ODD_WIDEST[de],Je=9-_e,Ke=Xe.getRSSvalue(y,_e,!1),Ge=Xe.getRSSvalue(_,Je,!0),ln=Se.OUTSIDE_EVEN_TOTAL_SUBSET[de],Kt=Se.OUTSIDE_GSUM[de];return new Ie(Ke*ln+Ge+Kt,te)}else{if((Z&1)!==0||Z>10||Z<4)throw new ce;let de=(10-Z)/2,_e=Se.INSIDE_ODD_WIDEST[de],Je=9-_e,Ke=Xe.getRSSvalue(y,_e,!0),Ge=Xe.getRSSvalue(_,Je,!1),ln=Se.INSIDE_ODD_TOTAL_SUBSET[de],Kt=Se.INSIDE_GSUM[de];return new Ie(Ge*ln+Ke+Kt,te)}}findFinderPattern(r,a){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let h=r.getSize(),d=!1,m=0;for(;m<h&&(d=!r.get(m),a!==d);)m++;let y=0,_=m;for(let v=m;v<h;v++)if(r.get(v)!==d)l[y]++;else{if(y===3){if(ie.isFinderPattern(l))return[_,v];_+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,y--}else y++;l[y]=1,d=!d}throw new ce}parseFoundFinderPattern(r,a,l,h){let d=r.get(h[0]),m=h[0]-1;for(;m>=0&&d!==r.get(m);)m--;m++;const y=h[0]-m,_=this.getDecodeFinderCounters(),v=new Int32Array(_.length);re.arraycopy(_,0,v,1,_.length-1),v[0]=y;const N=this.parseFinderValue(v,Se.FINDER_PATTERNS);let k=m,B=h[1];return l&&(k=r.getSize()-1-k,B=r.getSize()-1-B),new He(N,[m,h[1]],k,B,a)}adjustOddEvenCounts(r,a){let l=Fe.sum(new Int32Array(this.getOddCounts())),h=Fe.sum(new Int32Array(this.getEvenCounts())),d=!1,m=!1,y=!1,_=!1;r?(l>12?m=!0:l<4&&(d=!0),h>12?_=!0:h<4&&(y=!0)):(l>11?m=!0:l<5&&(d=!0),h>10?_=!0:h<4&&(y=!0));let v=l+h-a,N=(l&1)===(r?1:0),k=(h&1)===1;if(v===1)if(N){if(k)throw new ce;m=!0}else{if(!k)throw new ce;_=!0}else if(v===-1)if(N){if(k)throw new ce;d=!0}else{if(!k)throw new ce;y=!0}else if(v===0){if(N){if(!k)throw new ce;l<h?(d=!0,_=!0):(m=!0,y=!0)}else if(k)throw new ce}else throw new ce;if(d){if(m)throw new ce;ie.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&ie.decrement(this.getOddCounts(),this.getOddRoundingErrors()),y){if(_)throw new ce;ie.increment(this.getEvenCounts(),this.getOddRoundingErrors())}_&&ie.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Se.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Se.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Se.OUTSIDE_GSUM=[0,161,961,2015,2715],Se.INSIDE_GSUM=[0,336,1036,1516],Se.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Se.INSIDE_ODD_WIDEST=[2,4,6,8],Se.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class $e extends tn{constructor(r,a){super(),this.readers=[],this.verbose=a===!0;const l=r?r.get(Ze.POSSIBLE_FORMATS):null,h=r&&r.get(Ze.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;l?((l.includes(ve.EAN_13)||l.includes(ve.UPC_A)||l.includes(ve.EAN_8)||l.includes(ve.UPC_E))&&this.readers.push(new nn(r)),l.includes(ve.CODE_39)&&this.readers.push(new zt(h)),l.includes(ve.CODE_128)&&this.readers.push(new ze),l.includes(ve.ITF)&&this.readers.push(new wt),l.includes(ve.RSS_14)&&this.readers.push(new Se),l.includes(ve.RSS_EXPANDED)&&this.readers.push(new Ve(this.verbose))):(this.readers.push(new nn(r)),this.readers.push(new zt),this.readers.push(new nn(r)),this.readers.push(new ze),this.readers.push(new wt),this.readers.push(new Se),this.readers.push(new Ve(this.verbose)))}decodeRow(r,a,l){for(let h=0;h<this.readers.length;h++)try{return this.readers[h].decodeRow(r,a,l)}catch{}throw new ce}reset(){this.readers.forEach(r=>r.reset())}}class mt extends pe{constructor(r=500,a){super(new $e(a),r,a)}}class tt{constructor(r,a,l){this.ecCodewords=r,this.ecBlocks=[a],l&&this.ecBlocks.push(l)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class lt{constructor(r,a){this.count=r,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ht{constructor(r,a,l,h,d,m){this.versionNumber=r,this.symbolSizeRows=a,this.symbolSizeColumns=l,this.dataRegionSizeRows=h,this.dataRegionSizeColumns=d,this.ecBlocks=m;let y=0;const _=m.getECCodewords(),v=m.getECBlocks();for(let N of v)y+=N.getCount()*(N.getDataCodewords()+_);this.totalCodewords=y}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,a){if((r&1)!==0||(a&1)!==0)throw new F;for(let l of ht.VERSIONS)if(l.symbolSizeRows===r&&l.symbolSizeColumns===a)return l;throw new F}toString(){return""+this.versionNumber}static buildVersions(){return[new ht(1,10,10,8,8,new tt(5,new lt(1,3))),new ht(2,12,12,10,10,new tt(7,new lt(1,5))),new ht(3,14,14,12,12,new tt(10,new lt(1,8))),new ht(4,16,16,14,14,new tt(12,new lt(1,12))),new ht(5,18,18,16,16,new tt(14,new lt(1,18))),new ht(6,20,20,18,18,new tt(18,new lt(1,22))),new ht(7,22,22,20,20,new tt(20,new lt(1,30))),new ht(8,24,24,22,22,new tt(24,new lt(1,36))),new ht(9,26,26,24,24,new tt(28,new lt(1,44))),new ht(10,32,32,14,14,new tt(36,new lt(1,62))),new ht(11,36,36,16,16,new tt(42,new lt(1,86))),new ht(12,40,40,18,18,new tt(48,new lt(1,114))),new ht(13,44,44,20,20,new tt(56,new lt(1,144))),new ht(14,48,48,22,22,new tt(68,new lt(1,174))),new ht(15,52,52,24,24,new tt(42,new lt(2,102))),new ht(16,64,64,14,14,new tt(56,new lt(2,140))),new ht(17,72,72,16,16,new tt(36,new lt(4,92))),new ht(18,80,80,18,18,new tt(48,new lt(4,114))),new ht(19,88,88,20,20,new tt(56,new lt(4,144))),new ht(20,96,96,22,22,new tt(68,new lt(4,174))),new ht(21,104,104,24,24,new tt(56,new lt(6,136))),new ht(22,120,120,18,18,new tt(68,new lt(6,175))),new ht(23,132,132,20,20,new tt(62,new lt(8,163))),new ht(24,144,144,22,22,new tt(62,new lt(8,156),new lt(2,155))),new ht(25,8,18,6,16,new tt(7,new lt(1,5))),new ht(26,8,32,6,14,new tt(11,new lt(1,10))),new ht(27,12,26,10,24,new tt(14,new lt(1,16))),new ht(28,12,36,10,16,new tt(18,new lt(1,22))),new ht(29,16,36,14,16,new tt(24,new lt(1,32))),new ht(30,16,48,14,22,new tt(28,new lt(1,49)))]}}ht.VERSIONS=ht.buildVersions();class dn{constructor(r){const a=r.getHeight();if(a<8||a>144||(a&1)!==0)throw new F;this.version=dn.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new at(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const a=r.getHeight(),l=r.getWidth();return ht.getVersionForDimensions(a,l)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let a=0,l=4,h=0;const d=this.mappingBitMatrix.getHeight(),m=this.mappingBitMatrix.getWidth();let y=!1,_=!1,v=!1,N=!1;do if(l===d&&h===0&&!y)r[a++]=this.readCorner1(d,m)&255,l-=2,h+=2,y=!0;else if(l===d-2&&h===0&&(m&3)!==0&&!_)r[a++]=this.readCorner2(d,m)&255,l-=2,h+=2,_=!0;else if(l===d+4&&h===2&&(m&7)===0&&!v)r[a++]=this.readCorner3(d,m)&255,l-=2,h+=2,v=!0;else if(l===d-2&&h===0&&(m&7)===4&&!N)r[a++]=this.readCorner4(d,m)&255,l-=2,h+=2,N=!0;else{do l<d&&h>=0&&!this.readMappingMatrix.get(h,l)&&(r[a++]=this.readUtah(l,h,d,m)&255),l-=2,h+=2;while(l>=0&&h<m);l+=1,h+=3;do l>=0&&h<m&&!this.readMappingMatrix.get(h,l)&&(r[a++]=this.readUtah(l,h,d,m)&255),l+=2,h-=2;while(l<d&&h>=0);l+=3,h+=1}while(l<d||h<m);if(a!==this.version.getTotalCodewords())throw new F;return r}readModule(r,a,l,h){return r<0&&(r+=l,a+=4-(l+4&7)),a<0&&(a+=h,r+=4-(h+4&7)),this.readMappingMatrix.set(a,r),this.mappingBitMatrix.get(a,r)}readUtah(r,a,l,h){let d=0;return this.readModule(r-2,a-2,l,h)&&(d|=1),d<<=1,this.readModule(r-2,a-1,l,h)&&(d|=1),d<<=1,this.readModule(r-1,a-2,l,h)&&(d|=1),d<<=1,this.readModule(r-1,a-1,l,h)&&(d|=1),d<<=1,this.readModule(r-1,a,l,h)&&(d|=1),d<<=1,this.readModule(r,a-2,l,h)&&(d|=1),d<<=1,this.readModule(r,a-1,l,h)&&(d|=1),d<<=1,this.readModule(r,a,l,h)&&(d|=1),d}readCorner1(r,a){let l=0;return this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,1,r,a)&&(l|=1),l<<=1,this.readModule(r-1,2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(2,a-1,r,a)&&(l|=1),l<<=1,this.readModule(3,a-1,r,a)&&(l|=1),l}readCorner2(r,a){let l=0;return this.readModule(r-3,0,r,a)&&(l|=1),l<<=1,this.readModule(r-2,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(0,a-4,r,a)&&(l|=1),l<<=1,this.readModule(0,a-3,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l}readCorner3(r,a){let l=0;return this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(0,a-3,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-3,r,a)&&(l|=1),l<<=1,this.readModule(1,a-2,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l}readCorner4(r,a){let l=0;return this.readModule(r-3,0,r,a)&&(l|=1),l<<=1,this.readModule(r-2,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(2,a-1,r,a)&&(l|=1),l<<=1,this.readModule(3,a-1,r,a)&&(l|=1),l}extractDataRegion(r){const a=this.version.getSymbolSizeRows(),l=this.version.getSymbolSizeColumns();if(r.getHeight()!==a)throw new R("Dimension of bitMatrix must match the version size");const h=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),m=a/h|0,y=l/d|0,_=m*h,v=y*d,N=new at(v,_);for(let k=0;k<m;++k){const B=k*h;for(let q=0;q<y;++q){const Z=q*d;for(let te=0;te<h;++te){const de=k*(h+2)+1+te,_e=B+te;for(let Je=0;Je<d;++Je){const Ke=q*(d+2)+1+Je;if(r.get(Ke,de)){const Ge=Z+Je;N.set(Ge,_e)}}}}}return N}}class fn{constructor(r,a){this.numDataCodewords=r,this.codewords=a}static getDataBlocks(r,a){const l=a.getECBlocks();let h=0;const d=l.getECBlocks();for(let te of d)h+=te.getCount();const m=new Array(h);let y=0;for(let te of d)for(let de=0;de<te.getCount();de++){const _e=te.getDataCodewords(),Je=l.getECCodewords()+_e;m[y++]=new fn(_e,new Uint8Array(Je))}const v=m[0].codewords.length-l.getECCodewords(),N=v-1;let k=0;for(let te=0;te<N;te++)for(let de=0;de<y;de++)m[de].codewords[te]=r[k++];const B=a.getVersionNumber()===24,q=B?8:y;for(let te=0;te<q;te++)m[te].codewords[v-1]=r[k++];const Z=m[0].codewords.length;for(let te=v;te<Z;te++)for(let de=0;de<y;de++){const _e=B?(de+8)%y:de,Je=B&&_e>7?te-1:te;m[_e].codewords[Je]=r[k++]}if(k!==r.length)throw new R;return m}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Rn{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new R(""+r);let a=0,l=this.bitOffset,h=this.byteOffset;const d=this.bytes;if(l>0){const m=8-l,y=r<m?r:m,_=m-y,v=255>>8-y<<_;a=(d[h]&v)>>_,r-=y,l+=y,l===8&&(l=0,h++)}if(r>0){for(;r>=8;)a=a<<8|d[h]&255,h++,r-=8;if(r>0){const m=8-r,y=255>>m<<m;a=a<<r|(d[h]&y)>>m,l+=r}}return this.bitOffset=l,this.byteOffset=h,a}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Ft;(function(M){M[M.PAD_ENCODE=0]="PAD_ENCODE",M[M.ASCII_ENCODE=1]="ASCII_ENCODE",M[M.C40_ENCODE=2]="C40_ENCODE",M[M.TEXT_ENCODE=3]="TEXT_ENCODE",M[M.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",M[M.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",M[M.BASE256_ENCODE=6]="BASE256_ENCODE"})(Ft||(Ft={}));class kn{static decode(r){const a=new Rn(r),l=new G,h=new G,d=new Array;let m=Ft.ASCII_ENCODE;do if(m===Ft.ASCII_ENCODE)m=this.decodeAsciiSegment(a,l,h);else{switch(m){case Ft.C40_ENCODE:this.decodeC40Segment(a,l);break;case Ft.TEXT_ENCODE:this.decodeTextSegment(a,l);break;case Ft.ANSIX12_ENCODE:this.decodeAnsiX12Segment(a,l);break;case Ft.EDIFACT_ENCODE:this.decodeEdifactSegment(a,l);break;case Ft.BASE256_ENCODE:this.decodeBase256Segment(a,l,d);break;default:throw new F}m=Ft.ASCII_ENCODE}while(m!==Ft.PAD_ENCODE&&a.available()>0);return h.length()>0&&l.append(h.toString()),new kt(r,l.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(r,a,l){let h=!1;do{let d=r.readBits(8);if(d===0)throw new F;if(d<=128)return h&&(d+=128),a.append(String.fromCharCode(d-1)),Ft.ASCII_ENCODE;if(d===129)return Ft.PAD_ENCODE;if(d<=229){const m=d-130;m<10&&a.append("0"),a.append(""+m)}else switch(d){case 230:return Ft.C40_ENCODE;case 231:return Ft.BASE256_ENCODE;case 232:a.append("");break;case 233:case 234:break;case 235:h=!0;break;case 236:a.append("[)>05"),l.insert(0,"");break;case 237:a.append("[)>06"),l.insert(0,"");break;case 238:return Ft.ANSIX12_ENCODE;case 239:return Ft.TEXT_ENCODE;case 240:return Ft.EDIFACT_ENCODE;case 241:break;default:if(d!==254||r.available()!==0)throw new F;break}}while(r.available()>0);return Ft.ASCII_ENCODE}static decodeC40Segment(r,a){let l=!1;const h=[];let d=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),h);for(let y=0;y<3;y++){const _=h[y];switch(d){case 0:if(_<3)d=_+1;else if(_<this.C40_BASIC_SET_CHARS.length){const v=this.C40_BASIC_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else throw new F;break;case 1:l?(a.append(String.fromCharCode(_+128)),l=!1):a.append(String.fromCharCode(_)),d=0;break;case 2:if(_<this.C40_SHIFT2_SET_CHARS.length){const v=this.C40_SHIFT2_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else switch(_){case 27:a.append("");break;case 30:l=!0;break;default:throw new F}d=0;break;case 3:l?(a.append(String.fromCharCode(_+224)),l=!1):a.append(String.fromCharCode(_+96)),d=0;break;default:throw new F}}}while(r.available()>0)}static decodeTextSegment(r,a){let l=!1,h=[],d=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),h);for(let y=0;y<3;y++){const _=h[y];switch(d){case 0:if(_<3)d=_+1;else if(_<this.TEXT_BASIC_SET_CHARS.length){const v=this.TEXT_BASIC_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else throw new F;break;case 1:l?(a.append(String.fromCharCode(_+128)),l=!1):a.append(String.fromCharCode(_)),d=0;break;case 2:if(_<this.TEXT_SHIFT2_SET_CHARS.length){const v=this.TEXT_SHIFT2_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else switch(_){case 27:a.append("");break;case 30:l=!0;break;default:throw new F}d=0;break;case 3:if(_<this.TEXT_SHIFT3_SET_CHARS.length){const v=this.TEXT_SHIFT3_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v),d=0}else throw new F;break;default:throw new F}}}while(r.available()>0)}static decodeAnsiX12Segment(r,a){const l=[];do{if(r.available()===8)return;const h=r.readBits(8);if(h===254)return;this.parseTwoBytes(h,r.readBits(8),l);for(let d=0;d<3;d++){const m=l[d];switch(m){case 0:a.append("\r");break;case 1:a.append("*");break;case 2:a.append(">");break;case 3:a.append(" ");break;default:if(m<14)a.append(String.fromCharCode(m+44));else if(m<40)a.append(String.fromCharCode(m+51));else throw new F;break}}}while(r.available()>0)}static parseTwoBytes(r,a,l){let h=(r<<8)+a-1,d=Math.floor(h/1600);l[0]=d,h-=d*1600,d=Math.floor(h/40),l[1]=d,l[2]=h-d*40}static decodeEdifactSegment(r,a){do{if(r.available()<=16)return;for(let l=0;l<4;l++){let h=r.readBits(6);if(h===31){const d=8-r.getBitOffset();d!==8&&r.readBits(d);return}(h&32)===0&&(h|=64),a.append(String.fromCharCode(h))}}while(r.available()>0)}static decodeBase256Segment(r,a,l){let h=1+r.getByteOffset();const d=this.unrandomize255State(r.readBits(8),h++);let m;if(d===0?m=r.available()/8|0:d<250?m=d:m=250*(d-249)+this.unrandomize255State(r.readBits(8),h++),m<0)throw new F;const y=new Uint8Array(m);for(let _=0;_<m;_++){if(r.available()<8)throw new F;y[_]=this.unrandomize255State(r.readBits(8),h++)}l.push(y);try{a.append(X.decode(y,Y.ISO88591))}catch(_){throw new wn("Platform does not support required encoding: "+_.message)}}static unrandomize255State(r,a){const l=149*a%255+1,h=r-l;return h>=0?h:h+256}}kn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],kn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],kn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],kn.TEXT_SHIFT2_SET_CHARS=kn.C40_SHIFT2_SET_CHARS,kn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Pi{constructor(){this.rsDecoder=new De(Lt.DATA_MATRIX_FIELD_256)}decode(r){const a=new dn(r),l=a.getVersion(),h=a.readCodewords(),d=fn.getDataBlocks(h,l);let m=0;for(let v of d)m+=v.getNumDataCodewords();const y=new Uint8Array(m),_=d.length;for(let v=0;v<_;v++){const N=d[v],k=N.getCodewords(),B=N.getNumDataCodewords();this.correctErrors(k,B);for(let q=0;q<B;q++)y[q*_+v]=k[q]}return kn.decode(y)}correctErrors(r,a){const l=new Int32Array(r);try{this.rsDecoder.decode(l,r.length-a)}catch{throw new L}for(let h=0;h<a;h++)r[h]=l[h]}}class It{constructor(r){this.image=r,this.rectangleDetector=new Rt(this.image)}detect(){const r=this.rectangleDetector.detect();let a=this.detectSolid1(r);if(a=this.detectSolid2(a),a[3]=this.correctTopRight(a),!a[3])throw new ce;a=this.shiftToModuleCenter(a);const l=a[0],h=a[1],d=a[2],m=a[3];let y=this.transitionsBetween(l,m)+1,_=this.transitionsBetween(d,m)+1;(y&1)===1&&(y+=1),(_&1)===1&&(_+=1),4*y<7*_&&4*_<7*y&&(y=_=Math.max(y,_));let v=It.sampleGrid(this.image,l,h,d,m,y,_);return new Pt(v,[l,h,d,m])}static shiftPoint(r,a,l){let h=(a.getX()-r.getX())/(l+1),d=(a.getY()-r.getY())/(l+1);return new be(r.getX()+h,r.getY()+d)}static moveAway(r,a,l){let h=r.getX(),d=r.getY();return h<a?h-=1:h+=1,d<l?d-=1:d+=1,new be(h,d)}detectSolid1(r){let a=r[0],l=r[1],h=r[3],d=r[2],m=this.transitionsBetween(a,l),y=this.transitionsBetween(l,h),_=this.transitionsBetween(h,d),v=this.transitionsBetween(d,a),N=m,k=[d,a,l,h];return N>y&&(N=y,k[0]=a,k[1]=l,k[2]=h,k[3]=d),N>_&&(N=_,k[0]=l,k[1]=h,k[2]=d,k[3]=a),N>v&&(k[0]=h,k[1]=d,k[2]=a,k[3]=l),k}detectSolid2(r){let a=r[0],l=r[1],h=r[2],d=r[3],m=this.transitionsBetween(a,d),y=It.shiftPoint(l,h,(m+1)*4),_=It.shiftPoint(h,l,(m+1)*4),v=this.transitionsBetween(y,a),N=this.transitionsBetween(_,d);return v<N?(r[0]=a,r[1]=l,r[2]=h,r[3]=d):(r[0]=l,r[1]=h,r[2]=d,r[3]=a),r}correctTopRight(r){let a=r[0],l=r[1],h=r[2],d=r[3],m=this.transitionsBetween(a,d),y=this.transitionsBetween(l,d),_=It.shiftPoint(a,l,(y+1)*4),v=It.shiftPoint(h,l,(m+1)*4);m=this.transitionsBetween(_,d),y=this.transitionsBetween(v,d);let N=new be(d.getX()+(h.getX()-l.getX())/(m+1),d.getY()+(h.getY()-l.getY())/(m+1)),k=new be(d.getX()+(a.getX()-l.getX())/(y+1),d.getY()+(a.getY()-l.getY())/(y+1));if(!this.isValid(N))return this.isValid(k)?k:null;if(!this.isValid(k))return N;let B=this.transitionsBetween(_,N)+this.transitionsBetween(v,N),q=this.transitionsBetween(_,k)+this.transitionsBetween(v,k);return B>q?N:k}shiftToModuleCenter(r){let a=r[0],l=r[1],h=r[2],d=r[3],m=this.transitionsBetween(a,d)+1,y=this.transitionsBetween(h,d)+1,_=It.shiftPoint(a,l,y*4),v=It.shiftPoint(h,l,m*4);m=this.transitionsBetween(_,d)+1,y=this.transitionsBetween(v,d)+1,(m&1)===1&&(m+=1),(y&1)===1&&(y+=1);let N=(a.getX()+l.getX()+h.getX()+d.getX())/4,k=(a.getY()+l.getY()+h.getY()+d.getY())/4;a=It.moveAway(a,N,k),l=It.moveAway(l,N,k),h=It.moveAway(h,N,k),d=It.moveAway(d,N,k);let B,q;return _=It.shiftPoint(a,l,y*4),_=It.shiftPoint(_,d,m*4),B=It.shiftPoint(l,a,y*4),B=It.shiftPoint(B,h,m*4),v=It.shiftPoint(h,d,y*4),v=It.shiftPoint(v,l,m*4),q=It.shiftPoint(d,h,y*4),q=It.shiftPoint(q,a,m*4),[_,B,v,q]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,a,l,h,d,m,y){return xr.getInstance().sampleGrid(r,m,y,.5,.5,m-.5,.5,m-.5,y-.5,.5,y-.5,a.getX(),a.getY(),d.getX(),d.getY(),h.getX(),h.getY(),l.getX(),l.getY())}transitionsBetween(r,a){let l=Math.trunc(r.getX()),h=Math.trunc(r.getY()),d=Math.trunc(a.getX()),m=Math.trunc(a.getY()),y=Math.abs(m-h)>Math.abs(d-l);if(y){let te=l;l=h,h=te,te=d,d=m,m=te}let _=Math.abs(d-l),v=Math.abs(m-h),N=-_/2,k=h<m?1:-1,B=l<d?1:-1,q=0,Z=this.image.get(y?h:l,y?l:h);for(let te=l,de=h;te!==d;te+=B){let _e=this.image.get(y?de:te,y?te:de);if(_e!==Z&&(q++,Z=_e),N+=v,N>0){if(de===m)break;de+=k,N-=_}}return q}}class er{constructor(){this.decoder=new Pi}decode(r,a=null){let l,h;if(a!=null&&a.has(Ze.PURE_BARCODE)){const v=er.extractPureBits(r.getBlackMatrix());l=this.decoder.decode(v),h=er.NO_POINTS}else{const v=new It(r.getBlackMatrix()).detect();l=this.decoder.decode(v.getBits()),h=v.getPoints()}const d=l.getRawBytes(),m=new Te(l.getText(),d,8*d.length,h,ve.DATA_MATRIX,re.currentTimeMillis()),y=l.getByteSegments();y!=null&&m.putMetadata(xt.BYTE_SEGMENTS,y);const _=l.getECLevel();return _!=null&&m.putMetadata(xt.ERROR_CORRECTION_LEVEL,_),m}reset(){}static extractPureBits(r){const a=r.getTopLeftOnBit(),l=r.getBottomRightOnBit();if(a==null||l==null)throw new ce;const h=this.moduleSize(a,r);let d=a[1];const m=l[1];let y=a[0];const v=(l[0]-y+1)/h,N=(m-d+1)/h;if(v<=0||N<=0)throw new ce;const k=h/2;d+=k,y+=k;const B=new at(v,N);for(let q=0;q<N;q++){const Z=d+q*h;for(let te=0;te<v;te++)r.get(y+te*h,Z)&&B.set(te,q)}return B}static moduleSize(r,a){const l=a.getWidth();let h=r[0];const d=r[1];for(;h<l&&a.get(h,d);)h++;if(h===l)throw new ce;const m=h-r[0];if(m===0)throw new ce;return m}}er.NO_POINTS=[];class Cr extends pe{constructor(r=500){super(new er,r)}}var gi;(function(M){M[M.L=0]="L",M[M.M=1]="M",M[M.Q=2]="Q",M[M.H=3]="H"})(gi||(gi={}));class an{constructor(r,a,l){this.value=r,this.stringValue=a,this.bits=l,an.FOR_BITS.set(l,this),an.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return an.L;case"M":return an.M;case"Q":return an.Q;case"H":return an.H;default:throw new C(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof an))return!1;const a=r;return this.value===a.value}static forBits(r){if(r<0||r>=an.FOR_BITS.size)throw new R;return an.FOR_BITS.get(r)}}an.FOR_BITS=new Map,an.FOR_VALUE=new Map,an.L=new an(gi.L,"L",1),an.M=new an(gi.M,"M",0),an.Q=new an(gi.Q,"Q",3),an.H=new an(gi.H,"H",2);class Er{constructor(r){this.errorCorrectionLevel=an.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,a){return le.bitCount(r^a)}static decodeFormatInformation(r,a){const l=Er.doDecodeFormatInformation(r,a);return l!==null?l:Er.doDecodeFormatInformation(r^Er.FORMAT_INFO_MASK_QR,a^Er.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,a){let l=Number.MAX_SAFE_INTEGER,h=0;for(const d of Er.FORMAT_INFO_DECODE_LOOKUP){const m=d[0];if(m===r||m===a)return new Er(d[1]);let y=Er.numBitsDiffering(r,m);y<l&&(h=d[1],l=y),r!==a&&(y=Er.numBitsDiffering(a,m),y<l&&(h=d[1],l=y))}return l<=3?new Er(h):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof Er))return!1;const a=r;return this.errorCorrectionLevel===a.errorCorrectionLevel&&this.dataMask===a.dataMask}}Er.FORMAT_INFO_MASK_QR=21522,Er.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class fe{constructor(r,...a){this.ecCodewordsPerBlock=r,this.ecBlocks=a}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const a=this.ecBlocks;for(const l of a)r+=l.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class H{constructor(r,a){this.count=r,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class _t{constructor(r,a,...l){this.versionNumber=r,this.alignmentPatternCenters=a,this.ecBlocks=l;let h=0;const d=l[0].getECCodewordsPerBlock(),m=l[0].getECBlocks();for(const y of m)h+=y.getCount()*(y.getDataCodewords()+d);this.totalCodewords=h}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new F;try{return this.getVersionForNumber((r-17)/4)}catch{throw new F}}static getVersionForNumber(r){if(r<1||r>40)throw new R;return _t.VERSIONS[r-1]}static decodeVersionInformation(r){let a=Number.MAX_SAFE_INTEGER,l=0;for(let h=0;h<_t.VERSION_DECODE_INFO.length;h++){const d=_t.VERSION_DECODE_INFO[h];if(d===r)return _t.getVersionForNumber(h+7);const m=Er.numBitsDiffering(r,d);m<a&&(l=h+7,a=m)}return a<=3?_t.getVersionForNumber(l):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),a=new at(r);a.setRegion(0,0,9,9),a.setRegion(r-8,0,8,9),a.setRegion(0,r-8,9,8);const l=this.alignmentPatternCenters.length;for(let h=0;h<l;h++){const d=this.alignmentPatternCenters[h]-2;for(let m=0;m<l;m++)h===0&&(m===0||m===l-1)||h===l-1&&m===0||a.setRegion(this.alignmentPatternCenters[m]-2,d,5,5)}return a.setRegion(6,9,1,r-17),a.setRegion(9,6,r-17,1),this.versionNumber>6&&(a.setRegion(r-11,0,3,6),a.setRegion(0,r-11,6,3)),a}toString(){return""+this.versionNumber}}_t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),_t.VERSIONS=[new _t(1,new Int32Array(0),new fe(7,new H(1,19)),new fe(10,new H(1,16)),new fe(13,new H(1,13)),new fe(17,new H(1,9))),new _t(2,Int32Array.from([6,18]),new fe(10,new H(1,34)),new fe(16,new H(1,28)),new fe(22,new H(1,22)),new fe(28,new H(1,16))),new _t(3,Int32Array.from([6,22]),new fe(15,new H(1,55)),new fe(26,new H(1,44)),new fe(18,new H(2,17)),new fe(22,new H(2,13))),new _t(4,Int32Array.from([6,26]),new fe(20,new H(1,80)),new fe(18,new H(2,32)),new fe(26,new H(2,24)),new fe(16,new H(4,9))),new _t(5,Int32Array.from([6,30]),new fe(26,new H(1,108)),new fe(24,new H(2,43)),new fe(18,new H(2,15),new H(2,16)),new fe(22,new H(2,11),new H(2,12))),new _t(6,Int32Array.from([6,34]),new fe(18,new H(2,68)),new fe(16,new H(4,27)),new fe(24,new H(4,19)),new fe(28,new H(4,15))),new _t(7,Int32Array.from([6,22,38]),new fe(20,new H(2,78)),new fe(18,new H(4,31)),new fe(18,new H(2,14),new H(4,15)),new fe(26,new H(4,13),new H(1,14))),new _t(8,Int32Array.from([6,24,42]),new fe(24,new H(2,97)),new fe(22,new H(2,38),new H(2,39)),new fe(22,new H(4,18),new H(2,19)),new fe(26,new H(4,14),new H(2,15))),new _t(9,Int32Array.from([6,26,46]),new fe(30,new H(2,116)),new fe(22,new H(3,36),new H(2,37)),new fe(20,new H(4,16),new H(4,17)),new fe(24,new H(4,12),new H(4,13))),new _t(10,Int32Array.from([6,28,50]),new fe(18,new H(2,68),new H(2,69)),new fe(26,new H(4,43),new H(1,44)),new fe(24,new H(6,19),new H(2,20)),new fe(28,new H(6,15),new H(2,16))),new _t(11,Int32Array.from([6,30,54]),new fe(20,new H(4,81)),new fe(30,new H(1,50),new H(4,51)),new fe(28,new H(4,22),new H(4,23)),new fe(24,new H(3,12),new H(8,13))),new _t(12,Int32Array.from([6,32,58]),new fe(24,new H(2,92),new H(2,93)),new fe(22,new H(6,36),new H(2,37)),new fe(26,new H(4,20),new H(6,21)),new fe(28,new H(7,14),new H(4,15))),new _t(13,Int32Array.from([6,34,62]),new fe(26,new H(4,107)),new fe(22,new H(8,37),new H(1,38)),new fe(24,new H(8,20),new H(4,21)),new fe(22,new H(12,11),new H(4,12))),new _t(14,Int32Array.from([6,26,46,66]),new fe(30,new H(3,115),new H(1,116)),new fe(24,new H(4,40),new H(5,41)),new fe(20,new H(11,16),new H(5,17)),new fe(24,new H(11,12),new H(5,13))),new _t(15,Int32Array.from([6,26,48,70]),new fe(22,new H(5,87),new H(1,88)),new fe(24,new H(5,41),new H(5,42)),new fe(30,new H(5,24),new H(7,25)),new fe(24,new H(11,12),new H(7,13))),new _t(16,Int32Array.from([6,26,50,74]),new fe(24,new H(5,98),new H(1,99)),new fe(28,new H(7,45),new H(3,46)),new fe(24,new H(15,19),new H(2,20)),new fe(30,new H(3,15),new H(13,16))),new _t(17,Int32Array.from([6,30,54,78]),new fe(28,new H(1,107),new H(5,108)),new fe(28,new H(10,46),new H(1,47)),new fe(28,new H(1,22),new H(15,23)),new fe(28,new H(2,14),new H(17,15))),new _t(18,Int32Array.from([6,30,56,82]),new fe(30,new H(5,120),new H(1,121)),new fe(26,new H(9,43),new H(4,44)),new fe(28,new H(17,22),new H(1,23)),new fe(28,new H(2,14),new H(19,15))),new _t(19,Int32Array.from([6,30,58,86]),new fe(28,new H(3,113),new H(4,114)),new fe(26,new H(3,44),new H(11,45)),new fe(26,new H(17,21),new H(4,22)),new fe(26,new H(9,13),new H(16,14))),new _t(20,Int32Array.from([6,34,62,90]),new fe(28,new H(3,107),new H(5,108)),new fe(26,new H(3,41),new H(13,42)),new fe(30,new H(15,24),new H(5,25)),new fe(28,new H(15,15),new H(10,16))),new _t(21,Int32Array.from([6,28,50,72,94]),new fe(28,new H(4,116),new H(4,117)),new fe(26,new H(17,42)),new fe(28,new H(17,22),new H(6,23)),new fe(30,new H(19,16),new H(6,17))),new _t(22,Int32Array.from([6,26,50,74,98]),new fe(28,new H(2,111),new H(7,112)),new fe(28,new H(17,46)),new fe(30,new H(7,24),new H(16,25)),new fe(24,new H(34,13))),new _t(23,Int32Array.from([6,30,54,78,102]),new fe(30,new H(4,121),new H(5,122)),new fe(28,new H(4,47),new H(14,48)),new fe(30,new H(11,24),new H(14,25)),new fe(30,new H(16,15),new H(14,16))),new _t(24,Int32Array.from([6,28,54,80,106]),new fe(30,new H(6,117),new H(4,118)),new fe(28,new H(6,45),new H(14,46)),new fe(30,new H(11,24),new H(16,25)),new fe(30,new H(30,16),new H(2,17))),new _t(25,Int32Array.from([6,32,58,84,110]),new fe(26,new H(8,106),new H(4,107)),new fe(28,new H(8,47),new H(13,48)),new fe(30,new H(7,24),new H(22,25)),new fe(30,new H(22,15),new H(13,16))),new _t(26,Int32Array.from([6,30,58,86,114]),new fe(28,new H(10,114),new H(2,115)),new fe(28,new H(19,46),new H(4,47)),new fe(28,new H(28,22),new H(6,23)),new fe(30,new H(33,16),new H(4,17))),new _t(27,Int32Array.from([6,34,62,90,118]),new fe(30,new H(8,122),new H(4,123)),new fe(28,new H(22,45),new H(3,46)),new fe(30,new H(8,23),new H(26,24)),new fe(30,new H(12,15),new H(28,16))),new _t(28,Int32Array.from([6,26,50,74,98,122]),new fe(30,new H(3,117),new H(10,118)),new fe(28,new H(3,45),new H(23,46)),new fe(30,new H(4,24),new H(31,25)),new fe(30,new H(11,15),new H(31,16))),new _t(29,Int32Array.from([6,30,54,78,102,126]),new fe(30,new H(7,116),new H(7,117)),new fe(28,new H(21,45),new H(7,46)),new fe(30,new H(1,23),new H(37,24)),new fe(30,new H(19,15),new H(26,16))),new _t(30,Int32Array.from([6,26,52,78,104,130]),new fe(30,new H(5,115),new H(10,116)),new fe(28,new H(19,47),new H(10,48)),new fe(30,new H(15,24),new H(25,25)),new fe(30,new H(23,15),new H(25,16))),new _t(31,Int32Array.from([6,30,56,82,108,134]),new fe(30,new H(13,115),new H(3,116)),new fe(28,new H(2,46),new H(29,47)),new fe(30,new H(42,24),new H(1,25)),new fe(30,new H(23,15),new H(28,16))),new _t(32,Int32Array.from([6,34,60,86,112,138]),new fe(30,new H(17,115)),new fe(28,new H(10,46),new H(23,47)),new fe(30,new H(10,24),new H(35,25)),new fe(30,new H(19,15),new H(35,16))),new _t(33,Int32Array.from([6,30,58,86,114,142]),new fe(30,new H(17,115),new H(1,116)),new fe(28,new H(14,46),new H(21,47)),new fe(30,new H(29,24),new H(19,25)),new fe(30,new H(11,15),new H(46,16))),new _t(34,Int32Array.from([6,34,62,90,118,146]),new fe(30,new H(13,115),new H(6,116)),new fe(28,new H(14,46),new H(23,47)),new fe(30,new H(44,24),new H(7,25)),new fe(30,new H(59,16),new H(1,17))),new _t(35,Int32Array.from([6,30,54,78,102,126,150]),new fe(30,new H(12,121),new H(7,122)),new fe(28,new H(12,47),new H(26,48)),new fe(30,new H(39,24),new H(14,25)),new fe(30,new H(22,15),new H(41,16))),new _t(36,Int32Array.from([6,24,50,76,102,128,154]),new fe(30,new H(6,121),new H(14,122)),new fe(28,new H(6,47),new H(34,48)),new fe(30,new H(46,24),new H(10,25)),new fe(30,new H(2,15),new H(64,16))),new _t(37,Int32Array.from([6,28,54,80,106,132,158]),new fe(30,new H(17,122),new H(4,123)),new fe(28,new H(29,46),new H(14,47)),new fe(30,new H(49,24),new H(10,25)),new fe(30,new H(24,15),new H(46,16))),new _t(38,Int32Array.from([6,32,58,84,110,136,162]),new fe(30,new H(4,122),new H(18,123)),new fe(28,new H(13,46),new H(32,47)),new fe(30,new H(48,24),new H(14,25)),new fe(30,new H(42,15),new H(32,16))),new _t(39,Int32Array.from([6,26,54,82,110,138,166]),new fe(30,new H(20,117),new H(4,118)),new fe(28,new H(40,47),new H(7,48)),new fe(30,new H(43,24),new H(22,25)),new fe(30,new H(10,15),new H(67,16))),new _t(40,Int32Array.from([6,30,58,86,114,142,170]),new fe(30,new H(19,118),new H(6,119)),new fe(28,new H(18,47),new H(31,48)),new fe(30,new H(34,24),new H(34,25)),new fe(30,new H(20,15),new H(61,16)))];var wr;(function(M){M[M.DATA_MASK_000=0]="DATA_MASK_000",M[M.DATA_MASK_001=1]="DATA_MASK_001",M[M.DATA_MASK_010=2]="DATA_MASK_010",M[M.DATA_MASK_011=3]="DATA_MASK_011",M[M.DATA_MASK_100=4]="DATA_MASK_100",M[M.DATA_MASK_101=5]="DATA_MASK_101",M[M.DATA_MASK_110=6]="DATA_MASK_110",M[M.DATA_MASK_111=7]="DATA_MASK_111"})(wr||(wr={}));class Lr{constructor(r,a){this.value=r,this.isMasked=a}unmaskBitMatrix(r,a){for(let l=0;l<a;l++)for(let h=0;h<a;h++)this.isMasked(l,h)&&r.flip(h,l)}}Lr.values=new Map([[wr.DATA_MASK_000,new Lr(wr.DATA_MASK_000,(M,r)=>(M+r&1)===0)],[wr.DATA_MASK_001,new Lr(wr.DATA_MASK_001,(M,r)=>(M&1)===0)],[wr.DATA_MASK_010,new Lr(wr.DATA_MASK_010,(M,r)=>r%3===0)],[wr.DATA_MASK_011,new Lr(wr.DATA_MASK_011,(M,r)=>(M+r)%3===0)],[wr.DATA_MASK_100,new Lr(wr.DATA_MASK_100,(M,r)=>(Math.floor(M/2)+Math.floor(r/3)&1)===0)],[wr.DATA_MASK_101,new Lr(wr.DATA_MASK_101,(M,r)=>M*r%6===0)],[wr.DATA_MASK_110,new Lr(wr.DATA_MASK_110,(M,r)=>M*r%6<3)],[wr.DATA_MASK_111,new Lr(wr.DATA_MASK_111,(M,r)=>(M+r+M*r%3&1)===0)]]);class mi{constructor(r){const a=r.getHeight();if(a<21||(a&3)!==1)throw new F;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let d=0;d<6;d++)r=this.copyBit(d,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let d=5;d>=0;d--)r=this.copyBit(8,d,r);const a=this.bitMatrix.getHeight();let l=0;const h=a-7;for(let d=a-1;d>=h;d--)l=this.copyBit(8,d,l);for(let d=a-8;d<a;d++)l=this.copyBit(d,8,l);if(this.parsedFormatInfo=Er.decodeFormatInformation(r,l),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new F}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),a=Math.floor((r-17)/4);if(a<=6)return _t.getVersionForNumber(a);let l=0;const h=r-11;for(let m=5;m>=0;m--)for(let y=r-9;y>=h;y--)l=this.copyBit(y,m,l);let d=_t.decodeVersionInformation(l);if(d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;l=0;for(let m=5;m>=0;m--)for(let y=r-9;y>=h;y--)l=this.copyBit(m,y,l);if(d=_t.decodeVersionInformation(l),d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;throw new F}copyBit(r,a,l){return(this.isMirror?this.bitMatrix.get(a,r):this.bitMatrix.get(r,a))?l<<1|1:l<<1}readCodewords(){const r=this.readFormatInformation(),a=this.readVersion(),l=Lr.values.get(r.getDataMask()),h=this.bitMatrix.getHeight();l.unmaskBitMatrix(this.bitMatrix,h);const d=a.buildFunctionPattern();let m=!0;const y=new Uint8Array(a.getTotalCodewords());let _=0,v=0,N=0;for(let k=h-1;k>0;k-=2){k===6&&k--;for(let B=0;B<h;B++){const q=m?h-1-B:B;for(let Z=0;Z<2;Z++)d.get(k-Z,q)||(N++,v<<=1,this.bitMatrix.get(k-Z,q)&&(v|=1),N===8&&(y[_++]=v,N=0,v=0))}m=!m}if(_!==a.getTotalCodewords())throw new F;return y}remask(){if(this.parsedFormatInfo===null)return;const r=Lr.values[this.parsedFormatInfo.getDataMask()],a=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,a)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let a=0,l=r.getWidth();a<l;a++)for(let h=a+1,d=r.getHeight();h<d;h++)r.get(a,h)!==r.get(h,a)&&(r.flip(h,a),r.flip(a,h))}}class Ga{constructor(r,a){this.numDataCodewords=r,this.codewords=a}static getDataBlocks(r,a,l){if(r.length!==a.getTotalCodewords())throw new R;const h=a.getECBlocksForLevel(l);let d=0;const m=h.getECBlocks();for(const Z of m)d+=Z.getCount();const y=new Array(d);let _=0;for(const Z of m)for(let te=0;te<Z.getCount();te++){const de=Z.getDataCodewords(),_e=h.getECCodewordsPerBlock()+de;y[_++]=new Ga(de,new Uint8Array(_e))}const v=y[0].codewords.length;let N=y.length-1;for(;N>=0&&y[N].codewords.length!==v;)N--;N++;const k=v-h.getECCodewordsPerBlock();let B=0;for(let Z=0;Z<k;Z++)for(let te=0;te<_;te++)y[te].codewords[Z]=r[B++];for(let Z=N;Z<_;Z++)y[Z].codewords[k]=r[B++];const q=y[0].codewords.length;for(let Z=k;Z<q;Z++)for(let te=0;te<_;te++){const de=te<N?Z:Z+1;y[te].codewords[de]=r[B++]}return y}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var $r;(function(M){M[M.TERMINATOR=0]="TERMINATOR",M[M.NUMERIC=1]="NUMERIC",M[M.ALPHANUMERIC=2]="ALPHANUMERIC",M[M.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",M[M.BYTE=4]="BYTE",M[M.ECI=5]="ECI",M[M.KANJI=6]="KANJI",M[M.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",M[M.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",M[M.HANZI=9]="HANZI"})($r||($r={}));class Tt{constructor(r,a,l,h){this.value=r,this.stringValue=a,this.characterCountBitsForVersions=l,this.bits=h,Tt.FOR_BITS.set(h,this),Tt.FOR_VALUE.set(r,this)}static forBits(r){const a=Tt.FOR_BITS.get(r);if(a===void 0)throw new R;return a}getCharacterCountBits(r){const a=r.getVersionNumber();let l;return a<=9?l=0:a<=26?l=1:l=2,this.characterCountBitsForVersions[l]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof Tt))return!1;const a=r;return this.value===a.value}toString(){return this.stringValue}}Tt.FOR_BITS=new Map,Tt.FOR_VALUE=new Map,Tt.TERMINATOR=new Tt($r.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Tt.NUMERIC=new Tt($r.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Tt.ALPHANUMERIC=new Tt($r.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Tt.STRUCTURED_APPEND=new Tt($r.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Tt.BYTE=new Tt($r.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Tt.ECI=new Tt($r.ECI,"ECI",Int32Array.from([0,0,0]),7),Tt.KANJI=new Tt($r.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Tt.FNC1_FIRST_POSITION=new Tt($r.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Tt.FNC1_SECOND_POSITION=new Tt($r.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Tt.HANZI=new Tt($r.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class zn{static decode(r,a,l,h){const d=new Rn(r);let m=new G;const y=new Array;let _=-1,v=-1;try{let N=null,k=!1,B;do{if(d.available()<4)B=Tt.TERMINATOR;else{const q=d.readBits(4);B=Tt.forBits(q)}switch(B){case Tt.TERMINATOR:break;case Tt.FNC1_FIRST_POSITION:case Tt.FNC1_SECOND_POSITION:k=!0;break;case Tt.STRUCTURED_APPEND:if(d.available()<16)throw new F;_=d.readBits(8),v=d.readBits(8);break;case Tt.ECI:const q=zn.parseECIValue(d);if(N=U.getCharacterSetECIByValue(q),N===null)throw new F;break;case Tt.HANZI:const Z=d.readBits(4),te=d.readBits(B.getCharacterCountBits(a));Z===zn.GB2312_SUBSET&&zn.decodeHanziSegment(d,m,te);break;default:const de=d.readBits(B.getCharacterCountBits(a));switch(B){case Tt.NUMERIC:zn.decodeNumericSegment(d,m,de);break;case Tt.ALPHANUMERIC:zn.decodeAlphanumericSegment(d,m,de,k);break;case Tt.BYTE:zn.decodeByteSegment(d,m,de,N,y,h);break;case Tt.KANJI:zn.decodeKanjiSegment(d,m,de);break;default:throw new F}break}}while(B!==Tt.TERMINATOR)}catch{throw new F}return new kt(r,m.toString(),y.length===0?null:y,l===null?null:l.toString(),_,v)}static decodeHanziSegment(r,a,l){if(l*13>r.available())throw new F;const h=new Uint8Array(2*l);let d=0;for(;l>0;){const m=r.readBits(13);let y=m/96<<8&4294967295|m%96;y<959?y+=41377:y+=42657,h[d]=y>>8&255,h[d+1]=y&255,d+=2,l--}try{a.append(X.decode(h,Y.GB2312))}catch(m){throw new F(m)}}static decodeKanjiSegment(r,a,l){if(l*13>r.available())throw new F;const h=new Uint8Array(2*l);let d=0;for(;l>0;){const m=r.readBits(13);let y=m/192<<8&4294967295|m%192;y<7936?y+=33088:y+=49472,h[d]=y>>8,h[d+1]=y,d+=2,l--}try{a.append(X.decode(h,Y.SHIFT_JIS))}catch(m){throw new F(m)}}static decodeByteSegment(r,a,l,h,d,m){if(8*l>r.available())throw new F;const y=new Uint8Array(l);for(let v=0;v<l;v++)y[v]=r.readBits(8);let _;h===null?_=Y.guessEncoding(y,m):_=h.getName();try{a.append(X.decode(y,_))}catch(v){throw new F(v)}d.push(y)}static toAlphaNumericChar(r){if(r>=zn.ALPHANUMERIC_CHARS.length)throw new F;return zn.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,a,l,h){const d=a.length();for(;l>1;){if(r.available()<11)throw new F;const m=r.readBits(11);a.append(zn.toAlphaNumericChar(Math.floor(m/45))),a.append(zn.toAlphaNumericChar(m%45)),l-=2}if(l===1){if(r.available()<6)throw new F;a.append(zn.toAlphaNumericChar(r.readBits(6)))}if(h)for(let m=d;m<a.length();m++)a.charAt(m)==="%"&&(m<a.length()-1&&a.charAt(m+1)==="%"?a.deleteCharAt(m+1):a.setCharAt(m,""))}static decodeNumericSegment(r,a,l){for(;l>=3;){if(r.available()<10)throw new F;const h=r.readBits(10);if(h>=1e3)throw new F;a.append(zn.toAlphaNumericChar(Math.floor(h/100))),a.append(zn.toAlphaNumericChar(Math.floor(h/10)%10)),a.append(zn.toAlphaNumericChar(h%10)),l-=3}if(l===2){if(r.available()<7)throw new F;const h=r.readBits(7);if(h>=100)throw new F;a.append(zn.toAlphaNumericChar(Math.floor(h/10))),a.append(zn.toAlphaNumericChar(h%10))}else if(l===1){if(r.available()<4)throw new F;const h=r.readBits(4);if(h>=10)throw new F;a.append(zn.toAlphaNumericChar(h))}}static parseECIValue(r){const a=r.readBits(8);if((a&128)===0)return a&127;if((a&192)===128){const l=r.readBits(8);return(a&63)<<8&4294967295|l}if((a&224)===192){const l=r.readBits(16);return(a&31)<<16&4294967295|l}throw new F}}zn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",zn.GB2312_SUBSET=1;class zo{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const a=r[0];r[0]=r[2],r[2]=a}}class Bs{constructor(){this.rsDecoder=new De(Lt.QR_CODE_FIELD_256)}decodeBooleanArray(r,a){return this.decodeBitMatrix(at.parseFromBooleanArray(r),a)}decodeBitMatrix(r,a){const l=new mi(r);let h=null;try{return this.decodeBitMatrixParser(l,a)}catch(d){h=d}try{l.remask(),l.setMirror(!0),l.readVersion(),l.readFormatInformation(),l.mirror();const d=this.decodeBitMatrixParser(l,a);return d.setOther(new zo(!0)),d}catch(d){throw h!==null?h:d}}decodeBitMatrixParser(r,a){const l=r.readVersion(),h=r.readFormatInformation().getErrorCorrectionLevel(),d=r.readCodewords(),m=Ga.getDataBlocks(d,l,h);let y=0;for(const N of m)y+=N.getNumDataCodewords();const _=new Uint8Array(y);let v=0;for(const N of m){const k=N.getCodewords(),B=N.getNumDataCodewords();this.correctErrors(k,B);for(let q=0;q<B;q++)_[v++]=k[q]}return zn.decode(_,l,h,a)}correctErrors(r,a){const l=new Int32Array(r);try{this.rsDecoder.decode(l,r.length-a)}catch{throw new L}for(let h=0;h<a;h++)r[h]=l[h]}}class Vs extends be{constructor(r,a,l){super(r,a),this.estimatedModuleSize=l}aboutEquals(r,a,l){if(Math.abs(a-this.getY())<=r&&Math.abs(l-this.getX())<=r){const h=Math.abs(r-this.estimatedModuleSize);return h<=1||h<=this.estimatedModuleSize}return!1}combineEstimate(r,a,l){const h=(this.getX()+a)/2,d=(this.getY()+r)/2,m=(this.estimatedModuleSize+l)/2;return new Vs(h,d,m)}}class pi{constructor(r,a,l,h,d,m,y){this.image=r,this.startX=a,this.startY=l,this.width=h,this.height=d,this.moduleSize=m,this.resultPointCallback=y,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,a=this.height,l=this.width,h=r+l,d=this.startY+a/2,m=new Int32Array(3),y=this.image;for(let _=0;_<a;_++){const v=d+((_&1)===0?Math.floor((_+1)/2):-Math.floor((_+1)/2));m[0]=0,m[1]=0,m[2]=0;let N=r;for(;N<h&&!y.get(N,v);)N++;let k=0;for(;N<h;){if(y.get(N,v))if(k===1)m[1]++;else if(k===2){if(this.foundPatternCross(m)){const B=this.handlePossibleCenter(m,v,N);if(B!==null)return B}m[0]=m[2],m[1]=1,m[2]=0,k=1}else m[++k]++;else k===1&&k++,m[k]++;N++}if(this.foundPatternCross(m)){const B=this.handlePossibleCenter(m,v,h);if(B!==null)return B}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ce}static centerFromEnd(r,a){return a-r[2]-r[1]/2}foundPatternCross(r){const a=this.moduleSize,l=a/2;for(let h=0;h<3;h++)if(Math.abs(a-r[h])>=l)return!1;return!0}crossCheckVertical(r,a,l,h){const d=this.image,m=d.getHeight(),y=this.crossCheckStateCount;y[0]=0,y[1]=0,y[2]=0;let _=r;for(;_>=0&&d.get(a,_)&&y[1]<=l;)y[1]++,_--;if(_<0||y[1]>l)return NaN;for(;_>=0&&!d.get(a,_)&&y[0]<=l;)y[0]++,_--;if(y[0]>l)return NaN;for(_=r+1;_<m&&d.get(a,_)&&y[1]<=l;)y[1]++,_++;if(_===m||y[1]>l)return NaN;for(;_<m&&!d.get(a,_)&&y[2]<=l;)y[2]++,_++;if(y[2]>l)return NaN;const v=y[0]+y[1]+y[2];return 5*Math.abs(v-h)>=2*h?NaN:this.foundPatternCross(y)?pi.centerFromEnd(y,_):NaN}handlePossibleCenter(r,a,l){const h=r[0]+r[1]+r[2],d=pi.centerFromEnd(r,l),m=this.crossCheckVertical(a,d,2*r[1],h);if(!isNaN(m)){const y=(r[0]+r[1]+r[2])/3;for(const v of this.possibleCenters)if(v.aboutEquals(y,m,d))return v.combineEstimate(m,d,y);const _=new Vs(d,m,y);this.possibleCenters.push(_),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(_)}return null}}class ia extends be{constructor(r,a,l,h){super(r,a),this.estimatedModuleSize=l,this.count=h,h===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,a,l){if(Math.abs(a-this.getY())<=r&&Math.abs(l-this.getX())<=r){const h=Math.abs(r-this.estimatedModuleSize);return h<=1||h<=this.estimatedModuleSize}return!1}combineEstimate(r,a,l){const h=this.count+1,d=(this.count*this.getX()+a)/h,m=(this.count*this.getY()+r)/h,y=(this.count*this.estimatedModuleSize+l)/h;return new ia(d,m,y,h)}}class Bi{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class tr{constructor(r,a){this.image=r,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=a}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const a=r!=null&&r.get(Ze.TRY_HARDER)!==void 0,l=r!=null&&r.get(Ze.PURE_BARCODE)!==void 0,h=this.image,d=h.getHeight(),m=h.getWidth();let y=Math.floor(3*d/(4*tr.MAX_MODULES));(y<tr.MIN_SKIP||a)&&(y=tr.MIN_SKIP);let _=!1;const v=new Int32Array(5);for(let k=y-1;k<d&&!_;k+=y){v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0;let B=0;for(let q=0;q<m;q++)if(h.get(q,k))(B&1)===1&&B++,v[B]++;else if((B&1)===0)if(B===4)if(tr.foundPatternCross(v)){if(this.handlePossibleCenter(v,k,q,l)===!0)if(y=2,this.hasSkipped===!0)_=this.haveMultiplyConfirmedCenters();else{const te=this.findRowSkip();te>v[2]&&(k+=te-v[2]-y,q=m-1)}else{v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,B=3;continue}B=0,v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0}else v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,B=3;else v[++B]++;else v[B]++;tr.foundPatternCross(v)&&this.handlePossibleCenter(v,k,m,l)===!0&&(y=v[0],this.hasSkipped&&(_=this.haveMultiplyConfirmedCenters()))}const N=this.selectBestPatterns();return be.orderBestPatterns(N),new Bi(N)}static centerFromEnd(r,a){return a-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let a=0;for(let d=0;d<5;d++){const m=r[d];if(m===0)return!1;a+=m}if(a<7)return!1;const l=a/7,h=l/2;return Math.abs(l-r[0])<h&&Math.abs(l-r[1])<h&&Math.abs(3*l-r[2])<3*h&&Math.abs(l-r[3])<h&&Math.abs(l-r[4])<h}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,a,l,h){const d=this.getCrossCheckStateCount();let m=0;const y=this.image;for(;r>=m&&a>=m&&y.get(a-m,r-m);)d[2]++,m++;if(r<m||a<m)return!1;for(;r>=m&&a>=m&&!y.get(a-m,r-m)&&d[1]<=l;)d[1]++,m++;if(r<m||a<m||d[1]>l)return!1;for(;r>=m&&a>=m&&y.get(a-m,r-m)&&d[0]<=l;)d[0]++,m++;if(d[0]>l)return!1;const _=y.getHeight(),v=y.getWidth();for(m=1;r+m<_&&a+m<v&&y.get(a+m,r+m);)d[2]++,m++;if(r+m>=_||a+m>=v)return!1;for(;r+m<_&&a+m<v&&!y.get(a+m,r+m)&&d[3]<l;)d[3]++,m++;if(r+m>=_||a+m>=v||d[3]>=l)return!1;for(;r+m<_&&a+m<v&&y.get(a+m,r+m)&&d[4]<l;)d[4]++,m++;if(d[4]>=l)return!1;const N=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(N-h)<2*h&&tr.foundPatternCross(d)}crossCheckVertical(r,a,l,h){const d=this.image,m=d.getHeight(),y=this.getCrossCheckStateCount();let _=r;for(;_>=0&&d.get(a,_);)y[2]++,_--;if(_<0)return NaN;for(;_>=0&&!d.get(a,_)&&y[1]<=l;)y[1]++,_--;if(_<0||y[1]>l)return NaN;for(;_>=0&&d.get(a,_)&&y[0]<=l;)y[0]++,_--;if(y[0]>l)return NaN;for(_=r+1;_<m&&d.get(a,_);)y[2]++,_++;if(_===m)return NaN;for(;_<m&&!d.get(a,_)&&y[3]<l;)y[3]++,_++;if(_===m||y[3]>=l)return NaN;for(;_<m&&d.get(a,_)&&y[4]<l;)y[4]++,_++;if(y[4]>=l)return NaN;const v=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(v-h)>=2*h?NaN:tr.foundPatternCross(y)?tr.centerFromEnd(y,_):NaN}crossCheckHorizontal(r,a,l,h){const d=this.image,m=d.getWidth(),y=this.getCrossCheckStateCount();let _=r;for(;_>=0&&d.get(_,a);)y[2]++,_--;if(_<0)return NaN;for(;_>=0&&!d.get(_,a)&&y[1]<=l;)y[1]++,_--;if(_<0||y[1]>l)return NaN;for(;_>=0&&d.get(_,a)&&y[0]<=l;)y[0]++,_--;if(y[0]>l)return NaN;for(_=r+1;_<m&&d.get(_,a);)y[2]++,_++;if(_===m)return NaN;for(;_<m&&!d.get(_,a)&&y[3]<l;)y[3]++,_++;if(_===m||y[3]>=l)return NaN;for(;_<m&&d.get(_,a)&&y[4]<l;)y[4]++,_++;if(y[4]>=l)return NaN;const v=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(v-h)>=h?NaN:tr.foundPatternCross(y)?tr.centerFromEnd(y,_):NaN}handlePossibleCenter(r,a,l,h){const d=r[0]+r[1]+r[2]+r[3]+r[4];let m=tr.centerFromEnd(r,l),y=this.crossCheckVertical(a,Math.floor(m),r[2],d);if(!isNaN(y)&&(m=this.crossCheckHorizontal(Math.floor(m),Math.floor(y),r[2],d),!isNaN(m)&&(!h||this.crossCheckDiagonal(Math.floor(y),Math.floor(m),r[2],d)))){const _=d/7;let v=!1;const N=this.possibleCenters;for(let k=0,B=N.length;k<B;k++){const q=N[k];if(q.aboutEquals(_,y,m)){N[k]=q.combineEstimate(y,m,_),v=!0;break}}if(!v){const k=new ia(m,y,_);N.push(k),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(k)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let a=null;for(const l of this.possibleCenters)if(l.getCount()>=tr.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,a=0;const l=this.possibleCenters.length;for(const m of this.possibleCenters)m.getCount()>=tr.CENTER_QUORUM&&(r++,a+=m.getEstimatedModuleSize());if(r<3)return!1;const h=a/l;let d=0;for(const m of this.possibleCenters)d+=Math.abs(m.getEstimatedModuleSize()-h);return d<=.05*a}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new ce;const a=this.possibleCenters;let l;if(r>3){let h=0,d=0;for(const _ of this.possibleCenters){const v=_.getEstimatedModuleSize();h+=v,d+=v*v}l=h/r;let m=Math.sqrt(d/r-l*l);a.sort((_,v)=>{const N=Math.abs(v.getEstimatedModuleSize()-l),k=Math.abs(_.getEstimatedModuleSize()-l);return N<k?-1:N>k?1:0});const y=Math.max(.2*l,m);for(let _=0;_<a.length&&a.length>3;_++){const v=a[_];Math.abs(v.getEstimatedModuleSize()-l)>y&&(a.splice(_,1),_--)}}if(a.length>3){let h=0;for(const d of a)h+=d.getEstimatedModuleSize();l=h/a.length,a.sort((d,m)=>{if(m.getCount()===d.getCount()){const y=Math.abs(m.getEstimatedModuleSize()-l),_=Math.abs(d.getEstimatedModuleSize()-l);return y<_?1:y>_?-1:0}else return m.getCount()-d.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]}}tr.CENTER_QUORUM=2,tr.MIN_SKIP=3,tr.MAX_MODULES=57;class yi{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(Ze.NEED_RESULT_POINT_CALLBACK);const l=new tr(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(l)}processFinderPatternInfo(r){const a=r.getTopLeft(),l=r.getTopRight(),h=r.getBottomLeft(),d=this.calculateModuleSize(a,l,h);if(d<1)throw new ce("No pattern found in proccess finder.");const m=yi.computeDimension(a,l,h,d),y=_t.getProvisionalVersionForDimension(m),_=y.getDimensionForVersion()-7;let v=null;if(y.getAlignmentPatternCenters().length>0){const q=l.getX()-a.getX()+h.getX(),Z=l.getY()-a.getY()+h.getY(),te=1-3/_,de=Math.floor(a.getX()+te*(q-a.getX())),_e=Math.floor(a.getY()+te*(Z-a.getY()));for(let Je=4;Je<=16;Je<<=1)try{v=this.findAlignmentInRegion(d,de,_e,Je);break}catch(Ke){if(!(Ke instanceof ce))throw Ke}}const N=yi.createTransform(a,l,h,v,m),k=yi.sampleGrid(this.image,N,m);let B;return v===null?B=[h,a,l]:B=[h,a,l,v],new Pt(k,B)}static createTransform(r,a,l,h,d){const m=d-3.5;let y,_,v,N;return h!==null?(y=h.getX(),_=h.getY(),v=m-3,N=v):(y=a.getX()-r.getX()+l.getX(),_=a.getY()-r.getY()+l.getY(),v=m,N=m),Xt.quadrilateralToQuadrilateral(3.5,3.5,m,3.5,v,N,3.5,m,r.getX(),r.getY(),a.getX(),a.getY(),y,_,l.getX(),l.getY())}static sampleGrid(r,a,l){return xr.getInstance().sampleGridWithTransform(r,l,l,a)}static computeDimension(r,a,l,h){const d=Fe.round(be.distance(r,a)/h),m=Fe.round(be.distance(r,l)/h);let y=Math.floor((d+m)/2)+7;switch(y&3){case 0:y++;break;case 2:y--;break;case 3:throw new ce("Dimensions could be not found.")}return y}calculateModuleSize(r,a,l){return(this.calculateModuleSizeOneWay(r,a)+this.calculateModuleSizeOneWay(r,l))/2}calculateModuleSizeOneWay(r,a){const l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(a.getX()),Math.floor(a.getY())),h=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(l)?h/7:isNaN(h)?l/7:(l+h)/14}sizeOfBlackWhiteBlackRunBothWays(r,a,l,h){let d=this.sizeOfBlackWhiteBlackRun(r,a,l,h),m=1,y=r-(l-r);y<0?(m=r/(r-y),y=0):y>=this.image.getWidth()&&(m=(this.image.getWidth()-1-r)/(y-r),y=this.image.getWidth()-1);let _=Math.floor(a-(h-a)*m);return m=1,_<0?(m=a/(a-_),_=0):_>=this.image.getHeight()&&(m=(this.image.getHeight()-1-a)/(_-a),_=this.image.getHeight()-1),y=Math.floor(r+(y-r)*m),d+=this.sizeOfBlackWhiteBlackRun(r,a,y,_),d-1}sizeOfBlackWhiteBlackRun(r,a,l,h){const d=Math.abs(h-a)>Math.abs(l-r);if(d){let q=r;r=a,a=q,q=l,l=h,h=q}const m=Math.abs(l-r),y=Math.abs(h-a);let _=-m/2;const v=r<l?1:-1,N=a<h?1:-1;let k=0;const B=l+v;for(let q=r,Z=a;q!==B;q+=v){const te=d?Z:q,de=d?q:Z;if(k===1===this.image.get(te,de)){if(k===2)return Fe.distance(q,Z,r,a);k++}if(_+=y,_>0){if(Z===h)break;Z+=N,_-=m}}return k===2?Fe.distance(l+v,h,r,a):NaN}findAlignmentInRegion(r,a,l,h){const d=Math.floor(h*r),m=Math.max(0,a-d),y=Math.min(this.image.getWidth()-1,a+d);if(y-m<r*3)throw new ce("Alignment top exceeds estimated module size.");const _=Math.max(0,l-d),v=Math.min(this.image.getHeight()-1,l+d);if(v-_<r*3)throw new ce("Alignment bottom exceeds estimated module size.");return new pi(this.image,m,_,y-m,v-_,r,this.resultPointCallback).find()}}class xi{constructor(){this.decoder=new Bs}getDecoder(){return this.decoder}decode(r,a){let l,h;if(a!=null&&a.get(Ze.PURE_BARCODE)!==void 0){const _=xi.extractPureBits(r.getBlackMatrix());l=this.decoder.decodeBitMatrix(_,a),h=xi.NO_POINTS}else{const _=new yi(r.getBlackMatrix()).detect(a);l=this.decoder.decodeBitMatrix(_.getBits(),a),h=_.getPoints()}l.getOther()instanceof zo&&l.getOther().applyMirroredCorrection(h);const d=new Te(l.getText(),l.getRawBytes(),void 0,h,ve.QR_CODE,void 0),m=l.getByteSegments();m!==null&&d.putMetadata(xt.BYTE_SEGMENTS,m);const y=l.getECLevel();return y!==null&&d.putMetadata(xt.ERROR_CORRECTION_LEVEL,y),l.hasStructuredAppend()&&(d.putMetadata(xt.STRUCTURED_APPEND_SEQUENCE,l.getStructuredAppendSequenceNumber()),d.putMetadata(xt.STRUCTURED_APPEND_PARITY,l.getStructuredAppendParity())),d}reset(){}static extractPureBits(r){const a=r.getTopLeftOnBit(),l=r.getBottomRightOnBit();if(a===null||l===null)throw new ce;const h=this.moduleSize(a,r);let d=a[1],m=l[1],y=a[0],_=l[0];if(y>=_||d>=m)throw new ce;if(m-d!==_-y&&(_=y+(m-d),_>=r.getWidth()))throw new ce;const v=Math.round((_-y+1)/h),N=Math.round((m-d+1)/h);if(v<=0||N<=0)throw new ce;if(N!==v)throw new ce;const k=Math.floor(h/2);d+=k,y+=k;const B=y+Math.floor((v-1)*h)-_;if(B>0){if(B>k)throw new ce;y-=B}const q=d+Math.floor((N-1)*h)-m;if(q>0){if(q>k)throw new ce;d-=q}const Z=new at(v,N);for(let te=0;te<N;te++){const de=d+Math.floor(te*h);for(let _e=0;_e<v;_e++)r.get(y+Math.floor(_e*h),de)&&Z.set(_e,te)}return Z}static moduleSize(r,a){const l=a.getHeight(),h=a.getWidth();let d=r[0],m=r[1],y=!0,_=0;for(;d<h&&m<l;){if(y!==a.get(d,m)){if(++_===5)break;y=!y}d++,m++}if(d===h||m===l)throw new ce;return(d-r[0])/7}}xi.NO_POINTS=new Array;class Nt{PDF417Common(){}static getBitCountSum(r){return Fe.sum(r)}static toIntArray(r){if(r==null||!r.length)return Nt.EMPTY_INT_ARRAY;const a=new Int32Array(r.length);let l=0;for(const h of r)a[l++]=h;return a}static getCodeword(r){const a=Oe.binarySearch(Nt.SYMBOL_TABLE,r&262143);return a<0?-1:(Nt.CODEWORD_TABLE[a]-1)%Nt.NUMBER_OF_CODEWORDS}}Nt.NUMBER_OF_CODEWORDS=929,Nt.MAX_CODEWORDS_IN_BARCODE=Nt.NUMBER_OF_CODEWORDS-1,Nt.MIN_ROWS_IN_BARCODE=3,Nt.MAX_ROWS_IN_BARCODE=90,Nt.MODULES_IN_CODEWORD=17,Nt.MODULES_IN_STOP_PATTERN=18,Nt.BARS_IN_MODULE=8,Nt.EMPTY_INT_ARRAY=new Int32Array([]),Nt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Nt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Us{constructor(r,a){this.bits=r,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class Ut{static detectMultiple(r,a,l){let h=r.getBlackMatrix(),d=Ut.detect(l,h);return d.length||(h=h.clone(),h.rotate180(),d=Ut.detect(l,h)),new Us(h,d)}static detect(r,a){const l=new Array;let h=0,d=0,m=!1;for(;h<a.getHeight();){const y=Ut.findVertices(a,h,d);if(y[0]==null&&y[3]==null){if(!m)break;m=!1,d=0;for(const _ of l)_[1]!=null&&(h=Math.trunc(Math.max(h,_[1].getY()))),_[3]!=null&&(h=Math.max(h,Math.trunc(_[3].getY())));h+=Ut.ROW_STEP;continue}if(m=!0,l.push(y),!r)break;y[2]!=null?(d=Math.trunc(y[2].getX()),h=Math.trunc(y[2].getY())):(d=Math.trunc(y[4].getX()),h=Math.trunc(y[4].getY()))}return l}static findVertices(r,a,l){const h=r.getHeight(),d=r.getWidth(),m=new Array(8);return Ut.copyToResult(m,Ut.findRowsWithPattern(r,h,d,a,l,Ut.START_PATTERN),Ut.INDEXES_START_PATTERN),m[4]!=null&&(l=Math.trunc(m[4].getX()),a=Math.trunc(m[4].getY())),Ut.copyToResult(m,Ut.findRowsWithPattern(r,h,d,a,l,Ut.STOP_PATTERN),Ut.INDEXES_STOP_PATTERN),m}static copyToResult(r,a,l){for(let h=0;h<l.length;h++)r[l[h]]=a[h]}static findRowsWithPattern(r,a,l,h,d,m){const y=new Array(4);let _=!1;const v=new Int32Array(m.length);for(;h<a;h+=Ut.ROW_STEP){let k=Ut.findGuardPattern(r,d,h,l,!1,m,v);if(k!=null){for(;h>0;){const B=Ut.findGuardPattern(r,d,--h,l,!1,m,v);if(B!=null)k=B;else{h++;break}}y[0]=new be(k[0],h),y[1]=new be(k[1],h),_=!0;break}}let N=h+1;if(_){let k=0,B=Int32Array.from([Math.trunc(y[0].getX()),Math.trunc(y[1].getX())]);for(;N<a;N++){const q=Ut.findGuardPattern(r,B[0],N,l,!1,m,v);if(q!=null&&Math.abs(B[0]-q[0])<Ut.MAX_PATTERN_DRIFT&&Math.abs(B[1]-q[1])<Ut.MAX_PATTERN_DRIFT)B=q,k=0;else{if(k>Ut.SKIPPED_ROW_COUNT_MAX)break;k++}}N-=k+1,y[2]=new be(B[0],N),y[3]=new be(B[1],N)}return N-h<Ut.BARCODE_MIN_HEIGHT&&Oe.fill(y,null),y}static findGuardPattern(r,a,l,h,d,m,y){Oe.fillWithin(y,0,y.length,0);let _=a,v=0;for(;r.get(_,l)&&_>0&&v++<Ut.MAX_PIXEL_DRIFT;)_--;let N=_,k=0,B=m.length;for(let q=d;N<h;N++)if(r.get(N,l)!==q)y[k]++;else{if(k===B-1){if(Ut.patternMatchVariance(y,m,Ut.MAX_INDIVIDUAL_VARIANCE)<Ut.MAX_AVG_VARIANCE)return new Int32Array([_,N]);_+=y[0]+y[1],re.arraycopy(y,2,y,0,k-1),y[k-1]=0,y[k]=0,k--}else k++;y[k]=1,q=!q}return k===B-1&&Ut.patternMatchVariance(y,m,Ut.MAX_INDIVIDUAL_VARIANCE)<Ut.MAX_AVG_VARIANCE?new Int32Array([_,N-1]):null}static patternMatchVariance(r,a,l){let h=r.length,d=0,m=0;for(let v=0;v<h;v++)d+=r[v],m+=a[v];if(d<m)return 1/0;let y=d/m;l*=y;let _=0;for(let v=0;v<h;v++){let N=r[v],k=a[v]*y,B=N>k?N-k:k-N;if(B>l)return 1/0;_+=B}return _/d}}Ut.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ut.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ut.MAX_AVG_VARIANCE=.42,Ut.MAX_INDIVIDUAL_VARIANCE=.8,Ut.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ut.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ut.MAX_PIXEL_DRIFT=3,Ut.MAX_PATTERN_DRIFT=5,Ut.SKIPPED_ROW_COUNT_MAX=25,Ut.ROW_STEP=5,Ut.BARCODE_MIN_HEIGHT=10;class Hn{constructor(r,a){if(a.length===0)throw new R;this.field=r;let l=a.length;if(l>1&&a[0]===0){let h=1;for(;h<l&&a[h]===0;)h++;h===l?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(l-h),re.arraycopy(a,h,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let h=0;for(let d of this.coefficients)h=this.field.add(h,d);return h}let a=this.coefficients[0],l=this.coefficients.length;for(let h=1;h<l;h++)a=this.field.add(this.field.multiply(r,a),this.coefficients[h]);return a}add(r){if(!this.field.equals(r.field))throw new R("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let a=this.coefficients,l=r.coefficients;if(a.length>l.length){let m=a;a=l,l=m}let h=new Int32Array(l.length),d=l.length-a.length;re.arraycopy(l,0,h,0,d);for(let m=d;m<l.length;m++)h[m]=this.field.add(a[m-d],l[m]);return new Hn(this.field,h)}subtract(r){if(!this.field.equals(r.field))throw new R("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof Hn?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new R("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new Hn(this.field,new Int32Array([0]));let a=this.coefficients,l=a.length,h=r.coefficients,d=h.length,m=new Int32Array(l+d-1);for(let y=0;y<l;y++){let _=a[y];for(let v=0;v<d;v++)m[y+v]=this.field.add(m[y+v],this.field.multiply(_,h[v]))}return new Hn(this.field,m)}negative(){let r=this.coefficients.length,a=new Int32Array(r);for(let l=0;l<r;l++)a[l]=this.field.subtract(0,this.coefficients[l]);return new Hn(this.field,a)}multiplyScalar(r){if(r===0)return new Hn(this.field,new Int32Array([0]));if(r===1)return this;let a=this.coefficients.length,l=new Int32Array(a);for(let h=0;h<a;h++)l[h]=this.field.multiply(this.coefficients[h],r);return new Hn(this.field,l)}multiplyByMonomial(r,a){if(r<0)throw new R;if(a===0)return new Hn(this.field,new Int32Array([0]));let l=this.coefficients.length,h=new Int32Array(l+r);for(let d=0;d<l;d++)h[d]=this.field.multiply(this.coefficients[d],a);return new Hn(this.field,h)}toString(){let r=new G;for(let a=this.getDegree();a>=0;a--){let l=this.getCoefficient(a);l!==0&&(l<0?(r.append(" - "),l=-l):r.length()>0&&r.append(" + "),(a===0||l!==1)&&r.append(l),a!==0&&(a===1?r.append("x"):(r.append("x^"),r.append(a))))}return r.toString()}}class sa{add(r,a){return(r+a)%this.modulus}subtract(r,a){return(this.modulus+r-a)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new R;return this.logTable[r]}inverse(r){if(r===0)throw new En;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,a){return r===0||a===0?0:this.expTable[(this.logTable[r]+this.logTable[a])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class Ln extends sa{constructor(r,a){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let l=1;for(let h=0;h<r;h++)this.expTable[h]=l,l=l*a%r;for(let h=0;h<r-1;h++)this.logTable[this.expTable[h]]=h;this.zero=new Hn(this,new Int32Array([0])),this.one=new Hn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,a){if(r<0)throw new R;if(a===0)return this.zero;let l=new Int32Array(r+1);return l[0]=a,new Hn(this,l)}}Ln.PDF417_GF=new Ln(Nt.NUMBER_OF_CODEWORDS,3);class Qi{constructor(){this.field=Ln.PDF417_GF}decode(r,a,l){let h=new Hn(this.field,r),d=new Int32Array(a),m=!1;for(let Z=a;Z>0;Z--){let te=h.evaluateAt(this.field.exp(Z));d[a-Z]=te,te!==0&&(m=!0)}if(!m)return 0;let y=this.field.getOne();if(l!=null)for(const Z of l){let te=this.field.exp(r.length-1-Z),de=new Hn(this.field,new Int32Array([this.field.subtract(0,te),1]));y=y.multiply(de)}let _=new Hn(this.field,d),v=this.runEuclideanAlgorithm(this.field.buildMonomial(a,1),_,a),N=v[0],k=v[1],B=this.findErrorLocations(N),q=this.findErrorMagnitudes(k,N,B);for(let Z=0;Z<B.length;Z++){let te=r.length-1-this.field.log(B[Z]);if(te<0)throw L.getChecksumInstance();r[te]=this.field.subtract(r[te],q[Z])}return B.length}runEuclideanAlgorithm(r,a,l){if(r.getDegree()<a.getDegree()){let B=r;r=a,a=B}let h=r,d=a,m=this.field.getZero(),y=this.field.getOne();for(;d.getDegree()>=Math.round(l/2);){let B=h,q=m;if(h=d,m=y,h.isZero())throw L.getChecksumInstance();d=B;let Z=this.field.getZero(),te=h.getCoefficient(h.getDegree()),de=this.field.inverse(te);for(;d.getDegree()>=h.getDegree()&&!d.isZero();){let _e=d.getDegree()-h.getDegree(),Je=this.field.multiply(d.getCoefficient(d.getDegree()),de);Z=Z.add(this.field.buildMonomial(_e,Je)),d=d.subtract(h.multiplyByMonomial(_e,Je))}y=Z.multiply(m).subtract(q).negative()}let _=y.getCoefficient(0);if(_===0)throw L.getChecksumInstance();let v=this.field.inverse(_),N=y.multiply(v),k=d.multiply(v);return[N,k]}findErrorLocations(r){let a=r.getDegree(),l=new Int32Array(a),h=0;for(let d=1;d<this.field.getSize()&&h<a;d++)r.evaluateAt(d)===0&&(l[h]=this.field.inverse(d),h++);if(h!==a)throw L.getChecksumInstance();return l}findErrorMagnitudes(r,a,l){let h=a.getDegree(),d=new Int32Array(h);for(let v=1;v<=h;v++)d[h-v]=this.field.multiply(v,a.getCoefficient(v));let m=new Hn(this.field,d),y=l.length,_=new Int32Array(y);for(let v=0;v<y;v++){let N=this.field.inverse(l[v]),k=this.field.subtract(0,r.evaluateAt(N)),B=this.field.inverse(m.evaluateAt(N));_[v]=this.field.multiply(k,B)}return _}}class Zi{constructor(r,a,l,h,d){r instanceof Zi?this.constructor_2(r):this.constructor_1(r,a,l,h,d)}constructor_1(r,a,l,h,d){const m=a==null||l==null,y=h==null||d==null;if(m&&y)throw new ce;m?(a=new be(0,h.getY()),l=new be(0,d.getY())):y&&(h=new be(r.getWidth()-1,a.getY()),d=new be(r.getWidth()-1,l.getY())),this.image=r,this.topLeft=a,this.bottomLeft=l,this.topRight=h,this.bottomRight=d,this.minX=Math.trunc(Math.min(a.getX(),l.getX())),this.maxX=Math.trunc(Math.max(h.getX(),d.getX())),this.minY=Math.trunc(Math.min(a.getY(),h.getY())),this.maxY=Math.trunc(Math.max(l.getY(),d.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,a){return r==null?a:a==null?r:new Zi(r.image,r.topLeft,r.bottomLeft,a.topRight,a.bottomRight)}addMissingRows(r,a,l){let h=this.topLeft,d=this.bottomLeft,m=this.topRight,y=this.bottomRight;if(r>0){let _=l?this.topLeft:this.topRight,v=Math.trunc(_.getY()-r);v<0&&(v=0);let N=new be(_.getX(),v);l?h=N:m=N}if(a>0){let _=l?this.bottomLeft:this.bottomRight,v=Math.trunc(_.getY()+a);v>=this.image.getHeight()&&(v=this.image.getHeight()-1);let N=new be(_.getX(),v);l?d=N:y=N}return new Zi(this.image,h,d,m,y)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class aa{constructor(r,a,l,h){this.columnCount=r,this.errorCorrectionLevel=h,this.rowCountUpperPart=a,this.rowCountLowerPart=l,this.rowCount=a+l}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Cs{constructor(){this.buffer=""}static form(r,a){let l=-1;function h(m,y,_,v,N,k){if(m==="%%")return"%";if(a[++l]===void 0)return;m=v?parseInt(v.substr(1)):void 0;let B=N?parseInt(N.substr(1)):void 0,q;switch(k){case"s":q=a[l];break;case"c":q=a[l][0];break;case"f":q=parseFloat(a[l]).toFixed(m);break;case"p":q=parseFloat(a[l]).toPrecision(m);break;case"e":q=parseFloat(a[l]).toExponential(m);break;case"x":q=parseInt(a[l]).toString(B||16);break;case"d":q=parseFloat(parseInt(a[l],B||10).toPrecision(m)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(B);let Z=parseInt(_),te=_&&_[0]+""=="0"?"0":" ";for(;q.length<Z;)q=y!==void 0?q+te:te+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,h)}format(r,...a){this.buffer+=Cs.form(r,a)}toString(){return this.buffer}}class Ji{constructor(r){this.boundingBox=new Zi(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let a=this.getCodeword(r);if(a!=null)return a;for(let l=1;l<Ji.MAX_NEARBY_DISTANCE;l++){let h=this.imageRowToCodewordIndex(r)-l;if(h>=0&&(a=this.codewords[h],a!=null)||(h=this.imageRowToCodewordIndex(r)+l,h<this.codewords.length&&(a=this.codewords[h],a!=null)))return a}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,a){this.codewords[this.imageRowToCodewordIndex(r)]=a}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new Cs;let a=0;for(const l of this.codewords){if(l==null){r.format("%3d:    |   %n",a++);continue}r.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}return r.toString()}}Ji.MAX_NEARBY_DISTANCE=5;class Ci{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let a=this.values.get(r);a==null&&(a=0),a++,this.values.set(r,a)}getValue(){let r=-1,a=new Array;for(const[l,h]of this.values.entries()){const d={getKey:()=>l,getValue:()=>h};d.getValue()>r?(r=d.getValue(),a=[],a.push(d.getKey())):d.getValue()===r&&a.push(d.getKey())}return Nt.toIntArray(a)}getConfidence(r){return this.values.get(r)}}class Vi extends Ji{constructor(r,a){super(r),this._isLeft=a}setRowNumbers(){for(let r of this.getCodewords())r?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let a=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(a,r);let l=this.getBoundingBox(),h=this._isLeft?l.getTopLeft():l.getTopRight(),d=this._isLeft?l.getBottomLeft():l.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(h.getY())),y=this.imageRowToCodewordIndex(Math.trunc(d.getY())),_=-1,v=1,N=0;for(let k=m;k<y;k++){if(a[k]==null)continue;let B=a[k],q=B.getRowNumber()-_;if(q===0)N++;else if(q===1)v=Math.max(v,N),N=1,_=B.getRowNumber();else if(q<0||B.getRowNumber()>=r.getRowCount()||q>k)a[k]=null;else{let Z;v>2?Z=(v-2)*q:Z=q;let te=Z>=k;for(let de=1;de<=Z&&!te;de++)te=a[k-de]!=null;te?a[k]=null:(_=B.getRowNumber(),N=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let a=new Int32Array(r.getRowCount());for(let l of this.getCodewords())if(l!=null){let h=l.getRowNumber();if(h>=a.length)continue;a[h]++}return a}adjustIncompleteIndicatorColumnRowNumbers(r){let a=this.getBoundingBox(),l=this._isLeft?a.getTopLeft():a.getTopRight(),h=this._isLeft?a.getBottomLeft():a.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),m=this.imageRowToCodewordIndex(Math.trunc(h.getY())),y=this.getCodewords(),_=-1;for(let v=d;v<m;v++){if(y[v]==null)continue;let N=y[v];N.setRowNumberAsRowIndicatorColumn();let k=N.getRowNumber()-_;k===0||(k===1?_=N.getRowNumber():N.getRowNumber()>=r.getRowCount()?y[v]=null:_=N.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),a=new Ci,l=new Ci,h=new Ci,d=new Ci;for(let y of r){if(y==null)continue;y.setRowNumberAsRowIndicatorColumn();let _=y.getValue()%30,v=y.getRowNumber();switch(this._isLeft||(v+=2),v%3){case 0:l.setValue(_*3+1);break;case 1:d.setValue(_/3),h.setValue(_%3);break;case 2:a.setValue(_+1);break}}if(a.getValue().length===0||l.getValue().length===0||h.getValue().length===0||d.getValue().length===0||a.getValue()[0]<1||l.getValue()[0]+h.getValue()[0]<Nt.MIN_ROWS_IN_BARCODE||l.getValue()[0]+h.getValue()[0]>Nt.MAX_ROWS_IN_BARCODE)return null;let m=new aa(a.getValue()[0],l.getValue()[0],h.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(r,m),m}removeIncorrectCodewords(r,a){for(let l=0;l<r.length;l++){let h=r[l];if(r[l]==null)continue;let d=h.getValue()%30,m=h.getRowNumber();if(m>a.getRowCount()){r[l]=null;continue}switch(this._isLeft||(m+=2),m%3){case 0:d*3+1!==a.getRowCountUpperPart()&&(r[l]=null);break;case 1:(Math.trunc(d/3)!==a.getErrorCorrectionLevel()||d%3!==a.getRowCountLowerPart())&&(r[l]=null);break;case 2:d+1!==a.getColumnCount()&&(r[l]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class _r{constructor(r,a){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=a,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=Nt.MAX_CODEWORDS_IN_BARCODE,a;do a=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<a);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let a=1;a<this.barcodeColumnCount+1;a++){let l=this.detectionResultColumns[a].getCodewords();for(let h=0;h<l.length;h++)l[h]!=null&&(l[h].hasValidRowNumber()||this.adjustRowNumbers(a,h,l))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<r.length;l++)if(r[l]!=null&&a[l]!=null&&r[l].getRowNumber()===a[l].getRowNumber())for(let h=1;h<=this.barcodeColumnCount;h++){let d=this.detectionResultColumns[h].getCodewords()[l];d!=null&&(d.setRowNumber(r[l].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[h].getCodewords()[l]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<a.length;l++){if(a[l]==null)continue;let h=a[l].getRowNumber(),d=0;for(let m=this.barcodeColumnCount+1;m>0&&d<this.ADJUST_ROW_NUMBER_SKIP;m--){let y=this.detectionResultColumns[m].getCodewords()[l];y!=null&&(d=_r.adjustRowNumberIfValid(h,d,y),y.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,a=this.detectionResultColumns[0].getCodewords();for(let l=0;l<a.length;l++){if(a[l]==null)continue;let h=a[l].getRowNumber(),d=0;for(let m=1;m<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;m++){let y=this.detectionResultColumns[m].getCodewords()[l];y!=null&&(d=_r.adjustRowNumberIfValid(h,d,y),y.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,a,l){return l==null||l.hasValidRowNumber()||(l.isValidRowNumber(r)?(l.setRowNumber(r),a=0):++a),a}adjustRowNumbers(r,a,l){if(!this.detectionResultColumns[r-1])return;let h=l[a],d=this.detectionResultColumns[r-1].getCodewords(),m=d;this.detectionResultColumns[r+1]!=null&&(m=this.detectionResultColumns[r+1].getCodewords());let y=new Array(14);y[2]=d[a],y[3]=m[a],a>0&&(y[0]=l[a-1],y[4]=d[a-1],y[5]=m[a-1]),a>1&&(y[8]=l[a-2],y[10]=d[a-2],y[11]=m[a-2]),a<l.length-1&&(y[1]=l[a+1],y[6]=d[a+1],y[7]=m[a+1]),a<l.length-2&&(y[9]=l[a+2],y[12]=d[a+2],y[13]=m[a+2]);for(let _ of y)if(_r.adjustRowNumber(h,_))return}static adjustRowNumber(r,a){return a==null?!1:a.hasValidRowNumber()&&a.getBucket()===r.getBucket()?(r.setRowNumber(a.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,a){this.detectionResultColumns[r]=a}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let a=new Cs;for(let l=0;l<r.getCodewords().length;l++){a.format("CW %3d:",l);for(let h=0;h<this.barcodeColumnCount+2;h++){if(this.detectionResultColumns[h]==null){a.format("    |   ");continue}let d=this.detectionResultColumns[h].getCodewords()[l];if(d==null){a.format("    |   ");continue}a.format(" %3d|%3d",d.getRowNumber(),d.getValue())}a.format("%n")}return a.toString()}}class Si{constructor(r,a,l,h){this.rowNumber=Si.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(a),this.bucket=Math.trunc(l),this.value=Math.trunc(h)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==Si.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}Si.BARCODE_ROW_UNKNOWN=-1;class lr{static initialize(){for(let r=0;r<Nt.SYMBOL_TABLE.length;r++){let a=Nt.SYMBOL_TABLE[r],l=a&1;for(let h=0;h<Nt.BARS_IN_MODULE;h++){let d=0;for(;(a&1)===l;)d+=1,a>>=1;l=a&1,lr.RATIOS_TABLE[r]||(lr.RATIOS_TABLE[r]=new Array(Nt.BARS_IN_MODULE)),lr.RATIOS_TABLE[r][Nt.BARS_IN_MODULE-h-1]=Math.fround(d/Nt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let a=lr.getDecodedCodewordValue(lr.sampleBitCounts(r));return a!==-1?a:lr.getClosestDecodedValue(r)}static sampleBitCounts(r){let a=Fe.sum(r),l=new Int32Array(Nt.BARS_IN_MODULE),h=0,d=0;for(let m=0;m<Nt.MODULES_IN_CODEWORD;m++){let y=a/(2*Nt.MODULES_IN_CODEWORD)+m*a/Nt.MODULES_IN_CODEWORD;d+r[h]<=y&&(d+=r[h],h++),l[h]++}return l}static getDecodedCodewordValue(r){let a=lr.getBitValue(r);return Nt.getCodeword(a)===-1?-1:a}static getBitValue(r){let a=0;for(let l=0;l<r.length;l++)for(let h=0;h<r[l];h++)a=a<<1|(l%2===0?1:0);return Math.trunc(a)}static getClosestDecodedValue(r){let a=Fe.sum(r),l=new Array(Nt.BARS_IN_MODULE);if(a>1)for(let m=0;m<l.length;m++)l[m]=Math.fround(r[m]/a);let h=ke.MAX_VALUE,d=-1;this.bSymbolTableReady||lr.initialize();for(let m=0;m<lr.RATIOS_TABLE.length;m++){let y=0,_=lr.RATIOS_TABLE[m];for(let v=0;v<Nt.BARS_IN_MODULE;v++){let N=Math.fround(_[v]-l[v]);if(y+=Math.fround(N*N),y>=h)break}y<h&&(h=y,d=Nt.SYMBOL_TABLE[m])}return d}}lr.bSymbolTableReady=!1,lr.RATIOS_TABLE=new Array(Nt.SYMBOL_TABLE.length).map(M=>new Array(Nt.BARS_IN_MODULE));class Ss{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class qa{static parseLong(r,a=void 0){return parseInt(r,a)}}class Is extends w{}Is.kind="NullPointerException";class Xa{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,a,l){if(r==null)throw new Is;if(a<0||a>r.length||l<0||a+l>r.length||a+l<0)throw new se;if(l===0)return;for(let h=0;h<l;h++)this.write(r[a+h])}flush(){}close(){}}class hs extends w{}class Ya extends Xa{constructor(r=32){if(super(),this.count=0,r<0)throw new R("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let l=this.buf.length<<1;if(l-r<0&&(l=r),l<0){if(r<0)throw new hs;l=le.MAX_VALUE}this.buf=Oe.copyOfUint8Array(this.buf,l)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,a,l){if(a<0||a>r.length||l<0||a+l-r.length>0)throw new se;this.ensureCapacity(this.count+l),re.arraycopy(r,a,this.buf,this.count,l),this.count+=l}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return Oe.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var Dn;(function(M){M[M.ALPHA=0]="ALPHA",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.PUNCT=3]="PUNCT",M[M.ALPHA_SHIFT=4]="ALPHA_SHIFT",M[M.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Dn||(Dn={}));function Fs(){if(typeof window<"u")return window.BigInt||null;if(typeof $h<"u")return $h.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let oa;function $i(M){if(typeof oa>"u"&&(oa=Fs()),oa===null)throw new Error("BigInt is not supported!");return oa(M)}function la(){let M=[];M[0]=$i(1);let r=$i(900);M[1]=r;for(let a=2;a<16;a++)M[a]=M[a-1]*r;return M}class we{static decode(r,a){let l=new G(""),h=U.ISO8859_1;l.enableDecoding(h);let d=1,m=r[d++],y=new Ss;for(;d<r[0];){switch(m){case we.TEXT_COMPACTION_MODE_LATCH:d=we.textCompaction(r,d,l);break;case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:d=we.byteCompaction(m,r,h,d,l);break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(r[d++]);break;case we.NUMERIC_COMPACTION_MODE_LATCH:d=we.numericCompaction(r,d,l);break;case we.ECI_CHARSET:U.getCharacterSetECIByValue(r[d++]);break;case we.ECI_GENERAL_PURPOSE:d+=2;break;case we.ECI_USER_DEFINED:d++;break;case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=we.decodeMacroBlock(r,d,y);break;case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:throw new F;default:d--,d=we.textCompaction(r,d,l);break}if(d<r.length)m=r[d++];else throw F.getFormatInstance()}if(l.length()===0)throw F.getFormatInstance();let _=new kt(null,l.toString(),null,a);return _.setOther(y),_}static decodeMacroBlock(r,a,l){if(a+we.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw F.getFormatInstance();let h=new Int32Array(we.NUMBER_OF_SEQUENCE_CODEWORDS);for(let y=0;y<we.NUMBER_OF_SEQUENCE_CODEWORDS;y++,a++)h[y]=r[a];l.setSegmentIndex(le.parseInt(we.decodeBase900toBase10(h,we.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new G;a=we.textCompaction(r,a,d),l.setFileId(d.toString());let m=-1;for(r[a]===we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(m=a+1);a<r[0];)switch(r[a]){case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(a++,r[a]){case we.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let y=new G;a=we.textCompaction(r,a+1,y),l.setFileName(y.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let _=new G;a=we.textCompaction(r,a+1,_),l.setSender(_.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let v=new G;a=we.textCompaction(r,a+1,v),l.setAddressee(v.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let N=new G;a=we.numericCompaction(r,a+1,N),l.setSegmentCount(le.parseInt(N.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let k=new G;a=we.numericCompaction(r,a+1,k),l.setTimestamp(qa.parseLong(k.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let B=new G;a=we.numericCompaction(r,a+1,B),l.setChecksum(le.parseInt(B.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let q=new G;a=we.numericCompaction(r,a+1,q),l.setFileSize(qa.parseLong(q.toString()));break;default:throw F.getFormatInstance()}break;case we.MACRO_PDF417_TERMINATOR:a++,l.setLastSegment(!0);break;default:throw F.getFormatInstance()}if(m!==-1){let y=a-m;l.isLastSegment()&&y--,l.setOptionalData(Oe.copyOfRange(r,m,m+y))}return a}static textCompaction(r,a,l){let h=new Int32Array((r[0]-a)*2),d=new Int32Array((r[0]-a)*2),m=0,y=!1;for(;a<r[0]&&!y;){let _=r[a++];if(_<we.TEXT_COMPACTION_MODE_LATCH)h[m]=_/30,h[m+1]=_%30,m+=2;else switch(_){case we.TEXT_COMPACTION_MODE_LATCH:h[m++]=we.TEXT_COMPACTION_MODE_LATCH;break;case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:a--,y=!0;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h[m]=we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,_=r[a++],d[m]=_,m++;break}}return we.decodeTextCompaction(h,d,m,l),a}static decodeTextCompaction(r,a,l,h){let d=Dn.ALPHA,m=Dn.ALPHA,y=0;for(;y<l;){let _=r[y],v="";switch(d){case Dn.ALPHA:if(_<26)v=String.fromCharCode(65+_);else switch(_){case 26:v=" ";break;case we.LL:d=Dn.LOWER;break;case we.ML:d=Dn.MIXED;break;case we.PS:m=d,d=Dn.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.LOWER:if(_<26)v=String.fromCharCode(97+_);else switch(_){case 26:v=" ";break;case we.AS:m=d,d=Dn.ALPHA_SHIFT;break;case we.ML:d=Dn.MIXED;break;case we.PS:m=d,d=Dn.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.MIXED:if(_<we.PL)v=we.MIXED_CHARS[_];else switch(_){case we.PL:d=Dn.PUNCT;break;case 26:v=" ";break;case we.LL:d=Dn.LOWER;break;case we.AL:d=Dn.ALPHA;break;case we.PS:m=d,d=Dn.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.PUNCT:if(_<we.PAL)v=we.PUNCT_CHARS[_];else switch(_){case we.PAL:d=Dn.ALPHA;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.ALPHA_SHIFT:if(d=m,_<26)v=String.fromCharCode(65+_);else switch(_){case 26:v=" ";break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.PUNCT_SHIFT:if(d=m,_<we.PAL)v=we.PUNCT_CHARS[_];else switch(_){case we.PAL:d=Dn.ALPHA;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break}v!==""&&h.append(v),y++}}static byteCompaction(r,a,l,h,d){let m=new Ya,y=0,_=0,v=!1;switch(r){case we.BYTE_COMPACTION_MODE_LATCH:let N=new Int32Array(6),k=a[h++];for(;h<a[0]&&!v;)switch(N[y++]=k,_=900*_+k,k=a[h++],k){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:h--,v=!0;break;default:if(y%5===0&&y>0){for(let B=0;B<6;++B)m.write(Number($i(_)>>$i(8*(5-B))));_=0,y=0}break}h===a[0]&&k<we.TEXT_COMPACTION_MODE_LATCH&&(N[y++]=k);for(let B=0;B<y;B++)m.write(N[B]);break;case we.BYTE_COMPACTION_MODE_LATCH_6:for(;h<a[0]&&!v;){let B=a[h++];if(B<we.TEXT_COMPACTION_MODE_LATCH)y++,_=900*_+B;else switch(B){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:h--,v=!0;break}if(y%5===0&&y>0){for(let q=0;q<6;++q)m.write(Number($i(_)>>$i(8*(5-q))));_=0,y=0}}break}return d.append(X.decode(m.toByteArray(),l)),h}static numericCompaction(r,a,l){let h=0,d=!1,m=new Int32Array(we.MAX_NUMERIC_CODEWORDS);for(;a<r[0]&&!d;){let y=r[a++];if(a===r[0]&&(d=!0),y<we.TEXT_COMPACTION_MODE_LATCH)m[h]=y,h++;else switch(y){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:a--,d=!0;break}(h%we.MAX_NUMERIC_CODEWORDS===0||y===we.NUMERIC_COMPACTION_MODE_LATCH||d)&&h>0&&(l.append(we.decodeBase900toBase10(m,h)),h=0)}return a}static decodeBase900toBase10(r,a){let l=$i(0);for(let d=0;d<a;d++)l+=we.EXP900[a-d-1]*$i(r[d]);let h=l.toString();if(h.charAt(0)!=="1")throw new F;return h.substring(1)}}we.TEXT_COMPACTION_MODE_LATCH=900,we.BYTE_COMPACTION_MODE_LATCH=901,we.NUMERIC_COMPACTION_MODE_LATCH=902,we.BYTE_COMPACTION_MODE_LATCH_6=924,we.ECI_USER_DEFINED=925,we.ECI_GENERAL_PURPOSE=926,we.ECI_CHARSET=927,we.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,we.MACRO_PDF417_TERMINATOR=922,we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,we.MAX_NUMERIC_CODEWORDS=15,we.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,we.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,we.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,we.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,we.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,we.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,we.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,we.PL=25,we.LL=27,we.AS=27,we.ML=28,we.AL=28,we.PS=29,we.PAL=29,we.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,we.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",we.EXP900=Fs()?la():[],we.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Zt{constructor(){}static decode(r,a,l,h,d,m,y){let _=new Zi(r,a,l,h,d),v=null,N=null,k;for(let Z=!0;;Z=!1){if(a!=null&&(v=Zt.getRowIndicatorColumn(r,_,a,!0,m,y)),h!=null&&(N=Zt.getRowIndicatorColumn(r,_,h,!1,m,y)),k=Zt.merge(v,N),k==null)throw ce.getNotFoundInstance();let te=k.getBoundingBox();if(Z&&te!=null&&(te.getMinY()<_.getMinY()||te.getMaxY()>_.getMaxY()))_=te;else break}k.setBoundingBox(_);let B=k.getBarcodeColumnCount()+1;k.setDetectionResultColumn(0,v),k.setDetectionResultColumn(B,N);let q=v!=null;for(let Z=1;Z<=B;Z++){let te=q?Z:B-Z;if(k.getDetectionResultColumn(te)!==void 0)continue;let de;te===0||te===B?de=new Vi(_,te===0):de=new Ji(_),k.setDetectionResultColumn(te,de);let _e=-1,Je=_e;for(let Ke=_.getMinY();Ke<=_.getMaxY();Ke++){if(_e=Zt.getStartColumn(k,te,Ke,q),_e<0||_e>_.getMaxX()){if(Je===-1)continue;_e=Je}let Ge=Zt.detectCodeword(r,_.getMinX(),_.getMaxX(),q,_e,Ke,m,y);Ge!=null&&(de.setCodeword(Ke,Ge),Je=_e,m=Math.min(m,Ge.getWidth()),y=Math.max(y,Ge.getWidth()))}}return Zt.createDecoderResult(k)}static merge(r,a){if(r==null&&a==null)return null;let l=Zt.getBarcodeMetadata(r,a);if(l==null)return null;let h=Zi.merge(Zt.adjustBoundingBox(r),Zt.adjustBoundingBox(a));return new _r(l,h)}static adjustBoundingBox(r){if(r==null)return null;let a=r.getRowHeights();if(a==null)return null;let l=Zt.getMax(a),h=0;for(let y of a)if(h+=l-y,y>0)break;let d=r.getCodewords();for(let y=0;h>0&&d[y]==null;y++)h--;let m=0;for(let y=a.length-1;y>=0&&(m+=l-a[y],!(a[y]>0));y--);for(let y=d.length-1;m>0&&d[y]==null;y--)m--;return r.getBoundingBox().addMissingRows(h,m,r.isLeft())}static getMax(r){let a=-1;for(let l of r)a=Math.max(a,l);return a}static getBarcodeMetadata(r,a){let l;if(r==null||(l=r.getBarcodeMetadata())==null)return a==null?null:a.getBarcodeMetadata();let h;return a==null||(h=a.getBarcodeMetadata())==null?l:l.getColumnCount()!==h.getColumnCount()&&l.getErrorCorrectionLevel()!==h.getErrorCorrectionLevel()&&l.getRowCount()!==h.getRowCount()?null:l}static getRowIndicatorColumn(r,a,l,h,d,m){let y=new Vi(a,h);for(let _=0;_<2;_++){let v=_===0?1:-1,N=Math.trunc(Math.trunc(l.getX()));for(let k=Math.trunc(Math.trunc(l.getY()));k<=a.getMaxY()&&k>=a.getMinY();k+=v){let B=Zt.detectCodeword(r,0,r.getWidth(),h,N,k,d,m);B!=null&&(y.setCodeword(k,B),h?N=B.getStartX():N=B.getEndX())}}return y}static adjustCodewordCount(r,a){let l=a[0][1],h=l.getValue(),d=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-Zt.getNumberOfECCodeWords(r.getBarcodeECLevel());if(h.length===0){if(d<1||d>Nt.MAX_CODEWORDS_IN_BARCODE)throw ce.getNotFoundInstance();l.setValue(d)}else h[0]!==d&&l.setValue(d)}static createDecoderResult(r){let a=Zt.createBarcodeMatrix(r);Zt.adjustCodewordCount(r,a);let l=new Array,h=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),d=[],m=new Array;for(let _=0;_<r.getBarcodeRowCount();_++)for(let v=0;v<r.getBarcodeColumnCount();v++){let N=a[_][v+1].getValue(),k=_*r.getBarcodeColumnCount()+v;N.length===0?l.push(k):N.length===1?h[k]=N[0]:(m.push(k),d.push(N))}let y=new Array(d.length);for(let _=0;_<y.length;_++)y[_]=d[_];return Zt.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),h,Nt.toIntArray(l),Nt.toIntArray(m),y)}static createDecoderResultFromAmbiguousValues(r,a,l,h,d){let m=new Int32Array(h.length),y=100;for(;y-- >0;){for(let _=0;_<m.length;_++)a[h[_]]=d[_][m[_]];try{return Zt.decodeCodewords(a,r,l)}catch(_){if(!(_ instanceof L))throw _}if(m.length===0)throw L.getChecksumInstance();for(let _=0;_<m.length;_++)if(m[_]<d[_].length-1){m[_]++;break}else if(m[_]=0,_===m.length-1)throw L.getChecksumInstance()}throw L.getChecksumInstance()}static createBarcodeMatrix(r){let a=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let h=0;h<a.length;h++)for(let d=0;d<a[h].length;d++)a[h][d]=new Ci;let l=0;for(let h of r.getDetectionResultColumns()){if(h!=null){for(let d of h.getCodewords())if(d!=null){let m=d.getRowNumber();if(m>=0){if(m>=a.length)continue;a[m][l].setValue(d.getValue())}}}l++}return a}static isValidBarcodeColumn(r,a){return a>=0&&a<=r.getBarcodeColumnCount()+1}static getStartColumn(r,a,l,h){let d=h?1:-1,m=null;if(Zt.isValidBarcodeColumn(r,a-d)&&(m=r.getDetectionResultColumn(a-d).getCodeword(l)),m!=null)return h?m.getEndX():m.getStartX();if(m=r.getDetectionResultColumn(a).getCodewordNearby(l),m!=null)return h?m.getStartX():m.getEndX();if(Zt.isValidBarcodeColumn(r,a-d)&&(m=r.getDetectionResultColumn(a-d).getCodewordNearby(l)),m!=null)return h?m.getEndX():m.getStartX();let y=0;for(;Zt.isValidBarcodeColumn(r,a-d);){a-=d;for(let _ of r.getDetectionResultColumn(a).getCodewords())if(_!=null)return(h?_.getEndX():_.getStartX())+d*y*(_.getEndX()-_.getStartX());y++}return h?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,a,l,h,d,m,y,_){d=Zt.adjustCodewordStartColumn(r,a,l,h,d,m);let v=Zt.getModuleBitCount(r,a,l,h,d,m);if(v==null)return null;let N,k=Fe.sum(v);if(h)N=d+k;else{for(let Z=0;Z<v.length/2;Z++){let te=v[Z];v[Z]=v[v.length-1-Z],v[v.length-1-Z]=te}N=d,d=N-k}if(!Zt.checkCodewordSkew(k,y,_))return null;let B=lr.getDecodedValue(v),q=Nt.getCodeword(B);return q===-1?null:new Si(d,N,Zt.getCodewordBucketNumber(B),q)}static getModuleBitCount(r,a,l,h,d,m){let y=d,_=new Int32Array(8),v=0,N=h?1:-1,k=h;for(;(h?y<l:y>=a)&&v<_.length;)r.get(y,m)===k?(_[v]++,y+=N):(v++,k=!k);return v===_.length||y===(h?l:a)&&v===_.length-1?_:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,a,l,h,d,m){let y=d,_=h?-1:1;for(let v=0;v<2;v++){for(;(h?y>=a:y<l)&&h===r.get(y,m);){if(Math.abs(d-y)>Zt.CODEWORD_SKEW_SIZE)return d;y+=_}_=-_,h=!h}return y}static checkCodewordSkew(r,a,l){return a-Zt.CODEWORD_SKEW_SIZE<=r&&r<=l+Zt.CODEWORD_SKEW_SIZE}static decodeCodewords(r,a,l){if(r.length===0)throw F.getFormatInstance();let h=1<<a+1,d=Zt.correctErrors(r,l,h);Zt.verifyCodewordCount(r,h);let m=we.decode(r,""+a);return m.setErrorsCorrected(d),m.setErasures(l.length),m}static correctErrors(r,a,l){if(a!=null&&a.length>l/2+Zt.MAX_ERRORS||l<0||l>Zt.MAX_EC_CODEWORDS)throw L.getChecksumInstance();return Zt.errorCorrection.decode(r,l,a)}static verifyCodewordCount(r,a){if(r.length<4)throw F.getFormatInstance();let l=r[0];if(l>r.length)throw F.getFormatInstance();if(l===0)if(a<r.length)r[0]=r.length-a;else throw F.getFormatInstance()}static getBitCountForCodeword(r){let a=new Int32Array(8),l=0,h=a.length-1;for(;!((r&1)!==l&&(l=r&1,h--,h<0));)a[h]++,r>>=1;return a}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return Zt.getCodewordBucketNumber(Zt.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let a=new Cs;for(let l=0;l<r.length;l++){a.format("Row %2d: ",l);for(let h=0;h<r[l].length;h++){let d=r[l][h];d.getValue().length===0?a.format("        ",null):a.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}a.format("%n")}return a.toString()}}Zt.CODEWORD_SKEW_SIZE=2,Zt.MAX_ERRORS=3,Zt.MAX_EC_CODEWORDS=512,Zt.errorCorrection=new Qi;class fr{decode(r,a=null){let l=fr.decode(r,a,!1);if(l==null||l.length===0||l[0]==null)throw ce.getNotFoundInstance();return l[0]}decodeMultiple(r,a=null){try{return fr.decode(r,a,!0)}catch(l){throw l instanceof F||l instanceof L?ce.getNotFoundInstance():l}}static decode(r,a,l){const h=new Array,d=Ut.detectMultiple(r,a,l);for(const m of d.getPoints()){const y=Zt.decode(d.getBits(),m[4],m[5],m[6],m[7],fr.getMinCodewordWidth(m),fr.getMaxCodewordWidth(m)),_=new Te(y.getText(),y.getRawBytes(),void 0,m,ve.PDF_417);_.putMetadata(xt.ERROR_CORRECTION_LEVEL,y.getECLevel());const v=y.getOther();v!=null&&_.putMetadata(xt.PDF417_EXTRA_METADATA,v),h.push(_)}return h.map(m=>m)}static getMaxWidth(r,a){return r==null||a==null?0:Math.trunc(Math.abs(r.getX()-a.getX()))}static getMinWidth(r,a){return r==null||a==null?le.MAX_VALUE:Math.trunc(Math.abs(r.getX()-a.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(fr.getMaxWidth(r[0],r[4]),fr.getMaxWidth(r[6],r[2])*Nt.MODULES_IN_CODEWORD/Nt.MODULES_IN_STOP_PATTERN),Math.max(fr.getMaxWidth(r[1],r[5]),fr.getMaxWidth(r[7],r[3])*Nt.MODULES_IN_CODEWORD/Nt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(fr.getMinWidth(r[0],r[4]),fr.getMinWidth(r[6],r[2])*Nt.MODULES_IN_CODEWORD/Nt.MODULES_IN_STOP_PATTERN),Math.min(fr.getMinWidth(r[1],r[5]),fr.getMinWidth(r[7],r[3])*Nt.MODULES_IN_CODEWORD/Nt.MODULES_IN_STOP_PATTERN)))}reset(){}}class ca extends w{}ca.kind="ReaderException";class Ho{constructor(r,a){this.verbose=r===!0,a&&this.setHints(a)}decode(r,a){return a&&this.setHints(a),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const a=!o(r)&&r.get(Ze.TRY_HARDER)===!0,l=o(r)?null:r.get(Ze.POSSIBLE_FORMATS),h=new Array;if(!o(l)){const d=l.some(m=>m===ve.UPC_A||m===ve.UPC_E||m===ve.EAN_13||m===ve.EAN_8||m===ve.CODABAR||m===ve.CODE_39||m===ve.CODE_93||m===ve.CODE_128||m===ve.ITF||m===ve.RSS_14||m===ve.RSS_EXPANDED);d&&!a&&h.push(new $e(r,this.verbose)),l.includes(ve.QR_CODE)&&h.push(new xi),l.includes(ve.DATA_MATRIX)&&h.push(new er),l.includes(ve.AZTEC)&&h.push(new Ti),l.includes(ve.PDF_417)&&h.push(new fr),d&&a&&h.push(new $e(r,this.verbose))}h.length===0&&(a||h.push(new $e(r,this.verbose)),h.push(new xi),h.push(new er),h.push(new Ti),h.push(new fr),a&&h.push(new $e(r,this.verbose))),this.readers=h}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new ca("No readers where selected, nothing can be read.");for(const a of this.readers)try{return a.decode(r,this.hints)}catch(l){if(l instanceof ca)continue}throw new ce("No MultiFormat Readers were able to detect the code.")}}class ds extends pe{constructor(r=null,a=500){const l=new Ho;l.setHints(r),super(l,a)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class Al extends pe{constructor(r=500){super(new fr,r)}}class bl extends pe{constructor(r=500){super(new xi,r)}}var Ka;(function(M){M[M.ERROR_CORRECTION=0]="ERROR_CORRECTION",M[M.CHARACTER_SET=1]="CHARACTER_SET",M[M.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",M[M.MIN_SIZE=3]="MIN_SIZE",M[M.MAX_SIZE=4]="MAX_SIZE",M[M.MARGIN=5]="MARGIN",M[M.PDF417_COMPACT=6]="PDF417_COMPACT",M[M.PDF417_COMPACTION=7]="PDF417_COMPACTION",M[M.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",M[M.AZTEC_LAYERS=9]="AZTEC_LAYERS",M[M.QR_VERSION=10]="QR_VERSION"})(Ka||(Ka={}));var gr=Ka;class fs{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new en(r,Int32Array.from([1])))}buildGenerator(r){const a=this.cachedGenerators;if(r>=a.length){let l=a[a.length-1];const h=this.field;for(let d=a.length;d<=r;d++){const m=l.multiply(new en(h,Int32Array.from([1,h.exp(d-1+h.getGeneratorBase())])));a.push(m),l=m}}return a[r]}encode(r,a){if(a===0)throw new R("No error correction bytes");const l=r.length-a;if(l<=0)throw new R("No data bytes provided");const h=this.buildGenerator(a),d=new Int32Array(l);re.arraycopy(r,0,d,0,l);let m=new en(this.field,d);m=m.multiplyByMonomial(a,1);const _=m.divide(h)[1].getCoefficients(),v=a-_.length;for(let N=0;N<v;N++)r[l+N]=0;re.arraycopy(_,0,r,l+v,_.length)}}class gn{constructor(){}static applyMaskPenaltyRule1(r){return gn.applyMaskPenaltyRule1Internal(r,!0)+gn.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let a=0;const l=r.getArray(),h=r.getWidth(),d=r.getHeight();for(let m=0;m<d-1;m++){const y=l[m];for(let _=0;_<h-1;_++){const v=y[_];v===y[_+1]&&v===l[m+1][_]&&v===l[m+1][_+1]&&a++}}return gn.N2*a}static applyMaskPenaltyRule3(r){let a=0;const l=r.getArray(),h=r.getWidth(),d=r.getHeight();for(let m=0;m<d;m++)for(let y=0;y<h;y++){const _=l[m];y+6<h&&_[y]===1&&_[y+1]===0&&_[y+2]===1&&_[y+3]===1&&_[y+4]===1&&_[y+5]===0&&_[y+6]===1&&(gn.isWhiteHorizontal(_,y-4,y)||gn.isWhiteHorizontal(_,y+7,y+11))&&a++,m+6<d&&l[m][y]===1&&l[m+1][y]===0&&l[m+2][y]===1&&l[m+3][y]===1&&l[m+4][y]===1&&l[m+5][y]===0&&l[m+6][y]===1&&(gn.isWhiteVertical(l,y,m-4,m)||gn.isWhiteVertical(l,y,m+7,m+11))&&a++}return a*gn.N3}static isWhiteHorizontal(r,a,l){a=Math.max(a,0),l=Math.min(l,r.length);for(let h=a;h<l;h++)if(r[h]===1)return!1;return!0}static isWhiteVertical(r,a,l,h){l=Math.max(l,0),h=Math.min(h,r.length);for(let d=l;d<h;d++)if(r[d][a]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let a=0;const l=r.getArray(),h=r.getWidth(),d=r.getHeight();for(let _=0;_<d;_++){const v=l[_];for(let N=0;N<h;N++)v[N]===1&&a++}const m=r.getHeight()*r.getWidth();return Math.floor(Math.abs(a*2-m)*10/m)*gn.N4}static getDataMaskBit(r,a,l){let h,d;switch(r){case 0:h=l+a&1;break;case 1:h=l&1;break;case 2:h=a%3;break;case 3:h=(l+a)%3;break;case 4:h=Math.floor(l/2)+Math.floor(a/3)&1;break;case 5:d=l*a,h=(d&1)+d%3;break;case 6:d=l*a,h=(d&1)+d%3&1;break;case 7:d=l*a,h=d%3+(l+a&1)&1;break;default:throw new R("Invalid mask pattern: "+r)}return h===0}static applyMaskPenaltyRule1Internal(r,a){let l=0;const h=a?r.getHeight():r.getWidth(),d=a?r.getWidth():r.getHeight(),m=r.getArray();for(let y=0;y<h;y++){let _=0,v=-1;for(let N=0;N<d;N++){const k=a?m[y][N]:m[N][y];k===v?_++:(_>=5&&(l+=gn.N1+(_-5)),_=1,v=k)}_>=5&&(l+=gn.N1+(_-5))}return l}}gn.N1=3,gn.N2=3,gn.N3=40,gn.N4=10;class ua{constructor(r,a){this.width=r,this.height=a;const l=new Array(a);for(let h=0;h!==a;h++)l[h]=new Uint8Array(r);this.bytes=l}getHeight(){return this.height}getWidth(){return this.width}get(r,a){return this.bytes[a][r]}getArray(){return this.bytes}setNumber(r,a,l){this.bytes[a][r]=l}setBoolean(r,a,l){this.bytes[a][r]=l?1:0}clear(r){for(const a of this.bytes)Oe.fill(a,r)}equals(r){if(!(r instanceof ua))return!1;const a=r;if(this.width!==a.width||this.height!==a.height)return!1;for(let l=0,h=this.height;l<h;++l){const d=this.bytes[l],m=a.bytes[l];for(let y=0,_=this.width;y<_;++y)if(d[y]!==m[y])return!1}return!0}toString(){const r=new G;for(let a=0,l=this.height;a<l;++a){const h=this.bytes[a];for(let d=0,m=this.width;d<m;++d)switch(h[d]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class gs{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new G;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<gs.NUM_MASK_PATTERNS}}gs.NUM_MASK_PATTERNS=8;class mn extends w{}mn.kind="WriterException";class p{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,a,l,h,d){p.clearMatrix(d),p.embedBasicPatterns(l,d),p.embedTypeInfo(a,h,d),p.maybeEmbedVersionInfo(l,d),p.embedDataBits(r,h,d)}static embedBasicPatterns(r,a){p.embedPositionDetectionPatternsAndSeparators(a),p.embedDarkDotAtLeftBottomCorner(a),p.maybeEmbedPositionAdjustmentPatterns(r,a),p.embedTimingPatterns(a)}static embedTypeInfo(r,a,l){const h=new Ue;p.makeTypeInfoBits(r,a,h);for(let d=0,m=h.getSize();d<m;++d){const y=h.get(h.getSize()-1-d),_=p.TYPE_INFO_COORDINATES[d],v=_[0],N=_[1];if(l.setBoolean(v,N,y),d<8){const k=l.getWidth()-d-1;l.setBoolean(k,8,y)}else{const B=l.getHeight()-7+(d-8);l.setBoolean(8,B,y)}}}static maybeEmbedVersionInfo(r,a){if(r.getVersionNumber()<7)return;const l=new Ue;p.makeVersionInfoBits(r,l);let h=17;for(let d=0;d<6;++d)for(let m=0;m<3;++m){const y=l.get(h);h--,a.setBoolean(d,a.getHeight()-11+m,y),a.setBoolean(a.getHeight()-11+m,d,y)}}static embedDataBits(r,a,l){let h=0,d=-1,m=l.getWidth()-1,y=l.getHeight()-1;for(;m>0;){for(m===6&&(m-=1);y>=0&&y<l.getHeight();){for(let _=0;_<2;++_){const v=m-_;if(!p.isEmpty(l.get(v,y)))continue;let N;h<r.getSize()?(N=r.get(h),++h):N=!1,a!==255&&gn.getDataMaskBit(a,v,y)&&(N=!N),l.setBoolean(v,y,N)}y+=d}d=-d,y+=d,m-=2}if(h!==r.getSize())throw new mn("Not all bits consumed: "+h+"/"+r.getSize())}static findMSBSet(r){return 32-le.numberOfLeadingZeros(r)}static calculateBCHCode(r,a){if(a===0)throw new R("0 polynomial");const l=p.findMSBSet(a);for(r<<=l-1;p.findMSBSet(r)>=l;)r^=a<<p.findMSBSet(r)-l;return r}static makeTypeInfoBits(r,a,l){if(!gs.isValidMaskPattern(a))throw new mn("Invalid mask pattern");const h=r.getBits()<<3|a;l.appendBits(h,5);const d=p.calculateBCHCode(h,p.TYPE_INFO_POLY);l.appendBits(d,10);const m=new Ue;if(m.appendBits(p.TYPE_INFO_MASK_PATTERN,15),l.xor(m),l.getSize()!==15)throw new mn("should not happen but we got: "+l.getSize())}static makeVersionInfoBits(r,a){a.appendBits(r.getVersionNumber(),6);const l=p.calculateBCHCode(r.getVersionNumber(),p.VERSION_INFO_POLY);if(a.appendBits(l,12),a.getSize()!==18)throw new mn("should not happen but we got: "+a.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let a=8;a<r.getWidth()-8;++a){const l=(a+1)%2;p.isEmpty(r.get(a,6))&&r.setNumber(a,6,l),p.isEmpty(r.get(6,a))&&r.setNumber(6,a,l)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new mn;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,a,l){for(let h=0;h<8;++h){if(!p.isEmpty(l.get(r+h,a)))throw new mn;l.setNumber(r+h,a,0)}}static embedVerticalSeparationPattern(r,a,l){for(let h=0;h<7;++h){if(!p.isEmpty(l.get(r,a+h)))throw new mn;l.setNumber(r,a+h,0)}}static embedPositionAdjustmentPattern(r,a,l){for(let h=0;h<5;++h){const d=p.POSITION_ADJUSTMENT_PATTERN[h];for(let m=0;m<5;++m)l.setNumber(r+m,a+h,d[m])}}static embedPositionDetectionPattern(r,a,l){for(let h=0;h<7;++h){const d=p.POSITION_DETECTION_PATTERN[h];for(let m=0;m<7;++m)l.setNumber(r+m,a+h,d[m])}}static embedPositionDetectionPatternsAndSeparators(r){const a=p.POSITION_DETECTION_PATTERN[0].length;p.embedPositionDetectionPattern(0,0,r),p.embedPositionDetectionPattern(r.getWidth()-a,0,r),p.embedPositionDetectionPattern(0,r.getWidth()-a,r);const l=8;p.embedHorizontalSeparationPattern(0,l-1,r),p.embedHorizontalSeparationPattern(r.getWidth()-l,l-1,r),p.embedHorizontalSeparationPattern(0,r.getWidth()-l,r);const h=7;p.embedVerticalSeparationPattern(h,0,r),p.embedVerticalSeparationPattern(r.getHeight()-h-1,0,r),p.embedVerticalSeparationPattern(h,r.getHeight()-h,r)}static maybeEmbedPositionAdjustmentPatterns(r,a){if(r.getVersionNumber()<2)return;const l=r.getVersionNumber()-1,h=p.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[l];for(let d=0,m=h.length;d!==m;d++){const y=h[d];if(y>=0)for(let _=0;_!==m;_++){const v=h[_];v>=0&&p.isEmpty(a.get(v,y))&&p.embedPositionAdjustmentPattern(v-2,y-2,a)}}}}p.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),p.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),p.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),p.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),p.VERSION_INFO_POLY=7973,p.TYPE_INFO_POLY=1335,p.TYPE_INFO_MASK_PATTERN=21522;class S{constructor(r,a){this.dataBytes=r,this.errorCorrectionBytes=a}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class D{constructor(){}static calculateMaskPenalty(r){return gn.applyMaskPenaltyRule1(r)+gn.applyMaskPenaltyRule2(r)+gn.applyMaskPenaltyRule3(r)+gn.applyMaskPenaltyRule4(r)}static encode(r,a,l=null){let h=D.DEFAULT_BYTE_MODE_ENCODING;const d=l!==null&&l.get(gr.CHARACTER_SET)!==void 0;d&&(h=l.get(gr.CHARACTER_SET).toString());const m=this.chooseMode(r,h),y=new Ue;if(m===Tt.BYTE&&(d||D.DEFAULT_BYTE_MODE_ENCODING!==h)){const Ke=U.getCharacterSetECIByName(h);Ke!==void 0&&this.appendECI(Ke,y)}this.appendModeInfo(m,y);const _=new Ue;this.appendBytes(r,m,_,h);let v;if(l!==null&&l.get(gr.QR_VERSION)!==void 0){const Ke=Number.parseInt(l.get(gr.QR_VERSION).toString(),10);v=_t.getVersionForNumber(Ke);const Ge=this.calculateBitsNeeded(m,y,_,v);if(!this.willFit(Ge,v,a))throw new mn("Data too big for requested version")}else v=this.recommendVersion(a,m,y,_);const N=new Ue;N.appendBitArray(y);const k=m===Tt.BYTE?_.getSizeInBytes():r.length;this.appendLengthInfo(k,v,m,N),N.appendBitArray(_);const B=v.getECBlocksForLevel(a),q=v.getTotalCodewords()-B.getTotalECCodewords();this.terminateBits(q,N);const Z=this.interleaveWithECBytes(N,v.getTotalCodewords(),q,B.getNumBlocks()),te=new gs;te.setECLevel(a),te.setMode(m),te.setVersion(v);const de=v.getDimensionForVersion(),_e=new ua(de,de),Je=this.chooseMaskPattern(Z,a,v,_e);return te.setMaskPattern(Je),p.buildMatrix(Z,a,v,Je,_e),te.setMatrix(_e),te}static recommendVersion(r,a,l,h){const d=this.calculateBitsNeeded(a,l,h,_t.getVersionForNumber(1)),m=this.chooseVersion(d,r),y=this.calculateBitsNeeded(a,l,h,m);return this.chooseVersion(y,r)}static calculateBitsNeeded(r,a,l,h){return a.getSize()+r.getCharacterCountBits(h)+l.getSize()}static getAlphanumericCode(r){return r<D.ALPHANUMERIC_TABLE.length?D.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,a=null){if(U.SJIS.getName()===a&&this.isOnlyDoubleByteKanji(r))return Tt.KANJI;let l=!1,h=!1;for(let d=0,m=r.length;d<m;++d){const y=r.charAt(d);if(D.isDigit(y))l=!0;else if(this.getAlphanumericCode(y.charCodeAt(0))!==-1)h=!0;else return Tt.BYTE}return h?Tt.ALPHANUMERIC:l?Tt.NUMERIC:Tt.BYTE}static isOnlyDoubleByteKanji(r){let a;try{a=X.encode(r,U.SJIS)}catch{return!1}const l=a.length;if(l%2!==0)return!1;for(let h=0;h<l;h+=2){const d=a[h]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(r,a,l,h){let d=Number.MAX_SAFE_INTEGER,m=-1;for(let y=0;y<gs.NUM_MASK_PATTERNS;y++){p.buildMatrix(r,a,l,y,h);let _=this.calculateMaskPenalty(h);_<d&&(d=_,m=y)}return m}static chooseVersion(r,a){for(let l=1;l<=40;l++){const h=_t.getVersionForNumber(l);if(D.willFit(r,h,a))return h}throw new mn("Data too big")}static willFit(r,a,l){const h=a.getTotalCodewords(),m=a.getECBlocksForLevel(l).getTotalECCodewords(),y=h-m,_=(r+7)/8;return y>=_}static terminateBits(r,a){const l=r*8;if(a.getSize()>l)throw new mn("data bits cannot fit in the QR Code"+a.getSize()+" > "+l);for(let m=0;m<4&&a.getSize()<l;++m)a.appendBit(!1);const h=a.getSize()&7;if(h>0)for(let m=h;m<8;m++)a.appendBit(!1);const d=r-a.getSizeInBytes();for(let m=0;m<d;++m)a.appendBits((m&1)===0?236:17,8);if(a.getSize()!==l)throw new mn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,a,l,h,d,m){if(h>=l)throw new mn("Block ID too large");const y=r%l,_=l-y,v=Math.floor(r/l),N=v+1,k=Math.floor(a/l),B=k+1,q=v-k,Z=N-B;if(q!==Z)throw new mn("EC bytes mismatch");if(l!==_+y)throw new mn("RS blocks mismatch");if(r!==(k+q)*_+(B+Z)*y)throw new mn("Total bytes mismatch");h<_?(d[0]=k,m[0]=q):(d[0]=B,m[0]=Z)}static interleaveWithECBytes(r,a,l,h){if(r.getSizeInBytes()!==l)throw new mn("Number of bits and data bytes does not match");let d=0,m=0,y=0;const _=new Array;for(let N=0;N<h;++N){const k=new Int32Array(1),B=new Int32Array(1);D.getNumDataBytesAndNumECBytesForBlockID(a,l,h,N,k,B);const q=k[0],Z=new Uint8Array(q);r.toBytes(8*d,Z,0,q);const te=D.generateECBytes(Z,B[0]);_.push(new S(Z,te)),m=Math.max(m,q),y=Math.max(y,te.length),d+=k[0]}if(l!==d)throw new mn("Data bytes does not match offset");const v=new Ue;for(let N=0;N<m;++N)for(const k of _){const B=k.getDataBytes();N<B.length&&v.appendBits(B[N],8)}for(let N=0;N<y;++N)for(const k of _){const B=k.getErrorCorrectionBytes();N<B.length&&v.appendBits(B[N],8)}if(a!==v.getSizeInBytes())throw new mn("Interleaving error: "+a+" and "+v.getSizeInBytes()+" differ.");return v}static generateECBytes(r,a){const l=r.length,h=new Int32Array(l+a);for(let m=0;m<l;m++)h[m]=r[m]&255;new fs(Lt.QR_CODE_FIELD_256).encode(h,a);const d=new Uint8Array(a);for(let m=0;m<a;m++)d[m]=h[l+m];return d}static appendModeInfo(r,a){a.appendBits(r.getBits(),4)}static appendLengthInfo(r,a,l,h){const d=l.getCharacterCountBits(a);if(r>=1<<d)throw new mn(r+" is bigger than "+((1<<d)-1));h.appendBits(r,d)}static appendBytes(r,a,l,h){switch(a){case Tt.NUMERIC:D.appendNumericBytes(r,l);break;case Tt.ALPHANUMERIC:D.appendAlphanumericBytes(r,l);break;case Tt.BYTE:D.append8BitBytes(r,l,h);break;case Tt.KANJI:D.appendKanjiBytes(r,l);break;default:throw new mn("Invalid mode: "+a)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const a=D.getDigit(r);return a>=0&&a<=9}static appendNumericBytes(r,a){const l=r.length;let h=0;for(;h<l;){const d=D.getDigit(r.charAt(h));if(h+2<l){const m=D.getDigit(r.charAt(h+1)),y=D.getDigit(r.charAt(h+2));a.appendBits(d*100+m*10+y,10),h+=3}else if(h+1<l){const m=D.getDigit(r.charAt(h+1));a.appendBits(d*10+m,7),h+=2}else a.appendBits(d,4),h++}}static appendAlphanumericBytes(r,a){const l=r.length;let h=0;for(;h<l;){const d=D.getAlphanumericCode(r.charCodeAt(h));if(d===-1)throw new mn;if(h+1<l){const m=D.getAlphanumericCode(r.charCodeAt(h+1));if(m===-1)throw new mn;a.appendBits(d*45+m,11),h+=2}else a.appendBits(d,6),h++}}static append8BitBytes(r,a,l){let h;try{h=X.encode(r,l)}catch(d){throw new mn(d)}for(let d=0,m=h.length;d!==m;d++){const y=h[d];a.appendBits(y,8)}}static appendKanjiBytes(r,a){let l;try{l=X.encode(r,U.SJIS)}catch(d){throw new mn(d)}const h=l.length;for(let d=0;d<h;d+=2){const m=l[d]&255,y=l[d+1]&255,_=m<<8&4294967295|y;let v=-1;if(_>=33088&&_<=40956?v=_-33088:_>=57408&&_<=60351&&(v=_-49472),v===-1)throw new mn("Invalid byte sequence");const N=(v>>8)*192+(v&255);a.appendBits(N,13)}}static appendECI(r,a){a.appendBits(Tt.ECI.getBits(),4),a.appendBits(r.getValue(),8)}}D.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),D.DEFAULT_BYTE_MODE_ENCODING=U.UTF8.getName();class j{write(r,a,l,h=null){if(r.length===0)throw new R("Found empty contents");if(a<0||l<0)throw new R("Requested dimensions are too small: "+a+"x"+l);let d=an.L,m=j.QUIET_ZONE_SIZE;h!==null&&(h.get(gr.ERROR_CORRECTION)!==void 0&&(d=an.fromString(h.get(gr.ERROR_CORRECTION).toString())),h.get(gr.MARGIN)!==void 0&&(m=Number.parseInt(h.get(gr.MARGIN).toString(),10)));const y=D.encode(r,d,h);return this.renderResult(y,a,l,m)}writeToDom(r,a,l,h,d=null){typeof r=="string"&&(r=document.querySelector(r));const m=this.write(a,l,h,d);r&&r.appendChild(m)}renderResult(r,a,l,h){const d=r.getMatrix();if(d===null)throw new wn;const m=d.getWidth(),y=d.getHeight(),_=m+h*2,v=y+h*2,N=Math.max(a,_),k=Math.max(l,v),B=Math.min(Math.floor(N/_),Math.floor(k/v)),q=Math.floor((N-m*B)/2),Z=Math.floor((k-y*B)/2),te=this.createSVGElement(N,k);for(let de=0,_e=Z;de<y;de++,_e+=B)for(let Je=0,Ke=q;Je<m;Je++,Ke+=B)if(d.get(Je,de)===1){const Ge=this.createSvgRectElement(Ke,_e,B,B);te.appendChild(Ge)}return te}createSVGElement(r,a){const l=document.createElementNS(j.SVG_NS,"svg");return l.setAttributeNS(null,"height",r.toString()),l.setAttributeNS(null,"width",a.toString()),l}createSvgRectElement(r,a,l,h){const d=document.createElementNS(j.SVG_NS,"rect");return d.setAttributeNS(null,"x",r.toString()),d.setAttributeNS(null,"y",a.toString()),d.setAttributeNS(null,"height",l.toString()),d.setAttributeNS(null,"width",h.toString()),d.setAttributeNS(null,"fill","#000000"),d}}j.QUIET_ZONE_SIZE=4,j.SVG_NS="http://www.w3.org/2000/svg";class he{encode(r,a,l,h,d){if(r.length===0)throw new R("Found empty contents");if(a!==ve.QR_CODE)throw new R("Can only encode QR_CODE, but got "+a);if(l<0||h<0)throw new R(`Requested dimensions are too small: ${l}x${h}`);let m=an.L,y=he.QUIET_ZONE_SIZE;d!==null&&(d.get(gr.ERROR_CORRECTION)!==void 0&&(m=an.fromString(d.get(gr.ERROR_CORRECTION).toString())),d.get(gr.MARGIN)!==void 0&&(y=Number.parseInt(d.get(gr.MARGIN).toString(),10)));const _=D.encode(r,m,d);return he.renderResult(_,l,h,y)}static renderResult(r,a,l,h){const d=r.getMatrix();if(d===null)throw new wn;const m=d.getWidth(),y=d.getHeight(),_=m+h*2,v=y+h*2,N=Math.max(a,_),k=Math.max(l,v),B=Math.min(Math.floor(N/_),Math.floor(k/v)),q=Math.floor((N-m*B)/2),Z=Math.floor((k-y*B)/2),te=new at(N,k);for(let de=0,_e=Z;de<y;de++,_e+=B)for(let Je=0,Ke=q;Je<m;Je++,Ke+=B)d.get(Je,de)===1&&te.setRegion(Ke,_e,B,B);return te}}he.QUIET_ZONE_SIZE=4;class Ae{encode(r,a,l,h,d){let m;switch(a){case ve.QR_CODE:m=new he;break;default:throw new R("No encoder available for format "+a)}return m.encode(r,a,l,h,d)}}class et extends We{constructor(r,a,l,h,d,m,y,_){if(super(m,y),this.yuvData=r,this.dataWidth=a,this.dataHeight=l,this.left=h,this.top=d,h+m>a||d+y>l)throw new R("Crop rectangle does not fit within image data.");_&&this.reverseHorizontal(m,y)}getRow(r,a){if(r<0||r>=this.getHeight())throw new R("Requested row is outside the image: "+r);const l=this.getWidth();(a==null||a.length<l)&&(a=new Uint8ClampedArray(l));const h=(r+this.top)*this.dataWidth+this.left;return re.arraycopy(this.yuvData,h,a,0,l),a}getMatrix(){const r=this.getWidth(),a=this.getHeight();if(r===this.dataWidth&&a===this.dataHeight)return this.yuvData;const l=r*a,h=new Uint8ClampedArray(l);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return re.arraycopy(this.yuvData,d,h,0,l),h;for(let m=0;m<a;m++){const y=m*r;re.arraycopy(this.yuvData,d,h,y,r),d+=this.dataWidth}return h}isCropSupported(){return!0}crop(r,a,l,h){return new et(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+a,l,h,!1)}renderThumbnail(){const r=this.getWidth()/et.THUMBNAIL_SCALE_FACTOR,a=this.getHeight()/et.THUMBNAIL_SCALE_FACTOR,l=new Int32Array(r*a),h=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let m=0;m<a;m++){const y=m*r;for(let _=0;_<r;_++){const v=h[d+_*et.THUMBNAIL_SCALE_FACTOR]&255;l[y+_]=4278190080|v*65793}d+=this.dataWidth*et.THUMBNAIL_SCALE_FACTOR}return l}getThumbnailWidth(){return this.getWidth()/et.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/et.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,a){const l=this.yuvData;for(let h=0,d=this.top*this.dataWidth+this.left;h<a;h++,d+=this.dataWidth){const m=d+r/2;for(let y=d,_=d+r-1;y<m;y++,_--){const v=l[y];l[y]=l[_],l[_]=v}}}invert(){return new qe(this)}}et.THUMBNAIL_SCALE_FACTOR=2;class Yt extends We{constructor(r,a,l,h,d,m,y){if(super(a,l),this.dataWidth=h,this.dataHeight=d,this.left=m,this.top=y,r.BYTES_PER_ELEMENT===4){const _=a*l,v=new Uint8ClampedArray(_);for(let N=0;N<_;N++){const k=r[N],B=k>>16&255,q=k>>7&510,Z=k&255;v[N]=(B+q+Z)/4&255}this.luminances=v}else this.luminances=r;if(h===void 0&&(this.dataWidth=a),d===void 0&&(this.dataHeight=l),m===void 0&&(this.left=0),y===void 0&&(this.top=0),this.left+a>this.dataWidth||this.top+l>this.dataHeight)throw new R("Crop rectangle does not fit within image data.")}getRow(r,a){if(r<0||r>=this.getHeight())throw new R("Requested row is outside the image: "+r);const l=this.getWidth();(a==null||a.length<l)&&(a=new Uint8ClampedArray(l));const h=(r+this.top)*this.dataWidth+this.left;return re.arraycopy(this.luminances,h,a,0,l),a}getMatrix(){const r=this.getWidth(),a=this.getHeight();if(r===this.dataWidth&&a===this.dataHeight)return this.luminances;const l=r*a,h=new Uint8ClampedArray(l);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return re.arraycopy(this.luminances,d,h,0,l),h;for(let m=0;m<a;m++){const y=m*r;re.arraycopy(this.luminances,d,h,y,r),d+=this.dataWidth}return h}isCropSupported(){return!0}crop(r,a,l,h){return new Yt(this.luminances,l,h,this.dataWidth,this.dataHeight,this.left+r,this.top+a)}invert(){return new qe(this)}}class mr extends U{static forName(r){return this.getCharacterSetECIByName(r)}}class Nn{}Nn.ISO_8859_1=U.ISO8859_1;class nr{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class Ii{static singletonList(r){return[r]}static min(r,a){return r.sort(a)[0]}}class ms{constructor(r){this.previous=r}getPrevious(){return this.previous}}class ei extends ms{constructor(r,a,l){super(r),this.value=a,this.bitCount=l}appendTo(r,a){r.appendBits(this.value,this.bitCount)}add(r,a){return new ei(this,r,a)}addBinaryShift(r,a){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new ei(this,r,a)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+le.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class Ri extends ei{constructor(r,a,l){super(r,0,0),this.binaryShiftStart=a,this.binaryShiftByteCount=l}appendTo(r,a){for(let l=0;l<this.binaryShiftByteCount;l++)(l===0||l===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):l===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(a[this.binaryShiftStart+l],8)}addBinaryShift(r,a){return new Ri(this,r,a)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ha(M,r,a){return new Ri(M,r,a)}function ps(M,r,a){return new ei(M,r,a)}const Wa=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],js=0,vl=1,Ui=2,vc=3,es=4,Go=new ei(null,0,0),da=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Ef(M){for(let r of M)Oe.fill(r,-1);return M[js][es]=0,M[vl][es]=0,M[vl][js]=28,M[vc][es]=0,M[Ui][es]=0,M[Ui][js]=15,M}const qo=Ef(Oe.createInt32Array(6,6));class ts{constructor(r,a,l,h){this.token=r,this.mode=a,this.binaryShiftByteCount=l,this.bitCount=h}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,a){let l=this.bitCount,h=this.token;if(r!==this.mode){let m=da[this.mode][r];h=ps(h,m&65535,m>>16),l+=m>>16}let d=r===Ui?4:5;return h=ps(h,a,d),new ts(h,r,0,l+d)}shiftAndAppend(r,a){let l=this.token,h=this.mode===Ui?4:5;return l=ps(l,qo[this.mode][r],h),l=ps(l,a,5),new ts(l,this.mode,0,this.bitCount+h+5)}addBinaryShiftChar(r){let a=this.token,l=this.mode,h=this.bitCount;if(this.mode===es||this.mode===Ui){let y=da[l][js];a=ps(a,y&65535,y>>16),h+=y>>16,l=js}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,m=new ts(a,l,this.binaryShiftByteCount+1,h+d);return m.binaryShiftByteCount===2078&&(m=m.endBinaryShift(r+1)),m}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let a=this.token;return a=ha(a,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new ts(a,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let a=this.bitCount+(da[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?a+=ts.calculateBinaryShiftCost(r)-ts.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(a+=10),a<=r.bitCount}toBitArray(r){let a=[];for(let h=this.endBinaryShift(r.length).token;h!==null;h=h.getPrevious())a.unshift(h);let l=new Ue;for(const h of a)h.appendTo(l,r);return l}toString(){return Y.format("%s bits=%d bytes=%d",Wa[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}ts.INITIAL_STATE=new ts(Go,js,0,0);function Wu(M){const r=Y.getCharCode(" "),a=Y.getCharCode("."),l=Y.getCharCode(",");M[js][r]=1;const h=Y.getCharCode("Z"),d=Y.getCharCode("A");for(let B=d;B<=h;B++)M[js][B]=B-d+2;M[vl][r]=1;const m=Y.getCharCode("z"),y=Y.getCharCode("a");for(let B=y;B<=m;B++)M[vl][B]=B-y+2;M[Ui][r]=1;const _=Y.getCharCode("9"),v=Y.getCharCode("0");for(let B=v;B<=_;B++)M[Ui][B]=B-v+2;M[Ui][l]=12,M[Ui][a]=13;const N=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let B=0;B<N.length;B++)M[vc][Y.getCharCode(N[B])]=B;const k=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let B=0;B<k.length;B++)Y.getCharCode(k[B])>0&&(M[es][Y.getCharCode(k[B])]=B);return M}const Xo=Wu(Oe.createInt32Array(5,256));class fa{constructor(r){this.text=r}encode(){const r=Y.getCharCode(" "),a=Y.getCharCode(`
`);let l=Ii.singletonList(ts.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let m,y=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case Y.getCharCode("\r"):m=y===a?2:0;break;case Y.getCharCode("."):m=y===r?3:0;break;case Y.getCharCode(","):m=y===r?4:0;break;case Y.getCharCode(":"):m=y===r?5:0;break;default:m=0}m>0?(l=fa.updateStateListForPair(l,d,m),d++):l=this.updateStateListForChar(l,d)}return Ii.min(l,(d,m)=>d.getBitCount()-m.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,a){const l=[];for(let h of r)this.updateStateForChar(h,a,l);return fa.simplifyStates(l)}updateStateForChar(r,a,l){let h=this.text[a]&255,d=Xo[r.getMode()][h]>0,m=null;for(let y=0;y<=es;y++){let _=Xo[y][h];if(_>0){if(m==null&&(m=r.endBinaryShift(a)),!d||y===r.getMode()||y===Ui){const v=m.latchAndAppend(y,_);l.push(v)}if(!d&&qo[r.getMode()][y]>=0){const v=m.shiftAndAppend(y,_);l.push(v)}}}if(r.getBinaryShiftByteCount()>0||Xo[r.getMode()][h]===0){let y=r.addBinaryShiftChar(a);l.push(y)}}static updateStateListForPair(r,a,l){const h=[];for(let d of r)this.updateStateForPair(d,a,l,h);return this.simplifyStates(h)}static updateStateForPair(r,a,l,h){let d=r.endBinaryShift(a);if(h.push(d.latchAndAppend(es,l)),r.getMode()!==es&&h.push(d.shiftAndAppend(es,l)),l===3||l===4){let m=d.latchAndAppend(Ui,16-l).latchAndAppend(Ui,1);h.push(m)}if(r.getBinaryShiftByteCount()>0){let m=r.addBinaryShiftChar(a).addBinaryShiftChar(a+1);h.push(m)}}static simplifyStates(r){let a=[];for(const l of r){let h=!0;for(const d of a){if(d.isBetterThanOrEqualTo(l)){h=!1;break}l.isBetterThanOrEqualTo(d)&&(a=a.filter(m=>m!==d))}h&&a.push(l)}return a}}class An{constructor(){}static encodeBytes(r){return An.encode(r,An.DEFAULT_EC_PERCENT,An.DEFAULT_AZTEC_LAYERS)}static encode(r,a,l){let h=new fa(r).encode(),d=le.truncDivision(h.getSize()*a,100)+11,m=h.getSize()+d,y,_,v,N,k;if(l!==An.DEFAULT_AZTEC_LAYERS){if(y=l<0,_=Math.abs(l),_>(y?An.MAX_NB_BITS_COMPACT:An.MAX_NB_BITS))throw new R(Y.format("Illegal value %s for layers",l));v=An.totalBitsInLayer(_,y),N=An.WORD_SIZE[_];let Ge=v-v%N;if(k=An.stuffBits(h,N),k.getSize()+d>Ge)throw new R("Data to large for user specified layer");if(y&&k.getSize()>N*64)throw new R("Data to large for user specified layer")}else{N=0,k=null;for(let Ge=0;;Ge++){if(Ge>An.MAX_NB_BITS)throw new R("Data too large for an Aztec code");if(y=Ge<=3,_=y?Ge+1:Ge,v=An.totalBitsInLayer(_,y),m>v)continue;(k==null||N!==An.WORD_SIZE[_])&&(N=An.WORD_SIZE[_],k=An.stuffBits(h,N));let ln=v-v%N;if(!(y&&k.getSize()>N*64)&&k.getSize()+d<=ln)break}}let B=An.generateCheckWords(k,v,N),q=k.getSize()/N,Z=An.generateModeMessage(y,_,q),te=(y?11:14)+_*4,de=new Int32Array(te),_e;if(y){_e=te;for(let Ge=0;Ge<de.length;Ge++)de[Ge]=Ge}else{_e=te+1+2*le.truncDivision(le.truncDivision(te,2)-1,15);let Ge=le.truncDivision(te,2),ln=le.truncDivision(_e,2);for(let Kt=0;Kt<Ge;Kt++){let Sr=Kt+le.truncDivision(Kt,15);de[Ge-Kt-1]=ln-Sr-1,de[Ge+Kt]=ln+Sr+1}}let Je=new at(_e);for(let Ge=0,ln=0;Ge<_;Ge++){let Kt=(_-Ge)*4+(y?9:12);for(let Sr=0;Sr<Kt;Sr++){let Fi=Sr*2;for(let ii=0;ii<2;ii++)B.get(ln+Fi+ii)&&Je.set(de[Ge*2+ii],de[Ge*2+Sr]),B.get(ln+Kt*2+Fi+ii)&&Je.set(de[Ge*2+Sr],de[te-1-Ge*2-ii]),B.get(ln+Kt*4+Fi+ii)&&Je.set(de[te-1-Ge*2-ii],de[te-1-Ge*2-Sr]),B.get(ln+Kt*6+Fi+ii)&&Je.set(de[te-1-Ge*2-Sr],de[Ge*2+ii])}ln+=Kt*8}if(An.drawModeMessage(Je,y,_e,Z),y)An.drawBullsEye(Je,le.truncDivision(_e,2),5);else{An.drawBullsEye(Je,le.truncDivision(_e,2),7);for(let Ge=0,ln=0;Ge<le.truncDivision(te,2)-1;Ge+=15,ln+=16)for(let Kt=le.truncDivision(_e,2)&1;Kt<_e;Kt+=2)Je.set(le.truncDivision(_e,2)-ln,Kt),Je.set(le.truncDivision(_e,2)+ln,Kt),Je.set(Kt,le.truncDivision(_e,2)-ln),Je.set(Kt,le.truncDivision(_e,2)+ln)}let Ke=new nr;return Ke.setCompact(y),Ke.setSize(_e),Ke.setLayers(_),Ke.setCodeWords(q),Ke.setMatrix(Je),Ke}static drawBullsEye(r,a,l){for(let h=0;h<l;h+=2)for(let d=a-h;d<=a+h;d++)r.set(d,a-h),r.set(d,a+h),r.set(a-h,d),r.set(a+h,d);r.set(a-l,a-l),r.set(a-l+1,a-l),r.set(a-l,a-l+1),r.set(a+l,a-l),r.set(a+l,a-l+1),r.set(a+l,a+l-1)}static generateModeMessage(r,a,l){let h=new Ue;return r?(h.appendBits(a-1,2),h.appendBits(l-1,6),h=An.generateCheckWords(h,28,4)):(h.appendBits(a-1,5),h.appendBits(l-1,11),h=An.generateCheckWords(h,40,4)),h}static drawModeMessage(r,a,l,h){let d=le.truncDivision(l,2);if(a)for(let m=0;m<7;m++){let y=d-3+m;h.get(m)&&r.set(y,d-5),h.get(m+7)&&r.set(d+5,y),h.get(20-m)&&r.set(y,d+5),h.get(27-m)&&r.set(d-5,y)}else for(let m=0;m<10;m++){let y=d-5+m+le.truncDivision(m,5);h.get(m)&&r.set(y,d-7),h.get(m+10)&&r.set(d+7,y),h.get(29-m)&&r.set(y,d+7),h.get(39-m)&&r.set(d-7,y)}}static generateCheckWords(r,a,l){let h=r.getSize()/l,d=new fs(An.getGF(l)),m=le.truncDivision(a,l),y=An.bitsToWords(r,l,m);d.encode(y,m-h);let _=a%l,v=new Ue;v.appendBits(0,_);for(const N of Array.from(y))v.appendBits(N,l);return v}static bitsToWords(r,a,l){let h=new Int32Array(l),d,m;for(d=0,m=r.getSize()/a;d<m;d++){let y=0;for(let _=0;_<a;_++)y|=r.get(d*a+_)?1<<a-_-1:0;h[d]=y}return h}static getGF(r){switch(r){case 4:return Lt.AZTEC_PARAM;case 6:return Lt.AZTEC_DATA_6;case 8:return Lt.AZTEC_DATA_8;case 10:return Lt.AZTEC_DATA_10;case 12:return Lt.AZTEC_DATA_12;default:throw new R("Unsupported word size "+r)}}static stuffBits(r,a){let l=new Ue,h=r.getSize(),d=(1<<a)-2;for(let m=0;m<h;m+=a){let y=0;for(let _=0;_<a;_++)(m+_>=h||r.get(m+_))&&(y|=1<<a-1-_);(y&d)===d?(l.appendBits(y&d,a),m--):(y&d)===0?(l.appendBits(y|1,a),m--):l.appendBits(y,a)}return l}static totalBitsInLayer(r,a){return((a?88:112)+16*r)*r}}An.DEFAULT_EC_PERCENT=33,An.DEFAULT_AZTEC_LAYERS=0,An.MAX_NB_BITS=32,An.MAX_NB_BITS_COMPACT=4,An.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Yo{encode(r,a,l,h){return this.encodeWithHints(r,a,l,h,null)}encodeWithHints(r,a,l,h,d){let m=Nn.ISO_8859_1,y=An.DEFAULT_EC_PERCENT,_=An.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(gr.CHARACTER_SET)&&(m=mr.forName(d.get(gr.CHARACTER_SET).toString())),d.has(gr.ERROR_CORRECTION)&&(y=le.parseInt(d.get(gr.ERROR_CORRECTION).toString())),d.has(gr.AZTEC_LAYERS)&&(_=le.parseInt(d.get(gr.AZTEC_LAYERS).toString()))),Yo.encodeLayers(r,a,l,h,m,y,_)}static encodeLayers(r,a,l,h,d,m,y){if(a!==ve.AZTEC)throw new R("Can only encode AZTEC, but got "+a);let _=An.encode(Y.getBytes(r,d),m,y);return Yo.renderResult(_,l,h)}static renderResult(r,a,l){let h=r.getMatrix();if(h==null)throw new wn;let d=h.getWidth(),m=h.getHeight(),y=Math.max(a,d),_=Math.max(l,m),v=Math.min(y/d,_/m),N=(y-d*v)/2,k=(_-m*v)/2,B=new at(y,_);for(let q=0,Z=k;q<m;q++,Z+=v)for(let te=0,de=N;te<d;te++,de+=v)h.get(te,q)&&B.setRegion(de,Z,v,v);return B}}t.AbstractExpandedDecoder=gt,t.ArgumentException=C,t.ArithmeticException=En,t.AztecCode=nr,t.AztecCodeReader=Ti,t.AztecCodeWriter=Yo,t.AztecDecoder=Re,t.AztecDetector=Zr,t.AztecDetectorResult=vt,t.AztecEncoder=An,t.AztecHighLevelEncoder=fa,t.AztecPoint=or,t.BarcodeFormat=ve,t.Binarizer=ee,t.BinaryBitmap=P,t.BitArray=Ue,t.BitMatrix=at,t.BitSource=Rn,t.BrowserAztecCodeReader=ki,t.BrowserBarcodeReader=mt,t.BrowserCodeReader=pe,t.BrowserDatamatrixCodeReader=Cr,t.BrowserMultiFormatReader=ds,t.BrowserPDF417Reader=Al,t.BrowserQRCodeReader=bl,t.BrowserQRCodeSvgWriter=j,t.CharacterSetECI=U,t.ChecksumException=L,t.Code128Reader=ze,t.Code39Reader=zt,t.DataMatrixDecodedBitStreamParser=kn,t.DataMatrixReader=er,t.DecodeHintType=Ze,t.DecoderResult=kt,t.DefaultGridSampler=yr,t.DetectorResult=Pt,t.EAN13Reader=Qt,t.EncodeHintType=gr,t.Exception=w,t.FormatException=F,t.GenericGF=Lt,t.GenericGFPoly=en,t.GlobalHistogramBinarizer=ue,t.GridSampler=Fn,t.GridSamplerInstance=xr,t.HTMLCanvasElementLuminanceSource=ot,t.HybridBinarizer=Ee,t.ITFReader=wt,t.IllegalArgumentException=R,t.IllegalStateException=wn,t.InvertedLuminanceSource=qe,t.LuminanceSource=We,t.MathUtils=Fe,t.MultiFormatOneDReader=$e,t.MultiFormatReader=Ho,t.MultiFormatWriter=Ae,t.NotFoundException=ce,t.OneDReader=tn,t.PDF417DecodedBitStreamParser=we,t.PDF417DecoderErrorCorrection=Qi,t.PDF417Reader=fr,t.PDF417ResultMetadata=Ss,t.PerspectiveTransform=Xt,t.PlanarYUVLuminanceSource=et,t.QRCodeByteMatrix=ua,t.QRCodeDataMask=Lr,t.QRCodeDecodedBitStreamParser=zn,t.QRCodeDecoderErrorCorrectionLevel=an,t.QRCodeDecoderFormatInformation=Er,t.QRCodeEncoder=D,t.QRCodeEncoderQRCode=gs,t.QRCodeMaskUtil=gn,t.QRCodeMatrixUtil=p,t.QRCodeMode=Tt,t.QRCodeReader=xi,t.QRCodeVersion=_t,t.QRCodeWriter=he,t.RGBLuminanceSource=Yt,t.RSS14Reader=Se,t.RSSExpandedReader=Ve,t.ReaderException=ca,t.ReedSolomonDecoder=De,t.ReedSolomonEncoder=fs,t.ReedSolomonException=hn,t.Result=Te,t.ResultMetadataType=xt,t.ResultPoint=be,t.StringUtils=Y,t.UnsupportedOperationException=J,t.VideoInputDevice=Q,t.WhiteRectangleDetector=Rt,t.WriterException=mn,t.ZXingArrays=Oe,t.ZXingCharset=mr,t.ZXingInteger=le,t.ZXingStandardCharsets=Nn,t.ZXingStringBuilder=G,t.ZXingStringEncoding=X,t.ZXingSystem=re,t.createAbstractExpandedDecoder=Jr,Object.defineProperty(t,"__esModule",{value:!0})}))})(mu,mu.exports)),mu.exports}var hr=L8();const P8=Xd(hr),B8=Ob({__proto__:null,default:P8},[hr]);var oE=(function(){function s(e,t,o){if(this.formatMap=new Map([[Et.QR_CODE,hr.BarcodeFormat.QR_CODE],[Et.AZTEC,hr.BarcodeFormat.AZTEC],[Et.CODABAR,hr.BarcodeFormat.CODABAR],[Et.CODE_39,hr.BarcodeFormat.CODE_39],[Et.CODE_93,hr.BarcodeFormat.CODE_93],[Et.CODE_128,hr.BarcodeFormat.CODE_128],[Et.DATA_MATRIX,hr.BarcodeFormat.DATA_MATRIX],[Et.MAXICODE,hr.BarcodeFormat.MAXICODE],[Et.ITF,hr.BarcodeFormat.ITF],[Et.EAN_13,hr.BarcodeFormat.EAN_13],[Et.EAN_8,hr.BarcodeFormat.EAN_8],[Et.PDF_417,hr.BarcodeFormat.PDF_417],[Et.RSS_14,hr.BarcodeFormat.RSS_14],[Et.RSS_EXPANDED,hr.BarcodeFormat.RSS_EXPANDED],[Et.UPC_A,hr.BarcodeFormat.UPC_A],[Et.UPC_E,hr.BarcodeFormat.UPC_E],[Et.UPC_EAN_EXTENSION,hr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!B8)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=o;var u=this.createZXingFormats(e),g=new Map;g.set(hr.DecodeHintType.POSSIBLE_FORMATS,u),g.set(hr.DecodeHintType.TRY_HARDER,!1),this.hints=g}return s.prototype.decodeAsync=function(e){var t=this;return new Promise(function(o,u){try{o(t.decode(e))}catch(g){u(g)}})},s.prototype.decode=function(e){var t=new hr.MultiFormatReader(this.verbose,this.hints),o=new hr.HTMLCanvasElementLuminanceSource(e),u=new hr.BinaryBitmap(new hr.HybridBinarizer(o)),g=t.decode(u);return{text:g.text,format:Q_.create(this.toHtml5QrcodeSupportedFormats(g.format)),debugData:this.createDebugData()}},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,o,u){e.set(t,o)}),e},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createZXingFormats=function(e){for(var t=[],o=0,u=e;o<u.length;o++){var g=u[o];this.formatMap.has(g)?t.push(this.formatMap.get(g)):this.logger.logError("".concat(g," is not supported by")+"ZXingHtml5QrcodeShim")}return t},s.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},s})(),V8=function(s,e,t,o){function u(g){return g instanceof t?g:new t(function(x){x(g)})}return new(t||(t=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(R){x(R)}}function b(C){try{w(o.throw(C))}catch(R){x(R)}}function w(C){C.done?g(C.value):u(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},U8=function(s,e){var t={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,u,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(t=0)),t;)try{if(o=1,u&&(g=w[0]&2?u.return:w[0]?u.throw||((g=u.return)&&g.call(u),0):u.next)&&!(g=g.call(u,w[1])).done)return g;switch(u=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return t.label++,{value:w[1],done:!1};case 5:t.label++,u=w[1],w=[0];continue;case 7:w=t.ops.pop(),t.trys.pop();continue;default:if(g=t.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){t=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){t.label=w[1];break}if(w[0]===6&&t.label<g[1]){t.label=g[1],g=w;break}if(g&&t.label<g[2]){t.label=g[2],t.ops.push(w);break}g[2]&&t.ops.pop(),t.trys.pop();continue}w=e.call(s,t)}catch(C){w=[6,C],u=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},lE=(function(){function s(e,t,o){if(this.formatMap=new Map([[Et.QR_CODE,"qr_code"],[Et.AZTEC,"aztec"],[Et.CODABAR,"codabar"],[Et.CODE_39,"code_39"],[Et.CODE_93,"code_93"],[Et.CODE_128,"code_128"],[Et.DATA_MATRIX,"data_matrix"],[Et.ITF,"itf"],[Et.EAN_13,"ean_13"],[Et.EAN_8,"ean_8"],[Et.PDF_417,"pdf417"],[Et.UPC_A,"upc_a"],[Et.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!s.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=o;var u=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(u),!this.detector)throw"BarcodeDetector detector not supported"}return s.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},s.prototype.decodeAsync=function(e){return V8(this,void 0,void 0,function(){var t,o;return U8(this,function(u){switch(u.label){case 0:return[4,this.detector.detect(e)];case 1:if(t=u.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return o=this.selectLargestBarcode(t),[2,{text:o.rawValue,format:Q_.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}]}})})},s.prototype.selectLargestBarcode=function(e){for(var t=null,o=0,u=0,g=e;u<g.length;u++){var x=g[u],T=x.boundingBox.width*x.boundingBox.height;T>o&&(o=T,t=x)}if(!t)throw"No largest barcode found";return t},s.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],o=0,u=e;o<u.length;o++){var g=u[o];this.formatMap.has(g)?t.push(this.formatMap.get(g)):this.logger.warn("".concat(g," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,o,u){e.set(t,o)}),e},s.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},s})(),cE=function(s,e,t,o){function u(g){return g instanceof t?g:new t(function(x){x(g)})}return new(t||(t=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(R){x(R)}}function b(C){try{w(o.throw(C))}catch(R){x(R)}}function w(C){C.done?g(C.value):u(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},uE=function(s,e){var t={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,u,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(t=0)),t;)try{if(o=1,u&&(g=w[0]&2?u.return:w[0]?u.throw||((g=u.return)&&g.call(u),0):u.next)&&!(g=g.call(u,w[1])).done)return g;switch(u=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return t.label++,{value:w[1],done:!1};case 5:t.label++,u=w[1],w=[0];continue;case 7:w=t.ops.pop(),t.trys.pop();continue;default:if(g=t.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){t=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){t.label=w[1];break}if(w[0]===6&&t.label<g[1]){t.label=g[1],g=w;break}if(g&&t.label<g[2]){t.label=g[2],t.ops.push(w);break}g[2]&&t.ops.pop(),t.trys.pop();continue}w=e.call(s,t)}catch(C){w=[6,C],u=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},F8=(function(){function s(e,t,o,u){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=o,t&&lE.isSupported()?(this.primaryDecoder=new lE(e,o,u),this.secondaryDecoder=new oE(e,o,u)):this.primaryDecoder=new oE(e,o,u)}return s.prototype.decodeAsync=function(e){return cE(this,void 0,void 0,function(){var t;return uE(this,function(o){switch(o.label){case 0:t=performance.now(),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,o.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},s.prototype.decodeRobustlyAsync=function(e){return cE(this,void 0,void 0,function(){var t,o;return uE(this,function(u){switch(u.label){case 0:t=performance.now(),u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,u.sent()];case 3:if(o=u.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw o;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},s.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},s.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},s.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,o=this.executionResults;t<o.length;t++){var u=o[t];e+=u}var g=e/this.executionResults.length;console.log("".concat(g," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},s})(),sm=(function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&(o[g]=u[g])},s(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");s(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}})(),jd=function(s,e,t,o){function u(g){return g instanceof t?g:new t(function(x){x(g)})}return new(t||(t=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(R){x(R)}}function b(C){try{w(o.throw(C))}catch(R){x(R)}}function w(C){C.done?g(C.value):u(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},zd=function(s,e){var t={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,u,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(t=0)),t;)try{if(o=1,u&&(g=w[0]&2?u.return:w[0]?u.throw||((g=u.return)&&g.call(u),0):u.next)&&!(g=g.call(u,w[1])).done)return g;switch(u=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return t.label++,{value:w[1],done:!1};case 5:t.label++,u=w[1],w=[0];continue;case 7:w=t.ops.pop(),t.trys.pop();continue;default:if(g=t.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){t=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){t.label=w[1];break}if(w[0]===6&&t.label<g[1]){t.label=g[1],g=w;break}if(g&&t.label<g[2]){t.label=g[2],t.ops.push(w);break}g[2]&&t.ops.pop(),t.trys.pop();continue}w=e.call(s,t)}catch(C){w=[6,C],u=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},J_=(function(){function s(e,t){this.name=e,this.track=t}return s.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},s.prototype.apply=function(e){var t={};t[this.name]=e;var o={advanced:[t]};return this.track.applyConstraints(o)},s.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var t=e[this.name];return t}return null},s})(),j8=(function(s){sm(e,s);function e(t,o){return s.call(this,t,o)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(t){var o={};o[this.name]=t;var u={advanced:[o]};return this.track.applyConstraints(u)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),o=t[this.name];return{min:o.min,max:o.max,step:o.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e})(J_),z8=(function(s){sm(e,s);function e(t){return s.call(this,"zoom",t)||this}return e})(j8),H8=(function(s){sm(e,s);function e(t){return s.call(this,"torch",t)||this}return e})(J_),G8=(function(){function s(e){this.track=e}return s.prototype.zoomFeature=function(){return new z8(this.track)},s.prototype.torchFeature=function(){return new H8(this.track)},s})(),q8=(function(){function s(e,t,o){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=o,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return s.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},s.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var o=e.surface.clientWidth,u=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(o,u),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},s.create=function(e,t,o,u){return jd(this,void 0,void 0,function(){var g,x;return zd(this,function(T){switch(T.label){case 0:return g=new s(e,t,u),o.aspectRatio?(x={aspectRatio:o.aspectRatio},[4,g.getFirstTrackOrFail().applyConstraints(x)]):[3,2];case 1:T.sent(),T.label=2;case 2:return g.setupSurface(),[2,g]}})})},s.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},s.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},s.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},s.prototype.resume=function(e){this.failIfClosed();var t=this,o=function(){setTimeout(e,200),t.surface.removeEventListener("playing",o)};this.surface.addEventListener("playing",o),this.surface.play()},s.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},s.prototype.getSurface=function(){return this.failIfClosed(),this.surface},s.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},s.prototype.applyVideoConstraints=function(e){return jd(this,void 0,void 0,function(){return zd(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},s.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,o){var u=e.mediaStream.getVideoTracks(),g=u.length,x=0;e.mediaStream.getVideoTracks().forEach(function(T){e.mediaStream.removeTrack(T),T.stop(),++x,x>=g&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},s.prototype.getCapabilities=function(){return new G8(this.getFirstTrackOrFail())},s})(),X8=(function(){function s(e){this.mediaStream=e}return s.prototype.render=function(e,t,o){return jd(this,void 0,void 0,function(){return zd(this,function(u){return[2,q8.create(e,this.mediaStream,t,o)]})})},s.create=function(e){return jd(this,void 0,void 0,function(){var t,o;return zd(this,function(u){switch(u.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return o=u.sent(),[2,new s(o)]}})})},s})(),hE=function(s,e,t,o){function u(g){return g instanceof t?g:new t(function(x){x(g)})}return new(t||(t=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(R){x(R)}}function b(C){try{w(o.throw(C))}catch(R){x(R)}}function w(C){C.done?g(C.value):u(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},dE=function(s,e){var t={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,u,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(t=0)),t;)try{if(o=1,u&&(g=w[0]&2?u.return:w[0]?u.throw||((g=u.return)&&g.call(u),0):u.next)&&!(g=g.call(u,w[1])).done)return g;switch(u=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return t.label++,{value:w[1],done:!1};case 5:t.label++,u=w[1],w=[0];continue;case 7:w=t.ops.pop(),t.trys.pop();continue;default:if(g=t.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){t=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){t.label=w[1];break}if(w[0]===6&&t.label<g[1]){t.label=g[1],g=w;break}if(g&&t.label<g[2]){t.label=g[2],t.ops.push(w);break}g[2]&&t.ops.pop(),t.trys.pop();continue}w=e.call(s,t)}catch(C){w=[6,C],u=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Y8=(function(){function s(){}return s.failIfNotSupported=function(){return hE(this,void 0,void 0,function(){return dE(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new s]})})},s.prototype.create=function(e){return hE(this,void 0,void 0,function(){return dE(this,function(t){return[2,X8.create(e)]})})},s})(),K8=function(s,e,t,o){function u(g){return g instanceof t?g:new t(function(x){x(g)})}return new(t||(t=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(R){x(R)}}function b(C){try{w(o.throw(C))}catch(R){x(R)}}function w(C){C.done?g(C.value):u(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},W8=function(s,e){var t={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,u,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(t=0)),t;)try{if(o=1,u&&(g=w[0]&2?u.return:w[0]?u.throw||((g=u.return)&&g.call(u),0):u.next)&&!(g=g.call(u,w[1])).done)return g;switch(u=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return t.label++,{value:w[1],done:!1};case 5:t.label++,u=w[1],w=[0];continue;case 7:w=t.ops.pop(),t.trys.pop();continue;default:if(g=t.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){t=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){t.label=w[1];break}if(w[0]===6&&t.label<g[1]){t.label=g[1],g=w;break}if(g&&t.label<g[2]){t.label=g[2],t.ops.push(w);break}g[2]&&t.ops.pop(),t.trys.pop();continue}w=e.call(s,t)}catch(C){w=[6,C],u=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Q8=(function(){function s(){}return s.retrieve=function(){if(navigator.mediaDevices)return s.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?s.getCamerasFromMediaStreamTrack():s.rejectWithError()},s.rejectWithError=function(){var e=nc.unableToQuerySupportedDevices();return s.isHttpsOrLocalhost()||(e=nc.insecureContextCameraQueryError()),Promise.reject(e)},s.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},s.getCamerasFromMediaDevices=function(){return K8(this,void 0,void 0,function(){var e,t,o,u,g,x,T;return W8(this,function(b){switch(b.label){case 0:return e=function(w){for(var C=w.getVideoTracks(),R=0,P=C;R<P.length;R++){var L=P[R];L.enabled=!1,L.stop(),w.removeTrack(L)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=b.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(o=b.sent(),u=[],g=0,x=o;g<x.length;g++)T=x[g],T.kind==="videoinput"&&u.push({id:T.deviceId,label:T.label});return e(t),[2,u]}})})},s.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){var o=function(g){for(var x=[],T=0,b=g;T<b.length;T++){var w=b[T];w.kind==="video"&&x.push({id:w.id,label:w.label})}e(x)},u=MediaStreamTrack;u.getSources(o)})},s})(),Or;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.NOT_STARTED=1]="NOT_STARTED",s[s.SCANNING=2]="SCANNING",s[s.PAUSED=3]="PAUSED"})(Or||(Or={}));var Z8=(function(){function s(){this.state=Or.NOT_STARTED,this.onGoingTransactionNewState=Or.UNKNOWN}return s.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},s.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},s.prototype.execute=function(){if(this.onGoingTransactionNewState===Or.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Or.UNKNOWN,this.directTransition(e)},s.prototype.cancel=function(){if(this.onGoingTransactionNewState===Or.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Or.UNKNOWN},s.prototype.getState=function(){return this.state},s.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Or.UNKNOWN)throw"Cannot transition to a new state, already under transition"},s.prototype.validateTransition=function(e){switch(this.state){case Or.UNKNOWN:throw"Transition from unknown is not allowed";case Or.NOT_STARTED:this.failIfNewStateIs(e,[Or.PAUSED]);break;case Or.SCANNING:break;case Or.PAUSED:break}},s.prototype.failIfNewStateIs=function(e,t){for(var o=0,u=t;o<u.length;o++){var g=u[o];if(e===g)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},s})(),J8=(function(){function s(e){this.stateManager=e}return s.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},s.prototype.directTransition=function(e){this.stateManager.directTransition(e)},s.prototype.getState=function(){return this.stateManager.getState()},s.prototype.canScanFile=function(){return this.stateManager.getState()===Or.NOT_STARTED},s.prototype.isScanning=function(){return this.stateManager.getState()!==Or.NOT_STARTED},s.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Or.SCANNING},s.prototype.isPaused=function(){return this.stateManager.getState()===Or.PAUSED},s})(),$8=(function(){function s(){}return s.create=function(){return new J8(new Z8)},s})(),eR=(function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&(o[g]=u[g])},s(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");s(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}})(),ls=(function(s){eR(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e})(O8),tR=(function(){function s(e,t){this.logger=t,this.fps=ls.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=ls.DEFAULT_DISABLE_FLIP}return s.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Z_.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},s.prototype.isShadedBoxEnabled=function(){return!Na(this.qrbox)},s.create=function(e,t){return new s(e,t)},s})(),nR=(function(){function s(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var o;typeof t=="boolean"?this.verbose=t===!0:t&&(o=t,this.verbose=o.verbose===!0,o.experimentalFeatures),this.logger=new M8(this.verbose),this.qrcode=new F8(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(o),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=$8.create()}return s.prototype.start=function(e,t,o,u){var g=this;if(!e)throw"cameraIdOrConfig is required";if(!o||typeof o!="function")throw"qrCodeSuccessCallback is required and should be a function.";var x;u?x=u:x=this.verbose?this.logger.log:function(){};var T=tR.create(t,this.logger);this.clearElement();var b=!1;T.videoConstraints&&(T.isMediaStreamConstraintsValid()?b=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var w=b,C=document.getElementById(this.elementId);C.clientWidth?C.clientWidth:ls.DEFAULT_WIDTH,C.style.position="relative",this.shouldScan=!0,this.element=C;var R=this,P=this.stateManagerProxy.startTransition(Or.SCANNING);return new Promise(function(L,ee){var re=w?T.videoConstraints:R.createVideoConstraints(e);if(!re){P.cancel(),ee("videoConstraints should be defined");return}var se={};(!w||T.aspectRatio)&&(se.aspectRatio=T.aspectRatio);var Ye={onRenderSurfaceReady:function(Oe,le){R.setupUi(Oe,le,T),R.isScanning=!0,R.foreverScan(T,o,x)}};Y8.failIfNotSupported().then(function(Oe){Oe.create(re).then(function(le){return le.render(g.element,se,Ye).then(function(Ue){R.renderedCamera=Ue,P.execute(),L(null)}).catch(function(Ue){P.cancel(),ee(Ue)})}).catch(function(le){P.cancel(),ee(nc.errorGettingUserMedia(le))})}).catch(function(Oe){P.cancel(),ee(nc.cameraStreamingNotSupported())})})},s.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Or.PAUSED),this.showPausedState(),(Na(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},s.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(Or.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},s.prototype.getState=function(){return this.stateManagerProxy.getState()},s.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(Or.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var o=function(){if(e.element){var g=document.getElementById(ls.SHADED_REGION_ELEMENT_ID);g&&e.element.removeChild(g)}},u=this;return this.renderedCamera.close().then(function(){return u.renderedCamera=null,u.element&&(u.element.removeChild(u.canvasElement),u.canvasElement=null),o(),u.qrRegion&&(u.qrRegion=null),u.context&&(u.context=null),t.execute(),u.hidePausedState(),u.isScanning=!1,Promise.resolve()})},s.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(o){return o.decodedText})},s.prototype.scanFileV2=function(e,t){var o=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Na(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(u,g){o.possiblyCloseLastScanImageFile(),o.clearElement(),o.lastScanImageFile=URL.createObjectURL(e);var x=new Image;x.onload=function(){var T=x.width,b=x.height,w=document.getElementById(o.elementId),C=w.clientWidth?w.clientWidth:ls.DEFAULT_WIDTH,R=Math.max(w.clientHeight?w.clientHeight:b,ls.FILE_SCAN_MIN_HEIGHT),P=o.computeCanvasDrawConfig(T,b,C,R);if(t){var L=o.createCanvasElement(C,R,"qr-canvas-visible");L.style.display="inline-block",w.appendChild(L);var ee=L.getContext("2d");if(!ee)throw"Unable to get 2d context from canvas";ee.canvas.width=C,ee.canvas.height=R,ee.drawImage(x,0,0,T,b,P.x,P.y,P.width,P.height)}var re=ls.FILE_SCAN_HIDDEN_CANVAS_PADDING,se=Math.max(x.width,P.width),Ye=Math.max(x.height,P.height),Oe=se+2*re,le=Ye+2*re,Ue=o.createCanvasElement(Oe,le);w.appendChild(Ue);var dt=Ue.getContext("2d");if(!dt)throw"Unable to get 2d context from canvas";dt.canvas.width=Oe,dt.canvas.height=le,dt.drawImage(x,0,0,T,b,re,re,se,Ye);try{o.qrcode.decodeRobustlyAsync(Ue).then(function(Ze){u(sE.createFromQrcodeResult(Ze))}).catch(g)}catch(Ze){g("QR code parse error, error = ".concat(Ze))}},x.onerror=g,x.onabort=g,x.onstalled=g,x.onsuspend=g,x.src=URL.createObjectURL(e)})},s.prototype.clear=function(){this.clearElement()},s.getCameras=function(){return Q8.retrieve()},s.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},s.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},s.prototype.applyVideoConstraints=function(e){if(e){if(!Z_.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},s.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},s.prototype.getSupportedFormats=function(e){var t=[Et.QR_CODE,Et.AZTEC,Et.CODABAR,Et.CODE_39,Et.CODE_93,Et.CODE_128,Et.DATA_MATRIX,Et.MAXICODE,Et.ITF,Et.EAN_13,Et.EAN_8,Et.PDF_417,Et.RSS_14,Et.RSS_EXPANDED,Et.UPC_A,Et.UPC_E,Et.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var o=[],u=0,g=e.formatsToSupport;u<g.length;u++){var x=g[u];N8(x)?o.push(x):this.logger.warn("Invalid format: ".concat(x," passed in config, ignoring."))}if(o.length===0)throw"None of formatsToSupport match supported values.";return o},s.prototype.getUseBarCodeDetectorIfSupported=function(e){if(Na(e))return!0;if(!Na(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(Na(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return Na(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},s.prototype.validateQrboxSize=function(e,t,o){var u=this,g=o.qrbox;this.validateQrboxConfig(g);var x=this.toQrdimensions(e,t,g),T=function(w){if(w<ls.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(ls.MIN_QR_BOX_SIZE,"px.")},b=function(w){return w>e&&(u.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),w=e),w};T(x.width),T(x.height),x.width=b(x.width)},s.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},s.prototype.toQrdimensions=function(e,t,o){if(typeof o=="number")return{width:o,height:o};if(typeof o=="function")try{return o(e,t)}catch(u){throw new Error("qrbox config was passed as a function but it failed with unknown error"+u)}return o},s.prototype.setupUi=function(e,t,o){o.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,o);var u=Na(o.qrbox)?{width:e,height:t}:o.qrbox;this.validateQrboxConfig(u);var g=this.toQrdimensions(e,t,u);g.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var x=o.isShadedBoxEnabled()&&g.height<=t,T={x:0,y:0,width:e,height:t},b=x?this.getShadedRegionBounds(e,t,g):T,w=this.createCanvasElement(b.width,b.height),C={willReadFrequently:!0},R=w.getContext("2d",C);R.canvas.width=b.width,R.canvas.height=b.height,this.element.append(w),x&&this.possiblyInsertShadingElement(this.element,e,t,g),this.createScannerPausedUiElement(this.element),this.qrRegion=b,this.context=R,this.canvasElement=w},s.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=nc.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},s.prototype.scanContext=function(e,t){var o=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(u){return e(u.text,sE.createFromQrcodeResult(u)),o.possiblyUpdateShaders(!0),!0}).catch(function(u){o.possiblyUpdateShaders(!1);var g=nc.codeParseError(u);return t(g,D8.createFrom(g)),!1})},s.prototype.foreverScan=function(e,t,o){var u=this;if(this.shouldScan&&this.renderedCamera){var g=this.renderedCamera.getSurface(),x=g.videoWidth/g.clientWidth,T=g.videoHeight/g.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var b=this.qrRegion.width*x,w=this.qrRegion.height*T,C=this.qrRegion.x*x,R=this.qrRegion.y*T;this.context.drawImage(g,C,R,b,w,0,0,this.qrRegion.width,this.qrRegion.height);var P=function(){u.foreverScanTimeout=setTimeout(function(){u.foreverScan(e,t,o)},u.getTimeoutFps(e.fps))};this.scanContext(t,o).then(function(L){!L&&e.disableFlip!==!0?(u.context.translate(u.context.canvas.width,0),u.context.scale(-1,1),u.scanContext(t,o).finally(function(){P()})):P()}).catch(function(L){u.logger.logError("Error happend while scanning context",L),P()})}},s.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var t="facingMode",o="deviceId",u={user:!0,environment:!0},g="exact",x=function(ee){if(ee in u)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(ee,"'")},T=Object.keys(e);if(T.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(T.length," keys");var b=Object.keys(e)[0];if(b!==t&&b!==o)throw"Only '".concat(t,"' and '").concat(o,"' ")+" are supported for 'cameraIdOrConfig'";if(b===t){var w=e.facingMode;if(typeof w=="string"){if(x(w))return{facingMode:w}}else if(typeof w=="object")if(g in w){if(x(w["".concat(g)]))return{facingMode:{exact:w["".concat(g)]}}}else throw"'facingMode' should be string or object with"+" ".concat(g," as key.");else{var C=typeof w;throw"Invalid type of 'facingMode' = ".concat(C)}}else{var R=e.deviceId;if(typeof R=="string")return{deviceId:R};if(typeof R=="object"){if(g in R)return{deviceId:{exact:R["".concat(g)]}};throw"'deviceId' should be string or object with"+" ".concat(g," as key.")}else{var P=typeof R;throw"Invalid type of 'deviceId' = ".concat(P)}}}var L=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(L)},s.prototype.computeCanvasDrawConfig=function(e,t,o,u){if(e<=o&&t<=u){var g=(o-e)/2,x=(u-t)/2;return{x:g,y:x,width:e,height:t}}else{var T=e,b=t;return e>o&&(t=o/e*t,e=o),t>u&&(e=u/t*e,t=u),this.logger.log("Image downsampled from "+"".concat(T,"X").concat(b)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,o,u)}},s.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},s.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?ls.BORDER_SHADER_MATCH_COLOR:ls.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},s.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},s.prototype.createCanvasElement=function(e,t,o){var u=e,g=t,x=document.createElement("canvas");return x.style.width="".concat(u,"px"),x.style.height="".concat(g,"px"),x.style.display="none",x.id=Na(o)?"qr-canvas":o,x},s.prototype.getShadedRegionBounds=function(e,t,o){if(o.width>e||o.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-o.width)/2,y:(t-o.height)/2,width:o.width,height:o.height}},s.prototype.possiblyInsertShadingElement=function(e,t,o,u){if(!(t-u.width<1||o-u.height<1)){var g=document.createElement("div");g.style.position="absolute";var x=(t-u.width)/2,T=(o-u.height)/2;if(g.style.borderLeft="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderRight="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderTop="".concat(T,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderBottom="".concat(T,"px solid rgba(0, 0, 0, 0.48)"),g.style.boxSizing="border-box",g.style.top="0px",g.style.bottom="0px",g.style.left="0px",g.style.right="0px",g.id="".concat(ls.SHADED_REGION_ELEMENT_ID),t-u.width<11||o-u.height<11)this.hasBorderShaders=!1;else{var b=5,w=40;this.insertShaderBorders(g,w,b,-b,null,0,!0),this.insertShaderBorders(g,w,b,-b,null,0,!1),this.insertShaderBorders(g,w,b,null,-b,0,!0),this.insertShaderBorders(g,w,b,null,-b,0,!1),this.insertShaderBorders(g,b,w+b,-b,null,-b,!0),this.insertShaderBorders(g,b,w+b,null,-b,-b,!0),this.insertShaderBorders(g,b,w+b,-b,null,-b,!1),this.insertShaderBorders(g,b,w+b,null,-b,-b,!1),this.hasBorderShaders=!0}e.append(g)}},s.prototype.insertShaderBorders=function(e,t,o,u,g,x,T){var b=document.createElement("div");b.style.position="absolute",b.style.backgroundColor=ls.BORDER_SHADER_DEFAULT_COLOR,b.style.width="".concat(t,"px"),b.style.height="".concat(o,"px"),u!==null&&(b.style.top="".concat(u,"px")),g!==null&&(b.style.bottom="".concat(g,"px")),T?b.style.left="".concat(x,"px"):b.style.right="".concat(x,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(b),e.appendChild(b)},s.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},s.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},s.prototype.getTimeoutFps=function(e){return 1e3/e},s})(),fE;(function(s){s[s.STATUS_DEFAULT=0]="STATUS_DEFAULT",s[s.STATUS_SUCCESS=1]="STATUS_SUCCESS",s[s.STATUS_WARNING=2]="STATUS_WARNING",s[s.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(fE||(fE={}));const rR=({onCode:s})=>(oe.useEffect(()=>{const e="qr-reader",t=new nR(e);return t.start({facingMode:"environment"},{fps:10,qrbox:250},o=>{s(o)},()=>{}).catch(o=>{console.error("Kunne ikke starte QR-leser:",o)}),()=>{t.stop().then(()=>t.clear()).catch(()=>{})}},[s]),I.jsx("div",{id:"qr-reader",style:{width:"100%"}}));async function iR(){const e=(await dr(Kn(pt,"terms"))).docs.map(t=>{const o=t.data(),u=typeof o?.value=="number"?o.value:void 0;if(typeof u!="number")return null;const g=typeof o?.label=="string"?o.label:"",x=typeof o?.order=="number"?o.order:void 0;return{value:u,label:g,order:x}}).filter(Boolean);return e.sort((t,o)=>(t.order??t.value)-(o.order??o.value)),e}function am(){const[s,e]=oe.useState([]),[t,o]=oe.useState(!0),[u,g]=oe.useState(null);oe.useEffect(()=>{let T=!0;return(async()=>{try{o(!0);const b=await iR();T&&e(b)}catch(b){T&&g(b)}finally{T&&o(!1)}})(),()=>{T=!1}},[]);const x=oe.useMemo(()=>{const T=new Map;for(const b of s)T.set(b.value,b);return T},[s]);return{options:s,byValue:x,loading:t,error:u}}function La(s,e){if(e==null)return"Ukjent termin";let t;return Array.isArray(s)?t=s.find(o=>o.value===e):s instanceof Map&&(t=s.get(e)),t&&t.label?t.label:`Termin ${e}`}function sR(s){if(s==="Testmodul 1 - Testtermin 1")return s;const e=/(Modul)\s+(\d+)\s*-\s*(Blokk|Termin)\s+(\d+)/i,t=s.match(e);if(t){const g=t[2],x=t[4];return`M${g} - T${x}`}const o=/(Modul|Termin)\s+(\d+)/i,u=s.match(o);return u?`M${u[2]}`:s}function gE(s,e){if(e==null)return"";const t=La(s,e);return sR(t)}function aR({value:s,onChange:e,length:t=6,disabled:o}){const u=oe.useRef([]),g=oe.useMemo(()=>{const R=(s||"").replace(/\D/g,"").slice(0,t),P=new Array(t).fill("");for(let L=0;L<R.length;L++)P[L]=R[L];return P},[s,t]),x=R=>{const P=u.current[R];P&&P.focus()},T=(R,P)=>{const L=P.replace(/\D/g,"");if(!L)return;const re=g.join("").split("");let se=R;for(const Ye of L){if(se>=t)break;re[se]=Ye,se++}e(re.join("").slice(0,t)),se<=t-1&&x(se)},b=(R,P)=>{const L=P.target.value;if(L.length>1){T(R,L);return}const ee=L.replace(/\D/g,""),re=g.slice();re[R]=ee||"";const se=re.join("");e(se),ee&&R<t-1&&x(R+1)},w=(R,P)=>{const L=P.key;if(L==="Backspace"){if(g[R]){const ee=g.slice();ee[R]="",e(ee.join("")),P.preventDefault()}else if(R>0){P.preventDefault(),x(R-1);const ee=g.slice();ee[R-1]="",e(ee.join(""))}}else L==="ArrowLeft"&&R>0?(P.preventDefault(),x(R-1)):L==="ArrowRight"&&R<t-1&&(P.preventDefault(),x(R+1))},C=(R,P)=>{const L=P.clipboardData.getData("text");L&&(P.preventDefault(),T(R,L))};return oe.useEffect(()=>{u.current=u.current.slice(0,t)},[t]),I.jsx("div",{className:"",style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:g.map((R,P)=>I.jsx("input",{ref:L=>u.current[P]=L,type:"text",inputMode:"numeric",pattern:"[0-9]*",autoComplete:"one-time-code",className:"",style:{borderRadius:"7.5px",border:"2px solid var(--color-black",width:"2.2rem",height:"3.4rem",margin:"0 0.25rem",textAlign:"center"},value:R,onChange:L=>b(P,L),onKeyDown:L=>w(P,L),onPaste:L=>C(P,L),"aria-label":`Kode siffer ${P+1}`,disabled:o,maxLength:1},P))})}function oR({user:s}){const[e,t]=oe.useState(""),[o,u]=oe.useState(!1),g=s.term??11,[x,T]=oe.useState([]),[b,w]=oe.useState(!1),[C,R]=oe.useState(0),[P,L]=oe.useState(!1),{options:ee}=am(),[re,se]=oe.useState(!1),[Ye,Oe]=oe.useState(null),[le,Ue]=oe.useState([]),[dt,Ze]=oe.useState({}),[F,z]=oe.useState("idle"),[U,J]=oe.useState(null),[X,Y]=oe.useState(null),G=s.semesterStatus&&s.semesterStatus!=="aktiv",at=()=>{z("idle"),J(null),Y(null),t(""),L(!1)},ce=async $=>{if(!(!$||$.length<6)){u(!0),z("idle"),J(null);try{const pe=Kn(pt,"sessions"),Te=ui(pe,Ar("code","==",$)),nt=await dr(Te);if(nt.empty){z("error"),J("Fant ingen kt med denne koden."),t(""),L(!1),u(!1);return}const ve=nt.docs[0],st=ve.data(),xt=Cn(pt,"sessions",ve.id,"attendance",s.uid);if((await Fa(xt)).exists()){z("error"),J("Du er allerede registrert p denne kten."),t(""),L(!1),u(!1);return}await hl(xt,{userId:s.uid,studentName:s.displayName,studentEmail:s.email,createdAt:Vn.now(),status:"present"});const cn=st.name||"kten";Y(cn),z("success"),J(null),L(!1),t(""),R(en=>en+1)}catch(pe){console.error(pe),z("error"),J("Noe gikk galt ved registrering av oppmte."),t(""),L(!1)}finally{u(!1)}}},ue=$=>{if(!$||o)return;const pe=$.replace(/\D/g,"").slice(0,6);pe.length===6&&(t(pe),ce(pe))};oe.useEffect(()=>{(async()=>{w(!0);try{const pe=Kn(pt,"requirements"),Te=ui(pe,Ar("term","==",g)),ve=(await dr(Te)).docs.map(ke=>{const be=ke.data();return{category:be.category,requiredCount:be.requiredCount}}),st=Kn(pt,"sessions"),xt=ui(st,Ar("term","==",g)),cn=(await dr(xt)).docs.map(ke=>{const be=ke.data();return{id:ke.id,timeId:typeof be?.timeId=="string"?be.timeId:void 0,name:typeof be?.name=="string"?be.name:void 0,category:typeof be?.category=="string"?be.category:void 0}}),en=Kn(pt,"times"),En=ui(en,Ar("term","==",g)),hn=(await dr(En)).docs.map(ke=>{const be=ke.data();return{id:ke.id,name:be.name,category:be.category,term:be.term,order:typeof be?.order=="number"?be.order:void 0}}),wn=new Map;for(const ke of hn)ke.category&&wn.set(ke.category,(wn.get(ke.category)??0)+1);const De=new Map,ge={};for(const ke of cn){if(!ke.category)continue;const be=Cn(pt,"sessions",ke.id,"attendance",s.uid);if((await Fa(be)).exists()){if(De.set(ke.category,(De.get(ke.category)??0)+1),ke.timeId)ge[ke.timeId]=!0;else if(ke.name&&ke.category){const vt=hn.find(Rt=>Rt.category===ke.category&&Rt.name===ke.name);vt&&(ge[vt.id]=!0)}}}const Re=new Set;for(const ke of ve)Re.add(ke.category);for(const ke of cn)ke.category&&Re.add(ke.category);for(const ke of hn)ke.category&&Re.add(ke.category);const Fe=[];Re.forEach(ke=>{const be=ve.find(Fn=>Fn.category===ke),Pt=be?be.requiredCount:null,vt=wn.get(ke)??0,Rt=De.get(ke)??0;Fe.push({category:ke,attendedCount:Rt,totalSessions:vt,requiredCount:Pt})}),Fe.sort((ke,be)=>ke.category.localeCompare(be.category,"nb-NO",{sensitivity:"base"})),T(Fe),Ue(hn),Ze(ge)}catch(pe){console.error(pe),T([]),Ue([]),Ze({})}finally{w(!1)}})()},[g,s.uid,C]);const Ee=$=>{const pe=$.match(/^\s*(\d+)/);return pe?parseInt(pe[1],10):Number.POSITIVE_INFINITY},We=oe.useMemo(()=>{if(!re||!Ye)return[];const $=le.filter(pe=>pe.category===Ye).map(pe=>({...pe,attended:!!dt[pe.id]}));return $.sort((pe,Te)=>{const nt=(pe.order??Number.MAX_SAFE_INTEGER)-(Te.order??Number.MAX_SAFE_INTEGER);if(nt!==0)return nt;const ve=Ee(pe.name),st=Ee(Te.name);return ve!==st?ve-st:pe.name.localeCompare(Te.name,"nb-NO",{sensitivity:"base"})}),$},[re,Ye,le,dt]),qe=$=>{Oe($),se(!0)},ot=()=>{se(!1),Oe(null)},Q=$=>{const Te=($||"").replace(/\D/g,"").slice(0,6);t(Te),Te.length===6&&!o&&ce(Te)};return oe.useEffect(()=>{if(F==="idle")return;const pe=setTimeout(()=>{at()},1e4);return()=>clearTimeout(pe)},[F]),I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"card student-card student-card-top round-border-top",children:[I.jsxs("div",{className:"studentInfo",children:[I.jsx("h2",{children:s.displayName||s.email}),I.jsx("p",{className:"thinFont smallText opaqueFont",children:La(ee,g)})]}),I.jsx("img",{src:"/card-man.svg",alt:"Student-profile-placeholder"})]}),I.jsx("div",{className:"card student-card student-card-bottom round-border-bottom",children:F==="success"?I.jsx(I.Fragment,{children:I.jsxs("div",{className:"registered-sucsess",children:[I.jsx("img",{src:"/registered.svg",alt:"Registered-icon"}),I.jsx("h3",{className:"",children:"Oppmte registrert"}),X&&I.jsx("p",{className:"",children:X})]})}):F==="error"?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"",children:""}),I.jsx("h3",{className:"",children:"Kunne ikke registrere oppmte"}),U&&I.jsx("p",{className:"m-0 mb-1 fs-0_95 text-gray-700",children:U})]}):I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"code-input-container",children:[I.jsx("p",{className:"spacedFont thinFont",children:"Oppmtekode fra lrer"}),I.jsx(aR,{value:e,onChange:Q,disabled:o})]}),I.jsx("img",{src:"/qrscan.svg",alt:"QR-code-icon",className:"qr-code-icon"}),I.jsx("br",{}),I.jsx("button",{type:"button",onClick:()=>L($=>!$),className:"button-colorless fontUnderline boldFont QRbutton",children:P?"Stopp skanning":"Skann QR-kode"}),P&&I.jsx("div",{className:"mt-0_8 flex justify-center",children:I.jsx("div",{className:"w-260px maxw-full rounded-lg overflow-hidden border-gray",children:I.jsx(rR,{onCode:ue})})})]})}),I.jsxs("div",{className:"card round-corners-full approved-term-card",children:[I.jsx("h2",{children:"Godkjent"}),I.jsxs("p",{className:"thinFont opaqueFont",children:["Bra jobba! Kravene for ",La(ee,g).toLowerCase()," er oppndd. Lykke til p eksamen!"]}),I.jsx("button",{className:"btn button-primary button-black button-next-semester",children:"Start neste semester"}),I.jsx("button",{className:"button-primary button-colorless fontUnderline",children:"Innvilget permisjon"})]}),I.jsxs("div",{className:"card round-corners-full student-overview-card",children:[G&&I.jsxs("p",{className:"text-red text-center",children:['Du er markert som "',s.semesterStatus,'" dette semesteret. Ingen oppmtekrav, men du kan fortsatt registrere oppmte.']}),I.jsx("section",{children:b?I.jsx(lc,{}):x.length===0?I.jsx("p",{className:"fs-0_9 text-gray-500",children:"Ingen registrerte timer for denne terminen enn."}):I.jsxs(I.Fragment,{children:[I.jsx("h2",{children:"Min oppmtebok"}),I.jsxs("p",{className:"thinFont opaqueFont",children:["Her finner du alle fullfrte",I.jsx("br",{})," og fremtidige oppmter."]}),I.jsx("table",{className:"table-container",children:I.jsx("tbody",{children:x.map($=>{const pe=$.requiredCount!=null&&$.attendedCount>=$.requiredCount;return I.jsxs("tr",{onClick:()=>qe($.category),children:[I.jsx("td",{className:"requirement-meet-icon",children:pe?I.jsx("img",{src:"/check-white.svg",alt:"Checkmark-icon"}):I.jsx(I.Fragment,{})}),I.jsx("td",{className:"class-overview thinFont smal",children:$.category}),I.jsx("td",{className:"spacedFont",children:$.totalSessions>0?`${$.attendedCount}/${$.totalSessions}`:$.attendedCount}),I.jsx("td",{className:"required-classes",children:$.requiredCount??"-"})]},$.category)})})}),I.jsx("h2",{children:"Godkjent"}),I.jsxs("p",{className:"thinFont opaqueFont",children:["Bra jobba! Kravene for ",La(ee,g).toLowerCase()," er oppndd. Lykke til p eksamen!"]})]})}),re&&I.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},onClick:ot,children:I.jsxs("div",{onClick:$=>$.stopPropagation(),style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[I.jsx("h3",{style:{margin:0},children:Ye?`Oppmte i ${Ye}`:"Oppmte"}),I.jsx("button",{type:"button",onClick:ot,style:{border:"none",background:"transparent",fontSize:"1.2rem",cursor:"pointer"},"aria-label":"Lukk",title:"Lukk",children:""})]}),We.length===0?I.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen timer er definert i denne gruppen enda."}):I.jsx("ul",{style:{listStyle:"none",padding:0,marginTop:"0.75rem"},children:We.map($=>I.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.35rem 0",borderBottom:"1px solid #f3f4f6"},children:[I.jsx("span",{children:$.name}),I.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",borderRadius:"999px",backgroundColor:$.attended?"#dcfce7":"#fee2e2",color:$.attended?"#166534":"#991b1b",fontSize:"0.8rem"},children:$.attended?"Registrert":"Mangler"})]},$.id))}),I.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"0.75rem"},children:I.jsx("button",{type:"button",onClick:ot,style:{padding:"0.35rem 0.8rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff",cursor:"pointer"},children:"Lukk"})})]})})]})]})}var lR=Object.defineProperty,Hd=Object.getOwnPropertySymbols,$_=Object.prototype.hasOwnProperty,eA=Object.prototype.propertyIsEnumerable,mE=(s,e,t)=>e in s?lR(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ng=(s,e)=>{for(var t in e||(e={}))$_.call(e,t)&&mE(s,t,e[t]);if(Hd)for(var t of Hd(e))eA.call(e,t)&&mE(s,t,e[t]);return s},rg=(s,e)=>{var t={};for(var o in s)$_.call(s,o)&&e.indexOf(o)<0&&(t[o]=s[o]);if(s!=null&&Hd)for(var o of Hd(s))e.indexOf(o)<0&&eA.call(s,o)&&(t[o]=s[o]);return t};var xl;(s=>{const e=class xn{constructor(b,w,C,R){if(this.version=b,this.errorCorrectionLevel=w,this.modules=[],this.isFunction=[],b<xn.MIN_VERSION||b>xn.MAX_VERSION)throw new RangeError("Version value out of range");if(R<-1||R>7)throw new RangeError("Mask value out of range");this.size=b*4+17;let P=[];for(let ee=0;ee<this.size;ee++)P.push(!1);for(let ee=0;ee<this.size;ee++)this.modules.push(P.slice()),this.isFunction.push(P.slice());this.drawFunctionPatterns();const L=this.addEccAndInterleave(C);if(this.drawCodewords(L),R==-1){let ee=1e9;for(let re=0;re<8;re++){this.applyMask(re),this.drawFormatBits(re);const se=this.getPenaltyScore();se<ee&&(R=re,ee=se),this.applyMask(re)}}u(0<=R&&R<=7),this.mask=R,this.applyMask(R),this.drawFormatBits(R),this.isFunction=[]}static encodeText(b,w){const C=s.QrSegment.makeSegments(b);return xn.encodeSegments(C,w)}static encodeBinary(b,w){const C=s.QrSegment.makeBytes(b);return xn.encodeSegments([C],w)}static encodeSegments(b,w,C=1,R=40,P=-1,L=!0){if(!(xn.MIN_VERSION<=C&&C<=R&&R<=xn.MAX_VERSION)||P<-1||P>7)throw new RangeError("Invalid value");let ee,re;for(ee=C;;ee++){const le=xn.getNumDataCodewords(ee,w)*8,Ue=x.getTotalBits(b,ee);if(Ue<=le){re=Ue;break}if(ee>=R)throw new RangeError("Data too long")}for(const le of[xn.Ecc.MEDIUM,xn.Ecc.QUARTILE,xn.Ecc.HIGH])L&&re<=xn.getNumDataCodewords(ee,le)*8&&(w=le);let se=[];for(const le of b){t(le.mode.modeBits,4,se),t(le.numChars,le.mode.numCharCountBits(ee),se);for(const Ue of le.getData())se.push(Ue)}u(se.length==re);const Ye=xn.getNumDataCodewords(ee,w)*8;u(se.length<=Ye),t(0,Math.min(4,Ye-se.length),se),t(0,(8-se.length%8)%8,se),u(se.length%8==0);for(let le=236;se.length<Ye;le^=253)t(le,8,se);let Oe=[];for(;Oe.length*8<se.length;)Oe.push(0);return se.forEach((le,Ue)=>Oe[Ue>>>3]|=le<<7-(Ue&7)),new xn(ee,w,Oe,P)}getModule(b,w){return 0<=b&&b<this.size&&0<=w&&w<this.size&&this.modules[w][b]}getModules(){return this.modules}drawFunctionPatterns(){for(let C=0;C<this.size;C++)this.setFunctionModule(6,C,C%2==0),this.setFunctionModule(C,6,C%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const b=this.getAlignmentPatternPositions(),w=b.length;for(let C=0;C<w;C++)for(let R=0;R<w;R++)C==0&&R==0||C==0&&R==w-1||C==w-1&&R==0||this.drawAlignmentPattern(b[C],b[R]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(b){const w=this.errorCorrectionLevel.formatBits<<3|b;let C=w;for(let P=0;P<10;P++)C=C<<1^(C>>>9)*1335;const R=(w<<10|C)^21522;u(R>>>15==0);for(let P=0;P<=5;P++)this.setFunctionModule(8,P,o(R,P));this.setFunctionModule(8,7,o(R,6)),this.setFunctionModule(8,8,o(R,7)),this.setFunctionModule(7,8,o(R,8));for(let P=9;P<15;P++)this.setFunctionModule(14-P,8,o(R,P));for(let P=0;P<8;P++)this.setFunctionModule(this.size-1-P,8,o(R,P));for(let P=8;P<15;P++)this.setFunctionModule(8,this.size-15+P,o(R,P));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let b=this.version;for(let C=0;C<12;C++)b=b<<1^(b>>>11)*7973;const w=this.version<<12|b;u(w>>>18==0);for(let C=0;C<18;C++){const R=o(w,C),P=this.size-11+C%3,L=Math.floor(C/3);this.setFunctionModule(P,L,R),this.setFunctionModule(L,P,R)}}drawFinderPattern(b,w){for(let C=-4;C<=4;C++)for(let R=-4;R<=4;R++){const P=Math.max(Math.abs(R),Math.abs(C)),L=b+R,ee=w+C;0<=L&&L<this.size&&0<=ee&&ee<this.size&&this.setFunctionModule(L,ee,P!=2&&P!=4)}}drawAlignmentPattern(b,w){for(let C=-2;C<=2;C++)for(let R=-2;R<=2;R++)this.setFunctionModule(b+R,w+C,Math.max(Math.abs(R),Math.abs(C))!=1)}setFunctionModule(b,w,C){this.modules[w][b]=C,this.isFunction[w][b]=!0}addEccAndInterleave(b){const w=this.version,C=this.errorCorrectionLevel;if(b.length!=xn.getNumDataCodewords(w,C))throw new RangeError("Invalid argument");const R=xn.NUM_ERROR_CORRECTION_BLOCKS[C.ordinal][w],P=xn.ECC_CODEWORDS_PER_BLOCK[C.ordinal][w],L=Math.floor(xn.getNumRawDataModules(w)/8),ee=R-L%R,re=Math.floor(L/R);let se=[];const Ye=xn.reedSolomonComputeDivisor(P);for(let le=0,Ue=0;le<R;le++){let dt=b.slice(Ue,Ue+re-P+(le<ee?0:1));Ue+=dt.length;const Ze=xn.reedSolomonComputeRemainder(dt,Ye);le<ee&&dt.push(0),se.push(dt.concat(Ze))}let Oe=[];for(let le=0;le<se[0].length;le++)se.forEach((Ue,dt)=>{(le!=re-P||dt>=ee)&&Oe.push(Ue[le])});return u(Oe.length==L),Oe}drawCodewords(b){if(b.length!=Math.floor(xn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let w=0;for(let C=this.size-1;C>=1;C-=2){C==6&&(C=5);for(let R=0;R<this.size;R++)for(let P=0;P<2;P++){const L=C-P,re=(C+1&2)==0?this.size-1-R:R;!this.isFunction[re][L]&&w<b.length*8&&(this.modules[re][L]=o(b[w>>>3],7-(w&7)),w++)}}u(w==b.length*8)}applyMask(b){if(b<0||b>7)throw new RangeError("Mask value out of range");for(let w=0;w<this.size;w++)for(let C=0;C<this.size;C++){let R;switch(b){case 0:R=(C+w)%2==0;break;case 1:R=w%2==0;break;case 2:R=C%3==0;break;case 3:R=(C+w)%3==0;break;case 4:R=(Math.floor(C/3)+Math.floor(w/2))%2==0;break;case 5:R=C*w%2+C*w%3==0;break;case 6:R=(C*w%2+C*w%3)%2==0;break;case 7:R=((C+w)%2+C*w%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[w][C]&&R&&(this.modules[w][C]=!this.modules[w][C])}}getPenaltyScore(){let b=0;for(let P=0;P<this.size;P++){let L=!1,ee=0,re=[0,0,0,0,0,0,0];for(let se=0;se<this.size;se++)this.modules[P][se]==L?(ee++,ee==5?b+=xn.PENALTY_N1:ee>5&&b++):(this.finderPenaltyAddHistory(ee,re),L||(b+=this.finderPenaltyCountPatterns(re)*xn.PENALTY_N3),L=this.modules[P][se],ee=1);b+=this.finderPenaltyTerminateAndCount(L,ee,re)*xn.PENALTY_N3}for(let P=0;P<this.size;P++){let L=!1,ee=0,re=[0,0,0,0,0,0,0];for(let se=0;se<this.size;se++)this.modules[se][P]==L?(ee++,ee==5?b+=xn.PENALTY_N1:ee>5&&b++):(this.finderPenaltyAddHistory(ee,re),L||(b+=this.finderPenaltyCountPatterns(re)*xn.PENALTY_N3),L=this.modules[se][P],ee=1);b+=this.finderPenaltyTerminateAndCount(L,ee,re)*xn.PENALTY_N3}for(let P=0;P<this.size-1;P++)for(let L=0;L<this.size-1;L++){const ee=this.modules[P][L];ee==this.modules[P][L+1]&&ee==this.modules[P+1][L]&&ee==this.modules[P+1][L+1]&&(b+=xn.PENALTY_N2)}let w=0;for(const P of this.modules)w=P.reduce((L,ee)=>L+(ee?1:0),w);const C=this.size*this.size,R=Math.ceil(Math.abs(w*20-C*10)/C)-1;return u(0<=R&&R<=9),b+=R*xn.PENALTY_N4,u(0<=b&&b<=2568888),b}getAlignmentPatternPositions(){if(this.version==1)return[];{const b=Math.floor(this.version/7)+2,w=this.version==32?26:Math.ceil((this.version*4+4)/(b*2-2))*2;let C=[6];for(let R=this.size-7;C.length<b;R-=w)C.splice(1,0,R);return C}}static getNumRawDataModules(b){if(b<xn.MIN_VERSION||b>xn.MAX_VERSION)throw new RangeError("Version number out of range");let w=(16*b+128)*b+64;if(b>=2){const C=Math.floor(b/7)+2;w-=(25*C-10)*C-55,b>=7&&(w-=36)}return u(208<=w&&w<=29648),w}static getNumDataCodewords(b,w){return Math.floor(xn.getNumRawDataModules(b)/8)-xn.ECC_CODEWORDS_PER_BLOCK[w.ordinal][b]*xn.NUM_ERROR_CORRECTION_BLOCKS[w.ordinal][b]}static reedSolomonComputeDivisor(b){if(b<1||b>255)throw new RangeError("Degree out of range");let w=[];for(let R=0;R<b-1;R++)w.push(0);w.push(1);let C=1;for(let R=0;R<b;R++){for(let P=0;P<w.length;P++)w[P]=xn.reedSolomonMultiply(w[P],C),P+1<w.length&&(w[P]^=w[P+1]);C=xn.reedSolomonMultiply(C,2)}return w}static reedSolomonComputeRemainder(b,w){let C=w.map(R=>0);for(const R of b){const P=R^C.shift();C.push(0),w.forEach((L,ee)=>C[ee]^=xn.reedSolomonMultiply(L,P))}return C}static reedSolomonMultiply(b,w){if(b>>>8||w>>>8)throw new RangeError("Byte out of range");let C=0;for(let R=7;R>=0;R--)C=C<<1^(C>>>7)*285,C^=(w>>>R&1)*b;return u(C>>>8==0),C}finderPenaltyCountPatterns(b){const w=b[1];u(w<=this.size*3);const C=w>0&&b[2]==w&&b[3]==w*3&&b[4]==w&&b[5]==w;return(C&&b[0]>=w*4&&b[6]>=w?1:0)+(C&&b[6]>=w*4&&b[0]>=w?1:0)}finderPenaltyTerminateAndCount(b,w,C){return b&&(this.finderPenaltyAddHistory(w,C),w=0),w+=this.size,this.finderPenaltyAddHistory(w,C),this.finderPenaltyCountPatterns(C)}finderPenaltyAddHistory(b,w){w[0]==0&&(b+=this.size),w.pop(),w.unshift(b)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],s.QrCode=e;function t(T,b,w){if(b<0||b>31||T>>>b)throw new RangeError("Value out of range");for(let C=b-1;C>=0;C--)w.push(T>>>C&1)}function o(T,b){return(T>>>b&1)!=0}function u(T){if(!T)throw new Error("Assertion error")}const g=class Nr{constructor(b,w,C){if(this.mode=b,this.numChars=w,this.bitData=C,w<0)throw new RangeError("Invalid argument");this.bitData=C.slice()}static makeBytes(b){let w=[];for(const C of b)t(C,8,w);return new Nr(Nr.Mode.BYTE,b.length,w)}static makeNumeric(b){if(!Nr.isNumeric(b))throw new RangeError("String contains non-numeric characters");let w=[];for(let C=0;C<b.length;){const R=Math.min(b.length-C,3);t(parseInt(b.substring(C,C+R),10),R*3+1,w),C+=R}return new Nr(Nr.Mode.NUMERIC,b.length,w)}static makeAlphanumeric(b){if(!Nr.isAlphanumeric(b))throw new RangeError("String contains unencodable characters in alphanumeric mode");let w=[],C;for(C=0;C+2<=b.length;C+=2){let R=Nr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(C))*45;R+=Nr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(C+1)),t(R,11,w)}return C<b.length&&t(Nr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(C)),6,w),new Nr(Nr.Mode.ALPHANUMERIC,b.length,w)}static makeSegments(b){return b==""?[]:Nr.isNumeric(b)?[Nr.makeNumeric(b)]:Nr.isAlphanumeric(b)?[Nr.makeAlphanumeric(b)]:[Nr.makeBytes(Nr.toUtf8ByteArray(b))]}static makeEci(b){let w=[];if(b<0)throw new RangeError("ECI assignment value out of range");if(b<128)t(b,8,w);else if(b<16384)t(2,2,w),t(b,14,w);else if(b<1e6)t(6,3,w),t(b,21,w);else throw new RangeError("ECI assignment value out of range");return new Nr(Nr.Mode.ECI,0,w)}static isNumeric(b){return Nr.NUMERIC_REGEX.test(b)}static isAlphanumeric(b){return Nr.ALPHANUMERIC_REGEX.test(b)}getData(){return this.bitData.slice()}static getTotalBits(b,w){let C=0;for(const R of b){const P=R.mode.numCharCountBits(w);if(R.numChars>=1<<P)return 1/0;C+=4+P+R.bitData.length}return C}static toUtf8ByteArray(b){b=encodeURI(b);let w=[];for(let C=0;C<b.length;C++)b.charAt(C)!="%"?w.push(b.charCodeAt(C)):(w.push(parseInt(b.substring(C+1,C+3),16)),C+=2);return w}};g.NUMERIC_REGEX=/^[0-9]*$/,g.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,g.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let x=g;s.QrSegment=g})(xl||(xl={}));(s=>{(e=>{const t=class{constructor(u,g){this.ordinal=u,this.formatBits=g}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(s.QrCode||(s.QrCode={}))})(xl||(xl={}));(s=>{(e=>{const t=class{constructor(u,g){this.modeBits=u,this.numBitsCharCount=g}numCharCountBits(u){return this.numBitsCharCount[Math.floor((u+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(s.QrSegment||(s.QrSegment={}))})(xl||(xl={}));var rc=xl;var cR={L:rc.QrCode.Ecc.LOW,M:rc.QrCode.Ecc.MEDIUM,Q:rc.QrCode.Ecc.QUARTILE,H:rc.QrCode.Ecc.HIGH},tA=128,nA="L",rA="#FFFFFF",iA="#000000",sA=!1,aA=1,uR=4,hR=0,dR=.1;function oA(s,e=0){const t=[];return s.forEach(function(o,u){let g=null;o.forEach(function(x,T){if(!x&&g!==null){t.push(`M${g+e} ${u+e}h${T-g}v1H${g+e}z`),g=null;return}if(T===o.length-1){if(!x)return;g===null?t.push(`M${T+e},${u+e} h1v1H${T+e}z`):t.push(`M${g+e},${u+e} h${T+1-g}v1H${g+e}z`);return}x&&g===null&&(g=T)})}),t.join("")}function lA(s,e){return s.slice().map((t,o)=>o<e.y||o>=e.y+e.h?t:t.map((u,g)=>g<e.x||g>=e.x+e.w?u:!1))}function fR(s,e,t,o){if(o==null)return null;const u=s.length+t*2,g=Math.floor(e*dR),x=u/e,T=(o.width||g)*x,b=(o.height||g)*x,w=o.x==null?s.length/2-T/2:o.x*x,C=o.y==null?s.length/2-b/2:o.y*x,R=o.opacity==null?1:o.opacity;let P=null;if(o.excavate){let ee=Math.floor(w),re=Math.floor(C),se=Math.ceil(T+w-ee),Ye=Math.ceil(b+C-re);P={x:ee,y:re,w:se,h:Ye}}const L=o.crossOrigin;return{x:w,y:C,h:b,w:T,excavation:P,opacity:R,crossOrigin:L}}function gR(s,e){return e!=null?Math.max(Math.floor(e),0):s?uR:hR}function cA({value:s,level:e,minVersion:t,includeMargin:o,marginSize:u,imageSettings:g,size:x,boostLevel:T}){let b=Qe.useMemo(()=>{const ee=(Array.isArray(s)?s:[s]).reduce((re,se)=>(re.push(...rc.QrSegment.makeSegments(se)),re),[]);return rc.QrCode.encodeSegments(ee,cR[e],t,void 0,void 0,T)},[s,e,t,T]);const{cells:w,margin:C,numCells:R,calculatedImageSettings:P}=Qe.useMemo(()=>{let L=b.getModules();const ee=gR(o,u),re=L.length+ee*2,se=fR(L,x,ee,g);return{cells:L,margin:ee,numCells:re,calculatedImageSettings:se}},[b,x,g,o,u]);return{qrcode:b,margin:C,cells:w,numCells:R,calculatedImageSettings:P}}var mR=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),uA=Qe.forwardRef(function(e,t){const o=e,{value:u,size:g=tA,level:x=nA,bgColor:T=rA,fgColor:b=iA,includeMargin:w=sA,minVersion:C=aA,boostLevel:R,marginSize:P,imageSettings:L}=o,re=rg(o,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:se}=re,Ye=rg(re,["style"]),Oe=L?.src,le=Qe.useRef(null),Ue=Qe.useRef(null),dt=Qe.useCallback(at=>{le.current=at,typeof t=="function"?t(at):t&&(t.current=at)},[t]),[Ze,F]=Qe.useState(!1),{margin:z,cells:U,numCells:J,calculatedImageSettings:X}=cA({value:u,level:x,minVersion:C,boostLevel:R,includeMargin:w,marginSize:P,imageSettings:L,size:g});Qe.useEffect(()=>{if(le.current!=null){const at=le.current,ce=at.getContext("2d");if(!ce)return;let ue=U;const Ee=Ue.current,We=X!=null&&Ee!==null&&Ee.complete&&Ee.naturalHeight!==0&&Ee.naturalWidth!==0;We&&X.excavation!=null&&(ue=lA(U,X.excavation));const qe=window.devicePixelRatio||1;at.height=at.width=g*qe;const ot=g/J*qe;ce.scale(ot,ot),ce.fillStyle=T,ce.fillRect(0,0,J,J),ce.fillStyle=b,mR?ce.fill(new Path2D(oA(ue,z))):U.forEach(function(Q,$){Q.forEach(function(pe,Te){pe&&ce.fillRect(Te+z,$+z,1,1)})}),X&&(ce.globalAlpha=X.opacity),We&&ce.drawImage(Ee,X.x+z,X.y+z,X.w,X.h)}}),Qe.useEffect(()=>{F(!1)},[Oe]);const Y=ng({height:g,width:g},se);let G=null;return Oe!=null&&(G=Qe.createElement("img",{src:Oe,key:Oe,style:{display:"none"},onLoad:()=>{F(!0)},ref:Ue,crossOrigin:X?.crossOrigin})),Qe.createElement(Qe.Fragment,null,Qe.createElement("canvas",ng({style:Y,height:g,width:g,ref:dt,role:"img"},Ye)),G)});uA.displayName="QRCodeCanvas";var pR=Qe.forwardRef(function(e,t){const o=e,{value:u,size:g=tA,level:x=nA,bgColor:T=rA,fgColor:b=iA,includeMargin:w=sA,minVersion:C=aA,boostLevel:R,title:P,marginSize:L,imageSettings:ee}=o,re=rg(o,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:se,cells:Ye,numCells:Oe,calculatedImageSettings:le}=cA({value:u,level:x,minVersion:C,boostLevel:R,includeMargin:w,marginSize:L,imageSettings:ee,size:g});let Ue=Ye,dt=null;ee!=null&&le!=null&&(le.excavation!=null&&(Ue=lA(Ye,le.excavation)),dt=Qe.createElement("image",{href:ee.src,height:le.h,width:le.w,x:le.x+se,y:le.y+se,preserveAspectRatio:"none",opacity:le.opacity,crossOrigin:le.crossOrigin}));const Ze=oA(Ue,se);return Qe.createElement("svg",ng({height:g,width:g,viewBox:`0 0 ${Oe} ${Oe}`,ref:t,role:"img"},re),!!P&&Qe.createElement("title",null,P),Qe.createElement("path",{fill:T,d:`M0,0 h${Oe}v${Oe}H0z`,shapeRendering:"crispEdges"}),Qe.createElement("path",{fill:b,d:Ze,shapeRendering:"crispEdges"}),dt)});pR.displayName="QRCodeSVG";const yR={width:"100%",maxWidth:460,backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},ou={fontSize:"0.8rem",display:"block"},lu={width:"100%",padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.9rem",marginTop:"0.15rem",boxSizing:"border-box"},pE={padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",color:"#111827",cursor:"pointer",fontSize:"0.9rem"};function om({uid:s,role:e,onClose:t,displayName:o,email:u}){const{options:g}=am(),[x,T]=oe.useState(!0),[b,w]=oe.useState(!1),[C,R]=oe.useState(null),[P,L]=oe.useState(""),[ee,re]=oe.useState(""),[se,Ye]=oe.useState(u),[Oe,le]=oe.useState(null),[Ue,dt]=oe.useState([]),[Ze,F]=oe.useState(!1),[z,U]=oe.useState(""),J=e==="teacher"||e==="student",[X,Y]=oe.useState(""),[G,at]=oe.useState(""),[ce,ue]=oe.useState(u),[Ee,We]=oe.useState({}),[qe,ot]=oe.useState(!1),[Q,$]=oe.useState(""),[pe,Te]=oe.useState(!1),[nt,ve]=oe.useState(null),[st,xt]=oe.useState(null);oe.useEffect(()=>{let ge=!0;return(async()=>{try{T(!0);const Re=Cn(pt,"users",s),Fe=await Fa(Re),ke=Fe.exists()?Fe.data():{};if(!ge)return;const be=String(ke.phone??""),Pt=String(ke.secondaryEmail??""),vt=String(ke?.email??u);L(be),re(Pt),Ye(vt),Y(be),at(Pt),ue(vt),le(typeof ke.term=="number"?ke.term:null);const Rt=Array.isArray(ke.allowedTerms)?ke.allowedTerms.filter(Fn=>typeof Fn=="number"):[];dt(Rt);try{const Fn=Fe.exists()?Fe.data():{};F(!!Fn?.isSuperAdmin)}catch{F(!1)}}catch{ge&&R("Kunne ikke laste profildata.")}finally{ge&&T(!1)}})(),()=>{ge=!1}},[s]);const kt=oe.useMemo(()=>Ue.map(ge=>La(g,ge)),[Ue,g]),cn=async()=>{R(null),w(!0);try{await bi(Cn(pt,"users",s),{phone:P.trim()||null}),Y(P),Ct.success("Mobilnummer er oppdatert.")}catch(ge){console.error(ge),R("Kunne ikke lagre mobilnummer."),Ct.error("Kunne ikke lagre mobilnummer.")}finally{w(!1)}},en=async()=>{R(null),w(!0);try{await bi(Cn(pt,"users",s),{secondaryEmail:ee.trim()||null}),at(ee),Ct.success("Sekundr epost er oppdatert.")}catch(ge){console.error(ge),R("Kunne ikke lagre sekundr epost."),Ct.error("Kunne ikke lagre sekundr epost.")}finally{w(!1)}},En=async()=>{R(null);const ge=se.trim();if(!ge){R("Epost kan ikke vre tom."),Ct.error("Epost kan ikke vre tom.");return}if(ge===ce){Ct.info?.("Eposten er uendret.")||Ct("Eposten er uendret.");return}try{const Re=Co.currentUser;if(!Re){R("Ingen innlogget bruker."),Ct.error("Ingen innlogget bruker.");return}await z2(Re,ge),ue(ge),Ct.success(`Vi har sendt en bekreftelseslenke til ${ge}. Flg lenken for  fullfre endringen av epost.`)}catch(Re){console.warn("updateEmail failed",Re),Re?.code==="auth/operation-not-allowed"?(R("Kan ikke oppdatere epost direkte. Du m bekrefte ny epost via lenken vi sender. Prv igjen."),Ct.error("Kan ikke oppdatere epost direkte. Bruk knappen igjen for  f tilsendt bekreftelseslenke.")):Re?.code==="auth/requires-recent-login"?(xt(ge),$(""),ve(null),ot(!0),Ct.info?.("Av sikkerhetshensyn m du bekrefte med passord fr du kan endre epost.")||Ct("Av sikkerhetshensyn m du bekrefte med passord fr du kan endre epost.")):Re?.code==="auth/email-already-in-use"?(R("Epostadressen er allerede i bruk av en annen bruker."),Ct.error("Epostadressen er allerede i bruk av en annen bruker.")):Re?.code==="auth/invalid-email"?(R("Ugyldig epost."),Ct.error("Ugyldig epost.")):(R("Kunne ikke oppdatere epost. Prv igjen senere."),Ct.error("Kunne ikke oppdatere epost. Prv igjen senere."))}},Lt=()=>{ot(!1),$(""),ve(null)},hn=async()=>{ve(null);const ge=(st||se||"").trim();if(!ge){ve("Ugyldig ny epost.");return}const Re=Co.currentUser;if(!Re){ve("Ingen innlogget bruker.");return}if(!Q){ve("Skriv inn passordet ditt.");return}try{Te(!0);const Fe=El.credential(Re.email||u,Q);await TC(Re,Fe),await z2(Re,ge),ot(!1),$(""),xt(null),Ct.success(`Vi har sendt en bekreftelseslenke til ${ge}. Flg lenken for  fullfre endringen av epost.`)}catch(Fe){console.error("Reauth/update email failed",Fe),Fe?.code==="auth/wrong-password"?ve("Feil passord."):Fe?.code==="auth/too-many-requests"?ve("For mange forsk. Prv igjen senere."):Fe?.code==="auth/invalid-email"?ve("Ugyldig epost."):Fe?.code==="auth/email-already-in-use"?ve("Epostadressen er allerede i bruk av en annen bruker."):ve("Kunne ikke bekrefte innlogging eller oppdatere epost.")}finally{Te(!1)}},wn=async()=>{if(R(null),!z||z.length<6){R("Passord m vre minst 6 tegn."),Ct.error("Passord m vre minst 6 tegn.");return}try{const ge=Co.currentUser;if(!ge){R("Ingen innlogget bruker."),Ct.error("Ingen innlogget bruker.");return}await IC(ge,z),Ct.success("Passordet er oppdatert."),U("")}catch(ge){console.warn("updatePassword failed",ge),ge?.code==="auth/requires-recent-login"?(R("Du m logge inn p nytt fr du kan endre passord."),Ct.error("Du m logge inn p nytt fr du kan endre passord.")):(R("Kunne ikke endre passord."),Ct.error("Kunne ikke endre passord."))}},De=(ge,Re)=>({padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:ge&&Re?"#29B076":"#2EC483",color:"#111827",cursor:ge?"pointer":"not-allowed",fontSize:"0.9rem",transition:"background-color 120ms ease-out",width:"120px",flex:"0 0 120px",whiteSpace:"nowrap",textAlign:"center",boxSizing:"border-box"});return I.jsxs(I.Fragment,{children:[I.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},"aria-modal":!0,role:"dialog",children:I.jsxs("div",{style:yR,children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[I.jsx("h3",{style:{margin:0},children:o||u}),I.jsx("button",{type:"button",onClick:t,style:pE,children:"Lukk"})]}),x?I.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"1rem 0"},children:"Laster..."}):I.jsxs(I.Fragment,{children:[e==="student"&&I.jsxs("div",{style:{fontSize:"0.9rem",color:"#374151"},children:[I.jsx("div",{style:{fontWeight:600},children:"Din termin"}),I.jsx("div",{children:La(g,Oe)})]}),e==="teacher"&&I.jsxs("div",{style:{fontSize:"0.9rem",color:"#374151"},children:[I.jsx("div",{style:{fontWeight:600},children:"Terminer du kan registrere oppmte p:"}),Ue.length===0?I.jsx("div",{children:"Ingen"}):I.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginTop:"0.25rem"},children:kt.map((ge,Re)=>I.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",border:"1px solid #e5e7eb",borderRadius:"999px",background:"#f9fafb",fontSize:"0.8rem"},children:ge},Re))})]}),e==="admin"&&I.jsx("div",{style:{fontSize:"0.9rem",color:"#374151"},children:Ze?I.jsx("div",{style:{fontWeight:600},children:"Super administrator"}):I.jsxs(I.Fragment,{children:[I.jsx("div",{style:{fontWeight:600},children:"Moduler du administrerer:"}),Ue.length===0?I.jsx("div",{children:"Ingen"}):I.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginTop:"0.25rem"},children:kt.map((ge,Re)=>I.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",border:"1px solid #e5e7eb",borderRadius:"999px",background:"#f9fafb",fontSize:"0.8rem"},children:ge},Re))})]})}),I.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginTop:"1rem"},children:[I.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[I.jsx("div",{style:{flex:1,minWidth:0},children:I.jsxs("label",{style:ou,children:["Mobilnummer",I.jsx("input",{type:"tel",value:P,onChange:ge=>L(ge.target.value),placeholder:"Eks: 99999999",style:lu})]})}),I.jsx("button",{type:"button",disabled:b||P===X,onMouseEnter:()=>We(ge=>({...ge,phone:!0})),onMouseLeave:()=>We(ge=>({...ge,phone:!1})),onClick:cn,style:De(!(b||P===X),!!Ee.phone),children:"Lagre"})]}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[I.jsx("div",{style:{flex:1,minWidth:0},children:I.jsxs("label",{style:ou,children:["Epost",I.jsx("input",{type:"email",value:se,onChange:ge=>Ye(ge.target.value),placeholder:"din@epost.no",style:lu})]})}),I.jsx("button",{type:"button",disabled:b||se.trim()===ce.trim(),onMouseEnter:()=>We(ge=>({...ge,primaryEmail:!0})),onMouseLeave:()=>We(ge=>({...ge,primaryEmail:!1})),onClick:En,style:De(!(b||se.trim()===ce.trim()),!!Ee.primaryEmail),children:"Lagre"})]}),J&&I.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[I.jsx("div",{style:{flex:1,minWidth:0},children:I.jsxs("label",{style:ou,children:["Sekundr epost",I.jsx("input",{type:"email",value:ee,onChange:ge=>re(ge.target.value),placeholder:"eksempel@uio.no",style:lu})]})}),I.jsx("button",{type:"button",disabled:b||ee===G,onMouseEnter:()=>We(ge=>({...ge,secondaryEmail:!0})),onMouseLeave:()=>We(ge=>({...ge,secondaryEmail:!1})),onClick:en,style:De(!(b||ee===G),!!Ee.secondaryEmail),children:"Lagre"})]}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[I.jsx("div",{style:{flex:1,minWidth:0},children:I.jsxs("label",{style:ou,children:["Nytt passord",I.jsx("input",{type:"password",value:z,onChange:ge=>U(ge.target.value),placeholder:"Minst 6 tegn",style:lu})]})}),I.jsx("button",{type:"button",disabled:b||z.length===0,onMouseEnter:()=>We(ge=>({...ge,password:!0})),onMouseLeave:()=>We(ge=>({...ge,password:!1})),onClick:wn,style:De(!(b||z.length===0),!!Ee.password),children:"Lagre"})]})]})]})]})}),qe&&I.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:70},children:I.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff"},children:[I.jsx("h3",{style:{marginTop:0},children:"Logg inn p nytt"}),I.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:["Av sikkerhetshensyn m du bekrefte kontoen fr du kan endre epost.",`
`,"Skriv inn passordet for ",u,"."]}),I.jsxs("label",{style:ou,children:["Passord",I.jsx("input",{type:"password",value:Q,onChange:ge=>$(ge.target.value),placeholder:"Passord",style:lu,autoFocus:!0})]}),nt&&I.jsx("p",{style:{color:"#b91c1c",fontSize:"0.85rem",marginTop:"0.5rem"},children:nt}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"0.75rem"},children:[I.jsx("button",{type:"button",onClick:Lt,style:pE,children:"Avbryt"}),I.jsx("button",{type:"button",onClick:hn,style:{background:"#6CE1AB",color:"black",cursor:"pointer"},disabled:pe,children:pe?"Bekrefter...":"Bekreft og send lenke"})]})]})})]})}function xR({user:s}){const[e,t]=oe.useState([]),[o,u]=oe.useState(null),[g,x]=oe.useState(null),[T,b]=oe.useState(""),[w,C]=oe.useState(null),[R,P]=oe.useState([]),[L,ee]=oe.useState(!0),[re,se]=oe.useState(!1),[Ye,Oe]=oe.useState([]),[le,Ue]=oe.useState(!0),[dt,Ze]=oe.useState(""),[F,z]=oe.useState(!1),[U,J]=oe.useState({open:!1,attendee:null}),[X,Y]=oe.useState(120),[G,at]=oe.useState([]),[ce,ue]=oe.useState(!1),Ee=oe.useRef(null),We=oe.useRef(null),{options:qe}=am(),{logout:ot}=bc(),[Q,$]=oe.useState(!1);oe.useEffect(()=>{(async()=>{ee(!0);const Re=(await dr(Kn(pt,"times"))).docs.map(Fe=>{const ke=Fe.data();return{id:Fe.id,name:ke.name,category:ke.category,term:ke.term}});t(Re),ee(!1)})()},[]),oe.useEffect(()=>{(async()=>{try{const ge=Cn(pt,"users",s.uid),Re=await Fa(ge),Fe=Re.exists()?Re.data():null,ke=Array.isArray(Fe?.allowedTerms)?Fe.allowedTerms.map(be=>typeof be=="number"?be:parseInt(be,10)).filter(be=>!Number.isNaN(be)):[];x(ke)}catch(ge){console.warn("Kunne ikke hente allowedTerms for lrer:",ge),x([])}})()},[s.uid]),oe.useMemo(()=>{if(g===null)return qe;const De=new Set(g??[]);return qe.filter(ge=>De.has(ge.value))},[g,qe]),oe.useEffect(()=>{(async()=>{if(!(g===null||!o)){Ue(!0);try{const ge=Kn(pt,"users"),Re=ui(ge,Ar("role","==","student"),Ar("term","==",o)),ke=(await dr(Re)).docs.map(be=>{const Pt=be.data(),vt=Pt?.name&&String(Pt.name)||Pt?.displayName&&String(Pt.displayName)||null;return{id:be.id,name:vt,email:String(Pt?.email??""),phone:Pt?.phone?String(Pt.phone):null,term:typeof Pt?.term=="number"?Pt.term:null}});ke.sort((be,Pt)=>{const vt=(be.name??"").toLocaleLowerCase(),Rt=(Pt.name??"").toLocaleLowerCase();return vt!==Rt?vt.localeCompare(Rt,"nb-NO"):be.email.localeCompare(Pt.email,"nb-NO")}),Oe(ke)}catch(ge){console.error("Feil ved lasting av studenter:",ge),Oe([])}finally{Ue(!1)}}})()},[g,o]),oe.useEffect(()=>{pe()},[s.uid]);const pe=async()=>{try{ue(!0);const De=Date.now()-14400*1e3,ge=Vn.fromMillis(De),Re=Kn(pt,"sessions");let Fe=[];try{const Pt=ui(Re,Ar("teacherId","==",s.uid),Ar("createdAt",">=",ge),Qx("createdAt","desc"),Zx(50));Fe=(await dr(Pt)).docs}catch{const vt=ui(Re,Ar("teacherId","==",s.uid));Fe=(await dr(vt)).docs.filter(Fn=>{const Xt=Fn.data()?.createdAt;return Xt&&Xt.toMillis()>=De}).sort((Fn,Xt)=>{const yr=Fn.data()?.createdAt?.toMillis?.()??0;return(Xt.data()?.createdAt?.toMillis?.()??0)-yr}).slice(0,50)}const ke=new Set,be=[];for(const Pt of Fe){const vt=Pt.data(),Rt=String(vt?.timeId??"");if(!(!Rt||ke.has(Rt))&&(ke.add(Rt),be.push({timeId:Rt,name:String(vt?.name??"Ukjent time"),category:String(vt?.category??""),term:typeof vt?.term=="number"?vt.term:Number(vt?.term)||0,lastAt:vt?.createdAt}),be.length>=10))break}at(be)}catch(De){console.warn("Kunne ikke hente nylige timer:",De),at([])}finally{ue(!1)}};oe.useEffect(()=>{if(!w){P([]);return}const De=Kn(pt,"sessions",w.id,"attendance"),ge=eE(De,Re=>{const Fe=Re.docs.map(ke=>{const be=ke.data();return{id:ke.id,studentName:be.studentName??null,studentEmail:be.studentEmail??null,createdAt:be.createdAt}}).sort((ke,be)=>{const Pt=ke.createdAt?.toMillis?.()??0,vt=be.createdAt?.toMillis?.()??0;return Pt-vt});P(Fe)});return()=>ge()},[w?.id]);const Te=oe.useMemo(()=>e.filter(De=>De.term===o),[e,o]),nt=oe.useMemo(()=>{const De=T.trim().toLowerCase();return De?Te.filter(ge=>ge.name.toLowerCase().includes(De)).sort((ge,Re)=>ge.name.localeCompare(Re.name,"nb-NO",{sensitivity:"base"})):[]},[Te,T]),ve=oe.useMemo(()=>{const De=dt.trim().toLowerCase();if(!De||!w)return[];const ge=De.includes("@");return Ye.filter(Re=>{if(Re.term!==w.term)return!1;const Fe=String(Re.name??"").toLowerCase(),ke=String(Re.email??"").toLowerCase(),be=ge?ke:ke.split("@")[0]??ke,Pt=String(Re.phone??"").toLowerCase();return Fe.includes(De)||be.includes(De)||Pt.includes(De)}).slice(0,10)},[Ye,dt,w]),st=async De=>{const ge=e.find(Rt=>Rt.id===De);if(!ge)return;if(w){const Rt=Cn(pt,"sessions",w.id);await bi(Rt,{isOpen:!1}),C(null)}const Re=Math.floor(1e5+Math.random()*9e5),Fe=String(Re),ke=Kn(pt,"sessions"),be=Vn.now(),vt={id:(await xd(ke,{timeId:ge.id,name:ge.name,category:ge.category,term:ge.term,code:Fe,teacherId:s.uid,teacherName:s.displayName,teacherEmail:s.email,createdAt:be,isOpen:!0,openedAt:be})).id,timeId:ge.id,name:ge.name,category:ge.category,term:ge.term,code:Fe,teacherId:s.uid,createdAt:be,isOpen:!0,openedAt:be};C(vt),pe()},xt=async De=>{b(De.name),se(!1),await st(De.id),We.current&&We.current.blur()},kt=async De=>{u(De.term),b(De.name),se(!1);let ge;try{const Re=ui(Kn(pt,"sessions"),Ar("teacherId","==",s.uid),Ar("timeId","==",De.timeId),Qx("createdAt","desc"),Zx(1));ge=(await dr(Re)).docs[0]}catch{try{const Fe=ui(Kn(pt,"sessions"),Ar("teacherId","==",s.uid));ge=(await dr(Fe)).docs.filter(Pt=>String(Pt.data()?.timeId??"")===String(De.timeId)).sort((Pt,vt)=>{const Rt=Pt.data()?.createdAt?.toMillis?.()??0;return(vt.data()?.createdAt?.toMillis?.()??0)-Rt})[0]}catch{}}if(ge){const Re=ge.data();if(w&&w.id!==ge.id){try{await bi(Cn(pt,"sessions",w.id),{isOpen:!1})}catch{}C(null)}const Fe=Vn.now();try{await bi(Cn(pt,"sessions",ge.id),{isOpen:!0,openedAt:Fe})}catch{}const ke={id:ge.id,timeId:String(Re.timeId??De.timeId),name:String(Re.name??De.name),category:String(Re.category??""),term:typeof Re.term=="number"?Re.term:Number(Re.term)||De.term,code:String(Re.code??""),teacherId:String(Re.teacherId??s.uid),createdAt:Re.createdAt??Vn.now(),isOpen:!0,openedAt:Fe};C(ke),Y(120);return}await st(De.timeId)},cn=async()=>{if(!w)return;const De=Cn(pt,"sessions",w.id);if(!w.isOpen){const Re=Vn.now();await bi(De,{isOpen:!0,openedAt:Re}),C({...w,isOpen:!0,openedAt:Re}),Y(120)}else await bi(De,{isOpen:!1}),C({...w,isOpen:!1})};oe.useEffect(()=>{if(!w)return;const De=Cn(pt,"sessions",w.id),ge=eE(De,Re=>{if(!Re.exists())return;const Fe=Re.data();C(ke=>ke&&ke.id===Re.id?{...ke,isOpen:Fe?.isOpen??ke.isOpen,openedAt:Fe?.openedAt??ke.openedAt}:ke)});return()=>ge()},[w?.id]),oe.useEffect(()=>{if(!w||!w.isOpen||!w.openedAt){Y(0);return}const De=w.openedAt.toMillis(),ge=async()=>{const Fe=Date.now(),ke=Math.floor((Fe-De)/1e3),be=Math.max(0,60-ke);if(Y(be),be===0&&w.isOpen)try{await bi(Cn(pt,"sessions",w.id),{isOpen:!1}),C({...w,isOpen:!1})}catch{}};ge();const Re=setInterval(ge,1e3);return()=>clearInterval(Re)},[w?.id,w?.isOpen,w?.openedAt]);const en=De=>{const ge=Math.floor(De/60).toString().padStart(2,"0"),Re=Math.floor(De%60).toString().padStart(2,"0");return`${ge}:${Re}`},En=async De=>{if(w)try{const ge=Cn(pt,"sessions",w.id,"attendance",De.id);if((await Fa(ge)).exists()){Ct.error("Studenten er allerede registrert p denne kten.");return}await hl(ge,{userId:De.id,studentName:De.name??null,studentEmail:De.email,createdAt:Vn.now(),status:"present",addedManually:!0,addedBy:s.uid}),Ze(""),z(!1)}catch(ge){console.error(ge),Ct.error("Kunne ikke legge til student manuelt.")}},Lt=De=>{J({open:!0,attendee:De})},hn=()=>{J({open:!1,attendee:null})},wn=async()=>{if(!w||!U.attendee)return;const De=U.attendee;try{await X_(Cn(pt,"sessions",w.id,"attendance",De.id)),Ct.success("Student fjernet fra kten.")}catch(ge){console.error(ge),Ct.error("Kunne ikke fjerne studenten.")}finally{hn()}};return L?I.jsx("div",{className:"page-card page-card--teacher",children:I.jsx(lc,{})}):I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"page-card page-card--teacher",children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[I.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[I.jsx("button",{className:"btn-hover-lg",type:"button",onClick:()=>$(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),I.jsx("button",{className:"btn-hover-lg",onClick:ot,type:"button",style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),I.jsx("h2",{style:{textAlign:"center",margin:"4rem 0 3rem"},children:"Registrer oppmte"}),I.jsxs("section",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",alignItems:"center"},children:[I.jsx("div",{style:{marginBottom:"1.25rem",width:"100%",maxWidth:520},children:(()=>{const De=g!==null?new Set(g??[]):null,ge=De?qe.filter(Re=>De.has(Re.value)):qe;return ge.length===0?I.jsx("div",{style:{width:"100%",padding:"0.6rem 0",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"0.5rem",background:"#f9fafb",color:"#6b7280",textAlign:"center"},children:"Ingen terminer tilgjengelig"}):I.jsxs("select",{value:o??"",onChange:Re=>{const Fe=Re.target.value,ke=Fe===""?null:parseInt(Fe,10);u(ke),b(""),se(!1),C(null),P([]),ke!=null&&setTimeout(()=>{We.current?.focus()},0)},style:{width:"100%",padding:"0.6rem 0.75rem",fontSize:"16px",textAlign:"center",borderRadius:"0.5rem",border:"solid 1px"},children:[I.jsx("option",{value:"",disabled:!0,children:"Velg modul"}),ge.map(Re=>I.jsx("option",{value:Re.value,children:Re.label},Re.value))]})})()}),I.jsxs("div",{style:{position:"relative",marginBottom:"0.75rem",width:"100%",maxWidth:520},children:[I.jsx("input",{ref:We,value:T,onChange:De=>{b(De.target.value),se(!0)},onFocus:()=>{o&&T.trim().length>0&&se(!0)},placeholder:o?"Start  skrive navnet p timen...":"Velg modul frst",disabled:!o,style:{width:"100%",padding:"0.6rem 0rem",fontSize:"16px",textAlign:"center",borderRadius:"0.5rem",border:"solid 1px",opacity:o?1:.6}}),re&&nt.length>0&&I.jsx("ul",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",marginTop:"0.2rem",listStyle:"none",padding:0,maxHeight:"220px",overflowY:"auto",boxShadow:"0 10px 20px rgba(0,0,0,0.08)"},children:nt.map(De=>I.jsxs("li",{onClick:()=>xt(De),style:{padding:"0.4rem 0.6rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseDown:ge=>ge.preventDefault(),children:[I.jsx("div",{children:De.name}),I.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:De.category})]},De.id))})]})]}),!w&&G.length>0&&I.jsx("section",{style:{marginTop:"1.5rem",display:"flex",flexDirection:"column",alignItems:"center"},children:I.jsxs("div",{style:{width:"100%",maxWidth:520},children:[I.jsx("h4",{style:{textAlign:"center",marginTop:0},children:"Nylig registrerte timer"}),I.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:G.map(De=>I.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid #f3f4f6"},children:[I.jsxs("div",{children:[I.jsx("div",{style:{fontWeight:600},children:De.name}),I.jsxs("div",{style:{fontSize:"0.8rem",color:"#6b7280"},children:[De.category,"  ",La(qe,De.term)]})]}),I.jsx("button",{type:"button",onClick:()=>void kt(De),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"none",background:"#6CE1AB",color:"black",cursor:"pointer"},children:"pne"})]},De.timeId))})]})})]}),I.jsx("br",{}),I.jsx("div",{className:"page-card page-card--session",style:{display:w?void 0:"none"},children:w&&I.jsxs("section",{ref:Ee,style:{marginTop:"2rem",padding:"1rem",background:"#f9fafb"},children:[I.jsxs("div",{style:{textAlign:"center"},children:[I.jsx("h3",{style:{marginTop:0,marginBottom:"0.25rem"},children:La(qe,w.term)}),I.jsxs("p",{style:{margin:0},children:[I.jsx("strong",{children:"Time:"})," ",w.name]}),I.jsxs("p",{style:{marginTop:"0.2rem"},children:[I.jsx("strong",{children:"Gruppe:"})," ",w.category]})]}),I.jsxs("div",{style:{marginTop:"1rem",position:"relative"},children:[I.jsxs("div",{style:{filter:w.isOpen===!1?"blur(6px)":"none",pointerEvents:"none",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[I.jsx(uA,{value:w.code,size:160,bgColor:"#f9fafb",includeMargin:!0}),I.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",letterSpacing:"0.3em"},children:w.code})]}),w.isOpen===!1&&I.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center"},children:I.jsx("div",{style:{background:"rgba(255,255,255,0.85)",padding:"0.5rem 0.75rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb",fontWeight:600,color:"#6b7280"},children:"kten er lukket"})})]}),I.jsxs("div",{style:{marginTop:"1.5rem"},children:[I.jsx("h4",{style:{textAlign:"center",marginBottom:"0.3rem"},children:"Legg til student manuelt"}),I.jsx("p",{style:{fontSize:"0.8rem",color:"#6b7280",textAlign:"center",marginTop:0,marginBottom:"0.5rem"},children:"Brukes dersom en student ikke kan skanne eller skrive inn kode."}),le&&I.jsx("div",{style:{display:"flex",justifyContent:"center"},children:I.jsx(lc,{})}),I.jsxs("div",{style:{position:"relative",maxWidth:"360px",margin:"0 auto"},children:[I.jsx("input",{value:dt,onChange:De=>{Ze(De.target.value),z(!0)},onFocus:()=>{dt.trim().length>0&&z(!0)},placeholder:le?"Laster studenter...":"Sk p navn, e-post eller telefon",disabled:le,style:{width:"100%",padding:"0.6rem 0.75rem",fontSize:"16px",borderRadius:"0.5rem",border:"1px solid #d1d5db",textAlign:"center"}}),F&&ve.length>0&&I.jsx("ul",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:20,background:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",marginTop:"0.2rem",listStyle:"none",padding:0,maxHeight:"220px",overflowY:"auto",boxShadow:"0 10px 20px rgba(0,0,0,0.08)"},children:ve.map(De=>I.jsxs("li",{onClick:()=>En(De),style:{padding:"0.4rem 0.6rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseDown:ge=>ge.preventDefault(),children:[I.jsx("div",{children:De.name||"(Uten navn)"}),I.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[De.email,De.phone?`  ${De.phone}`:""]})]},De.id))})]})]}),I.jsxs("div",{style:{marginTop:"1.2rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[I.jsx("div",{style:{fontWeight:600,color:"#111827"},children:en(X)}),I.jsx("button",{onClick:cn,style:{padding:"0.5rem 1.2rem",borderRadius:"999px",border:"none",background:(w.isOpen===!1,"#6CE1AB"),color:"black",fontWeight:500,cursor:"pointer"},children:w.isOpen===!1?"pne kta":"Lukk kt"})]}),I.jsx("hr",{style:{margin:"1rem 0"}}),I.jsx("h4",{children:"Registrerte studenter"}),R.length===0?I.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen har registrert seg enn."}):I.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Navn"}),I.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"E-post"}),I.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Tidspunkt"}),I.jsx("th",{style:{textAlign:"right",borderBottom:"1px solid #e5e7eb",padding:"0.3rem",width:40}})]})}),I.jsx("tbody",{children:R.map(De=>I.jsxs("tr",{children:[I.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6"},children:De.studentName||"-"}),I.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6"},children:De.studentEmail||"-"}),I.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6",fontSize:"0.8rem",color:"#6b7280"},children:De.createdAt?new Date(De.createdAt.toMillis()).toLocaleTimeString("no-NO",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}),I.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:I.jsx("button",{type:"button",onClick:()=>Lt(De),"aria-label":"Fjern student fra kten",title:"Fjern student",style:{background:"transparent",border:"none",cursor:"pointer",color:"#b91c1c",padding:"0.15rem"},children:I.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[I.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),I.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})})]},De.id))})]})]})}),U.open&&U.attendee&&I.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:I.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff",textAlign:"center"},children:[I.jsx("h3",{style:{marginTop:0},children:"Fjerne student?"}),I.jsx("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:(()=>{const De=U.attendee;return`Du er i ferd med  fjerne ${De.studentName||De.studentEmail||"denne studenten"} fra denne kten.`})()}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",marginTop:"0.75rem"},children:[I.jsx("button",{className:"button",type:"button",onClick:hn,style:{background:"#ef4444",color:"#ffffff"},children:"Avbryt"}),I.jsx("button",{type:"button",onClick:()=>void wn(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Fjern student"})]})]})}),Q&&I.jsx(om,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>$(!1)})]})}const ER="type.googleapis.com/google.protobuf.Int64Value",wR="type.googleapis.com/google.protobuf.UInt64Value";function hA(s,e){const t={};for(const o in s)s.hasOwnProperty(o)&&(t[o]=e(s[o]));return t}function Gd(s){if(s==null)return null;if(s instanceof Number&&(s=s.valueOf()),typeof s=="number"&&isFinite(s)||s===!0||s===!1||Object.prototype.toString.call(s)==="[object String]")return s;if(s instanceof Date)return s.toISOString();if(Array.isArray(s))return s.map(e=>Gd(e));if(typeof s=="function"||typeof s=="object")return hA(s,e=>Gd(e));throw new Error("Data cannot be encoded in JSON: "+s)}function pc(s){if(s==null)return s;if(s["@type"])switch(s["@type"]){case ER:case wR:{const e=Number(s.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+s);return e}default:throw new Error("Data cannot be decoded from JSON: "+s)}return Array.isArray(s)?s.map(e=>pc(e)):typeof s=="function"||typeof s=="object"?hA(s,e=>pc(e)):s}const lm="functions";const yE={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Wi extends na{constructor(e,t,o){super(`${lm}/${e}`,t||""),this.details=o,Object.setPrototypeOf(this,Wi.prototype)}}function _R(s){if(s>=200&&s<300)return"ok";switch(s){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function qd(s,e){let t=_R(s),o=t,u;try{const g=e&&e.error;if(g){const x=g.status;if(typeof x=="string"){if(!yE[x])return new Wi("internal","internal");t=yE[x],o=x}const T=g.message;typeof T=="string"&&(o=T),u=g.details,u!==void 0&&(u=pc(u))}}catch{}return t==="ok"?null:new Wi(t,o,u)}class AR{constructor(e,t,o,u){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,cs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=o.getImmediate({optional:!0}),this.auth||t.get().then(g=>this.auth=g,()=>{}),this.messaging||o.get().then(g=>this.messaging=g,()=>{}),this.appCheck||u?.get().then(g=>this.appCheck=g,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),o=await this.getMessagingToken(),u=await this.getAppCheckToken(e);return{authToken:t,messagingToken:o,appCheckToken:u}}}const ig="us-central1",bR=/^data: (.*?)(?:\n|$)/;function vR(s){let e=null;return{promise:new Promise((t,o)=>{e=setTimeout(()=>{o(new Wi("deadline-exceeded","deadline-exceeded"))},s)}),cancel:()=>{e&&clearTimeout(e)}}}class TR{constructor(e,t,o,u,g=ig,x=(...T)=>fetch(...T)){this.app=e,this.fetchImpl=x,this.emulatorOrigin=null,this.contextProvider=new AR(e,t,o,u),this.cancelAllRequests=new Promise(T=>{this.deleteService=()=>Promise.resolve(T())});try{const T=new URL(g);this.customDomain=T.origin+(T.pathname==="/"?"":T.pathname),this.region=ig}catch{this.customDomain=null,this.region=g}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function CR(s,e,t){const o=Vo(e);s.emulatorOrigin=`http${o?"s":""}://${e}:${t}`,o&&(ag(s.emulatorOrigin+"/backends"),og("Functions",!0))}function SR(s,e,t){const o=u=>RR(s,e,u,{});return o.stream=(u,g)=>OR(s,e,u,g),o}function dA(s){return s.emulatorOrigin&&Vo(s.emulatorOrigin)?"include":void 0}async function IR(s,e,t,o,u){t["Content-Type"]="application/json";let g;try{g=await o(s,{method:"POST",body:JSON.stringify(e),headers:t,credentials:dA(u)})}catch{return{status:0,json:null}}let x=null;try{x=await g.json()}catch{}return{status:g.status,json:x}}async function fA(s,e){const t={},o=await s.contextProvider.getContext(e.limitedUseAppCheckTokens);return o.authToken&&(t.Authorization="Bearer "+o.authToken),o.messagingToken&&(t["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=o.appCheckToken),t}function RR(s,e,t,o){const u=s._url(e);return NR(s,u,t,o)}async function NR(s,e,t,o){t=Gd(t);const u={data:t},g=await fA(s,o),x=o.timeout||7e4,T=vR(x),b=await Promise.race([IR(e,u,g,s.fetchImpl,s),T.promise,s.cancelAllRequests]);if(T.cancel(),!b)throw new Wi("cancelled","Firebase Functions instance was deleted.");const w=qd(b.status,b.json);if(w)throw w;if(!b.json)throw new Wi("internal","Response is not valid JSON object.");let C=b.json.data;if(typeof C>"u"&&(C=b.json.result),typeof C>"u")throw new Wi("internal","Response is missing data field.");return{data:pc(C)}}function OR(s,e,t,o){const u=s._url(e);return DR(s,u,t,o||{})}async function DR(s,e,t,o){t=Gd(t);const u={data:t},g=await fA(s,o);g["Content-Type"]="application/json",g.Accept="text/event-stream";let x;try{x=await s.fetchImpl(e,{method:"POST",body:JSON.stringify(u),headers:g,signal:o?.signal,credentials:dA(s)})}catch(P){if(P instanceof Error&&P.name==="AbortError"){const ee=new Wi("cancelled","Request was cancelled.");return{data:Promise.reject(ee),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(ee)}}}}}}const L=qd(0,null);return{data:Promise.reject(L),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(L)}}}}}}let T,b;const w=new Promise((P,L)=>{T=P,b=L});o?.signal?.addEventListener("abort",()=>{const P=new Wi("cancelled","Request was cancelled.");b(P)});const C=x.body.getReader(),R=MR(C,T,b,o?.signal);return{stream:{[Symbol.asyncIterator](){const P=R.getReader();return{async next(){const{value:L,done:ee}=await P.read();return{value:L,done:ee}},async return(){return await P.cancel(),{done:!0,value:void 0}}}}},data:w}}function MR(s,e,t,o){const u=(x,T)=>{const b=x.match(bR);if(!b)return;const w=b[1];try{const C=JSON.parse(w);if("result"in C){e(pc(C.result));return}if("message"in C){T.enqueue(pc(C.message));return}if("error"in C){const R=qd(0,C);T.error(R),t(R);return}}catch(C){if(C instanceof Wi){T.error(C),t(C);return}}},g=new TextDecoder;return new ReadableStream({start(x){let T="";return b();async function b(){if(o?.aborted){const w=new Wi("cancelled","Request was cancelled");return x.error(w),t(w),Promise.resolve()}try{const{value:w,done:C}=await s.read();if(C){T.trim()&&u(T.trim(),x),x.close();return}if(o?.aborted){const P=new Wi("cancelled","Request was cancelled");x.error(P),t(P),await s.cancel();return}T+=g.decode(w,{stream:!0});const R=T.split(`
`);T=R.pop()||"";for(const P of R)P.trim()&&u(P.trim(),x);return b()}catch(w){const C=w instanceof Wi?w:qd(0,null);x.error(C),t(C)}}},cancel(){return s.cancel()}})}const xE="@firebase/functions",EE="0.13.1";const kR="auth-internal",LR="app-check-internal",PR="messaging-internal";function BR(s){const e=(t,{instanceIdentifier:o})=>{const u=t.getProvider("app").getImmediate(),g=t.getProvider(kR),x=t.getProvider(PR),T=t.getProvider(LR);return new TR(u,g,x,T,o)};fl(new Oo(lm,e,"PUBLIC").setMultipleInstances(!0)),Ys(xE,EE,s),Ys(xE,EE,"esm2020")}function C1(s=Wd(),e=ig){const o=Kd(ir(s),lm).getImmediate({identifier:e}),u=SE("functions");return u&&VR(o,...u),o}function VR(s,e,t){CR(ir(s),e,t)}function S1(s,e,t){return SR(ir(s),e)}BR();function wE(s){const e=s.match(/^\s*(\d+)/);return e?parseInt(e[1],10):Number.POSITIVE_INFINITY}function I1(){const s="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$";let e="";for(let t=0;t<12;t++)e+=s[Math.floor(Math.random()*s.length)];return e}const UR=()=>{const{user:s}=bc(),[e,t]=oe.useState([]),[o,u]=oe.useState(!0),[g,x]=oe.useState(""),[T,b]=oe.useState("students"),[w,C]=oe.useState("all"),[R,P]=oe.useState("name"),[L,ee]=oe.useState("asc"),[re,se]=oe.useState("all"),[Ye,Oe]=oe.useState("name"),[le,Ue]=oe.useState("asc"),[dt,Ze]=oe.useState("all"),[F,z]=oe.useState("name"),[U,J]=oe.useState("asc"),[X,Y]=oe.useState([]),G=oe.useMemo(()=>X.slice().sort((K,Se)=>(K.order??K.value)-(Se.order??Se.value)).map(K=>({value:K.value,label:K.label||`Termin ${K.value}`})),[X]),[at,ce]=oe.useState(null),[ue,Ee]=oe.useState(null);oe.useEffect(()=>{(async()=>{try{if(!s?.uid)return;const Se=Cn(pt,"users",s.uid),$e=await Fa(Se),mt=$e.exists()?$e.data():null,lt=(Array.isArray(mt?.allowedTerms)?mt.allowedTerms:[]).map(ht=>typeof ht=="number"?ht:parseInt(String(ht),10)).filter(ht=>!Number.isNaN(ht));ce(lt),Ee(!!mt?.isSuperAdmin)}catch(Se){console.warn("Kunne ikke hente allowedTerms for innlogget admin:",Se),ce([]),Ee(!1)}})()},[s?.uid]);const We=oe.useMemo(()=>{if(ue===!0||at===null)return G;const K=new Set(at);return G.filter(Se=>K.has(Se.value))},[G,at,ue]),qe=oe.useMemo(()=>{if(ue)return null;const K=at;return Array.isArray(K)&&K.length===1?Number(K[0]):null},[ue,at]);oe.useEffect(()=>{qe!=null&&(w==="all"&&C(qe),re==="all"&&se(qe))},[qe]),oe.useEffect(()=>{(async()=>{try{const $e=(await dr(Kn(pt,"terms"))).docs.map(mt=>{const tt=mt.data(),lt=typeof tt?.value=="number"?tt.value:void 0;if(typeof lt!="number")return null;const ht=typeof tt?.label=="string"?tt.label:"",dn=typeof tt?.order=="number"?tt.order:void 0;return{value:lt,label:ht,order:dn}}).filter(Boolean);$e.sort((mt,tt)=>(mt.order??mt.value)-(tt.order??tt.value)),Y($e)}catch(Se){console.warn("Kunne ikke laste terminer fra Firestore for admin-brukerpanel:",Se)}})()},[]);const[ot,Q]=oe.useState(null),[$,pe]=oe.useState(null),[Te,nt]=oe.useState(""),[ve,st]=oe.useState(""),[xt,kt]=oe.useState(""),[cn,en]=oe.useState("teacher"),[En,Lt]=oe.useState([]),[hn,wn]=oe.useState(null),[De,ge]=oe.useState(null),[Re,Fe]=oe.useState(""),[ke,be]=oe.useState(""),[Pt,vt]=oe.useState(""),[Rt,Fn]=oe.useState("student"),[Xt,yr]=oe.useState(null),[xr,or]=oe.useState(null),[Zr,Ti]=oe.useState({}),ki=(K,Se)=>{if(K&&Se!=null)return Zr[K]?.[Se]},tn=async(K,Se)=>{if(!(!K||Se==null)&&Zr[K]?.[Se]===void 0)try{const $e=Cn(pt,"users",K,"books",String(Se)),mt=await Fa($e),tt=mt.exists()?{approved:!!mt.data().approved,approvedAt:mt.data().approvedAt??null}:{approved:!1,approvedAt:null};Ti(lt=>({...lt,[K]:{...lt[K]??{},[Se]:tt}}))}catch($e){console.error("Kunne ikke laste godkjenning for bok:",$e)}},ze=({uid:K,term:Se})=>{const $e=ki(K,Se);if(oe.useEffect(()=>{$e===void 0&&tn(K,Se)},[K,Se,$e]),!$e)return I.jsx("span",{style:{color:"#9ca3af"},children:""});if($e.approved){const mt=$e.approvedAt,tt=mt?new Date(mt.toDate()).toLocaleString("nb-NO"):void 0;return I.jsx("span",{title:tt,style:{color:"#16a34a",fontSize:"1rem"},children:""})}return I.jsx("span",{style:{color:"#9ca3af"},children:""})},[zt,wt]=oe.useState(null),[_n,vr]=oe.useState(null),[Xr,Tr]=oe.useState(""),[Bt,Qt]=oe.useState(""),[jn,Mr]=oe.useState(""),[ut,nn]=oe.useState("admin"),[ie,Ie]=oe.useState([]);oe.useEffect(()=>{(async()=>{try{u(!0);const $e=(await dr(Kn(pt,"users"))).docs.map(mt=>{const tt=mt.data();return{docId:mt.id,email:tt.email??"",displayName:tt.name??tt.displayName??tt.email??"(uten navn)",role:tt.role??"student",term:tt.term??null,phone:tt.phone??null,allowedTerms:tt.allowedTerms??[]}});$e.sort((mt,tt)=>mt.displayName.localeCompare(tt.displayName,"nb-NO",{sensitivity:"base"})),t($e)}catch(Se){console.error("Feil ved lasting av brukere:",Se),t([])}finally{u(!1)}})()},[]);const He=oe.useMemo(()=>{const K=g.trim().toLowerCase();if(!K)return e;const Se=K.includes("@");return e.filter($e=>{const mt=String($e.displayName??"").toLowerCase(),tt=String($e.email??"").toLowerCase(),lt=Se?tt:tt.split("@")[0]??tt,ht=String($e.phone??"").toLowerCase();return`${mt} ${lt} ${ht}`.includes(K)})},[e,g]);let Xe=He.filter(K=>K.role==="teacher"),rt=He.filter(K=>K.role==="student"),ft=He.filter(K=>K.role==="admin");const it=(()=>{if(ue)return{teachers:Xe,students:rt,admins:ft};const K=at;if(!(Array.isArray(K)&&K.length>0))return{teachers:Xe,students:rt,admins:ft};const $e=new Set(K),mt=Xe.filter(ht=>(ht.allowedTerms??[]).some(dn=>$e.has(Number(dn)))),tt=rt.filter(ht=>ht.term!=null&&$e.has(Number(ht.term)));return{teachers:mt,students:tt,admins:ft}})();if(Xe=it.teachers,rt=it.students,ft=it.admins,w!=="all"){const K=w;Xe=Xe.filter(Se=>(Se.allowedTerms??[]).includes(K))}if(re!=="all"){const K=re;rt=rt.filter(Se=>Se.term===K)}if(dt!=="all"){const K=dt;ft=ft.filter(Se=>(Se.allowedTerms??[]).includes(K))}Xe.sort((K,Se)=>{const $e=lt=>R==="name"?lt.displayName??"":R==="email"?lt.email??"":lt.phone??"",mt=String($e(K)??"").toLowerCase(),tt=String($e(Se)??"").toLowerCase();return mt<tt?L==="asc"?-1:1:mt>tt?L==="asc"?1:-1:0}),rt.sort((K,Se)=>{const $e=lt=>Ye==="name"?lt.displayName??"":Ye==="email"?lt.email??"":lt.phone??"",mt=String($e(K)??"").toLowerCase(),tt=String($e(Se)??"").toLowerCase();return mt<tt?le==="asc"?-1:1:mt>tt?le==="asc"?1:-1:0}),ft.sort((K,Se)=>{const $e=lt=>F==="name"?lt.displayName??"":F==="email"?lt.email??"":lt.phone??"",mt=String($e(K)??"").toLowerCase(),tt=String($e(Se)??"").toLowerCase();return mt<tt?U==="asc"?-1:1:mt>tt?U==="asc"?1:-1:0}),Xe=Xe.slice(0,50),rt=rt.slice(0,50),ft=ft.slice(0,50);const Ht=K=>{P(Se=>Se===K?(ee($e=>$e==="asc"?"desc":"asc"),Se):(ee("asc"),K))},St=K=>{Oe(Se=>Se===K?(Ue($e=>$e==="asc"?"desc":"asc"),Se):(Ue("asc"),K))},Vt=K=>{z(Se=>Se===K?(J($e=>$e==="asc"?"desc":"asc"),Se):(J("asc"),K))},Me=()=>{Q("create"),pe(null),nt(""),st(""),kt(""),en("teacher"),Lt(qe!=null?[qe]:[])},sn=async()=>{const K=ve.trim(),Se=Te.trim(),$e=xt.trim();if(!K){Ct.error("E-post m fylles ut for  opprette lrer.");return}if(!En||En.length===0){Ct.error("Velg minst n termin lreren kan registrere for.");return}try{const mt=I1(),lt=(await cd(T1,K,mt)).user.uid,ht={uid:lt,email:K,displayName:Se||K,name:Se||K,role:"teacher",term:null,phone:$e||null,allowedTerms:En};await hl(Cn(pt,"users",lt),ht,{merge:!0}),t(dn=>{const fn=[{docId:lt,email:K,displayName:ht.displayName,role:"teacher",term:null,phone:$e||null,allowedTerms:[...En]},...dn];return fn.sort((Rn,Ft)=>Rn.displayName.localeCompare(Ft.displayName,"nb-NO",{sensitivity:"base"})),fn}),Q(null),pe(null),Ct.success("Ny lrer opprettet",{description:`Epost: ${K}
Midlertidig passord: ${mt}
Gi passordet videre og be om passordbytte etter frste innlogging.`,duration:15e3})}catch(mt){if(console.error("Feil ved oppretting av lrer:",mt),mt?.code==="auth/email-already-in-use")try{const tt=ui(Kn(pt,"users"),Ar("email","==",K)),lt=await dr(tt);if(lt.empty){Ct.error("Eposten finnes allerede i Auth, men fant ingen bruker i Firestore. Kontakt administrator.");return}const ht=lt.docs[0],dn=ht.data(),fn=Array.isArray(dn?.allowedTerms)?dn.allowedTerms.map(kn=>typeof kn=="number"?kn:parseInt(String(kn),10)).filter(kn=>!Number.isNaN(kn)):[],Rn=new Set([...fn,...En]),Ft=Array.from(Rn);await bi(Cn(pt,"users",ht.id),{role:"teacher",allowedTerms:Ft,displayName:Se||dn?.displayName||dn?.name||K,name:Se||dn?.name||dn?.displayName||K,phone:$e||dn?.phone||null}),t(kn=>{const Pi=kn.findIndex(Cr=>Cr.docId===ht.id),It={docId:ht.id,email:K,displayName:Se||(dn?.displayName??dn?.name??K),role:"teacher",term:null,phone:$e||dn?.phone||null,allowedTerms:Ft};if(Pi>=0){const Cr=kn.slice();return Cr[Pi]={...Cr[Pi],...It},Cr}const er=[It,...kn];return er.sort((Cr,gi)=>(Cr.displayName??"").localeCompare(gi.displayName??"","nb-NO",{sensitivity:"base"})),er}),Q(null),pe(null),Ct.success("Eksisterende bruker oppdatert som lrer og tildelt valgte terminer.")}catch(tt){console.error("Kunne ikke oppdatere eksisterende lrer:",tt),Ct.error("Kunne ikke oppdatere eksisterende bruker med nye terminer.")}else Ct.error("Kunne ikke opprette lrer. Se console for mer info.")}},gt=K=>{Q("edit"),pe(K),nt(K.displayName),st(K.email),kt(K.phone??""),en(K.role),Lt(K.allowedTerms??[])},Ot=async()=>{if(!$)return;const K=$.docId;try{if(ve.trim()&&ve.trim()!==($.email||""))try{const $e=C1(void 0,"europe-west1");await S1($e,"adminUpdateUserEmail")({uid:K,newEmail:ve.trim()})}catch($e){console.error("adminUpdateUserEmail failed",$e),Ct.error("Kunne ikke oppdatere lrerens epost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const Se=Cn(pt,"users",K);await bi(Se,{displayName:Te,email:ve,phone:xt||null,role:cn,allowedTerms:En}),t($e=>$e.map(mt=>mt.docId===K?{...mt,displayName:Te,email:ve,phone:xt||null,role:cn,allowedTerms:[...En]}:mt)),Q(null),pe(null)}catch(Se){console.error("Feil ved lagring av lrer:",Se),Ct.error("Kunne ikke lagre endringer for lrer.")}},$n=()=>{Q(null),pe(null)},fi=K=>{Lt(Se=>Se.includes(K)?Se.filter($e=>$e!==K):[...Se,K])},Ps=()=>{wn("create"),ge(null),Fe(""),be(""),vt(""),Fn("student"),yr(qe??null)},ri=async()=>{const K=ke.trim(),Se=Re.trim(),$e=Pt.trim();if(!Se){Ct.error("Navn m fylles ut for  opprette student.");return}if(!K){Ct.error("E-post m fylles ut for  opprette student.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(K)){Ct.error("Ugyldig epost.");return}if(Xt==null){Ct.error("Velg termin studenten tilhrer.");return}try{const tt=I1(),ht=(await cd(T1,K,tt)).user.uid,dn={uid:ht,email:K,displayName:Se||K,name:Se||K,role:"student",term:Xt,phone:$e||null,allowedTerms:[]};await hl(Cn(pt,"users",ht),dn,{merge:!0}),t(fn=>{const Rn=[{docId:ht,email:K,displayName:dn.displayName,role:"student",term:Xt,phone:$e||null,allowedTerms:[]},...fn];return Rn.sort((Ft,kn)=>Ft.displayName.localeCompare(kn.displayName,"nb-NO",{sensitivity:"base"})),Rn}),wn(null),ge(null),Ct.success(`Ny student med epost ${K} er opprettet.`,{description:"Be studenten trykke Glemt passord p innloggingssiden for  lage sitt eget passord.",duration:12e3})}catch(tt){if(console.error("Feil ved oppretting av student:",tt),tt?.code==="auth/invalid-email")Ct.error("Ugyldig epost.");else if(tt?.code==="auth/email-already-in-use")try{const lt=ui(Kn(pt,"users"),Ar("email","==",K)),ht=await dr(lt);if(ht.empty){Ct.error("Eposten finnes allerede i Auth, men fant ingen bruker i Firestore. Kontakt administrator.");return}const dn=ht.docs[0],fn=dn.data();await bi(Cn(pt,"users",dn.id),{role:"student",term:Xt,displayName:Se||fn?.displayName||fn?.name||K,name:Se||fn?.name||fn?.displayName||K,phone:$e||fn?.phone||null}),t(Ft=>{const kn=Ft.findIndex(er=>er.docId===dn.id),Pi={docId:dn.id,email:K,displayName:Se||(fn?.displayName??fn?.name??K),role:"student",term:Xt,phone:$e||fn?.phone||null,allowedTerms:Array.isArray(fn?.allowedTerms)?fn.allowedTerms:[]};if(kn>=0){const er=Ft.slice();return er[kn]={...er[kn],...Pi},er}const It=[Pi,...Ft];return It.sort((er,Cr)=>(er.displayName??"").localeCompare(Cr.displayName??"","nb-NO",{sensitivity:"base"})),It}),wn(null),ge(null);const Rn=gE(G,Xt);Ct.success(`Eksisterende bruker oppdatert til termin ${Rn}.`)}catch(lt){console.error("Kunne ikke oppdatere eksisterende student:",lt),Ct.error("Kunne ikke oppdatere eksisterende bruker med valgt termin.")}else tt?.code==="auth/missing-email"?Ct.error("Epost mangler."):Ct.error("Kunne ikke opprette student. Prv igjen senere.")}},Ha=K=>{wn("edit"),ge(K),Fe(K.displayName),be(K.email),vt(K.phone??""),Fn(K.role),yr(K.term??null)},Li=async()=>{if(!De)return;const K=De.docId;try{if(ke.trim()&&ke.trim()!==(De.email||""))try{const $e=C1(void 0,"europe-west1");await S1($e,"adminUpdateUserEmail")({uid:K,newEmail:ke.trim()})}catch($e){console.error("adminUpdateUserEmail failed",$e),Ct.error("Kunne ikke oppdatere studentens epost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const Se=Cn(pt,"users",K);await bi(Se,{displayName:Re,email:ke,phone:Pt||null,role:Rt,term:Xt??null}),t($e=>$e.map(mt=>mt.docId===K?{...mt,displayName:Re,email:ke,phone:Pt||null,role:Rt,term:Xt??null}:mt)),wn(null),ge(null)}catch(Se){console.error("Feil ved lagring av student:",Se),Ct.error("Kunne ikke lagre endringer for student.")}},Yr=()=>{wn(null),ge(null)},Wn=()=>{wt("create"),vr(null),Tr(""),Qt(""),Mr(""),nn("admin"),Ie([])},un=async()=>{const K=Bt.trim(),Se=Xr.trim(),$e=jn.trim();if(!K){Ct.error("E-post m fylles ut for  opprette admin.");return}if(!$e){Ct.error("Mobilnummer m fylles ut for  opprette admin.");return}if(!ie||ie.length===0){Ct.error("Velg minst n termin administratoren skal ha tilgang til.");return}try{const mt=I1(),lt=(await cd(T1,K,mt)).user.uid,ht={uid:lt,email:K,displayName:Se||K,name:Se||K,role:"admin",term:null,phone:$e,allowedTerms:ie};await hl(Cn(pt,"users",lt),ht,{merge:!0}),t(dn=>{const fn=[{docId:lt,email:K,displayName:ht.displayName,role:"admin",term:null,phone:$e,allowedTerms:[...ie]},...dn];return fn.sort((Rn,Ft)=>Rn.displayName.localeCompare(Ft.displayName,"nb-NO",{sensitivity:"base"})),fn}),wt(null),vr(null),Ct.success("Ny admin opprettet",{description:`Epost: ${K}
Midlertidig passord: ${mt}
Gi passordet videre og be om passordbytte etter frste innlogging.`,duration:15e3})}catch(mt){console.error("Feil ved oppretting av admin:",mt),mt?.code==="auth/email-already-in-use"?Ct.error("E-posten er allerede i bruk i Auth. Bruk en annen eller koble eksisterende bruker."):Ct.error("Kunne ikke opprette admin. Se console for mer info.")}},Jr=K=>{wt("edit"),vr(K),Tr(K.displayName),Qt(K.email),Mr(K.phone??""),nn(K.role),Ie(K.allowedTerms??[])},kr=async()=>{if(!_n)return;const K=_n.docId;try{if(Bt.trim()&&Bt.trim()!==(_n.email||""))try{const $e=C1(void 0,"europe-west1");await S1($e,"adminUpdateUserEmail")({uid:K,newEmail:Bt.trim()})}catch($e){console.error("adminUpdateUserEmail failed",$e),Ct.error("Kunne ikke oppdatere adminepost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const Se=Cn(pt,"users",K);await bi(Se,{displayName:Xr,email:Bt,phone:jn||null,role:ut,allowedTerms:ie}),t($e=>$e.map(mt=>mt.docId===K?{...mt,displayName:Xr,email:Bt,phone:jn||null,role:ut,allowedTerms:[...ie]}:mt)),wt(null),vr(null)}catch(Se){console.error("Feil ved lagring av admin:",Se),Ct.error("Kunne ikke lagre endringer for admin.")}},sr=()=>{wt(null),vr(null)},Ve=K=>{Ie(Se=>Se.includes(K)?Se.filter($e=>$e!==K):[...Se,K])};return I.jsxs("div",{className:"mb-2",children:[I.jsxs("div",{className:"flex gap-0_5 mb-0_75",children:[I.jsx("button",{type:"button",onClick:()=>b("students"),className:`flex-1 py-0_35 px-0_6 rounded-full fs-0_85 cursor-pointer ${T==="students"?"bg-green-light border-green-light text-black":"bg-white border-gray text-gray-900"}`,children:"Studenter"}),I.jsx("button",{type:"button",onClick:()=>b("teachers"),className:`flex-1 py-0_35 px-0_6 fs-0_85 cursor-pointer ${T==="teachers"?"bg-green-light border-green-light text-black":"bg-white border-gray text-gray-900"}`,children:"Lrere"}),I.jsx("button",{type:"button",onClick:()=>b("admins"),className:`flex-1 py-0_35 px-0_6 rounded-full fs-0_85 cursor-pointer ${T==="admins"?"bg-green-light border-green-light text-black":"bg-white border-gray text-gray-900"}`,children:"Admin"})]}),I.jsx("input",{type:"text",placeholder:"Sk p navn, e-post eller mobil...",value:g,onChange:K=>x(K.target.value),className:"w-full py-0_4 px-0_6 mb-0_75 rounded-md border-gray fs-0_9"}),o?I.jsx(lc,{}):I.jsxs(I.Fragment,{children:[T==="teachers"&&I.jsxs("div",{style:{marginBottom:"1.2rem"},children:[I.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[I.jsx("div",{style:{fontSize:"0.8rem"},children:I.jsx("label",{children:I.jsxs("select",{value:w==="all"?"":w,onChange:K=>{const Se=K.target.value;C(Se===""?"all":parseInt(Se,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[I.jsx("option",{value:"",children:"Alle terminer"}),We.map(K=>I.jsx("option",{value:K.value,children:K.label},K.value))]})})}),I.jsx("button",{type:"button",onClick:Me,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),I.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Ht("name"),children:["Navn"," ",R==="name"&&(L==="asc"?"":"")]}),I.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Ht("email"),children:["E-post"," ",R==="email"&&(L==="asc"?"":"")]}),I.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Ht("phone"),children:["Mobil"," ",R==="phone"&&(L==="asc"?"":"")]})]})}),I.jsx("tbody",{children:Xe.length===0?I.jsx("tr",{children:I.jsx("td",{colSpan:3,style:{padding:"0.4rem",fontSize:"0.85rem",color:"#6b7280"},children:"Ingen lrere funnet."})}):Xe.map(K=>I.jsxs("tr",{onClick:()=>gt(K),style:{cursor:"pointer"},children:[I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.displayName}),I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.email}),I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.phone??""})]},K.docId))})]})]}),T==="students"&&I.jsxs("div",{style:{marginBottom:"1.2rem"},children:[I.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[I.jsx("div",{style:{fontSize:"0.8rem"},children:I.jsx("label",{children:I.jsxs("select",{value:re==="all"?"":re,onChange:K=>{const Se=K.target.value;se(Se===""?"all":parseInt(Se,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[I.jsx("option",{value:"",children:"Alle terminer"}),We.map(K=>I.jsx("option",{value:K.value,children:K.label},K.value))]})})}),I.jsx("button",{type:"button",onClick:Ps,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),rt.length===0?I.jsx("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:"Ingen studenter funnet."}):I.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>St("name"),children:["Navn"," ",Ye==="name"&&(le==="asc"?"":"")]}),I.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem"},children:"Termin"}),I.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem"},children:"Godkjent?"})]})}),I.jsx("tbody",{children:rt.map(K=>I.jsxs("tr",{onClick:()=>Ha(K),style:{cursor:"pointer"},children:[I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.displayName}),I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.term!=null&&K.term!==void 0?gE(G,K.term):"Ingen"}),I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},onMouseEnter:Se=>{tn(K.docId,K.term??null)},children:K.term==null?"":I.jsx(ze,{uid:K.docId,term:K.term})})]},K.docId))})]})]}),T==="admins"&&I.jsxs("div",{style:{marginBottom:"1.2rem"},children:[I.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[I.jsx("div",{style:{fontSize:"0.8rem"},children:I.jsx("label",{children:I.jsxs("select",{value:dt==="all"?"":dt,onChange:K=>{const Se=K.target.value;Ze(Se===""?"all":parseInt(Se,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[I.jsx("option",{value:"",children:"Alle terminer"}),G.map(K=>I.jsx("option",{value:K.value,children:K.label},K.value))]})})}),I.jsx("button",{type:"button",onClick:Wn,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),ft.length===0?I.jsx("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:"Ingen administratorer funnet."}):I.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Vt("name"),children:["Navn"," ",F==="name"&&(U==="asc"?"":"")]}),I.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Vt("email"),children:["E-post"," ",F==="email"&&(U==="asc"?"":"")]}),I.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Vt("phone"),children:["Mobil"," ",F==="phone"&&(U==="asc"?"":"")]})]})}),I.jsx("tbody",{children:ft.map(K=>I.jsxs("tr",{onClick:()=>Jr(K),style:{cursor:"pointer"},children:[I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.displayName}),I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.email}),I.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:K.phone??""})]},K.docId))})]})]})]}),ot&&I.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:I.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[I.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:ot==="create"?"Ny lrer":"Rediger lrer"}),I.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:ot==="create"?"Opprett ny lrer, velg hvilke terminer de kan registrere for og lagre.":"Endre navn, e-post, mobil, rolle og hvilke terminer lreren kan undervise p."}),I.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",I.jsx("input",{type:"text",value:Te,onChange:K=>nt(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),I.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",I.jsx("input",{type:"email",value:ve,onChange:K=>st(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",I.jsx("input",{type:"tel",value:xt,onChange:K=>kt(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),ot==="edit"&&I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",I.jsxs("select",{value:cn,onChange:K=>en(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[I.jsx("option",{value:"teacher",children:"Lrer"}),I.jsx("option",{value:"student",children:"Student"}),I.jsx("option",{value:"admin",children:"Admin"})]})]}),I.jsxs("div",{style:{fontSize:"0.8rem"},children:[I.jsx("div",{style:{marginBottom:"0.25rem"},children:"Termin(er) lreren kan registrere for:"}),I.jsx("div",{style:{maxHeight:"150px",overflowY:"auto",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"0.35rem 0.45rem"},children:(We.length===0?[]:We).map(K=>I.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.35rem",fontSize:"0.8rem",padding:"0.15rem 0"},children:[I.jsx("input",{type:"checkbox",checked:En.includes(K.value),onChange:()=>fi(K.value)}),I.jsx("span",{children:K.label})]},K.value))})]})]}),I.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[I.jsx("button",{type:"button",onClick:$n,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),I.jsx("button",{className:"button button-green",type:"button",onClick:ot==="create"?sn:Ot,children:ot==="create"?"Opprett lrer":"Lagre"})]})]})}),hn&&I.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:I.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[I.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:hn==="create"?"Ny student":"Rediger student"}),I.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:hn==="create"?"Opprett ny student og velg termin.":"Endre navn, e-post, mobil, rolle og termin."}),I.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",I.jsx("input",{type:"text",value:Re,onChange:K=>Fe(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),I.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",I.jsx("input",{type:"email",value:ke,onChange:K=>be(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",I.jsx("input",{type:"tel",value:Pt,onChange:K=>vt(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),hn==="edit"&&I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",I.jsxs("select",{value:Rt,onChange:K=>Fn(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[I.jsx("option",{value:"student",children:"Student"}),I.jsx("option",{value:"teacher",children:"Lrer"}),I.jsx("option",{value:"admin",children:"Admin"})]})]}),I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Termin",I.jsxs("select",{value:Xt??"",onChange:K=>{const Se=K.target.value;yr(Se===""?null:parseInt(Se,10))},style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[I.jsx("option",{value:"",children:"Ingen"}),(We.length===0?[]:We).map(K=>I.jsx("option",{value:K.value,children:K.label},K.value))]})]})]}),I.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[I.jsx("button",{type:"button",onClick:Yr,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),I.jsx("button",{type:"button",onClick:hn==="create"?ri:Li,style:{padding:"0.3rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:hn==="create"?"Opprett student":"Lagre"})]})]})}),zt&&I.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:I.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[I.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:zt==="create"?"Ny admin":"Rediger admin"}),I.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:zt==="create"?"Opprett ny admin.":"Endre navn, e-post, mobil og rolle."}),I.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",I.jsx("input",{type:"text",value:Xr,onChange:K=>Tr(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),I.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",I.jsx("input",{type:"email",value:Bt,onChange:K=>Qt(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",I.jsx("input",{type:"tel",value:jn,onChange:K=>Mr(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),zt==="edit"&&I.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",I.jsxs("select",{value:ut,onChange:K=>nn(K.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[I.jsx("option",{value:"admin",children:"Admin"}),I.jsx("option",{value:"teacher",children:"Lrer"}),I.jsx("option",{value:"student",children:"Student"})]})]}),I.jsxs("div",{style:{fontSize:"0.8rem"},children:[I.jsx("div",{style:{marginBottom:"0.25rem"},children:"Termin(er) admin kan administrere:"}),I.jsx("div",{style:{maxHeight:"150px",overflowY:"auto",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"0.35rem 0.45rem"},children:We.length===0?I.jsx("div",{style:{color:"#6b7280"},children:"Ingen terminer tilgjengelig"}):We.map(K=>I.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.35rem",fontSize:"0.8rem",padding:"0.15rem 0"},children:[I.jsx("input",{type:"checkbox",checked:ie.includes(K.value),onChange:()=>Ve(K.value)}),I.jsx("span",{children:K.label})]},K.value))})]})]}),I.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[I.jsx("button",{type:"button",onClick:sr,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),I.jsx("button",{type:"button",onClick:zt==="create"?un:kr,style:{padding:"0.3rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:zt==="create"?"Opprett admin":"Lagre"})]})]})})]})},FR=()=>{const[s,e]=oe.useState([]),[t,o]=oe.useState(""),[u,g]=oe.useState([]),[x,T]=oe.useState(!0),[b,w]=oe.useState(""),[C,R]=oe.useState({}),[P,L]=oe.useState(null),[ee,re]=oe.useState(""),[se,Ye]=oe.useState(""),[Oe,le]=oe.useState(null),[Ue,dt]=oe.useState(0),[Ze,F]=oe.useState({}),[z,U]=oe.useState([]),[J,X]=oe.useState(!1),[Y,G]=oe.useState(""),at=oe.useRef(null),[ce,ue]=oe.useState(!1),[Ee,We]=oe.useState([]),[qe,ot]=oe.useState(!1),[Q,$]=oe.useState([]),{user:pe}=bc(),[Te,nt]=oe.useState(null),[ve,st]=oe.useState(null);oe.useEffect(()=>{(async()=>{try{if(!pe?.uid)return;const Ie=Cn(pt,"users",pe.uid),He=await Fa(Ie),Xe=He.exists()?He.data():null,ft=(Array.isArray(Xe?.allowedTerms)?Xe.allowedTerms:[]).map(it=>typeof it=="number"?it:parseInt(String(it),10)).filter(it=>!Number.isNaN(it));nt(ft),st(!!Xe?.isSuperAdmin)}catch(Ie){console.warn("Kunne ikke hente allowedTerms for innlogget admin (TermSetup):",Ie),nt([]),st(!1)}})()},[pe?.uid]);const xt=oe.useMemo(()=>ve?!1:Array.isArray(Te)&&Te.length>0,[ve,Te]),kt=oe.useMemo(()=>xt?new Set(Te):null,[xt,Te]);oe.useEffect(()=>{ve||xt&&(!Te||Te.length!==1||t===""&&o(Te[0]))},[ve,xt,Te,t]),oe.useEffect(()=>{xt&&t!==""&&kt&&!kt.has(t)&&o("")},[xt,kt,t]),oe.useEffect(()=>{(async()=>{try{T(!0);const[Ie,He,Xe,rt]=await Promise.all([dr(Kn(pt,"requirements")),dr(Kn(pt,"times")),dr(Kn(pt,"termLabels")).catch(()=>null),dr(Kn(pt,"terms")).catch(()=>null)]),ft=Ie.docs.map(Ht=>{const St=Ht.data();return{id:Ht.id,term:St.term,category:St.category,requiredCount:St.requiredCount??0,order:typeof St?.order=="number"?St.order:void 0}}),it=He.docs.map(Ht=>{const St=Ht.data();return{id:Ht.id,name:St.name,category:St.category,term:St.term}});if(e(ft),g(it),rt){const Ht=rt.docs.map(St=>{const Vt=St.data(),Me=typeof Vt?.value=="number"?Vt.value:void 0,sn=typeof Vt?.label=="string"?Vt.label:"",gt=typeof Vt?.order=="number"?Vt.order:void 0;return typeof Me!="number"?null:{docId:St.id,value:Me,label:sn,order:gt}}).filter(Boolean);Ht.sort((St,Vt)=>{const Me=St.order??St.value,sn=Vt.order??Vt.value;return Me-sn}),U(Ht)}if(Xe){const Ht={};Xe.docs.forEach(St=>{const Vt=St.data(),Me=parseInt(St.id,10);!Number.isNaN(Me)&&typeof Vt?.label=="string"&&Vt.label.trim()&&(Ht[Me]=Vt.label.trim())}),F(Ht)}}catch(Ie){console.error("Feil ved lasting av termin-oppsett:",Ie)}finally{T(!1)}})()},[]);const cn=s.filter(ie=>ie.term===t).sort((ie,Ie)=>{const He=ie.order??Number.MAX_SAFE_INTEGER,Xe=Ie.order??Number.MAX_SAFE_INTEGER;return He!==Xe?He-Xe:ie.category.localeCompare(Ie.category,"nb-NO",{sensitivity:"base"})}),en=oe.useMemo(()=>{const ie=z.slice().sort((Ie,He)=>(Ie.order??Ie.value)-(He.order??He.value)).map(Ie=>({value:Ie.value,label:Ie.label||`Termin ${Ie.value}`}));return Object.keys(Ze).length>0?ie.map(Ie=>({...Ie,label:Ze[Ie.value]??Ie.label})):ie},[z,Ze]),En=ie=>La(en,ie??null),Lt=()=>{if(t==="")return;const ie=En(t);G(ie),X(!0),setTimeout(()=>at.current?.focus(),0)},hn=()=>{X(!1),G("")},wn=async()=>{if(t==="")return;const ie=En(t),Ie=Y.trim();if(!Ie||Ie===ie){X(!1);return}try{const He=z.find(Xe=>Xe.value===Number(t));if(He)await bi(Cn(pt,"terms",He.docId),{label:Ie,updatedAt:Ed()}),U(Xe=>Xe.map(rt=>rt.docId===He.docId?{...rt,label:Ie}:rt));else{const Xe=String(t);await hl(Cn(pt,"termLabels",Xe),{label:Ie,updatedAt:Ed(),value:Number(t)},{merge:!0}),F(rt=>({...rt,[Number(t)]:Ie}))}X(!1)}catch(He){console.error("Feil ved endring av modulnavn:",He),alert("Kunne ikke endre navn p modulen.")}},De=async()=>{try{const ie=z.map(St=>St.value),Ie=z.map(St=>St.order??St.value),He=ie.length>0?Math.max(...ie):0,Xe=Ie.length>0?Math.max(...Ie):0,rt=He+1,ft=Xe+1,Ht={docId:(await xd(Kn(pt,"terms"),{value:rt,label:"",order:ft,createdAt:Ed()})).id,value:rt,label:"",order:ft};U(St=>[...St,Ht]),o(rt),G(""),X(!0),setTimeout(()=>at.current?.focus(),0)}catch(ie){console.error("Kunne ikke opprette ny oppmtebok:",ie),alert("Kunne ikke opprette ny oppmtebok.")}},ge=()=>{if(z.length===0)return;const ie=z.slice().sort((Ie,He)=>(Ie.order??Ie.value)-(He.order??He.value));We(ie),ue(!0)},Re=(ie,Ie)=>{We(He=>{const Xe=He.slice(),rt=ie+Ie;if(rt<0||rt>=Xe.length)return He;const[ft]=Xe.splice(ie,1);return Xe.splice(rt,0,ft),Xe})},Fe=async()=>{try{const ie=au(pt);Ee.forEach((Ie,He)=>{ie.update(Cn(pt,"terms",Ie.docId),{order:He+1})}),await ie.commit(),U(Ee.map((Ie,He)=>({...Ie,order:He+1}))),ue(!1)}catch(ie){console.error("Kunne ikke lagre sortering av terminer:",ie),alert("Kunne ikke lagre sortering av terminer.")}},ke=()=>{if(t==="")return;const ie=s.filter(Ie=>Ie.term===t).slice().sort((Ie,He)=>{const Xe=Ie.order??Number.MAX_SAFE_INTEGER,rt=He.order??Number.MAX_SAFE_INTEGER;return Xe!==rt?Xe-rt:Ie.category.localeCompare(He.category,"nb-NO",{sensitivity:"base"})});$(ie),ot(!0)},be=(ie,Ie)=>{$(He=>{const Xe=He.slice(),rt=ie+Ie;if(rt<0||rt>=Xe.length)return He;const[ft]=Xe.splice(ie,1);return Xe.splice(rt,0,ft),Xe})},Pt=async()=>{try{const ie=au(pt);Q.forEach((Ie,He)=>{ie.update(Cn(pt,"requirements",Ie.id),{order:He+1})}),await ie.commit(),e(Ie=>{const He={};return Q.forEach((Xe,rt)=>He[Xe.id]=rt+1),Ie.map(Xe=>He[Xe.id]?{...Xe,order:He[Xe.id]}:Xe)}),ot(!1)}catch(ie){console.error("Kunne ikke lagre sortering av grupper:",ie),alert("Kunne ikke lagre sortering av grupper.")}},[vt,Rt]=oe.useState({open:!1,termValue:null,termLabel:"",reqCount:0,timeCount:0}),Fn=()=>{if(t==="")return;const ie=t,Ie=En(ie),He=s.filter(rt=>rt.term===ie).length,Xe=u.filter(rt=>rt.term===ie).length;Rt({open:!0,termValue:ie,termLabel:Ie,reqCount:He,timeCount:Xe})},Xt=()=>{Rt({open:!1,termValue:null,termLabel:"",reqCount:0,timeCount:0})},yr=async(ie,Ie)=>{try{const He=z.find(Me=>Me.value===ie);let Xe=He?Cn(pt,"terms",He.docId):null;const rt=ui(Kn(pt,"requirements"),Ar("term","==",ie)),ft=ui(Kn(pt,"times"),Ar("term","==",ie)),[it,Ht]=await Promise.all([dr(rt),dr(ft)]);if(!Xe)try{const Me=ui(Kn(pt,"terms"),Ar("value","==",ie));Xe=(await dr(Me)).docs[0]?.ref??null}catch{}const St=[...it.docs.map(Me=>Me.ref),...Ht.docs.map(Me=>Me.ref)];Xe&&St.push(Xe);const Vt=450;for(let Me=0;Me<St.length;Me+=Vt){const sn=au(pt);St.slice(Me,Me+Vt).forEach(gt=>sn.delete(gt)),await sn.commit()}e(Me=>Me.filter(sn=>sn.term!==ie)),g(Me=>Me.filter(sn=>sn.term!==ie)),U(Me=>Me.filter(sn=>sn.value!==ie)),o(""),X(!1),w(""),le(null),L(null),re(""),Ct.success("Termin slettet",{description:`${Ie} er fjernet med alle grupper og timer.`})}catch(He){console.error("Kunne ikke slette termin med relaterte data:",He),Ct.error("Kunne ikke slette termin. Prv igjen senere.")}finally{Xt()}},xr=async()=>{!vt.open||vt.termValue==null||await yr(vt.termValue,vt.termLabel)},or=async ie=>{const Ie=ee.trim();if(!Ie||Ie===ie.name){L(null),re("");return}try{await bi(Cn(pt,"times",ie.id),{name:Ie}),g(He=>He.map(Xe=>Xe.id===ie.id?{...Xe,name:Ie}:Xe)),L(null),re("")}catch(He){console.error("Feil ved endring av timenavn:",He),alert("Kunne ikke oppdatere navn p timen.")}},Zr=u.filter(ie=>ie.term===t),Ti=ie=>{le(ie.id),Ye(ie.category),dt(ie.requiredCount??0)},ki=()=>{le(null)},tn=async ie=>{if(!Oe)return;const Ie=ie.category,He=(se||"").trim()||Ie,Xe=u.filter(it=>it.term===ie.term&&it.category===Ie).length;let rt=Ue;if((Number.isNaN(rt)||rt<0)&&(rt=0),Xe>0&&rt>Xe&&(rt=Xe),cn.find(it=>it.id!==ie.id&&it.category.toLowerCase()===He.toLowerCase())){alert("Det finnes allerede en gruppe med dette navnet i valgt termin.");return}try{const it=au(pt),Ht=Cn(pt,"requirements",ie.id);it.update(Ht,{category:He,requiredCount:rt});const St=ui(Kn(pt,"times"),Ar("term","==",ie.term),Ar("category","==",Ie));(await dr(St)).forEach(gt=>{it.update(gt.ref,{category:He})});const Me=ui(Kn(pt,"sessions"),Ar("term","==",ie.term),Ar("category","==",Ie));(await dr(Me)).forEach(gt=>{it.update(gt.ref,{category:He})}),await it.commit(),e(gt=>gt.map(Ot=>Ot.id===ie.id?{...Ot,category:He,requiredCount:rt}:Ot)),g(gt=>gt.map(Ot=>Ot.term===ie.term&&Ot.category===Ie?{...Ot,category:He}:Ot)),le(null)}catch(it){console.error("Feil ved lagring av gruppe:",it),alert("Kunne ikke lagre endringene for gruppen.")}},ze=async()=>{const ie=b.trim();if(!ie)return;if(cn.some(He=>He.category.toLowerCase()===ie.toLowerCase())){alert("Denne gruppen finnes allerede for valgt termin.");return}try{const He=s.filter(it=>it.term===t),rt=(He.length?Math.max(...He.map(it=>typeof it.order=="number"?it.order:0)):0)+1,ft=await xd(Kn(pt,"requirements"),{term:t,category:ie,requiredCount:0,order:rt});e(it=>[...it,{id:ft.id,term:t,category:ie,requiredCount:0,order:rt}]),w("")}catch(He){console.error("Feil ved oppretting av kategori:",He),alert("Kunne ikke opprette kategori.")}},[zt,wt]=oe.useState({open:!1,req:null,timeCount:0}),_n=async(ie,Ie)=>{const{id:He,term:Xe,category:rt}=ie;try{const ft=ui(Kn(pt,"times"),Ar("term","==",Xe),Ar("category","==",rt)),it=await dr(ft),Ht=[Cn(pt,"requirements",He),...it.docs.map(Vt=>Vt.ref)],St=450;for(let Vt=0;Vt<Ht.length;Vt+=St){const Me=au(pt);Ht.slice(Vt,Vt+St).forEach(sn=>Me.delete(sn)),await Me.commit()}e(Vt=>Vt.filter(Me=>Me.id!==He)),g(Vt=>Vt.filter(Me=>!(Me.term===Xe&&Me.category===rt)))}catch(ft){console.error("Feil ved sletting av gruppe og tilhrende timer:",ft),Ct.error("Kunne ikke slette gruppen. Prv igjen senere.")}finally{Xr()}},vr=ie=>{const Ie=u.filter(He=>He.term===ie.term&&He.category===ie.category).length;if(Ie===0){_n(ie);return}wt({open:!0,req:ie,timeCount:Ie})},Xr=()=>{wt({open:!1,req:null,timeCount:0})},Tr=async()=>{zt.req&&await _n(zt.req,zt.timeCount)},Bt=async ie=>{const Ie=ie.id,He=(C[Ie]??"").trim();if(He)try{const Xe=await xd(Kn(pt,"times"),{term:t,category:ie.category,name:He});g(rt=>[...rt,{id:Xe.id,term:t,category:ie.category,name:He}]),R(rt=>({...rt,[Ie]:""}))}catch(Xe){console.error("Feil ved oppretting av time:",Xe),alert("Kunne ikke opprette time.")}},[Qt,jn]=oe.useState({open:!1,time:null}),Mr=ie=>{jn({open:!0,time:ie})},ut=()=>{jn({open:!1,time:null})},nn=async()=>{if(!Qt.time)return;const ie=Qt.time;try{await X_(Cn(pt,"times",ie.id)),g(Ie=>Ie.filter(He=>He.id!==ie.id))}catch(Ie){console.error("Feil ved sletting av time:",Ie),Ct.error("Kunne ikke slette time. Prv igjen senere.")}finally{ut()}};return x?I.jsx(lc,{}):I.jsxs(I.Fragment,{children:[I.jsxs("section",{style:{marginBottom:"2rem"},children:[I.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[I.jsxs("div",{className:"admin-books-controls",style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[I.jsxs("div",{className:`admin-books-rest${ve?" admin-books-rest--split":""}`,style:{display:"flex",gap:"0.5rem",flex:1,minWidth:0},children:[J&&ve?I.jsx("input",{className:"admin-books-select",ref:at,type:"text",value:Y,onChange:ie=>G(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"?(ie.preventDefault(),wn()):ie.key==="Escape"&&(ie.preventDefault(),hn())},placeholder:"Navn p modul",style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}}):I.jsxs("select",{className:"admin-books-select",value:t,onChange:ie=>{const Ie=ie.target.value;if(Ie==="__new__"){if(xt)return;De();return}o(Ie===""?"":parseInt(Ie,10))},style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",width:ve?void 0:"100%"},children:[I.jsx("option",{value:"",disabled:!0,children:"Velg termin"}),(xt?en.filter(ie=>kt?.has(ie.value)):en).map(ie=>I.jsx("option",{value:ie.value,children:ie.label},ie.value)),!xt&&I.jsx("option",{value:"__new__",children:"+ Ny oppmtebok"})]}),ve&&I.jsx("button",{className:"button-green admin-books-action",type:"button",disabled:t===""&&!J,onClick:()=>{J?wn():Lt()},style:{width:"160px",padding:"0.45rem 0.9rem",cursor:t===""&&!J?"not-allowed":"pointer",whiteSpace:"nowrap"},children:J?"Legg til":"Endre navn"})]}),ve&&I.jsx("button",{className:"admin-books-filter",type:"button",title:"Sorter oppmtebker",disabled:z.length===0,onClick:ge,style:{padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",background:"#ffffff",fontSize:"0.9rem",cursor:z.length===0?"not-allowed":"pointer"},children:""})]}),I.jsx("div",{className:"admin-books-controls",style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:(()=>{const ie=t===""?null:Number(t),Ie=ie!=null?z.find(it=>it.value===ie):void 0,He=!!Ie?.label&&Ie.label.trim().length>0,Xe=ie!=null?Ze[ie]:void 0,rt=!!Xe&&Xe.trim().length>0,ft=ie!=null&&(He||rt);return I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"admin-books-rest admin-books-rest--split",style:{display:"flex",gap:"0.5rem",flex:1,minWidth:0},children:[I.jsx("input",{className:"admin-books-select",type:"text",placeholder:"Ny gruppe...",value:b,onChange:it=>w(it.target.value),onKeyDown:it=>{it.key==="Enter"&&ft&&(it.preventDefault(),ze())},disabled:!ft,style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",opacity:ft?1:.6,cursor:ft?"text":"not-allowed"}}),I.jsx("button",{className:"button-green admin-books-action",type:"button",onClick:ze,disabled:!ft,style:{width:"160px",padding:"0.45rem 0.9rem",cursor:ft?"pointer":"not-allowed",whiteSpace:"nowrap",opacity:ft?1:.7},children:"Legg til"})]}),I.jsx("button",{className:"admin-books-filter",type:"button",title:"Sorter grupper",disabled:!ft||cn.length===0,onClick:ke,style:{padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",background:"#ffffff",fontSize:"0.9rem",cursor:!ft||cn.length===0?"not-allowed":"pointer",opacity:!ft||cn.length===0?.7:1},children:""})]})})()})]}),(()=>{const ie=t===""?null:Number(t),Ie=ie!=null?z.find(it=>it.value===ie):void 0,He=!!Ie?.label&&Ie.label.trim().length>0,Xe=ie!=null?Ze[ie]:void 0,rt=!!Xe&&Xe.trim().length>0;return ie!=null&&(He||rt)?cn.length===0?I.jsxs("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:["Ingen grupper definert enn for ",En(t),"."]}):I.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:cn.map(it=>{const Ht=it.id,St=Zr.filter(gt=>gt.category===it.category).sort((gt,Ot)=>{const $n=wE(gt.name),fi=wE(Ot.name);return $n!==fi?$n-fi:gt.name.localeCompare(Ot.name,"nb-NO",{sensitivity:"base"})}),Vt=C[Ht]??"",Me=Zr.filter(gt=>gt.category===it.category).length,sn=Oe===it.id;return I.jsxs("div",{style:{borderRadius:"0.75rem",border:"1px solid #e5e7eb",padding:"0.75rem 0.75rem",backgroundColor:"#f9fafb"},children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem",gap:"0.5rem",flexWrap:"wrap"},children:[I.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:sn?I.jsxs(I.Fragment,{children:[I.jsx("input",{type:"text",value:se,onChange:gt=>Ye(gt.target.value),onKeyDown:gt=>{gt.key==="Enter"?tn(it):gt.key==="Escape"&&ki()},autoFocus:!0,style:{minWidth:"12rem",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.9rem"}}),I.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[I.jsx("input",{type:"number",min:0,max:Me,value:Ue,onChange:gt=>{const Ot=parseInt(gt.target.value,10);dt(Number.isNaN(Ot)?0:Ot)},onKeyDown:gt=>{gt.key==="Enter"?tn(it):gt.key==="Escape"&&ki()},style:{width:"4rem",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.9rem",textAlign:"center"}}),I.jsxs("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:["/ ",Me]})]})]}):I.jsxs("div",{style:{fontWeight:600,fontSize:"0.95rem"},children:[it.category," (",it.requiredCount,"/",Me,")"]})}),I.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[I.jsx("button",{className:"button-green admin-books-action",type:"button",onClick:()=>sn?void tn(it):Ti(it),style:{padding:"0.45rem 0.9rem",cursor:"pointer",whiteSpace:"nowrap"},children:sn?"Lagre":"Endre navn"}),I.jsx("button",{type:"button",onClick:()=>vr({id:it.id,term:it.term,category:it.category}),style:{padding:"0.25rem 0.6rem",borderRadius:"999px",border:"none",backgroundColor:"#fee2e2",color:"#991b1b",fontSize:"0.75rem",cursor:"pointer"},children:"Slett gruppe"})]})]}),St.length>0?I.jsx("ul",{style:{listStyle:"none",paddingLeft:0,margin:"0 0 0.5rem 0",fontSize:"0.85rem"},children:St.map(gt=>{const Ot=P===gt.id;return I.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.15rem 0",borderBottom:"1px dashed #e5e7eb",gap:"0.5rem"},children:[I.jsx("div",{style:{flex:1},children:Ot?I.jsx("input",{type:"text",value:ee,onChange:$n=>re($n.target.value),onKeyDown:$n=>{$n.key==="Enter"?or(gt):$n.key==="Escape"&&(L(null),re(""))},autoFocus:!0,style:{width:"100%",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.85rem"}}):I.jsx("span",{children:gt.name})}),I.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[Ot?I.jsx("button",{type:"button",onClick:()=>void or(gt),style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:"Lagre"}):I.jsx("button",{type:"button",onClick:()=>{L(gt.id),re(gt.name)},style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:"Endre"}),I.jsx("button",{type:"button",onClick:()=>Mr(gt),style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#fee2e2",color:"#b91c1c",fontSize:"0.75rem",cursor:"pointer"},children:"Slett"})]})]},gt.id)})}):I.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.8rem",color:"#9ca3af"},children:"Ingen timer lagt til i denne gruppen."}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"},children:[I.jsx("input",{type:"text",placeholder:"Ny time...",value:Vt,onChange:gt=>R(Ot=>({...Ot,[Ht]:gt.target.value})),onKeyDown:gt=>{gt.key==="Enter"&&(gt.preventDefault(),Bt(it))},style:{flex:1,padding:"0.3rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem"}}),I.jsx("button",{type:"button",onClick:()=>Bt(it),style:{padding:"0.35rem 0.8rem",borderRadius:"999px",border:"none",backgroundColor:"#4b5563",color:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til time"})]})]},it.id)})}):null})(),t!==""&&ve&&I.jsx("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center"},children:I.jsx("button",{className:"btn-hover-danger",type:"button",onClick:Fn,style:{backgroundColor:"#ef4444",borderColor:"#ef4444",color:"white",fontSize:"0.9rem"},children:"Slett termin"})}),vt.open&&vt.termValue!=null&&I.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:I.jsxs("div",{className:"page-card",style:{textAlign:"center",maxWidth:520,width:"100%",background:"#ffffff"},children:[I.jsx("h3",{style:{marginTop:0},children:"Slett termin?"}),I.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:[`Du er i ferd med  slette oppmteboka for ${vt.termLabel}.

`,`Dette vil slette selve terminen, alle grupper (${vt.reqCount} stk) og alle timer (${vt.timeCount} stk) som tilhrer denne terminen.
`]}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",marginTop:"0.75rem"},children:[I.jsx("button",{className:"btn-hover-danger",type:"button",onClick:Xt,style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",background:"#ef4444",color:"black",cursor:"pointer"},children:"Avbryt"}),I.jsx("button",{className:"btn-hover-lg",type:"button",onClick:()=>void xr(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Slett termin"})]})]})}),zt.open&&zt.req&&I.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:I.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff"},children:[I.jsx("h3",{style:{marginTop:0},children:"Slett gruppe?"}),I.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:[`Du er i ferd med  slette gruppen ${zt.req.category}.

`,`Dette vil ogs slette alle tilhrende timer i denne gruppen for valgt termin (${zt.timeCount}).
`,"Handlingen kan ikke angres."]}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"0.75rem"},children:[I.jsx("button",{type:"button",onClick:Xr,style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Avbryt"}),I.jsx("button",{type:"button",onClick:()=>void Tr(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",background:"#ef4444",color:"#ffffff",cursor:"pointer"},children:"Slett gruppe"})]})]})}),Qt.open&&Qt.time&&I.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:I.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff"},children:[I.jsx("h3",{style:{marginTop:0},children:"Slett time?"}),I.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:[`Du er i ferd med  slette timen ${Qt.time.name} i gruppen ${Qt.time.category} for ${En(Qt.time.term)}.

`,`Historiske sesjoner beholdes, men timen forsvinner fra admin-oppsettet.
`,"Handlingen kan ikke angres."]}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"0.75rem"},children:[I.jsx("button",{type:"button",onClick:ut,style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Avbryt"}),I.jsx("button",{type:"button",onClick:()=>void nn(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",background:"#ef4444",color:"#ffffff",cursor:"pointer"},children:"Slett time"})]})]})})]}),ce&&I.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:I.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[I.jsx("h3",{style:{marginTop:0},children:"Sorter oppmtebker"}),I.jsx("ul",{style:{listStyle:"none",padding:0,margin:"0 0 0.75rem"},children:Ee.map((ie,Ie)=>I.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.4rem 0.6rem",marginBottom:"0.4rem"},children:[I.jsx("span",{style:{fontSize:"0.9rem"},children:ie.label||`Termin ${ie.value}`}),I.jsxs("span",{style:{display:"flex",gap:"0.25rem"},children:[I.jsx("button",{type:"button",onClick:()=>Re(Ie,-1),disabled:Ie===0,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""}),I.jsx("button",{type:"button",onClick:()=>Re(Ie,1),disabled:Ie===Ee.length-1,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""})]})]},ie.docId))}),I.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[I.jsx("button",{type:"button",onClick:()=>ue(!1),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff"},children:"Avbryt"}),I.jsx("button",{type:"button",onClick:()=>void Fe(),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"none",background:"#16a34a",color:"#fff"},children:"Lagre rekkeflge"})]})]})}),qe&&I.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:I.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[I.jsx("h3",{style:{marginTop:0},children:"Sorter grupper"}),I.jsx("ul",{style:{listStyle:"none",padding:0,margin:"0 0 0.75rem"},children:Q.map((ie,Ie)=>I.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.4rem 0.6rem",marginBottom:"0.4rem"},children:[I.jsx("span",{style:{fontSize:"0.9rem"},children:ie.category}),I.jsxs("span",{style:{display:"flex",gap:"0.25rem"},children:[I.jsx("button",{type:"button",onClick:()=>be(Ie,-1),disabled:Ie===0,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""}),I.jsx("button",{type:"button",onClick:()=>be(Ie,1),disabled:Ie===Q.length-1,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""})]})]},ie.id))}),I.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[I.jsx("button",{type:"button",onClick:()=>ot(!1),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff"},children:"Avbryt"}),I.jsx("button",{type:"button",onClick:()=>void Pt(),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"none",background:"#16a34a",color:"#fff"},children:"Lagre rekkeflge"})]})]})})]})},jR=()=>{const{user:s,loading:e,logout:t}=bc(),[o,u]=oe.useState("setup"),[g,x]=oe.useState(!1);return e?I.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:I.jsx(lc,{})}):!s||s.role!=="admin"?I.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"1.5rem"},children:I.jsxs("div",{className:"page-card page-card--admin",children:[I.jsx("h2",{children:"Ingen tilgang"}),I.jsx("p",{children:"Du m vre logget inn som administrator for  se denne siden."})]})}):I.jsxs(I.Fragment,{children:[I.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"flex-start",justifyContent:"center",padding:"1.5rem 1rem"},children:I.jsxs("div",{className:"page-card page-card--admin",children:[I.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[I.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[I.jsx("button",{type:"button",onClick:()=>x(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),I.jsx("button",{type:"button",onClick:t,style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),I.jsxs("header",{style:{marginBottom:"1rem",borderBottom:"1px solid #e5e7eb",paddingBottom:"0.75rem"},children:[I.jsx("h2",{style:{margin:0},children:"Adminpanel"}),I.jsx("p",{style:{margin:"0.25rem 0 0.75rem",fontSize:"0.85rem",color:"#6b7280"},children:"Oppsett av oppmtebker og administrasjon av brukere."}),I.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[I.jsx("button",{type:"button",onClick:()=>u("setup"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #e5e7eb",background:o==="setup"?"#6CE1AB":"#ffffff",color:o==="setup"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Oppmtebker"}),I.jsx("button",{type:"button",onClick:()=>u("users"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #e5e7eb",background:o==="users"?"#6CE1AB":"#ffffff",color:o==="users"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Brukere"})]})]}),o==="setup"&&I.jsx(FR,{}),o==="users"&&I.jsx(UR,{})]})}),g&&I.jsx(om,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>x(!1)})]})};function _E(){return I.jsx("footer",{children:I.jsxs("div",{className:"container",children:[I.jsxs("div",{className:"row row1",children:[I.jsx("h2",{children:"Vi lytter til dere!"}),I.jsx("p",{children:"Traskende rundt i sykehuskorridorene med en oppmtebok du alltid er redd for  miste eller sle kaffekoppen p, begynner man  fundere p om det gr an  gjre livet litt enklere S hvorfor ikke lage en digital oppmtebok du aldri glemmer hjemme, som er superrask for lrerne og sparer fakultetet for over 3000(!) papirutgaver i ret?"}),I.jsx("br",{}),I.jsx("p",{children:"Miljvennlig, effektivt og bedre for studentene. Velkommen til Oppmteboka  skapt mellom uttrykning p vakt eller halvsovende p sofaen i de sene nattestimer. Send oss en melding om du har noe tips til hva vi br gjre!"})]}),I.jsxs("div",{className:"row row2",children:[I.jsx("img",{src:"/logo.svg",alt:"Oppmteboka logo"}),I.jsx("p",{className:"normalFont",children:I.jsx("a",{className:"link",href:"mailto:hei@sablateknisk.no?subject=Tilbakelding",children:"Gi tilbakemelding"})}),I.jsx("p",{children:"hei@sablateknisk.no"}),I.jsx("br",{}),I.jsxs("p",{className:"smallText",children:["Nettisden er utviklet av",I.jsx("br",{})," Vetle Mrland og ge Frivoll"]})]})]})})}function zR({user:s}){const{logout:e}=bc(),[t,o]=oe.useState(!1);return I.jsxs("header",{children:[I.jsxs("div",{className:"header-container",children:[I.jsx("div",{className:"header-img",children:I.jsx("img",{src:"/logo.svg",alt:"Logo",className:""})}),I.jsxs("div",{className:"header-buttons",children:[I.jsx("button",{className:"button-small button-border button-colorless boldFont",type:"button",onClick:()=>o(!0),children:"Min profil"}),I.jsx("button",{className:"button-small button-border button-black boldFont",type:"button",onClick:e,children:"Logg ut"})]})]}),I.jsx("div",{children:t&&I.jsx(om,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>o(!1)})})]})}function HR(){const{user:s,login:e}=bc(),[t,o]=oe.useState(""),[u,g]=oe.useState(""),[x,T]=oe.useState(null),[b,w]=oe.useState(null),[C,R]=oe.useState(!1),[P,L]=oe.useState(!1),ee=oe.useRef(null),re=oe.useRef(null);oe.useEffect(()=>{if(!x)return;const Oe=setTimeout(()=>T(null),3e3);return()=>clearTimeout(Oe)},[x]),oe.useEffect(()=>{if(!b)return;const Oe=setTimeout(()=>w(null),3e3);return()=>clearTimeout(Oe)},[b]),oe.useEffect(()=>{if(s)try{window.scrollTo({top:0,behavior:"smooth"})}catch{window.scrollTo(0,0)}},[s]);const se=async Oe=>{if(Oe.preventDefault(),T(null),!t||!u){T("Fyll inn bde e-post og passord.");return}R(!0);try{await e(t.trim(),u)}catch(le){console.error(le);let Ue="Kunne ikke logge inn.";le?.code==="auth/user-not-found"?Ue="Bruker finnes ikke.":le?.code==="auth/wrong-password"?Ue="Feil passord.":le?.code==="auth/email-already-in-use"?Ue="E-postadressen er allerede registrert.":le?.code==="auth/weak-password"&&(Ue="Passordet er for svakt (min. 6 tegn)."),T(Ue)}finally{R(!1)}},Ye=async()=>{const Oe=t.trim();if(!Oe){T("Skriv inn epostadressen din frst.");return}L(!0);try{await CC(Co,Oe),w("Sendte epost for tilbakestilling av passord.")}catch(le){console.error(le);let Ue="Kunne ikke sende epost for tilbakestilling.";le?.code==="auth/invalid-email"?Ue="Ugyldig epostadresse.":le?.code==="auth/user-not-found"&&(Ue="Fant ingen bruker for denne epostadressen."),T(Ue)}finally{L(!1)}};return s?I.jsxs(I.Fragment,{children:[I.jsx(zR,{user:s}),I.jsx("div",{id:"main",children:s.role==="admin"?I.jsx(jR,{user:s}):s.role==="teacher"?I.jsx(xR,{user:s}):I.jsx(oR,{user:s})}),I.jsx(_E,{})]}):I.jsxs(I.Fragment,{children:[I.jsxs("div",{id:"main",children:[I.jsx("div",{id:"loginMan",children:I.jsx("img",{src:"/logo.svg",alt:"Logo",className:""})}),I.jsxs("div",{className:"card round-corners-full login-card",children:[I.jsx("h1",{children:"Velkommen tilbake"}),I.jsxs("form",{onSubmit:se,children:[I.jsxs("div",{className:"input-group",children:[I.jsx("label",{className:"input-label",children:"Mobil / epost"}),I.jsx("input",{className:"input-field round-corners-half",type:"email",value:t,onChange:Oe=>o(Oe.target.value),ref:ee,onKeyDown:Oe=>{Oe.key==="Enter"&&(Oe.preventDefault(),re.current?.focus())},enterKeyHint:"next"})]}),I.jsxs("div",{className:"input-group",children:[I.jsx("label",{className:"input-label",children:"Passord"}),I.jsx("input",{className:"input-field round-corners-half",type:"password",value:u,onChange:Oe=>g(Oe.target.value),ref:re,enterKeyHint:"go"})]}),I.jsx("button",{type:"submit",disabled:C,className:"button-primary button-black round-corners-half",children:C?"Logger inn...":"Logg inn"}),I.jsx("button",{type:"button",onClick:Ye,disabled:P,className:"button-colorless boldFont",children:P?"Sender epost...":"Glemt passord"}),I.jsxs("p",{className:"errorTxt",children:[I.jsx("br",{}),x]}),I.jsxs("p",{className:"successTxt",children:[I.jsx("br",{}),b]})]})]})]}),I.jsx(_E,{})]})}jb.createRoot(document.getElementById("root")).render(I.jsxs(Qe.StrictMode,{children:[I.jsx(HR,{}),I.jsx(R8,{richColors:!0,position:"top-center"})]}));
