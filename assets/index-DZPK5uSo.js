function Nb(s,e){for(var n=0;n<e.length;n++){const o=e[n];if(typeof o!="string"&&!Array.isArray(o)){for(const h in o)if(h!=="default"&&!(h in s)){const g=Object.getOwnPropertyDescriptor(o,h);g&&Object.defineProperty(s,h,g.get?g:{enumerable:!0,get:()=>o[h]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))o(h);new MutationObserver(h=>{for(const g of h)if(g.type==="childList")for(const x of g.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&o(x)}).observe(document,{childList:!0,subtree:!0});function n(h){const g={};return h.integrity&&(g.integrity=h.integrity),h.referrerPolicy&&(g.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?g.credentials="include":h.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function o(h){if(h.ep)return;h.ep=!0;const g=n(h);fetch(h.href,g)}})();var $h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qd(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var s1={exports:{}},iu={};var d2;function Ob(){if(d2)return iu;d2=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(o,h,g){var x=null;if(g!==void 0&&(x=""+g),h.key!==void 0&&(x=""+h.key),"key"in h){g={};for(var T in h)T!=="key"&&(g[T]=h[T])}else g=h;return h=g.ref,{$$typeof:s,type:o,key:x,ref:h!==void 0?h:null,props:g}}return iu.Fragment=e,iu.jsx=n,iu.jsxs=n,iu}var f2;function Db(){return f2||(f2=1,s1.exports=Ob()),s1.exports}var R=Db(),a1={exports:{}},$t={};var g2;function Mb(){if(g2)return $t;g2=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),g=Symbol.for("react.consumer"),x=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),P=Symbol.iterator;function B(K){return K===null||typeof K!="object"?null:(K=P&&K[P]||K["@@iterator"],typeof K=="function"?K:null)}var ee={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ne=Object.assign,ae={};function tt(K,se,ve){this.props=K,this.context=se,this.refs=ae,this.updater=ve||ee}tt.prototype.isReactComponent={},tt.prototype.setState=function(K,se){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,se,"setState")},tt.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function ze(){}ze.prototype=tt.prototype;function fe(K,se,ve){this.props=K,this.context=se,this.refs=ae,this.updater=ve||ee}var Ge=fe.prototype=new ze;Ge.constructor=fe,ne(Ge,tt.prototype),Ge.isPureReactComponent=!0;var gt=Array.isArray;function Qe(){}var F={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function U(K,se,ve){var Ce=ve.ref;return{$$typeof:s,type:K,key:se,ref:Ce!==void 0?Ce:null,props:ve}}function J(K,se){return U(K.type,se,K.props)}function X(K){return typeof K=="object"&&K!==null&&K.$$typeof===s}function Y(K){var se={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(ve){return se[ve]})}var G=/\/+/g;function ot(K,se){return typeof K=="object"&&K!==null&&K.key!=null?Y(""+K.key):se.toString(36)}function oe(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(Qe,Qe):(K.status="pending",K.then(function(se){K.status==="pending"&&(K.status="fulfilled",K.value=se)},function(se){K.status==="pending"&&(K.status="rejected",K.reason=se)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function le(K,se,ve,Ce,Le){var me=typeof K;(me==="undefined"||me==="boolean")&&(K=null);var rt=!1;if(K===null)rt=!0;else switch(me){case"bigint":case"string":case"number":rt=!0;break;case"object":switch(K.$$typeof){case s:case e:rt=!0;break;case C:return rt=K._init,le(rt(K._payload),se,ve,Ce,Le)}}if(rt)return Le=Le(K),rt=Ce===""?"."+ot(K,0):Ce,gt(Le)?(ve="",rt!=null&&(ve=rt.replace(G,"$&/")+"/"),le(Le,se,ve,"",function(sn){return sn})):Le!=null&&(X(Le)&&(Le=J(Le,ve+(Le.key==null||K&&K.key===Le.key?"":(""+Le.key).replace(G,"$&/")+"/")+rt)),se.push(Le)),1;rt=0;var mt=Ce===""?".":Ce+":";if(gt(K))for(var Ct=0;Ct<K.length;Ct++)Ce=K[Ct],me=mt+ot(Ce,Ct),rt+=le(Ce,se,ve,me,Le);else if(Ct=B(K),typeof Ct=="function")for(K=Ct.call(K),Ct=0;!(Ce=K.next()).done;)Ce=Ce.value,me=mt+ot(Ce,Ct++),rt+=le(Ce,se,ve,me,Le);else if(me==="object"){if(typeof K.then=="function")return le(oe(K),se,ve,Ce,Le);throw se=String(K),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return rt}function xe(K,se,ve){if(K==null)return K;var Ce=[],Le=0;return le(K,Ce,"","",function(me){return se.call(ve,me,Le++)}),Ce}function We(K){if(K._status===-1){var se=K._result;se=se(),se.then(function(ve){(K._status===0||K._status===-1)&&(K._status=1,K._result=ve)},function(ve){(K._status===0||K._status===-1)&&(K._status=2,K._result=ve)}),K._status===-1&&(K._status=0,K._result=se)}if(K._status===1)return K._result.default;throw K._result}var qe=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},ut={map:xe,forEach:function(K,se,ve){xe(K,function(){se.apply(this,arguments)},ve)},count:function(K){var se=0;return xe(K,function(){se++}),se},toArray:function(K){return xe(K,function(se){return se})||[]},only:function(K){if(!X(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return $t.Activity=N,$t.Children=ut,$t.Component=tt,$t.Fragment=n,$t.Profiler=h,$t.PureComponent=fe,$t.StrictMode=o,$t.Suspense=b,$t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,$t.__COMPILER_RUNTIME={__proto__:null,c:function(K){return F.H.useMemoCache(K)}},$t.cache=function(K){return function(){return K.apply(null,arguments)}},$t.cacheSignal=function(){return null},$t.cloneElement=function(K,se,ve){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var Ce=ne({},K.props),Le=K.key;if(se!=null)for(me in se.key!==void 0&&(Le=""+se.key),se)!z.call(se,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&se.ref===void 0||(Ce[me]=se[me]);var me=arguments.length-2;if(me===1)Ce.children=ve;else if(1<me){for(var rt=Array(me),mt=0;mt<me;mt++)rt[mt]=arguments[mt+2];Ce.children=rt}return U(K.type,Le,Ce)},$t.createContext=function(K){return K={$$typeof:x,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:g,_context:K},K},$t.createElement=function(K,se,ve){var Ce,Le={},me=null;if(se!=null)for(Ce in se.key!==void 0&&(me=""+se.key),se)z.call(se,Ce)&&Ce!=="key"&&Ce!=="__self"&&Ce!=="__source"&&(Le[Ce]=se[Ce]);var rt=arguments.length-2;if(rt===1)Le.children=ve;else if(1<rt){for(var mt=Array(rt),Ct=0;Ct<rt;Ct++)mt[Ct]=arguments[Ct+2];Le.children=mt}if(K&&K.defaultProps)for(Ce in rt=K.defaultProps,rt)Le[Ce]===void 0&&(Le[Ce]=rt[Ce]);return U(K,me,Le)},$t.createRef=function(){return{current:null}},$t.forwardRef=function(K){return{$$typeof:T,render:K}},$t.isValidElement=X,$t.lazy=function(K){return{$$typeof:C,_payload:{_status:-1,_result:K},_init:We}},$t.memo=function(K,se){return{$$typeof:w,type:K,compare:se===void 0?null:se}},$t.startTransition=function(K){var se=F.T,ve={};F.T=ve;try{var Ce=K(),Le=F.S;Le!==null&&Le(ve,Ce),typeof Ce=="object"&&Ce!==null&&typeof Ce.then=="function"&&Ce.then(Qe,qe)}catch(me){qe(me)}finally{se!==null&&ve.types!==null&&(se.types=ve.types),F.T=se}},$t.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},$t.use=function(K){return F.H.use(K)},$t.useActionState=function(K,se,ve){return F.H.useActionState(K,se,ve)},$t.useCallback=function(K,se){return F.H.useCallback(K,se)},$t.useContext=function(K){return F.H.useContext(K)},$t.useDebugValue=function(){},$t.useDeferredValue=function(K,se){return F.H.useDeferredValue(K,se)},$t.useEffect=function(K,se){return F.H.useEffect(K,se)},$t.useEffectEvent=function(K){return F.H.useEffectEvent(K)},$t.useId=function(){return F.H.useId()},$t.useImperativeHandle=function(K,se,ve){return F.H.useImperativeHandle(K,se,ve)},$t.useInsertionEffect=function(K,se){return F.H.useInsertionEffect(K,se)},$t.useLayoutEffect=function(K,se){return F.H.useLayoutEffect(K,se)},$t.useMemo=function(K,se){return F.H.useMemo(K,se)},$t.useOptimistic=function(K,se){return F.H.useOptimistic(K,se)},$t.useReducer=function(K,se,ve){return F.H.useReducer(K,se,ve)},$t.useRef=function(K){return F.H.useRef(K)},$t.useState=function(K){return F.H.useState(K)},$t.useSyncExternalStore=function(K,se,ve){return F.H.useSyncExternalStore(K,se,ve)},$t.useTransition=function(){return F.H.useTransition()},$t.version="19.2.0",$t}var m2;function ag(){return m2||(m2=1,a1.exports=Mb()),a1.exports}var he=ag();const Ke=qd(he);var o1={exports:{}},su={},l1={exports:{}},c1={};var p2;function kb(){return p2||(p2=1,(function(s){function e(le,xe){var We=le.length;le.push(xe);e:for(;0<We;){var qe=We-1>>>1,ut=le[qe];if(0<h(ut,xe))le[qe]=xe,le[We]=ut,We=qe;else break e}}function n(le){return le.length===0?null:le[0]}function o(le){if(le.length===0)return null;var xe=le[0],We=le.pop();if(We!==xe){le[0]=We;e:for(var qe=0,ut=le.length,K=ut>>>1;qe<K;){var se=2*(qe+1)-1,ve=le[se],Ce=se+1,Le=le[Ce];if(0>h(ve,We))Ce<ut&&0>h(Le,ve)?(le[qe]=Le,le[Ce]=We,qe=Ce):(le[qe]=ve,le[se]=We,qe=se);else if(Ce<ut&&0>h(Le,We))le[qe]=Le,le[Ce]=We,qe=Ce;else break e}}return xe}function h(le,xe){var We=le.sortIndex-xe.sortIndex;return We!==0?We:le.id-xe.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var g=performance;s.unstable_now=function(){return g.now()}}else{var x=Date,T=x.now();s.unstable_now=function(){return x.now()-T}}var b=[],w=[],C=1,N=null,P=3,B=!1,ee=!1,ne=!1,ae=!1,tt=typeof setTimeout=="function"?setTimeout:null,ze=typeof clearTimeout=="function"?clearTimeout:null,fe=typeof setImmediate<"u"?setImmediate:null;function Ge(le){for(var xe=n(w);xe!==null;){if(xe.callback===null)o(w);else if(xe.startTime<=le)o(w),xe.sortIndex=xe.expirationTime,e(b,xe);else break;xe=n(w)}}function gt(le){if(ne=!1,Ge(le),!ee)if(n(b)!==null)ee=!0,Qe||(Qe=!0,Y());else{var xe=n(w);xe!==null&&oe(gt,xe.startTime-le)}}var Qe=!1,F=-1,z=5,U=-1;function J(){return ae?!0:!(s.unstable_now()-U<z)}function X(){if(ae=!1,Qe){var le=s.unstable_now();U=le;var xe=!0;try{e:{ee=!1,ne&&(ne=!1,ze(F),F=-1),B=!0;var We=P;try{t:{for(Ge(le),N=n(b);N!==null&&!(N.expirationTime>le&&J());){var qe=N.callback;if(typeof qe=="function"){N.callback=null,P=N.priorityLevel;var ut=qe(N.expirationTime<=le);if(le=s.unstable_now(),typeof ut=="function"){N.callback=ut,Ge(le),xe=!0;break t}N===n(b)&&o(b),Ge(le)}else o(b);N=n(b)}if(N!==null)xe=!0;else{var K=n(w);K!==null&&oe(gt,K.startTime-le),xe=!1}}break e}finally{N=null,P=We,B=!1}xe=void 0}}finally{xe?Y():Qe=!1}}}var Y;if(typeof fe=="function")Y=function(){fe(X)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,ot=G.port2;G.port1.onmessage=X,Y=function(){ot.postMessage(null)}}else Y=function(){tt(X,0)};function oe(le,xe){F=tt(function(){le(s.unstable_now())},xe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(le){le.callback=null},s.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<le?Math.floor(1e3/le):5},s.unstable_getCurrentPriorityLevel=function(){return P},s.unstable_next=function(le){switch(P){case 1:case 2:case 3:var xe=3;break;default:xe=P}var We=P;P=xe;try{return le()}finally{P=We}},s.unstable_requestPaint=function(){ae=!0},s.unstable_runWithPriority=function(le,xe){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var We=P;P=le;try{return xe()}finally{P=We}},s.unstable_scheduleCallback=function(le,xe,We){var qe=s.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?qe+We:qe):We=qe,le){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=We+ut,le={id:C++,callback:xe,priorityLevel:le,startTime:We,expirationTime:ut,sortIndex:-1},We>qe?(le.sortIndex=We,e(w,le),n(b)===null&&le===n(w)&&(ne?(ze(F),F=-1):ne=!0,oe(gt,We-qe))):(le.sortIndex=ut,e(b,le),ee||B||(ee=!0,Qe||(Qe=!0,Y()))),le},s.unstable_shouldYield=J,s.unstable_wrapCallback=function(le){var xe=P;return function(){var We=P;P=xe;try{return le.apply(this,arguments)}finally{P=We}}}})(c1)),c1}var y2;function Lb(){return y2||(y2=1,l1.exports=kb()),l1.exports}var u1={exports:{}},Ei={};var x2;function Pb(){if(x2)return Ei;x2=1;var s=ag();function e(b){var w="https://react.dev/errors/"+b;if(1<arguments.length){w+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)w+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+b+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var o={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},h=Symbol.for("react.portal");function g(b,w,C){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:N==null?null:""+N,children:b,containerInfo:w,implementation:C}}var x=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function T(b,w){if(b==="font")return"";if(typeof w=="string")return w==="use-credentials"?w:""}return Ei.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Ei.createPortal=function(b,w){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w||w.nodeType!==1&&w.nodeType!==9&&w.nodeType!==11)throw Error(e(299));return g(b,w,null,C)},Ei.flushSync=function(b){var w=x.T,C=o.p;try{if(x.T=null,o.p=2,b)return b()}finally{x.T=w,o.p=C,o.d.f()}},Ei.preconnect=function(b,w){typeof b=="string"&&(w?(w=w.crossOrigin,w=typeof w=="string"?w==="use-credentials"?w:"":void 0):w=null,o.d.C(b,w))},Ei.prefetchDNS=function(b){typeof b=="string"&&o.d.D(b)},Ei.preinit=function(b,w){if(typeof b=="string"&&w&&typeof w.as=="string"){var C=w.as,N=T(C,w.crossOrigin),P=typeof w.integrity=="string"?w.integrity:void 0,B=typeof w.fetchPriority=="string"?w.fetchPriority:void 0;C==="style"?o.d.S(b,typeof w.precedence=="string"?w.precedence:void 0,{crossOrigin:N,integrity:P,fetchPriority:B}):C==="script"&&o.d.X(b,{crossOrigin:N,integrity:P,fetchPriority:B,nonce:typeof w.nonce=="string"?w.nonce:void 0})}},Ei.preinitModule=function(b,w){if(typeof b=="string")if(typeof w=="object"&&w!==null){if(w.as==null||w.as==="script"){var C=T(w.as,w.crossOrigin);o.d.M(b,{crossOrigin:C,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0})}}else w==null&&o.d.M(b)},Ei.preload=function(b,w){if(typeof b=="string"&&typeof w=="object"&&w!==null&&typeof w.as=="string"){var C=w.as,N=T(C,w.crossOrigin);o.d.L(b,C,{crossOrigin:N,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0,type:typeof w.type=="string"?w.type:void 0,fetchPriority:typeof w.fetchPriority=="string"?w.fetchPriority:void 0,referrerPolicy:typeof w.referrerPolicy=="string"?w.referrerPolicy:void 0,imageSrcSet:typeof w.imageSrcSet=="string"?w.imageSrcSet:void 0,imageSizes:typeof w.imageSizes=="string"?w.imageSizes:void 0,media:typeof w.media=="string"?w.media:void 0})}},Ei.preloadModule=function(b,w){if(typeof b=="string")if(w){var C=T(w.as,w.crossOrigin);o.d.m(b,{as:typeof w.as=="string"&&w.as!=="script"?w.as:void 0,crossOrigin:C,integrity:typeof w.integrity=="string"?w.integrity:void 0})}else o.d.m(b)},Ei.requestFormReset=function(b){o.d.r(b)},Ei.unstable_batchedUpdates=function(b,w){return b(w)},Ei.useFormState=function(b,w,C){return x.H.useFormState(b,w,C)},Ei.useFormStatus=function(){return x.H.useHostTransitionStatus()},Ei.version="19.2.0",Ei}var E2;function AE(){if(E2)return u1.exports;E2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),u1.exports=Pb(),u1.exports}var w2;function Bb(){if(w2)return su;w2=1;var s=Lb(),e=ag(),n=AE();function o(t){var i="https://react.dev/errors/"+t;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function g(t){var i=t,c=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(c=i.return),t=i.return;while(t)}return i.tag===3?c:null}function x(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function T(t){if(t.tag===31){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function b(t){if(g(t)!==t)throw Error(o(188))}function w(t){var i=t.alternate;if(!i){if(i=g(t),i===null)throw Error(o(188));return i!==t?null:t}for(var c=t,f=i;;){var E=c.return;if(E===null)break;var A=E.alternate;if(A===null){if(f=E.return,f!==null){c=f;continue}break}if(E.child===A.child){for(A=E.child;A;){if(A===c)return b(E),t;if(A===f)return b(E),i;A=A.sibling}throw Error(o(188))}if(c.return!==f.return)c=E,f=A;else{for(var O=!1,V=E.child;V;){if(V===c){O=!0,c=E,f=A;break}if(V===f){O=!0,f=E,c=A;break}V=V.sibling}if(!O){for(V=A.child;V;){if(V===c){O=!0,c=A,f=E;break}if(V===f){O=!0,f=A,c=E;break}V=V.sibling}if(!O)throw Error(o(189))}}if(c.alternate!==f)throw Error(o(190))}if(c.tag!==3)throw Error(o(188));return c.stateNode.current===c?t:i}function C(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t;for(t=t.child;t!==null;){if(i=C(t),i!==null)return i;t=t.sibling}return null}var N=Object.assign,P=Symbol.for("react.element"),B=Symbol.for("react.transitional.element"),ee=Symbol.for("react.portal"),ne=Symbol.for("react.fragment"),ae=Symbol.for("react.strict_mode"),tt=Symbol.for("react.profiler"),ze=Symbol.for("react.consumer"),fe=Symbol.for("react.context"),Ge=Symbol.for("react.forward_ref"),gt=Symbol.for("react.suspense"),Qe=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function Y(t){return t===null||typeof t!="object"?null:(t=X&&t[X]||t["@@iterator"],typeof t=="function"?t:null)}var G=Symbol.for("react.client.reference");function ot(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===G?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ne:return"Fragment";case tt:return"Profiler";case ae:return"StrictMode";case gt:return"Suspense";case Qe:return"SuspenseList";case U:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case ee:return"Portal";case fe:return t.displayName||"Context";case ze:return(t._context.displayName||"Context")+".Consumer";case Ge:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case F:return i=t.displayName||null,i!==null?i:ot(t.type)||"Memo";case z:i=t._payload,t=t._init;try{return ot(t(i))}catch{}}return null}var oe=Array.isArray,le=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,We={pending:!1,data:null,method:null,action:null},qe=[],ut=-1;function K(t){return{current:t}}function se(t){0>ut||(t.current=qe[ut],qe[ut]=null,ut--)}function ve(t,i){ut++,qe[ut]=t.current,t.current=i}var Ce=K(null),Le=K(null),me=K(null),rt=K(null);function mt(t,i){switch(ve(me,i),ve(Le,t),ve(Ce,null),i.nodeType){case 9:case 11:t=(t=i.documentElement)&&(t=t.namespaceURI)?Ly(t):0;break;default:if(t=i.tagName,i=i.namespaceURI)i=Ly(i),t=Py(i,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}se(Ce),ve(Ce,t)}function Ct(){se(Ce),se(Le),se(me)}function sn(t){t.memoizedState!==null&&ve(rt,t);var i=Ce.current,c=Py(i,t.type);i!==c&&(ve(Le,t),ve(Ce,c))}function Qt(t){Le.current===t&&(se(Ce),se(Le)),rt.current===t&&(se(rt),eu._currentValue=We)}var En,Ot;function gn(t){if(En===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);En=i&&i[1]||"",Ot=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+En+t+Ot}var On=!1;function Me(t,i){if(!t||On)return"";On=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var Pe=function(){throw Error()};if(Object.defineProperty(Pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pe,[])}catch(be){var Ee=be}Reflect.construct(t,[],Pe)}else{try{Pe.call()}catch(be){Ee=be}t.call(Pe.prototype)}}else{try{throw Error()}catch(be){Ee=be}(Pe=t())&&typeof Pe.catch=="function"&&Pe.catch(function(){})}}catch(be){if(be&&Ee&&typeof be.stack=="string")return[be.stack,Ee.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=f.DetermineComponentFrameRoot(),O=A[0],V=A[1];if(O&&V){var Q=O.split(`
`),ye=V.split(`
`);for(E=f=0;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;for(;E<ye.length&&!ye[E].includes("DetermineComponentFrameRoot");)E++;if(f===Q.length||E===ye.length)for(f=Q.length-1,E=ye.length-1;1<=f&&0<=E&&Q[f]!==ye[E];)E--;for(;1<=f&&0<=E;f--,E--)if(Q[f]!==ye[E]){if(f!==1||E!==1)do if(f--,E--,0>E||Q[f]!==ye[E]){var Re=`
`+Q[f].replace(" at new "," at ");return t.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",t.displayName)),Re}while(1<=f&&0<=E);break}}}finally{On=!1,Error.prepareStackTrace=c}return(c=t?t.displayName||t.name:"")?gn(c):""}function ge(t,i){switch(t.tag){case 26:case 27:case 5:return gn(t.type);case 16:return gn("Lazy");case 13:return t.child!==i&&i!==null?gn("Suspense Fallback"):gn("Suspense");case 19:return gn("SuspenseList");case 0:case 15:return Me(t.type,!1);case 11:return Me(t.type.render,!1);case 1:return Me(t.type,!0);case 31:return gn("Activity");default:return""}}function Ne(t){try{var i="",c=null;do i+=ge(t,c),c=t,t=t.return;while(t);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Ve=Object.prototype.hasOwnProperty,it=s.unstable_scheduleCallback,Ie=s.unstable_cancelCallback,Pt=s.unstable_shouldYield,et=s.unstable_requestPaint,ht=s.unstable_now,Un=s.unstable_getCurrentPriorityLevel,Bt=s.unstable_ImmediatePriority,Kn=s.unstable_UserBlockingPriority,lr=s.unstable_NormalPriority,cr=s.unstable_LowPriority,Zr=s.unstable_IdlePriority,Ti=s.log,ki=s.unstable_setDisableYieldValue,tn=null,Fe=null;function Ht(t){if(typeof Ti=="function"&&ki(t),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(tn,t)}catch{}}var At=Math.clz32?Math.clz32:Xr,wn=Math.log,vr=Math.LN2;function Xr(t){return t>>>=0,t===0?32:31-(wn(t)/vr|0)|0}var Tr=256,Vt=262144,Zt=4194304;function jn(t){var i=t&42;if(i!==0)return i;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Mr(t,i,c){var f=t.pendingLanes;if(f===0)return 0;var E=0,A=t.suspendedLanes,O=t.pingedLanes;t=t.warmLanes;var V=f&134217727;return V!==0?(f=V&~A,f!==0?E=jn(f):(O&=V,O!==0?E=jn(O):c||(c=V&~t,c!==0&&(E=jn(c))))):(V=f&~A,V!==0?E=jn(V):O!==0?E=jn(O):c||(c=f&~t,c!==0&&(E=jn(c)))),E===0?0:i!==0&&i!==E&&(i&A)===0&&(A=E&-E,c=i&-i,A>=c||A===32&&(c&4194048)!==0)?i:E}function dt(t,i){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&i)===0}function nn(t,i){switch(t){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function re(){var t=Zt;return Zt<<=1,(Zt&62914560)===0&&(Zt=4194304),t}function Se(t){for(var i=[],c=0;31>c;c++)i.push(t);return i}function je(t,i){t.pendingLanes|=i,i!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Xe(t,i,c,f,E,A){var O=t.pendingLanes;t.pendingLanes=c,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=c,t.entangledLanes&=c,t.errorRecoveryDisabledLanes&=c,t.shellSuspendCounter=0;var V=t.entanglements,Q=t.expirationTimes,ye=t.hiddenUpdates;for(c=O&~c;0<c;){var Re=31-At(c),Pe=1<<Re;V[Re]=0,Q[Re]=-1;var Ee=ye[Re];if(Ee!==null)for(ye[Re]=null,Re=0;Re<Ee.length;Re++){var be=Ee[Re];be!==null&&(be.lane&=-536870913)}c&=~Pe}f!==0&&st(t,f,0),A!==0&&E===0&&t.tag!==0&&(t.suspendedLanes|=A&~(O&~i))}function st(t,i,c){t.pendingLanes|=i,t.suspendedLanes&=~i;var f=31-At(i);t.entangledLanes|=i,t.entanglements[f]=t.entanglements[f]|1073741824|c&261930}function pt(t,i){var c=t.entangledLanes|=i;for(t=t.entanglements;c;){var f=31-At(c),E=1<<f;E&i|t[f]&i&&(t[f]|=i),c&=~E}}function at(t,i){var c=i&-i;return c=(c&42)!==0?1:Gt(c),(c&(t.suspendedLanes|i))!==0?0:c}function Gt(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Rt(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Ut(){var t=xe.p;return t!==0?t:(t=window.event,t===void 0?32:s2(t.type))}function Oe(t,i){var c=xe.p;try{return xe.p=t,i()}finally{xe.p=c}}var an=Math.random().toString(36).slice(2),yt="__reactFiber$"+an,Mt="__reactProps$"+an,er="__reactContainer$"+an,fi="__reactEvents$"+an,Ps="__reactListeners$"+an,ri="__reactHandles$"+an,za="__reactResources$"+an,Li="__reactMarker$"+an;function Yr(t){delete t[yt],delete t[Mt],delete t[fi],delete t[Ps],delete t[ri]}function Qn(t){var i=t[yt];if(i)return i;for(var c=t.parentNode;c;){if(i=c[er]||c[yt]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(t=Hy(t);t!==null;){if(c=t[yt])return c;t=Hy(t)}return i}t=c,c=t.parentNode}return null}function un(t){if(t=t[yt]||t[er]){var i=t.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return t}return null}function Jr(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t.stateNode;throw Error(o(33))}function kr(t){var i=t[za];return i||(i=t[za]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ar(t){t[Li]=!0}var Be=new Set,W={};function Te(t,i){Je(t,i),Je(t+"Capture",i)}function Je(t,i){for(W[t]=i,t=0;t<i.length;t++)Be.add(i[t])}var xt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nt={},lt={};function ft(t){return Ve.call(lt,t)?!0:Ve.call(nt,t)?!1:xt.test(t)?lt[t]=!0:(nt[t]=!0,!1)}function hn(t,i,c){if(ft(i))if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":t.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){t.removeAttribute(i);return}}t.setAttribute(i,""+c)}}function dn(t,i,c){if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttribute(i,""+c)}}function In(t,i,c,f){if(f===null)t.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(c);return}t.setAttributeNS(i,c,""+f)}}function jt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function kn(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Pi(t,i,c){var f=Object.getOwnPropertyDescriptor(t.constructor.prototype,i);if(!t.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,A=f.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return E.call(this)},set:function(O){c=""+O,A.call(this,O)}}),Object.defineProperty(t,i,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(O){c=""+O},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function Nt(t){if(!t._valueTracker){var i=kn(t)?"checked":"value";t._valueTracker=Pi(t,i,""+t[i])}}function tr(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var c=i.getValue(),f="";return t&&(f=kn(t)?t.checked?"true":"false":t.value),t=f,t!==c?(i.setValue(t),!0):!1}function Cr(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var gi=/[\n"\\]/g;function on(t){return t.replace(gi,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Er(t,i,c,f,E,A,O,V){t.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?t.type=O:t.removeAttribute("type"),i!=null?O==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+jt(i)):t.value!==""+jt(i)&&(t.value=""+jt(i)):O!=="submit"&&O!=="reset"||t.removeAttribute("value"),i!=null?H(t,O,jt(i)):c!=null?H(t,O,jt(c)):f!=null&&t.removeAttribute("value"),E==null&&A!=null&&(t.defaultChecked=!!A),E!=null&&(t.checked=E&&typeof E!="function"&&typeof E!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?t.name=""+jt(V):t.removeAttribute("name")}function de(t,i,c,f,E,A,O,V){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(t.type=A),i!=null||c!=null){if(!(A!=="submit"&&A!=="reset"||i!=null)){Nt(t);return}c=c!=null?""+jt(c):"",i=i!=null?""+jt(i):c,V||i===t.value||(t.value=i),t.defaultValue=i}f=f??E,f=typeof f!="function"&&typeof f!="symbol"&&!!f,t.checked=V?t.checked:!!f,t.defaultChecked=!!f,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(t.name=O),Nt(t)}function H(t,i,c){i==="number"&&Cr(t.ownerDocument)===t||t.defaultValue===""+c||(t.defaultValue=""+c)}function bt(t,i,c,f){if(t=t.options,i){i={};for(var E=0;E<c.length;E++)i["$"+c[E]]=!0;for(c=0;c<t.length;c++)E=i.hasOwnProperty("$"+t[c].value),t[c].selected!==E&&(t[c].selected=E),E&&f&&(t[c].defaultSelected=!0)}else{for(c=""+jt(c),i=null,E=0;E<t.length;E++){if(t[E].value===c){t[E].selected=!0,f&&(t[E].defaultSelected=!0);return}i!==null||t[E].disabled||(i=t[E])}i!==null&&(i.selected=!0)}}function wr(t,i,c){if(i!=null&&(i=""+jt(i),i!==t.value&&(t.value=i),c==null)){t.defaultValue!==i&&(t.defaultValue=i);return}t.defaultValue=c!=null?""+jt(c):""}function Lr(t,i,c,f){if(i==null){if(f!=null){if(c!=null)throw Error(o(92));if(oe(f)){if(1<f.length)throw Error(o(93));f=f[0]}c=f}c==null&&(c=""),i=c}c=jt(i),t.defaultValue=c,f=t.textContent,f===c&&f!==""&&f!==null&&(t.value=f),Nt(t)}function mi(t,i){if(i){var c=t.firstChild;if(c&&c===t.lastChild&&c.nodeType===3){c.nodeValue=i;return}}t.textContent=i}var Ha=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $r(t,i,c){var f=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="":f?t.setProperty(i,c):typeof c!="number"||c===0||Ha.has(i)?i==="float"?t.cssFloat=c:t[i]=(""+c).trim():t[i]=c+"px"}function St(t,i,c){if(i!=null&&typeof i!="object")throw Error(o(62));if(t=t.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?t.setProperty(f,""):f==="float"?t.cssFloat="":t[f]="");for(var E in i)f=i[E],i.hasOwnProperty(E)&&c[E]!==f&&$r(t,E,f)}else for(var A in i)i.hasOwnProperty(A)&&$r(t,A,i[A])}function zn(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vs(t){return Bs.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function pi(){}var ia=null;function Bi(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var nr=null,yi=null;function xi(t){var i=un(t);if(i&&(t=i.stateNode)){var c=t[Mt]||null;e:switch(t=i.stateNode,i.type){case"input":if(Er(t,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=t;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+on(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var f=c[i];if(f!==t&&f.form===t.form){var E=f[Mt]||null;if(!E)throw Error(o(90));Er(f,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(i=0;i<c.length;i++)f=c[i],f.form===t.form&&tr(f)}break e;case"textarea":wr(t,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&bt(t,!!c.multiple,i,!1)}}}var Dt=!1;function Us(t,i,c){if(Dt)return t(i,c);Dt=!0;try{var f=t(i);return f}finally{if(Dt=!1,(nr!==null||yi!==null)&&(Oh(),nr&&(i=nr,t=yi,yi=nr=null,xi(i),t)))for(i=0;i<t.length;i++)xi(t[i])}}function Ft(t,i){var c=t.stateNode;if(c===null)return null;var f=c[Mt]||null;if(f===null)return null;c=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(t=t.type,f=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!f;break e;default:t=!1}if(t)return null;if(c&&typeof c!="function")throw Error(o(231,i,typeof c));return c}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sa=!1;if(Hn)try{var Ln={};Object.defineProperty(Ln,"passive",{get:function(){sa=!0}}),window.addEventListener("test",Ln,Ln),window.removeEventListener("test",Ln,Ln)}catch{sa=!1}var Qi=null,Zi=null,aa=null;function Cs(){if(aa)return aa;var t,i=Zi,c=i.length,f,E="value"in Qi?Qi.value:Qi.textContent,A=E.length;for(t=0;t<c&&i[t]===E[t];t++);var O=c-t;for(f=1;f<=O&&i[c-f]===E[A-f];f++);return aa=E.slice(t,1<f?1-f:void 0)}function Ji(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function Ci(){return!0}function Vi(){return!1}function _r(t){function i(c,f,E,A,O){this._reactName=c,this._targetInst=E,this.type=f,this.nativeEvent=A,this.target=O,this.currentTarget=null;for(var V in t)t.hasOwnProperty(V)&&(c=t[V],this[V]=c?c(A):A[V]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Ci:Vi,this.isPropagationStopped=Vi,this}return N(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),i}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ur=_r(Si),Ss=N({},Si,{view:0,detail:0}),Ga=_r(Ss),Is,qa,hs,Xa=N({},Ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fs,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hs&&(hs&&t.type==="mousemove"?(Is=t.screenX-hs.screenX,qa=t.screenY-hs.screenY):qa=Is=0,hs=t),Is)},movementY:function(t){return"movementY"in t?t.movementY:qa}}),Dn=_r(Xa),Fs=N({},Xa,{dataTransfer:0}),oa=_r(Fs),$i=N({},Ss,{relatedTarget:0}),la=_r($i),we=N({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),Jt=_r(we),mr=N({},Si,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ca=_r(mr),jo=N({},Si,{data:0}),ds=_r(jo),bl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ya={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pr(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=Ya[t])?!!i[t]:!1}function fs(){return pr}var fn=N({},Ss,{key:function(t){if(t.key){var i=bl[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=Ji(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vl[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fs,charCode:function(t){return t.type==="keypress"?Ji(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ji(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ua=_r(fn),gs=N({},Xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mn=_r(gs),p=N({},Ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fs}),S=_r(p),D=N({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),j=_r(D),ce=N({},Xa,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ae=_r(ce),$e=N({},Si,{newState:0,oldState:0}),Yt=_r($e),yr=[9,13,27,32],Rn=Hn&&"CompositionEvent"in window,rr=null;Hn&&"documentMode"in document&&(rr=document.documentMode);var Ii=Hn&&"TextEvent"in window&&!rr,ms=Hn&&(!Rn||rr&&8<rr&&11>=rr),ei=" ",Ri=!1;function ha(t,i){switch(t){case"keyup":return yr.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ps(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wa=!1;function js(t,i){switch(t){case"compositionend":return ps(i);case"keypress":return i.which!==32?null:(Ri=!0,ei);case"textInput":return t=i.data,t===ei&&Ri?null:t;default:return null}}function Tl(t,i){if(Wa)return t==="compositionend"||!Rn&&ha(t,i)?(t=Cs(),aa=Zi=Qi=null,Wa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ms&&i.locale!=="ko"?null:i.data;default:return null}}var Ui={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vc(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!Ui[t.type]:i==="textarea"}function es(t,i,c,f){nr?yi?yi.push(f):yi=[f]:nr=f,i=Vh(i,"onChange"),0<i.length&&(c=new ur("onChange","change",null,c,f),t.push({event:c,listeners:i}))}var zo=null,da=null;function xf(t){Ry(t,0)}function Ho(t){var i=Jr(t);if(tr(i))return t}function ts(t,i){if(t==="change")return i}var Ku=!1;if(Hn){var Go;if(Hn){var fa="oninput"in document;if(!fa){var _n=document.createElement("div");_n.setAttribute("oninput","return;"),fa=typeof _n.oninput=="function"}Go=fa}else Go=!1;Ku=Go&&(!document.documentMode||9<document.documentMode)}function qo(){zo&&(zo.detachEvent("onpropertychange",M),da=zo=null)}function M(t){if(t.propertyName==="value"&&Ho(da)){var i=[];es(i,da,t,Bi(t)),Us(xf,i)}}function r(t,i,c){t==="focusin"?(qo(),zo=i,da=c,zo.attachEvent("onpropertychange",M)):t==="focusout"&&qo()}function a(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ho(da)}function l(t,i){if(t==="click")return Ho(i)}function u(t,i){if(t==="input"||t==="change")return Ho(i)}function d(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var m=typeof Object.is=="function"?Object.is:d;function y(t,i){if(m(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var c=Object.keys(t),f=Object.keys(i);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var E=c[f];if(!Ve.call(i,E)||!m(t[E],i[E]))return!1}return!0}function _(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v(t,i){var c=_(t);t=0;for(var f;c;){if(c.nodeType===3){if(f=t+c.textContent.length,t<=i&&f>=i)return{node:c,offset:i-t};t=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=_(c)}}function I(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?I(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function k(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var i=Cr(t.document);i instanceof t.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)t=i.contentWindow;else break;i=Cr(t.document)}return i}function L(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}var q=Hn&&"documentMode"in document&&11>=document.documentMode,Z=null,$=null,ue=null,_e=!1;function Ze(t,i,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;_e||Z==null||Z!==Cr(f)||(f=Z,"selectionStart"in f&&L(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ue&&y(ue,f)||(ue=f,f=Vh($,"onSelect"),0<f.length&&(i=new ur("onSelect","select",null,i,c),t.push({event:i,listeners:f}),i.target=Z)))}function Ye(t,i){var c={};return c[t.toLowerCase()]=i.toLowerCase(),c["Webkit"+t]="webkit"+i,c["Moz"+t]="moz"+i,c}var He={animationend:Ye("Animation","AnimationEnd"),animationiteration:Ye("Animation","AnimationIteration"),animationstart:Ye("Animation","AnimationStart"),transitionrun:Ye("Transition","TransitionRun"),transitionstart:Ye("Transition","TransitionStart"),transitioncancel:Ye("Transition","TransitionCancel"),transitionend:Ye("Transition","TransitionEnd")},cn={},Wt={};Hn&&(Wt=document.createElement("div").style,"AnimationEvent"in window||(delete He.animationend.animation,delete He.animationiteration.animation,delete He.animationstart.animation),"TransitionEvent"in window||delete He.transitionend.transition);function Sr(t){if(cn[t])return cn[t];if(!He[t])return t;var i=He[t],c;for(c in i)if(i.hasOwnProperty(c)&&c in Wt)return cn[t]=i[c];return t}var Fi=Sr("animationend"),ii=Sr("animationiteration"),Gn=Sr("animationstart"),Wr=Sr("transitionrun"),Ni=Sr("transitionstart"),Ka=Sr("transitioncancel"),ga=Sr("transitionend"),Qu=new Map,Tc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tc.push("scrollEnd");function Rs(t,i){Qu.set(t,i),Te(i,[t])}var Zu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ys=[],Cl=0,Ef=0;function Ju(){for(var t=Cl,i=Ef=Cl=0;i<t;){var c=ys[i];ys[i++]=null;var f=ys[i];ys[i++]=null;var E=ys[i];ys[i++]=null;var A=ys[i];if(ys[i++]=null,f!==null&&E!==null){var O=f.pending;O===null?E.next=E:(E.next=O.next,O.next=E),f.pending=E}A!==0&&um(c,E,A)}}function $u(t,i,c,f){ys[Cl++]=t,ys[Cl++]=i,ys[Cl++]=c,ys[Cl++]=f,Ef|=f,t.lanes|=f,t=t.alternate,t!==null&&(t.lanes|=f)}function wf(t,i,c,f){return $u(t,i,c,f),eh(t)}function Xo(t,i){return $u(t,null,null,i),eh(t)}function um(t,i,c){t.lanes|=c;var f=t.alternate;f!==null&&(f.lanes|=c);for(var E=!1,A=t.return;A!==null;)A.childLanes|=c,f=A.alternate,f!==null&&(f.childLanes|=c),A.tag===22&&(t=A.stateNode,t===null||t._visibility&1||(E=!0)),t=A,A=A.return;return t.tag===3?(A=t.stateNode,E&&i!==null&&(E=31-At(c),t=A.hiddenUpdates,f=t[E],f===null?t[E]=[i]:f.push(i),i.lane=c|536870912),A):null}function eh(t){if(50<Yc)throw Yc=0,R0=null,Error(o(185));for(var i=t.return;i!==null;)t=i,i=t.return;return t.tag===3?t.stateNode:null}var Sl={};function fA(t,i,c,f){this.tag=t,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ns(t,i,c,f){return new fA(t,i,c,f)}function _f(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ma(t,i){var c=t.alternate;return c===null?(c=ns(t.tag,i,t.key,t.mode),c.elementType=t.elementType,c.type=t.type,c.stateNode=t.stateNode,c.alternate=t,t.alternate=c):(c.pendingProps=i,c.type=t.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=t.flags&65011712,c.childLanes=t.childLanes,c.lanes=t.lanes,c.child=t.child,c.memoizedProps=t.memoizedProps,c.memoizedState=t.memoizedState,c.updateQueue=t.updateQueue,i=t.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=t.sibling,c.index=t.index,c.ref=t.ref,c.refCleanup=t.refCleanup,c}function hm(t,i){t.flags&=65011714;var c=t.alternate;return c===null?(t.childLanes=0,t.lanes=i,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=c.childLanes,t.lanes=c.lanes,t.child=c.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=c.memoizedProps,t.memoizedState=c.memoizedState,t.updateQueue=c.updateQueue,t.type=c.type,i=c.dependencies,t.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t}function th(t,i,c,f,E,A){var O=0;if(f=t,typeof t=="function")_f(t)&&(O=1);else if(typeof t=="string")O=xb(t,c,Ce.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case U:return t=ns(31,c,i,E),t.elementType=U,t.lanes=A,t;case ne:return Yo(c.children,E,A,i);case ae:O=8,E|=24;break;case tt:return t=ns(12,c,i,E|2),t.elementType=tt,t.lanes=A,t;case gt:return t=ns(13,c,i,E),t.elementType=gt,t.lanes=A,t;case Qe:return t=ns(19,c,i,E),t.elementType=Qe,t.lanes=A,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fe:O=10;break e;case ze:O=9;break e;case Ge:O=11;break e;case F:O=14;break e;case z:O=16,f=null;break e}O=29,c=Error(o(130,t===null?"null":typeof t,"")),f=null}return i=ns(O,c,i,E),i.elementType=t,i.type=f,i.lanes=A,i}function Yo(t,i,c,f){return t=ns(7,t,f,i),t.lanes=c,t}function Af(t,i,c){return t=ns(6,t,null,i),t.lanes=c,t}function dm(t){var i=ns(18,null,null,0);return i.stateNode=t,i}function bf(t,i,c){return i=ns(4,t.children!==null?t.children:[],t.key,i),i.lanes=c,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}var fm=new WeakMap;function xs(t,i){if(typeof t=="object"&&t!==null){var c=fm.get(t);return c!==void 0?c:(i={value:t,source:i,stack:Ne(i)},fm.set(t,i),i)}return{value:t,source:i,stack:Ne(i)}}var Il=[],Rl=0,nh=null,Cc=0,Es=[],ws=0,Qa=null,zs=1,Hs="";function pa(t,i){Il[Rl++]=Cc,Il[Rl++]=nh,nh=t,Cc=i}function gm(t,i,c){Es[ws++]=zs,Es[ws++]=Hs,Es[ws++]=Qa,Qa=t;var f=zs;t=Hs;var E=32-At(f)-1;f&=~(1<<E),c+=1;var A=32-At(i)+E;if(30<A){var O=E-E%5;A=(f&(1<<O)-1).toString(32),f>>=O,E-=O,zs=1<<32-At(i)+E|c<<E|f,Hs=A+t}else zs=1<<A|c<<E|f,Hs=t}function vf(t){t.return!==null&&(pa(t,1),gm(t,1,0))}function Tf(t){for(;t===nh;)nh=Il[--Rl],Il[Rl]=null,Cc=Il[--Rl],Il[Rl]=null;for(;t===Qa;)Qa=Es[--ws],Es[ws]=null,Hs=Es[--ws],Es[ws]=null,zs=Es[--ws],Es[ws]=null}function mm(t,i){Es[ws++]=zs,Es[ws++]=Hs,Es[ws++]=Qa,zs=i.id,Hs=i.overflow,Qa=t}var si=null,hr=null,Nn=!1,Za=null,_s=!1,Cf=Error(o(519));function Ja(t){var i=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Sc(xs(i,t)),Cf}function pm(t){var i=t.stateNode,c=t.type,f=t.memoizedProps;switch(i[yt]=t,i[Mt]=f,c){case"dialog":yn("cancel",i),yn("close",i);break;case"iframe":case"object":case"embed":yn("load",i);break;case"video":case"audio":for(c=0;c<Kc.length;c++)yn(Kc[c],i);break;case"source":yn("error",i);break;case"img":case"image":case"link":yn("error",i),yn("load",i);break;case"details":yn("toggle",i);break;case"input":yn("invalid",i),de(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":yn("invalid",i);break;case"textarea":yn("invalid",i),Lr(i,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||f.suppressHydrationWarning===!0||My(i.textContent,c)?(f.popover!=null&&(yn("beforetoggle",i),yn("toggle",i)),f.onScroll!=null&&yn("scroll",i),f.onScrollEnd!=null&&yn("scrollend",i),f.onClick!=null&&(i.onclick=pi),i=!0):i=!1,i||Ja(t,!0)}function ym(t){for(si=t.return;si;)switch(si.tag){case 5:case 31:case 13:_s=!1;return;case 27:case 3:_s=!0;return;default:si=si.return}}function Nl(t){if(t!==si)return!1;if(!Nn)return ym(t),Nn=!0,!1;var i=t.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=t.type,c=!(c!=="form"&&c!=="button")||G0(t.type,t.memoizedProps)),c=!c),c&&hr&&Ja(t),ym(t),i===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));hr=zy(t)}else if(i===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));hr=zy(t)}else i===27?(i=hr,fo(t.type)?(t=K0,K0=null,hr=t):hr=i):hr=si?bs(t.stateNode.nextSibling):null;return!0}function Wo(){hr=si=null,Nn=!1}function Sf(){var t=Za;return t!==null&&(Gi===null?Gi=t:Gi.push.apply(Gi,t),Za=null),t}function Sc(t){Za===null?Za=[t]:Za.push(t)}var If=K(null),Ko=null,ya=null;function $a(t,i,c){ve(If,i._currentValue),i._currentValue=c}function xa(t){t._currentValue=If.current,se(If)}function Rf(t,i,c){for(;t!==null;){var f=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),t===c)break;t=t.return}}function Nf(t,i,c,f){var E=t.child;for(E!==null&&(E.return=t);E!==null;){var A=E.dependencies;if(A!==null){var O=E.child;A=A.firstContext;e:for(;A!==null;){var V=A;A=E;for(var Q=0;Q<i.length;Q++)if(V.context===i[Q]){A.lanes|=c,V=A.alternate,V!==null&&(V.lanes|=c),Rf(A.return,c,t),f||(O=null);break e}A=V.next}}else if(E.tag===18){if(O=E.return,O===null)throw Error(o(341));O.lanes|=c,A=O.alternate,A!==null&&(A.lanes|=c),Rf(O,c,t),O=null}else O=E.child;if(O!==null)O.return=E;else for(O=E;O!==null;){if(O===t){O=null;break}if(E=O.sibling,E!==null){E.return=O.return,O=E;break}O=O.return}E=O}}function Ol(t,i,c,f){t=null;for(var E=i,A=!1;E!==null;){if(!A){if((E.flags&524288)!==0)A=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var O=E.alternate;if(O===null)throw Error(o(387));if(O=O.memoizedProps,O!==null){var V=E.type;m(E.pendingProps.value,O.value)||(t!==null?t.push(V):t=[V])}}else if(E===rt.current){if(O=E.alternate,O===null)throw Error(o(387));O.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(t!==null?t.push(eu):t=[eu])}E=E.return}t!==null&&Nf(i,t,c,f),i.flags|=262144}function rh(t){for(t=t.firstContext;t!==null;){if(!m(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Qo(t){Ko=t,ya=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function ai(t){return xm(Ko,t)}function ih(t,i){return Ko===null&&Qo(t),xm(t,i)}function xm(t,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},ya===null){if(t===null)throw Error(o(308));ya=i,t.dependencies={lanes:0,firstContext:i},t.flags|=524288}else ya=ya.next=i;return c}var gA=typeof AbortController<"u"?AbortController:function(){var t=[],i=this.signal={aborted:!1,addEventListener:function(c,f){t.push(f)}};this.abort=function(){i.aborted=!0,t.forEach(function(c){return c()})}},mA=s.unstable_scheduleCallback,pA=s.unstable_NormalPriority,Ur={$$typeof:fe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Of(){return{controller:new gA,data:new Map,refCount:0}}function Ic(t){t.refCount--,t.refCount===0&&mA(pA,function(){t.controller.abort()})}var Rc=null,Df=0,Dl=0,Ml=null;function yA(t,i){if(Rc===null){var c=Rc=[];Df=0,Dl=L0(),Ml={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Df++,i.then(Em,Em),i}function Em(){if(--Df===0&&Rc!==null){Ml!==null&&(Ml.status="fulfilled");var t=Rc;Rc=null,Dl=0,Ml=null;for(var i=0;i<t.length;i++)(0,t[i])()}}function xA(t,i){var c=[],f={status:"pending",value:null,reason:null,then:function(E){c.push(E)}};return t.then(function(){f.status="fulfilled",f.value=i;for(var E=0;E<c.length;E++)(0,c[E])(i)},function(E){for(f.status="rejected",f.reason=E,E=0;E<c.length;E++)(0,c[E])(void 0)}),f}var wm=le.S;le.S=function(t,i){ry=ht(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&yA(t,i),wm!==null&&wm(t,i)};var Zo=K(null);function Mf(){var t=Zo.current;return t!==null?t:ir.pooledCache}function sh(t,i){i===null?ve(Zo,Zo.current):ve(Zo,i.pool)}function _m(){var t=Mf();return t===null?null:{parent:Ur._currentValue,pool:t}}var kl=Error(o(460)),kf=Error(o(474)),ah=Error(o(542)),oh={then:function(){}};function Am(t){return t=t.status,t==="fulfilled"||t==="rejected"}function bm(t,i,c){switch(c=t[c],c===void 0?t.push(i):c!==i&&(i.then(pi,pi),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,Tm(t),t;default:if(typeof i.status=="string")i.then(pi,pi);else{if(t=ir,t!==null&&100<t.shellSuspendCounter)throw Error(o(482));t=i,t.status="pending",t.then(function(f){if(i.status==="pending"){var E=i;E.status="fulfilled",E.value=f}},function(f){if(i.status==="pending"){var E=i;E.status="rejected",E.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,Tm(t),t}throw $o=i,kl}}function Jo(t){try{var i=t._init;return i(t._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?($o=c,kl):c}}var $o=null;function vm(){if($o===null)throw Error(o(459));var t=$o;return $o=null,t}function Tm(t){if(t===kl||t===ah)throw Error(o(483))}var Ll=null,Nc=0;function lh(t){var i=Nc;return Nc+=1,Ll===null&&(Ll=[]),bm(Ll,t,i)}function Oc(t,i){i=i.props.ref,t.ref=i!==void 0?i:null}function ch(t,i){throw i.$$typeof===P?Error(o(525)):(t=Object.prototype.toString.call(i),Error(o(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t)))}function Cm(t){function i(ie,te){if(t){var pe=ie.deletions;pe===null?(ie.deletions=[te],ie.flags|=16):pe.push(te)}}function c(ie,te){if(!t)return null;for(;te!==null;)i(ie,te),te=te.sibling;return null}function f(ie){for(var te=new Map;ie!==null;)ie.key!==null?te.set(ie.key,ie):te.set(ie.index,ie),ie=ie.sibling;return te}function E(ie,te){return ie=ma(ie,te),ie.index=0,ie.sibling=null,ie}function A(ie,te,pe){return ie.index=pe,t?(pe=ie.alternate,pe!==null?(pe=pe.index,pe<te?(ie.flags|=67108866,te):pe):(ie.flags|=67108866,te)):(ie.flags|=1048576,te)}function O(ie){return t&&ie.alternate===null&&(ie.flags|=67108866),ie}function V(ie,te,pe,ke){return te===null||te.tag!==6?(te=Af(pe,ie.mode,ke),te.return=ie,te):(te=E(te,pe),te.return=ie,te)}function Q(ie,te,pe,ke){var kt=pe.type;return kt===ne?Re(ie,te,pe.props.children,ke,pe.key):te!==null&&(te.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===z&&Jo(kt)===te.type)?(te=E(te,pe.props),Oc(te,pe),te.return=ie,te):(te=th(pe.type,pe.key,pe.props,null,ie.mode,ke),Oc(te,pe),te.return=ie,te)}function ye(ie,te,pe,ke){return te===null||te.tag!==4||te.stateNode.containerInfo!==pe.containerInfo||te.stateNode.implementation!==pe.implementation?(te=bf(pe,ie.mode,ke),te.return=ie,te):(te=E(te,pe.children||[]),te.return=ie,te)}function Re(ie,te,pe,ke,kt){return te===null||te.tag!==7?(te=Yo(pe,ie.mode,ke,kt),te.return=ie,te):(te=E(te,pe),te.return=ie,te)}function Pe(ie,te,pe){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=Af(""+te,ie.mode,pe),te.return=ie,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case B:return pe=th(te.type,te.key,te.props,null,ie.mode,pe),Oc(pe,te),pe.return=ie,pe;case ee:return te=bf(te,ie.mode,pe),te.return=ie,te;case z:return te=Jo(te),Pe(ie,te,pe)}if(oe(te)||Y(te))return te=Yo(te,ie.mode,pe,null),te.return=ie,te;if(typeof te.then=="function")return Pe(ie,lh(te),pe);if(te.$$typeof===fe)return Pe(ie,ih(ie,te),pe);ch(ie,te)}return null}function Ee(ie,te,pe,ke){var kt=te!==null?te.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return kt!==null?null:V(ie,te,""+pe,ke);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case B:return pe.key===kt?Q(ie,te,pe,ke):null;case ee:return pe.key===kt?ye(ie,te,pe,ke):null;case z:return pe=Jo(pe),Ee(ie,te,pe,ke)}if(oe(pe)||Y(pe))return kt!==null?null:Re(ie,te,pe,ke,null);if(typeof pe.then=="function")return Ee(ie,te,lh(pe),ke);if(pe.$$typeof===fe)return Ee(ie,te,ih(ie,pe),ke);ch(ie,pe)}return null}function be(ie,te,pe,ke,kt){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return ie=ie.get(pe)||null,V(te,ie,""+ke,kt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case B:return ie=ie.get(ke.key===null?pe:ke.key)||null,Q(te,ie,ke,kt);case ee:return ie=ie.get(ke.key===null?pe:ke.key)||null,ye(te,ie,ke,kt);case z:return ke=Jo(ke),be(ie,te,pe,ke,kt)}if(oe(ke)||Y(ke))return ie=ie.get(pe)||null,Re(te,ie,ke,kt,null);if(typeof ke.then=="function")return be(ie,te,pe,lh(ke),kt);if(ke.$$typeof===fe)return be(ie,te,pe,ih(te,ke),kt);ch(te,ke)}return null}function vt(ie,te,pe,ke){for(var kt=null,Pn=null,Tt=te,ln=te=0,bn=null;Tt!==null&&ln<pe.length;ln++){Tt.index>ln?(bn=Tt,Tt=null):bn=Tt.sibling;var Bn=Ee(ie,Tt,pe[ln],ke);if(Bn===null){Tt===null&&(Tt=bn);break}t&&Tt&&Bn.alternate===null&&i(ie,Tt),te=A(Bn,te,ln),Pn===null?kt=Bn:Pn.sibling=Bn,Pn=Bn,Tt=bn}if(ln===pe.length)return c(ie,Tt),Nn&&pa(ie,ln),kt;if(Tt===null){for(;ln<pe.length;ln++)Tt=Pe(ie,pe[ln],ke),Tt!==null&&(te=A(Tt,te,ln),Pn===null?kt=Tt:Pn.sibling=Tt,Pn=Tt);return Nn&&pa(ie,ln),kt}for(Tt=f(Tt);ln<pe.length;ln++)bn=be(Tt,ie,ln,pe[ln],ke),bn!==null&&(t&&bn.alternate!==null&&Tt.delete(bn.key===null?ln:bn.key),te=A(bn,te,ln),Pn===null?kt=bn:Pn.sibling=bn,Pn=bn);return t&&Tt.forEach(function(xo){return i(ie,xo)}),Nn&&pa(ie,ln),kt}function zt(ie,te,pe,ke){if(pe==null)throw Error(o(151));for(var kt=null,Pn=null,Tt=te,ln=te=0,bn=null,Bn=pe.next();Tt!==null&&!Bn.done;ln++,Bn=pe.next()){Tt.index>ln?(bn=Tt,Tt=null):bn=Tt.sibling;var xo=Ee(ie,Tt,Bn.value,ke);if(xo===null){Tt===null&&(Tt=bn);break}t&&Tt&&xo.alternate===null&&i(ie,Tt),te=A(xo,te,ln),Pn===null?kt=xo:Pn.sibling=xo,Pn=xo,Tt=bn}if(Bn.done)return c(ie,Tt),Nn&&pa(ie,ln),kt;if(Tt===null){for(;!Bn.done;ln++,Bn=pe.next())Bn=Pe(ie,Bn.value,ke),Bn!==null&&(te=A(Bn,te,ln),Pn===null?kt=Bn:Pn.sibling=Bn,Pn=Bn);return Nn&&pa(ie,ln),kt}for(Tt=f(Tt);!Bn.done;ln++,Bn=pe.next())Bn=be(Tt,ie,ln,Bn.value,ke),Bn!==null&&(t&&Bn.alternate!==null&&Tt.delete(Bn.key===null?ln:Bn.key),te=A(Bn,te,ln),Pn===null?kt=Bn:Pn.sibling=Bn,Pn=Bn);return t&&Tt.forEach(function(Rb){return i(ie,Rb)}),Nn&&pa(ie,ln),kt}function $n(ie,te,pe,ke){if(typeof pe=="object"&&pe!==null&&pe.type===ne&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case B:e:{for(var kt=pe.key;te!==null;){if(te.key===kt){if(kt=pe.type,kt===ne){if(te.tag===7){c(ie,te.sibling),ke=E(te,pe.props.children),ke.return=ie,ie=ke;break e}}else if(te.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===z&&Jo(kt)===te.type){c(ie,te.sibling),ke=E(te,pe.props),Oc(ke,pe),ke.return=ie,ie=ke;break e}c(ie,te);break}else i(ie,te);te=te.sibling}pe.type===ne?(ke=Yo(pe.props.children,ie.mode,ke,pe.key),ke.return=ie,ie=ke):(ke=th(pe.type,pe.key,pe.props,null,ie.mode,ke),Oc(ke,pe),ke.return=ie,ie=ke)}return O(ie);case ee:e:{for(kt=pe.key;te!==null;){if(te.key===kt)if(te.tag===4&&te.stateNode.containerInfo===pe.containerInfo&&te.stateNode.implementation===pe.implementation){c(ie,te.sibling),ke=E(te,pe.children||[]),ke.return=ie,ie=ke;break e}else{c(ie,te);break}else i(ie,te);te=te.sibling}ke=bf(pe,ie.mode,ke),ke.return=ie,ie=ke}return O(ie);case z:return pe=Jo(pe),$n(ie,te,pe,ke)}if(oe(pe))return vt(ie,te,pe,ke);if(Y(pe)){if(kt=Y(pe),typeof kt!="function")throw Error(o(150));return pe=kt.call(pe),zt(ie,te,pe,ke)}if(typeof pe.then=="function")return $n(ie,te,lh(pe),ke);if(pe.$$typeof===fe)return $n(ie,te,ih(ie,pe),ke);ch(ie,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint"?(pe=""+pe,te!==null&&te.tag===6?(c(ie,te.sibling),ke=E(te,pe),ke.return=ie,ie=ke):(c(ie,te),ke=Af(pe,ie.mode,ke),ke.return=ie,ie=ke),O(ie)):c(ie,te)}return function(ie,te,pe,ke){try{Nc=0;var kt=$n(ie,te,pe,ke);return Ll=null,kt}catch(Tt){if(Tt===kl||Tt===ah)throw Tt;var Pn=ns(29,Tt,null,ie.mode);return Pn.lanes=ke,Pn.return=ie,Pn}finally{}}}var el=Cm(!0),Sm=Cm(!1),eo=!1;function Lf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pf(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function to(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function no(t,i,c){var f=t.updateQueue;if(f===null)return null;if(f=f.shared,(Fn&2)!==0){var E=f.pending;return E===null?i.next=i:(i.next=E.next,E.next=i),f.pending=i,i=eh(t),um(t,null,c),i}return $u(t,f,i,c),eh(t)}function Dc(t,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var f=i.lanes;f&=t.pendingLanes,c|=f,i.lanes=c,pt(t,c)}}function Bf(t,i){var c=t.updateQueue,f=t.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var E=null,A=null;if(c=c.firstBaseUpdate,c!==null){do{var O={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};A===null?E=A=O:A=A.next=O,c=c.next}while(c!==null);A===null?E=A=i:A=A.next=i}else E=A=i;c={baseState:f.baseState,firstBaseUpdate:E,lastBaseUpdate:A,shared:f.shared,callbacks:f.callbacks},t.updateQueue=c;return}t=c.lastBaseUpdate,t===null?c.firstBaseUpdate=i:t.next=i,c.lastBaseUpdate=i}var Vf=!1;function Mc(){if(Vf){var t=Ml;if(t!==null)throw t}}function kc(t,i,c,f){Vf=!1;var E=t.updateQueue;eo=!1;var A=E.firstBaseUpdate,O=E.lastBaseUpdate,V=E.shared.pending;if(V!==null){E.shared.pending=null;var Q=V,ye=Q.next;Q.next=null,O===null?A=ye:O.next=ye,O=Q;var Re=t.alternate;Re!==null&&(Re=Re.updateQueue,V=Re.lastBaseUpdate,V!==O&&(V===null?Re.firstBaseUpdate=ye:V.next=ye,Re.lastBaseUpdate=Q))}if(A!==null){var Pe=E.baseState;O=0,Re=ye=Q=null,V=A;do{var Ee=V.lane&-536870913,be=Ee!==V.lane;if(be?(An&Ee)===Ee:(f&Ee)===Ee){Ee!==0&&Ee===Dl&&(Vf=!0),Re!==null&&(Re=Re.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var vt=t,zt=V;Ee=i;var $n=c;switch(zt.tag){case 1:if(vt=zt.payload,typeof vt=="function"){Pe=vt.call($n,Pe,Ee);break e}Pe=vt;break e;case 3:vt.flags=vt.flags&-65537|128;case 0:if(vt=zt.payload,Ee=typeof vt=="function"?vt.call($n,Pe,Ee):vt,Ee==null)break e;Pe=N({},Pe,Ee);break e;case 2:eo=!0}}Ee=V.callback,Ee!==null&&(t.flags|=64,be&&(t.flags|=8192),be=E.callbacks,be===null?E.callbacks=[Ee]:be.push(Ee))}else be={lane:Ee,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Re===null?(ye=Re=be,Q=Pe):Re=Re.next=be,O|=Ee;if(V=V.next,V===null){if(V=E.shared.pending,V===null)break;be=V,V=be.next,be.next=null,E.lastBaseUpdate=be,E.shared.pending=null}}while(!0);Re===null&&(Q=Pe),E.baseState=Q,E.firstBaseUpdate=ye,E.lastBaseUpdate=Re,A===null&&(E.shared.lanes=0),oo|=O,t.lanes=O,t.memoizedState=Pe}}function Im(t,i){if(typeof t!="function")throw Error(o(191,t));t.call(i)}function Rm(t,i){var c=t.callbacks;if(c!==null)for(t.callbacks=null,t=0;t<c.length;t++)Im(c[t],i)}var Pl=K(null),uh=K(0);function Nm(t,i){t=Sa,ve(uh,t),ve(Pl,i),Sa=t|i.baseLanes}function Uf(){ve(uh,Sa),ve(Pl,Pl.current)}function Ff(){Sa=uh.current,se(Pl),se(uh)}var rs=K(null),As=null;function ro(t){var i=t.alternate;ve(Pr,Pr.current&1),ve(rs,t),As===null&&(i===null||Pl.current!==null||i.memoizedState!==null)&&(As=t)}function jf(t){ve(Pr,Pr.current),ve(rs,t),As===null&&(As=t)}function Om(t){t.tag===22?(ve(Pr,Pr.current),ve(rs,t),As===null&&(As=t)):io()}function io(){ve(Pr,Pr.current),ve(rs,rs.current)}function is(t){se(rs),As===t&&(As=null),se(Pr)}var Pr=K(0);function hh(t){for(var i=t;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Y0(c)||W0(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ea=0,rn=null,Zn=null,Fr=null,dh=!1,Bl=!1,tl=!1,fh=0,Lc=0,Vl=null,EA=0;function Ir(){throw Error(o(321))}function zf(t,i){if(i===null)return!1;for(var c=0;c<i.length&&c<t.length;c++)if(!m(t[c],i[c]))return!1;return!0}function Hf(t,i,c,f,E,A){return Ea=A,rn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,le.H=t===null||t.memoizedState===null?gp:i0,tl=!1,A=c(f,E),tl=!1,Bl&&(A=Mm(i,c,f,E)),Dm(t),A}function Dm(t){le.H=Vc;var i=Zn!==null&&Zn.next!==null;if(Ea=0,Fr=Zn=rn=null,dh=!1,Lc=0,Vl=null,i)throw Error(o(300));t===null||jr||(t=t.dependencies,t!==null&&rh(t)&&(jr=!0))}function Mm(t,i,c,f){rn=t;var E=0;do{if(Bl&&(Vl=null),Lc=0,Bl=!1,25<=E)throw Error(o(301));if(E+=1,Fr=Zn=null,t.updateQueue!=null){var A=t.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}le.H=mp,A=i(c,f)}while(Bl);return A}function wA(){var t=le.H,i=t.useState()[0];return i=typeof i.then=="function"?Pc(i):i,t=t.useState()[0],(Zn!==null?Zn.memoizedState:null)!==t&&(rn.flags|=1024),i}function Gf(){var t=fh!==0;return fh=0,t}function qf(t,i,c){i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~c}function Xf(t){if(dh){for(t=t.memoizedState;t!==null;){var i=t.queue;i!==null&&(i.pending=null),t=t.next}dh=!1}Ea=0,Fr=Zn=rn=null,Bl=!1,Lc=fh=0,Vl=null}function Oi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fr===null?rn.memoizedState=Fr=t:Fr=Fr.next=t,Fr}function Br(){if(Zn===null){var t=rn.alternate;t=t!==null?t.memoizedState:null}else t=Zn.next;var i=Fr===null?rn.memoizedState:Fr.next;if(i!==null)Fr=i,Zn=t;else{if(t===null)throw rn.alternate===null?Error(o(467)):Error(o(310));Zn=t,t={memoizedState:Zn.memoizedState,baseState:Zn.baseState,baseQueue:Zn.baseQueue,queue:Zn.queue,next:null},Fr===null?rn.memoizedState=Fr=t:Fr=Fr.next=t}return Fr}function gh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pc(t){var i=Lc;return Lc+=1,Vl===null&&(Vl=[]),t=bm(Vl,t,i),i=rn,(Fr===null?i.memoizedState:Fr.next)===null&&(i=i.alternate,le.H=i===null||i.memoizedState===null?gp:i0),t}function mh(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Pc(t);if(t.$$typeof===fe)return ai(t)}throw Error(o(438,String(t)))}function Yf(t){var i=null,c=rn.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var f=rn.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(E){return E.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=gh(),rn.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(t),f=0;f<t;f++)c[f]=J;return i.index++,c}function wa(t,i){return typeof i=="function"?i(t):i}function ph(t){var i=Br();return Wf(i,Zn,t)}function Wf(t,i,c){var f=t.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=c;var E=t.baseQueue,A=f.pending;if(A!==null){if(E!==null){var O=E.next;E.next=A.next,A.next=O}i.baseQueue=E=A,f.pending=null}if(A=t.baseState,E===null)t.memoizedState=A;else{i=E.next;var V=O=null,Q=null,ye=i,Re=!1;do{var Pe=ye.lane&-536870913;if(Pe!==ye.lane?(An&Pe)===Pe:(Ea&Pe)===Pe){var Ee=ye.revertLane;if(Ee===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,gesture:null,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null}),Pe===Dl&&(Re=!0);else if((Ea&Ee)===Ee){ye=ye.next,Ee===Dl&&(Re=!0);continue}else Pe={lane:0,revertLane:ye.revertLane,gesture:null,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},Q===null?(V=Q=Pe,O=A):Q=Q.next=Pe,rn.lanes|=Ee,oo|=Ee;Pe=ye.action,tl&&c(A,Pe),A=ye.hasEagerState?ye.eagerState:c(A,Pe)}else Ee={lane:Pe,revertLane:ye.revertLane,gesture:ye.gesture,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},Q===null?(V=Q=Ee,O=A):Q=Q.next=Ee,rn.lanes|=Pe,oo|=Pe;ye=ye.next}while(ye!==null&&ye!==i);if(Q===null?O=A:Q.next=V,!m(A,t.memoizedState)&&(jr=!0,Re&&(c=Ml,c!==null)))throw c;t.memoizedState=A,t.baseState=O,t.baseQueue=Q,f.lastRenderedState=A}return E===null&&(f.lanes=0),[t.memoizedState,f.dispatch]}function Kf(t){var i=Br(),c=i.queue;if(c===null)throw Error(o(311));c.lastRenderedReducer=t;var f=c.dispatch,E=c.pending,A=i.memoizedState;if(E!==null){c.pending=null;var O=E=E.next;do A=t(A,O.action),O=O.next;while(O!==E);m(A,i.memoizedState)||(jr=!0),i.memoizedState=A,i.baseQueue===null&&(i.baseState=A),c.lastRenderedState=A}return[A,f]}function km(t,i,c){var f=rn,E=Br(),A=Nn;if(A){if(c===void 0)throw Error(o(407));c=c()}else c=i();var O=!m((Zn||E).memoizedState,c);if(O&&(E.memoizedState=c,jr=!0),E=E.queue,Jf(Bm.bind(null,f,E,t),[t]),E.getSnapshot!==i||O||Fr!==null&&Fr.memoizedState.tag&1){if(f.flags|=2048,Ul(9,{destroy:void 0},Pm.bind(null,f,E,c,i),null),ir===null)throw Error(o(349));A||(Ea&127)!==0||Lm(f,i,c)}return c}function Lm(t,i,c){t.flags|=16384,t={getSnapshot:i,value:c},i=rn.updateQueue,i===null?(i=gh(),rn.updateQueue=i,i.stores=[t]):(c=i.stores,c===null?i.stores=[t]:c.push(t))}function Pm(t,i,c,f){i.value=c,i.getSnapshot=f,Vm(i)&&Um(t)}function Bm(t,i,c){return c(function(){Vm(i)&&Um(t)})}function Vm(t){var i=t.getSnapshot;t=t.value;try{var c=i();return!m(t,c)}catch{return!0}}function Um(t){var i=Xo(t,2);i!==null&&qi(i,t,2)}function Qf(t){var i=Oi();if(typeof t=="function"){var c=t;if(t=c(),tl){Ht(!0);try{c()}finally{Ht(!1)}}}return i.memoizedState=i.baseState=t,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:t},i}function Fm(t,i,c,f){return t.baseState=c,Wf(t,Zn,typeof f=="function"?f:wa)}function _A(t,i,c,f,E){if(Eh(t))throw Error(o(485));if(t=i.action,t!==null){var A={payload:E,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){A.listeners.push(O)}};le.T!==null?c(!0):A.isTransition=!1,f(A),c=i.pending,c===null?(A.next=i.pending=A,jm(i,A)):(A.next=c.next,i.pending=c.next=A)}}function jm(t,i){var c=i.action,f=i.payload,E=t.state;if(i.isTransition){var A=le.T,O={};le.T=O;try{var V=c(E,f),Q=le.S;Q!==null&&Q(O,V),zm(t,i,V)}catch(ye){Zf(t,i,ye)}finally{A!==null&&O.types!==null&&(A.types=O.types),le.T=A}}else try{A=c(E,f),zm(t,i,A)}catch(ye){Zf(t,i,ye)}}function zm(t,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Hm(t,i,f)},function(f){return Zf(t,i,f)}):Hm(t,i,c)}function Hm(t,i,c){i.status="fulfilled",i.value=c,Gm(i),t.state=c,i=t.pending,i!==null&&(c=i.next,c===i?t.pending=null:(c=c.next,i.next=c,jm(t,c)))}function Zf(t,i,c){var f=t.pending;if(t.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=c,Gm(i),i=i.next;while(i!==f)}t.action=null}function Gm(t){t=t.listeners;for(var i=0;i<t.length;i++)(0,t[i])()}function qm(t,i){return i}function Xm(t,i){if(Nn){var c=ir.formState;if(c!==null){e:{var f=rn;if(Nn){if(hr){t:{for(var E=hr,A=_s;E.nodeType!==8;){if(!A){E=null;break t}if(E=bs(E.nextSibling),E===null){E=null;break t}}A=E.data,E=A==="F!"||A==="F"?E:null}if(E){hr=bs(E.nextSibling),f=E.data==="F!";break e}}Ja(f)}f=!1}f&&(i=c[0])}}return c=Oi(),c.memoizedState=c.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qm,lastRenderedState:i},c.queue=f,c=hp.bind(null,rn,f),f.dispatch=c,f=Qf(!1),A=r0.bind(null,rn,!1,f.queue),f=Oi(),E={state:i,dispatch:null,action:t,pending:null},f.queue=E,c=_A.bind(null,rn,E,A,c),E.dispatch=c,f.memoizedState=t,[i,c,!1]}function Ym(t){var i=Br();return Wm(i,Zn,t)}function Wm(t,i,c){if(i=Wf(t,i,qm)[0],t=ph(wa)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=Pc(i)}catch(O){throw O===kl?ah:O}else f=i;i=Br();var E=i.queue,A=E.dispatch;return c!==i.memoizedState&&(rn.flags|=2048,Ul(9,{destroy:void 0},AA.bind(null,E,c),null)),[f,A,t]}function AA(t,i){t.action=i}function Km(t){var i=Br(),c=Zn;if(c!==null)return Wm(i,c,t);Br(),i=i.memoizedState,c=Br();var f=c.queue.dispatch;return c.memoizedState=t,[i,f,!1]}function Ul(t,i,c,f){return t={tag:t,create:c,deps:f,inst:i,next:null},i=rn.updateQueue,i===null&&(i=gh(),rn.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=t.next=t:(f=c.next,c.next=t,t.next=f,i.lastEffect=t),t}function Qm(){return Br().memoizedState}function yh(t,i,c,f){var E=Oi();rn.flags|=t,E.memoizedState=Ul(1|i,{destroy:void 0},c,f===void 0?null:f)}function xh(t,i,c,f){var E=Br();f=f===void 0?null:f;var A=E.memoizedState.inst;Zn!==null&&f!==null&&zf(f,Zn.memoizedState.deps)?E.memoizedState=Ul(i,A,c,f):(rn.flags|=t,E.memoizedState=Ul(1|i,A,c,f))}function Zm(t,i){yh(8390656,8,t,i)}function Jf(t,i){xh(2048,8,t,i)}function bA(t){rn.flags|=4;var i=rn.updateQueue;if(i===null)i=gh(),rn.updateQueue=i,i.events=[t];else{var c=i.events;c===null?i.events=[t]:c.push(t)}}function Jm(t){var i=Br().memoizedState;return bA({ref:i,nextImpl:t}),function(){if((Fn&2)!==0)throw Error(o(440));return i.impl.apply(void 0,arguments)}}function $m(t,i){return xh(4,2,t,i)}function ep(t,i){return xh(4,4,t,i)}function tp(t,i){if(typeof i=="function"){t=t();var c=i(t);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function np(t,i,c){c=c!=null?c.concat([t]):null,xh(4,4,tp.bind(null,i,t),c)}function $f(){}function rp(t,i){var c=Br();i=i===void 0?null:i;var f=c.memoizedState;return i!==null&&zf(i,f[1])?f[0]:(c.memoizedState=[t,i],t)}function ip(t,i){var c=Br();i=i===void 0?null:i;var f=c.memoizedState;if(i!==null&&zf(i,f[1]))return f[0];if(f=t(),tl){Ht(!0);try{t()}finally{Ht(!1)}}return c.memoizedState=[f,i],f}function e0(t,i,c){return c===void 0||(Ea&1073741824)!==0&&(An&261930)===0?t.memoizedState=i:(t.memoizedState=c,t=sy(),rn.lanes|=t,oo|=t,c)}function sp(t,i,c,f){return m(c,i)?c:Pl.current!==null?(t=e0(t,c,f),m(t,i)||(jr=!0),t):(Ea&42)===0||(Ea&1073741824)!==0&&(An&261930)===0?(jr=!0,t.memoizedState=c):(t=sy(),rn.lanes|=t,oo|=t,i)}function ap(t,i,c,f,E){var A=xe.p;xe.p=A!==0&&8>A?A:8;var O=le.T,V={};le.T=V,r0(t,!1,i,c);try{var Q=E(),ye=le.S;if(ye!==null&&ye(V,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var Re=xA(Q,f);Bc(t,i,Re,os(t))}else Bc(t,i,f,os(t))}catch(Pe){Bc(t,i,{then:function(){},status:"rejected",reason:Pe},os())}finally{xe.p=A,O!==null&&V.types!==null&&(O.types=V.types),le.T=O}}function vA(){}function t0(t,i,c,f){if(t.tag!==5)throw Error(o(476));var E=op(t).queue;ap(t,E,i,We,c===null?vA:function(){return lp(t),c(f)})}function op(t){var i=t.memoizedState;if(i!==null)return i;i={memoizedState:We,baseState:We,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:We},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:c},next:null},t.memoizedState=i,t=t.alternate,t!==null&&(t.memoizedState=i),i}function lp(t){var i=op(t);i.next===null&&(i=t.alternate.memoizedState),Bc(t,i.next.queue,{},os())}function n0(){return ai(eu)}function cp(){return Br().memoizedState}function up(){return Br().memoizedState}function TA(t){for(var i=t.return;i!==null;){switch(i.tag){case 24:case 3:var c=os();t=to(c);var f=no(i,t,c);f!==null&&(qi(f,i,c),Dc(f,i,c)),i={cache:Of()},t.payload=i;return}i=i.return}}function CA(t,i,c){var f=os();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Eh(t)?dp(i,c):(c=wf(t,i,c,f),c!==null&&(qi(c,t,f),fp(c,i,f)))}function hp(t,i,c){var f=os();Bc(t,i,c,f)}function Bc(t,i,c,f){var E={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Eh(t))dp(i,E);else{var A=t.alternate;if(t.lanes===0&&(A===null||A.lanes===0)&&(A=i.lastRenderedReducer,A!==null))try{var O=i.lastRenderedState,V=A(O,c);if(E.hasEagerState=!0,E.eagerState=V,m(V,O))return $u(t,i,E,0),ir===null&&Ju(),!1}catch{}finally{}if(c=wf(t,i,E,f),c!==null)return qi(c,t,f),fp(c,i,f),!0}return!1}function r0(t,i,c,f){if(f={lane:2,revertLane:L0(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Eh(t)){if(i)throw Error(o(479))}else i=wf(t,c,f,2),i!==null&&qi(i,t,2)}function Eh(t){var i=t.alternate;return t===rn||i!==null&&i===rn}function dp(t,i){Bl=dh=!0;var c=t.pending;c===null?i.next=i:(i.next=c.next,c.next=i),t.pending=i}function fp(t,i,c){if((c&4194048)!==0){var f=i.lanes;f&=t.pendingLanes,c|=f,i.lanes=c,pt(t,c)}}var Vc={readContext:ai,use:mh,useCallback:Ir,useContext:Ir,useEffect:Ir,useImperativeHandle:Ir,useLayoutEffect:Ir,useInsertionEffect:Ir,useMemo:Ir,useReducer:Ir,useRef:Ir,useState:Ir,useDebugValue:Ir,useDeferredValue:Ir,useTransition:Ir,useSyncExternalStore:Ir,useId:Ir,useHostTransitionStatus:Ir,useFormState:Ir,useActionState:Ir,useOptimistic:Ir,useMemoCache:Ir,useCacheRefresh:Ir};Vc.useEffectEvent=Ir;var gp={readContext:ai,use:mh,useCallback:function(t,i){return Oi().memoizedState=[t,i===void 0?null:i],t},useContext:ai,useEffect:Zm,useImperativeHandle:function(t,i,c){c=c!=null?c.concat([t]):null,yh(4194308,4,tp.bind(null,i,t),c)},useLayoutEffect:function(t,i){return yh(4194308,4,t,i)},useInsertionEffect:function(t,i){yh(4,2,t,i)},useMemo:function(t,i){var c=Oi();i=i===void 0?null:i;var f=t();if(tl){Ht(!0);try{t()}finally{Ht(!1)}}return c.memoizedState=[f,i],f},useReducer:function(t,i,c){var f=Oi();if(c!==void 0){var E=c(i);if(tl){Ht(!0);try{c(i)}finally{Ht(!1)}}}else E=i;return f.memoizedState=f.baseState=E,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:E},f.queue=t,t=t.dispatch=CA.bind(null,rn,t),[f.memoizedState,t]},useRef:function(t){var i=Oi();return t={current:t},i.memoizedState=t},useState:function(t){t=Qf(t);var i=t.queue,c=hp.bind(null,rn,i);return i.dispatch=c,[t.memoizedState,c]},useDebugValue:$f,useDeferredValue:function(t,i){var c=Oi();return e0(c,t,i)},useTransition:function(){var t=Qf(!1);return t=ap.bind(null,rn,t.queue,!0,!1),Oi().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,i,c){var f=rn,E=Oi();if(Nn){if(c===void 0)throw Error(o(407));c=c()}else{if(c=i(),ir===null)throw Error(o(349));(An&127)!==0||Lm(f,i,c)}E.memoizedState=c;var A={value:c,getSnapshot:i};return E.queue=A,Zm(Bm.bind(null,f,A,t),[t]),f.flags|=2048,Ul(9,{destroy:void 0},Pm.bind(null,f,A,c,i),null),c},useId:function(){var t=Oi(),i=ir.identifierPrefix;if(Nn){var c=Hs,f=zs;c=(f&~(1<<32-At(f)-1)).toString(32)+c,i="_"+i+"R_"+c,c=fh++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=EA++,i="_"+i+"r_"+c.toString(32)+"_";return t.memoizedState=i},useHostTransitionStatus:n0,useFormState:Xm,useActionState:Xm,useOptimistic:function(t){var i=Oi();i.memoizedState=i.baseState=t;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=r0.bind(null,rn,!0,c),c.dispatch=i,[t,i]},useMemoCache:Yf,useCacheRefresh:function(){return Oi().memoizedState=TA.bind(null,rn)},useEffectEvent:function(t){var i=Oi(),c={impl:t};return i.memoizedState=c,function(){if((Fn&2)!==0)throw Error(o(440));return c.impl.apply(void 0,arguments)}}},i0={readContext:ai,use:mh,useCallback:rp,useContext:ai,useEffect:Jf,useImperativeHandle:np,useInsertionEffect:$m,useLayoutEffect:ep,useMemo:ip,useReducer:ph,useRef:Qm,useState:function(){return ph(wa)},useDebugValue:$f,useDeferredValue:function(t,i){var c=Br();return sp(c,Zn.memoizedState,t,i)},useTransition:function(){var t=ph(wa)[0],i=Br().memoizedState;return[typeof t=="boolean"?t:Pc(t),i]},useSyncExternalStore:km,useId:cp,useHostTransitionStatus:n0,useFormState:Ym,useActionState:Ym,useOptimistic:function(t,i){var c=Br();return Fm(c,Zn,t,i)},useMemoCache:Yf,useCacheRefresh:up};i0.useEffectEvent=Jm;var mp={readContext:ai,use:mh,useCallback:rp,useContext:ai,useEffect:Jf,useImperativeHandle:np,useInsertionEffect:$m,useLayoutEffect:ep,useMemo:ip,useReducer:Kf,useRef:Qm,useState:function(){return Kf(wa)},useDebugValue:$f,useDeferredValue:function(t,i){var c=Br();return Zn===null?e0(c,t,i):sp(c,Zn.memoizedState,t,i)},useTransition:function(){var t=Kf(wa)[0],i=Br().memoizedState;return[typeof t=="boolean"?t:Pc(t),i]},useSyncExternalStore:km,useId:cp,useHostTransitionStatus:n0,useFormState:Km,useActionState:Km,useOptimistic:function(t,i){var c=Br();return Zn!==null?Fm(c,Zn,t,i):(c.baseState=t,[t,c.queue.dispatch])},useMemoCache:Yf,useCacheRefresh:up};mp.useEffectEvent=Jm;function s0(t,i,c,f){i=t.memoizedState,c=c(f,i),c=c==null?i:N({},i,c),t.memoizedState=c,t.lanes===0&&(t.updateQueue.baseState=c)}var a0={enqueueSetState:function(t,i,c){t=t._reactInternals;var f=os(),E=to(f);E.payload=i,c!=null&&(E.callback=c),i=no(t,E,f),i!==null&&(qi(i,t,f),Dc(i,t,f))},enqueueReplaceState:function(t,i,c){t=t._reactInternals;var f=os(),E=to(f);E.tag=1,E.payload=i,c!=null&&(E.callback=c),i=no(t,E,f),i!==null&&(qi(i,t,f),Dc(i,t,f))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var c=os(),f=to(c);f.tag=2,i!=null&&(f.callback=i),i=no(t,f,c),i!==null&&(qi(i,t,c),Dc(i,t,c))}};function pp(t,i,c,f,E,A,O){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(f,A,O):i.prototype&&i.prototype.isPureReactComponent?!y(c,f)||!y(E,A):!0}function yp(t,i,c,f){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,f),i.state!==t&&a0.enqueueReplaceState(i,i.state,null)}function nl(t,i){var c=i;if("ref"in i){c={};for(var f in i)f!=="ref"&&(c[f]=i[f])}if(t=t.defaultProps){c===i&&(c=N({},c));for(var E in t)c[E]===void 0&&(c[E]=t[E])}return c}function xp(t){Zu(t)}function Ep(t){console.error(t)}function wp(t){Zu(t)}function wh(t,i){try{var c=t.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function _p(t,i,c){try{var f=t.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function o0(t,i,c){return c=to(c),c.tag=3,c.payload={element:null},c.callback=function(){wh(t,i)},c}function Ap(t){return t=to(t),t.tag=3,t}function bp(t,i,c,f){var E=c.type.getDerivedStateFromError;if(typeof E=="function"){var A=f.value;t.payload=function(){return E(A)},t.callback=function(){_p(i,c,f)}}var O=c.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(t.callback=function(){_p(i,c,f),typeof E!="function"&&(lo===null?lo=new Set([this]):lo.add(this));var V=f.stack;this.componentDidCatch(f.value,{componentStack:V!==null?V:""})})}function SA(t,i,c,f,E){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=c.alternate,i!==null&&Ol(i,c,E,!0),c=rs.current,c!==null){switch(c.tag){case 31:case 13:return As===null?Dh():c.alternate===null&&Rr===0&&(Rr=3),c.flags&=-257,c.flags|=65536,c.lanes=E,f===oh?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([f]):i.add(f),D0(t,f,E)),!1;case 22:return c.flags|=65536,f===oh?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([f]):c.add(f)),D0(t,f,E)),!1}throw Error(o(435,c.tag))}return D0(t,f,E),Dh(),!1}if(Nn)return i=rs.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=E,f!==Cf&&(t=Error(o(422),{cause:f}),Sc(xs(t,c)))):(f!==Cf&&(i=Error(o(423),{cause:f}),Sc(xs(i,c))),t=t.current.alternate,t.flags|=65536,E&=-E,t.lanes|=E,f=xs(f,c),E=o0(t.stateNode,f,E),Bf(t,E),Rr!==4&&(Rr=2)),!1;var A=Error(o(520),{cause:f});if(A=xs(A,c),Xc===null?Xc=[A]:Xc.push(A),Rr!==4&&(Rr=2),i===null)return!0;f=xs(f,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,t=E&-E,c.lanes|=t,t=o0(c.stateNode,f,t),Bf(c,t),!1;case 1:if(i=c.type,A=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(lo===null||!lo.has(A))))return c.flags|=65536,E&=-E,c.lanes|=E,E=Ap(E),bp(E,t,c,f),Bf(c,E),!1}c=c.return}while(c!==null);return!1}var l0=Error(o(461)),jr=!1;function oi(t,i,c,f){i.child=t===null?Sm(i,null,c,f):el(i,t.child,c,f)}function vp(t,i,c,f,E){c=c.render;var A=i.ref;if("ref"in f){var O={};for(var V in f)V!=="ref"&&(O[V]=f[V])}else O=f;return Qo(i),f=Hf(t,i,c,O,A,E),V=Gf(),t!==null&&!jr?(qf(t,i,E),_a(t,i,E)):(Nn&&V&&vf(i),i.flags|=1,oi(t,i,f,E),i.child)}function Tp(t,i,c,f,E){if(t===null){var A=c.type;return typeof A=="function"&&!_f(A)&&A.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=A,Cp(t,i,A,f,E)):(t=th(c.type,null,f,i,i.mode,E),t.ref=i.ref,t.return=i,i.child=t)}if(A=t.child,!p0(t,E)){var O=A.memoizedProps;if(c=c.compare,c=c!==null?c:y,c(O,f)&&t.ref===i.ref)return _a(t,i,E)}return i.flags|=1,t=ma(A,f),t.ref=i.ref,t.return=i,i.child=t}function Cp(t,i,c,f,E){if(t!==null){var A=t.memoizedProps;if(y(A,f)&&t.ref===i.ref)if(jr=!1,i.pendingProps=f=A,p0(t,E))(t.flags&131072)!==0&&(jr=!0);else return i.lanes=t.lanes,_a(t,i,E)}return c0(t,i,c,f,E)}function Sp(t,i,c,f){var E=f.children,A=t!==null?t.memoizedState:null;if(t===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(A=A!==null?A.baseLanes|c:c,t!==null){for(f=i.child=t.child,E=0;f!==null;)E=E|f.lanes|f.childLanes,f=f.sibling;f=E&~A}else f=0,i.child=null;return Ip(t,i,A,c,f)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},t!==null&&sh(i,A!==null?A.cachePool:null),A!==null?Nm(i,A):Uf(),Om(i);else return f=i.lanes=536870912,Ip(t,i,A!==null?A.baseLanes|c:c,c,f)}else A!==null?(sh(i,A.cachePool),Nm(i,A),io(),i.memoizedState=null):(t!==null&&sh(i,null),Uf(),io());return oi(t,i,E,c),i.child}function Uc(t,i){return t!==null&&t.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Ip(t,i,c,f,E){var A=Mf();return A=A===null?null:{parent:Ur._currentValue,pool:A},i.memoizedState={baseLanes:c,cachePool:A},t!==null&&sh(i,null),Uf(),Om(i),t!==null&&Ol(t,i,f,!0),i.childLanes=E,null}function _h(t,i){return i=bh({mode:i.mode,children:i.children},t.mode),i.ref=t.ref,t.child=i,i.return=t,i}function Rp(t,i,c){return el(i,t.child,null,c),t=_h(i,i.pendingProps),t.flags|=2,is(i),i.memoizedState=null,t}function IA(t,i,c){var f=i.pendingProps,E=(i.flags&128)!==0;if(i.flags&=-129,t===null){if(Nn){if(f.mode==="hidden")return t=_h(i,f),i.lanes=536870912,Uc(null,t);if(jf(i),(t=hr)?(t=jy(t,_s),t=t!==null&&t.data==="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:Qa!==null?{id:zs,overflow:Hs}:null,retryLane:536870912,hydrationErrors:null},c=dm(t),c.return=i,i.child=c,si=i,hr=null)):t=null,t===null)throw Ja(i);return i.lanes=536870912,null}return _h(i,f)}var A=t.memoizedState;if(A!==null){var O=A.dehydrated;if(jf(i),E)if(i.flags&256)i.flags&=-257,i=Rp(t,i,c);else if(i.memoizedState!==null)i.child=t.child,i.flags|=128,i=null;else throw Error(o(558));else if(jr||Ol(t,i,c,!1),E=(c&t.childLanes)!==0,jr||E){if(f=ir,f!==null&&(O=at(f,c),O!==0&&O!==A.retryLane))throw A.retryLane=O,Xo(t,O),qi(f,t,O),l0;Dh(),i=Rp(t,i,c)}else t=A.treeContext,hr=bs(O.nextSibling),si=i,Nn=!0,Za=null,_s=!1,t!==null&&mm(i,t),i=_h(i,f),i.flags|=4096;return i}return t=ma(t.child,{mode:f.mode,children:f.children}),t.ref=i.ref,i.child=t,t.return=i,t}function Ah(t,i){var c=i.ref;if(c===null)t!==null&&t.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(o(284));(t===null||t.ref!==c)&&(i.flags|=4194816)}}function c0(t,i,c,f,E){return Qo(i),c=Hf(t,i,c,f,void 0,E),f=Gf(),t!==null&&!jr?(qf(t,i,E),_a(t,i,E)):(Nn&&f&&vf(i),i.flags|=1,oi(t,i,c,E),i.child)}function Np(t,i,c,f,E,A){return Qo(i),i.updateQueue=null,c=Mm(i,f,c,E),Dm(t),f=Gf(),t!==null&&!jr?(qf(t,i,A),_a(t,i,A)):(Nn&&f&&vf(i),i.flags|=1,oi(t,i,c,A),i.child)}function Op(t,i,c,f,E){if(Qo(i),i.stateNode===null){var A=Sl,O=c.contextType;typeof O=="object"&&O!==null&&(A=ai(O)),A=new c(f,A),i.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=a0,i.stateNode=A,A._reactInternals=i,A=i.stateNode,A.props=f,A.state=i.memoizedState,A.refs={},Lf(i),O=c.contextType,A.context=typeof O=="object"&&O!==null?ai(O):Sl,A.state=i.memoizedState,O=c.getDerivedStateFromProps,typeof O=="function"&&(s0(i,c,O,f),A.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(O=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),O!==A.state&&a0.enqueueReplaceState(A,A.state,null),kc(i,f,A,E),Mc(),A.state=i.memoizedState),typeof A.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(t===null){A=i.stateNode;var V=i.memoizedProps,Q=nl(c,V);A.props=Q;var ye=A.context,Re=c.contextType;O=Sl,typeof Re=="object"&&Re!==null&&(O=ai(Re));var Pe=c.getDerivedStateFromProps;Re=typeof Pe=="function"||typeof A.getSnapshotBeforeUpdate=="function",V=i.pendingProps!==V,Re||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(V||ye!==O)&&yp(i,A,f,O),eo=!1;var Ee=i.memoizedState;A.state=Ee,kc(i,f,A,E),Mc(),ye=i.memoizedState,V||Ee!==ye||eo?(typeof Pe=="function"&&(s0(i,c,Pe,f),ye=i.memoizedState),(Q=eo||pp(i,c,Q,f,Ee,ye,O))?(Re||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(i.flags|=4194308)):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=ye),A.props=f,A.state=ye,A.context=O,f=Q):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{A=i.stateNode,Pf(t,i),O=i.memoizedProps,Re=nl(c,O),A.props=Re,Pe=i.pendingProps,Ee=A.context,ye=c.contextType,Q=Sl,typeof ye=="object"&&ye!==null&&(Q=ai(ye)),V=c.getDerivedStateFromProps,(ye=typeof V=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(O!==Pe||Ee!==Q)&&yp(i,A,f,Q),eo=!1,Ee=i.memoizedState,A.state=Ee,kc(i,f,A,E),Mc();var be=i.memoizedState;O!==Pe||Ee!==be||eo||t!==null&&t.dependencies!==null&&rh(t.dependencies)?(typeof V=="function"&&(s0(i,c,V,f),be=i.memoizedState),(Re=eo||pp(i,c,Re,f,Ee,be,Q)||t!==null&&t.dependencies!==null&&rh(t.dependencies))?(ye||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(f,be,Q),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(f,be,Q)),typeof A.componentDidUpdate=="function"&&(i.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof A.componentDidUpdate!="function"||O===t.memoizedProps&&Ee===t.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||O===t.memoizedProps&&Ee===t.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=be),A.props=f,A.state=be,A.context=Q,f=Re):(typeof A.componentDidUpdate!="function"||O===t.memoizedProps&&Ee===t.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||O===t.memoizedProps&&Ee===t.memoizedState||(i.flags|=1024),f=!1)}return A=f,Ah(t,i),f=(i.flags&128)!==0,A||f?(A=i.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:A.render(),i.flags|=1,t!==null&&f?(i.child=el(i,t.child,null,E),i.child=el(i,null,c,E)):oi(t,i,c,E),i.memoizedState=A.state,t=i.child):t=_a(t,i,E),t}function Dp(t,i,c,f){return Wo(),i.flags|=256,oi(t,i,c,f),i.child}var u0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function h0(t){return{baseLanes:t,cachePool:_m()}}function d0(t,i,c){return t=t!==null?t.childLanes&~c:0,i&&(t|=as),t}function Mp(t,i,c){var f=i.pendingProps,E=!1,A=(i.flags&128)!==0,O;if((O=A)||(O=t!==null&&t.memoizedState===null?!1:(Pr.current&2)!==0),O&&(E=!0,i.flags&=-129),O=(i.flags&32)!==0,i.flags&=-33,t===null){if(Nn){if(E?ro(i):io(),(t=hr)?(t=jy(t,_s),t=t!==null&&t.data!=="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:Qa!==null?{id:zs,overflow:Hs}:null,retryLane:536870912,hydrationErrors:null},c=dm(t),c.return=i,i.child=c,si=i,hr=null)):t=null,t===null)throw Ja(i);return W0(t)?i.lanes=32:i.lanes=536870912,null}var V=f.children;return f=f.fallback,E?(io(),E=i.mode,V=bh({mode:"hidden",children:V},E),f=Yo(f,E,c,null),V.return=i,f.return=i,V.sibling=f,i.child=V,f=i.child,f.memoizedState=h0(c),f.childLanes=d0(t,O,c),i.memoizedState=u0,Uc(null,f)):(ro(i),f0(i,V))}var Q=t.memoizedState;if(Q!==null&&(V=Q.dehydrated,V!==null)){if(A)i.flags&256?(ro(i),i.flags&=-257,i=g0(t,i,c)):i.memoizedState!==null?(io(),i.child=t.child,i.flags|=128,i=null):(io(),V=f.fallback,E=i.mode,f=bh({mode:"visible",children:f.children},E),V=Yo(V,E,c,null),V.flags|=2,f.return=i,V.return=i,f.sibling=V,i.child=f,el(i,t.child,null,c),f=i.child,f.memoizedState=h0(c),f.childLanes=d0(t,O,c),i.memoizedState=u0,i=Uc(null,f));else if(ro(i),W0(V)){if(O=V.nextSibling&&V.nextSibling.dataset,O)var ye=O.dgst;O=ye,f=Error(o(419)),f.stack="",f.digest=O,Sc({value:f,source:null,stack:null}),i=g0(t,i,c)}else if(jr||Ol(t,i,c,!1),O=(c&t.childLanes)!==0,jr||O){if(O=ir,O!==null&&(f=at(O,c),f!==0&&f!==Q.retryLane))throw Q.retryLane=f,Xo(t,f),qi(O,t,f),l0;Y0(V)||Dh(),i=g0(t,i,c)}else Y0(V)?(i.flags|=192,i.child=t.child,i=null):(t=Q.treeContext,hr=bs(V.nextSibling),si=i,Nn=!0,Za=null,_s=!1,t!==null&&mm(i,t),i=f0(i,f.children),i.flags|=4096);return i}return E?(io(),V=f.fallback,E=i.mode,Q=t.child,ye=Q.sibling,f=ma(Q,{mode:"hidden",children:f.children}),f.subtreeFlags=Q.subtreeFlags&65011712,ye!==null?V=ma(ye,V):(V=Yo(V,E,c,null),V.flags|=2),V.return=i,f.return=i,f.sibling=V,i.child=f,Uc(null,f),f=i.child,V=t.child.memoizedState,V===null?V=h0(c):(E=V.cachePool,E!==null?(Q=Ur._currentValue,E=E.parent!==Q?{parent:Q,pool:Q}:E):E=_m(),V={baseLanes:V.baseLanes|c,cachePool:E}),f.memoizedState=V,f.childLanes=d0(t,O,c),i.memoizedState=u0,Uc(t.child,f)):(ro(i),c=t.child,t=c.sibling,c=ma(c,{mode:"visible",children:f.children}),c.return=i,c.sibling=null,t!==null&&(O=i.deletions,O===null?(i.deletions=[t],i.flags|=16):O.push(t)),i.child=c,i.memoizedState=null,c)}function f0(t,i){return i=bh({mode:"visible",children:i},t.mode),i.return=t,t.child=i}function bh(t,i){return t=ns(22,t,null,i),t.lanes=0,t}function g0(t,i,c){return el(i,t.child,null,c),t=f0(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function kp(t,i,c){t.lanes|=i;var f=t.alternate;f!==null&&(f.lanes|=i),Rf(t.return,i,c)}function m0(t,i,c,f,E,A){var O=t.memoizedState;O===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:E,treeForkCount:A}:(O.isBackwards=i,O.rendering=null,O.renderingStartTime=0,O.last=f,O.tail=c,O.tailMode=E,O.treeForkCount=A)}function Lp(t,i,c){var f=i.pendingProps,E=f.revealOrder,A=f.tail;f=f.children;var O=Pr.current,V=(O&2)!==0;if(V?(O=O&1|2,i.flags|=128):O&=1,ve(Pr,O),oi(t,i,f,c),f=Nn?Cc:0,!V&&t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&kp(t,c,i);else if(t.tag===19)kp(t,c,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(E){case"forwards":for(c=i.child,E=null;c!==null;)t=c.alternate,t!==null&&hh(t)===null&&(E=c),c=c.sibling;c=E,c===null?(E=i.child,i.child=null):(E=c.sibling,c.sibling=null),m0(i,!1,E,c,A,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,E=i.child,i.child=null;E!==null;){if(t=E.alternate,t!==null&&hh(t)===null){i.child=E;break}t=E.sibling,E.sibling=c,c=E,E=t}m0(i,!0,c,null,A,f);break;case"together":m0(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function _a(t,i,c){if(t!==null&&(i.dependencies=t.dependencies),oo|=i.lanes,(c&i.childLanes)===0)if(t!==null){if(Ol(t,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(t!==null&&i.child!==t.child)throw Error(o(153));if(i.child!==null){for(t=i.child,c=ma(t,t.pendingProps),i.child=c,c.return=i;t.sibling!==null;)t=t.sibling,c=c.sibling=ma(t,t.pendingProps),c.return=i;c.sibling=null}return i.child}function p0(t,i){return(t.lanes&i)!==0?!0:(t=t.dependencies,!!(t!==null&&rh(t)))}function RA(t,i,c){switch(i.tag){case 3:mt(i,i.stateNode.containerInfo),$a(i,Ur,t.memoizedState.cache),Wo();break;case 27:case 5:sn(i);break;case 4:mt(i,i.stateNode.containerInfo);break;case 10:$a(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,jf(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(ro(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Mp(t,i,c):(ro(i),t=_a(t,i,c),t!==null?t.sibling:null);ro(i);break;case 19:var E=(t.flags&128)!==0;if(f=(c&i.childLanes)!==0,f||(Ol(t,i,c,!1),f=(c&i.childLanes)!==0),E){if(f)return Lp(t,i,c);i.flags|=128}if(E=i.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),ve(Pr,Pr.current),f)break;return null;case 22:return i.lanes=0,Sp(t,i,c,i.pendingProps);case 24:$a(i,Ur,t.memoizedState.cache)}return _a(t,i,c)}function Pp(t,i,c){if(t!==null)if(t.memoizedProps!==i.pendingProps)jr=!0;else{if(!p0(t,c)&&(i.flags&128)===0)return jr=!1,RA(t,i,c);jr=(t.flags&131072)!==0}else jr=!1,Nn&&(i.flags&1048576)!==0&&gm(i,Cc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(t=Jo(i.elementType),i.type=t,typeof t=="function")_f(t)?(f=nl(t,f),i.tag=1,i=Op(null,i,t,f,c)):(i.tag=0,i=c0(null,i,t,f,c));else{if(t!=null){var E=t.$$typeof;if(E===Ge){i.tag=11,i=vp(null,i,t,f,c);break e}else if(E===F){i.tag=14,i=Tp(null,i,t,f,c);break e}}throw i=ot(t)||t,Error(o(306,i,""))}}return i;case 0:return c0(t,i,i.type,i.pendingProps,c);case 1:return f=i.type,E=nl(f,i.pendingProps),Op(t,i,f,E,c);case 3:e:{if(mt(i,i.stateNode.containerInfo),t===null)throw Error(o(387));f=i.pendingProps;var A=i.memoizedState;E=A.element,Pf(t,i),kc(i,f,null,c);var O=i.memoizedState;if(f=O.cache,$a(i,Ur,f),f!==A.cache&&Nf(i,[Ur],c,!0),Mc(),f=O.element,A.isDehydrated)if(A={element:f,isDehydrated:!1,cache:O.cache},i.updateQueue.baseState=A,i.memoizedState=A,i.flags&256){i=Dp(t,i,f,c);break e}else if(f!==E){E=xs(Error(o(424)),i),Sc(E),i=Dp(t,i,f,c);break e}else{switch(t=i.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(hr=bs(t.firstChild),si=i,Nn=!0,Za=null,_s=!0,c=Sm(i,null,f,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Wo(),f===E){i=_a(t,i,c);break e}oi(t,i,f,c)}i=i.child}return i;case 26:return Ah(t,i),t===null?(c=Yy(i.type,null,i.pendingProps,null))?i.memoizedState=c:Nn||(c=i.type,t=i.pendingProps,f=Uh(me.current).createElement(c),f[yt]=i,f[Mt]=t,li(f,c,t),ar(f),i.stateNode=f):i.memoizedState=Yy(i.type,t.memoizedProps,i.pendingProps,t.memoizedState),null;case 27:return sn(i),t===null&&Nn&&(f=i.stateNode=Gy(i.type,i.pendingProps,me.current),si=i,_s=!0,E=hr,fo(i.type)?(K0=E,hr=bs(f.firstChild)):hr=E),oi(t,i,i.pendingProps.children,c),Ah(t,i),t===null&&(i.flags|=4194304),i.child;case 5:return t===null&&Nn&&((E=f=hr)&&(f=sb(f,i.type,i.pendingProps,_s),f!==null?(i.stateNode=f,si=i,hr=bs(f.firstChild),_s=!1,E=!0):E=!1),E||Ja(i)),sn(i),E=i.type,A=i.pendingProps,O=t!==null?t.memoizedProps:null,f=A.children,G0(E,A)?f=null:O!==null&&G0(E,O)&&(i.flags|=32),i.memoizedState!==null&&(E=Hf(t,i,wA,null,null,c),eu._currentValue=E),Ah(t,i),oi(t,i,f,c),i.child;case 6:return t===null&&Nn&&((t=c=hr)&&(c=ab(c,i.pendingProps,_s),c!==null?(i.stateNode=c,si=i,hr=null,t=!0):t=!1),t||Ja(i)),null;case 13:return Mp(t,i,c);case 4:return mt(i,i.stateNode.containerInfo),f=i.pendingProps,t===null?i.child=el(i,null,f,c):oi(t,i,f,c),i.child;case 11:return vp(t,i,i.type,i.pendingProps,c);case 7:return oi(t,i,i.pendingProps,c),i.child;case 8:return oi(t,i,i.pendingProps.children,c),i.child;case 12:return oi(t,i,i.pendingProps.children,c),i.child;case 10:return f=i.pendingProps,$a(i,i.type,f.value),oi(t,i,f.children,c),i.child;case 9:return E=i.type._context,f=i.pendingProps.children,Qo(i),E=ai(E),f=f(E),i.flags|=1,oi(t,i,f,c),i.child;case 14:return Tp(t,i,i.type,i.pendingProps,c);case 15:return Cp(t,i,i.type,i.pendingProps,c);case 19:return Lp(t,i,c);case 31:return IA(t,i,c);case 22:return Sp(t,i,c,i.pendingProps);case 24:return Qo(i),f=ai(Ur),t===null?(E=Mf(),E===null&&(E=ir,A=Of(),E.pooledCache=A,A.refCount++,A!==null&&(E.pooledCacheLanes|=c),E=A),i.memoizedState={parent:f,cache:E},Lf(i),$a(i,Ur,E)):((t.lanes&c)!==0&&(Pf(t,i),kc(i,null,null,c),Mc()),E=t.memoizedState,A=i.memoizedState,E.parent!==f?(E={parent:f,cache:f},i.memoizedState=E,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=E),$a(i,Ur,f)):(f=A.cache,$a(i,Ur,f),f!==E.cache&&Nf(i,[Ur],c,!0))),oi(t,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(o(156,i.tag))}function Aa(t){t.flags|=4}function y0(t,i,c,f,E){if((i=(t.mode&32)!==0)&&(i=!1),i){if(t.flags|=16777216,(E&335544128)===E)if(t.stateNode.complete)t.flags|=8192;else if(cy())t.flags|=8192;else throw $o=oh,kf}else t.flags&=-16777217}function Bp(t,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Jy(i))if(cy())t.flags|=8192;else throw $o=oh,kf}function vh(t,i){i!==null&&(t.flags|=4),t.flags&16384&&(i=t.tag!==22?re():536870912,t.lanes|=i,Hl|=i)}function Fc(t,i){if(!Nn)switch(t.tailMode){case"hidden":i=t.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?t.tail=null:c.sibling=null;break;case"collapsed":c=t.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:f.sibling=null}}function dr(t){var i=t.alternate!==null&&t.alternate.child===t.child,c=0,f=0;if(i)for(var E=t.child;E!==null;)c|=E.lanes|E.childLanes,f|=E.subtreeFlags&65011712,f|=E.flags&65011712,E.return=t,E=E.sibling;else for(E=t.child;E!==null;)c|=E.lanes|E.childLanes,f|=E.subtreeFlags,f|=E.flags,E.return=t,E=E.sibling;return t.subtreeFlags|=f,t.childLanes=c,i}function NA(t,i,c){var f=i.pendingProps;switch(Tf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(i),null;case 1:return dr(i),null;case 3:return c=i.stateNode,f=null,t!==null&&(f=t.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),xa(Ur),Ct(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(t===null||t.child===null)&&(Nl(i)?Aa(i):t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Sf())),dr(i),null;case 26:var E=i.type,A=i.memoizedState;return t===null?(Aa(i),A!==null?(dr(i),Bp(i,A)):(dr(i),y0(i,E,null,f,c))):A?A!==t.memoizedState?(Aa(i),dr(i),Bp(i,A)):(dr(i),i.flags&=-16777217):(t=t.memoizedProps,t!==f&&Aa(i),dr(i),y0(i,E,t,f,c)),null;case 27:if(Qt(i),c=me.current,E=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==f&&Aa(i);else{if(!f){if(i.stateNode===null)throw Error(o(166));return dr(i),null}t=Ce.current,Nl(i)?pm(i):(t=Gy(E,f,c),i.stateNode=t,Aa(i))}return dr(i),null;case 5:if(Qt(i),E=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==f&&Aa(i);else{if(!f){if(i.stateNode===null)throw Error(o(166));return dr(i),null}if(A=Ce.current,Nl(i))pm(i);else{var O=Uh(me.current);switch(A){case 1:A=O.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:A=O.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":A=O.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":A=O.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":A=O.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof f.is=="string"?O.createElement("select",{is:f.is}):O.createElement("select"),f.multiple?A.multiple=!0:f.size&&(A.size=f.size);break;default:A=typeof f.is=="string"?O.createElement(E,{is:f.is}):O.createElement(E)}}A[yt]=i,A[Mt]=f;e:for(O=i.child;O!==null;){if(O.tag===5||O.tag===6)A.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===i)break e;for(;O.sibling===null;){if(O.return===null||O.return===i)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}i.stateNode=A;e:switch(li(A,E,f),E){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Aa(i)}}return dr(i),y0(i,i.type,t===null?null:t.memoizedProps,i.pendingProps,c),null;case 6:if(t&&i.stateNode!=null)t.memoizedProps!==f&&Aa(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(o(166));if(t=me.current,Nl(i)){if(t=i.stateNode,c=i.memoizedProps,f=null,E=si,E!==null)switch(E.tag){case 27:case 5:f=E.memoizedProps}t[yt]=i,t=!!(t.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||My(t.nodeValue,c)),t||Ja(i,!0)}else t=Uh(t).createTextNode(f),t[yt]=i,i.stateNode=t}return dr(i),null;case 31:if(c=i.memoizedState,t===null||t.memoizedState!==null){if(f=Nl(i),c!==null){if(t===null){if(!f)throw Error(o(318));if(t=i.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(557));t[yt]=i}else Wo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;dr(i),t=!1}else c=Sf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=c),t=!0;if(!t)return i.flags&256?(is(i),i):(is(i),null);if((i.flags&128)!==0)throw Error(o(558))}return dr(i),null;case 13:if(f=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(E=Nl(i),f!==null&&f.dehydrated!==null){if(t===null){if(!E)throw Error(o(318));if(E=i.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(o(317));E[yt]=i}else Wo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;dr(i),E=!1}else E=Sf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=E),E=!0;if(!E)return i.flags&256?(is(i),i):(is(i),null)}return is(i),(i.flags&128)!==0?(i.lanes=c,i):(c=f!==null,t=t!==null&&t.memoizedState!==null,c&&(f=i.child,E=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(E=f.alternate.memoizedState.cachePool.pool),A=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),A!==E&&(f.flags|=2048)),c!==t&&c&&(i.child.flags|=8192),vh(i,i.updateQueue),dr(i),null);case 4:return Ct(),t===null&&U0(i.stateNode.containerInfo),dr(i),null;case 10:return xa(i.type),dr(i),null;case 19:if(se(Pr),f=i.memoizedState,f===null)return dr(i),null;if(E=(i.flags&128)!==0,A=f.rendering,A===null)if(E)Fc(f,!1);else{if(Rr!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(A=hh(t),A!==null){for(i.flags|=128,Fc(f,!1),t=A.updateQueue,i.updateQueue=t,vh(i,t),i.subtreeFlags=0,t=c,c=i.child;c!==null;)hm(c,t),c=c.sibling;return ve(Pr,Pr.current&1|2),Nn&&pa(i,f.treeForkCount),i.child}t=t.sibling}f.tail!==null&&ht()>Rh&&(i.flags|=128,E=!0,Fc(f,!1),i.lanes=4194304)}else{if(!E)if(t=hh(A),t!==null){if(i.flags|=128,E=!0,t=t.updateQueue,i.updateQueue=t,vh(i,t),Fc(f,!0),f.tail===null&&f.tailMode==="hidden"&&!A.alternate&&!Nn)return dr(i),null}else 2*ht()-f.renderingStartTime>Rh&&c!==536870912&&(i.flags|=128,E=!0,Fc(f,!1),i.lanes=4194304);f.isBackwards?(A.sibling=i.child,i.child=A):(t=f.last,t!==null?t.sibling=A:i.child=A,f.last=A)}return f.tail!==null?(t=f.tail,f.rendering=t,f.tail=t.sibling,f.renderingStartTime=ht(),t.sibling=null,c=Pr.current,ve(Pr,E?c&1|2:c&1),Nn&&pa(i,f.treeForkCount),t):(dr(i),null);case 22:case 23:return is(i),Ff(),f=i.memoizedState!==null,t!==null?t.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(c&536870912)!==0&&(i.flags&128)===0&&(dr(i),i.subtreeFlags&6&&(i.flags|=8192)):dr(i),c=i.updateQueue,c!==null&&vh(i,c.retryQueue),c=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(c=t.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048),t!==null&&se(Zo),null;case 24:return c=null,t!==null&&(c=t.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),xa(Ur),dr(i),null;case 25:return null;case 30:return null}throw Error(o(156,i.tag))}function OA(t,i){switch(Tf(i),i.tag){case 1:return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return xa(Ur),Ct(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 26:case 27:case 5:return Qt(i),null;case 31:if(i.memoizedState!==null){if(is(i),i.alternate===null)throw Error(o(340));Wo()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 13:if(is(i),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(o(340));Wo()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return se(Pr),null;case 4:return Ct(),null;case 10:return xa(i.type),null;case 22:case 23:return is(i),Ff(),t!==null&&se(Zo),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 24:return xa(Ur),null;case 25:return null;default:return null}}function Vp(t,i){switch(Tf(i),i.tag){case 3:xa(Ur),Ct();break;case 26:case 27:case 5:Qt(i);break;case 4:Ct();break;case 31:i.memoizedState!==null&&is(i);break;case 13:is(i);break;case 19:se(Pr);break;case 10:xa(i.type);break;case 22:case 23:is(i),Ff(),t!==null&&se(Zo);break;case 24:xa(Ur)}}function jc(t,i){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var E=f.next;c=E;do{if((c.tag&t)===t){f=void 0;var A=c.create,O=c.inst;f=A(),O.destroy=f}c=c.next}while(c!==E)}}catch(V){Yn(i,i.return,V)}}function so(t,i,c){try{var f=i.updateQueue,E=f!==null?f.lastEffect:null;if(E!==null){var A=E.next;f=A;do{if((f.tag&t)===t){var O=f.inst,V=O.destroy;if(V!==void 0){O.destroy=void 0,E=i;var Q=c,ye=V;try{ye()}catch(Re){Yn(E,Q,Re)}}}f=f.next}while(f!==A)}}catch(Re){Yn(i,i.return,Re)}}function Up(t){var i=t.updateQueue;if(i!==null){var c=t.stateNode;try{Rm(i,c)}catch(f){Yn(t,t.return,f)}}}function Fp(t,i,c){c.props=nl(t.type,t.memoizedProps),c.state=t.memoizedState;try{c.componentWillUnmount()}catch(f){Yn(t,i,f)}}function zc(t,i){try{var c=t.ref;if(c!==null){switch(t.tag){case 26:case 27:case 5:var f=t.stateNode;break;case 30:f=t.stateNode;break;default:f=t.stateNode}typeof c=="function"?t.refCleanup=c(f):c.current=f}}catch(E){Yn(t,i,E)}}function Gs(t,i){var c=t.ref,f=t.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(E){Yn(t,i,E)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(E){Yn(t,i,E)}else c.current=null}function jp(t){var i=t.type,c=t.memoizedProps,f=t.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(E){Yn(t,t.return,E)}}function x0(t,i,c){try{var f=t.stateNode;$A(f,t.type,c,i),f[Mt]=i}catch(E){Yn(t,t.return,E)}}function zp(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&fo(t.type)||t.tag===4}function E0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&fo(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function w0(t,i,c){var f=t.tag;if(f===5||f===6)t=t.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(t,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(t),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=pi));else if(f!==4&&(f===27&&fo(t.type)&&(c=t.stateNode,i=null),t=t.child,t!==null))for(w0(t,i,c),t=t.sibling;t!==null;)w0(t,i,c),t=t.sibling}function Th(t,i,c){var f=t.tag;if(f===5||f===6)t=t.stateNode,i?c.insertBefore(t,i):c.appendChild(t);else if(f!==4&&(f===27&&fo(t.type)&&(c=t.stateNode),t=t.child,t!==null))for(Th(t,i,c),t=t.sibling;t!==null;)Th(t,i,c),t=t.sibling}function Hp(t){var i=t.stateNode,c=t.memoizedProps;try{for(var f=t.type,E=i.attributes;E.length;)i.removeAttributeNode(E[0]);li(i,f,c),i[yt]=t,i[Mt]=c}catch(A){Yn(t,t.return,A)}}var ba=!1,zr=!1,_0=!1,Gp=typeof WeakSet=="function"?WeakSet:Set,ti=null;function DA(t,i){if(t=t.containerInfo,z0=Xh,t=k(t),L(t)){if("selectionStart"in t)var c={start:t.selectionStart,end:t.selectionEnd};else e:{c=(c=t.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var E=f.anchorOffset,A=f.focusNode;f=f.focusOffset;try{c.nodeType,A.nodeType}catch{c=null;break e}var O=0,V=-1,Q=-1,ye=0,Re=0,Pe=t,Ee=null;t:for(;;){for(var be;Pe!==c||E!==0&&Pe.nodeType!==3||(V=O+E),Pe!==A||f!==0&&Pe.nodeType!==3||(Q=O+f),Pe.nodeType===3&&(O+=Pe.nodeValue.length),(be=Pe.firstChild)!==null;)Ee=Pe,Pe=be;for(;;){if(Pe===t)break t;if(Ee===c&&++ye===E&&(V=O),Ee===A&&++Re===f&&(Q=O),(be=Pe.nextSibling)!==null)break;Pe=Ee,Ee=Pe.parentNode}Pe=be}c=V===-1||Q===-1?null:{start:V,end:Q}}else c=null}c=c||{start:0,end:0}}else c=null;for(H0={focusedElem:t,selectionRange:c},Xh=!1,ti=i;ti!==null;)if(i=ti,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,ti=t;else for(;ti!==null;){switch(i=ti,A=i.alternate,t=i.flags,i.tag){case 0:if((t&4)!==0&&(t=i.updateQueue,t=t!==null?t.events:null,t!==null))for(c=0;c<t.length;c++)E=t[c],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&A!==null){t=void 0,c=i,E=A.memoizedProps,A=A.memoizedState,f=c.stateNode;try{var vt=nl(c.type,E);t=f.getSnapshotBeforeUpdate(vt,A),f.__reactInternalSnapshotBeforeUpdate=t}catch(zt){Yn(c,c.return,zt)}}break;case 3:if((t&1024)!==0){if(t=i.stateNode.containerInfo,c=t.nodeType,c===9)X0(t);else if(c===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":X0(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(o(163))}if(t=i.sibling,t!==null){t.return=i.return,ti=t;break}ti=i.return}}function qp(t,i,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Ta(t,c),f&4&&jc(5,c);break;case 1:if(Ta(t,c),f&4)if(t=c.stateNode,i===null)try{t.componentDidMount()}catch(O){Yn(c,c.return,O)}else{var E=nl(c.type,i.memoizedProps);i=i.memoizedState;try{t.componentDidUpdate(E,i,t.__reactInternalSnapshotBeforeUpdate)}catch(O){Yn(c,c.return,O)}}f&64&&Up(c),f&512&&zc(c,c.return);break;case 3:if(Ta(t,c),f&64&&(t=c.updateQueue,t!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Rm(t,i)}catch(O){Yn(c,c.return,O)}}break;case 27:i===null&&f&4&&Hp(c);case 26:case 5:Ta(t,c),i===null&&f&4&&jp(c),f&512&&zc(c,c.return);break;case 12:Ta(t,c);break;case 31:Ta(t,c),f&4&&Wp(t,c);break;case 13:Ta(t,c),f&4&&Kp(t,c),f&64&&(t=c.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(c=jA.bind(null,c),ob(t,c))));break;case 22:if(f=c.memoizedState!==null||ba,!f){i=i!==null&&i.memoizedState!==null||zr,E=ba;var A=zr;ba=f,(zr=i)&&!A?Ca(t,c,(c.subtreeFlags&8772)!==0):Ta(t,c),ba=E,zr=A}break;case 30:break;default:Ta(t,c)}}function Xp(t){var i=t.alternate;i!==null&&(t.alternate=null,Xp(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&Yr(i)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var xr=null,ji=!1;function va(t,i,c){for(c=c.child;c!==null;)Yp(t,i,c),c=c.sibling}function Yp(t,i,c){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(tn,c)}catch{}switch(c.tag){case 26:zr||Gs(c,i),va(t,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:zr||Gs(c,i);var f=xr,E=ji;fo(c.type)&&(xr=c.stateNode,ji=!1),va(t,i,c),Zc(c.stateNode),xr=f,ji=E;break;case 5:zr||Gs(c,i);case 6:if(f=xr,E=ji,xr=null,va(t,i,c),xr=f,ji=E,xr!==null)if(ji)try{(xr.nodeType===9?xr.body:xr.nodeName==="HTML"?xr.ownerDocument.body:xr).removeChild(c.stateNode)}catch(A){Yn(c,i,A)}else try{xr.removeChild(c.stateNode)}catch(A){Yn(c,i,A)}break;case 18:xr!==null&&(ji?(t=xr,Uy(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,c.stateNode),Zl(t)):Uy(xr,c.stateNode));break;case 4:f=xr,E=ji,xr=c.stateNode.containerInfo,ji=!0,va(t,i,c),xr=f,ji=E;break;case 0:case 11:case 14:case 15:so(2,c,i),zr||so(4,c,i),va(t,i,c);break;case 1:zr||(Gs(c,i),f=c.stateNode,typeof f.componentWillUnmount=="function"&&Fp(c,i,f)),va(t,i,c);break;case 21:va(t,i,c);break;case 22:zr=(f=zr)||c.memoizedState!==null,va(t,i,c),zr=f;break;default:va(t,i,c)}}function Wp(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Zl(t)}catch(c){Yn(i,i.return,c)}}}function Kp(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Zl(t)}catch(c){Yn(i,i.return,c)}}function MA(t){switch(t.tag){case 31:case 13:case 19:var i=t.stateNode;return i===null&&(i=t.stateNode=new Gp),i;case 22:return t=t.stateNode,i=t._retryCache,i===null&&(i=t._retryCache=new Gp),i;default:throw Error(o(435,t.tag))}}function Ch(t,i){var c=MA(t);i.forEach(function(f){if(!c.has(f)){c.add(f);var E=zA.bind(null,t,f);f.then(E,E)}})}function zi(t,i){var c=i.deletions;if(c!==null)for(var f=0;f<c.length;f++){var E=c[f],A=t,O=i,V=O;e:for(;V!==null;){switch(V.tag){case 27:if(fo(V.type)){xr=V.stateNode,ji=!1;break e}break;case 5:xr=V.stateNode,ji=!1;break e;case 3:case 4:xr=V.stateNode.containerInfo,ji=!0;break e}V=V.return}if(xr===null)throw Error(o(160));Yp(A,O,E),xr=null,ji=!1,A=E.alternate,A!==null&&(A.return=null),E.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Qp(i,t),i=i.sibling}var Ns=null;function Qp(t,i){var c=t.alternate,f=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:zi(i,t),Hi(t),f&4&&(so(3,t,t.return),jc(3,t),so(5,t,t.return));break;case 1:zi(i,t),Hi(t),f&512&&(zr||c===null||Gs(c,c.return)),f&64&&ba&&(t=t.updateQueue,t!==null&&(f=t.callbacks,f!==null&&(c=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var E=Ns;if(zi(i,t),Hi(t),f&512&&(zr||c===null||Gs(c,c.return)),f&4){var A=c!==null?c.memoizedState:null;if(f=t.memoizedState,c===null)if(f===null)if(t.stateNode===null){e:{f=t.type,c=t.memoizedProps,E=E.ownerDocument||E;t:switch(f){case"title":A=E.getElementsByTagName("title")[0],(!A||A[Li]||A[yt]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=E.createElement(f),E.head.insertBefore(A,E.querySelector("head > title"))),li(A,f,c),A[yt]=t,ar(A),f=A;break e;case"link":var O=Qy("link","href",E).get(f+(c.href||""));if(O){for(var V=0;V<O.length;V++)if(A=O[V],A.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&A.getAttribute("rel")===(c.rel==null?null:c.rel)&&A.getAttribute("title")===(c.title==null?null:c.title)&&A.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){O.splice(V,1);break t}}A=E.createElement(f),li(A,f,c),E.head.appendChild(A);break;case"meta":if(O=Qy("meta","content",E).get(f+(c.content||""))){for(V=0;V<O.length;V++)if(A=O[V],A.getAttribute("content")===(c.content==null?null:""+c.content)&&A.getAttribute("name")===(c.name==null?null:c.name)&&A.getAttribute("property")===(c.property==null?null:c.property)&&A.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&A.getAttribute("charset")===(c.charSet==null?null:c.charSet)){O.splice(V,1);break t}}A=E.createElement(f),li(A,f,c),E.head.appendChild(A);break;default:throw Error(o(468,f))}A[yt]=t,ar(A),f=A}t.stateNode=f}else Zy(E,t.type,t.stateNode);else t.stateNode=Ky(E,f,t.memoizedProps);else A!==f?(A===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):A.count--,f===null?Zy(E,t.type,t.stateNode):Ky(E,f,t.memoizedProps)):f===null&&t.stateNode!==null&&x0(t,t.memoizedProps,c.memoizedProps)}break;case 27:zi(i,t),Hi(t),f&512&&(zr||c===null||Gs(c,c.return)),c!==null&&f&4&&x0(t,t.memoizedProps,c.memoizedProps);break;case 5:if(zi(i,t),Hi(t),f&512&&(zr||c===null||Gs(c,c.return)),t.flags&32){E=t.stateNode;try{mi(E,"")}catch(vt){Yn(t,t.return,vt)}}f&4&&t.stateNode!=null&&(E=t.memoizedProps,x0(t,E,c!==null?c.memoizedProps:E)),f&1024&&(_0=!0);break;case 6:if(zi(i,t),Hi(t),f&4){if(t.stateNode===null)throw Error(o(162));f=t.memoizedProps,c=t.stateNode;try{c.nodeValue=f}catch(vt){Yn(t,t.return,vt)}}break;case 3:if(zh=null,E=Ns,Ns=Fh(i.containerInfo),zi(i,t),Ns=E,Hi(t),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Zl(i.containerInfo)}catch(vt){Yn(t,t.return,vt)}_0&&(_0=!1,Zp(t));break;case 4:f=Ns,Ns=Fh(t.stateNode.containerInfo),zi(i,t),Hi(t),Ns=f;break;case 12:zi(i,t),Hi(t);break;case 31:zi(i,t),Hi(t),f&4&&(f=t.updateQueue,f!==null&&(t.updateQueue=null,Ch(t,f)));break;case 13:zi(i,t),Hi(t),t.child.flags&8192&&t.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Ih=ht()),f&4&&(f=t.updateQueue,f!==null&&(t.updateQueue=null,Ch(t,f)));break;case 22:E=t.memoizedState!==null;var Q=c!==null&&c.memoizedState!==null,ye=ba,Re=zr;if(ba=ye||E,zr=Re||Q,zi(i,t),zr=Re,ba=ye,Hi(t),f&8192)e:for(i=t.stateNode,i._visibility=E?i._visibility&-2:i._visibility|1,E&&(c===null||Q||ba||zr||rl(t)),c=null,i=t;;){if(i.tag===5||i.tag===26){if(c===null){Q=c=i;try{if(A=Q.stateNode,E)O=A.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{V=Q.stateNode;var Pe=Q.memoizedProps.style,Ee=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null;V.style.display=Ee==null||typeof Ee=="boolean"?"":(""+Ee).trim()}}catch(vt){Yn(Q,Q.return,vt)}}}else if(i.tag===6){if(c===null){Q=i;try{Q.stateNode.nodeValue=E?"":Q.memoizedProps}catch(vt){Yn(Q,Q.return,vt)}}}else if(i.tag===18){if(c===null){Q=i;try{var be=Q.stateNode;E?Fy(be,!0):Fy(Q.stateNode,!1)}catch(vt){Yn(Q,Q.return,vt)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===t)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;i.sibling===null;){if(i.return===null||i.return===t)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=t.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Ch(t,c))));break;case 19:zi(i,t),Hi(t),f&4&&(f=t.updateQueue,f!==null&&(t.updateQueue=null,Ch(t,f)));break;case 30:break;case 21:break;default:zi(i,t),Hi(t)}}function Hi(t){var i=t.flags;if(i&2){try{for(var c,f=t.return;f!==null;){if(zp(f)){c=f;break}f=f.return}if(c==null)throw Error(o(160));switch(c.tag){case 27:var E=c.stateNode,A=E0(t);Th(t,A,E);break;case 5:var O=c.stateNode;c.flags&32&&(mi(O,""),c.flags&=-33);var V=E0(t);Th(t,V,O);break;case 3:case 4:var Q=c.stateNode.containerInfo,ye=E0(t);w0(t,ye,Q);break;default:throw Error(o(161))}}catch(Re){Yn(t,t.return,Re)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function Zp(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var i=t;Zp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),t=t.sibling}}function Ta(t,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)qp(t,i.alternate,i),i=i.sibling}function rl(t){for(t=t.child;t!==null;){var i=t;switch(i.tag){case 0:case 11:case 14:case 15:so(4,i,i.return),rl(i);break;case 1:Gs(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&Fp(i,i.return,c),rl(i);break;case 27:Zc(i.stateNode);case 26:case 5:Gs(i,i.return),rl(i);break;case 22:i.memoizedState===null&&rl(i);break;case 30:rl(i);break;default:rl(i)}t=t.sibling}}function Ca(t,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,E=t,A=i,O=A.flags;switch(A.tag){case 0:case 11:case 15:Ca(E,A,c),jc(4,A);break;case 1:if(Ca(E,A,c),f=A,E=f.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(ye){Yn(f,f.return,ye)}if(f=A,E=f.updateQueue,E!==null){var V=f.stateNode;try{var Q=E.shared.hiddenCallbacks;if(Q!==null)for(E.shared.hiddenCallbacks=null,E=0;E<Q.length;E++)Im(Q[E],V)}catch(ye){Yn(f,f.return,ye)}}c&&O&64&&Up(A),zc(A,A.return);break;case 27:Hp(A);case 26:case 5:Ca(E,A,c),c&&f===null&&O&4&&jp(A),zc(A,A.return);break;case 12:Ca(E,A,c);break;case 31:Ca(E,A,c),c&&O&4&&Wp(E,A);break;case 13:Ca(E,A,c),c&&O&4&&Kp(E,A);break;case 22:A.memoizedState===null&&Ca(E,A,c),zc(A,A.return);break;case 30:break;default:Ca(E,A,c)}i=i.sibling}}function A0(t,i){var c=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(c=t.memoizedState.cachePool.pool),t=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(t=i.memoizedState.cachePool.pool),t!==c&&(t!=null&&t.refCount++,c!=null&&Ic(c))}function b0(t,i){t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&Ic(t))}function Os(t,i,c,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Jp(t,i,c,f),i=i.sibling}function Jp(t,i,c,f){var E=i.flags;switch(i.tag){case 0:case 11:case 15:Os(t,i,c,f),E&2048&&jc(9,i);break;case 1:Os(t,i,c,f);break;case 3:Os(t,i,c,f),E&2048&&(t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&Ic(t)));break;case 12:if(E&2048){Os(t,i,c,f),t=i.stateNode;try{var A=i.memoizedProps,O=A.id,V=A.onPostCommit;typeof V=="function"&&V(O,i.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(Q){Yn(i,i.return,Q)}}else Os(t,i,c,f);break;case 31:Os(t,i,c,f);break;case 13:Os(t,i,c,f);break;case 23:break;case 22:A=i.stateNode,O=i.alternate,i.memoizedState!==null?A._visibility&2?Os(t,i,c,f):Hc(t,i):A._visibility&2?Os(t,i,c,f):(A._visibility|=2,Fl(t,i,c,f,(i.subtreeFlags&10256)!==0||!1)),E&2048&&A0(O,i);break;case 24:Os(t,i,c,f),E&2048&&b0(i.alternate,i);break;default:Os(t,i,c,f)}}function Fl(t,i,c,f,E){for(E=E&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var A=t,O=i,V=c,Q=f,ye=O.flags;switch(O.tag){case 0:case 11:case 15:Fl(A,O,V,Q,E),jc(8,O);break;case 23:break;case 22:var Re=O.stateNode;O.memoizedState!==null?Re._visibility&2?Fl(A,O,V,Q,E):Hc(A,O):(Re._visibility|=2,Fl(A,O,V,Q,E)),E&&ye&2048&&A0(O.alternate,O);break;case 24:Fl(A,O,V,Q,E),E&&ye&2048&&b0(O.alternate,O);break;default:Fl(A,O,V,Q,E)}i=i.sibling}}function Hc(t,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=t,f=i,E=f.flags;switch(f.tag){case 22:Hc(c,f),E&2048&&A0(f.alternate,f);break;case 24:Hc(c,f),E&2048&&b0(f.alternate,f);break;default:Hc(c,f)}i=i.sibling}}var Gc=8192;function jl(t,i,c){if(t.subtreeFlags&Gc)for(t=t.child;t!==null;)$p(t,i,c),t=t.sibling}function $p(t,i,c){switch(t.tag){case 26:jl(t,i,c),t.flags&Gc&&t.memoizedState!==null&&Eb(c,Ns,t.memoizedState,t.memoizedProps);break;case 5:jl(t,i,c);break;case 3:case 4:var f=Ns;Ns=Fh(t.stateNode.containerInfo),jl(t,i,c),Ns=f;break;case 22:t.memoizedState===null&&(f=t.alternate,f!==null&&f.memoizedState!==null?(f=Gc,Gc=16777216,jl(t,i,c),Gc=f):jl(t,i,c));break;default:jl(t,i,c)}}function ey(t){var i=t.alternate;if(i!==null&&(t=i.child,t!==null)){i.child=null;do i=t.sibling,t.sibling=null,t=i;while(t!==null)}}function qc(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];ti=f,ny(f,t)}ey(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ty(t),t=t.sibling}function ty(t){switch(t.tag){case 0:case 11:case 15:qc(t),t.flags&2048&&so(9,t,t.return);break;case 3:qc(t);break;case 12:qc(t);break;case 22:var i=t.stateNode;t.memoizedState!==null&&i._visibility&2&&(t.return===null||t.return.tag!==13)?(i._visibility&=-3,Sh(t)):qc(t);break;default:qc(t)}}function Sh(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];ti=f,ny(f,t)}ey(t)}for(t=t.child;t!==null;){switch(i=t,i.tag){case 0:case 11:case 15:so(8,i,i.return),Sh(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Sh(i));break;default:Sh(i)}t=t.sibling}}function ny(t,i){for(;ti!==null;){var c=ti;switch(c.tag){case 0:case 11:case 15:so(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ic(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,ti=f;else e:for(c=t;ti!==null;){f=ti;var E=f.sibling,A=f.return;if(Xp(f),f===c){ti=null;break e}if(E!==null){E.return=A,ti=E;break e}ti=A}}}var kA={getCacheForType:function(t){var i=ai(Ur),c=i.data.get(t);return c===void 0&&(c=t(),i.data.set(t,c)),c},cacheSignal:function(){return ai(Ur).controller.signal}},LA=typeof WeakMap=="function"?WeakMap:Map,Fn=0,ir=null,pn=null,An=0,Xn=0,ss=null,ao=!1,zl=!1,v0=!1,Sa=0,Rr=0,oo=0,il=0,T0=0,as=0,Hl=0,Xc=null,Gi=null,C0=!1,Ih=0,ry=0,Rh=1/0,Nh=null,lo=null,Kr=0,co=null,Gl=null,Ia=0,S0=0,I0=null,iy=null,Yc=0,R0=null;function os(){return(Fn&2)!==0&&An!==0?An&-An:le.T!==null?L0():Ut()}function sy(){if(as===0)if((An&536870912)===0||Nn){var t=Vt;Vt<<=1,(Vt&3932160)===0&&(Vt=262144),as=t}else as=536870912;return t=rs.current,t!==null&&(t.flags|=32),as}function qi(t,i,c){(t===ir&&(Xn===2||Xn===9)||t.cancelPendingCommit!==null)&&(ql(t,0),uo(t,An,as,!1)),je(t,c),((Fn&2)===0||t!==ir)&&(t===ir&&((Fn&2)===0&&(il|=c),Rr===4&&uo(t,An,as,!1)),qs(t))}function ay(t,i,c){if((Fn&6)!==0)throw Error(o(327));var f=!c&&(i&127)===0&&(i&t.expiredLanes)===0||dt(t,i),E=f?VA(t,i):O0(t,i,!0),A=f;do{if(E===0){zl&&!f&&uo(t,i,0,!1);break}else{if(c=t.current.alternate,A&&!PA(c)){E=O0(t,i,!1),A=!1;continue}if(E===2){if(A=i,t.errorRecoveryDisabledLanes&A)var O=0;else O=t.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){i=O;e:{var V=t;E=Xc;var Q=V.current.memoizedState.isDehydrated;if(Q&&(ql(V,O).flags|=256),O=O0(V,O,!1),O!==2){if(v0&&!Q){V.errorRecoveryDisabledLanes|=A,il|=A,E=4;break e}A=Gi,Gi=E,A!==null&&(Gi===null?Gi=A:Gi.push.apply(Gi,A))}E=O}if(A=!1,E!==2)continue}}if(E===1){ql(t,0),uo(t,i,0,!0);break}e:{switch(f=t,A=E,A){case 0:case 1:throw Error(o(345));case 4:if((i&4194048)!==i)break;case 6:uo(f,i,as,!ao);break e;case 2:Gi=null;break;case 3:case 5:break;default:throw Error(o(329))}if((i&62914560)===i&&(E=Ih+300-ht(),10<E)){if(uo(f,i,as,!ao),Mr(f,0,!0)!==0)break e;Ia=i,f.timeoutHandle=By(oy.bind(null,f,c,Gi,Nh,C0,i,as,il,Hl,ao,A,"Throttled",-0,0),E);break e}oy(f,c,Gi,Nh,C0,i,as,il,Hl,ao,A,null,-0,0)}}break}while(!0);qs(t)}function oy(t,i,c,f,E,A,O,V,Q,ye,Re,Pe,Ee,be){if(t.timeoutHandle=-1,Pe=i.subtreeFlags,Pe&8192||(Pe&16785408)===16785408){Pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pi},$p(i,A,Pe);var vt=(A&62914560)===A?Ih-ht():(A&4194048)===A?ry-ht():0;if(vt=wb(Pe,vt),vt!==null){Ia=A,t.cancelPendingCommit=vt(my.bind(null,t,i,A,c,f,E,O,V,Q,Re,Pe,null,Ee,be)),uo(t,A,O,!ye);return}}my(t,i,A,c,f,E,O,V,Q)}function PA(t){for(var i=t;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var E=c[f],A=E.getSnapshot;E=E.value;try{if(!m(A(),E))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function uo(t,i,c,f){i&=~T0,i&=~il,t.suspendedLanes|=i,t.pingedLanes&=~i,f&&(t.warmLanes|=i),f=t.expirationTimes;for(var E=i;0<E;){var A=31-At(E),O=1<<A;f[A]=-1,E&=~O}c!==0&&st(t,c,i)}function Oh(){return(Fn&6)===0?(Wc(0),!1):!0}function N0(){if(pn!==null){if(Xn===0)var t=pn.return;else t=pn,ya=Ko=null,Xf(t),Ll=null,Nc=0,t=pn;for(;t!==null;)Vp(t.alternate,t),t=t.return;pn=null}}function ql(t,i){var c=t.timeoutHandle;c!==-1&&(t.timeoutHandle=-1,nb(c)),c=t.cancelPendingCommit,c!==null&&(t.cancelPendingCommit=null,c()),Ia=0,N0(),ir=t,pn=c=ma(t.current,null),An=i,Xn=0,ss=null,ao=!1,zl=dt(t,i),v0=!1,Hl=as=T0=il=oo=Rr=0,Gi=Xc=null,C0=!1,(i&8)!==0&&(i|=i&32);var f=t.entangledLanes;if(f!==0)for(t=t.entanglements,f&=i;0<f;){var E=31-At(f),A=1<<E;i|=t[E],f&=~A}return Sa=i,Ju(),c}function ly(t,i){rn=null,le.H=Vc,i===kl||i===ah?(i=vm(),Xn=3):i===kf?(i=vm(),Xn=4):Xn=i===l0?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ss=i,pn===null&&(Rr=1,wh(t,xs(i,t.current)))}function cy(){var t=rs.current;return t===null?!0:(An&4194048)===An?As===null:(An&62914560)===An||(An&536870912)!==0?t===As:!1}function uy(){var t=le.H;return le.H=Vc,t===null?Vc:t}function hy(){var t=le.A;return le.A=kA,t}function Dh(){Rr=4,ao||(An&4194048)!==An&&rs.current!==null||(zl=!0),(oo&134217727)===0&&(il&134217727)===0||ir===null||uo(ir,An,as,!1)}function O0(t,i,c){var f=Fn;Fn|=2;var E=uy(),A=hy();(ir!==t||An!==i)&&(Nh=null,ql(t,i)),i=!1;var O=Rr;e:do try{if(Xn!==0&&pn!==null){var V=pn,Q=ss;switch(Xn){case 8:N0(),O=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(i=!0);var ye=Xn;if(Xn=0,ss=null,Xl(t,V,Q,ye),c&&zl){O=0;break e}break;default:ye=Xn,Xn=0,ss=null,Xl(t,V,Q,ye)}}BA(),O=Rr;break}catch(Re){ly(t,Re)}while(!0);return i&&t.shellSuspendCounter++,ya=Ko=null,Fn=f,le.H=E,le.A=A,pn===null&&(ir=null,An=0,Ju()),O}function BA(){for(;pn!==null;)dy(pn)}function VA(t,i){var c=Fn;Fn|=2;var f=uy(),E=hy();ir!==t||An!==i?(Nh=null,Rh=ht()+500,ql(t,i)):zl=dt(t,i);e:do try{if(Xn!==0&&pn!==null){i=pn;var A=ss;t:switch(Xn){case 1:Xn=0,ss=null,Xl(t,i,A,1);break;case 2:case 9:if(Am(A)){Xn=0,ss=null,fy(i);break}i=function(){Xn!==2&&Xn!==9||ir!==t||(Xn=7),qs(t)},A.then(i,i);break e;case 3:Xn=7;break e;case 4:Xn=5;break e;case 7:Am(A)?(Xn=0,ss=null,fy(i)):(Xn=0,ss=null,Xl(t,i,A,7));break;case 5:var O=null;switch(pn.tag){case 26:O=pn.memoizedState;case 5:case 27:var V=pn;if(O?Jy(O):V.stateNode.complete){Xn=0,ss=null;var Q=V.sibling;if(Q!==null)pn=Q;else{var ye=V.return;ye!==null?(pn=ye,Mh(ye)):pn=null}break t}}Xn=0,ss=null,Xl(t,i,A,5);break;case 6:Xn=0,ss=null,Xl(t,i,A,6);break;case 8:N0(),Rr=6;break e;default:throw Error(o(462))}}UA();break}catch(Re){ly(t,Re)}while(!0);return ya=Ko=null,le.H=f,le.A=E,Fn=c,pn!==null?0:(ir=null,An=0,Ju(),Rr)}function UA(){for(;pn!==null&&!Pt();)dy(pn)}function dy(t){var i=Pp(t.alternate,t,Sa);t.memoizedProps=t.pendingProps,i===null?Mh(t):pn=i}function fy(t){var i=t,c=i.alternate;switch(i.tag){case 15:case 0:i=Np(c,i,i.pendingProps,i.type,void 0,An);break;case 11:i=Np(c,i,i.pendingProps,i.type.render,i.ref,An);break;case 5:Xf(i);default:Vp(c,i),i=pn=hm(i,Sa),i=Pp(c,i,Sa)}t.memoizedProps=t.pendingProps,i===null?Mh(t):pn=i}function Xl(t,i,c,f){ya=Ko=null,Xf(i),Ll=null,Nc=0;var E=i.return;try{if(SA(t,E,i,c,An)){Rr=1,wh(t,xs(c,t.current)),pn=null;return}}catch(A){if(E!==null)throw pn=E,A;Rr=1,wh(t,xs(c,t.current)),pn=null;return}i.flags&32768?(Nn||f===1?t=!0:zl||(An&536870912)!==0?t=!1:(ao=t=!0,(f===2||f===9||f===3||f===6)&&(f=rs.current,f!==null&&f.tag===13&&(f.flags|=16384))),gy(i,t)):Mh(i)}function Mh(t){var i=t;do{if((i.flags&32768)!==0){gy(i,ao);return}t=i.return;var c=NA(i.alternate,i,Sa);if(c!==null){pn=c;return}if(i=i.sibling,i!==null){pn=i;return}pn=i=t}while(i!==null);Rr===0&&(Rr=5)}function gy(t,i){do{var c=OA(t.alternate,t);if(c!==null){c.flags&=32767,pn=c;return}if(c=t.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(t=t.sibling,t!==null)){pn=t;return}pn=t=c}while(t!==null);Rr=6,pn=null}function my(t,i,c,f,E,A,O,V,Q){t.cancelPendingCommit=null;do kh();while(Kr!==0);if((Fn&6)!==0)throw Error(o(327));if(i!==null){if(i===t.current)throw Error(o(177));if(A=i.lanes|i.childLanes,A|=Ef,Xe(t,c,A,O,V,Q),t===ir&&(pn=ir=null,An=0),Gl=i,co=t,Ia=c,S0=A,I0=E,iy=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,HA(lr,function(){return wy(),null})):(t.callbackNode=null,t.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=le.T,le.T=null,E=xe.p,xe.p=2,O=Fn,Fn|=4;try{DA(t,i,c)}finally{Fn=O,xe.p=E,le.T=f}}Kr=1,py(),yy(),xy()}}function py(){if(Kr===1){Kr=0;var t=co,i=Gl,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=le.T,le.T=null;var f=xe.p;xe.p=2;var E=Fn;Fn|=4;try{Qp(i,t);var A=H0,O=k(t.containerInfo),V=A.focusedElem,Q=A.selectionRange;if(O!==V&&V&&V.ownerDocument&&I(V.ownerDocument.documentElement,V)){if(Q!==null&&L(V)){var ye=Q.start,Re=Q.end;if(Re===void 0&&(Re=ye),"selectionStart"in V)V.selectionStart=ye,V.selectionEnd=Math.min(Re,V.value.length);else{var Pe=V.ownerDocument||document,Ee=Pe&&Pe.defaultView||window;if(Ee.getSelection){var be=Ee.getSelection(),vt=V.textContent.length,zt=Math.min(Q.start,vt),$n=Q.end===void 0?zt:Math.min(Q.end,vt);!be.extend&&zt>$n&&(O=$n,$n=zt,zt=O);var ie=v(V,zt),te=v(V,$n);if(ie&&te&&(be.rangeCount!==1||be.anchorNode!==ie.node||be.anchorOffset!==ie.offset||be.focusNode!==te.node||be.focusOffset!==te.offset)){var pe=Pe.createRange();pe.setStart(ie.node,ie.offset),be.removeAllRanges(),zt>$n?(be.addRange(pe),be.extend(te.node,te.offset)):(pe.setEnd(te.node,te.offset),be.addRange(pe))}}}}for(Pe=[],be=V;be=be.parentNode;)be.nodeType===1&&Pe.push({element:be,left:be.scrollLeft,top:be.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<Pe.length;V++){var ke=Pe[V];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}Xh=!!z0,H0=z0=null}finally{Fn=E,xe.p=f,le.T=c}}t.current=i,Kr=2}}function yy(){if(Kr===2){Kr=0;var t=co,i=Gl,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=le.T,le.T=null;var f=xe.p;xe.p=2;var E=Fn;Fn|=4;try{qp(t,i.alternate,i)}finally{Fn=E,xe.p=f,le.T=c}}Kr=3}}function xy(){if(Kr===4||Kr===3){Kr=0,et();var t=co,i=Gl,c=Ia,f=iy;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Kr=5:(Kr=0,Gl=co=null,Ey(t,t.pendingLanes));var E=t.pendingLanes;if(E===0&&(lo=null),Rt(c),i=i.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(tn,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=le.T,E=xe.p,xe.p=2,le.T=null;try{for(var A=t.onRecoverableError,O=0;O<f.length;O++){var V=f[O];A(V.value,{componentStack:V.stack})}}finally{le.T=i,xe.p=E}}(Ia&3)!==0&&kh(),qs(t),E=t.pendingLanes,(c&261930)!==0&&(E&42)!==0?t===R0?Yc++:(Yc=0,R0=t):Yc=0,Wc(0)}}function Ey(t,i){(t.pooledCacheLanes&=i)===0&&(i=t.pooledCache,i!=null&&(t.pooledCache=null,Ic(i)))}function kh(){return py(),yy(),xy(),wy()}function wy(){if(Kr!==5)return!1;var t=co,i=S0;S0=0;var c=Rt(Ia),f=le.T,E=xe.p;try{xe.p=32>c?32:c,le.T=null,c=I0,I0=null;var A=co,O=Ia;if(Kr=0,Gl=co=null,Ia=0,(Fn&6)!==0)throw Error(o(331));var V=Fn;if(Fn|=4,ty(A.current),Jp(A,A.current,O,c),Fn=V,Wc(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(tn,A)}catch{}return!0}finally{xe.p=E,le.T=f,Ey(t,i)}}function _y(t,i,c){i=xs(c,i),i=o0(t.stateNode,i,2),t=no(t,i,2),t!==null&&(je(t,2),qs(t))}function Yn(t,i,c){if(t.tag===3)_y(t,t,c);else for(;i!==null;){if(i.tag===3){_y(i,t,c);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(lo===null||!lo.has(f))){t=xs(c,t),c=Ap(2),f=no(i,c,2),f!==null&&(bp(c,f,i,t),je(f,2),qs(f));break}}i=i.return}}function D0(t,i,c){var f=t.pingCache;if(f===null){f=t.pingCache=new LA;var E=new Set;f.set(i,E)}else E=f.get(i),E===void 0&&(E=new Set,f.set(i,E));E.has(c)||(v0=!0,E.add(c),t=FA.bind(null,t,i,c),i.then(t,t))}function FA(t,i,c){var f=t.pingCache;f!==null&&f.delete(i),t.pingedLanes|=t.suspendedLanes&c,t.warmLanes&=~c,ir===t&&(An&c)===c&&(Rr===4||Rr===3&&(An&62914560)===An&&300>ht()-Ih?(Fn&2)===0&&ql(t,0):T0|=c,Hl===An&&(Hl=0)),qs(t)}function Ay(t,i){i===0&&(i=re()),t=Xo(t,i),t!==null&&(je(t,i),qs(t))}function jA(t){var i=t.memoizedState,c=0;i!==null&&(c=i.retryLane),Ay(t,c)}function zA(t,i){var c=0;switch(t.tag){case 31:case 13:var f=t.stateNode,E=t.memoizedState;E!==null&&(c=E.retryLane);break;case 19:f=t.stateNode;break;case 22:f=t.stateNode._retryCache;break;default:throw Error(o(314))}f!==null&&f.delete(i),Ay(t,c)}function HA(t,i){return it(t,i)}var Lh=null,Yl=null,M0=!1,Ph=!1,k0=!1,ho=0;function qs(t){t!==Yl&&t.next===null&&(Yl===null?Lh=Yl=t:Yl=Yl.next=t),Ph=!0,M0||(M0=!0,qA())}function Wc(t,i){if(!k0&&Ph){k0=!0;do for(var c=!1,f=Lh;f!==null;){if(t!==0){var E=f.pendingLanes;if(E===0)var A=0;else{var O=f.suspendedLanes,V=f.pingedLanes;A=(1<<31-At(42|t)+1)-1,A&=E&~(O&~V),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(c=!0,Cy(f,A))}else A=An,A=Mr(f,f===ir?A:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(A&3)===0||dt(f,A)||(c=!0,Cy(f,A));f=f.next}while(c);k0=!1}}function GA(){by()}function by(){Ph=M0=!1;var t=0;ho!==0&&tb()&&(t=ho);for(var i=ht(),c=null,f=Lh;f!==null;){var E=f.next,A=vy(f,i);A===0?(f.next=null,c===null?Lh=E:c.next=E,E===null&&(Yl=c)):(c=f,(t!==0||(A&3)!==0)&&(Ph=!0)),f=E}Kr!==0&&Kr!==5||Wc(t),ho!==0&&(ho=0)}function vy(t,i){for(var c=t.suspendedLanes,f=t.pingedLanes,E=t.expirationTimes,A=t.pendingLanes&-62914561;0<A;){var O=31-At(A),V=1<<O,Q=E[O];Q===-1?((V&c)===0||(V&f)!==0)&&(E[O]=nn(V,i)):Q<=i&&(t.expiredLanes|=V),A&=~V}if(i=ir,c=An,c=Mr(t,t===i?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),f=t.callbackNode,c===0||t===i&&(Xn===2||Xn===9)||t.cancelPendingCommit!==null)return f!==null&&f!==null&&Ie(f),t.callbackNode=null,t.callbackPriority=0;if((c&3)===0||dt(t,c)){if(i=c&-c,i===t.callbackPriority)return i;switch(f!==null&&Ie(f),Rt(c)){case 2:case 8:c=Kn;break;case 32:c=lr;break;case 268435456:c=Zr;break;default:c=lr}return f=Ty.bind(null,t),c=it(c,f),t.callbackPriority=i,t.callbackNode=c,i}return f!==null&&f!==null&&Ie(f),t.callbackPriority=2,t.callbackNode=null,2}function Ty(t,i){if(Kr!==0&&Kr!==5)return t.callbackNode=null,t.callbackPriority=0,null;var c=t.callbackNode;if(kh()&&t.callbackNode!==c)return null;var f=An;return f=Mr(t,t===ir?f:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),f===0?null:(ay(t,f,i),vy(t,ht()),t.callbackNode!=null&&t.callbackNode===c?Ty.bind(null,t):null)}function Cy(t,i){if(kh())return null;ay(t,i,!0)}function qA(){rb(function(){(Fn&6)!==0?it(Bt,GA):by()})}function L0(){if(ho===0){var t=Dl;t===0&&(t=Tr,Tr<<=1,(Tr&261888)===0&&(Tr=256)),ho=t}return ho}function Sy(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Vs(""+t)}function Iy(t,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,t.id&&c.setAttribute("form",t.id),i.parentNode.insertBefore(c,i),t=new FormData(t),c.parentNode.removeChild(c),t}function XA(t,i,c,f,E){if(i==="submit"&&c&&c.stateNode===E){var A=Sy((E[Mt]||null).action),O=f.submitter;O&&(i=(i=O[Mt]||null)?Sy(i.formAction):O.getAttribute("formAction"),i!==null&&(A=i,O=null));var V=new ur("action","action",null,f,E);t.push({event:V,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ho!==0){var Q=O?Iy(E,O):new FormData(E);t0(c,{pending:!0,data:Q,method:E.method,action:A},null,Q)}}else typeof A=="function"&&(V.preventDefault(),Q=O?Iy(E,O):new FormData(E),t0(c,{pending:!0,data:Q,method:E.method,action:A},A,Q))},currentTarget:E}]})}}for(var P0=0;P0<Tc.length;P0++){var B0=Tc[P0],YA=B0.toLowerCase(),WA=B0[0].toUpperCase()+B0.slice(1);Rs(YA,"on"+WA)}Rs(Fi,"onAnimationEnd"),Rs(ii,"onAnimationIteration"),Rs(Gn,"onAnimationStart"),Rs("dblclick","onDoubleClick"),Rs("focusin","onFocus"),Rs("focusout","onBlur"),Rs(Wr,"onTransitionRun"),Rs(Ni,"onTransitionStart"),Rs(Ka,"onTransitionCancel"),Rs(ga,"onTransitionEnd"),Je("onMouseEnter",["mouseout","mouseover"]),Je("onMouseLeave",["mouseout","mouseover"]),Je("onPointerEnter",["pointerout","pointerover"]),Je("onPointerLeave",["pointerout","pointerover"]),Te("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Te("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Te("onBeforeInput",["compositionend","keypress","textInput","paste"]),Te("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kc));function Ry(t,i){i=(i&4)!==0;for(var c=0;c<t.length;c++){var f=t[c],E=f.event;f=f.listeners;e:{var A=void 0;if(i)for(var O=f.length-1;0<=O;O--){var V=f[O],Q=V.instance,ye=V.currentTarget;if(V=V.listener,Q!==A&&E.isPropagationStopped())break e;A=V,E.currentTarget=ye;try{A(E)}catch(Re){Zu(Re)}E.currentTarget=null,A=Q}else for(O=0;O<f.length;O++){if(V=f[O],Q=V.instance,ye=V.currentTarget,V=V.listener,Q!==A&&E.isPropagationStopped())break e;A=V,E.currentTarget=ye;try{A(E)}catch(Re){Zu(Re)}E.currentTarget=null,A=Q}}}}function yn(t,i){var c=i[fi];c===void 0&&(c=i[fi]=new Set);var f=t+"__bubble";c.has(f)||(Ny(i,t,2,!1),c.add(f))}function V0(t,i,c){var f=0;i&&(f|=4),Ny(c,t,f,i)}var Bh="_reactListening"+Math.random().toString(36).slice(2);function U0(t){if(!t[Bh]){t[Bh]=!0,Be.forEach(function(c){c!=="selectionchange"&&(KA.has(c)||V0(c,!1,t),V0(c,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Bh]||(i[Bh]=!0,V0("selectionchange",!1,i))}}function Ny(t,i,c,f){switch(s2(i)){case 2:var E=bb;break;case 8:E=vb;break;default:E=e1}c=E.bind(null,i,c,t),E=void 0,!sa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(E=!0),f?E!==void 0?t.addEventListener(i,c,{capture:!0,passive:E}):t.addEventListener(i,c,!0):E!==void 0?t.addEventListener(i,c,{passive:E}):t.addEventListener(i,c,!1)}function F0(t,i,c,f,E){var A=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var O=f.tag;if(O===3||O===4){var V=f.stateNode.containerInfo;if(V===E)break;if(O===4)for(O=f.return;O!==null;){var Q=O.tag;if((Q===3||Q===4)&&O.stateNode.containerInfo===E)return;O=O.return}for(;V!==null;){if(O=Qn(V),O===null)return;if(Q=O.tag,Q===5||Q===6||Q===26||Q===27){f=A=O;continue e}V=V.parentNode}}f=f.return}Us(function(){var ye=A,Re=Bi(c),Pe=[];e:{var Ee=Qu.get(t);if(Ee!==void 0){var be=ur,vt=t;switch(t){case"keypress":if(Ji(c)===0)break e;case"keydown":case"keyup":be=ua;break;case"focusin":vt="focus",be=la;break;case"focusout":vt="blur",be=la;break;case"beforeblur":case"afterblur":be=la;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":be=Dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":be=oa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":be=S;break;case Fi:case ii:case Gn:be=Jt;break;case ga:be=j;break;case"scroll":case"scrollend":be=Ga;break;case"wheel":be=Ae;break;case"copy":case"cut":case"paste":be=ca;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":be=mn;break;case"toggle":case"beforetoggle":be=Yt}var zt=(i&4)!==0,$n=!zt&&(t==="scroll"||t==="scrollend"),ie=zt?Ee!==null?Ee+"Capture":null:Ee;zt=[];for(var te=ye,pe;te!==null;){var ke=te;if(pe=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||pe===null||ie===null||(ke=Ft(te,ie),ke!=null&&zt.push(Qc(te,ke,pe))),$n)break;te=te.return}0<zt.length&&(Ee=new be(Ee,vt,null,c,Re),Pe.push({event:Ee,listeners:zt}))}}if((i&7)===0){e:{if(Ee=t==="mouseover"||t==="pointerover",be=t==="mouseout"||t==="pointerout",Ee&&c!==ia&&(vt=c.relatedTarget||c.fromElement)&&(Qn(vt)||vt[er]))break e;if((be||Ee)&&(Ee=Re.window===Re?Re:(Ee=Re.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,be?(vt=c.relatedTarget||c.toElement,be=ye,vt=vt?Qn(vt):null,vt!==null&&($n=g(vt),zt=vt.tag,vt!==$n||zt!==5&&zt!==27&&zt!==6)&&(vt=null)):(be=null,vt=ye),be!==vt)){if(zt=Dn,ke="onMouseLeave",ie="onMouseEnter",te="mouse",(t==="pointerout"||t==="pointerover")&&(zt=mn,ke="onPointerLeave",ie="onPointerEnter",te="pointer"),$n=be==null?Ee:Jr(be),pe=vt==null?Ee:Jr(vt),Ee=new zt(ke,te+"leave",be,c,Re),Ee.target=$n,Ee.relatedTarget=pe,ke=null,Qn(Re)===ye&&(zt=new zt(ie,te+"enter",vt,c,Re),zt.target=pe,zt.relatedTarget=$n,ke=zt),$n=ke,be&&vt)t:{for(zt=QA,ie=be,te=vt,pe=0,ke=ie;ke;ke=zt(ke))pe++;ke=0;for(var kt=te;kt;kt=zt(kt))ke++;for(;0<pe-ke;)ie=zt(ie),pe--;for(;0<ke-pe;)te=zt(te),ke--;for(;pe--;){if(ie===te||te!==null&&ie===te.alternate){zt=ie;break t}ie=zt(ie),te=zt(te)}zt=null}else zt=null;be!==null&&Oy(Pe,Ee,be,zt,!1),vt!==null&&$n!==null&&Oy(Pe,$n,vt,zt,!0)}}e:{if(Ee=ye?Jr(ye):window,be=Ee.nodeName&&Ee.nodeName.toLowerCase(),be==="select"||be==="input"&&Ee.type==="file")var Pn=ts;else if(vc(Ee))if(Ku)Pn=u;else{Pn=a;var Tt=r}else be=Ee.nodeName,!be||be.toLowerCase()!=="input"||Ee.type!=="checkbox"&&Ee.type!=="radio"?ye&&zn(ye.elementType)&&(Pn=ts):Pn=l;if(Pn&&(Pn=Pn(t,ye))){es(Pe,Pn,c,Re);break e}Tt&&Tt(t,Ee,ye),t==="focusout"&&ye&&Ee.type==="number"&&ye.memoizedProps.value!=null&&H(Ee,"number",Ee.value)}switch(Tt=ye?Jr(ye):window,t){case"focusin":(vc(Tt)||Tt.contentEditable==="true")&&(Z=Tt,$=ye,ue=null);break;case"focusout":ue=$=Z=null;break;case"mousedown":_e=!0;break;case"contextmenu":case"mouseup":case"dragend":_e=!1,Ze(Pe,c,Re);break;case"selectionchange":if(q)break;case"keydown":case"keyup":Ze(Pe,c,Re)}var ln;if(Rn)e:{switch(t){case"compositionstart":var bn="onCompositionStart";break e;case"compositionend":bn="onCompositionEnd";break e;case"compositionupdate":bn="onCompositionUpdate";break e}bn=void 0}else Wa?ha(t,c)&&(bn="onCompositionEnd"):t==="keydown"&&c.keyCode===229&&(bn="onCompositionStart");bn&&(ms&&c.locale!=="ko"&&(Wa||bn!=="onCompositionStart"?bn==="onCompositionEnd"&&Wa&&(ln=Cs()):(Qi=Re,Zi="value"in Qi?Qi.value:Qi.textContent,Wa=!0)),Tt=Vh(ye,bn),0<Tt.length&&(bn=new ds(bn,t,null,c,Re),Pe.push({event:bn,listeners:Tt}),ln?bn.data=ln:(ln=ps(c),ln!==null&&(bn.data=ln)))),(ln=Ii?js(t,c):Tl(t,c))&&(bn=Vh(ye,"onBeforeInput"),0<bn.length&&(Tt=new ds("onBeforeInput","beforeinput",null,c,Re),Pe.push({event:Tt,listeners:bn}),Tt.data=ln)),XA(Pe,t,ye,c,Re)}Ry(Pe,i)})}function Qc(t,i,c){return{instance:t,listener:i,currentTarget:c}}function Vh(t,i){for(var c=i+"Capture",f=[];t!==null;){var E=t,A=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||A===null||(E=Ft(t,c),E!=null&&f.unshift(Qc(t,E,A)),E=Ft(t,i),E!=null&&f.push(Qc(t,E,A))),t.tag===3)return f;t=t.return}return[]}function QA(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Oy(t,i,c,f,E){for(var A=i._reactName,O=[];c!==null&&c!==f;){var V=c,Q=V.alternate,ye=V.stateNode;if(V=V.tag,Q!==null&&Q===f)break;V!==5&&V!==26&&V!==27||ye===null||(Q=ye,E?(ye=Ft(c,A),ye!=null&&O.unshift(Qc(c,ye,Q))):E||(ye=Ft(c,A),ye!=null&&O.push(Qc(c,ye,Q)))),c=c.return}O.length!==0&&t.push({event:i,listeners:O})}var ZA=/\r\n?/g,JA=/\u0000|\uFFFD/g;function Dy(t){return(typeof t=="string"?t:""+t).replace(ZA,`
`).replace(JA,"")}function My(t,i){return i=Dy(i),Dy(t)===i}function Jn(t,i,c,f,E,A){switch(c){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||mi(t,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&mi(t,""+f);break;case"className":dn(t,"class",f);break;case"tabIndex":dn(t,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":dn(t,c,f);break;case"style":St(t,f,A);break;case"data":if(i!=="object"){dn(t,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||c!=="href")){t.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){t.removeAttribute(c);break}f=Vs(""+f),t.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){t.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(c==="formAction"?(i!=="input"&&Jn(t,i,"name",E.name,E,null),Jn(t,i,"formEncType",E.formEncType,E,null),Jn(t,i,"formMethod",E.formMethod,E,null),Jn(t,i,"formTarget",E.formTarget,E,null)):(Jn(t,i,"encType",E.encType,E,null),Jn(t,i,"method",E.method,E,null),Jn(t,i,"target",E.target,E,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){t.removeAttribute(c);break}f=Vs(""+f),t.setAttribute(c,f);break;case"onClick":f!=null&&(t.onclick=pi);break;case"onScroll":f!=null&&yn("scroll",t);break;case"onScrollEnd":f!=null&&yn("scrollend",t);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(o(61));if(c=f.__html,c!=null){if(E.children!=null)throw Error(o(60));t.innerHTML=c}}break;case"multiple":t.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":t.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){t.removeAttribute("xlink:href");break}c=Vs(""+f),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?t.setAttribute(c,""+f):t.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?t.setAttribute(c,""):t.removeAttribute(c);break;case"capture":case"download":f===!0?t.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?t.setAttribute(c,f):t.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?t.setAttribute(c,f):t.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?t.removeAttribute(c):t.setAttribute(c,f);break;case"popover":yn("beforetoggle",t),yn("toggle",t),hn(t,"popover",f);break;case"xlinkActuate":In(t,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":In(t,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":In(t,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":In(t,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":In(t,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":In(t,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":In(t,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":In(t,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":In(t,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":hn(t,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Fo.get(c)||c,hn(t,c,f))}}function j0(t,i,c,f,E,A){switch(c){case"style":St(t,f,A);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(o(61));if(c=f.__html,c!=null){if(E.children!=null)throw Error(o(60));t.innerHTML=c}}break;case"children":typeof f=="string"?mi(t,f):(typeof f=="number"||typeof f=="bigint")&&mi(t,""+f);break;case"onScroll":f!=null&&yn("scroll",t);break;case"onScrollEnd":f!=null&&yn("scrollend",t);break;case"onClick":f!=null&&(t.onclick=pi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!W.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(E=c.endsWith("Capture"),i=c.slice(2,E?c.length-7:void 0),A=t[Mt]||null,A=A!=null?A[c]:null,typeof A=="function"&&t.removeEventListener(i,A,E),typeof f=="function")){typeof A!="function"&&A!==null&&(c in t?t[c]=null:t.hasAttribute(c)&&t.removeAttribute(c)),t.addEventListener(i,f,E);break e}c in t?t[c]=f:f===!0?t.setAttribute(c,""):hn(t,c,f)}}}function li(t,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yn("error",t),yn("load",t);var f=!1,E=!1,A;for(A in c)if(c.hasOwnProperty(A)){var O=c[A];if(O!=null)switch(A){case"src":f=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:Jn(t,i,A,O,c,null)}}E&&Jn(t,i,"srcSet",c.srcSet,c,null),f&&Jn(t,i,"src",c.src,c,null);return;case"input":yn("invalid",t);var V=A=O=E=null,Q=null,ye=null;for(f in c)if(c.hasOwnProperty(f)){var Re=c[f];if(Re!=null)switch(f){case"name":E=Re;break;case"type":O=Re;break;case"checked":Q=Re;break;case"defaultChecked":ye=Re;break;case"value":A=Re;break;case"defaultValue":V=Re;break;case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(o(137,i));break;default:Jn(t,i,f,Re,c,null)}}de(t,A,V,Q,ye,O,E,!1);return;case"select":yn("invalid",t),f=O=A=null;for(E in c)if(c.hasOwnProperty(E)&&(V=c[E],V!=null))switch(E){case"value":A=V;break;case"defaultValue":O=V;break;case"multiple":f=V;default:Jn(t,i,E,V,c,null)}i=A,c=O,t.multiple=!!f,i!=null?bt(t,!!f,i,!1):c!=null&&bt(t,!!f,c,!0);return;case"textarea":yn("invalid",t),A=E=f=null;for(O in c)if(c.hasOwnProperty(O)&&(V=c[O],V!=null))switch(O){case"value":f=V;break;case"defaultValue":E=V;break;case"children":A=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(o(91));break;default:Jn(t,i,O,V,c,null)}Lr(t,f,E,A);return;case"option":for(Q in c)if(c.hasOwnProperty(Q)&&(f=c[Q],f!=null))switch(Q){case"selected":t.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Jn(t,i,Q,f,c,null)}return;case"dialog":yn("beforetoggle",t),yn("toggle",t),yn("cancel",t),yn("close",t);break;case"iframe":case"object":yn("load",t);break;case"video":case"audio":for(f=0;f<Kc.length;f++)yn(Kc[f],t);break;case"image":yn("error",t),yn("load",t);break;case"details":yn("toggle",t);break;case"embed":case"source":case"link":yn("error",t),yn("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ye in c)if(c.hasOwnProperty(ye)&&(f=c[ye],f!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,i));default:Jn(t,i,ye,f,c,null)}return;default:if(zn(i)){for(Re in c)c.hasOwnProperty(Re)&&(f=c[Re],f!==void 0&&j0(t,i,Re,f,c,void 0));return}}for(V in c)c.hasOwnProperty(V)&&(f=c[V],f!=null&&Jn(t,i,V,f,c,null))}function $A(t,i,c,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,A=null,O=null,V=null,Q=null,ye=null,Re=null;for(be in c){var Pe=c[be];if(c.hasOwnProperty(be)&&Pe!=null)switch(be){case"checked":break;case"value":break;case"defaultValue":Q=Pe;default:f.hasOwnProperty(be)||Jn(t,i,be,null,f,Pe)}}for(var Ee in f){var be=f[Ee];if(Pe=c[Ee],f.hasOwnProperty(Ee)&&(be!=null||Pe!=null))switch(Ee){case"type":A=be;break;case"name":E=be;break;case"checked":ye=be;break;case"defaultChecked":Re=be;break;case"value":O=be;break;case"defaultValue":V=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(o(137,i));break;default:be!==Pe&&Jn(t,i,Ee,be,f,Pe)}}Er(t,O,V,Q,ye,Re,A,E);return;case"select":be=O=V=Ee=null;for(A in c)if(Q=c[A],c.hasOwnProperty(A)&&Q!=null)switch(A){case"value":break;case"multiple":be=Q;default:f.hasOwnProperty(A)||Jn(t,i,A,null,f,Q)}for(E in f)if(A=f[E],Q=c[E],f.hasOwnProperty(E)&&(A!=null||Q!=null))switch(E){case"value":Ee=A;break;case"defaultValue":V=A;break;case"multiple":O=A;default:A!==Q&&Jn(t,i,E,A,f,Q)}i=V,c=O,f=be,Ee!=null?bt(t,!!c,Ee,!1):!!f!=!!c&&(i!=null?bt(t,!!c,i,!0):bt(t,!!c,c?[]:"",!1));return;case"textarea":be=Ee=null;for(V in c)if(E=c[V],c.hasOwnProperty(V)&&E!=null&&!f.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:Jn(t,i,V,null,f,E)}for(O in f)if(E=f[O],A=c[O],f.hasOwnProperty(O)&&(E!=null||A!=null))switch(O){case"value":Ee=E;break;case"defaultValue":be=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(o(91));break;default:E!==A&&Jn(t,i,O,E,f,A)}wr(t,Ee,be);return;case"option":for(var vt in c)if(Ee=c[vt],c.hasOwnProperty(vt)&&Ee!=null&&!f.hasOwnProperty(vt))switch(vt){case"selected":t.selected=!1;break;default:Jn(t,i,vt,null,f,Ee)}for(Q in f)if(Ee=f[Q],be=c[Q],f.hasOwnProperty(Q)&&Ee!==be&&(Ee!=null||be!=null))switch(Q){case"selected":t.selected=Ee&&typeof Ee!="function"&&typeof Ee!="symbol";break;default:Jn(t,i,Q,Ee,f,be)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var zt in c)Ee=c[zt],c.hasOwnProperty(zt)&&Ee!=null&&!f.hasOwnProperty(zt)&&Jn(t,i,zt,null,f,Ee);for(ye in f)if(Ee=f[ye],be=c[ye],f.hasOwnProperty(ye)&&Ee!==be&&(Ee!=null||be!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(o(137,i));break;default:Jn(t,i,ye,Ee,f,be)}return;default:if(zn(i)){for(var $n in c)Ee=c[$n],c.hasOwnProperty($n)&&Ee!==void 0&&!f.hasOwnProperty($n)&&j0(t,i,$n,void 0,f,Ee);for(Re in f)Ee=f[Re],be=c[Re],!f.hasOwnProperty(Re)||Ee===be||Ee===void 0&&be===void 0||j0(t,i,Re,Ee,f,be);return}}for(var ie in c)Ee=c[ie],c.hasOwnProperty(ie)&&Ee!=null&&!f.hasOwnProperty(ie)&&Jn(t,i,ie,null,f,Ee);for(Pe in f)Ee=f[Pe],be=c[Pe],!f.hasOwnProperty(Pe)||Ee===be||Ee==null&&be==null||Jn(t,i,Pe,Ee,f,be)}function ky(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function eb(){if(typeof performance.getEntriesByType=="function"){for(var t=0,i=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var E=c[f],A=E.transferSize,O=E.initiatorType,V=E.duration;if(A&&V&&ky(O)){for(O=0,V=E.responseEnd,f+=1;f<c.length;f++){var Q=c[f],ye=Q.startTime;if(ye>V)break;var Re=Q.transferSize,Pe=Q.initiatorType;Re&&ky(Pe)&&(Q=Q.responseEnd,O+=Re*(Q<V?1:(V-ye)/(Q-ye)))}if(--f,i+=8*(A+O)/(E.duration/1e3),t++,10<t)break}}if(0<t)return i/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var z0=null,H0=null;function Uh(t){return t.nodeType===9?t:t.ownerDocument}function Ly(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Py(t,i){if(t===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&i==="foreignObject"?0:t}function G0(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var q0=null;function tb(){var t=window.event;return t&&t.type==="popstate"?t===q0?!1:(q0=t,!0):(q0=null,!1)}var By=typeof setTimeout=="function"?setTimeout:void 0,nb=typeof clearTimeout=="function"?clearTimeout:void 0,Vy=typeof Promise=="function"?Promise:void 0,rb=typeof queueMicrotask=="function"?queueMicrotask:typeof Vy<"u"?function(t){return Vy.resolve(null).then(t).catch(ib)}:By;function ib(t){setTimeout(function(){throw t})}function fo(t){return t==="head"}function Uy(t,i){var c=i,f=0;do{var E=c.nextSibling;if(t.removeChild(c),E&&E.nodeType===8)if(c=E.data,c==="/$"||c==="/&"){if(f===0){t.removeChild(E),Zl(i);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Zc(t.ownerDocument.documentElement);else if(c==="head"){c=t.ownerDocument.head,Zc(c);for(var A=c.firstChild;A;){var O=A.nextSibling,V=A.nodeName;A[Li]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&A.rel.toLowerCase()==="stylesheet"||c.removeChild(A),A=O}}else c==="body"&&Zc(t.ownerDocument.body);c=E}while(c);Zl(i)}function Fy(t,i){var c=t;t=0;do{var f=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(t===0)break;t--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||t++;c=f}while(c)}function X0(t){var i=t.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":X0(c),Yr(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}t.removeChild(c)}}function sb(t,i,c,f){for(;t.nodeType===1;){var E=c;if(t.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(f){if(!t[Li])switch(i){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(A=t.getAttribute("rel"),A==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(A!==E.rel||t.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||t.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||t.getAttribute("title")!==(E.title==null?null:E.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(A=t.getAttribute("src"),(A!==(E.src==null?null:E.src)||t.getAttribute("type")!==(E.type==null?null:E.type)||t.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&A&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(i==="input"&&t.type==="hidden"){var A=E.name==null?null:""+E.name;if(E.type==="hidden"&&t.getAttribute("name")===A)return t}else return t;if(t=bs(t.nextSibling),t===null)break}return null}function ab(t,i,c){if(i==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!c||(t=bs(t.nextSibling),t===null))return null;return t}function jy(t,i){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=bs(t.nextSibling),t===null))return null;return t}function Y0(t){return t.data==="$?"||t.data==="$~"}function W0(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function ob(t,i){var c=t.ownerDocument;if(t.data==="$~")t._reactRetry=i;else if(t.data!=="$?"||c.readyState!=="loading")i();else{var f=function(){i(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),t._reactRetry=f}}function bs(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return t}var K0=null;function zy(t){t=t.nextSibling;for(var i=0;t;){if(t.nodeType===8){var c=t.data;if(c==="/$"||c==="/&"){if(i===0)return bs(t.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}t=t.nextSibling}return null}function Hy(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var c=t.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return t;i--}else c!=="/$"&&c!=="/&"||i++}t=t.previousSibling}return null}function Gy(t,i,c){switch(i=Uh(c),t){case"html":if(t=i.documentElement,!t)throw Error(o(452));return t;case"head":if(t=i.head,!t)throw Error(o(453));return t;case"body":if(t=i.body,!t)throw Error(o(454));return t;default:throw Error(o(451))}}function Zc(t){for(var i=t.attributes;i.length;)t.removeAttributeNode(i[0]);Yr(t)}var vs=new Map,qy=new Set;function Fh(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Ra=xe.d;xe.d={f:lb,r:cb,D:ub,C:hb,L:db,m:fb,X:mb,S:gb,M:pb};function lb(){var t=Ra.f(),i=Oh();return t||i}function cb(t){var i=un(t);i!==null&&i.tag===5&&i.type==="form"?lp(i):Ra.r(t)}var Wl=typeof document>"u"?null:document;function Xy(t,i,c){var f=Wl;if(f&&typeof i=="string"&&i){var E=on(i);E='link[rel="'+t+'"][href="'+E+'"]',typeof c=="string"&&(E+='[crossorigin="'+c+'"]'),qy.has(E)||(qy.add(E),t={rel:t,crossOrigin:c,href:i},f.querySelector(E)===null&&(i=f.createElement("link"),li(i,"link",t),ar(i),f.head.appendChild(i)))}}function ub(t){Ra.D(t),Xy("dns-prefetch",t,null)}function hb(t,i){Ra.C(t,i),Xy("preconnect",t,i)}function db(t,i,c){Ra.L(t,i,c);var f=Wl;if(f&&t&&i){var E='link[rel="preload"][as="'+on(i)+'"]';i==="image"&&c&&c.imageSrcSet?(E+='[imagesrcset="'+on(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(E+='[imagesizes="'+on(c.imageSizes)+'"]')):E+='[href="'+on(t)+'"]';var A=E;switch(i){case"style":A=Kl(t);break;case"script":A=Ql(t)}vs.has(A)||(t=N({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:t,as:i},c),vs.set(A,t),f.querySelector(E)!==null||i==="style"&&f.querySelector(Jc(A))||i==="script"&&f.querySelector($c(A))||(i=f.createElement("link"),li(i,"link",t),ar(i),f.head.appendChild(i)))}}function fb(t,i){Ra.m(t,i);var c=Wl;if(c&&t){var f=i&&typeof i.as=="string"?i.as:"script",E='link[rel="modulepreload"][as="'+on(f)+'"][href="'+on(t)+'"]',A=E;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Ql(t)}if(!vs.has(A)&&(t=N({rel:"modulepreload",href:t},i),vs.set(A,t),c.querySelector(E)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector($c(A)))return}f=c.createElement("link"),li(f,"link",t),ar(f),c.head.appendChild(f)}}}function gb(t,i,c){Ra.S(t,i,c);var f=Wl;if(f&&t){var E=kr(f).hoistableStyles,A=Kl(t);i=i||"default";var O=E.get(A);if(!O){var V={loading:0,preload:null};if(O=f.querySelector(Jc(A)))V.loading=5;else{t=N({rel:"stylesheet",href:t,"data-precedence":i},c),(c=vs.get(A))&&Q0(t,c);var Q=O=f.createElement("link");ar(Q),li(Q,"link",t),Q._p=new Promise(function(ye,Re){Q.onload=ye,Q.onerror=Re}),Q.addEventListener("load",function(){V.loading|=1}),Q.addEventListener("error",function(){V.loading|=2}),V.loading|=4,jh(O,i,f)}O={type:"stylesheet",instance:O,count:1,state:V},E.set(A,O)}}}function mb(t,i){Ra.X(t,i);var c=Wl;if(c&&t){var f=kr(c).hoistableScripts,E=Ql(t),A=f.get(E);A||(A=c.querySelector($c(E)),A||(t=N({src:t,async:!0},i),(i=vs.get(E))&&Z0(t,i),A=c.createElement("script"),ar(A),li(A,"link",t),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(E,A))}}function pb(t,i){Ra.M(t,i);var c=Wl;if(c&&t){var f=kr(c).hoistableScripts,E=Ql(t),A=f.get(E);A||(A=c.querySelector($c(E)),A||(t=N({src:t,async:!0,type:"module"},i),(i=vs.get(E))&&Z0(t,i),A=c.createElement("script"),ar(A),li(A,"link",t),c.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},f.set(E,A))}}function Yy(t,i,c,f){var E=(E=me.current)?Fh(E):null;if(!E)throw Error(o(446));switch(t){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Kl(c.href),c=kr(E).hoistableStyles,f=c.get(i),f||(f={type:"style",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){t=Kl(c.href);var A=kr(E).hoistableStyles,O=A.get(t);if(O||(E=E.ownerDocument||E,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(t,O),(A=E.querySelector(Jc(t)))&&!A._p&&(O.instance=A,O.state.loading=5),vs.has(t)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},vs.set(t,c),A||yb(E,t,c,O.state))),i&&f===null)throw Error(o(528,""));return O}if(i&&f!==null)throw Error(o(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Ql(c),c=kr(E).hoistableScripts,f=c.get(i),f||(f={type:"script",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,t))}}function Kl(t){return'href="'+on(t)+'"'}function Jc(t){return'link[rel="stylesheet"]['+t+"]"}function Wy(t){return N({},t,{"data-precedence":t.precedence,precedence:null})}function yb(t,i,c,f){t.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=t.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),li(i,"link",c),ar(i),t.head.appendChild(i))}function Ql(t){return'[src="'+on(t)+'"]'}function $c(t){return"script[async]"+t}function Ky(t,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var f=t.querySelector('style[data-href~="'+on(c.href)+'"]');if(f)return i.instance=f,ar(f),f;var E=N({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(t.ownerDocument||t).createElement("style"),ar(f),li(f,"style",E),jh(f,c.precedence,t),i.instance=f;case"stylesheet":E=Kl(c.href);var A=t.querySelector(Jc(E));if(A)return i.state.loading|=4,i.instance=A,ar(A),A;f=Wy(c),(E=vs.get(E))&&Q0(f,E),A=(t.ownerDocument||t).createElement("link"),ar(A);var O=A;return O._p=new Promise(function(V,Q){O.onload=V,O.onerror=Q}),li(A,"link",f),i.state.loading|=4,jh(A,c.precedence,t),i.instance=A;case"script":return A=Ql(c.src),(E=t.querySelector($c(A)))?(i.instance=E,ar(E),E):(f=c,(E=vs.get(A))&&(f=N({},c),Z0(f,E)),t=t.ownerDocument||t,E=t.createElement("script"),ar(E),li(E,"link",f),t.head.appendChild(E),i.instance=E);case"void":return null;default:throw Error(o(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,jh(f,c.precedence,t));return i.instance}function jh(t,i,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=f.length?f[f.length-1]:null,A=E,O=0;O<f.length;O++){var V=f[O];if(V.dataset.precedence===i)A=V;else if(A!==E)break}A?A.parentNode.insertBefore(t,A.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(t,i.firstChild))}function Q0(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.title==null&&(t.title=i.title)}function Z0(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.integrity==null&&(t.integrity=i.integrity)}var zh=null;function Qy(t,i,c){if(zh===null){var f=new Map,E=zh=new Map;E.set(c,f)}else E=zh,f=E.get(c),f||(f=new Map,E.set(c,f));if(f.has(t))return f;for(f.set(t,null),c=c.getElementsByTagName(t),E=0;E<c.length;E++){var A=c[E];if(!(A[Li]||A[yt]||t==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var O=A.getAttribute(i)||"";O=t+O;var V=f.get(O);V?V.push(A):f.set(O,[A])}}return f}function Zy(t,i,c){t=t.ownerDocument||t,t.head.insertBefore(c,i==="title"?t.querySelector("head > title"):null)}function xb(t,i,c){if(c===1||i.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return t=i.disabled,typeof i.precedence=="string"&&t==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Jy(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Eb(t,i,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var E=Kl(f.href),A=i.querySelector(Jc(E));if(A){i=A._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(t.count++,t=Hh.bind(t),i.then(t,t)),c.state.loading|=4,c.instance=A,ar(A);return}A=i.ownerDocument||i,f=Wy(f),(E=vs.get(E))&&Q0(f,E),A=A.createElement("link"),ar(A);var O=A;O._p=new Promise(function(V,Q){O.onload=V,O.onerror=Q}),li(A,"link",f),c.instance=A}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(t.count++,c=Hh.bind(t),i.addEventListener("load",c),i.addEventListener("error",c))}}var J0=0;function wb(t,i){return t.stylesheets&&t.count===0&&qh(t,t.stylesheets),0<t.count||0<t.imgCount?function(c){var f=setTimeout(function(){if(t.stylesheets&&qh(t,t.stylesheets),t.unsuspend){var A=t.unsuspend;t.unsuspend=null,A()}},6e4+i);0<t.imgBytes&&J0===0&&(J0=62500*eb());var E=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&qh(t,t.stylesheets),t.unsuspend)){var A=t.unsuspend;t.unsuspend=null,A()}},(t.imgBytes>J0?50:800)+i);return t.unsuspend=c,function(){t.unsuspend=null,clearTimeout(f),clearTimeout(E)}}:null}function Hh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qh(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Gh=null;function qh(t,i){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Gh=new Map,i.forEach(_b,t),Gh=null,Hh.call(t))}function _b(t,i){if(!(i.state.loading&4)){var c=Gh.get(t);if(c)var f=c.get(null);else{c=new Map,Gh.set(t,c);for(var E=t.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<E.length;A++){var O=E[A];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(c.set(O.dataset.precedence,O),f=O)}f&&c.set(null,f)}E=i.instance,O=E.getAttribute("data-precedence"),A=c.get(O)||f,A===f&&c.set(null,E),c.set(O,E),this.count++,f=Hh.bind(this),E.addEventListener("load",f),E.addEventListener("error",f),A?A.parentNode.insertBefore(E,A.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(E,t.firstChild)),i.state.loading|=4}}var eu={$$typeof:fe,Provider:null,Consumer:null,_currentValue:We,_currentValue2:We,_threadCount:0};function Ab(t,i,c,f,E,A,O,V,Q){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Se(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Se(0),this.hiddenUpdates=Se(null),this.identifierPrefix=f,this.onUncaughtError=E,this.onCaughtError=A,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function $y(t,i,c,f,E,A,O,V,Q,ye,Re,Pe){return t=new Ab(t,i,c,O,Q,ye,Re,Pe,V),i=1,A===!0&&(i|=24),A=ns(3,null,null,i),t.current=A,A.stateNode=t,i=Of(),i.refCount++,t.pooledCache=i,i.refCount++,A.memoizedState={element:f,isDehydrated:c,cache:i},Lf(A),t}function e2(t){return t?(t=Sl,t):Sl}function t2(t,i,c,f,E,A){E=e2(E),f.context===null?f.context=E:f.pendingContext=E,f=to(i),f.payload={element:c},A=A===void 0?null:A,A!==null&&(f.callback=A),c=no(t,f,i),c!==null&&(qi(c,t,i),Dc(c,t,i))}function n2(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var c=t.retryLane;t.retryLane=c!==0&&c<i?c:i}}function $0(t,i){n2(t,i),(t=t.alternate)&&n2(t,i)}function r2(t){if(t.tag===13||t.tag===31){var i=Xo(t,67108864);i!==null&&qi(i,t,67108864),$0(t,67108864)}}function i2(t){if(t.tag===13||t.tag===31){var i=os();i=Gt(i);var c=Xo(t,i);c!==null&&qi(c,t,i),$0(t,i)}}var Xh=!0;function bb(t,i,c,f){var E=le.T;le.T=null;var A=xe.p;try{xe.p=2,e1(t,i,c,f)}finally{xe.p=A,le.T=E}}function vb(t,i,c,f){var E=le.T;le.T=null;var A=xe.p;try{xe.p=8,e1(t,i,c,f)}finally{xe.p=A,le.T=E}}function e1(t,i,c,f){if(Xh){var E=t1(f);if(E===null)F0(t,i,f,Yh,c),a2(t,f);else if(Cb(E,t,i,c,f))f.stopPropagation();else if(a2(t,f),i&4&&-1<Tb.indexOf(t)){for(;E!==null;){var A=un(E);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var O=jn(A.pendingLanes);if(O!==0){var V=A;for(V.pendingLanes|=2,V.entangledLanes|=2;O;){var Q=1<<31-At(O);V.entanglements[1]|=Q,O&=~Q}qs(A),(Fn&6)===0&&(Rh=ht()+500,Wc(0))}}break;case 31:case 13:V=Xo(A,2),V!==null&&qi(V,A,2),Oh(),$0(A,2)}if(A=t1(f),A===null&&F0(t,i,f,Yh,c),A===E)break;E=A}E!==null&&f.stopPropagation()}else F0(t,i,f,null,c)}}function t1(t){return t=Bi(t),n1(t)}var Yh=null;function n1(t){if(Yh=null,t=Qn(t),t!==null){var i=g(t);if(i===null)t=null;else{var c=i.tag;if(c===13){if(t=x(i),t!==null)return t;t=null}else if(c===31){if(t=T(i),t!==null)return t;t=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null)}}return Yh=t,null}function s2(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Un()){case Bt:return 2;case Kn:return 8;case lr:case cr:return 32;case Zr:return 268435456;default:return 32}default:return 32}}var r1=!1,go=null,mo=null,po=null,tu=new Map,nu=new Map,yo=[],Tb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function a2(t,i){switch(t){case"focusin":case"focusout":go=null;break;case"dragenter":case"dragleave":mo=null;break;case"mouseover":case"mouseout":po=null;break;case"pointerover":case"pointerout":tu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":nu.delete(i.pointerId)}}function ru(t,i,c,f,E,A){return t===null||t.nativeEvent!==A?(t={blockedOn:i,domEventName:c,eventSystemFlags:f,nativeEvent:A,targetContainers:[E]},i!==null&&(i=un(i),i!==null&&r2(i)),t):(t.eventSystemFlags|=f,i=t.targetContainers,E!==null&&i.indexOf(E)===-1&&i.push(E),t)}function Cb(t,i,c,f,E){switch(i){case"focusin":return go=ru(go,t,i,c,f,E),!0;case"dragenter":return mo=ru(mo,t,i,c,f,E),!0;case"mouseover":return po=ru(po,t,i,c,f,E),!0;case"pointerover":var A=E.pointerId;return tu.set(A,ru(tu.get(A)||null,t,i,c,f,E)),!0;case"gotpointercapture":return A=E.pointerId,nu.set(A,ru(nu.get(A)||null,t,i,c,f,E)),!0}return!1}function o2(t){var i=Qn(t.target);if(i!==null){var c=g(i);if(c!==null){if(i=c.tag,i===13){if(i=x(c),i!==null){t.blockedOn=i,Oe(t.priority,function(){i2(c)});return}}else if(i===31){if(i=T(c),i!==null){t.blockedOn=i,Oe(t.priority,function(){i2(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){t.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wh(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var c=t1(t.nativeEvent);if(c===null){c=t.nativeEvent;var f=new c.constructor(c.type,c);ia=f,c.target.dispatchEvent(f),ia=null}else return i=un(c),i!==null&&r2(i),t.blockedOn=c,!1;i.shift()}return!0}function l2(t,i,c){Wh(t)&&c.delete(i)}function Sb(){r1=!1,go!==null&&Wh(go)&&(go=null),mo!==null&&Wh(mo)&&(mo=null),po!==null&&Wh(po)&&(po=null),tu.forEach(l2),nu.forEach(l2)}function Kh(t,i){t.blockedOn===i&&(t.blockedOn=null,r1||(r1=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Sb)))}var Qh=null;function c2(t){Qh!==t&&(Qh=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Qh===t&&(Qh=null);for(var i=0;i<t.length;i+=3){var c=t[i],f=t[i+1],E=t[i+2];if(typeof f!="function"){if(n1(f||c)===null)continue;break}var A=un(c);A!==null&&(t.splice(i,3),i-=3,t0(A,{pending:!0,data:E,method:c.method,action:f},f,E))}}))}function Zl(t){function i(Q){return Kh(Q,t)}go!==null&&Kh(go,t),mo!==null&&Kh(mo,t),po!==null&&Kh(po,t),tu.forEach(i),nu.forEach(i);for(var c=0;c<yo.length;c++){var f=yo[c];f.blockedOn===t&&(f.blockedOn=null)}for(;0<yo.length&&(c=yo[0],c.blockedOn===null);)o2(c),c.blockedOn===null&&yo.shift();if(c=(t.ownerDocument||t).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var E=c[f],A=c[f+1],O=E[Mt]||null;if(typeof A=="function")O||c2(c);else if(O){var V=null;if(A&&A.hasAttribute("formAction")){if(E=A,O=A[Mt]||null)V=O.formAction;else if(n1(E)!==null)continue}else V=O.action;typeof V=="function"?c[f+1]=V:(c.splice(f,3),f-=3),c2(c)}}}function u2(){function t(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(O){return E=O})},focusReset:"manual",scroll:"manual"})}function i(){E!==null&&(E(),E=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,E=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),E!==null&&(E(),E=null)}}}function i1(t){this._internalRoot=t}Zh.prototype.render=i1.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(o(409));var c=i.current,f=os();t2(c,f,t,i,null,null)},Zh.prototype.unmount=i1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;t2(t.current,2,null,t,null,null),Oh(),i[er]=null}};function Zh(t){this._internalRoot=t}Zh.prototype.unstable_scheduleHydration=function(t){if(t){var i=Ut();t={blockedOn:null,target:t,priority:i};for(var c=0;c<yo.length&&i!==0&&i<yo[c].priority;c++);yo.splice(c,0,t),c===0&&o2(t)}};var h2=e.version;if(h2!=="19.2.0")throw Error(o(527,h2,"19.2.0"));xe.findDOMNode=function(t){var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(o(188)):(t=Object.keys(t).join(","),Error(o(268,t)));return t=w(i),t=t!==null?C(t):null,t=t===null?null:t.stateNode,t};var Ib={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:le,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jh.isDisabled&&Jh.supportsFiber)try{tn=Jh.inject(Ib),Fe=Jh}catch{}}return su.createRoot=function(t,i){if(!h(t))throw Error(o(299));var c=!1,f="",E=xp,A=Ep,O=wp;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(E=i.onUncaughtError),i.onCaughtError!==void 0&&(A=i.onCaughtError),i.onRecoverableError!==void 0&&(O=i.onRecoverableError)),i=$y(t,1,!1,null,null,c,f,null,E,A,O,u2),t[er]=i.current,U0(t),new i1(i)},su.hydrateRoot=function(t,i,c){if(!h(t))throw Error(o(299));var f=!1,E="",A=xp,O=Ep,V=wp,Q=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onUncaughtError!==void 0&&(A=c.onUncaughtError),c.onCaughtError!==void 0&&(O=c.onCaughtError),c.onRecoverableError!==void 0&&(V=c.onRecoverableError),c.formState!==void 0&&(Q=c.formState)),i=$y(t,1,!0,i,c??null,f,E,Q,A,O,V,u2),i.context=e2(null),c=i.current,f=os(),f=Gt(f),E=to(f),E.callback=null,no(c,E,f),c=f,i.current.lanes=c,je(i,c),qs(i),t[er]=i.current,U0(t),new Zh(i)},su.version="19.2.0",su}var _2;function Vb(){if(_2)return o1.exports;_2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),o1.exports=Bb(),o1.exports}var Ub=Vb();const Fb=qd(Ub),Ro=()=>R.jsxs("div",{style:{padding:"1.5rem 0",display:"flex",justifyContent:"center",alignItems:"center"},children:[R.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",border:"3px solid #e5e7eb",borderTopColor:"#2EC483",animation:"spin 1s linear infinite"}}),R.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]}),jb=()=>{};var A2={};const bE=function(s){const e=[];let n=0;for(let o=0;o<s.length;o++){let h=s.charCodeAt(o);h<128?e[n++]=h:h<2048?(e[n++]=h>>6|192,e[n++]=h&63|128):(h&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(h=65536+((h&1023)<<10)+(s.charCodeAt(++o)&1023),e[n++]=h>>18|240,e[n++]=h>>12&63|128,e[n++]=h>>6&63|128,e[n++]=h&63|128):(e[n++]=h>>12|224,e[n++]=h>>6&63|128,e[n++]=h&63|128)}return e},zb=function(s){const e=[];let n=0,o=0;for(;n<s.length;){const h=s[n++];if(h<128)e[o++]=String.fromCharCode(h);else if(h>191&&h<224){const g=s[n++];e[o++]=String.fromCharCode((h&31)<<6|g&63)}else if(h>239&&h<365){const g=s[n++],x=s[n++],T=s[n++],b=((h&7)<<18|(g&63)<<12|(x&63)<<6|T&63)-65536;e[o++]=String.fromCharCode(55296+(b>>10)),e[o++]=String.fromCharCode(56320+(b&1023))}else{const g=s[n++],x=s[n++];e[o++]=String.fromCharCode((h&15)<<12|(g&63)<<6|x&63)}}return e.join("")},vE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let h=0;h<s.length;h+=3){const g=s[h],x=h+1<s.length,T=x?s[h+1]:0,b=h+2<s.length,w=b?s[h+2]:0,C=g>>2,N=(g&3)<<4|T>>4;let P=(T&15)<<2|w>>6,B=w&63;b||(B=64,x||(P=64)),o.push(n[C],n[N],n[P],n[B])}return o.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(bE(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):zb(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let h=0;h<s.length;){const g=n[s.charAt(h++)],T=h<s.length?n[s.charAt(h)]:0;++h;const w=h<s.length?n[s.charAt(h)]:64;++h;const N=h<s.length?n[s.charAt(h)]:64;if(++h,g==null||T==null||w==null||N==null)throw new Hb;const P=g<<2|T>>4;if(o.push(P),w!==64){const B=T<<4&240|w>>2;if(o.push(B),N!==64){const ee=w<<6&192|N;o.push(ee)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Hb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Gb=function(s){const e=bE(s);return vE.encodeByteArray(e,!0)},wd=function(s){return Gb(s).replace(/\./g,"")},TE=function(s){try{return vE.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function qb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Xb=()=>qb().__FIREBASE_DEFAULTS__,Yb=()=>{if(typeof process>"u"||typeof A2>"u")return;const s=A2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Wb=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&TE(s[1]);return e&&JSON.parse(e)},Xd=()=>{try{return jb()||Xb()||Yb()||Wb()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},CE=s=>Xd()?.emulatorHosts?.[s],SE=s=>{const e=CE(s);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),o]:[e.substring(0,n),o]},IE=()=>Xd()?.config,RE=s=>Xd()?.[`_${s}`];class Kb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,o)=>{n?this.reject(n):this.resolve(o),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,o))}}}function Bo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function og(s){return(await fetch(s,{credentials:"include"})).ok}function Qb(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},o=e||"demo-project",h=s.iat||0,g=s.sub||s.user_id;if(!g)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const x={iss:`https://securetoken.google.com/${o}`,aud:o,iat:h,exp:h+3600,auth_time:h,sub:g,user_id:g,firebase:{sign_in_provider:"custom",identities:{}},...s};return[wd(JSON.stringify(n)),wd(JSON.stringify(x)),""].join(".")}const pu={};function Zb(){const s={prod:[],emulator:[]};for(const e of Object.keys(pu))pu[e]?s.emulator.push(e):s.prod.push(e);return s}function Jb(s){let e=document.getElementById(s),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),n=!0),{created:n,element:e}}let b2=!1;function lg(s,e){if(typeof window>"u"||typeof document>"u"||!Bo(window.location.host)||pu[s]===e||pu[s]||b2)return;pu[s]=e;function n(P){return`__firebase__banner__${P}`}const o="__firebase__banner",g=Zb().prod.length>0;function x(){const P=document.getElementById(o);P&&P.remove()}function T(P){P.style.display="flex",P.style.background="#7faaf0",P.style.position="fixed",P.style.bottom="5px",P.style.left="5px",P.style.padding=".5em",P.style.borderRadius="5px",P.style.alignItems="center"}function b(P,B){P.setAttribute("width","24"),P.setAttribute("id",B),P.setAttribute("height","24"),P.setAttribute("viewBox","0 0 24 24"),P.setAttribute("fill","none"),P.style.marginLeft="-6px"}function w(){const P=document.createElement("span");return P.style.cursor="pointer",P.style.marginLeft="16px",P.style.fontSize="24px",P.innerHTML=" &times;",P.onclick=()=>{b2=!0,x()},P}function C(P,B){P.setAttribute("id",B),P.innerText="Learn more",P.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",P.setAttribute("target","__blank"),P.style.paddingLeft="5px",P.style.textDecoration="underline"}function N(){const P=Jb(o),B=n("text"),ee=document.getElementById(B)||document.createElement("span"),ne=n("learnmore"),ae=document.getElementById(ne)||document.createElement("a"),tt=n("preprendIcon"),ze=document.getElementById(tt)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(P.created){const fe=P.element;T(fe),C(ae,ne);const Ge=w();b(ze,tt),fe.append(ze,ee,ae,Ge),document.body.appendChild(fe)}g?(ee.innerText="Preview backend disconnected.",ze.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ze.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,ee.innerText="Preview backend running in this workspace."),ee.setAttribute("id",B)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}function vi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $b(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vi())}function ev(){const s=Xd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nv(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function rv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iv(){const s=vi();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function sv(){return!ev()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function av(){try{return typeof indexedDB=="object"}catch{return!1}}function ov(){return new Promise((s,e)=>{try{let n=!0;const o="validate-browser-context-for-indexeddb-analytics-module",h=self.indexedDB.open(o);h.onsuccess=()=>{h.result.close(),n||self.indexedDB.deleteDatabase(o),s(!0)},h.onupgradeneeded=()=>{n=!1},h.onerror=()=>{e(h.error?.message||"")}}catch(n){e(n)}})}const lv="FirebaseError";class na extends Error{constructor(e,n,o){super(n),this.code=e,this.customData=o,this.name=lv,Object.setPrototypeOf(this,na.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mu.prototype.create)}}class Mu{constructor(e,n,o){this.service=e,this.serviceName=n,this.errors=o}create(e,...n){const o=n[0]||{},h=`${this.service}/${e}`,g=this.errors[e],x=g?cv(g,o):"Error",T=`${this.serviceName}: ${x} (${h}).`;return new na(h,T,o)}}function cv(s,e){return s.replace(uv,(n,o)=>{const h=e[o];return h!=null?String(h):`<${o}?>`})}const uv=/\{\$([^}]+)}/g;function hv(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function hl(s,e){if(s===e)return!0;const n=Object.keys(s),o=Object.keys(e);for(const h of n){if(!o.includes(h))return!1;const g=s[h],x=e[h];if(v2(g)&&v2(x)){if(!hl(g,x))return!1}else if(g!==x)return!1}for(const h of o)if(!n.includes(h))return!1;return!0}function v2(s){return s!==null&&typeof s=="object"}function ku(s){const e=[];for(const[n,o]of Object.entries(s))Array.isArray(o)?o.forEach(h=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(h))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function cu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(o=>{if(o){const[h,g]=o.split("=");e[decodeURIComponent(h)]=decodeURIComponent(g)}}),e}function uu(s){const e=s.indexOf("?");if(!e)return"";const n=s.indexOf("#",e);return s.substring(e,n>0?n:void 0)}function dv(s,e){const n=new fv(s,e);return n.subscribe.bind(n)}class fv{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(o=>{this.error(o)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,o){let h;if(e===void 0&&n===void 0&&o===void 0)throw new Error("Missing Observer.");gv(e,["next","error","complete"])?h=e:h={next:e,error:n,complete:o},h.next===void 0&&(h.next=h1),h.error===void 0&&(h.error=h1),h.complete===void 0&&(h.complete=h1);const g=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?h.error(this.finalError):h.complete()}catch{}}),this.observers.push(h),g}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gv(s,e){if(typeof s!="object"||s===null)return!1;for(const n of e)if(n in s&&typeof s[n]=="function")return!0;return!1}function h1(){}function sr(s){return s&&s._delegate?s._delegate:s}class No{constructor(e,n,o){this.name=e,this.instanceFactory=n,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const sl="[DEFAULT]";class mv{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const o=new Kb;if(this.instancesDeferred.set(n,o),this.isInitialized(n)||this.shouldAutoInitialize())try{const h=this.getOrInitializeService({instanceIdentifier:n});h&&o.resolve(h)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),o=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(h){if(o)return null;throw h}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yv(e))try{this.getOrInitializeService({instanceIdentifier:sl})}catch{}for(const[n,o]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(n);try{const g=this.getOrInitializeService({instanceIdentifier:h});o.resolve(g)}catch{}}}}clearInstance(e=sl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sl){return this.instances.has(e)}getOptions(e=sl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const h=this.getOrInitializeService({instanceIdentifier:o,options:n});for(const[g,x]of this.instancesDeferred.entries()){const T=this.normalizeInstanceIdentifier(g);o===T&&x.resolve(h)}return h}onInit(e,n){const o=this.normalizeInstanceIdentifier(n),h=this.onInitCallbacks.get(o)??new Set;h.add(e),this.onInitCallbacks.set(o,h);const g=this.instances.get(o);return g&&e(g,o),()=>{h.delete(e)}}invokeOnInitCallbacks(e,n){const o=this.onInitCallbacks.get(n);if(o)for(const h of o)try{h(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let o=this.instances.get(e);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:pv(e),options:n}),this.instances.set(e,o),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(o,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,o)}catch{}return o||null}normalizeInstanceIdentifier(e=sl){return this.component?this.component.multipleInstances?e:sl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pv(s){return s===sl?void 0:s}function yv(s){return s.instantiationMode==="EAGER"}class xv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new mv(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var vn;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(vn||(vn={}));const Ev={debug:vn.DEBUG,verbose:vn.VERBOSE,info:vn.INFO,warn:vn.WARN,error:vn.ERROR,silent:vn.SILENT},wv=vn.INFO,_v={[vn.DEBUG]:"log",[vn.VERBOSE]:"log",[vn.INFO]:"info",[vn.WARN]:"warn",[vn.ERROR]:"error"},Av=(s,e,...n)=>{if(e<s.logLevel)return;const o=new Date().toISOString(),h=_v[e];if(h)console[h](`[${o}]  ${s.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cg{constructor(e){this.name=e,this._logLevel=wv,this._logHandler=Av,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ev[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vn.DEBUG,...e),this._logHandler(this,vn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vn.VERBOSE,...e),this._logHandler(this,vn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vn.INFO,...e),this._logHandler(this,vn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vn.WARN,...e),this._logHandler(this,vn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vn.ERROR,...e),this._logHandler(this,vn.ERROR,...e)}}const bv=(s,e)=>e.some(n=>s instanceof n);let T2,C2;function vv(){return T2||(T2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Tv(){return C2||(C2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const NE=new WeakMap,R1=new WeakMap,OE=new WeakMap,d1=new WeakMap,ug=new WeakMap;function Cv(s){const e=new Promise((n,o)=>{const h=()=>{s.removeEventListener("success",g),s.removeEventListener("error",x)},g=()=>{n(To(s.result)),h()},x=()=>{o(s.error),h()};s.addEventListener("success",g),s.addEventListener("error",x)});return e.then(n=>{n instanceof IDBCursor&&NE.set(n,s)}).catch(()=>{}),ug.set(e,s),e}function Sv(s){if(R1.has(s))return;const e=new Promise((n,o)=>{const h=()=>{s.removeEventListener("complete",g),s.removeEventListener("error",x),s.removeEventListener("abort",x)},g=()=>{n(),h()},x=()=>{o(s.error||new DOMException("AbortError","AbortError")),h()};s.addEventListener("complete",g),s.addEventListener("error",x),s.addEventListener("abort",x)});R1.set(s,e)}let N1={get(s,e,n){if(s instanceof IDBTransaction){if(e==="done")return R1.get(s);if(e==="objectStoreNames")return s.objectStoreNames||OE.get(s);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return To(s[e])},set(s,e,n){return s[e]=n,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Iv(s){N1=s(N1)}function Rv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const o=s.call(f1(this),e,...n);return OE.set(o,e.sort?e.sort():[e]),To(o)}:Tv().includes(s)?function(...e){return s.apply(f1(this),e),To(NE.get(this))}:function(...e){return To(s.apply(f1(this),e))}}function Nv(s){return typeof s=="function"?Rv(s):(s instanceof IDBTransaction&&Sv(s),bv(s,vv())?new Proxy(s,N1):s)}function To(s){if(s instanceof IDBRequest)return Cv(s);if(d1.has(s))return d1.get(s);const e=Nv(s);return e!==s&&(d1.set(s,e),ug.set(e,s)),e}const f1=s=>ug.get(s);function Ov(s,e,{blocked:n,upgrade:o,blocking:h,terminated:g}={}){const x=indexedDB.open(s,e),T=To(x);return o&&x.addEventListener("upgradeneeded",b=>{o(To(x.result),b.oldVersion,b.newVersion,To(x.transaction),b)}),n&&x.addEventListener("blocked",b=>n(b.oldVersion,b.newVersion,b)),T.then(b=>{g&&b.addEventListener("close",()=>g()),h&&b.addEventListener("versionchange",w=>h(w.oldVersion,w.newVersion,w))}).catch(()=>{}),T}const Dv=["get","getKey","getAll","getAllKeys","count"],Mv=["put","add","delete","clear"],g1=new Map;function S2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(g1.get(e))return g1.get(e);const n=e.replace(/FromIndex$/,""),o=e!==n,h=Mv.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!(h||Dv.includes(n)))return;const g=async function(x,...T){const b=this.transaction(x,h?"readwrite":"readonly");let w=b.store;return o&&(w=w.index(T.shift())),(await Promise.all([w[n](...T),h&&b.done]))[0]};return g1.set(e,g),g}Iv(s=>({...s,get:(e,n,o)=>S2(e,n)||s.get(e,n,o),has:(e,n)=>!!S2(e,n)||s.has(e,n)}));class kv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Lv(n)){const o=n.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(n=>n).join(" ")}}function Lv(s){return s.getComponent()?.type==="VERSION"}const O1="@firebase/app",I2="0.14.6";const La=new cg("@firebase/app"),Pv="@firebase/app-compat",Bv="@firebase/analytics-compat",Vv="@firebase/analytics",Uv="@firebase/app-check-compat",Fv="@firebase/app-check",jv="@firebase/auth",zv="@firebase/auth-compat",Hv="@firebase/database",Gv="@firebase/data-connect",qv="@firebase/database-compat",Xv="@firebase/functions",Yv="@firebase/functions-compat",Wv="@firebase/installations",Kv="@firebase/installations-compat",Qv="@firebase/messaging",Zv="@firebase/messaging-compat",Jv="@firebase/performance",$v="@firebase/performance-compat",eT="@firebase/remote-config",tT="@firebase/remote-config-compat",nT="@firebase/storage",rT="@firebase/storage-compat",iT="@firebase/firestore",sT="@firebase/ai",aT="@firebase/firestore-compat",oT="firebase",lT="12.6.0";const D1="[DEFAULT]",cT={[O1]:"fire-core",[Pv]:"fire-core-compat",[Vv]:"fire-analytics",[Bv]:"fire-analytics-compat",[Fv]:"fire-app-check",[Uv]:"fire-app-check-compat",[jv]:"fire-auth",[zv]:"fire-auth-compat",[Hv]:"fire-rtdb",[Gv]:"fire-data-connect",[qv]:"fire-rtdb-compat",[Xv]:"fire-fn",[Yv]:"fire-fn-compat",[Wv]:"fire-iid",[Kv]:"fire-iid-compat",[Qv]:"fire-fcm",[Zv]:"fire-fcm-compat",[Jv]:"fire-perf",[$v]:"fire-perf-compat",[eT]:"fire-rc",[tT]:"fire-rc-compat",[nT]:"fire-gcs",[rT]:"fire-gcs-compat",[iT]:"fire-fst",[aT]:"fire-fst-compat",[sT]:"fire-vertex","fire-js":"fire-js",[oT]:"fire-js-all"};const Au=new Map,uT=new Map,M1=new Map;function R2(s,e){try{s.container.addComponent(e)}catch(n){La.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,n)}}function dl(s){const e=s.name;if(M1.has(e))return La.debug(`There were multiple attempts to register component ${e}.`),!1;M1.set(e,s);for(const n of Au.values())R2(n,s);for(const n of uT.values())R2(n,s);return!0}function Yd(s,e){const n=s.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),s.container.getProvider(e)}function cs(s){return s==null?!1:s.settings!==void 0}const hT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Co=new Mu("app","Firebase",hT);class dT{constructor(e,n,o){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new No("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Co.create("app-deleted",{appName:this._name})}}const yc=lT;function hg(s,e={}){let n=s;typeof e!="object"&&(e={name:e});const o={name:D1,automaticDataCollectionEnabled:!0,...e},h=o.name;if(typeof h!="string"||!h)throw Co.create("bad-app-name",{appName:String(h)});if(n||(n=IE()),!n)throw Co.create("no-options");const g=Au.get(h);if(g){if(hl(n,g.options)&&hl(o,g.config))return g;throw Co.create("duplicate-app",{appName:h})}const x=new xv(h);for(const b of M1.values())x.addComponent(b);const T=new dT(n,o,x);return Au.set(h,T),T}function Wd(s=D1){const e=Au.get(s);if(!e&&s===D1&&IE())return hg();if(!e)throw Co.create("no-app",{appName:s});return e}function DE(){return Array.from(Au.values())}function Ys(s,e,n){let o=cT[s]??s;n&&(o+=`-${n}`);const h=o.match(/\s|\//),g=e.match(/\s|\//);if(h||g){const x=[`Unable to register library "${o}" with version "${e}":`];h&&x.push(`library name "${o}" contains illegal characters (whitespace or "/")`),h&&g&&x.push("and"),g&&x.push(`version name "${e}" contains illegal characters (whitespace or "/")`),La.warn(x.join(" "));return}dl(new No(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}const fT="firebase-heartbeat-database",gT=1,bu="firebase-heartbeat-store";let m1=null;function ME(){return m1||(m1=Ov(fT,gT,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(bu)}catch(n){console.warn(n)}}}}).catch(s=>{throw Co.create("idb-open",{originalErrorMessage:s.message})})),m1}async function mT(s){try{const n=(await ME()).transaction(bu),o=await n.objectStore(bu).get(kE(s));return await n.done,o}catch(e){if(e instanceof na)La.warn(e.message);else{const n=Co.create("idb-get",{originalErrorMessage:e?.message});La.warn(n.message)}}}async function N2(s,e){try{const o=(await ME()).transaction(bu,"readwrite");await o.objectStore(bu).put(e,kE(s)),await o.done}catch(n){if(n instanceof na)La.warn(n.message);else{const o=Co.create("idb-set",{originalErrorMessage:n?.message});La.warn(o.message)}}}function kE(s){return`${s.name}!${s.options.appId}`}const pT=1024,yT=30;class xT{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new wT(n),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=O2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(h=>h.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:n}),this._heartbeatsCache.heartbeats.length>yT){const h=_T(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(h,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){La.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=O2(),{heartbeatsToSend:n,unsentEntries:o}=ET(this._heartbeatsCache.heartbeats),h=wd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),h}catch(e){return La.warn(e),""}}}function O2(){return new Date().toISOString().substring(0,10)}function ET(s,e=pT){const n=[];let o=s.slice();for(const h of s){const g=n.find(x=>x.agent===h.agent);if(g){if(g.dates.push(h.date),D2(n)>e){g.dates.pop();break}}else if(n.push({agent:h.agent,dates:[h.date]}),D2(n)>e){n.pop();break}o=o.slice(1)}return{heartbeatsToSend:n,unsentEntries:o}}class wT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return av()?ov().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await mT(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const o=await this.read();return N2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const o=await this.read();return N2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function D2(s){return wd(JSON.stringify({version:2,heartbeats:s})).length}function _T(s){if(s.length===0)return-1;let e=0,n=s[0].date;for(let o=1;o<s.length;o++)s[o].date<n&&(n=s[o].date,e=o);return e}function AT(s){dl(new No("platform-logger",e=>new kv(e),"PRIVATE")),dl(new No("heartbeat",e=>new xT(e),"PRIVATE")),Ys(O1,I2,s),Ys(O1,I2,"esm2020"),Ys("fire-js","")}AT("");var bT="firebase",vT="12.6.0";Ys(bT,vT,"app");function LE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TT=LE,PE=new Mu("auth","Firebase",LE());const _d=new cg("@firebase/auth");function CT(s,...e){_d.logLevel<=vn.WARN&&_d.warn(`Auth (${yc}): ${s}`,...e)}function od(s,...e){_d.logLevel<=vn.ERROR&&_d.error(`Auth (${yc}): ${s}`,...e)}function ks(s,...e){throw dg(s,...e)}function Ws(s,...e){return dg(s,...e)}function BE(s,e,n){const o={...TT(),[e]:n};return new Mu("auth","Firebase",o).create(e,{appName:s.name})}function Ma(s){return BE(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dg(s,...e){if(typeof s!="string"){const n=e[0],o=[...e.slice(1)];return o[0]&&(o[0].appName=s.name),s._errorFactory.create(n,...o)}return PE.create(s,...e)}function qt(s,e,...n){if(!s)throw dg(e,...n)}function Oa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw od(e),new Error(e)}function Pa(s,e){s||Oa(e)}function k1(){return typeof self<"u"&&self.location?.href||""}function ST(){return M2()==="http:"||M2()==="https:"}function M2(){return typeof self<"u"&&self.location?.protocol||null}function IT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ST()||nv()||"connection"in navigator)?navigator.onLine:!0}function RT(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Lu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Pa(n>e,"Short delay should be less than long delay!"),this.isMobile=$b()||rv()}get(){return IT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function fg(s,e){Pa(s.emulator,"Emulator should always be set here");const{url:n}=s.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class VE{static initialize(e,n,o){this.fetchImpl=e,n&&(this.headersImpl=n),o&&(this.responseImpl=o)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Oa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Oa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Oa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const NT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const OT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],DT=new Lu(3e4,6e4);function Fa(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ra(s,e,n,o,h={}){return UE(s,h,async()=>{let g={},x={};o&&(e==="GET"?x=o:g={body:JSON.stringify(o)});const T=ku({key:s.config.apiKey,...x}).slice(1),b=await s._getAdditionalHeaders();b["Content-Type"]="application/json",s.languageCode&&(b["X-Firebase-Locale"]=s.languageCode);const w={method:e,headers:b,...g};return tv()||(w.referrerPolicy="no-referrer"),s.emulatorConfig&&Bo(s.emulatorConfig.host)&&(w.credentials="include"),VE.fetch()(await FE(s,s.config.apiHost,n,T),w)})}async function UE(s,e,n){s._canInitEmulator=!1;const o={...NT,...e};try{const h=new kT(s),g=await Promise.race([n(),h.promise]);h.clearNetworkTimeout();const x=await g.json();if("needConfirmation"in x)throw ed(s,"account-exists-with-different-credential",x);if(g.ok&&!("errorMessage"in x))return x;{const T=g.ok?x.errorMessage:x.error.message,[b,w]=T.split(" : ");if(b==="FEDERATED_USER_ID_ALREADY_LINKED")throw ed(s,"credential-already-in-use",x);if(b==="EMAIL_EXISTS")throw ed(s,"email-already-in-use",x);if(b==="USER_DISABLED")throw ed(s,"user-disabled",x);const C=o[b]||b.toLowerCase().replace(/[_\s]+/g,"-");if(w)throw BE(s,C,w);ks(s,C)}}catch(h){if(h instanceof na)throw h;ks(s,"network-request-failed",{message:String(h)})}}async function Pu(s,e,n,o,h={}){const g=await ra(s,e,n,o,h);return"mfaPendingCredential"in g&&ks(s,"multi-factor-auth-required",{_serverResponse:g}),g}async function FE(s,e,n,o){const h=`${e}${n}?${o}`,g=s,x=g.config.emulator?fg(s.config,h):`${s.config.apiScheme}://${h}`;return OT.includes(n)&&(await g._persistenceManagerAvailable,g._getPersistenceType()==="COOKIE")?g._getPersistence()._getFinalTarget(x).toString():x}function MT(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,o)=>{this.timer=setTimeout(()=>o(Ws(this.auth,"network-request-failed")),DT.get())})}}function ed(s,e,n){const o={appName:s.name};n.email&&(o.email=n.email),n.phoneNumber&&(o.phoneNumber=n.phoneNumber);const h=Ws(s,e,o);return h.customData._tokenResponse=n,h}function k2(s){return s!==void 0&&s.enterprise!==void 0}class LT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return MT(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function PT(s,e){return ra(s,"GET","/v2/recaptchaConfig",Fa(s,e))}async function BT(s,e){return ra(s,"POST","/v1/accounts:delete",e)}async function Ad(s,e){return ra(s,"POST","/v1/accounts:lookup",e)}function yu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function VT(s,e=!1){const n=sr(s),o=await n.getIdToken(e),h=gg(o);qt(h&&h.exp&&h.auth_time&&h.iat,n.auth,"internal-error");const g=typeof h.firebase=="object"?h.firebase:void 0,x=g?.sign_in_provider;return{claims:h,token:o,authTime:yu(p1(h.auth_time)),issuedAtTime:yu(p1(h.iat)),expirationTime:yu(p1(h.exp)),signInProvider:x||null,signInSecondFactor:g?.sign_in_second_factor||null}}function p1(s){return Number(s)*1e3}function gg(s){const[e,n,o]=s.split(".");if(e===void 0||n===void 0||o===void 0)return od("JWT malformed, contained fewer than 3 sections"),null;try{const h=TE(n);return h?JSON.parse(h):(od("Failed to decode base64 JWT payload"),null)}catch(h){return od("Caught error parsing JWT payload as JSON",h?.toString()),null}}function L2(s){const e=gg(s);return qt(e,"internal-error"),qt(typeof e.exp<"u","internal-error"),qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function cc(s,e,n=!1){if(n)return e;try{return await e}catch(o){throw o instanceof na&&UT(o)&&s.auth.currentUser===s&&await s.auth.signOut(),o}}function UT({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class FT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const o=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class L1{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=yu(this.lastLoginAt),this.creationTime=yu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bd(s){const e=s.auth,n=await s.getIdToken(),o=await cc(s,Ad(e,{idToken:n}));qt(o?.users.length,e,"internal-error");const h=o.users[0];s._notifyReloadListener(h);const g=h.providerUserInfo?.length?jE(h.providerUserInfo):[],x=zT(s.providerData,g),T=s.isAnonymous,b=!(s.email&&h.passwordHash)&&!x?.length,w=T?b:!1,C={uid:h.localId,displayName:h.displayName||null,photoURL:h.photoUrl||null,email:h.email||null,emailVerified:h.emailVerified||!1,phoneNumber:h.phoneNumber||null,tenantId:h.tenantId||null,providerData:x,metadata:new L1(h.createdAt,h.lastLoginAt),isAnonymous:w};Object.assign(s,C)}async function jT(s){const e=sr(s);await bd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function zT(s,e){return[...s.filter(o=>!e.some(h=>h.providerId===o.providerId)),...e]}function jE(s){return s.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function HT(s,e){const n=await UE(s,{},async()=>{const o=ku({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:h,apiKey:g}=s.config,x=await FE(s,h,"/v1/token",`key=${g}`),T=await s._getAdditionalHeaders();T["Content-Type"]="application/x-www-form-urlencoded";const b={method:"POST",headers:T,body:o};return s.emulatorConfig&&Bo(s.emulatorConfig.host)&&(b.credentials="include"),VE.fetch()(x,b)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function GT(s,e){return ra(s,"POST","/v2/accounts:revokeToken",Fa(s,e))}class sc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qt(e.idToken,"internal-error"),qt(typeof e.idToken<"u","internal-error"),qt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):L2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){qt(e.length!==0,"internal-error");const n=L2(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:o,refreshToken:h,expiresIn:g}=await HT(e,n);this.updateTokensAndExpiration(o,h,Number(g))}updateTokensAndExpiration(e,n,o){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+o*1e3}static fromJSON(e,n){const{refreshToken:o,accessToken:h,expirationTime:g}=n,x=new sc;return o&&(qt(typeof o=="string","internal-error",{appName:e}),x.refreshToken=o),h&&(qt(typeof h=="string","internal-error",{appName:e}),x.accessToken=h),g&&(qt(typeof g=="number","internal-error",{appName:e}),x.expirationTime=g),x}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sc,this.toJSON())}_performRefresh(){return Oa("not implemented")}}function Eo(s,e){qt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Ms{constructor({uid:e,auth:n,stsTokenManager:o,...h}){this.providerId="firebase",this.proactiveRefresh=new FT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=h.displayName||null,this.email=h.email||null,this.emailVerified=h.emailVerified||!1,this.phoneNumber=h.phoneNumber||null,this.photoURL=h.photoURL||null,this.isAnonymous=h.isAnonymous||!1,this.tenantId=h.tenantId||null,this.providerData=h.providerData?[...h.providerData]:[],this.metadata=new L1(h.createdAt||void 0,h.lastLoginAt||void 0)}async getIdToken(e){const n=await cc(this,this.stsTokenManager.getToken(this.auth,e));return qt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return VT(this,e)}reload(){return jT(this)}_assign(e){this!==e&&(qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ms({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let o=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),o=!0),n&&await bd(this),await this.auth._persistUserIfCurrent(this),o&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cs(this.auth.app))return Promise.reject(Ma(this.auth));const e=await this.getIdToken();return await cc(this,BT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const o=n.displayName??void 0,h=n.email??void 0,g=n.phoneNumber??void 0,x=n.photoURL??void 0,T=n.tenantId??void 0,b=n._redirectEventId??void 0,w=n.createdAt??void 0,C=n.lastLoginAt??void 0,{uid:N,emailVerified:P,isAnonymous:B,providerData:ee,stsTokenManager:ne}=n;qt(N&&ne,e,"internal-error");const ae=sc.fromJSON(this.name,ne);qt(typeof N=="string",e,"internal-error"),Eo(o,e.name),Eo(h,e.name),qt(typeof P=="boolean",e,"internal-error"),qt(typeof B=="boolean",e,"internal-error"),Eo(g,e.name),Eo(x,e.name),Eo(T,e.name),Eo(b,e.name),Eo(w,e.name),Eo(C,e.name);const tt=new Ms({uid:N,auth:e,email:h,emailVerified:P,displayName:o,isAnonymous:B,photoURL:x,phoneNumber:g,tenantId:T,stsTokenManager:ae,createdAt:w,lastLoginAt:C});return ee&&Array.isArray(ee)&&(tt.providerData=ee.map(ze=>({...ze}))),b&&(tt._redirectEventId=b),tt}static async _fromIdTokenResponse(e,n,o=!1){const h=new sc;h.updateFromServerResponse(n);const g=new Ms({uid:n.localId,auth:e,stsTokenManager:h,isAnonymous:o});return await bd(g),g}static async _fromGetAccountInfoResponse(e,n,o){const h=n.users[0];qt(h.localId!==void 0,"internal-error");const g=h.providerUserInfo!==void 0?jE(h.providerUserInfo):[],x=!(h.email&&h.passwordHash)&&!g?.length,T=new sc;T.updateFromIdToken(o);const b=new Ms({uid:h.localId,auth:e,stsTokenManager:T,isAnonymous:x}),w={uid:h.localId,displayName:h.displayName||null,photoURL:h.photoUrl||null,email:h.email||null,emailVerified:h.emailVerified||!1,phoneNumber:h.phoneNumber||null,tenantId:h.tenantId||null,providerData:g,metadata:new L1(h.createdAt,h.lastLoginAt),isAnonymous:!(h.email&&h.passwordHash)&&!g?.length};return Object.assign(b,w),b}}const P2=new Map;function Da(s){Pa(s instanceof Function,"Expected a class definition");let e=P2.get(s);return e?(Pa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,P2.set(s,e),e)}class zE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}zE.type="NONE";const B2=zE;function ld(s,e,n){return`firebase:${s}:${e}:${n}`}class ac{constructor(e,n,o){this.persistence=e,this.auth=n,this.userKey=o;const{config:h,name:g}=this.auth;this.fullUserKey=ld(this.userKey,h.apiKey,g),this.fullPersistenceKey=ld("persistence",h.apiKey,g),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Ad(this.auth,{idToken:e}).catch(()=>{});return n?Ms._fromGetAccountInfoResponse(this.auth,n,e):null}return Ms._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,o="authUser"){if(!n.length)return new ac(Da(B2),e,o);const h=(await Promise.all(n.map(async w=>{if(await w._isAvailable())return w}))).filter(w=>w);let g=h[0]||Da(B2);const x=ld(o,e.config.apiKey,e.name);let T=null;for(const w of n)try{const C=await w._get(x);if(C){let N;if(typeof C=="string"){const P=await Ad(e,{idToken:C}).catch(()=>{});if(!P)break;N=await Ms._fromGetAccountInfoResponse(e,P,C)}else N=Ms._fromJSON(e,C);w!==g&&(T=N),g=w;break}}catch{}const b=h.filter(w=>w._shouldAllowMigration);return!g._shouldAllowMigration||!b.length?new ac(g,e,o):(g=b[0],T&&await g._set(x,T.toJSON()),await Promise.all(n.map(async w=>{if(w!==g)try{await w._remove(x)}catch{}})),new ac(g,e,o))}}function V2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(XE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(HE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(WE(e))return"Blackberry";if(KE(e))return"Webos";if(GE(e))return"Safari";if((e.includes("chrome/")||qE(e))&&!e.includes("edge/"))return"Chrome";if(YE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,o=s.match(n);if(o?.length===2)return o[1]}return"Other"}function HE(s=vi()){return/firefox\//i.test(s)}function GE(s=vi()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function qE(s=vi()){return/crios\//i.test(s)}function XE(s=vi()){return/iemobile/i.test(s)}function YE(s=vi()){return/android/i.test(s)}function WE(s=vi()){return/blackberry/i.test(s)}function KE(s=vi()){return/webos/i.test(s)}function mg(s=vi()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function qT(s=vi()){return mg(s)&&!!window.navigator?.standalone}function XT(){return iv()&&document.documentMode===10}function QE(s=vi()){return mg(s)||YE(s)||KE(s)||WE(s)||/windows phone/i.test(s)||XE(s)}function ZE(s,e=[]){let n;switch(s){case"Browser":n=V2(vi());break;case"Worker":n=`${V2(vi())}-${s}`;break;default:n=s}const o=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${yc}/${o}`}class YT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const o=g=>new Promise((x,T)=>{try{const b=e(g);x(b)}catch(b){T(b)}});o.onAbort=n,this.queue.push(o);const h=this.queue.length-1;return()=>{this.queue[h]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const o of this.queue)await o(e),o.onAbort&&n.push(o.onAbort)}catch(o){n.reverse();for(const h of n)try{h()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:o?.message})}}}async function WT(s,e={}){return ra(s,"GET","/v2/passwordPolicy",Fa(s,e))}const KT=6;class QT{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??KT,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const o=this.customStrengthOptions.minPasswordLength,h=this.customStrengthOptions.maxPasswordLength;o&&(n.meetsMinPasswordLength=e.length>=o),h&&(n.meetsMaxPasswordLength=e.length<=h)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let o;for(let h=0;h<e.length;h++)o=e.charAt(h),this.updatePasswordCharacterOptionsStatuses(n,o>="a"&&o<="z",o>="A"&&o<="Z",o>="0"&&o<="9",this.allowedNonAlphanumericCharacters.includes(o))}updatePasswordCharacterOptionsStatuses(e,n,o,h,g){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=o)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=h)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=g))}}class ZT{constructor(e,n,o,h){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=o,this.config=h,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new U2(this),this.idTokenSubscription=new U2(this),this.beforeStateQueue=new YT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=h.sdkClientVersion,this._persistenceManagerAvailable=new Promise(g=>this._resolvePersistenceManagerAvailable=g)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Da(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ac.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ad(this,{idToken:e}),o=await Ms._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(o)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(cs(this.app)){const g=this.app.settings.authIdToken;return g?new Promise(x=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(g).then(x,x))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let o=n,h=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const g=this.redirectUser?._redirectEventId,x=o?._redirectEventId,T=await this.tryRedirectSignIn(e);(!g||g===x)&&T?.user&&(o=T.user,h=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(h)try{await this.beforeStateQueue.runMiddleware(o)}catch(g){o=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(g))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bd(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=RT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cs(this.app))return Promise.reject(Ma(this));const n=e?sr(e):null;return n&&qt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cs(this.app)?Promise.reject(Ma(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cs(this.app)?Promise.reject(Ma(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Da(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WT(this),n=new QT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Mu("auth","Firebase",e())}onAuthStateChanged(e,n,o){return this.registerStateListener(this.authStateSubscription,e,n,o)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,o){return this.registerStateListener(this.idTokenSubscription,e,n,o)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const o=this.onAuthStateChanged(()=>{o(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),o={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(o.tenantId=this.tenantId),await GT(this,o)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const o=await this.getOrInitRedirectPersistenceManager(n);return e===null?o.removeCurrentUser():o.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Da(e)||this._popupRedirectResolver;qt(n,this,"argument-error"),this.redirectPersistenceManager=await ac.create(this,[Da(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,o,h){if(this._deleted)return()=>{};const g=typeof n=="function"?n:n.next.bind(n);let x=!1;const T=this._isInitialized?Promise.resolve():this._initializationPromise;if(qt(T,this,"internal-error"),T.then(()=>{x||g(this.currentUser)}),typeof n=="function"){const b=e.addObserver(n,o,h);return()=>{x=!0,b()}}else{const b=e.addObserver(n);return()=>{x=!0,b()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const o=await this._getAppCheckToken();return o&&(e["X-Firebase-AppCheck"]=o),e}async _getAppCheckToken(){if(cs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&CT(`Error while retrieving App Check token: ${e.error}`),e?.token}}function El(s){return sr(s)}class U2{constructor(e){this.auth=e,this.observer=null,this.addObserver=dv(n=>this.observer=n)}get next(){return qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Kd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JT(s){Kd=s}function JE(s){return Kd.loadJS(s)}function $T(){return Kd.recaptchaEnterpriseScript}function eC(){return Kd.gapiScript}function tC(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class nC{constructor(){this.enterprise=new rC}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class rC{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const iC="recaptcha-enterprise",$E="NO_RECAPTCHA";class sC{constructor(e){this.type=iC,this.auth=El(e)}async verify(e="verify",n=!1){async function o(g){if(!n){if(g.tenantId==null&&g._agentRecaptchaConfig!=null)return g._agentRecaptchaConfig.siteKey;if(g.tenantId!=null&&g._tenantRecaptchaConfigs[g.tenantId]!==void 0)return g._tenantRecaptchaConfigs[g.tenantId].siteKey}return new Promise(async(x,T)=>{PT(g,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(b=>{if(b.recaptchaKey===void 0)T(new Error("recaptcha Enterprise site key undefined"));else{const w=new LT(b);return g.tenantId==null?g._agentRecaptchaConfig=w:g._tenantRecaptchaConfigs[g.tenantId]=w,x(w.siteKey)}}).catch(b=>{T(b)})})}function h(g,x,T){const b=window.grecaptcha;k2(b)?b.enterprise.ready(()=>{b.enterprise.execute(g,{action:e}).then(w=>{x(w)}).catch(()=>{x($E)})}):T(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nC().execute("siteKey",{action:"verify"}):new Promise((g,x)=>{o(this.auth).then(T=>{if(!n&&k2(window.grecaptcha))h(T,g,x);else{if(typeof window>"u"){x(new Error("RecaptchaVerifier is only supported in browser"));return}let b=$T();b.length!==0&&(b+=T),JE(b).then(()=>{h(T,g,x)}).catch(w=>{x(w)})}}).catch(T=>{x(T)})})}}async function F2(s,e,n,o=!1,h=!1){const g=new sC(s);let x;if(h)x=$E;else try{x=await g.verify(n)}catch{x=await g.verify(n,!0)}const T={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in T){const b=T.phoneEnrollmentInfo.phoneNumber,w=T.phoneEnrollmentInfo.recaptchaToken;Object.assign(T,{phoneEnrollmentInfo:{phoneNumber:b,recaptchaToken:w,captchaResponse:x,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in T){const b=T.phoneSignInInfo.recaptchaToken;Object.assign(T,{phoneSignInInfo:{recaptchaToken:b,captchaResponse:x,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return T}return o?Object.assign(T,{captchaResp:x}):Object.assign(T,{captchaResponse:x}),Object.assign(T,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(T,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),T}async function P1(s,e,n,o,h){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const g=await F2(s,e,n,n==="getOobCode");return o(s,g)}else return o(s,e).catch(async g=>{if(g.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const x=await F2(s,e,n,n==="getOobCode");return o(s,x)}else return Promise.reject(g)})}function aC(s,e){const n=Yd(s,"auth");if(n.isInitialized()){const h=n.getImmediate(),g=n.getOptions();if(hl(g,e??{}))return h;ks(h,"already-initialized")}return n.initialize({options:e})}function oC(s,e){const n=e?.persistence||[],o=(Array.isArray(n)?n:[n]).map(Da);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(o,e?.popupRedirectResolver)}function lC(s,e,n){const o=El(s);qt(/^https?:\/\//.test(e),o,"invalid-emulator-scheme");const h=!1,g=ew(e),{host:x,port:T}=cC(e),b=T===null?"":`:${T}`,w={url:`${g}//${x}${b}/`},C=Object.freeze({host:x,port:T,protocol:g.replace(":",""),options:Object.freeze({disableWarnings:h})});if(!o._canInitEmulator){qt(o.config.emulator&&o.emulatorConfig,o,"emulator-config-failed"),qt(hl(w,o.config.emulator)&&hl(C,o.emulatorConfig),o,"emulator-config-failed");return}o.config.emulator=w,o.emulatorConfig=C,o.settings.appVerificationDisabledForTesting=!0,Bo(x)?(og(`${g}//${x}${b}`),lg("Auth",!0)):uC()}function ew(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function cC(s){const e=ew(s),n=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!n)return{host:"",port:null};const o=n[2].split("@").pop()||"",h=/^(\[[^\]]+\])(:|$)/.exec(o);if(h){const g=h[1];return{host:g,port:j2(o.substr(g.length+1))}}else{const[g,x]=o.split(":");return{host:g,port:j2(x)}}}function j2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function uC(){function s(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class pg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Oa("not implemented")}_getIdTokenResponse(e){return Oa("not implemented")}_linkToIdToken(e,n){return Oa("not implemented")}_getReauthenticationResolver(e){return Oa("not implemented")}}async function hC(s,e){return ra(s,"POST","/v1/accounts:update",e)}async function dC(s,e){return ra(s,"POST","/v1/accounts:signUp",e)}async function fC(s,e){return Pu(s,"POST","/v1/accounts:signInWithPassword",Fa(s,e))}async function gC(s,e){return ra(s,"POST","/v1/accounts:sendOobCode",Fa(s,e))}async function mC(s,e){return gC(s,e)}async function pC(s,e){return Pu(s,"POST","/v1/accounts:signInWithEmailLink",Fa(s,e))}async function yC(s,e){return Pu(s,"POST","/v1/accounts:signInWithEmailLink",Fa(s,e))}class vu extends pg{constructor(e,n,o,h=null){super("password",o),this._email=e,this._password=n,this._tenantId=h}static _fromEmailAndPassword(e,n){return new vu(e,n,"password")}static _fromEmailAndCode(e,n,o=null){return new vu(e,n,"emailLink",o)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return P1(e,n,"signInWithPassword",fC);case"emailLink":return pC(e,{email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const o={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return P1(e,o,"signUpPassword",dC);case"emailLink":return yC(e,{idToken:n,email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function oc(s,e){return Pu(s,"POST","/v1/accounts:signInWithIdp",Fa(s,e))}const xC="http://localhost";class fl extends pg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new fl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ks("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:o,signInMethod:h,...g}=n;if(!o||!h)return null;const x=new fl(o,h);return x.idToken=g.idToken||void 0,x.accessToken=g.accessToken||void 0,x.secret=g.secret,x.nonce=g.nonce,x.pendingToken=g.pendingToken||null,x}_getIdTokenResponse(e){const n=this.buildRequest();return oc(e,n)}_linkToIdToken(e,n){const o=this.buildRequest();return o.idToken=n,oc(e,o)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,oc(e,n)}buildRequest(){const e={requestUri:xC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ku(n)}return e}}function EC(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function wC(s){const e=cu(uu(s)).link,n=e?cu(uu(e)).deep_link_id:null,o=cu(uu(s)).deep_link_id;return(o?cu(uu(o)).link:null)||o||n||e||s}class yg{constructor(e){const n=cu(uu(e)),o=n.apiKey??null,h=n.oobCode??null,g=EC(n.mode??null);qt(o&&h&&g,"argument-error"),this.apiKey=o,this.operation=g,this.code=h,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=wC(e);try{return new yg(n)}catch{return null}}}class wl{constructor(){this.providerId=wl.PROVIDER_ID}static credential(e,n){return vu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const o=yg.parseLink(n);return qt(o,"argument-error"),vu._fromEmailAndCode(e,o.code,o.tenantId)}}wl.PROVIDER_ID="password";wl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";wl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class tw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Bu extends tw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class wo extends Bu{constructor(){super("facebook.com")}static credential(e){return fl._fromParams({providerId:wo.PROVIDER_ID,signInMethod:wo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wo.credentialFromTaggedObject(e)}static credentialFromError(e){return wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wo.credential(e.oauthAccessToken)}catch{return null}}}wo.FACEBOOK_SIGN_IN_METHOD="facebook.com";wo.PROVIDER_ID="facebook.com";class _o extends Bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return fl._fromParams({providerId:_o.PROVIDER_ID,signInMethod:_o.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return _o.credentialFromTaggedObject(e)}static credentialFromError(e){return _o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:o}=e;if(!n&&!o)return null;try{return _o.credential(n,o)}catch{return null}}}_o.GOOGLE_SIGN_IN_METHOD="google.com";_o.PROVIDER_ID="google.com";class Ao extends Bu{constructor(){super("github.com")}static credential(e){return fl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ao.credential(e.oauthAccessToken)}catch{return null}}}Ao.GITHUB_SIGN_IN_METHOD="github.com";Ao.PROVIDER_ID="github.com";class bo extends Bu{constructor(){super("twitter.com")}static credential(e,n){return fl._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:o}=e;if(!n||!o)return null;try{return bo.credential(n,o)}catch{return null}}}bo.TWITTER_SIGN_IN_METHOD="twitter.com";bo.PROVIDER_ID="twitter.com";async function _C(s,e){return Pu(s,"POST","/v1/accounts:signUp",Fa(s,e))}class gl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,o,h=!1){const g=await Ms._fromIdTokenResponse(e,o,h),x=z2(o);return new gl({user:g,providerId:x,_tokenResponse:o,operationType:n})}static async _forOperation(e,n,o){await e._updateTokensIfNecessary(o,!0);const h=z2(o);return new gl({user:e,providerId:h,_tokenResponse:o,operationType:n})}}function z2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class vd extends na{constructor(e,n,o,h){super(n.code,n.message),this.operationType=o,this.user=h,Object.setPrototypeOf(this,vd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:o}}static _fromErrorAndOperation(e,n,o,h){return new vd(e,n,o,h)}}function nw(s,e,n,o){return(e==="reauthenticate"?n._getReauthenticationResolver(s):n._getIdTokenResponse(s)).catch(g=>{throw g.code==="auth/multi-factor-auth-required"?vd._fromErrorAndOperation(s,g,e,o):g})}async function AC(s,e,n=!1){const o=await cc(s,e._linkToIdToken(s.auth,await s.getIdToken()),n);return gl._forOperation(s,"link",o)}async function rw(s,e,n=!1){const{auth:o}=s;if(cs(o.app))return Promise.reject(Ma(o));const h="reauthenticate";try{const g=await cc(s,nw(o,h,e,s),n);qt(g.idToken,o,"internal-error");const x=gg(g.idToken);qt(x,o,"internal-error");const{sub:T}=x;return qt(s.uid===T,o,"user-mismatch"),gl._forOperation(s,h,g)}catch(g){throw g?.code==="auth/user-not-found"&&ks(o,"user-mismatch"),g}}async function iw(s,e,n=!1){if(cs(s.app))return Promise.reject(Ma(s));const o="signIn",h=await nw(s,o,e),g=await gl._fromIdTokenResponse(s,o,h);return n||await s._updateCurrentUser(g.user),g}async function bC(s,e){return iw(El(s),e)}async function vC(s,e){return rw(sr(s),e)}async function sw(s){const e=El(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function cd(s,e,n){if(cs(s.app))return Promise.reject(Ma(s));const o=El(s),x=await P1(o,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_C).catch(b=>{throw b.code==="auth/password-does-not-meet-requirements"&&sw(s),b}),T=await gl._fromIdTokenResponse(o,"signIn",x);return await o._updateCurrentUser(T.user),T}function TC(s,e,n){return cs(s.app)?Promise.reject(Ma(s)):bC(sr(s),wl.credential(e,n)).catch(async o=>{throw o.code==="auth/password-does-not-meet-requirements"&&sw(s),o})}async function H2(s,e,n){const o=sr(s),g={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await s.getIdToken(),newEmail:e},{email:x}=await mC(o.auth,g);x!==s.email&&await s.reload()}function CC(s,e){return SC(sr(s),null,e)}async function SC(s,e,n){const{auth:o}=s,g={idToken:await s.getIdToken(),returnSecureToken:!0};n&&(g.password=n);const x=await cc(s,hC(o,g));await s._updateTokensIfNecessary(x,!0)}function IC(s,e,n,o){return sr(s).onIdTokenChanged(e,n,o)}function RC(s,e,n){return sr(s).beforeAuthStateChanged(e,n)}function NC(s,e,n,o){return sr(s).onAuthStateChanged(e,n,o)}function OC(s){return sr(s).signOut()}const Td="__sak";class aw{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Td,"1"),this.storage.removeItem(Td),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const DC=1e3,MC=10;class ow extends aw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=QE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const o=this.storage.getItem(n),h=this.localCache[n];o!==h&&e(n,h,o)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((x,T,b)=>{this.notifyListeners(x,b)});return}const o=e.key;n?this.detachListener():this.stopPolling();const h=()=>{const x=this.storage.getItem(o);!n&&this.localCache[o]===x||this.notifyListeners(o,x)},g=this.storage.getItem(o);XT()&&g!==e.newValue&&e.newValue!==e.oldValue?setTimeout(h,MC):h()}notifyListeners(e,n){this.localCache[e]=n;const o=this.listeners[e];if(o)for(const h of Array.from(o))h(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,o)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:o}),!0)})},DC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ow.type="LOCAL";const kC=ow;class lw extends aw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}lw.type="SESSION";const cw=lw;function LC(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Qd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(h=>h.isListeningto(e));if(n)return n;const o=new Qd(e);return this.receivers.push(o),o}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:o,eventType:h,data:g}=n.data,x=this.handlersMap[h];if(!x?.size)return;n.ports[0].postMessage({status:"ack",eventId:o,eventType:h});const T=Array.from(x).map(async w=>w(n.origin,g)),b=await LC(T);n.ports[0].postMessage({status:"done",eventId:o,eventType:h,response:b})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qd.receivers=[];function xg(s="",e=10){let n="";for(let o=0;o<e;o++)n+=Math.floor(Math.random()*10);return s+n}class PC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,o=50){const h=typeof MessageChannel<"u"?new MessageChannel:null;if(!h)throw new Error("connection_unavailable");let g,x;return new Promise((T,b)=>{const w=xg("",20);h.port1.start();const C=setTimeout(()=>{b(new Error("unsupported_event"))},o);x={messageChannel:h,onMessage(N){const P=N;if(P.data.eventId===w)switch(P.data.status){case"ack":clearTimeout(C),g=setTimeout(()=>{b(new Error("timeout"))},3e3);break;case"done":clearTimeout(g),T(P.data.response);break;default:clearTimeout(C),clearTimeout(g),b(new Error("invalid_response"));break}}},this.handlers.add(x),h.port1.addEventListener("message",x.onMessage),this.target.postMessage({eventType:e,eventId:w,data:n},[h.port2])}).finally(()=>{x&&this.removeMessageHandler(x)})}}function Ks(){return window}function BC(s){Ks().location.href=s}function uw(){return typeof Ks().WorkerGlobalScope<"u"&&typeof Ks().importScripts=="function"}async function VC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function UC(){return navigator?.serviceWorker?.controller||null}function FC(){return uw()?self:null}const hw="firebaseLocalStorageDb",jC=1,Cd="firebaseLocalStorage",dw="fbase_key";class Vu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Zd(s,e){return s.transaction([Cd],e?"readwrite":"readonly").objectStore(Cd)}function zC(){const s=indexedDB.deleteDatabase(hw);return new Vu(s).toPromise()}function B1(){const s=indexedDB.open(hw,jC);return new Promise((e,n)=>{s.addEventListener("error",()=>{n(s.error)}),s.addEventListener("upgradeneeded",()=>{const o=s.result;try{o.createObjectStore(Cd,{keyPath:dw})}catch(h){n(h)}}),s.addEventListener("success",async()=>{const o=s.result;o.objectStoreNames.contains(Cd)?e(o):(o.close(),await zC(),e(await B1()))})})}async function G2(s,e,n){const o=Zd(s,!0).put({[dw]:e,value:n});return new Vu(o).toPromise()}async function HC(s,e){const n=Zd(s,!1).get(e),o=await new Vu(n).toPromise();return o===void 0?null:o.value}function q2(s,e){const n=Zd(s,!0).delete(e);return new Vu(n).toPromise()}const GC=800,qC=3;class fw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await B1(),this.db)}async _withRetries(e){let n=0;for(;;)try{const o=await this._openDb();return await e(o)}catch(o){if(n++>qC)throw o;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return uw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qd._getInstance(FC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await VC(),!this.activeServiceWorker)return;this.sender=new PC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||UC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await B1();return await G2(e,Td,"1"),await q2(e,Td),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(o=>G2(o,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(o=>HC(o,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>q2(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(h=>{const g=Zd(h,!1).getAll();return new Vu(g).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],o=new Set;if(e.length!==0)for(const{fbase_key:h,value:g}of e)o.add(h),JSON.stringify(this.localCache[h])!==JSON.stringify(g)&&(this.notifyListeners(h,g),n.push(h));for(const h of Object.keys(this.localCache))this.localCache[h]&&!o.has(h)&&(this.notifyListeners(h,null),n.push(h));return n}notifyListeners(e,n){this.localCache[e]=n;const o=this.listeners[e];if(o)for(const h of Array.from(o))h(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),GC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fw.type="LOCAL";const XC=fw;new Lu(3e4,6e4);function YC(s,e){return e?Da(e):(qt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Eg extends pg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return oc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return oc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return oc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function WC(s){return iw(s.auth,new Eg(s),s.bypassAuthState)}function KC(s){const{auth:e,user:n}=s;return qt(n,e,"internal-error"),rw(n,new Eg(s),s.bypassAuthState)}async function QC(s){const{auth:e,user:n}=s;return qt(n,e,"internal-error"),AC(n,new Eg(s),s.bypassAuthState)}class gw{constructor(e,n,o,h,g=!1){this.auth=e,this.resolver=o,this.user=h,this.bypassAuthState=g,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(o){this.reject(o)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:o,postBody:h,tenantId:g,error:x,type:T}=e;if(x){this.reject(x);return}const b={auth:this.auth,requestUri:n,sessionId:o,tenantId:g||void 0,postBody:h||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(T)(b))}catch(w){this.reject(w)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return WC;case"linkViaPopup":case"linkViaRedirect":return QC;case"reauthViaPopup":case"reauthViaRedirect":return KC;default:ks(this.auth,"internal-error")}}resolve(e){Pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ZC=new Lu(2e3,1e4);class nc extends gw{constructor(e,n,o,h,g){super(e,n,h,g),this.provider=o,this.authWindow=null,this.pollId=null,nc.currentPopupAction&&nc.currentPopupAction.cancel(),nc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qt(e,this.auth,"internal-error"),e}async onExecution(){Pa(this.filter.length===1,"Popup operations only handle one event");const e=xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ws(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ws(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ws(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ZC.get())};e()}}nc.currentPopupAction=null;const JC="pendingRedirect",ud=new Map;class $C extends gw{constructor(e,n,o=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,o),this.eventId=null}async execute(){let e=ud.get(this.auth._key());if(!e){try{const o=await e3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(o)}catch(n){e=()=>Promise.reject(n)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function e3(s,e){const n=r3(e),o=n3(s);if(!await o._isAvailable())return!1;const h=await o._get(n)==="true";return await o._remove(n),h}function t3(s,e){ud.set(s._key(),e)}function n3(s){return Da(s._redirectPersistence)}function r3(s){return ld(JC,s.config.apiKey,s.name)}async function i3(s,e,n=!1){if(cs(s.app))return Promise.reject(Ma(s));const o=El(s),h=YC(o,e),x=await new $C(o,h,n).execute();return x&&!n&&(delete x.user._redirectEventId,await o._persistUserIfCurrent(x.user),await o._setRedirectUser(null,e)),x}const s3=600*1e3;class a3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(o=>{this.isEventForConsumer(e,o)&&(n=!0,this.sendToConsumer(e,o),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!o3(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!mw(e)){const o=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Ws(this.auth,o))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const o=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&o}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=s3&&this.cachedEventUids.clear(),this.cachedEventUids.has(X2(e))}saveEventToCache(e){this.cachedEventUids.add(X2(e)),this.lastProcessedEventTime=Date.now()}}function X2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function mw({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function o3(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mw(s);default:return!1}}async function l3(s,e={}){return ra(s,"GET","/v1/projects",e)}const c3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u3=/^https?/;async function h3(s){if(s.config.emulator)return;const{authorizedDomains:e}=await l3(s);for(const n of e)try{if(d3(n))return}catch{}ks(s,"unauthorized-domain")}function d3(s){const e=k1(),{protocol:n,hostname:o}=new URL(e);if(s.startsWith("chrome-extension://")){const x=new URL(s);return x.hostname===""&&o===""?n==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&x.hostname===o}if(!u3.test(n))return!1;if(c3.test(s))return o===s;const h=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+h+"|"+h+")$","i").test(o)}const f3=new Lu(3e4,6e4);function Y2(){const s=Ks().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let n=0;n<s.CP.length;n++)s.CP[n]=null}}function g3(s){return new Promise((e,n)=>{function o(){Y2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Y2(),n(Ws(s,"network-request-failed"))},timeout:f3.get()})}if(Ks().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ks().gapi?.load)o();else{const h=tC("iframefcb");return Ks()[h]=()=>{gapi.load?o():n(Ws(s,"network-request-failed"))},JE(`${eC()}?onload=${h}`).catch(g=>n(g))}}).catch(e=>{throw hd=null,e})}let hd=null;function m3(s){return hd=hd||g3(s),hd}const p3=new Lu(5e3,15e3),y3="__/auth/iframe",x3="emulator/auth/iframe",E3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},w3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _3(s){const e=s.config;qt(e.authDomain,s,"auth-domain-config-required");const n=e.emulator?fg(e,x3):`https://${s.config.authDomain}/${y3}`,o={apiKey:e.apiKey,appName:s.name,v:yc},h=w3.get(s.config.apiHost);h&&(o.eid=h);const g=s._getFrameworks();return g.length&&(o.fw=g.join(",")),`${n}?${ku(o).slice(1)}`}async function A3(s){const e=await m3(s),n=Ks().gapi;return qt(n,s,"internal-error"),e.open({where:document.body,url:_3(s),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:E3,dontclear:!0},o=>new Promise(async(h,g)=>{await o.restyle({setHideOnLeave:!1});const x=Ws(s,"network-request-failed"),T=Ks().setTimeout(()=>{g(x)},p3.get());function b(){Ks().clearTimeout(T),h(o)}o.ping(b).then(b,()=>{g(x)})}))}const b3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},v3=500,T3=600,C3="_blank",S3="http://localhost";class W2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function I3(s,e,n,o=v3,h=T3){const g=Math.max((window.screen.availHeight-h)/2,0).toString(),x=Math.max((window.screen.availWidth-o)/2,0).toString();let T="";const b={...b3,width:o.toString(),height:h.toString(),top:g,left:x},w=vi().toLowerCase();n&&(T=qE(w)?C3:n),HE(w)&&(e=e||S3,b.scrollbars="yes");const C=Object.entries(b).reduce((P,[B,ee])=>`${P}${B}=${ee},`,"");if(qT(w)&&T!=="_self")return R3(e||"",T),new W2(null);const N=window.open(e||"",T,C);qt(N,s,"popup-blocked");try{N.focus()}catch{}return new W2(N)}function R3(s,e){const n=document.createElement("a");n.href=s,n.target=e;const o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(o)}const N3="__/auth/handler",O3="emulator/auth/handler",D3=encodeURIComponent("fac");async function K2(s,e,n,o,h,g){qt(s.config.authDomain,s,"auth-domain-config-required"),qt(s.config.apiKey,s,"invalid-api-key");const x={apiKey:s.config.apiKey,appName:s.name,authType:n,redirectUrl:o,v:yc,eventId:h};if(e instanceof tw){e.setDefaultLanguage(s.languageCode),x.providerId=e.providerId||"",hv(e.getCustomParameters())||(x.customParameters=JSON.stringify(e.getCustomParameters()));for(const[C,N]of Object.entries({}))x[C]=N}if(e instanceof Bu){const C=e.getScopes().filter(N=>N!=="");C.length>0&&(x.scopes=C.join(","))}s.tenantId&&(x.tid=s.tenantId);const T=x;for(const C of Object.keys(T))T[C]===void 0&&delete T[C];const b=await s._getAppCheckToken(),w=b?`#${D3}=${encodeURIComponent(b)}`:"";return`${M3(s)}?${ku(T).slice(1)}${w}`}function M3({config:s}){return s.emulator?fg(s,O3):`https://${s.authDomain}/${N3}`}const y1="webStorageSupport";class k3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cw,this._completeRedirectFn=i3,this._overrideRedirectResult=t3}async _openPopup(e,n,o,h){Pa(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const g=await K2(e,n,o,k1(),h);return I3(e,g,xg())}async _openRedirect(e,n,o,h){await this._originValidation(e);const g=await K2(e,n,o,k1(),h);return BC(g),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:h,promise:g}=this.eventManagers[n];return h?Promise.resolve(h):(Pa(g,"If manager is not set, promise should be"),g)}const o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(()=>{delete this.eventManagers[n]}),o}async initAndGetManager(e){const n=await A3(e),o=new a3(e);return n.register("authEvent",h=>(qt(h?.authEvent,e,"invalid-auth-event"),{status:o.onEvent(h.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:o},this.iframes[e._key()]=n,o}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(y1,{type:y1},h=>{const g=h?.[0]?.[y1];g!==void 0&&n(!!g),ks(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=h3(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return QE()||GE()||mg()}}const L3=k3;var Q2="@firebase/auth",Z2="1.11.1";class P3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(o=>{e(o?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function B3(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function V3(s){dl(new No("auth",(e,{options:n})=>{const o=e.getProvider("app").getImmediate(),h=e.getProvider("heartbeat"),g=e.getProvider("app-check-internal"),{apiKey:x,authDomain:T}=o.options;qt(x&&!x.includes(":"),"invalid-api-key",{appName:o.name});const b={apiKey:x,authDomain:T,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZE(s)},w=new ZT(o,h,g,b);return oC(w,n),w},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,o)=>{e.getProvider("auth-internal").initialize()})),dl(new No("auth-internal",e=>{const n=El(e.getProvider("auth").getImmediate());return(o=>new P3(o))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ys(Q2,Z2,B3(s)),Ys(Q2,Z2,"esm2020")}const U3=300,F3=RE("authIdTokenMaxAge")||U3;let J2=null;const j3=s=>async e=>{const n=e&&await e.getIdTokenResult(),o=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(o&&o>F3)return;const h=n?.token;J2!==h&&(J2=h,await fetch(s,{method:h?"POST":"DELETE",headers:h?{Authorization:`Bearer ${h}`}:{}}))};function pw(s=Wd()){const e=Yd(s,"auth");if(e.isInitialized())return e.getImmediate();const n=aC(s,{popupRedirectResolver:L3,persistence:[XC,kC,cw]}),o=RE("authTokenSyncURL");if(o&&typeof isSecureContext=="boolean"&&isSecureContext){const g=new URL(o,location.origin);if(location.origin===g.origin){const x=j3(g.toString());RC(n,x,()=>x(n.currentUser)),IC(n,T=>x(T))}}const h=CE("auth");return h&&lC(n,`http://${h}`),n}function z3(){return document.getElementsByTagName("head")?.[0]??document}JT({loadJS(s){return new Promise((e,n)=>{const o=document.createElement("script");o.setAttribute("src",s),o.onload=e,o.onerror=h=>{const g=Ws("internal-error");g.customData=h,n(g)},o.type="text/javascript",o.charset="UTF-8",z3().appendChild(o)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});V3("Browser");var $2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var So,yw;(function(){var s;function e(F,z){function U(){}U.prototype=z.prototype,F.F=z.prototype,F.prototype=new U,F.prototype.constructor=F,F.D=function(J,X,Y){for(var G=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)G[ot-2]=arguments[ot];return z.prototype[X].apply(J,G)}}function n(){this.blockSize=-1}function o(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(o,n),o.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function h(F,z,U){U||(U=0);const J=Array(16);if(typeof z=="string")for(var X=0;X<16;++X)J[X]=z.charCodeAt(U++)|z.charCodeAt(U++)<<8|z.charCodeAt(U++)<<16|z.charCodeAt(U++)<<24;else for(X=0;X<16;++X)J[X]=z[U++]|z[U++]<<8|z[U++]<<16|z[U++]<<24;z=F.g[0],U=F.g[1],X=F.g[2];let Y=F.g[3],G;G=z+(Y^U&(X^Y))+J[0]+3614090360&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[1]+3905402710&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[2]+606105819&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[3]+3250441966&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(Y^U&(X^Y))+J[4]+4118548399&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[5]+1200080426&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[6]+2821735955&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[7]+4249261313&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(Y^U&(X^Y))+J[8]+1770035416&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[9]+2336552879&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[10]+4294925233&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[11]+2304563134&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(Y^U&(X^Y))+J[12]+1804603682&4294967295,z=U+(G<<7&4294967295|G>>>25),G=Y+(X^z&(U^X))+J[13]+4254626195&4294967295,Y=z+(G<<12&4294967295|G>>>20),G=X+(U^Y&(z^U))+J[14]+2792965006&4294967295,X=Y+(G<<17&4294967295|G>>>15),G=U+(z^X&(Y^z))+J[15]+1236535329&4294967295,U=X+(G<<22&4294967295|G>>>10),G=z+(X^Y&(U^X))+J[1]+4129170786&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[6]+3225465664&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[11]+643717713&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[0]+3921069994&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(X^Y&(U^X))+J[5]+3593408605&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[10]+38016083&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[15]+3634488961&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[4]+3889429448&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(X^Y&(U^X))+J[9]+568446438&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[14]+3275163606&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[3]+4107603335&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[8]+1163531501&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(X^Y&(U^X))+J[13]+2850285829&4294967295,z=U+(G<<5&4294967295|G>>>27),G=Y+(U^X&(z^U))+J[2]+4243563512&4294967295,Y=z+(G<<9&4294967295|G>>>23),G=X+(z^U&(Y^z))+J[7]+1735328473&4294967295,X=Y+(G<<14&4294967295|G>>>18),G=U+(Y^z&(X^Y))+J[12]+2368359562&4294967295,U=X+(G<<20&4294967295|G>>>12),G=z+(U^X^Y)+J[5]+4294588738&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[8]+2272392833&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[11]+1839030562&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[14]+4259657740&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(U^X^Y)+J[1]+2763975236&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[4]+1272893353&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[7]+4139469664&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[10]+3200236656&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(U^X^Y)+J[13]+681279174&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[0]+3936430074&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[3]+3572445317&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[6]+76029189&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(U^X^Y)+J[9]+3654602809&4294967295,z=U+(G<<4&4294967295|G>>>28),G=Y+(z^U^X)+J[12]+3873151461&4294967295,Y=z+(G<<11&4294967295|G>>>21),G=X+(Y^z^U)+J[15]+530742520&4294967295,X=Y+(G<<16&4294967295|G>>>16),G=U+(X^Y^z)+J[2]+3299628645&4294967295,U=X+(G<<23&4294967295|G>>>9),G=z+(X^(U|~Y))+J[0]+4096336452&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[7]+1126891415&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[14]+2878612391&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[5]+4237533241&4294967295,U=X+(G<<21&4294967295|G>>>11),G=z+(X^(U|~Y))+J[12]+1700485571&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[3]+2399980690&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[10]+4293915773&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[1]+2240044497&4294967295,U=X+(G<<21&4294967295|G>>>11),G=z+(X^(U|~Y))+J[8]+1873313359&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[15]+4264355552&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[6]+2734768916&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[13]+1309151649&4294967295,U=X+(G<<21&4294967295|G>>>11),G=z+(X^(U|~Y))+J[4]+4149444226&4294967295,z=U+(G<<6&4294967295|G>>>26),G=Y+(U^(z|~X))+J[11]+3174756917&4294967295,Y=z+(G<<10&4294967295|G>>>22),G=X+(z^(Y|~U))+J[2]+718787259&4294967295,X=Y+(G<<15&4294967295|G>>>17),G=U+(Y^(X|~z))+J[9]+3951481745&4294967295,F.g[0]=F.g[0]+z&4294967295,F.g[1]=F.g[1]+(X+(G<<21&4294967295|G>>>11))&4294967295,F.g[2]=F.g[2]+X&4294967295,F.g[3]=F.g[3]+Y&4294967295}o.prototype.v=function(F,z){z===void 0&&(z=F.length);const U=z-this.blockSize,J=this.C;let X=this.h,Y=0;for(;Y<z;){if(X==0)for(;Y<=U;)h(this,F,Y),Y+=this.blockSize;if(typeof F=="string"){for(;Y<z;)if(J[X++]=F.charCodeAt(Y++),X==this.blockSize){h(this,J),X=0;break}}else for(;Y<z;)if(J[X++]=F[Y++],X==this.blockSize){h(this,J),X=0;break}}this.h=X,this.o+=z},o.prototype.A=function(){var F=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);F[0]=128;for(var z=1;z<F.length-8;++z)F[z]=0;z=this.o*8;for(var U=F.length-8;U<F.length;++U)F[U]=z&255,z/=256;for(this.v(F),F=Array(16),z=0,U=0;U<4;++U)for(let J=0;J<32;J+=8)F[z++]=this.g[U]>>>J&255;return F};function g(F,z){var U=T;return Object.prototype.hasOwnProperty.call(U,F)?U[F]:U[F]=z(F)}function x(F,z){this.h=z;const U=[];let J=!0;for(let X=F.length-1;X>=0;X--){const Y=F[X]|0;J&&Y==z||(U[X]=Y,J=!1)}this.g=U}var T={};function b(F){return-128<=F&&F<128?g(F,function(z){return new x([z|0],z<0?-1:0)}):new x([F|0],F<0?-1:0)}function w(F){if(isNaN(F)||!isFinite(F))return N;if(F<0)return ae(w(-F));const z=[];let U=1;for(let J=0;F>=U;J++)z[J]=F/U|0,U*=4294967296;return new x(z,0)}function C(F,z){if(F.length==0)throw Error("number format error: empty string");if(z=z||10,z<2||36<z)throw Error("radix out of range: "+z);if(F.charAt(0)=="-")return ae(C(F.substring(1),z));if(F.indexOf("-")>=0)throw Error('number format error: interior "-" character');const U=w(Math.pow(z,8));let J=N;for(let Y=0;Y<F.length;Y+=8){var X=Math.min(8,F.length-Y);const G=parseInt(F.substring(Y,Y+X),z);X<8?(X=w(Math.pow(z,X)),J=J.j(X).add(w(G))):(J=J.j(U),J=J.add(w(G)))}return J}var N=b(0),P=b(1),B=b(16777216);s=x.prototype,s.m=function(){if(ne(this))return-ae(this).m();let F=0,z=1;for(let U=0;U<this.g.length;U++){const J=this.i(U);F+=(J>=0?J:4294967296+J)*z,z*=4294967296}return F},s.toString=function(F){if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(ee(this))return"0";if(ne(this))return"-"+ae(this).toString(F);const z=w(Math.pow(F,6));var U=this;let J="";for(;;){const X=Ge(U,z).g;U=tt(U,X.j(z));let Y=((U.g.length>0?U.g[0]:U.h)>>>0).toString(F);if(U=X,ee(U))return Y+J;for(;Y.length<6;)Y="0"+Y;J=Y+J}},s.i=function(F){return F<0?0:F<this.g.length?this.g[F]:this.h};function ee(F){if(F.h!=0)return!1;for(let z=0;z<F.g.length;z++)if(F.g[z]!=0)return!1;return!0}function ne(F){return F.h==-1}s.l=function(F){return F=tt(this,F),ne(F)?-1:ee(F)?0:1};function ae(F){const z=F.g.length,U=[];for(let J=0;J<z;J++)U[J]=~F.g[J];return new x(U,~F.h).add(P)}s.abs=function(){return ne(this)?ae(this):this},s.add=function(F){const z=Math.max(this.g.length,F.g.length),U=[];let J=0;for(let X=0;X<=z;X++){let Y=J+(this.i(X)&65535)+(F.i(X)&65535),G=(Y>>>16)+(this.i(X)>>>16)+(F.i(X)>>>16);J=G>>>16,Y&=65535,G&=65535,U[X]=G<<16|Y}return new x(U,U[U.length-1]&-2147483648?-1:0)};function tt(F,z){return F.add(ae(z))}s.j=function(F){if(ee(this)||ee(F))return N;if(ne(this))return ne(F)?ae(this).j(ae(F)):ae(ae(this).j(F));if(ne(F))return ae(this.j(ae(F)));if(this.l(B)<0&&F.l(B)<0)return w(this.m()*F.m());const z=this.g.length+F.g.length,U=[];for(var J=0;J<2*z;J++)U[J]=0;for(J=0;J<this.g.length;J++)for(let X=0;X<F.g.length;X++){const Y=this.i(J)>>>16,G=this.i(J)&65535,ot=F.i(X)>>>16,oe=F.i(X)&65535;U[2*J+2*X]+=G*oe,ze(U,2*J+2*X),U[2*J+2*X+1]+=Y*oe,ze(U,2*J+2*X+1),U[2*J+2*X+1]+=G*ot,ze(U,2*J+2*X+1),U[2*J+2*X+2]+=Y*ot,ze(U,2*J+2*X+2)}for(F=0;F<z;F++)U[F]=U[2*F+1]<<16|U[2*F];for(F=z;F<2*z;F++)U[F]=0;return new x(U,0)};function ze(F,z){for(;(F[z]&65535)!=F[z];)F[z+1]+=F[z]>>>16,F[z]&=65535,z++}function fe(F,z){this.g=F,this.h=z}function Ge(F,z){if(ee(z))throw Error("division by zero");if(ee(F))return new fe(N,N);if(ne(F))return z=Ge(ae(F),z),new fe(ae(z.g),ae(z.h));if(ne(z))return z=Ge(F,ae(z)),new fe(ae(z.g),z.h);if(F.g.length>30){if(ne(F)||ne(z))throw Error("slowDivide_ only works with positive integers.");for(var U=P,J=z;J.l(F)<=0;)U=gt(U),J=gt(J);var X=Qe(U,1),Y=Qe(J,1);for(J=Qe(J,2),U=Qe(U,2);!ee(J);){var G=Y.add(J);G.l(F)<=0&&(X=X.add(U),Y=G),J=Qe(J,1),U=Qe(U,1)}return z=tt(F,X.j(z)),new fe(X,z)}for(X=N;F.l(z)>=0;){for(U=Math.max(1,Math.floor(F.m()/z.m())),J=Math.ceil(Math.log(U)/Math.LN2),J=J<=48?1:Math.pow(2,J-48),Y=w(U),G=Y.j(z);ne(G)||G.l(F)>0;)U-=J,Y=w(U),G=Y.j(z);ee(Y)&&(Y=P),X=X.add(Y),F=tt(F,G)}return new fe(X,F)}s.B=function(F){return Ge(this,F).h},s.and=function(F){const z=Math.max(this.g.length,F.g.length),U=[];for(let J=0;J<z;J++)U[J]=this.i(J)&F.i(J);return new x(U,this.h&F.h)},s.or=function(F){const z=Math.max(this.g.length,F.g.length),U=[];for(let J=0;J<z;J++)U[J]=this.i(J)|F.i(J);return new x(U,this.h|F.h)},s.xor=function(F){const z=Math.max(this.g.length,F.g.length),U=[];for(let J=0;J<z;J++)U[J]=this.i(J)^F.i(J);return new x(U,this.h^F.h)};function gt(F){const z=F.g.length+1,U=[];for(let J=0;J<z;J++)U[J]=F.i(J)<<1|F.i(J-1)>>>31;return new x(U,F.h)}function Qe(F,z){const U=z>>5;z%=32;const J=F.g.length-U,X=[];for(let Y=0;Y<J;Y++)X[Y]=z>0?F.i(Y+U)>>>z|F.i(Y+U+1)<<32-z:F.i(Y+U);return new x(X,F.h)}o.prototype.digest=o.prototype.A,o.prototype.reset=o.prototype.u,o.prototype.update=o.prototype.v,yw=o,x.prototype.add=x.prototype.add,x.prototype.multiply=x.prototype.j,x.prototype.modulo=x.prototype.B,x.prototype.compare=x.prototype.l,x.prototype.toNumber=x.prototype.m,x.prototype.toString=x.prototype.toString,x.prototype.getBits=x.prototype.i,x.fromNumber=w,x.fromString=C,So=x}).apply(typeof $2<"u"?$2:typeof self<"u"?self:typeof window<"u"?window:{});var td=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var xw,hu,Ew,dd,V1,ww,_w,Aw;(function(){var s,e=Object.defineProperty;function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof td=="object"&&td];for(var S=0;S<p.length;++S){var D=p[S];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var o=n(this);function h(p,S){if(S)e:{var D=o;p=p.split(".");for(var j=0;j<p.length-1;j++){var ce=p[j];if(!(ce in D))break e;D=D[ce]}p=p[p.length-1],j=D[p],S=S(j),S!=j&&S!=null&&e(D,p,{configurable:!0,writable:!0,value:S})}}h("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),h("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),h("Object.entries",function(p){return p||function(S){var D=[],j;for(j in S)Object.prototype.hasOwnProperty.call(S,j)&&D.push([j,S[j]]);return D}});var g=g||{},x=this||self;function T(p){var S=typeof p;return S=="object"&&p!=null||S=="function"}function b(p,S,D){return p.call.apply(p.bind,arguments)}function w(p,S,D){return w=b,w.apply(null,arguments)}function C(p,S){var D=Array.prototype.slice.call(arguments,1);return function(){var j=D.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function N(p,S){function D(){}D.prototype=S.prototype,p.Z=S.prototype,p.prototype=new D,p.prototype.constructor=p,p.Ob=function(j,ce,Ae){for(var $e=Array(arguments.length-2),Yt=2;Yt<arguments.length;Yt++)$e[Yt-2]=arguments[Yt];return S.prototype[ce].apply(j,$e)}}var P=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function B(p){const S=p.length;if(S>0){const D=Array(S);for(let j=0;j<S;j++)D[j]=p[j];return D}return[]}function ee(p,S){for(let j=1;j<arguments.length;j++){const ce=arguments[j];var D=typeof ce;if(D=D!="object"?D:ce?Array.isArray(ce)?"array":D:"null",D=="array"||D=="object"&&typeof ce.length=="number"){D=p.length||0;const Ae=ce.length||0;p.length=D+Ae;for(let $e=0;$e<Ae;$e++)p[D+$e]=ce[$e]}else p.push(ce)}}class ne{constructor(S,D){this.i=S,this.j=D,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function ae(p){x.setTimeout(()=>{throw p},0)}function tt(){var p=F;let S=null;return p.g&&(S=p.g,p.g=p.g.next,p.g||(p.h=null),S.next=null),S}class ze{constructor(){this.h=this.g=null}add(S,D){const j=fe.get();j.set(S,D),this.h?this.h.next=j:this.g=j,this.h=j}}var fe=new ne(()=>new Ge,p=>p.reset());class Ge{constructor(){this.next=this.g=this.h=null}set(S,D){this.h=S,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let gt,Qe=!1,F=new ze,z=()=>{const p=Promise.resolve(void 0);gt=()=>{p.then(U)}};function U(){for(var p;p=tt();){try{p.h.call(p.g)}catch(D){ae(D)}var S=fe;S.j(p),S.h<100&&(S.h++,p.next=S.g,S.g=p)}Qe=!1}function J(){this.u=this.u,this.C=this.C}J.prototype.u=!1,J.prototype.dispose=function(){this.u||(this.u=!0,this.N())},J.prototype[Symbol.dispose]=function(){this.dispose()},J.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(p,S){this.type=p,this.g=this.target=S,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var Y=(function(){if(!x.addEventListener||!Object.defineProperty)return!1;var p=!1,S=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const D=()=>{};x.addEventListener("test",D,S),x.removeEventListener("test",D,S)}catch{}return p})();function G(p){return/^[\s\xa0]*$/.test(p)}function ot(p,S){X.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,S)}N(ot,X),ot.prototype.init=function(p,S){const D=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=S,S=p.relatedTarget,S||(D=="mouseover"?S=p.fromElement:D=="mouseout"&&(S=p.toElement)),this.relatedTarget=S,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&ot.Z.h.call(this)},ot.prototype.h=function(){ot.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var oe="closure_listenable_"+(Math.random()*1e6|0),le=0;function xe(p,S,D,j,ce){this.listener=p,this.proxy=null,this.src=S,this.type=D,this.capture=!!j,this.ha=ce,this.key=++le,this.da=this.fa=!1}function We(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function qe(p,S,D){for(const j in p)S.call(D,p[j],j,p)}function ut(p,S){for(const D in p)S.call(void 0,p[D],D,p)}function K(p){const S={};for(const D in p)S[D]=p[D];return S}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ve(p,S){let D,j;for(let ce=1;ce<arguments.length;ce++){j=arguments[ce];for(D in j)p[D]=j[D];for(let Ae=0;Ae<se.length;Ae++)D=se[Ae],Object.prototype.hasOwnProperty.call(j,D)&&(p[D]=j[D])}}function Ce(p){this.src=p,this.g={},this.h=0}Ce.prototype.add=function(p,S,D,j,ce){const Ae=p.toString();p=this.g[Ae],p||(p=this.g[Ae]=[],this.h++);const $e=me(p,S,j,ce);return $e>-1?(S=p[$e],D||(S.fa=!1)):(S=new xe(S,this.src,Ae,!!j,ce),S.fa=D,p.push(S)),S};function Le(p,S){const D=S.type;if(D in p.g){var j=p.g[D],ce=Array.prototype.indexOf.call(j,S,void 0),Ae;(Ae=ce>=0)&&Array.prototype.splice.call(j,ce,1),Ae&&(We(S),p.g[D].length==0&&(delete p.g[D],p.h--))}}function me(p,S,D,j){for(let ce=0;ce<p.length;++ce){const Ae=p[ce];if(!Ae.da&&Ae.listener==S&&Ae.capture==!!D&&Ae.ha==j)return ce}return-1}var rt="closure_lm_"+(Math.random()*1e6|0),mt={};function Ct(p,S,D,j,ce){if(Array.isArray(S)){for(let Ae=0;Ae<S.length;Ae++)Ct(p,S[Ae],D,j,ce);return null}return D=Ne(D),p&&p[oe]?p.J(S,D,T(j)?!!j.capture:!1,ce):sn(p,S,D,!1,j,ce)}function sn(p,S,D,j,ce,Ae){if(!S)throw Error("Invalid event type");const $e=T(ce)?!!ce.capture:!!ce;let Yt=Me(p);if(Yt||(p[rt]=Yt=new Ce(p)),D=Yt.add(S,D,j,$e,Ae),D.proxy)return D;if(j=Qt(),D.proxy=j,j.src=p,j.listener=D,p.addEventListener)Y||(ce=$e),ce===void 0&&(ce=!1),p.addEventListener(S.toString(),j,ce);else if(p.attachEvent)p.attachEvent(gn(S.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return D}function Qt(){function p(D){return S.call(p.src,p.listener,D)}const S=On;return p}function En(p,S,D,j,ce){if(Array.isArray(S))for(var Ae=0;Ae<S.length;Ae++)En(p,S[Ae],D,j,ce);else j=T(j)?!!j.capture:!!j,D=Ne(D),p&&p[oe]?(p=p.i,Ae=String(S).toString(),Ae in p.g&&(S=p.g[Ae],D=me(S,D,j,ce),D>-1&&(We(S[D]),Array.prototype.splice.call(S,D,1),S.length==0&&(delete p.g[Ae],p.h--)))):p&&(p=Me(p))&&(S=p.g[S.toString()],p=-1,S&&(p=me(S,D,j,ce)),(D=p>-1?S[p]:null)&&Ot(D))}function Ot(p){if(typeof p!="number"&&p&&!p.da){var S=p.src;if(S&&S[oe])Le(S.i,p);else{var D=p.type,j=p.proxy;S.removeEventListener?S.removeEventListener(D,j,p.capture):S.detachEvent?S.detachEvent(gn(D),j):S.addListener&&S.removeListener&&S.removeListener(j),(D=Me(S))?(Le(D,p),D.h==0&&(D.src=null,S[rt]=null)):We(p)}}}function gn(p){return p in mt?mt[p]:mt[p]="on"+p}function On(p,S){if(p.da)p=!0;else{S=new ot(S,this);const D=p.listener,j=p.ha||p.src;p.fa&&Ot(p),p=D.call(j,S)}return p}function Me(p){return p=p[rt],p instanceof Ce?p:null}var ge="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ne(p){return typeof p=="function"?p:(p[ge]||(p[ge]=function(S){return p.handleEvent(S)}),p[ge])}function Ve(){J.call(this),this.i=new Ce(this),this.M=this,this.G=null}N(Ve,J),Ve.prototype[oe]=!0,Ve.prototype.removeEventListener=function(p,S,D,j){En(this,p,S,D,j)};function it(p,S){var D,j=p.G;if(j)for(D=[];j;j=j.G)D.push(j);if(p=p.M,j=S.type||S,typeof S=="string")S=new X(S,p);else if(S instanceof X)S.target=S.target||p;else{var ce=S;S=new X(j,p),ve(S,ce)}ce=!0;let Ae,$e;if(D)for($e=D.length-1;$e>=0;$e--)Ae=S.g=D[$e],ce=Ie(Ae,j,!0,S)&&ce;if(Ae=S.g=p,ce=Ie(Ae,j,!0,S)&&ce,ce=Ie(Ae,j,!1,S)&&ce,D)for($e=0;$e<D.length;$e++)Ae=S.g=D[$e],ce=Ie(Ae,j,!1,S)&&ce}Ve.prototype.N=function(){if(Ve.Z.N.call(this),this.i){var p=this.i;for(const S in p.g){const D=p.g[S];for(let j=0;j<D.length;j++)We(D[j]);delete p.g[S],p.h--}}this.G=null},Ve.prototype.J=function(p,S,D,j){return this.i.add(String(p),S,!1,D,j)},Ve.prototype.K=function(p,S,D,j){return this.i.add(String(p),S,!0,D,j)};function Ie(p,S,D,j){if(S=p.i.g[String(S)],!S)return!0;S=S.concat();let ce=!0;for(let Ae=0;Ae<S.length;++Ae){const $e=S[Ae];if($e&&!$e.da&&$e.capture==D){const Yt=$e.listener,yr=$e.ha||$e.src;$e.fa&&Le(p.i,$e),ce=Yt.call(yr,j)!==!1&&ce}}return ce&&!j.defaultPrevented}function Pt(p,S){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=w(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:x.setTimeout(p,S||0)}function et(p){p.g=Pt(()=>{p.g=null,p.i&&(p.i=!1,et(p))},p.l);const S=p.h;p.h=null,p.m.apply(null,S)}class ht extends J{constructor(S,D){super(),this.m=S,this.l=D,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:et(this)}N(){super.N(),this.g&&(x.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Un(p){J.call(this),this.h=p,this.g={}}N(Un,J);var Bt=[];function Kn(p){qe(p.g,function(S,D){this.g.hasOwnProperty(D)&&Ot(S)},p),p.g={}}Un.prototype.N=function(){Un.Z.N.call(this),Kn(this)},Un.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var lr=x.JSON.stringify,cr=x.JSON.parse,Zr=class{stringify(p){return x.JSON.stringify(p,void 0)}parse(p){return x.JSON.parse(p,void 0)}};function Ti(){}function ki(){}var tn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Fe(){X.call(this,"d")}N(Fe,X);function Ht(){X.call(this,"c")}N(Ht,X);var At={},wn=null;function vr(){return wn=wn||new Ve}At.Ia="serverreachability";function Xr(p){X.call(this,At.Ia,p)}N(Xr,X);function Tr(p){const S=vr();it(S,new Xr(S))}At.STAT_EVENT="statevent";function Vt(p,S){X.call(this,At.STAT_EVENT,p),this.stat=S}N(Vt,X);function Zt(p){const S=vr();it(S,new Vt(S,p))}At.Ja="timingevent";function jn(p,S){X.call(this,At.Ja,p),this.size=S}N(jn,X);function Mr(p,S){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){p()},S)}function dt(){this.g=!0}dt.prototype.ua=function(){this.g=!1};function nn(p,S,D,j,ce,Ae){p.info(function(){if(p.g)if(Ae){var $e="",Yt=Ae.split("&");for(let Rn=0;Rn<Yt.length;Rn++){var yr=Yt[Rn].split("=");if(yr.length>1){const rr=yr[0];yr=yr[1];const Ii=rr.split("_");$e=Ii.length>=2&&Ii[1]=="type"?$e+(rr+"="+yr+"&"):$e+(rr+"=redacted&")}}}else $e=null;else $e=Ae;return"XMLHTTP REQ ("+j+") [attempt "+ce+"]: "+S+`
`+D+`
`+$e})}function re(p,S,D,j,ce,Ae,$e){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ce+"]: "+S+`
`+D+`
`+Ae+" "+$e})}function Se(p,S,D,j){p.info(function(){return"XMLHTTP TEXT ("+S+"): "+Xe(p,D)+(j?" "+j:"")})}function je(p,S){p.info(function(){return"TIMEOUT: "+S})}dt.prototype.info=function(){};function Xe(p,S){if(!p.g)return S;if(!S)return null;try{const Ae=JSON.parse(S);if(Ae){for(p=0;p<Ae.length;p++)if(Array.isArray(Ae[p])){var D=Ae[p];if(!(D.length<2)){var j=D[1];if(Array.isArray(j)&&!(j.length<1)){var ce=j[0];if(ce!="noop"&&ce!="stop"&&ce!="close")for(let $e=1;$e<j.length;$e++)j[$e]=""}}}}return lr(Ae)}catch{return S}}var st={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},at;function Gt(){}N(Gt,Ti),Gt.prototype.g=function(){return new XMLHttpRequest},at=new Gt;function Rt(p){return encodeURIComponent(String(p))}function Ut(p){var S=1;p=p.split(":");const D=[];for(;S>0&&p.length;)D.push(p.shift()),S--;return p.length&&D.push(p.join(":")),D}function Oe(p,S,D,j){this.j=p,this.i=S,this.l=D,this.S=j||1,this.V=new Un(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new an}function an(){this.i=null,this.g="",this.h=!1}var yt={},Mt={};function er(p,S,D){p.M=1,p.A=tr(In(S)),p.u=D,p.R=!0,fi(p,null)}function fi(p,S){p.F=Date.now(),Li(p),p.B=In(p.A);var D=p.B,j=p.S;Array.isArray(j)||(j=[String(j)]),zn(D.i,"t",j),p.C=0,D=p.j.L,p.h=new an,p.g=Ya(p.j,D?S:null,!p.u),p.P>0&&(p.O=new ht(w(p.Y,p,p.g),p.P)),S=p.V,D=p.g,j=p.ba;var ce="readystatechange";Array.isArray(ce)||(ce&&(Bt[0]=ce.toString()),ce=Bt);for(let Ae=0;Ae<ce.length;Ae++){const $e=Ct(D,ce[Ae],j||S.handleEvent,!1,S.h||S);if(!$e)break;S.g[$e.key]=$e}S=p.J?K(p.J):{},p.u?(p.v||(p.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,S)):(p.v="GET",p.g.ea(p.B,p.v,null,S)),Tr(),nn(p.i,p.v,p.B,p.l,p.S,p.u)}Oe.prototype.ba=function(p){p=p.target;const S=this.O;S&&Vi(p)==3?S.j():this.Y(p)},Oe.prototype.Y=function(p){try{if(p==this.g)e:{const Yt=Vi(this.g),yr=this.g.ya(),Rn=this.g.ca();if(!(Yt<3)&&(Yt!=3||this.g&&(this.h.h||this.g.la()||_r(this.g)))){this.K||Yt!=4||yr==7||(yr==8||Rn<=0?Tr(3):Tr(2)),Qn(this);var S=this.g.ca();this.X=S;var D=Ps(this);if(this.o=S==200,re(this.i,this.v,this.B,this.l,this.S,Yt,S),this.o){if(this.U&&!this.L){t:{if(this.g){var j,ce=this.g;if((j=ce.g?ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(j)){var Ae=j;break t}}Ae=null}if(p=Ae)Se(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,kr(this,p);else{this.o=!1,this.m=3,Zt(12),Jr(this),un(this);break e}}if(this.R){p=!0;let rr;for(;!this.K&&this.C<D.length;)if(rr=za(this,D),rr==Mt){Yt==4&&(this.m=4,Zt(14),p=!1),Se(this.i,this.l,null,"[Incomplete Response]");break}else if(rr==yt){this.m=4,Zt(15),Se(this.i,this.l,D,"[Invalid Chunk]"),p=!1;break}else Se(this.i,this.l,rr,null),kr(this,rr);if(ri(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yt!=4||D.length!=0||this.h.h||(this.m=1,Zt(16),p=!1),this.o=this.o&&p,!p)Se(this.i,this.l,D,"[Invalid Chunked Response]"),Jr(this),un(this);else if(D.length>0&&!this.W){this.W=!0;var $e=this.j;$e.g==this&&$e.aa&&!$e.P&&($e.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),we($e),$e.P=!0,Zt(11))}}else Se(this.i,this.l,D,null),kr(this,D);Yt==4&&Jr(this),this.o&&!this.K&&(Yt==4?ca(this.j,this):(this.o=!1,Li(this)))}else Si(this.g),S==400&&D.indexOf("Unknown SID")>0?(this.m=3,Zt(12)):(this.m=0,Zt(13)),Jr(this),un(this)}}}catch{}finally{}};function Ps(p){if(!ri(p))return p.g.la();const S=_r(p.g);if(S==="")return"";let D="";const j=S.length,ce=Vi(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Jr(p),un(p),"";p.h.i=new x.TextDecoder}for(let Ae=0;Ae<j;Ae++)p.h.h=!0,D+=p.h.i.decode(S[Ae],{stream:!(ce&&Ae==j-1)});return S.length=0,p.h.g+=D,p.C=0,p.h.g}function ri(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function za(p,S){var D=p.C,j=S.indexOf(`
`,D);return j==-1?Mt:(D=Number(S.substring(D,j)),isNaN(D)?yt:(j+=1,j+D>S.length?Mt:(S=S.slice(j,j+D),p.C=j+D,S)))}Oe.prototype.cancel=function(){this.K=!0,Jr(this)};function Li(p){p.T=Date.now()+p.H,Yr(p,p.H)}function Yr(p,S){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Mr(w(p.aa,p),S)}function Qn(p){p.D&&(x.clearTimeout(p.D),p.D=null)}Oe.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(je(this.i,this.B),this.M!=2&&(Tr(),Zt(17)),Jr(this),this.m=2,un(this)):Yr(this,this.T-p)};function un(p){p.j.I==0||p.K||ca(p.j,p)}function Jr(p){Qn(p);var S=p.O;S&&typeof S.dispose=="function"&&S.dispose(),p.O=null,Kn(p.V),p.g&&(S=p.g,p.g=null,S.abort(),S.dispose())}function kr(p,S){try{var D=p.j;if(D.I!=0&&(D.g==p||Je(D.h,p))){if(!p.L&&Je(D.h,p)&&D.I==3){try{var j=D.Ba.g.parse(S)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ce=j;if(ce[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<p.F)mr(D),Is(D);else break e;la(D),Zt(18)}}else D.xa=ce[1],0<D.xa-D.K&&ce[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Mr(w(D.Va,D),6e3));Te(D.h)<=1&&D.ta&&(D.ta=void 0)}else ds(D,11)}else if((p.L||D.g==p)&&mr(D),!G(S))for(ce=D.Ba.g.parse(S),S=0;S<ce.length;S++){let Rn=ce[S];const rr=Rn[0];if(!(rr<=D.K))if(D.K=rr,Rn=Rn[1],D.I==2)if(Rn[0]=="c"){D.M=Rn[1],D.ba=Rn[2];const Ii=Rn[3];Ii!=null&&(D.ka=Ii,D.j.info("VER="+D.ka));const ms=Rn[4];ms!=null&&(D.za=ms,D.j.info("SVER="+D.za));const ei=Rn[5];ei!=null&&typeof ei=="number"&&ei>0&&(j=1.5*ei,D.O=j,D.j.info("backChannelRequestTimeoutMs_="+j)),j=D;const Ri=p.g;if(Ri){const ha=Ri.g?Ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ha){var Ae=j.h;Ae.g||ha.indexOf("spdy")==-1&&ha.indexOf("quic")==-1&&ha.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(xt(Ae,Ae.h),Ae.h=null))}if(j.G){const ps=Ri.g?Ri.g.getResponseHeader("X-HTTP-Session-Id"):null;ps&&(j.wa=ps,Nt(j.J,j.G,ps))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-p.F,D.j.info("Handshake RTT: "+D.T+"ms")),j=D;var $e=p;if(j.na=vl(j,j.L?j.ba:null,j.W),$e.L){nt(j.h,$e);var Yt=$e,yr=j.O;yr&&(Yt.H=yr),Yt.D&&(Qn(Yt),Li(Yt)),j.g=$e}else $i(j);D.i.length>0&&hs(D)}else Rn[0]!="stop"&&Rn[0]!="close"||ds(D,7);else D.I==3&&(Rn[0]=="stop"||Rn[0]=="close"?Rn[0]=="stop"?ds(D,7):Ga(D):Rn[0]!="noop"&&D.l&&D.l.qa(Rn),D.A=0)}}Tr(4)}catch{}}var ar=class{constructor(p,S){this.g=p,this.map=S}};function Be(p){this.l=p||10,x.PerformanceNavigationTiming?(p=x.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(x.chrome&&x.chrome.loadTimes&&x.chrome.loadTimes()&&x.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function W(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Te(p){return p.h?1:p.g?p.g.size:0}function Je(p,S){return p.h?p.h==S:p.g?p.g.has(S):!1}function xt(p,S){p.g?p.g.add(S):p.h=S}function nt(p,S){p.h&&p.h==S?p.h=null:p.g&&p.g.has(S)&&p.g.delete(S)}Be.prototype.cancel=function(){if(this.i=lt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function lt(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let S=p.i;for(const D of p.g.values())S=S.concat(D.G);return S}return B(p.i)}var ft=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hn(p,S){if(p){p=p.split("&");for(let D=0;D<p.length;D++){const j=p[D].indexOf("=");let ce,Ae=null;j>=0?(ce=p[D].substring(0,j),Ae=p[D].substring(j+1)):ce=p[D],S(ce,Ae?decodeURIComponent(Ae.replace(/\+/g," ")):"")}}}function dn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;p instanceof dn?(this.l=p.l,jt(this,p.j),this.o=p.o,this.g=p.g,kn(this,p.u),this.h=p.h,Pi(this,Fo(p.i)),this.m=p.m):p&&(S=String(p).match(ft))?(this.l=!1,jt(this,S[1]||"",!0),this.o=Cr(S[2]||""),this.g=Cr(S[3]||"",!0),kn(this,S[4]),this.h=Cr(S[5]||"",!0),Pi(this,S[6]||"",!0),this.m=Cr(S[7]||"")):(this.l=!1,this.i=new Lr(null,this.l))}dn.prototype.toString=function(){const p=[];var S=this.j;S&&p.push(gi(S,Er,!0),":");var D=this.g;return(D||S=="file")&&(p.push("//"),(S=this.o)&&p.push(gi(S,Er,!0),"@"),p.push(Rt(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&p.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&p.push("/"),p.push(gi(D,D.charAt(0)=="/"?H:de,!0))),(D=this.i.toString())&&p.push("?",D),(D=this.m)&&p.push("#",gi(D,wr)),p.join("")},dn.prototype.resolve=function(p){const S=In(this);let D=!!p.j;D?jt(S,p.j):D=!!p.o,D?S.o=p.o:D=!!p.g,D?S.g=p.g:D=p.u!=null;var j=p.h;if(D)kn(S,p.u);else if(D=!!p.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var ce=S.h.lastIndexOf("/");ce!=-1&&(j=S.h.slice(0,ce+1)+j)}if(ce=j,ce==".."||ce==".")j="";else if(ce.indexOf("./")!=-1||ce.indexOf("/.")!=-1){j=ce.lastIndexOf("/",0)==0,ce=ce.split("/");const Ae=[];for(let $e=0;$e<ce.length;){const Yt=ce[$e++];Yt=="."?j&&$e==ce.length&&Ae.push(""):Yt==".."?((Ae.length>1||Ae.length==1&&Ae[0]!="")&&Ae.pop(),j&&$e==ce.length&&Ae.push("")):(Ae.push(Yt),j=!0)}j=Ae.join("/")}else j=ce}return D?S.h=j:D=p.i.toString()!=="",D?Pi(S,Fo(p.i)):D=!!p.m,D&&(S.m=p.m),S};function In(p){return new dn(p)}function jt(p,S,D){p.j=D?Cr(S,!0):S,p.j&&(p.j=p.j.replace(/:$/,""))}function kn(p,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);p.u=S}else p.u=null}function Pi(p,S,D){S instanceof Lr?(p.i=S,Vs(p.i,p.l)):(D||(S=gi(S,bt)),p.i=new Lr(S,p.l))}function Nt(p,S,D){p.i.set(S,D)}function tr(p){return Nt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Cr(p,S){return p?S?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function gi(p,S,D){return typeof p=="string"?(p=encodeURI(p).replace(S,on),D&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function on(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Er=/[#\/\?@]/g,de=/[#\?:]/g,H=/[#\?]/g,bt=/[#\?@]/g,wr=/#/g;function Lr(p,S){this.h=this.g=null,this.i=p||null,this.j=!!S}function mi(p){p.g||(p.g=new Map,p.h=0,p.i&&hn(p.i,function(S,D){p.add(decodeURIComponent(S.replace(/\+/g," ")),D)}))}s=Lr.prototype,s.add=function(p,S){mi(this),this.i=null,p=Bs(this,p);let D=this.g.get(p);return D||this.g.set(p,D=[]),D.push(S),this.h+=1,this};function Ha(p,S){mi(p),S=Bs(p,S),p.g.has(S)&&(p.i=null,p.h-=p.g.get(S).length,p.g.delete(S))}function $r(p,S){return mi(p),S=Bs(p,S),p.g.has(S)}s.forEach=function(p,S){mi(this),this.g.forEach(function(D,j){D.forEach(function(ce){p.call(S,ce,j,this)},this)},this)};function St(p,S){mi(p);let D=[];if(typeof S=="string")$r(p,S)&&(D=D.concat(p.g.get(Bs(p,S))));else for(p=Array.from(p.g.values()),S=0;S<p.length;S++)D=D.concat(p[S]);return D}s.set=function(p,S){return mi(this),this.i=null,p=Bs(this,p),$r(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[S]),this.h+=1,this},s.get=function(p,S){return p?(p=St(this,p),p.length>0?String(p[0]):S):S};function zn(p,S,D){Ha(p,S),D.length>0&&(p.i=null,p.g.set(Bs(p,S),B(D)),p.h+=D.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],S=Array.from(this.g.keys());for(let j=0;j<S.length;j++){var D=S[j];const ce=Rt(D);D=St(this,D);for(let Ae=0;Ae<D.length;Ae++){let $e=ce;D[Ae]!==""&&($e+="="+Rt(D[Ae])),p.push($e)}}return this.i=p.join("&")};function Fo(p){const S=new Lr;return S.i=p.i,p.g&&(S.g=new Map(p.g),S.h=p.h),S}function Bs(p,S){return S=String(S),p.j&&(S=S.toLowerCase()),S}function Vs(p,S){S&&!p.j&&(mi(p),p.i=null,p.g.forEach(function(D,j){const ce=j.toLowerCase();j!=ce&&(Ha(this,j),zn(this,ce,D))},p)),p.j=S}function pi(p,S){const D=new dt;if(x.Image){const j=new Image;j.onload=C(Bi,D,"TestLoadImage: loaded",!0,S,j),j.onerror=C(Bi,D,"TestLoadImage: error",!1,S,j),j.onabort=C(Bi,D,"TestLoadImage: abort",!1,S,j),j.ontimeout=C(Bi,D,"TestLoadImage: timeout",!1,S,j),x.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else S(!1)}function ia(p,S){const D=new dt,j=new AbortController,ce=setTimeout(()=>{j.abort(),Bi(D,"TestPingServer: timeout",!1,S)},1e4);fetch(p,{signal:j.signal}).then(Ae=>{clearTimeout(ce),Ae.ok?Bi(D,"TestPingServer: ok",!0,S):Bi(D,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(ce),Bi(D,"TestPingServer: error",!1,S)})}function Bi(p,S,D,j,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),j(D)}catch{}}function nr(){this.g=new Zr}function yi(p){this.i=p.Sb||null,this.h=p.ab||!1}N(yi,Ti),yi.prototype.g=function(){return new xi(this.i,this.h)};function xi(p,S){Ve.call(this),this.H=p,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}N(xi,Ve),s=xi.prototype,s.open=function(p,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=S,this.readyState=1,Ft(this)},s.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(S.body=p),(this.H||x).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Us(this)),this.readyState=0},s.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Ft(this)),this.g&&(this.readyState=3,Ft(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof x.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Dt(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Dt(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}s.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var S=p.value?p.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!p.done}))&&(this.response=this.responseText+=S)}p.done?Us(this):Ft(this),this.readyState==3&&Dt(this)}},s.Oa=function(p){this.g&&(this.response=this.responseText=p,Us(this))},s.Na=function(p){this.g&&(this.response=p,Us(this))},s.ga=function(){this.g&&Us(this)};function Us(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Ft(p)}s.setRequestHeader=function(p,S){this.A.append(p,S)},s.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],S=this.h.entries();for(var D=S.next();!D.done;)D=D.value,p.push(D[0]+": "+D[1]),D=S.next();return p.join(`\r
`)};function Ft(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(xi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Hn(p){let S="";return qe(p,function(D,j){S+=j,S+=":",S+=D,S+=`\r
`}),S}function sa(p,S,D){e:{for(j in D){var j=!1;break e}j=!0}j||(D=Hn(D),typeof p=="string"?D!=null&&Rt(D):Nt(p,S,D))}function Ln(p){Ve.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}N(Ln,Ve);var Qi=/^https?$/i,Zi=["POST","PUT"];s=Ln.prototype,s.Fa=function(p){this.H=p},s.ea=function(p,S,D,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);S=S?S.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():at.g(),this.g.onreadystatechange=P(w(this.Ca,this));try{this.B=!0,this.g.open(S,String(p),!0),this.B=!1}catch(Ae){aa(this,Ae);return}if(p=D||"",D=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ce in j)D.set(ce,j[ce]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const Ae of j.keys())D.set(Ae,j.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(D.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),ce=x.FormData&&p instanceof x.FormData,!(Array.prototype.indexOf.call(Zi,S,void 0)>=0)||j||ce||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,$e]of D)this.g.setRequestHeader(Ae,$e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Ae){aa(this,Ae)}};function aa(p,S){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=S,p.o=5,Cs(p),Ci(p)}function Cs(p){p.A||(p.A=!0,it(p,"complete"),it(p,"error"))}s.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,it(this,"complete"),it(this,"abort"),Ci(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ci(this,!0)),Ln.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ji(this):this.Xa())},s.Xa=function(){Ji(this)};function Ji(p){if(p.h&&typeof g<"u"){if(p.v&&Vi(p)==4)setTimeout(p.Ca.bind(p),0);else if(it(p,"readystatechange"),Vi(p)==4){p.h=!1;try{const Ae=p.ca();e:switch(Ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var D;if(!(D=S)){var j;if(j=Ae===0){let $e=String(p.D).match(ft)[1]||null;!$e&&x.self&&x.self.location&&($e=x.self.location.protocol.slice(0,-1)),j=!Qi.test($e?$e.toLowerCase():"")}D=j}if(D)it(p,"complete"),it(p,"success");else{p.o=6;try{var ce=Vi(p)>2?p.g.statusText:""}catch{ce=""}p.l=ce+" ["+p.ca()+"]",Cs(p)}}finally{Ci(p)}}}}function Ci(p,S){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const D=p.g;p.g=null,S||it(p,"ready");try{D.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Vi(p){return p.g?p.g.readyState:0}s.ca=function(){try{return Vi(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(p){if(this.g){var S=this.g.responseText;return p&&S.indexOf(p)==0&&(S=S.substring(p.length)),cr(S)}};function _r(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Si(p){const S={};p=(p.g&&Vi(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(G(p[j]))continue;var D=Ut(p[j]);const ce=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Ae=S[ce]||[];S[ce]=Ae,Ae.push(D)}ut(S,function(j){return j.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ur(p,S,D){return D&&D.internalChannelParams&&D.internalChannelParams[p]||S}function Ss(p){this.za=0,this.i=[],this.j=new dt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ur("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ur("baseRetryDelayMs",5e3,p),this.Za=ur("retryDelaySeedMs",1e4,p),this.Ta=ur("forwardChannelMaxRetries",2,p),this.va=ur("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Be(p&&p.concurrentRequestLimit),this.Ba=new nr,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Ss.prototype,s.ka=8,s.I=1,s.connect=function(p,S,D,j){Zt(0),this.W=p,this.H=S||{},D&&j!==void 0&&(this.H.OSID=D,this.H.OAID=j),this.F=this.X,this.J=vl(this,null,this.W),hs(this)};function Ga(p){if(qa(p),p.I==3){var S=p.V++,D=In(p.J);if(Nt(D,"SID",p.M),Nt(D,"RID",S),Nt(D,"TYPE","terminate"),Fs(p,D),S=new Oe(p,p.j,S),S.M=2,S.A=tr(In(D)),D=!1,x.navigator&&x.navigator.sendBeacon)try{D=x.navigator.sendBeacon(S.A.toString(),"")}catch{}!D&&x.Image&&(new Image().src=S.A,D=!0),D||(S.g=Ya(S.j,null),S.g.ea(S.A)),S.F=Date.now(),Li(S)}bl(p)}function Is(p){p.g&&(we(p),p.g.cancel(),p.g=null)}function qa(p){Is(p),p.v&&(x.clearTimeout(p.v),p.v=null),mr(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&x.clearTimeout(p.m),p.m=null)}function hs(p){if(!W(p.h)&&!p.m){p.m=!0;var S=p.Ea;gt||z(),Qe||(gt(),Qe=!0),F.add(S,p),p.D=0}}function Xa(p,S){return Te(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=S.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Mr(w(p.Ea,p,S),jo(p,p.D)),p.D++,!0)}s.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ce=new Oe(this,this.j,p);let Ae=this.o;if(this.U&&(Ae?(Ae=K(Ae),ve(Ae,this.U)):Ae=this.U),this.u!==null||this.R||(ce.J=Ae,Ae=null),this.S)e:{for(var S=0,D=0;D<this.i.length;D++){t:{var j=this.i[D];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(S+=j,S>4096){S=D;break e}if(S===4096||D===this.i.length-1){S=D+1;break e}}S=1e3}else S=1e3;S=oa(this,ce,S),D=In(this.J),Nt(D,"RID",p),Nt(D,"CVER",22),this.G&&Nt(D,"X-HTTP-Session-Id",this.G),Fs(this,D),Ae&&(this.R?S="headers="+Rt(Hn(Ae))+"&"+S:this.u&&sa(D,this.u,Ae)),xt(this.h,ce),this.Ra&&Nt(D,"TYPE","init"),this.S?(Nt(D,"$req",S),Nt(D,"SID","null"),ce.U=!0,er(ce,D,null)):er(ce,D,S),this.I=2}}else this.I==3&&(p?Dn(this,p):this.i.length==0||W(this.h)||Dn(this))};function Dn(p,S){var D;S?D=S.l:D=p.V++;const j=In(p.J);Nt(j,"SID",p.M),Nt(j,"RID",D),Nt(j,"AID",p.K),Fs(p,j),p.u&&p.o&&sa(j,p.u,p.o),D=new Oe(p,p.j,D,p.D+1),p.u===null&&(D.J=p.o),S&&(p.i=S.G.concat(p.i)),S=oa(p,D,1e3),D.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),xt(p.h,D),er(D,j,S)}function Fs(p,S){p.H&&qe(p.H,function(D,j){Nt(S,j,D)}),p.l&&qe({},function(D,j){Nt(S,j,D)})}function oa(p,S,D){D=Math.min(p.i.length,D);const j=p.l?w(p.l.Ka,p.l,p):null;e:{var ce=p.i;let Yt=-1;for(;;){const yr=["count="+D];Yt==-1?D>0?(Yt=ce[0].g,yr.push("ofs="+Yt)):Yt=0:yr.push("ofs="+Yt);let Rn=!0;for(let rr=0;rr<D;rr++){var Ae=ce[rr].g;const Ii=ce[rr].map;if(Ae-=Yt,Ae<0)Yt=Math.max(0,ce[rr].g-100),Rn=!1;else try{Ae="req"+Ae+"_"||"";try{var $e=Ii instanceof Map?Ii:Object.entries(Ii);for(const[ms,ei]of $e){let Ri=ei;T(ei)&&(Ri=lr(ei)),yr.push(Ae+ms+"="+encodeURIComponent(Ri))}}catch(ms){throw yr.push(Ae+"type="+encodeURIComponent("_badmap")),ms}}catch{j&&j(Ii)}}if(Rn){$e=yr.join("&");break e}}$e=void 0}return p=p.i.splice(0,D),S.G=p,$e}function $i(p){if(!p.g&&!p.v){p.Y=1;var S=p.Da;gt||z(),Qe||(gt(),Qe=!0),F.add(S,p),p.A=0}}function la(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Mr(w(p.Da,p),jo(p,p.A)),p.A++,!0)}s.Da=function(){if(this.v=null,Jt(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Mr(w(this.Wa,this),p)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Zt(10),Is(this),Jt(this))};function we(p){p.B!=null&&(x.clearTimeout(p.B),p.B=null)}function Jt(p){p.g=new Oe(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var S=In(p.na);Nt(S,"RID","rpc"),Nt(S,"SID",p.M),Nt(S,"AID",p.K),Nt(S,"CI",p.F?"0":"1"),!p.F&&p.ia&&Nt(S,"TO",p.ia),Nt(S,"TYPE","xmlhttp"),Fs(p,S),p.u&&p.o&&sa(S,p.u,p.o),p.O&&(p.g.H=p.O);var D=p.g;p=p.ba,D.M=1,D.A=tr(In(S)),D.u=null,D.R=!0,fi(D,p)}s.Va=function(){this.C!=null&&(this.C=null,Is(this),la(this),Zt(19))};function mr(p){p.C!=null&&(x.clearTimeout(p.C),p.C=null)}function ca(p,S){var D=null;if(p.g==S){mr(p),we(p),p.g=null;var j=2}else if(Je(p.h,S))D=S.G,nt(p.h,S),j=1;else return;if(p.I!=0){if(S.o)if(j==1){D=S.u?S.u.length:0,S=Date.now()-S.F;var ce=p.D;j=vr(),it(j,new jn(j,D)),hs(p)}else $i(p);else if(ce=S.m,ce==3||ce==0&&S.X>0||!(j==1&&Xa(p,S)||j==2&&la(p)))switch(D&&D.length>0&&(S=p.h,S.i=S.i.concat(D)),ce){case 1:ds(p,5);break;case 4:ds(p,10);break;case 3:ds(p,6);break;default:ds(p,2)}}}function jo(p,S){let D=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(D*=2),D*S}function ds(p,S){if(p.j.info("Error code "+S),S==2){var D=w(p.bb,p),j=p.Ua;const ce=!j;j=new dn(j||"//www.google.com/images/cleardot.gif"),x.location&&x.location.protocol=="http"||jt(j,"https"),tr(j),ce?pi(j.toString(),D):ia(j.toString(),D)}else Zt(2);p.I=0,p.l&&p.l.pa(S),bl(p),qa(p)}s.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function bl(p){if(p.I=0,p.ja=[],p.l){const S=lt(p.h);(S.length!=0||p.i.length!=0)&&(ee(p.ja,S),ee(p.ja,p.i),p.h.i.length=0,B(p.i),p.i.length=0),p.l.oa()}}function vl(p,S,D){var j=D instanceof dn?In(D):new dn(D);if(j.g!="")S&&(j.g=S+"."+j.g),kn(j,j.u);else{var ce=x.location;j=ce.protocol,S=S?S+"."+ce.hostname:ce.hostname,ce=+ce.port;const Ae=new dn(null);j&&jt(Ae,j),S&&(Ae.g=S),ce&&kn(Ae,ce),D&&(Ae.h=D),j=Ae}return D=p.G,S=p.wa,D&&S&&Nt(j,D,S),Nt(j,"VER",p.ka),Fs(p,j),j}function Ya(p,S,D){if(S&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=p.Aa&&!p.ma?new Ln(new yi({ab:D})):new Ln(p.ma),S.Fa(p.L),S}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function pr(){}s=pr.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function fs(){}fs.prototype.g=function(p,S){return new fn(p,S)};function fn(p,S){Ve.call(this),this.g=new Ss(S),this.l=p,this.h=S&&S.messageUrlParams||null,p=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(p?p["X-WebChannel-Content-Type"]=S.messageContentType:p={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(p?p["X-WebChannel-Client-Profile"]=S.sa:p={"X-WebChannel-Client-Profile":S.sa}),this.g.U=p,(p=S&&S.Qb)&&!G(p)&&(this.g.u=p),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!G(S)&&(this.g.G=S,p=this.h,p!==null&&S in p&&(p=this.h,S in p&&delete p[S])),this.j=new mn(this)}N(fn,Ve),fn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fn.prototype.close=function(){Ga(this.g)},fn.prototype.o=function(p){var S=this.g;if(typeof p=="string"){var D={};D.__data__=p,p=D}else this.v&&(D={},D.__data__=lr(p),p=D);S.i.push(new ar(S.Ya++,p)),S.I==3&&hs(S)},fn.prototype.N=function(){this.g.l=null,delete this.j,Ga(this.g),delete this.g,fn.Z.N.call(this)};function ua(p){Fe.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var S=p.__sm__;if(S){e:{for(const D in S){p=D;break e}p=void 0}(this.i=p)&&(p=this.i,S=S!==null&&p in S?S[p]:void 0),this.data=S}else this.data=p}N(ua,Fe);function gs(){Ht.call(this),this.status=1}N(gs,Ht);function mn(p){this.g=p}N(mn,pr),mn.prototype.ra=function(){it(this.g,"a")},mn.prototype.qa=function(p){it(this.g,new ua(p))},mn.prototype.pa=function(p){it(this.g,new gs)},mn.prototype.oa=function(){it(this.g,"b")},fs.prototype.createWebChannel=fs.prototype.g,fn.prototype.send=fn.prototype.o,fn.prototype.open=fn.prototype.m,fn.prototype.close=fn.prototype.close,Aw=function(){return new fs},_w=function(){return vr()},ww=At,V1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},st.NO_ERROR=0,st.TIMEOUT=8,st.HTTP_ERROR=6,dd=st,pt.COMPLETE="complete",Ew=pt,ki.EventType=tn,tn.OPEN="a",tn.CLOSE="b",tn.ERROR="c",tn.MESSAGE="d",Ve.prototype.listen=Ve.prototype.J,hu=ki,Ln.prototype.listenOnce=Ln.prototype.K,Ln.prototype.getLastError=Ln.prototype.Ha,Ln.prototype.getLastErrorCode=Ln.prototype.ya,Ln.prototype.getStatus=Ln.prototype.ca,Ln.prototype.getResponseJson=Ln.prototype.La,Ln.prototype.getResponseText=Ln.prototype.la,Ln.prototype.send=Ln.prototype.ea,Ln.prototype.setWithCredentials=Ln.prototype.Fa,xw=Ln}).apply(typeof td<"u"?td:typeof self<"u"?self:typeof window<"u"?window:{});const ex="@firebase/firestore",tx="4.9.2";class _i{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_i.UNAUTHENTICATED=new _i(null),_i.GOOGLE_CREDENTIALS=new _i("google-credentials-uid"),_i.FIRST_PARTY=new _i("first-party-uid"),_i.MOCK_USER=new _i("mock-user");let xc="12.3.0";const ml=new cg("@firebase/firestore");function Jl(){return ml.logLevel}function wt(s,...e){if(ml.logLevel<=vn.DEBUG){const n=e.map(wg);ml.debug(`Firestore (${xc}): ${s}`,...n)}}function Ba(s,...e){if(ml.logLevel<=vn.ERROR){const n=e.map(wg);ml.error(`Firestore (${xc}): ${s}`,...n)}}function uc(s,...e){if(ml.logLevel<=vn.WARN){const n=e.map(wg);ml.warn(`Firestore (${xc}): ${s}`,...n)}}function wg(s){if(typeof s=="string")return s;try{return(function(n){return JSON.stringify(n)})(s)}catch{return s}}function Xt(s,e,n){let o="Unexpected state";typeof e=="string"?o=e:n=e,bw(s,o,n)}function bw(s,e,n){let o=`FIRESTORE (${xc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(n!==void 0)try{o+=" CONTEXT: "+JSON.stringify(n)}catch{o+=" CONTEXT: "+n}throw Ba(o),new Error(o)}function qn(s,e,n,o){let h="Unexpected state";typeof n=="string"?h=n:o=n,s||bw(e,h,o)}function en(s,e){return s}const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ct extends na{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ka{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class vw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class H3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(_i.UNAUTHENTICATED)))}shutdown(){}}class G3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class q3{constructor(e){this.t=e,this.currentUser=_i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){qn(this.o===void 0,42304);let o=this.i;const h=b=>this.i!==o?(o=this.i,n(b)):Promise.resolve();let g=new ka;this.o=()=>{this.i++,this.currentUser=this.u(),g.resolve(),g=new ka,e.enqueueRetryable((()=>h(this.currentUser)))};const x=()=>{const b=g;e.enqueueRetryable((async()=>{await b.promise,await h(this.currentUser)}))},T=b=>{wt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=b,this.o&&(this.auth.addAuthTokenListener(this.o),x())};this.t.onInit((b=>T(b))),setTimeout((()=>{if(!this.auth){const b=this.t.getImmediate({optional:!0});b?T(b):(wt("FirebaseAuthCredentialsProvider","Auth not yet detected"),g.resolve(),g=new ka)}}),0),x()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((o=>this.i!==e?(wt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(qn(typeof o.accessToken=="string",31837,{l:o}),new vw(o.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qn(e===null||typeof e=="string",2055,{h:e}),new _i(e)}}class X3{constructor(e,n,o){this.P=e,this.T=n,this.I=o,this.type="FirstParty",this.user=_i.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Y3{constructor(e,n,o){this.P=e,this.T=n,this.I=o}getToken(){return Promise.resolve(new X3(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(_i.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W3{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,cs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){qn(this.o===void 0,3512);const o=g=>{g.error!=null&&wt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${g.error.message}`);const x=g.token!==this.m;return this.m=g.token,wt("FirebaseAppCheckTokenProvider",`Received ${x?"new":"existing"} token.`),x?n(g.token):Promise.resolve()};this.o=g=>{e.enqueueRetryable((()=>o(g)))};const h=g=>{wt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=g,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((g=>h(g))),setTimeout((()=>{if(!this.appCheck){const g=this.V.getImmediate({optional:!0});g?h(g):wt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new nx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(qn(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new nx(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function K3(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let o=0;o<s;o++)n[o]=Math.floor(256*Math.random());return n}class _g{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let o="";for(;o.length<20;){const h=K3(40);for(let g=0;g<h.length;++g)o.length<20&&h[g]<n&&(o+=e.charAt(h[g]%62))}return o}}function Cn(s,e){return s<e?-1:s>e?1:0}function U1(s,e){const n=Math.min(s.length,e.length);for(let o=0;o<n;o++){const h=s.charAt(o),g=e.charAt(o);if(h!==g)return x1(h)===x1(g)?Cn(h,g):x1(h)?1:-1}return Cn(s.length,e.length)}const Q3=55296,Z3=57343;function x1(s){const e=s.charCodeAt(0);return e>=Q3&&e<=Z3}function hc(s,e,n){return s.length===e.length&&s.every(((o,h)=>n(o,e[h])))}const rx="__name__";class Xs{constructor(e,n,o){n===void 0?n=0:n>e.length&&Xt(637,{offset:n,range:e.length}),o===void 0?o=e.length-n:o>e.length-n&&Xt(1746,{length:o,range:e.length-n}),this.segments=e,this.offset=n,this.len=o}get length(){return this.len}isEqual(e){return Xs.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Xs?e.forEach((o=>{n.push(o)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,o=this.limit();n<o;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const o=Math.min(e.length,n.length);for(let h=0;h<o;h++){const g=Xs.compareSegments(e.get(h),n.get(h));if(g!==0)return g}return Cn(e.length,n.length)}static compareSegments(e,n){const o=Xs.isNumericId(e),h=Xs.isNumericId(n);return o&&!h?-1:!o&&h?1:o&&h?Xs.extractNumericId(e).compare(Xs.extractNumericId(n)):U1(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return So.fromString(e.substring(4,e.length-2))}}class or extends Xs{construct(e,n,o){return new or(e,n,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const o of e){if(o.indexOf("//")>=0)throw new ct(De.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);n.push(...o.split("/").filter((h=>h.length>0)))}return new or(n)}static emptyPath(){return new or([])}}const J3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hi extends Xs{construct(e,n,o){return new hi(e,n,o)}static isValidIdentifier(e){return J3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hi.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rx}static keyField(){return new hi([rx])}static fromServerFormat(e){const n=[];let o="",h=0;const g=()=>{if(o.length===0)throw new ct(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(o),o=""};let x=!1;for(;h<e.length;){const T=e[h];if(T==="\\"){if(h+1===e.length)throw new ct(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const b=e[h+1];if(b!=="\\"&&b!=="."&&b!=="`")throw new ct(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);o+=b,h+=2}else T==="`"?(x=!x,h++):T!=="."||x?(o+=T,h++):(g(),h++)}if(g(),x)throw new ct(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hi(n)}static emptyPath(){return new hi([])}}class Lt{constructor(e){this.path=e}static fromPath(e){return new Lt(or.fromString(e))}static fromName(e){return new Lt(or.fromString(e).popFirst(5))}static empty(){return new Lt(or.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&or.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return or.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Lt(new or(e.slice()))}}function Tw(s,e,n){if(!n)throw new ct(De.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function $3(s,e,n,o){if(e===!0&&o===!0)throw new ct(De.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function ix(s){if(!Lt.isDocumentKey(s))throw new ct(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function sx(s){if(Lt.isDocumentKey(s))throw new ct(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Cw(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Jd(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(o){return o.constructor?o.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Xt(12329,{type:typeof s})}function Di(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new ct(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jd(s);throw new ct(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function eS(s,e){if(e<=0)throw new ct(De.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function qr(s,e){const n={typeString:s};return e&&(n.value=e),n}function Uu(s,e){if(!Cw(s))throw new ct(De.INVALID_ARGUMENT,"JSON must be an object");let n;for(const o in e)if(e[o]){const h=e[o].typeString,g="value"in e[o]?{value:e[o].value}:void 0;if(!(o in s)){n=`JSON missing required field: '${o}'`;break}const x=s[o];if(h&&typeof x!==h){n=`JSON field '${o}' must be a ${h}.`;break}if(g!==void 0&&x!==g.value){n=`Expected '${o}' field to equal '${g.value}'`;break}}if(n)throw new ct(De.INVALID_ARGUMENT,n);return!0}const ax=-62135596800,ox=1e6;class Vn{static now(){return Vn.fromMillis(Date.now())}static fromDate(e){return Vn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),o=Math.floor((e-1e3*n)*ox);return new Vn(n,o)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ct(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ct(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<ax)throw new ct(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ct(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ox}_compareTo(e){return this.seconds===e.seconds?Cn(this.nanoseconds,e.nanoseconds):Cn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Vn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Uu(e,Vn._jsonSchema))return new Vn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ax;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Vn._jsonSchemaVersion="firestore/timestamp/1.0",Vn._jsonSchema={type:qr("string",Vn._jsonSchemaVersion),seconds:qr("number"),nanoseconds:qr("number")};class Kt{static fromTimestamp(e){return new Kt(e)}static min(){return new Kt(new Vn(0,0))}static max(){return new Kt(new Vn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Tu=-1;function tS(s,e){const n=s.toTimestamp().seconds,o=s.toTimestamp().nanoseconds+1,h=Kt.fromTimestamp(o===1e9?new Vn(n+1,0):new Vn(n,o));return new Oo(h,Lt.empty(),e)}function nS(s){return new Oo(s.readTime,s.key,Tu)}class Oo{constructor(e,n,o){this.readTime=e,this.documentKey=n,this.largestBatchId=o}static min(){return new Oo(Kt.min(),Lt.empty(),Tu)}static max(){return new Oo(Kt.max(),Lt.empty(),Tu)}}function rS(s,e){let n=s.readTime.compareTo(e.readTime);return n!==0?n:(n=Lt.comparator(s.documentKey,e.documentKey),n!==0?n:Cn(s.largestBatchId,e.largestBatchId))}const iS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ec(s){if(s.code!==De.FAILED_PRECONDITION||s.message!==iS)throw s;wt("LocalStore","Unexpectedly lost primary lease")}class Ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Xt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Ue(((o,h)=>{this.nextCallback=g=>{this.wrapSuccess(e,g).next(o,h)},this.catchCallback=g=>{this.wrapFailure(n,g).next(o,h)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof Ue?n:Ue.resolve(n)}catch(n){return Ue.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):Ue.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):Ue.reject(n)}static resolve(e){return new Ue(((n,o)=>{n(e)}))}static reject(e){return new Ue(((n,o)=>{o(e)}))}static waitFor(e){return new Ue(((n,o)=>{let h=0,g=0,x=!1;e.forEach((T=>{++h,T.next((()=>{++g,x&&g===h&&n()}),(b=>o(b)))})),x=!0,g===h&&n()}))}static or(e){let n=Ue.resolve(!1);for(const o of e)n=n.next((h=>h?Ue.resolve(h):o()));return n}static forEach(e,n){const o=[];return e.forEach(((h,g)=>{o.push(n.call(this,h,g))})),this.waitFor(o)}static mapArray(e,n){return new Ue(((o,h)=>{const g=e.length,x=new Array(g);let T=0;for(let b=0;b<g;b++){const w=b;n(e[w]).next((C=>{x[w]=C,++T,T===g&&o(x)}),(C=>h(C)))}}))}static doWhile(e,n){return new Ue(((o,h)=>{const g=()=>{e()===!0?n().next((()=>{g()}),h):o()};g()}))}}function aS(s){const e=s.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function wc(s){return s.name==="IndexedDbTransactionError"}class $d{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=o=>this.ae(o),this.ue=o=>n.writeSequenceNumber(o))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}$d.ce=-1;const Ag=-1;function ef(s){return s==null}function Sd(s){return s===0&&1/s==-1/0}function oS(s){return typeof s=="number"&&Number.isInteger(s)&&!Sd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Sw="";function lS(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=lx(e)),e=cS(s.get(n),e);return lx(e)}function cS(s,e){let n=e;const o=s.length;for(let h=0;h<o;h++){const g=s.charAt(h);switch(g){case"\0":n+="";break;case Sw:n+="";break;default:n+=g}}return n}function lx(s){return s+Sw+""}function cx(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function Vo(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function Iw(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class br{constructor(e,n){this.comparator=e,this.root=n||ci.EMPTY}insert(e,n){return new br(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ci.BLACK,null,null))}remove(e){return new br(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ci.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return n.value;o<0?n=n.left:o>0&&(n=n.right)}return null}indexOf(e){let n=0,o=this.root;for(;!o.isEmpty();){const h=this.comparator(e,o.key);if(h===0)return n+o.left.size;h<0?o=o.left:(n+=o.left.size+1,o=o.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,o)=>(e(n,o),!1)))}toString(){const e=[];return this.inorderTraversal(((n,o)=>(e.push(`${n}:${o}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nd(this.root,e,this.comparator,!1)}getReverseIterator(){return new nd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nd(this.root,e,this.comparator,!0)}}class nd{constructor(e,n,o,h){this.isReverse=h,this.nodeStack=[];let g=1;for(;!e.isEmpty();)if(g=n?o(e.key,n):1,n&&h&&(g*=-1),g<0)e=this.isReverse?e.left:e.right;else{if(g===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ci{constructor(e,n,o,h,g){this.key=e,this.value=n,this.color=o??ci.RED,this.left=h??ci.EMPTY,this.right=g??ci.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,o,h,g){return new ci(e??this.key,n??this.value,o??this.color,h??this.left,g??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,o){let h=this;const g=o(e,h.key);return h=g<0?h.copy(null,null,null,h.left.insert(e,n,o),null):g===0?h.copy(null,n,null,null,null):h.copy(null,null,null,null,h.right.insert(e,n,o)),h.fixUp()}removeMin(){if(this.left.isEmpty())return ci.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let o,h=this;if(n(e,h.key)<0)h.left.isEmpty()||h.left.isRed()||h.left.left.isRed()||(h=h.moveRedLeft()),h=h.copy(null,null,null,h.left.remove(e,n),null);else{if(h.left.isRed()&&(h=h.rotateRight()),h.right.isEmpty()||h.right.isRed()||h.right.left.isRed()||(h=h.moveRedRight()),n(e,h.key)===0){if(h.right.isEmpty())return ci.EMPTY;o=h.right.min(),h=h.copy(o.key,o.value,null,null,h.right.removeMin())}h=h.copy(null,null,null,null,h.right.remove(e,n))}return h.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xt(27949);return e+(this.isRed()?0:1)}}ci.EMPTY=null,ci.RED=!0,ci.BLACK=!1;ci.EMPTY=new class{constructor(){this.size=0}get key(){throw Xt(57766)}get value(){throw Xt(16141)}get color(){throw Xt(16727)}get left(){throw Xt(29726)}get right(){throw Xt(36894)}copy(e,n,o,h,g){return this}insert(e,n,o){return new ci(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qr{constructor(e){this.comparator=e,this.data=new br(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,o)=>(e(n),!1)))}forEachInRange(e,n){const o=this.data.getIteratorFrom(e[0]);for(;o.hasNext();){const h=o.getNext();if(this.comparator(h.key,e[1])>=0)return;n(h.key)}}forEachWhile(e,n){let o;for(o=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();o.hasNext();)if(!e(o.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ux(this.data.getIterator())}getIteratorFrom(e){return new ux(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((o=>{n=n.add(o)})),n}isEqual(e){if(!(e instanceof Qr)||this.size!==e.size)return!1;const n=this.data.getIterator(),o=e.data.getIterator();for(;n.hasNext();){const h=n.getNext().key,g=o.getNext().key;if(this.comparator(h,g)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Qr(this.comparator);return n.data=e,n}}class ux{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class us{constructor(e){this.fields=e,e.sort(hi.comparator)}static empty(){return new us([])}unionWith(e){let n=new Qr(hi.comparator);for(const o of this.fields)n=n.add(o);for(const o of e)n=n.add(o);return new us(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return hc(this.fields,e.fields,((n,o)=>n.isEqual(o)))}}class Rw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class di{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(h){try{return atob(h)}catch(g){throw typeof DOMException<"u"&&g instanceof DOMException?new Rw("Invalid base64 string: "+g):g}})(e);return new di(n)}static fromUint8Array(e){const n=(function(h){let g="";for(let x=0;x<h.length;++x)g+=String.fromCharCode(h[x]);return g})(e);return new di(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const o=new Uint8Array(n.length);for(let h=0;h<n.length;h++)o[h]=n.charCodeAt(h);return o})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Cn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}di.EMPTY_BYTE_STRING=new di("");const uS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Do(s){if(qn(!!s,39018),typeof s=="string"){let e=0;const n=uS.exec(s);if(qn(!!n,46558,{timestamp:s}),n[1]){let h=n[1];h=(h+"000000000").substr(0,9),e=Number(h)}const o=new Date(s);return{seconds:Math.floor(o.getTime()/1e3),nanos:e}}return{seconds:Vr(s.seconds),nanos:Vr(s.nanos)}}function Vr(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Mo(s){return typeof s=="string"?di.fromBase64String(s):di.fromUint8Array(s)}const Nw="server_timestamp",Ow="__type__",Dw="__previous_value__",Mw="__local_write_time__";function bg(s){return(s?.mapValue?.fields||{})[Ow]?.stringValue===Nw}function tf(s){const e=s.mapValue.fields[Dw];return bg(e)?tf(e):e}function Cu(s){const e=Do(s.mapValue.fields[Mw].timestampValue);return new Vn(e.seconds,e.nanos)}class hS{constructor(e,n,o,h,g,x,T,b,w,C){this.databaseId=e,this.appId=n,this.persistenceKey=o,this.host=h,this.ssl=g,this.forceLongPolling=x,this.autoDetectLongPolling=T,this.longPollingOptions=b,this.useFetchStreams=w,this.isUsingEmulator=C}}const Id="(default)";class Su{constructor(e,n){this.projectId=e,this.database=n||Id}static empty(){return new Su("","")}get isDefaultDatabase(){return this.database===Id}isEqual(e){return e instanceof Su&&e.projectId===this.projectId&&e.database===this.database}}const kw="__type__",dS="__max__",rd={mapValue:{}},Lw="__vector__",Rd="value";function ko(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?bg(s)?4:gS(s)?9007199254740991:fS(s)?10:11:Xt(28295,{value:s})}function ea(s,e){if(s===e)return!0;const n=ko(s);if(n!==ko(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Cu(s).isEqual(Cu(e));case 3:return(function(h,g){if(typeof h.timestampValue=="string"&&typeof g.timestampValue=="string"&&h.timestampValue.length===g.timestampValue.length)return h.timestampValue===g.timestampValue;const x=Do(h.timestampValue),T=Do(g.timestampValue);return x.seconds===T.seconds&&x.nanos===T.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(h,g){return Mo(h.bytesValue).isEqual(Mo(g.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(h,g){return Vr(h.geoPointValue.latitude)===Vr(g.geoPointValue.latitude)&&Vr(h.geoPointValue.longitude)===Vr(g.geoPointValue.longitude)})(s,e);case 2:return(function(h,g){if("integerValue"in h&&"integerValue"in g)return Vr(h.integerValue)===Vr(g.integerValue);if("doubleValue"in h&&"doubleValue"in g){const x=Vr(h.doubleValue),T=Vr(g.doubleValue);return x===T?Sd(x)===Sd(T):isNaN(x)&&isNaN(T)}return!1})(s,e);case 9:return hc(s.arrayValue.values||[],e.arrayValue.values||[],ea);case 10:case 11:return(function(h,g){const x=h.mapValue.fields||{},T=g.mapValue.fields||{};if(cx(x)!==cx(T))return!1;for(const b in x)if(x.hasOwnProperty(b)&&(T[b]===void 0||!ea(x[b],T[b])))return!1;return!0})(s,e);default:return Xt(52216,{left:s})}}function Iu(s,e){return(s.values||[]).find((n=>ea(n,e)))!==void 0}function dc(s,e){if(s===e)return 0;const n=ko(s),o=ko(e);if(n!==o)return Cn(n,o);switch(n){case 0:case 9007199254740991:return 0;case 1:return Cn(s.booleanValue,e.booleanValue);case 2:return(function(g,x){const T=Vr(g.integerValue||g.doubleValue),b=Vr(x.integerValue||x.doubleValue);return T<b?-1:T>b?1:T===b?0:isNaN(T)?isNaN(b)?0:-1:1})(s,e);case 3:return hx(s.timestampValue,e.timestampValue);case 4:return hx(Cu(s),Cu(e));case 5:return U1(s.stringValue,e.stringValue);case 6:return(function(g,x){const T=Mo(g),b=Mo(x);return T.compareTo(b)})(s.bytesValue,e.bytesValue);case 7:return(function(g,x){const T=g.split("/"),b=x.split("/");for(let w=0;w<T.length&&w<b.length;w++){const C=Cn(T[w],b[w]);if(C!==0)return C}return Cn(T.length,b.length)})(s.referenceValue,e.referenceValue);case 8:return(function(g,x){const T=Cn(Vr(g.latitude),Vr(x.latitude));return T!==0?T:Cn(Vr(g.longitude),Vr(x.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return dx(s.arrayValue,e.arrayValue);case 10:return(function(g,x){const T=g.fields||{},b=x.fields||{},w=T[Rd]?.arrayValue,C=b[Rd]?.arrayValue,N=Cn(w?.values?.length||0,C?.values?.length||0);return N!==0?N:dx(w,C)})(s.mapValue,e.mapValue);case 11:return(function(g,x){if(g===rd.mapValue&&x===rd.mapValue)return 0;if(g===rd.mapValue)return 1;if(x===rd.mapValue)return-1;const T=g.fields||{},b=Object.keys(T),w=x.fields||{},C=Object.keys(w);b.sort(),C.sort();for(let N=0;N<b.length&&N<C.length;++N){const P=U1(b[N],C[N]);if(P!==0)return P;const B=dc(T[b[N]],w[C[N]]);if(B!==0)return B}return Cn(b.length,C.length)})(s.mapValue,e.mapValue);default:throw Xt(23264,{he:n})}}function hx(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Cn(s,e);const n=Do(s),o=Do(e),h=Cn(n.seconds,o.seconds);return h!==0?h:Cn(n.nanos,o.nanos)}function dx(s,e){const n=s.values||[],o=e.values||[];for(let h=0;h<n.length&&h<o.length;++h){const g=dc(n[h],o[h]);if(g)return g}return Cn(n.length,o.length)}function fc(s){return F1(s)}function F1(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(n){const o=Do(n);return`time(${o.seconds},${o.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(n){return Mo(n).toBase64()})(s.bytesValue):"referenceValue"in s?(function(n){return Lt.fromName(n).toString()})(s.referenceValue):"geoPointValue"in s?(function(n){return`geo(${n.latitude},${n.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(n){let o="[",h=!0;for(const g of n.values||[])h?h=!1:o+=",",o+=F1(g);return o+"]"})(s.arrayValue):"mapValue"in s?(function(n){const o=Object.keys(n.fields||{}).sort();let h="{",g=!0;for(const x of o)g?g=!1:h+=",",h+=`${x}:${F1(n.fields[x])}`;return h+"}"})(s.mapValue):Xt(61005,{value:s})}function fd(s){switch(ko(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=tf(s);return e?16+fd(e):16;case 5:return 2*s.stringValue.length;case 6:return Mo(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(o){return(o.values||[]).reduce(((h,g)=>h+fd(g)),0)})(s.arrayValue);case 10:case 11:return(function(o){let h=0;return Vo(o.fields,((g,x)=>{h+=g.length+fd(x)})),h})(s.mapValue);default:throw Xt(13486,{value:s})}}function fx(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function j1(s){return!!s&&"integerValue"in s}function vg(s){return!!s&&"arrayValue"in s}function gx(s){return!!s&&"nullValue"in s}function mx(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function gd(s){return!!s&&"mapValue"in s}function fS(s){return(s?.mapValue?.fields||{})[kw]?.stringValue===Lw}function xu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Vo(s.mapValue.fields,((n,o)=>e.mapValue.fields[n]=xu(o))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=xu(s.arrayValue.values[n]);return e}return{...s}}function gS(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===dS}class Wi{constructor(e){this.value=e}static empty(){return new Wi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let o=0;o<e.length-1;++o)if(n=(n.mapValue.fields||{})[e.get(o)],!gd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=xu(n)}setAll(e){let n=hi.emptyPath(),o={},h=[];e.forEach(((x,T)=>{if(!n.isImmediateParentOf(T)){const b=this.getFieldsMap(n);this.applyChanges(b,o,h),o={},h=[],n=T.popLast()}x?o[T.lastSegment()]=xu(x):h.push(T.lastSegment())}));const g=this.getFieldsMap(n);this.applyChanges(g,o,h)}delete(e){const n=this.field(e.popLast());gd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ea(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let o=0;o<e.length;++o){let h=n.mapValue.fields[e.get(o)];gd(h)&&h.mapValue.fields||(h={mapValue:{fields:{}}},n.mapValue.fields[e.get(o)]=h),n=h}return n.mapValue.fields}applyChanges(e,n,o){Vo(n,((h,g)=>e[h]=g));for(const h of o)delete e[h]}clone(){return new Wi(xu(this.value))}}function Pw(s){const e=[];return Vo(s.fields,((n,o)=>{const h=new hi([n]);if(gd(o)){const g=Pw(o.mapValue).fields;if(g.length===0)e.push(h);else for(const x of g)e.push(h.child(x))}else e.push(h)})),new us(e)}class Ai{constructor(e,n,o,h,g,x,T){this.key=e,this.documentType=n,this.version=o,this.readTime=h,this.createTime=g,this.data=x,this.documentState=T}static newInvalidDocument(e){return new Ai(e,0,Kt.min(),Kt.min(),Kt.min(),Wi.empty(),0)}static newFoundDocument(e,n,o,h){return new Ai(e,1,n,Kt.min(),o,h,0)}static newNoDocument(e,n){return new Ai(e,2,n,Kt.min(),Kt.min(),Wi.empty(),0)}static newUnknownDocument(e,n){return new Ai(e,3,n,Kt.min(),Kt.min(),Wi.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Kt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Kt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ai&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ai(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Nd{constructor(e,n){this.position=e,this.inclusive=n}}function px(s,e,n){let o=0;for(let h=0;h<s.position.length;h++){const g=e[h],x=s.position[h];if(g.field.isKeyField()?o=Lt.comparator(Lt.fromName(x.referenceValue),n.key):o=dc(x,n.data.field(g.field)),g.dir==="desc"&&(o*=-1),o!==0)break}return o}function yx(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!ea(s.position[n],e.position[n]))return!1;return!0}class Ru{constructor(e,n="asc"){this.field=e,this.dir=n}}function mS(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Bw{}class Gr extends Bw{constructor(e,n,o){super(),this.field=e,this.op=n,this.value=o}static create(e,n,o){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,o):new yS(e,n,o):n==="array-contains"?new wS(e,o):n==="in"?new _S(e,o):n==="not-in"?new AS(e,o):n==="array-contains-any"?new bS(e,o):new Gr(e,n,o)}static createKeyFieldInFilter(e,n,o){return n==="in"?new xS(e,o):new ES(e,o)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(dc(n,this.value)):n!==null&&ko(this.value)===ko(n)&&this.matchesComparison(dc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Xt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ls extends Bw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ls(e,n)}matches(e){return Vw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Vw(s){return s.op==="and"}function Uw(s){return pS(s)&&Vw(s)}function pS(s){for(const e of s.filters)if(e instanceof Ls)return!1;return!0}function z1(s){if(s instanceof Gr)return s.field.canonicalString()+s.op.toString()+fc(s.value);if(Uw(s))return s.filters.map((e=>z1(e))).join(",");{const e=s.filters.map((n=>z1(n))).join(",");return`${s.op}(${e})`}}function Fw(s,e){return s instanceof Gr?(function(o,h){return h instanceof Gr&&o.op===h.op&&o.field.isEqual(h.field)&&ea(o.value,h.value)})(s,e):s instanceof Ls?(function(o,h){return h instanceof Ls&&o.op===h.op&&o.filters.length===h.filters.length?o.filters.reduce(((g,x,T)=>g&&Fw(x,h.filters[T])),!0):!1})(s,e):void Xt(19439)}function jw(s){return s instanceof Gr?(function(n){return`${n.field.canonicalString()} ${n.op} ${fc(n.value)}`})(s):s instanceof Ls?(function(n){return n.op.toString()+" {"+n.getFilters().map(jw).join(" ,")+"}"})(s):"Filter"}class yS extends Gr{constructor(e,n,o){super(e,n,o),this.key=Lt.fromName(o.referenceValue)}matches(e){const n=Lt.comparator(e.key,this.key);return this.matchesComparison(n)}}class xS extends Gr{constructor(e,n){super(e,"in",n),this.keys=zw("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class ES extends Gr{constructor(e,n){super(e,"not-in",n),this.keys=zw("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function zw(s,e){return(e.arrayValue?.values||[]).map((n=>Lt.fromName(n.referenceValue)))}class wS extends Gr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return vg(n)&&Iu(n.arrayValue,this.value)}}class _S extends Gr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Iu(this.value.arrayValue,n)}}class AS extends Gr{constructor(e,n){super(e,"not-in",n)}matches(e){if(Iu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Iu(this.value.arrayValue,n)}}class bS extends Gr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!vg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((o=>Iu(this.value.arrayValue,o)))}}class vS{constructor(e,n=null,o=[],h=[],g=null,x=null,T=null){this.path=e,this.collectionGroup=n,this.orderBy=o,this.filters=h,this.limit=g,this.startAt=x,this.endAt=T,this.Te=null}}function xx(s,e=null,n=[],o=[],h=null,g=null,x=null){return new vS(s,e,n,o,h,g,x)}function Tg(s){const e=en(s);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((o=>z1(o))).join(","),n+="|ob:",n+=e.orderBy.map((o=>(function(g){return g.field.canonicalString()+g.dir})(o))).join(","),ef(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((o=>fc(o))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((o=>fc(o))).join(",")),e.Te=n}return e.Te}function Cg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<s.orderBy.length;n++)if(!mS(s.orderBy[n],e.orderBy[n]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let n=0;n<s.filters.length;n++)if(!Fw(s.filters[n],e.filters[n]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!yx(s.startAt,e.startAt)&&yx(s.endAt,e.endAt)}function H1(s){return Lt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class _c{constructor(e,n=null,o=[],h=[],g=null,x="F",T=null,b=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=o,this.filters=h,this.limit=g,this.limitType=x,this.startAt=T,this.endAt=b,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function TS(s,e,n,o,h,g,x,T){return new _c(s,e,n,o,h,g,x,T)}function nf(s){return new _c(s)}function Ex(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Hw(s){return s.collectionGroup!==null}function Eu(s){const e=en(s);if(e.Ie===null){e.Ie=[];const n=new Set;for(const g of e.explicitOrderBy)e.Ie.push(g),n.add(g.field.canonicalString());const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(x){let T=new Qr(hi.comparator);return x.filters.forEach((b=>{b.getFlattenedFilters().forEach((w=>{w.isInequality()&&(T=T.add(w.field))}))})),T})(e).forEach((g=>{n.has(g.canonicalString())||g.isKeyField()||e.Ie.push(new Ru(g,o))})),n.has(hi.keyField().canonicalString())||e.Ie.push(new Ru(hi.keyField(),o))}return e.Ie}function Qs(s){const e=en(s);return e.Ee||(e.Ee=CS(e,Eu(s))),e.Ee}function CS(s,e){if(s.limitType==="F")return xx(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((h=>{const g=h.dir==="desc"?"asc":"desc";return new Ru(h.field,g)}));const n=s.endAt?new Nd(s.endAt.position,s.endAt.inclusive):null,o=s.startAt?new Nd(s.startAt.position,s.startAt.inclusive):null;return xx(s.path,s.collectionGroup,e,s.filters,s.limit,n,o)}}function G1(s,e){const n=s.filters.concat([e]);return new _c(s.path,s.collectionGroup,s.explicitOrderBy.slice(),n,s.limit,s.limitType,s.startAt,s.endAt)}function Od(s,e,n){return new _c(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function rf(s,e){return Cg(Qs(s),Qs(e))&&s.limitType===e.limitType}function Gw(s){return`${Tg(Qs(s))}|lt:${s.limitType}`}function $l(s){return`Query(target=${(function(n){let o=n.path.canonicalString();return n.collectionGroup!==null&&(o+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(o+=`, filters: [${n.filters.map((h=>jw(h))).join(", ")}]`),ef(n.limit)||(o+=", limit: "+n.limit),n.orderBy.length>0&&(o+=`, orderBy: [${n.orderBy.map((h=>(function(x){return`${x.field.canonicalString()} (${x.dir})`})(h))).join(", ")}]`),n.startAt&&(o+=", startAt: ",o+=n.startAt.inclusive?"b:":"a:",o+=n.startAt.position.map((h=>fc(h))).join(",")),n.endAt&&(o+=", endAt: ",o+=n.endAt.inclusive?"a:":"b:",o+=n.endAt.position.map((h=>fc(h))).join(",")),`Target(${o})`})(Qs(s))}; limitType=${s.limitType})`}function sf(s,e){return e.isFoundDocument()&&(function(o,h){const g=h.key.path;return o.collectionGroup!==null?h.key.hasCollectionId(o.collectionGroup)&&o.path.isPrefixOf(g):Lt.isDocumentKey(o.path)?o.path.isEqual(g):o.path.isImmediateParentOf(g)})(s,e)&&(function(o,h){for(const g of Eu(o))if(!g.field.isKeyField()&&h.data.field(g.field)===null)return!1;return!0})(s,e)&&(function(o,h){for(const g of o.filters)if(!g.matches(h))return!1;return!0})(s,e)&&(function(o,h){return!(o.startAt&&!(function(x,T,b){const w=px(x,T,b);return x.inclusive?w<=0:w<0})(o.startAt,Eu(o),h)||o.endAt&&!(function(x,T,b){const w=px(x,T,b);return x.inclusive?w>=0:w>0})(o.endAt,Eu(o),h))})(s,e)}function SS(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function qw(s){return(e,n)=>{let o=!1;for(const h of Eu(s)){const g=IS(h,e,n);if(g!==0)return g;o=o||h.field.isKeyField()}return 0}}function IS(s,e,n){const o=s.field.isKeyField()?Lt.comparator(e.key,n.key):(function(g,x,T){const b=x.data.field(g),w=T.data.field(g);return b!==null&&w!==null?dc(b,w):Xt(42886)})(s.field,e,n);switch(s.dir){case"asc":return o;case"desc":return-1*o;default:return Xt(19790,{direction:s.dir})}}class _l{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),o=this.inner[n];if(o!==void 0){for(const[h,g]of o)if(this.equalsFn(h,e))return g}}has(e){return this.get(e)!==void 0}set(e,n){const o=this.mapKeyFn(e),h=this.inner[o];if(h===void 0)return this.inner[o]=[[e,n]],void this.innerSize++;for(let g=0;g<h.length;g++)if(this.equalsFn(h[g][0],e))return void(h[g]=[e,n]);h.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return!1;for(let h=0;h<o.length;h++)if(this.equalsFn(o[h][0],e))return o.length===1?delete this.inner[n]:o.splice(h,1),this.innerSize--,!0;return!1}forEach(e){Vo(this.inner,((n,o)=>{for(const[h,g]of o)e(h,g)}))}isEmpty(){return Iw(this.inner)}size(){return this.innerSize}}const RS=new br(Lt.comparator);function Va(){return RS}const Xw=new br(Lt.comparator);function du(...s){let e=Xw;for(const n of s)e=e.insert(n.key,n);return e}function Yw(s){let e=Xw;return s.forEach(((n,o)=>e=e.insert(n,o.overlayedDocument))),e}function al(){return wu()}function Ww(){return wu()}function wu(){return new _l((s=>s.toString()),((s,e)=>s.isEqual(e)))}const NS=new br(Lt.comparator),OS=new Qr(Lt.comparator);function Sn(...s){let e=OS;for(const n of s)e=e.add(n);return e}const DS=new Qr(Cn);function MS(){return DS}function Sg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sd(e)?"-0":e}}function Kw(s){return{integerValue:""+s}}function kS(s,e){return oS(e)?Kw(e):Sg(s,e)}class af{constructor(){this._=void 0}}function LS(s,e,n){return s instanceof Nu?(function(h,g){const x={fields:{[Ow]:{stringValue:Nw},[Mw]:{timestampValue:{seconds:h.seconds,nanos:h.nanoseconds}}}};return g&&bg(g)&&(g=tf(g)),g&&(x.fields[Dw]=g),{mapValue:x}})(n,e):s instanceof Ou?Zw(s,e):s instanceof Du?Jw(s,e):(function(h,g){const x=Qw(h,g),T=wx(x)+wx(h.Ae);return j1(x)&&j1(h.Ae)?Kw(T):Sg(h.serializer,T)})(s,e)}function PS(s,e,n){return s instanceof Ou?Zw(s,e):s instanceof Du?Jw(s,e):n}function Qw(s,e){return s instanceof Dd?(function(o){return j1(o)||(function(g){return!!g&&"doubleValue"in g})(o)})(e)?e:{integerValue:0}:null}class Nu extends af{}class Ou extends af{constructor(e){super(),this.elements=e}}function Zw(s,e){const n=$w(e);for(const o of s.elements)n.some((h=>ea(h,o)))||n.push(o);return{arrayValue:{values:n}}}class Du extends af{constructor(e){super(),this.elements=e}}function Jw(s,e){let n=$w(e);for(const o of s.elements)n=n.filter((h=>!ea(h,o)));return{arrayValue:{values:n}}}class Dd extends af{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function wx(s){return Vr(s.integerValue||s.doubleValue)}function $w(s){return vg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class BS{constructor(e,n){this.field=e,this.transform=n}}function VS(s,e){return s.field.isEqual(e.field)&&(function(o,h){return o instanceof Ou&&h instanceof Ou||o instanceof Du&&h instanceof Du?hc(o.elements,h.elements,ea):o instanceof Dd&&h instanceof Dd?ea(o.Ae,h.Ae):o instanceof Nu&&h instanceof Nu})(s.transform,e.transform)}class US{constructor(e,n){this.version=e,this.transformResults=n}}class Mi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Mi}static exists(e){return new Mi(void 0,e)}static updateTime(e){return new Mi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function md(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class of{}function e_(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new lf(s.key,Mi.none()):new Fu(s.key,s.data,Mi.none());{const n=s.data,o=Wi.empty();let h=new Qr(hi.comparator);for(let g of e.fields)if(!h.has(g)){let x=n.field(g);x===null&&g.length>1&&(g=g.popLast(),x=n.field(g)),x===null?o.delete(g):o.set(g,x),h=h.add(g)}return new Uo(s.key,o,new us(h.toArray()),Mi.none())}}function FS(s,e,n){s instanceof Fu?(function(h,g,x){const T=h.value.clone(),b=Ax(h.fieldTransforms,g,x.transformResults);T.setAll(b),g.convertToFoundDocument(x.version,T).setHasCommittedMutations()})(s,e,n):s instanceof Uo?(function(h,g,x){if(!md(h.precondition,g))return void g.convertToUnknownDocument(x.version);const T=Ax(h.fieldTransforms,g,x.transformResults),b=g.data;b.setAll(t_(h)),b.setAll(T),g.convertToFoundDocument(x.version,b).setHasCommittedMutations()})(s,e,n):(function(h,g,x){g.convertToNoDocument(x.version).setHasCommittedMutations()})(0,e,n)}function _u(s,e,n,o){return s instanceof Fu?(function(g,x,T,b){if(!md(g.precondition,x))return T;const w=g.value.clone(),C=bx(g.fieldTransforms,b,x);return w.setAll(C),x.convertToFoundDocument(x.version,w).setHasLocalMutations(),null})(s,e,n,o):s instanceof Uo?(function(g,x,T,b){if(!md(g.precondition,x))return T;const w=bx(g.fieldTransforms,b,x),C=x.data;return C.setAll(t_(g)),C.setAll(w),x.convertToFoundDocument(x.version,C).setHasLocalMutations(),T===null?null:T.unionWith(g.fieldMask.fields).unionWith(g.fieldTransforms.map((N=>N.field)))})(s,e,n,o):(function(g,x,T){return md(g.precondition,x)?(x.convertToNoDocument(x.version).setHasLocalMutations(),null):T})(s,e,n)}function jS(s,e){let n=null;for(const o of s.fieldTransforms){const h=e.data.field(o.field),g=Qw(o.transform,h||null);g!=null&&(n===null&&(n=Wi.empty()),n.set(o.field,g))}return n||null}function _x(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(o,h){return o===void 0&&h===void 0||!(!o||!h)&&hc(o,h,((g,x)=>VS(g,x)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Fu extends of{constructor(e,n,o,h=[]){super(),this.key=e,this.value=n,this.precondition=o,this.fieldTransforms=h,this.type=0}getFieldMask(){return null}}class Uo extends of{constructor(e,n,o,h,g=[]){super(),this.key=e,this.data=n,this.fieldMask=o,this.precondition=h,this.fieldTransforms=g,this.type=1}getFieldMask(){return this.fieldMask}}function t_(s){const e=new Map;return s.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const o=s.data.field(n);e.set(n,o)}})),e}function Ax(s,e,n){const o=new Map;qn(s.length===n.length,32656,{Re:n.length,Ve:s.length});for(let h=0;h<n.length;h++){const g=s[h],x=g.transform,T=e.data.field(g.field);o.set(g.field,PS(x,T,n[h]))}return o}function bx(s,e,n){const o=new Map;for(const h of s){const g=h.transform,x=n.data.field(h.field);o.set(h.field,LS(g,x,e))}return o}class lf extends of{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zS extends of{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class HS{constructor(e,n,o,h){this.batchId=e,this.localWriteTime=n,this.baseMutations=o,this.mutations=h}applyToRemoteDocument(e,n){const o=n.mutationResults;for(let h=0;h<this.mutations.length;h++){const g=this.mutations[h];g.key.isEqual(e.key)&&FS(g,e,o[h])}}applyToLocalView(e,n){for(const o of this.baseMutations)o.key.isEqual(e.key)&&(n=_u(o,e,n,this.localWriteTime));for(const o of this.mutations)o.key.isEqual(e.key)&&(n=_u(o,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const o=Ww();return this.mutations.forEach((h=>{const g=e.get(h.key),x=g.overlayedDocument;let T=this.applyToLocalView(x,g.mutatedFields);T=n.has(h.key)?null:T;const b=e_(x,T);b!==null&&o.set(h.key,b),x.isValidDocument()||x.convertToNoDocument(Kt.min())})),o}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&hc(this.mutations,e.mutations,((n,o)=>_x(n,o)))&&hc(this.baseMutations,e.baseMutations,((n,o)=>_x(n,o)))}}class Ig{constructor(e,n,o,h){this.batch=e,this.commitVersion=n,this.mutationResults=o,this.docVersions=h}static from(e,n,o){qn(e.mutations.length===o.length,58842,{me:e.mutations.length,fe:o.length});let h=(function(){return NS})();const g=e.mutations;for(let x=0;x<g.length;x++)h=h.insert(g[x].key,o[x].version);return new Ig(e,n,o,h)}}class GS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class qS{constructor(e,n){this.count=e,this.unchangedNames=n}}var Hr,Mn;function XS(s){switch(s){case De.OK:return Xt(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return Xt(15467,{code:s})}}function n_(s){if(s===void 0)return Ba("GRPC error has no .code"),De.UNKNOWN;switch(s){case Hr.OK:return De.OK;case Hr.CANCELLED:return De.CANCELLED;case Hr.UNKNOWN:return De.UNKNOWN;case Hr.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Hr.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Hr.INTERNAL:return De.INTERNAL;case Hr.UNAVAILABLE:return De.UNAVAILABLE;case Hr.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Hr.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Hr.NOT_FOUND:return De.NOT_FOUND;case Hr.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Hr.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Hr.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Hr.ABORTED:return De.ABORTED;case Hr.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Hr.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Hr.DATA_LOSS:return De.DATA_LOSS;default:return Xt(39323,{code:s})}}(Mn=Hr||(Hr={}))[Mn.OK=0]="OK",Mn[Mn.CANCELLED=1]="CANCELLED",Mn[Mn.UNKNOWN=2]="UNKNOWN",Mn[Mn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mn[Mn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mn[Mn.NOT_FOUND=5]="NOT_FOUND",Mn[Mn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mn[Mn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mn[Mn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mn[Mn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mn[Mn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mn[Mn.ABORTED=10]="ABORTED",Mn[Mn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mn[Mn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mn[Mn.INTERNAL=13]="INTERNAL",Mn[Mn.UNAVAILABLE=14]="UNAVAILABLE",Mn[Mn.DATA_LOSS=15]="DATA_LOSS";function YS(){return new TextEncoder}const WS=new So([4294967295,4294967295],0);function vx(s){const e=YS().encode(s),n=new yw;return n.update(e),new Uint8Array(n.digest())}function Tx(s){const e=new DataView(s.buffer),n=e.getUint32(0,!0),o=e.getUint32(4,!0),h=e.getUint32(8,!0),g=e.getUint32(12,!0);return[new So([n,o],0),new So([h,g],0)]}class Rg{constructor(e,n,o){if(this.bitmap=e,this.padding=n,this.hashCount=o,n<0||n>=8)throw new fu(`Invalid padding: ${n}`);if(o<0)throw new fu(`Invalid hash count: ${o}`);if(e.length>0&&this.hashCount===0)throw new fu(`Invalid hash count: ${o}`);if(e.length===0&&n!==0)throw new fu(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=So.fromNumber(this.ge)}ye(e,n,o){let h=e.add(n.multiply(So.fromNumber(o)));return h.compare(WS)===1&&(h=new So([h.getBits(0),h.getBits(1)],0)),h.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=vx(e),[o,h]=Tx(n);for(let g=0;g<this.hashCount;g++){const x=this.ye(o,h,g);if(!this.we(x))return!1}return!0}static create(e,n,o){const h=e%8==0?0:8-e%8,g=new Uint8Array(Math.ceil(e/8)),x=new Rg(g,h,n);return o.forEach((T=>x.insert(T))),x}insert(e){if(this.ge===0)return;const n=vx(e),[o,h]=Tx(n);for(let g=0;g<this.hashCount;g++){const x=this.ye(o,h,g);this.Se(x)}}Se(e){const n=Math.floor(e/8),o=e%8;this.bitmap[n]|=1<<o}}class fu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class cf{constructor(e,n,o,h,g){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=o,this.documentUpdates=h,this.resolvedLimboDocuments=g}static createSynthesizedRemoteEventForCurrentChange(e,n,o){const h=new Map;return h.set(e,ju.createSynthesizedTargetChangeForCurrentChange(e,n,o)),new cf(Kt.min(),h,new br(Cn),Va(),Sn())}}class ju{constructor(e,n,o,h,g){this.resumeToken=e,this.current=n,this.addedDocuments=o,this.modifiedDocuments=h,this.removedDocuments=g}static createSynthesizedTargetChangeForCurrentChange(e,n,o){return new ju(o,n,Sn(),Sn(),Sn())}}class pd{constructor(e,n,o,h){this.be=e,this.removedTargetIds=n,this.key=o,this.De=h}}class r_{constructor(e,n){this.targetId=e,this.Ce=n}}class i_{constructor(e,n,o=di.EMPTY_BYTE_STRING,h=null){this.state=e,this.targetIds=n,this.resumeToken=o,this.cause=h}}class Cx{constructor(){this.ve=0,this.Fe=Sx(),this.Me=di.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Sn(),n=Sn(),o=Sn();return this.Fe.forEach(((h,g)=>{switch(g){case 0:e=e.add(h);break;case 2:n=n.add(h);break;case 1:o=o.add(h);break;default:Xt(38017,{changeType:g})}})),new ju(this.Me,this.xe,e,n,o)}qe(){this.Oe=!1,this.Fe=Sx()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,qn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class KS{constructor(e){this.Ge=e,this.ze=new Map,this.je=Va(),this.Je=id(),this.He=id(),this.Ye=new br(Cn)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const o=this.nt(n);switch(e.state){case 0:this.rt(n)&&o.Le(e.resumeToken);break;case 1:o.Ke(),o.Ne||o.qe(),o.Le(e.resumeToken);break;case 2:o.Ke(),o.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(o.We(),o.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),o.Le(e.resumeToken));break;default:Xt(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((o,h)=>{this.rt(h)&&n(h)}))}st(e){const n=e.targetId,o=e.Ce.count,h=this.ot(n);if(h){const g=h.target;if(H1(g))if(o===0){const x=new Lt(g.path);this.et(n,x,Ai.newNoDocument(x,Kt.min()))}else qn(o===1,20013,{expectedCount:o});else{const x=this._t(n);if(x!==o){const T=this.ut(e),b=T?this.ct(T,e,x):1;if(b!==0){this.it(n);const w=b===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,w)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:o="",padding:h=0},hashCount:g=0}=n;let x,T;try{x=Mo(o).toUint8Array()}catch(b){if(b instanceof Rw)return uc("Decoding the base64 bloom filter in existence filter failed ("+b.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw b}try{T=new Rg(x,h,g)}catch(b){return uc(b instanceof fu?"BloomFilter error: ":"Applying bloom filter failed: ",b),null}return T.ge===0?null:T}ct(e,n,o){return n.Ce.count===o-this.Pt(e,n.targetId)?0:2}Pt(e,n){const o=this.Ge.getRemoteKeysForTarget(n);let h=0;return o.forEach((g=>{const x=this.Ge.ht(),T=`projects/${x.projectId}/databases/${x.database}/documents/${g.path.canonicalString()}`;e.mightContain(T)||(this.et(n,g,null),h++)})),h}Tt(e){const n=new Map;this.ze.forEach(((g,x)=>{const T=this.ot(x);if(T){if(g.current&&H1(T.target)){const b=new Lt(T.target.path);this.It(b).has(x)||this.Et(x,b)||this.et(x,b,Ai.newNoDocument(b,e))}g.Be&&(n.set(x,g.ke()),g.qe())}}));let o=Sn();this.He.forEach(((g,x)=>{let T=!0;x.forEachWhile((b=>{const w=this.ot(b);return!w||w.purpose==="TargetPurposeLimboResolution"||(T=!1,!1)})),T&&(o=o.add(g))})),this.je.forEach(((g,x)=>x.setReadTime(e)));const h=new cf(e,n,this.Ye,this.je,o);return this.je=Va(),this.Je=id(),this.He=id(),this.Ye=new br(Cn),h}Xe(e,n){if(!this.rt(e))return;const o=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,o),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,o){if(!this.rt(e))return;const h=this.nt(e);this.Et(e,n)?h.Qe(n,1):h.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),o&&(this.je=this.je.insert(n,o))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Cx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Qr(Cn),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Qr(Cn),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||wt("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Cx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function id(){return new br(Lt.comparator)}function Sx(){return new br(Lt.comparator)}const QS={asc:"ASCENDING",desc:"DESCENDING"},ZS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JS={and:"AND",or:"OR"};class $S{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function q1(s,e){return s.useProto3Json||ef(e)?e:{value:e}}function Md(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function s_(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function eI(s,e){return Md(s,e.toTimestamp())}function Zs(s){return qn(!!s,49232),Kt.fromTimestamp((function(n){const o=Do(n);return new Vn(o.seconds,o.nanos)})(s))}function Ng(s,e){return X1(s,e).canonicalString()}function X1(s,e){const n=(function(h){return new or(["projects",h.projectId,"databases",h.database])})(s).child("documents");return e===void 0?n:n.child(e)}function a_(s){const e=or.fromString(s);return qn(h_(e),10190,{key:e.toString()}),e}function Y1(s,e){return Ng(s.databaseId,e.path)}function E1(s,e){const n=a_(e);if(n.get(1)!==s.databaseId.projectId)throw new ct(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new ct(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new Lt(l_(n))}function o_(s,e){return Ng(s.databaseId,e)}function tI(s){const e=a_(s);return e.length===4?or.emptyPath():l_(e)}function W1(s){return new or(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function l_(s){return qn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Ix(s,e,n){return{name:Y1(s,e),fields:n.value.mapValue.fields}}function nI(s,e){let n;if("targetChange"in e){e.targetChange;const o=(function(w){return w==="NO_CHANGE"?0:w==="ADD"?1:w==="REMOVE"?2:w==="CURRENT"?3:w==="RESET"?4:Xt(39313,{state:w})})(e.targetChange.targetChangeType||"NO_CHANGE"),h=e.targetChange.targetIds||[],g=(function(w,C){return w.useProto3Json?(qn(C===void 0||typeof C=="string",58123),di.fromBase64String(C||"")):(qn(C===void 0||C instanceof Buffer||C instanceof Uint8Array,16193),di.fromUint8Array(C||new Uint8Array))})(s,e.targetChange.resumeToken),x=e.targetChange.cause,T=x&&(function(w){const C=w.code===void 0?De.UNKNOWN:n_(w.code);return new ct(C,w.message||"")})(x);n=new i_(o,h,g,T||null)}else if("documentChange"in e){e.documentChange;const o=e.documentChange;o.document,o.document.name,o.document.updateTime;const h=E1(s,o.document.name),g=Zs(o.document.updateTime),x=o.document.createTime?Zs(o.document.createTime):Kt.min(),T=new Wi({mapValue:{fields:o.document.fields}}),b=Ai.newFoundDocument(h,g,x,T),w=o.targetIds||[],C=o.removedTargetIds||[];n=new pd(w,C,b.key,b)}else if("documentDelete"in e){e.documentDelete;const o=e.documentDelete;o.document;const h=E1(s,o.document),g=o.readTime?Zs(o.readTime):Kt.min(),x=Ai.newNoDocument(h,g),T=o.removedTargetIds||[];n=new pd([],T,x.key,x)}else if("documentRemove"in e){e.documentRemove;const o=e.documentRemove;o.document;const h=E1(s,o.document),g=o.removedTargetIds||[];n=new pd([],g,h,null)}else{if(!("filter"in e))return Xt(11601,{Rt:e});{e.filter;const o=e.filter;o.targetId;const{count:h=0,unchangedNames:g}=o,x=new qS(h,g),T=o.targetId;n=new r_(T,x)}}return n}function rI(s,e){let n;if(e instanceof Fu)n={update:Ix(s,e.key,e.value)};else if(e instanceof lf)n={delete:Y1(s,e.key)};else if(e instanceof Uo)n={update:Ix(s,e.key,e.data),updateMask:dI(e.fieldMask)};else{if(!(e instanceof zS))return Xt(16599,{Vt:e.type});n={verify:Y1(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((o=>(function(g,x){const T=x.transform;if(T instanceof Nu)return{fieldPath:x.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(T instanceof Ou)return{fieldPath:x.field.canonicalString(),appendMissingElements:{values:T.elements}};if(T instanceof Du)return{fieldPath:x.field.canonicalString(),removeAllFromArray:{values:T.elements}};if(T instanceof Dd)return{fieldPath:x.field.canonicalString(),increment:T.Ae};throw Xt(20930,{transform:x.transform})})(0,o)))),e.precondition.isNone||(n.currentDocument=(function(h,g){return g.updateTime!==void 0?{updateTime:eI(h,g.updateTime)}:g.exists!==void 0?{exists:g.exists}:Xt(27497)})(s,e.precondition)),n}function iI(s,e){return s&&s.length>0?(qn(e!==void 0,14353),s.map((n=>(function(h,g){let x=h.updateTime?Zs(h.updateTime):Zs(g);return x.isEqual(Kt.min())&&(x=Zs(g)),new US(x,h.transformResults||[])})(n,e)))):[]}function sI(s,e){return{documents:[o_(s,e.path)]}}function aI(s,e){const n={structuredQuery:{}},o=e.path;let h;e.collectionGroup!==null?(h=o,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(h=o.popLast(),n.structuredQuery.from=[{collectionId:o.lastSegment()}]),n.parent=o_(s,h);const g=(function(w){if(w.length!==0)return u_(Ls.create(w,"and"))})(e.filters);g&&(n.structuredQuery.where=g);const x=(function(w){if(w.length!==0)return w.map((C=>(function(P){return{field:ec(P.field),direction:cI(P.dir)}})(C)))})(e.orderBy);x&&(n.structuredQuery.orderBy=x);const T=q1(s,e.limit);return T!==null&&(n.structuredQuery.limit=T),e.startAt&&(n.structuredQuery.startAt=(function(w){return{before:w.inclusive,values:w.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(w){return{before:!w.inclusive,values:w.position}})(e.endAt)),{ft:n,parent:h}}function oI(s){let e=tI(s.parent);const n=s.structuredQuery,o=n.from?n.from.length:0;let h=null;if(o>0){qn(o===1,65062);const C=n.from[0];C.allDescendants?h=C.collectionId:e=e.child(C.collectionId)}let g=[];n.where&&(g=(function(N){const P=c_(N);return P instanceof Ls&&Uw(P)?P.getFilters():[P]})(n.where));let x=[];n.orderBy&&(x=(function(N){return N.map((P=>(function(ee){return new Ru(tc(ee.field),(function(ae){switch(ae){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(ee.direction))})(P)))})(n.orderBy));let T=null;n.limit&&(T=(function(N){let P;return P=typeof N=="object"?N.value:N,ef(P)?null:P})(n.limit));let b=null;n.startAt&&(b=(function(N){const P=!!N.before,B=N.values||[];return new Nd(B,P)})(n.startAt));let w=null;return n.endAt&&(w=(function(N){const P=!N.before,B=N.values||[];return new Nd(B,P)})(n.endAt)),TS(e,h,x,g,T,"F",b,w)}function lI(s,e){const n=(function(h){switch(h){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xt(28987,{purpose:h})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function c_(s){return s.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const o=tc(n.unaryFilter.field);return Gr.create(o,"==",{doubleValue:NaN});case"IS_NULL":const h=tc(n.unaryFilter.field);return Gr.create(h,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const g=tc(n.unaryFilter.field);return Gr.create(g,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const x=tc(n.unaryFilter.field);return Gr.create(x,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xt(61313);default:return Xt(60726)}})(s):s.fieldFilter!==void 0?(function(n){return Gr.create(tc(n.fieldFilter.field),(function(h){switch(h){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xt(58110);default:return Xt(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(n){return Ls.create(n.compositeFilter.filters.map((o=>c_(o))),(function(h){switch(h){case"AND":return"and";case"OR":return"or";default:return Xt(1026)}})(n.compositeFilter.op))})(s):Xt(30097,{filter:s})}function cI(s){return QS[s]}function uI(s){return ZS[s]}function hI(s){return JS[s]}function ec(s){return{fieldPath:s.canonicalString()}}function tc(s){return hi.fromServerFormat(s.fieldPath)}function u_(s){return s instanceof Gr?(function(n){if(n.op==="=="){if(mx(n.value))return{unaryFilter:{field:ec(n.field),op:"IS_NAN"}};if(gx(n.value))return{unaryFilter:{field:ec(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(mx(n.value))return{unaryFilter:{field:ec(n.field),op:"IS_NOT_NAN"}};if(gx(n.value))return{unaryFilter:{field:ec(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ec(n.field),op:uI(n.op),value:n.value}}})(s):s instanceof Ls?(function(n){const o=n.getFilters().map((h=>u_(h)));return o.length===1?o[0]:{compositeFilter:{op:hI(n.op),filters:o}}})(s):Xt(54877,{filter:s})}function dI(s){const e=[];return s.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function h_(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}class vo{constructor(e,n,o,h,g=Kt.min(),x=Kt.min(),T=di.EMPTY_BYTE_STRING,b=null){this.target=e,this.targetId=n,this.purpose=o,this.sequenceNumber=h,this.snapshotVersion=g,this.lastLimboFreeSnapshotVersion=x,this.resumeToken=T,this.expectedCount=b}withSequenceNumber(e){return new vo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new vo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class fI{constructor(e){this.yt=e}}function gI(s){const e=oI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Od(e,e.limit,"L"):e}class mI{constructor(){this.Cn=new pI}addToCollectionParentIndex(e,n){return this.Cn.add(n),Ue.resolve()}getCollectionParents(e,n){return Ue.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return Ue.resolve()}deleteFieldIndex(e,n){return Ue.resolve()}deleteAllFieldIndexes(e){return Ue.resolve()}createTargetIndexes(e,n){return Ue.resolve()}getDocumentsMatchingTarget(e,n){return Ue.resolve(null)}getIndexType(e,n){return Ue.resolve(0)}getFieldIndexes(e,n){return Ue.resolve([])}getNextCollectionGroupToUpdate(e){return Ue.resolve(null)}getMinOffset(e,n){return Ue.resolve(Oo.min())}getMinOffsetFromCollectionGroup(e,n){return Ue.resolve(Oo.min())}updateCollectionGroup(e,n,o){return Ue.resolve()}updateIndexEntries(e,n){return Ue.resolve()}}class pI{constructor(){this.index={}}add(e){const n=e.lastSegment(),o=e.popLast(),h=this.index[n]||new Qr(or.comparator),g=!h.has(o);return this.index[n]=h.add(o),g}has(e){const n=e.lastSegment(),o=e.popLast(),h=this.index[n];return h&&h.has(o)}getEntries(e){return(this.index[e]||new Qr(or.comparator)).toArray()}}const Rx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},d_=41943040;class Yi{static withCacheSize(e){return new Yi(e,Yi.DEFAULT_COLLECTION_PERCENTILE,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,o){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=o}}Yi.DEFAULT_COLLECTION_PERCENTILE=10,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yi.DEFAULT=new Yi(d_,Yi.DEFAULT_COLLECTION_PERCENTILE,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yi.DISABLED=new Yi(-1,0,0);class gc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new gc(0)}static cr(){return new gc(-1)}}const Nx="LruGarbageCollector",yI=1048576;function Ox([s,e],[n,o]){const h=Cn(s,n);return h===0?Cn(e,o):h}class xI{constructor(e){this.Ir=e,this.buffer=new Qr(Ox),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const o=this.buffer.last();Ox(n,o)<0&&(this.buffer=this.buffer.delete(o).add(n))}}get maxValue(){return this.buffer.last()[0]}}class EI{constructor(e,n,o){this.garbageCollector=e,this.asyncQueue=n,this.localStore=o,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){wt(Nx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){wc(n)?wt(Nx,"Ignoring IndexedDB error during garbage collection: ",n):await Ec(n)}await this.Vr(3e5)}))}}class wI{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((o=>Math.floor(n/100*o)))}nthSequenceNumber(e,n){if(n===0)return Ue.resolve($d.ce);const o=new xI(n);return this.mr.forEachTarget(e,(h=>o.Ar(h.sequenceNumber))).next((()=>this.mr.pr(e,(h=>o.Ar(h))))).next((()=>o.maxValue))}removeTargets(e,n,o){return this.mr.removeTargets(e,n,o)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(wt("LruGarbageCollector","Garbage collection skipped; disabled"),Ue.resolve(Rx)):this.getCacheSize(e).next((o=>o<this.params.cacheSizeCollectionThreshold?(wt("LruGarbageCollector",`Garbage collection skipped; Cache size ${o} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Rx):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let o,h,g,x,T,b,w;const C=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((N=>(N>this.params.maximumSequenceNumbersToCollect?(wt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),h=this.params.maximumSequenceNumbersToCollect):h=N,x=Date.now(),this.nthSequenceNumber(e,h)))).next((N=>(o=N,T=Date.now(),this.removeTargets(e,o,n)))).next((N=>(g=N,b=Date.now(),this.removeOrphanedDocuments(e,o)))).next((N=>(w=Date.now(),Jl()<=vn.DEBUG&&wt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${x-C}ms
	Determined least recently used ${h} in `+(T-x)+`ms
	Removed ${g} targets in `+(b-T)+`ms
	Removed ${N} documents in `+(w-b)+`ms
Total Duration: ${w-C}ms`),Ue.resolve({didRun:!0,sequenceNumbersCollected:h,targetsRemoved:g,documentsRemoved:N}))))}}function _I(s,e){return new wI(s,e)}class AI{constructor(){this.changes=new _l((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ai.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const o=this.changes.get(n);return o!==void 0?Ue.resolve(o):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bI{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class vI{constructor(e,n,o,h){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=o,this.indexManager=h}getDocument(e,n){let o=null;return this.documentOverlayCache.getOverlay(e,n).next((h=>(o=h,this.remoteDocumentCache.getEntry(e,n)))).next((h=>(o!==null&&_u(o.mutation,h,us.empty(),Vn.now()),h)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((o=>this.getLocalViewOfDocuments(e,o,Sn()).next((()=>o))))}getLocalViewOfDocuments(e,n,o=Sn()){const h=al();return this.populateOverlays(e,h,n).next((()=>this.computeViews(e,n,h,o).next((g=>{let x=du();return g.forEach(((T,b)=>{x=x.insert(T,b.overlayedDocument)})),x}))))}getOverlayedDocuments(e,n){const o=al();return this.populateOverlays(e,o,n).next((()=>this.computeViews(e,n,o,Sn())))}populateOverlays(e,n,o){const h=[];return o.forEach((g=>{n.has(g)||h.push(g)})),this.documentOverlayCache.getOverlays(e,h).next((g=>{g.forEach(((x,T)=>{n.set(x,T)}))}))}computeViews(e,n,o,h){let g=Va();const x=wu(),T=(function(){return wu()})();return n.forEach(((b,w)=>{const C=o.get(w.key);h.has(w.key)&&(C===void 0||C.mutation instanceof Uo)?g=g.insert(w.key,w):C!==void 0?(x.set(w.key,C.mutation.getFieldMask()),_u(C.mutation,w,C.mutation.getFieldMask(),Vn.now())):x.set(w.key,us.empty())})),this.recalculateAndSaveOverlays(e,g).next((b=>(b.forEach(((w,C)=>x.set(w,C))),n.forEach(((w,C)=>T.set(w,new bI(C,x.get(w)??null)))),T)))}recalculateAndSaveOverlays(e,n){const o=wu();let h=new br(((x,T)=>x-T)),g=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((x=>{for(const T of x)T.keys().forEach((b=>{const w=n.get(b);if(w===null)return;let C=o.get(b)||us.empty();C=T.applyToLocalView(w,C),o.set(b,C);const N=(h.get(T.batchId)||Sn()).add(b);h=h.insert(T.batchId,N)}))})).next((()=>{const x=[],T=h.getReverseIterator();for(;T.hasNext();){const b=T.getNext(),w=b.key,C=b.value,N=Ww();C.forEach((P=>{if(!g.has(P)){const B=e_(n.get(P),o.get(P));B!==null&&N.set(P,B),g=g.add(P)}})),x.push(this.documentOverlayCache.saveOverlays(e,w,N))}return Ue.waitFor(x)})).next((()=>o))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((o=>this.recalculateAndSaveOverlays(e,o)))}getDocumentsMatchingQuery(e,n,o,h){return(function(x){return Lt.isDocumentKey(x.path)&&x.collectionGroup===null&&x.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Hw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,o,h):this.getDocumentsMatchingCollectionQuery(e,n,o,h)}getNextDocuments(e,n,o,h){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,o,h).next((g=>{const x=h-g.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,o.largestBatchId,h-g.size):Ue.resolve(al());let T=Tu,b=g;return x.next((w=>Ue.forEach(w,((C,N)=>(T<N.largestBatchId&&(T=N.largestBatchId),g.get(C)?Ue.resolve():this.remoteDocumentCache.getEntry(e,C).next((P=>{b=b.insert(C,P)}))))).next((()=>this.populateOverlays(e,w,g))).next((()=>this.computeViews(e,b,w,Sn()))).next((C=>({batchId:T,changes:Yw(C)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Lt(n)).next((o=>{let h=du();return o.isFoundDocument()&&(h=h.insert(o.key,o)),h}))}getDocumentsMatchingCollectionGroupQuery(e,n,o,h){const g=n.collectionGroup;let x=du();return this.indexManager.getCollectionParents(e,g).next((T=>Ue.forEach(T,(b=>{const w=(function(N,P){return new _c(P,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)})(n,b.child(g));return this.getDocumentsMatchingCollectionQuery(e,w,o,h).next((C=>{C.forEach(((N,P)=>{x=x.insert(N,P)}))}))})).next((()=>x))))}getDocumentsMatchingCollectionQuery(e,n,o,h){let g;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,o.largestBatchId).next((x=>(g=x,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,o,g,h)))).next((x=>{g.forEach(((b,w)=>{const C=w.getKey();x.get(C)===null&&(x=x.insert(C,Ai.newInvalidDocument(C)))}));let T=du();return x.forEach(((b,w)=>{const C=g.get(b);C!==void 0&&_u(C.mutation,w,us.empty(),Vn.now()),sf(n,w)&&(T=T.insert(b,w))})),T}))}}class TI{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return Ue.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(h){return{id:h.id,version:h.version,createTime:Zs(h.createTime)}})(n)),Ue.resolve()}getNamedQuery(e,n){return Ue.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(h){return{name:h.name,query:gI(h.bundledQuery),readTime:Zs(h.readTime)}})(n)),Ue.resolve()}}class CI{constructor(){this.overlays=new br(Lt.comparator),this.qr=new Map}getOverlay(e,n){return Ue.resolve(this.overlays.get(n))}getOverlays(e,n){const o=al();return Ue.forEach(n,(h=>this.getOverlay(e,h).next((g=>{g!==null&&o.set(h,g)})))).next((()=>o))}saveOverlays(e,n,o){return o.forEach(((h,g)=>{this.St(e,n,g)})),Ue.resolve()}removeOverlaysForBatchId(e,n,o){const h=this.qr.get(o);return h!==void 0&&(h.forEach((g=>this.overlays=this.overlays.remove(g))),this.qr.delete(o)),Ue.resolve()}getOverlaysForCollection(e,n,o){const h=al(),g=n.length+1,x=new Lt(n.child("")),T=this.overlays.getIteratorFrom(x);for(;T.hasNext();){const b=T.getNext().value,w=b.getKey();if(!n.isPrefixOf(w.path))break;w.path.length===g&&b.largestBatchId>o&&h.set(b.getKey(),b)}return Ue.resolve(h)}getOverlaysForCollectionGroup(e,n,o,h){let g=new br(((w,C)=>w-C));const x=this.overlays.getIterator();for(;x.hasNext();){const w=x.getNext().value;if(w.getKey().getCollectionGroup()===n&&w.largestBatchId>o){let C=g.get(w.largestBatchId);C===null&&(C=al(),g=g.insert(w.largestBatchId,C)),C.set(w.getKey(),w)}}const T=al(),b=g.getIterator();for(;b.hasNext()&&(b.getNext().value.forEach(((w,C)=>T.set(w,C))),!(T.size()>=h)););return Ue.resolve(T)}St(e,n,o){const h=this.overlays.get(o.key);if(h!==null){const x=this.qr.get(h.largestBatchId).delete(o.key);this.qr.set(h.largestBatchId,x)}this.overlays=this.overlays.insert(o.key,new GS(n,o));let g=this.qr.get(n);g===void 0&&(g=Sn(),this.qr.set(n,g)),this.qr.set(n,g.add(o.key))}}class SI{constructor(){this.sessionToken=di.EMPTY_BYTE_STRING}getSessionToken(e){return Ue.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Ue.resolve()}}class Og{constructor(){this.Qr=new Qr(ni.$r),this.Ur=new Qr(ni.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const o=new ni(e,n);this.Qr=this.Qr.add(o),this.Ur=this.Ur.add(o)}Wr(e,n){e.forEach((o=>this.addReference(o,n)))}removeReference(e,n){this.Gr(new ni(e,n))}zr(e,n){e.forEach((o=>this.removeReference(o,n)))}jr(e){const n=new Lt(new or([])),o=new ni(n,e),h=new ni(n,e+1),g=[];return this.Ur.forEachInRange([o,h],(x=>{this.Gr(x),g.push(x.key)})),g}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Lt(new or([])),o=new ni(n,e),h=new ni(n,e+1);let g=Sn();return this.Ur.forEachInRange([o,h],(x=>{g=g.add(x.key)})),g}containsKey(e){const n=new ni(e,0),o=this.Qr.firstAfterOrEqual(n);return o!==null&&e.isEqual(o.key)}}class ni{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Lt.comparator(e.key,n.key)||Cn(e.Yr,n.Yr)}static Kr(e,n){return Cn(e.Yr,n.Yr)||Lt.comparator(e.key,n.key)}}class II{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Qr(ni.$r)}checkEmpty(e){return Ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,o,h){const g=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const x=new HS(g,n,o,h);this.mutationQueue.push(x);for(const T of h)this.Zr=this.Zr.add(new ni(T.key,g)),this.indexManager.addToCollectionParentIndex(e,T.key.path.popLast());return Ue.resolve(x)}lookupMutationBatch(e,n){return Ue.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const o=n+1,h=this.ei(o),g=h<0?0:h;return Ue.resolve(this.mutationQueue.length>g?this.mutationQueue[g]:null)}getHighestUnacknowledgedBatchId(){return Ue.resolve(this.mutationQueue.length===0?Ag:this.tr-1)}getAllMutationBatches(e){return Ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const o=new ni(n,0),h=new ni(n,Number.POSITIVE_INFINITY),g=[];return this.Zr.forEachInRange([o,h],(x=>{const T=this.Xr(x.Yr);g.push(T)})),Ue.resolve(g)}getAllMutationBatchesAffectingDocumentKeys(e,n){let o=new Qr(Cn);return n.forEach((h=>{const g=new ni(h,0),x=new ni(h,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([g,x],(T=>{o=o.add(T.Yr)}))})),Ue.resolve(this.ti(o))}getAllMutationBatchesAffectingQuery(e,n){const o=n.path,h=o.length+1;let g=o;Lt.isDocumentKey(g)||(g=g.child(""));const x=new ni(new Lt(g),0);let T=new Qr(Cn);return this.Zr.forEachWhile((b=>{const w=b.key.path;return!!o.isPrefixOf(w)&&(w.length===h&&(T=T.add(b.Yr)),!0)}),x),Ue.resolve(this.ti(T))}ti(e){const n=[];return e.forEach((o=>{const h=this.Xr(o);h!==null&&n.push(h)})),n}removeMutationBatch(e,n){qn(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let o=this.Zr;return Ue.forEach(n.mutations,(h=>{const g=new ni(h.key,n.batchId);return o=o.delete(g),this.referenceDelegate.markPotentiallyOrphaned(e,h.key)})).next((()=>{this.Zr=o}))}ir(e){}containsKey(e,n){const o=new ni(n,0),h=this.Zr.firstAfterOrEqual(o);return Ue.resolve(n.isEqual(h&&h.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ue.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class RI{constructor(e){this.ri=e,this.docs=(function(){return new br(Lt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const o=n.key,h=this.docs.get(o),g=h?h.size:0,x=this.ri(n);return this.docs=this.docs.insert(o,{document:n.mutableCopy(),size:x}),this.size+=x-g,this.indexManager.addToCollectionParentIndex(e,o.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const o=this.docs.get(n);return Ue.resolve(o?o.document.mutableCopy():Ai.newInvalidDocument(n))}getEntries(e,n){let o=Va();return n.forEach((h=>{const g=this.docs.get(h);o=o.insert(h,g?g.document.mutableCopy():Ai.newInvalidDocument(h))})),Ue.resolve(o)}getDocumentsMatchingQuery(e,n,o,h){let g=Va();const x=n.path,T=new Lt(x.child("__id-9223372036854775808__")),b=this.docs.getIteratorFrom(T);for(;b.hasNext();){const{key:w,value:{document:C}}=b.getNext();if(!x.isPrefixOf(w.path))break;w.path.length>x.length+1||rS(nS(C),o)<=0||(h.has(C.key)||sf(n,C))&&(g=g.insert(C.key,C.mutableCopy()))}return Ue.resolve(g)}getAllFromCollectionGroup(e,n,o,h){Xt(9500)}ii(e,n){return Ue.forEach(this.docs,(o=>n(o)))}newChangeBuffer(e){return new NI(this)}getSize(e){return Ue.resolve(this.size)}}class NI extends AI{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((o,h)=>{h.isValidDocument()?n.push(this.Nr.addEntry(e,h)):this.Nr.removeEntry(o)})),Ue.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class OI{constructor(e){this.persistence=e,this.si=new _l((n=>Tg(n)),Cg),this.lastRemoteSnapshotVersion=Kt.min(),this.highestTargetId=0,this.oi=0,this._i=new Og,this.targetCount=0,this.ai=gc.ur()}forEachTarget(e,n){return this.si.forEach(((o,h)=>n(h))),Ue.resolve()}getLastRemoteSnapshotVersion(e){return Ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ue.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ue.resolve(this.highestTargetId)}setTargetsMetadata(e,n,o){return o&&(this.lastRemoteSnapshotVersion=o),n>this.oi&&(this.oi=n),Ue.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new gc(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,Ue.resolve()}updateTargetData(e,n){return this.Pr(n),Ue.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,Ue.resolve()}removeTargets(e,n,o){let h=0;const g=[];return this.si.forEach(((x,T)=>{T.sequenceNumber<=n&&o.get(T.targetId)===null&&(this.si.delete(x),g.push(this.removeMatchingKeysForTargetId(e,T.targetId)),h++)})),Ue.waitFor(g).next((()=>h))}getTargetCount(e){return Ue.resolve(this.targetCount)}getTargetData(e,n){const o=this.si.get(n)||null;return Ue.resolve(o)}addMatchingKeys(e,n,o){return this._i.Wr(n,o),Ue.resolve()}removeMatchingKeys(e,n,o){this._i.zr(n,o);const h=this.persistence.referenceDelegate,g=[];return h&&n.forEach((x=>{g.push(h.markPotentiallyOrphaned(e,x))})),Ue.waitFor(g)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),Ue.resolve()}getMatchingKeysForTargetId(e,n){const o=this._i.Hr(n);return Ue.resolve(o)}containsKey(e,n){return Ue.resolve(this._i.containsKey(n))}}class f_{constructor(e,n){this.ui={},this.overlays={},this.ci=new $d(0),this.li=!1,this.li=!0,this.hi=new SI,this.referenceDelegate=e(this),this.Pi=new OI(this),this.indexManager=new mI,this.remoteDocumentCache=(function(h){return new RI(h)})((o=>this.referenceDelegate.Ti(o))),this.serializer=new fI(n),this.Ii=new TI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new CI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let o=this.ui[e.toKey()];return o||(o=new II(n,this.referenceDelegate),this.ui[e.toKey()]=o),o}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,o){wt("MemoryPersistence","Starting transaction:",e);const h=new DI(this.ci.next());return this.referenceDelegate.Ei(),o(h).next((g=>this.referenceDelegate.di(h).next((()=>g)))).toPromise().then((g=>(h.raiseOnCommittedEvent(),g)))}Ai(e,n){return Ue.or(Object.values(this.ui).map((o=>()=>o.containsKey(e,n))))}}class DI extends sS{constructor(e){super(),this.currentSequenceNumber=e}}class Dg{constructor(e){this.persistence=e,this.Ri=new Og,this.Vi=null}static mi(e){return new Dg(e)}get fi(){if(this.Vi)return this.Vi;throw Xt(60996)}addReference(e,n,o){return this.Ri.addReference(o,n),this.fi.delete(o.toString()),Ue.resolve()}removeReference(e,n,o){return this.Ri.removeReference(o,n),this.fi.add(o.toString()),Ue.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),Ue.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((h=>this.fi.add(h.toString())));const o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(e,n.targetId).next((h=>{h.forEach((g=>this.fi.add(g.toString())))})).next((()=>o.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ue.forEach(this.fi,(o=>{const h=Lt.fromPath(o);return this.gi(e,h).next((g=>{g||n.removeEntry(h,Kt.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((o=>{o?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return Ue.or([()=>Ue.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class kd{constructor(e,n){this.persistence=e,this.pi=new _l((o=>lS(o.path)),((o,h)=>o.isEqual(h))),this.garbageCollector=_I(this,n)}static mi(e,n){return new kd(e,n)}Ei(){}di(e){return Ue.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((o=>n.next((h=>o+h))))}wr(e){let n=0;return this.pr(e,(o=>{n++})).next((()=>n))}pr(e,n){return Ue.forEach(this.pi,((o,h)=>this.br(e,o,h).next((g=>g?Ue.resolve():n(h)))))}removeTargets(e,n,o){return this.persistence.getTargetCache().removeTargets(e,n,o)}removeOrphanedDocuments(e,n){let o=0;const h=this.persistence.getRemoteDocumentCache(),g=h.newChangeBuffer();return h.ii(e,(x=>this.br(e,x,n).next((T=>{T||(o++,g.removeEntry(x,Kt.min()))})))).next((()=>g.apply(e))).next((()=>o))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),Ue.resolve()}removeTarget(e,n){const o=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,o)}addReference(e,n,o){return this.pi.set(o,e.currentSequenceNumber),Ue.resolve()}removeReference(e,n,o){return this.pi.set(o,e.currentSequenceNumber),Ue.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),Ue.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=fd(e.data.value)),n}br(e,n,o){return Ue.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const h=this.pi.get(n);return Ue.resolve(h!==void 0&&h>o)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Mg{constructor(e,n,o,h){this.targetId=e,this.fromCache=n,this.Es=o,this.ds=h}static As(e,n){let o=Sn(),h=Sn();for(const g of n.docChanges)switch(g.type){case 0:o=o.add(g.doc.key);break;case 1:h=h.add(g.doc.key)}return new Mg(e,n.fromCache,o,h)}}class MI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class kI{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return sv()?8:aS(vi())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,o,h){const g={result:null};return this.ys(e,n).next((x=>{g.result=x})).next((()=>{if(!g.result)return this.ws(e,n,h,o).next((x=>{g.result=x}))})).next((()=>{if(g.result)return;const x=new MI;return this.Ss(e,n,x).next((T=>{if(g.result=T,this.Vs)return this.bs(e,n,x,T.size)}))})).next((()=>g.result))}bs(e,n,o,h){return o.documentReadCount<this.fs?(Jl()<=vn.DEBUG&&wt("QueryEngine","SDK will not create cache indexes for query:",$l(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ue.resolve()):(Jl()<=vn.DEBUG&&wt("QueryEngine","Query:",$l(n),"scans",o.documentReadCount,"local documents and returns",h,"documents as results."),o.documentReadCount>this.gs*h?(Jl()<=vn.DEBUG&&wt("QueryEngine","The SDK decides to create cache indexes for query:",$l(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qs(n))):Ue.resolve())}ys(e,n){if(Ex(n))return Ue.resolve(null);let o=Qs(n);return this.indexManager.getIndexType(e,o).next((h=>h===0?null:(n.limit!==null&&h===1&&(n=Od(n,null,"F"),o=Qs(n)),this.indexManager.getDocumentsMatchingTarget(e,o).next((g=>{const x=Sn(...g);return this.ps.getDocuments(e,x).next((T=>this.indexManager.getMinOffset(e,o).next((b=>{const w=this.Ds(n,T);return this.Cs(n,w,x,b.readTime)?this.ys(e,Od(n,null,"F")):this.vs(e,w,n,b)}))))})))))}ws(e,n,o,h){return Ex(n)||h.isEqual(Kt.min())?Ue.resolve(null):this.ps.getDocuments(e,o).next((g=>{const x=this.Ds(n,g);return this.Cs(n,x,o,h)?Ue.resolve(null):(Jl()<=vn.DEBUG&&wt("QueryEngine","Re-using previous result from %s to execute query: %s",h.toString(),$l(n)),this.vs(e,x,n,tS(h,Tu)).next((T=>T)))}))}Ds(e,n){let o=new Qr(qw(e));return n.forEach(((h,g)=>{sf(e,g)&&(o=o.add(g))})),o}Cs(e,n,o,h){if(e.limit===null)return!1;if(o.size!==n.size)return!0;const g=e.limitType==="F"?n.last():n.first();return!!g&&(g.hasPendingWrites||g.version.compareTo(h)>0)}Ss(e,n,o){return Jl()<=vn.DEBUG&&wt("QueryEngine","Using full collection scan to execute query:",$l(n)),this.ps.getDocumentsMatchingQuery(e,n,Oo.min(),o)}vs(e,n,o,h){return this.ps.getDocumentsMatchingQuery(e,o,h).next((g=>(n.forEach((x=>{g=g.insert(x.key,x)})),g)))}}const kg="LocalStore",LI=3e8;class PI{constructor(e,n,o,h){this.persistence=e,this.Fs=n,this.serializer=h,this.Ms=new br(Cn),this.xs=new _l((g=>Tg(g)),Cg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(o)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function BI(s,e,n,o){return new PI(s,e,n,o)}async function g_(s,e){const n=en(s);return await n.persistence.runTransaction("Handle user change","readonly",(o=>{let h;return n.mutationQueue.getAllMutationBatches(o).next((g=>(h=g,n.Bs(e),n.mutationQueue.getAllMutationBatches(o)))).next((g=>{const x=[],T=[];let b=Sn();for(const w of h){x.push(w.batchId);for(const C of w.mutations)b=b.add(C.key)}for(const w of g){T.push(w.batchId);for(const C of w.mutations)b=b.add(C.key)}return n.localDocuments.getDocuments(o,b).next((w=>({Ls:w,removedBatchIds:x,addedBatchIds:T})))}))}))}function VI(s,e){const n=en(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(o=>{const h=e.batch.keys(),g=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(T,b,w,C){const N=w.batch,P=N.keys();let B=Ue.resolve();return P.forEach((ee=>{B=B.next((()=>C.getEntry(b,ee))).next((ne=>{const ae=w.docVersions.get(ee);qn(ae!==null,48541),ne.version.compareTo(ae)<0&&(N.applyToRemoteDocument(ne,w),ne.isValidDocument()&&(ne.setReadTime(w.commitVersion),C.addEntry(ne)))}))})),B.next((()=>T.mutationQueue.removeMutationBatch(b,N)))})(n,o,e,g).next((()=>g.apply(o))).next((()=>n.mutationQueue.performConsistencyCheck(o))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(o,h,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(o,(function(T){let b=Sn();for(let w=0;w<T.mutationResults.length;++w)T.mutationResults[w].transformResults.length>0&&(b=b.add(T.batch.mutations[w].key));return b})(e)))).next((()=>n.localDocuments.getDocuments(o,h)))}))}function m_(s){const e=en(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function UI(s,e){const n=en(s),o=e.snapshotVersion;let h=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(g=>{const x=n.Ns.newChangeBuffer({trackRemovals:!0});h=n.Ms;const T=[];e.targetChanges.forEach(((C,N)=>{const P=h.get(N);if(!P)return;T.push(n.Pi.removeMatchingKeys(g,C.removedDocuments,N).next((()=>n.Pi.addMatchingKeys(g,C.addedDocuments,N))));let B=P.withSequenceNumber(g.currentSequenceNumber);e.targetMismatches.get(N)!==null?B=B.withResumeToken(di.EMPTY_BYTE_STRING,Kt.min()).withLastLimboFreeSnapshotVersion(Kt.min()):C.resumeToken.approximateByteSize()>0&&(B=B.withResumeToken(C.resumeToken,o)),h=h.insert(N,B),(function(ne,ae,tt){return ne.resumeToken.approximateByteSize()===0||ae.snapshotVersion.toMicroseconds()-ne.snapshotVersion.toMicroseconds()>=LI?!0:tt.addedDocuments.size+tt.modifiedDocuments.size+tt.removedDocuments.size>0})(P,B,C)&&T.push(n.Pi.updateTargetData(g,B))}));let b=Va(),w=Sn();if(e.documentUpdates.forEach((C=>{e.resolvedLimboDocuments.has(C)&&T.push(n.persistence.referenceDelegate.updateLimboDocument(g,C))})),T.push(FI(g,x,e.documentUpdates).next((C=>{b=C.ks,w=C.qs}))),!o.isEqual(Kt.min())){const C=n.Pi.getLastRemoteSnapshotVersion(g).next((N=>n.Pi.setTargetsMetadata(g,g.currentSequenceNumber,o)));T.push(C)}return Ue.waitFor(T).next((()=>x.apply(g))).next((()=>n.localDocuments.getLocalViewOfDocuments(g,b,w))).next((()=>b))})).then((g=>(n.Ms=h,g)))}function FI(s,e,n){let o=Sn(),h=Sn();return n.forEach((g=>o=o.add(g))),e.getEntries(s,o).next((g=>{let x=Va();return n.forEach(((T,b)=>{const w=g.get(T);b.isFoundDocument()!==w.isFoundDocument()&&(h=h.add(T)),b.isNoDocument()&&b.version.isEqual(Kt.min())?(e.removeEntry(T,b.readTime),x=x.insert(T,b)):!w.isValidDocument()||b.version.compareTo(w.version)>0||b.version.compareTo(w.version)===0&&w.hasPendingWrites?(e.addEntry(b),x=x.insert(T,b)):wt(kg,"Ignoring outdated watch update for ",T,". Current version:",w.version," Watch version:",b.version)})),{ks:x,qs:h}}))}function jI(s,e){const n=en(s);return n.persistence.runTransaction("Get next mutation batch","readonly",(o=>(e===void 0&&(e=Ag),n.mutationQueue.getNextMutationBatchAfterBatchId(o,e))))}function zI(s,e){const n=en(s);return n.persistence.runTransaction("Allocate target","readwrite",(o=>{let h;return n.Pi.getTargetData(o,e).next((g=>g?(h=g,Ue.resolve(h)):n.Pi.allocateTargetId(o).next((x=>(h=new vo(e,x,"TargetPurposeListen",o.currentSequenceNumber),n.Pi.addTargetData(o,h).next((()=>h)))))))})).then((o=>{const h=n.Ms.get(o.targetId);return(h===null||o.snapshotVersion.compareTo(h.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(o.targetId,o),n.xs.set(e,o.targetId)),o}))}async function K1(s,e,n){const o=en(s),h=o.Ms.get(e),g=n?"readwrite":"readwrite-primary";try{n||await o.persistence.runTransaction("Release target",g,(x=>o.persistence.referenceDelegate.removeTarget(x,h)))}catch(x){if(!wc(x))throw x;wt(kg,`Failed to update sequence numbers for target ${e}: ${x}`)}o.Ms=o.Ms.remove(e),o.xs.delete(h.target)}function Dx(s,e,n){const o=en(s);let h=Kt.min(),g=Sn();return o.persistence.runTransaction("Execute query","readwrite",(x=>(function(b,w,C){const N=en(b),P=N.xs.get(C);return P!==void 0?Ue.resolve(N.Ms.get(P)):N.Pi.getTargetData(w,C)})(o,x,Qs(e)).next((T=>{if(T)return h=T.lastLimboFreeSnapshotVersion,o.Pi.getMatchingKeysForTargetId(x,T.targetId).next((b=>{g=b}))})).next((()=>o.Fs.getDocumentsMatchingQuery(x,e,n?h:Kt.min(),n?g:Sn()))).next((T=>(HI(o,SS(e),T),{documents:T,Qs:g})))))}function HI(s,e,n){let o=s.Os.get(e)||Kt.min();n.forEach(((h,g)=>{g.readTime.compareTo(o)>0&&(o=g.readTime)})),s.Os.set(e,o)}class Mx{constructor(){this.activeTargetIds=MS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GI{constructor(){this.Mo=new Mx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,o){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,o){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Mx,Promise.resolve()}handleUserChange(e,n,o){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class qI{Oo(e){}shutdown(){}}const kx="ConnectivityMonitor";class Lx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){wt(kx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){wt(kx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let sd=null;function Q1(){return sd===null?sd=(function(){return 268435456+Math.round(2147483648*Math.random())})():sd++,"0x"+sd.toString(16)}const w1="RestConnection",XI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class YI{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),h=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${o}/databases/${h}`,this.Wo=this.databaseId.database===Id?`project_id=${o}`:`project_id=${o}&database_id=${h}`}Go(e,n,o,h,g){const x=Q1(),T=this.zo(e,n.toUriEncodedString());wt(w1,`Sending RPC '${e}' ${x}:`,T,o);const b={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(b,h,g);const{host:w}=new URL(T),C=Bo(w);return this.Jo(e,T,b,o,C).then((N=>(wt(w1,`Received RPC '${e}' ${x}: `,N),N)),(N=>{throw uc(w1,`RPC '${e}' ${x} failed with error: `,N,"url: ",T,"request:",o),N}))}Ho(e,n,o,h,g,x){return this.Go(e,n,o,h,g)}jo(e,n,o){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+xc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((h,g)=>e[g]=h)),o&&o.headers.forEach(((h,g)=>e[g]=h))}zo(e,n){const o=XI[e];return`${this.Uo}/v1/${n}:${o}`}terminate(){}}class WI{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const wi="WebChannelConnection";class KI extends YI{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,o,h,g){const x=Q1();return new Promise(((T,b)=>{const w=new xw;w.setWithCredentials(!0),w.listenOnce(Ew.COMPLETE,(()=>{try{switch(w.getLastErrorCode()){case dd.NO_ERROR:const N=w.getResponseJson();wt(wi,`XHR for RPC '${e}' ${x} received:`,JSON.stringify(N)),T(N);break;case dd.TIMEOUT:wt(wi,`RPC '${e}' ${x} timed out`),b(new ct(De.DEADLINE_EXCEEDED,"Request time out"));break;case dd.HTTP_ERROR:const P=w.getStatus();if(wt(wi,`RPC '${e}' ${x} failed with status:`,P,"response text:",w.getResponseText()),P>0){let B=w.getResponseJson();Array.isArray(B)&&(B=B[0]);const ee=B?.error;if(ee&&ee.status&&ee.message){const ne=(function(tt){const ze=tt.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(ze)>=0?ze:De.UNKNOWN})(ee.status);b(new ct(ne,ee.message))}else b(new ct(De.UNKNOWN,"Server responded with status "+w.getStatus()))}else b(new ct(De.UNAVAILABLE,"Connection failed."));break;default:Xt(9055,{l_:e,streamId:x,h_:w.getLastErrorCode(),P_:w.getLastError()})}}finally{wt(wi,`RPC '${e}' ${x} completed.`)}}));const C=JSON.stringify(h);wt(wi,`RPC '${e}' ${x} sending request:`,h),w.send(n,"POST",C,o,15)}))}T_(e,n,o){const h=Q1(),g=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],x=Aw(),T=_w(),b={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},w=this.longPollingOptions.timeoutSeconds;w!==void 0&&(b.longPollingTimeout=Math.round(1e3*w)),this.useFetchStreams&&(b.useFetchStreams=!0),this.jo(b.initMessageHeaders,n,o),b.encodeInitMessageHeaders=!0;const C=g.join("");wt(wi,`Creating RPC '${e}' stream ${h}: ${C}`,b);const N=x.createWebChannel(C,b);this.I_(N);let P=!1,B=!1;const ee=new WI({Yo:ae=>{B?wt(wi,`Not sending because RPC '${e}' stream ${h} is closed:`,ae):(P||(wt(wi,`Opening RPC '${e}' stream ${h} transport.`),N.open(),P=!0),wt(wi,`RPC '${e}' stream ${h} sending:`,ae),N.send(ae))},Zo:()=>N.close()}),ne=(ae,tt,ze)=>{ae.listen(tt,(fe=>{try{ze(fe)}catch(Ge){setTimeout((()=>{throw Ge}),0)}}))};return ne(N,hu.EventType.OPEN,(()=>{B||(wt(wi,`RPC '${e}' stream ${h} transport opened.`),ee.o_())})),ne(N,hu.EventType.CLOSE,(()=>{B||(B=!0,wt(wi,`RPC '${e}' stream ${h} transport closed`),ee.a_(),this.E_(N))})),ne(N,hu.EventType.ERROR,(ae=>{B||(B=!0,uc(wi,`RPC '${e}' stream ${h} transport errored. Name:`,ae.name,"Message:",ae.message),ee.a_(new ct(De.UNAVAILABLE,"The operation could not be completed")))})),ne(N,hu.EventType.MESSAGE,(ae=>{if(!B){const tt=ae.data[0];qn(!!tt,16349);const ze=tt,fe=ze?.error||ze[0]?.error;if(fe){wt(wi,`RPC '${e}' stream ${h} received error:`,fe);const Ge=fe.status;let gt=(function(z){const U=Hr[z];if(U!==void 0)return n_(U)})(Ge),Qe=fe.message;gt===void 0&&(gt=De.INTERNAL,Qe="Unknown error status: "+Ge+" with message "+fe.message),B=!0,ee.a_(new ct(gt,Qe)),N.close()}else wt(wi,`RPC '${e}' stream ${h} received:`,tt),ee.u_(tt)}})),ne(T,ww.STAT_EVENT,(ae=>{ae.stat===V1.PROXY?wt(wi,`RPC '${e}' stream ${h} detected buffering proxy`):ae.stat===V1.NOPROXY&&wt(wi,`RPC '${e}' stream ${h} detected no buffering proxy`)})),setTimeout((()=>{ee.__()}),0),ee}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function _1(){return typeof document<"u"?document:null}function uf(s){return new $S(s,!0)}class p_{constructor(e,n,o=1e3,h=1.5,g=6e4){this.Mi=e,this.timerId=n,this.d_=o,this.A_=h,this.R_=g,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),o=Math.max(0,Date.now()-this.f_),h=Math.max(0,n-o);h>0&&wt("ExponentialBackoff",`Backing off for ${h} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${o} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,h,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Px="PersistentStream";class y_{constructor(e,n,o,h,g,x,T,b){this.Mi=e,this.S_=o,this.b_=h,this.connection=g,this.authCredentialsProvider=x,this.appCheckCredentialsProvider=T,this.listener=b,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new p_(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===De.RESOURCE_EXHAUSTED?(Ba(n.toString()),Ba("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([o,h])=>{this.D_===n&&this.G_(o,h)}),(o=>{e((()=>{const h=new ct(De.UNKNOWN,"Fetching auth token failed: "+o.message);return this.z_(h)}))}))}G_(e,n){const o=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{o((()=>this.listener.Xo()))})),this.stream.t_((()=>{o((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((h=>{o((()=>this.z_(h)))})),this.stream.onMessage((h=>{o((()=>++this.F_==1?this.J_(h):this.onNext(h)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return wt(Px,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(wt(Px,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class QI extends y_{constructor(e,n,o,h,g,x){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,o,h,x),this.serializer=g}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=nI(this.serializer,e),o=(function(g){if(!("targetChange"in g))return Kt.min();const x=g.targetChange;return x.targetIds&&x.targetIds.length?Kt.min():x.readTime?Zs(x.readTime):Kt.min()})(e);return this.listener.H_(n,o)}Y_(e){const n={};n.database=W1(this.serializer),n.addTarget=(function(g,x){let T;const b=x.target;if(T=H1(b)?{documents:sI(g,b)}:{query:aI(g,b).ft},T.targetId=x.targetId,x.resumeToken.approximateByteSize()>0){T.resumeToken=s_(g,x.resumeToken);const w=q1(g,x.expectedCount);w!==null&&(T.expectedCount=w)}else if(x.snapshotVersion.compareTo(Kt.min())>0){T.readTime=Md(g,x.snapshotVersion.toTimestamp());const w=q1(g,x.expectedCount);w!==null&&(T.expectedCount=w)}return T})(this.serializer,e);const o=lI(this.serializer,e);o&&(n.labels=o),this.q_(n)}Z_(e){const n={};n.database=W1(this.serializer),n.removeTarget=e,this.q_(n)}}class ZI extends y_{constructor(e,n,o,h,g,x){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,o,h,x),this.serializer=g}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return qn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=iI(e.writeResults,e.commitTime),o=Zs(e.commitTime);return this.listener.na(o,n)}ra(){const e={};e.database=W1(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((o=>rI(this.serializer,o)))};this.q_(n)}}class JI{}class $I extends JI{constructor(e,n,o,h){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=o,this.serializer=h,this.ia=!1}sa(){if(this.ia)throw new ct(De.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,o,h){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([g,x])=>this.connection.Go(e,X1(n,o),h,g,x))).catch((g=>{throw g.name==="FirebaseError"?(g.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),g):new ct(De.UNKNOWN,g.toString())}))}Ho(e,n,o,h,g){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([x,T])=>this.connection.Ho(e,X1(n,o),h,x,T,g))).catch((x=>{throw x.name==="FirebaseError"?(x.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),x):new ct(De.UNKNOWN,x.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class e4{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ba(n),this.aa=!1):wt("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const pl="RemoteStore";class t4{constructor(e,n,o,h,g){this.localStore=e,this.datastore=n,this.asyncQueue=o,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=g,this.Aa.Oo((x=>{o.enqueueAndForget((async()=>{Al(this)&&(wt(pl,"Restarting streams for network reachability change."),await(async function(b){const w=en(b);w.Ea.add(4),await zu(w),w.Ra.set("Unknown"),w.Ea.delete(4),await hf(w)})(this))}))})),this.Ra=new e4(o,h)}}async function hf(s){if(Al(s))for(const e of s.da)await e(!0)}async function zu(s){for(const e of s.da)await e(!1)}function x_(s,e){const n=en(s);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Vg(n)?Bg(n):Ac(n).O_()&&Pg(n,e))}function Lg(s,e){const n=en(s),o=Ac(n);n.Ia.delete(e),o.O_()&&E_(n,e),n.Ia.size===0&&(o.O_()?o.L_():Al(n)&&n.Ra.set("Unknown"))}function Pg(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Kt.min())>0){const n=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ac(s).Y_(e)}function E_(s,e){s.Va.Ue(e),Ac(s).Z_(e)}function Bg(s){s.Va=new KS({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Ac(s).start(),s.Ra.ua()}function Vg(s){return Al(s)&&!Ac(s).x_()&&s.Ia.size>0}function Al(s){return en(s).Ea.size===0}function w_(s){s.Va=void 0}async function n4(s){s.Ra.set("Online")}async function r4(s){s.Ia.forEach(((e,n)=>{Pg(s,e)}))}async function i4(s,e){w_(s),Vg(s)?(s.Ra.ha(e),Bg(s)):s.Ra.set("Unknown")}async function s4(s,e,n){if(s.Ra.set("Online"),e instanceof i_&&e.state===2&&e.cause)try{await(async function(h,g){const x=g.cause;for(const T of g.targetIds)h.Ia.has(T)&&(await h.remoteSyncer.rejectListen(T,x),h.Ia.delete(T),h.Va.removeTarget(T))})(s,e)}catch(o){wt(pl,"Failed to remove targets %s: %s ",e.targetIds.join(","),o),await Ld(s,o)}else if(e instanceof pd?s.Va.Ze(e):e instanceof r_?s.Va.st(e):s.Va.tt(e),!n.isEqual(Kt.min()))try{const o=await m_(s.localStore);n.compareTo(o)>=0&&await(function(g,x){const T=g.Va.Tt(x);return T.targetChanges.forEach(((b,w)=>{if(b.resumeToken.approximateByteSize()>0){const C=g.Ia.get(w);C&&g.Ia.set(w,C.withResumeToken(b.resumeToken,x))}})),T.targetMismatches.forEach(((b,w)=>{const C=g.Ia.get(b);if(!C)return;g.Ia.set(b,C.withResumeToken(di.EMPTY_BYTE_STRING,C.snapshotVersion)),E_(g,b);const N=new vo(C.target,b,w,C.sequenceNumber);Pg(g,N)})),g.remoteSyncer.applyRemoteEvent(T)})(s,n)}catch(o){wt(pl,"Failed to raise snapshot:",o),await Ld(s,o)}}async function Ld(s,e,n){if(!wc(e))throw e;s.Ea.add(1),await zu(s),s.Ra.set("Offline"),n||(n=()=>m_(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{wt(pl,"Retrying IndexedDB access"),await n(),s.Ea.delete(1),await hf(s)}))}function __(s,e){return e().catch((n=>Ld(s,n,e)))}async function df(s){const e=en(s),n=Lo(e);let o=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ag;for(;a4(e);)try{const h=await jI(e.localStore,o);if(h===null){e.Ta.length===0&&n.L_();break}o=h.batchId,o4(e,h)}catch(h){await Ld(e,h)}A_(e)&&b_(e)}function a4(s){return Al(s)&&s.Ta.length<10}function o4(s,e){s.Ta.push(e);const n=Lo(s);n.O_()&&n.X_&&n.ea(e.mutations)}function A_(s){return Al(s)&&!Lo(s).x_()&&s.Ta.length>0}function b_(s){Lo(s).start()}async function l4(s){Lo(s).ra()}async function c4(s){const e=Lo(s);for(const n of s.Ta)e.ea(n.mutations)}async function u4(s,e,n){const o=s.Ta.shift(),h=Ig.from(o,e,n);await __(s,(()=>s.remoteSyncer.applySuccessfulWrite(h))),await df(s)}async function h4(s,e){e&&Lo(s).X_&&await(async function(o,h){if((function(x){return XS(x)&&x!==De.ABORTED})(h.code)){const g=o.Ta.shift();Lo(o).B_(),await __(o,(()=>o.remoteSyncer.rejectFailedWrite(g.batchId,h))),await df(o)}})(s,e),A_(s)&&b_(s)}async function Bx(s,e){const n=en(s);n.asyncQueue.verifyOperationInProgress(),wt(pl,"RemoteStore received new credentials");const o=Al(n);n.Ea.add(3),await zu(n),o&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await hf(n)}async function d4(s,e){const n=en(s);e?(n.Ea.delete(2),await hf(n)):e||(n.Ea.add(2),await zu(n),n.Ra.set("Unknown"))}function Ac(s){return s.ma||(s.ma=(function(n,o,h){const g=en(n);return g.sa(),new QI(o,g.connection,g.authCredentials,g.appCheckCredentials,g.serializer,h)})(s.datastore,s.asyncQueue,{Xo:n4.bind(null,s),t_:r4.bind(null,s),r_:i4.bind(null,s),H_:s4.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),Vg(s)?Bg(s):s.Ra.set("Unknown")):(await s.ma.stop(),w_(s))}))),s.ma}function Lo(s){return s.fa||(s.fa=(function(n,o,h){const g=en(n);return g.sa(),new ZI(o,g.connection,g.authCredentials,g.appCheckCredentials,g.serializer,h)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:l4.bind(null,s),r_:h4.bind(null,s),ta:c4.bind(null,s),na:u4.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await df(s)):(await s.fa.stop(),s.Ta.length>0&&(wt(pl,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Ug{constructor(e,n,o,h,g){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=o,this.op=h,this.removalCallback=g,this.deferred=new ka,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((x=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,o,h,g){const x=Date.now()+o,T=new Ug(e,n,x,h,g);return T.start(o),T}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ct(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fg(s,e){if(Ba("AsyncQueue",`${e}: ${s}`),wc(s))return new ct(De.UNAVAILABLE,`${e}: ${s}`);throw s}class lc{static emptySet(e){return new lc(e.comparator)}constructor(e){this.comparator=e?(n,o)=>e(n,o)||Lt.comparator(n.key,o.key):(n,o)=>Lt.comparator(n.key,o.key),this.keyedMap=du(),this.sortedSet=new br(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,o)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof lc)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),o=e.sortedSet.getIterator();for(;n.hasNext();){const h=n.getNext().key,g=o.getNext().key;if(!h.isEqual(g))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const o=new lc;return o.comparator=this.comparator,o.keyedMap=e,o.sortedSet=n,o}}class Vx{constructor(){this.ga=new br(Lt.comparator)}track(e){const n=e.doc.key,o=this.ga.get(n);o?e.type!==0&&o.type===3?this.ga=this.ga.insert(n,e):e.type===3&&o.type!==1?this.ga=this.ga.insert(n,{type:o.type,doc:e.doc}):e.type===2&&o.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&o.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&o.type===0?this.ga=this.ga.remove(n):e.type===1&&o.type===2?this.ga=this.ga.insert(n,{type:1,doc:o.doc}):e.type===0&&o.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Xt(63341,{Rt:e,pa:o}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,o)=>{e.push(o)})),e}}class mc{constructor(e,n,o,h,g,x,T,b,w){this.query=e,this.docs=n,this.oldDocs=o,this.docChanges=h,this.mutatedKeys=g,this.fromCache=x,this.syncStateChanged=T,this.excludesMetadataChanges=b,this.hasCachedResults=w}static fromInitialDocuments(e,n,o,h,g){const x=[];return n.forEach((T=>{x.push({type:0,doc:T})})),new mc(e,n,lc.emptySet(n),x,o,h,!0,!1,g)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,o=e.docChanges;if(n.length!==o.length)return!1;for(let h=0;h<n.length;h++)if(n[h].type!==o[h].type||!n[h].doc.isEqual(o[h].doc))return!1;return!0}}class f4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class g4{constructor(){this.queries=Ux(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,o){const h=en(n),g=h.queries;h.queries=Ux(),g.forEach(((x,T)=>{for(const b of T.Sa)b.onError(o)}))})(this,new ct(De.ABORTED,"Firestore shutting down"))}}function Ux(){return new _l((s=>Gw(s)),rf)}async function jg(s,e){const n=en(s);let o=3;const h=e.query;let g=n.queries.get(h);g?!g.ba()&&e.Da()&&(o=2):(g=new f4,o=e.Da()?0:1);try{switch(o){case 0:g.wa=await n.onListen(h,!0);break;case 1:g.wa=await n.onListen(h,!1);break;case 2:await n.onFirstRemoteStoreListen(h)}}catch(x){const T=Fg(x,`Initialization of query '${$l(e.query)}' failed`);return void e.onError(T)}n.queries.set(h,g),g.Sa.push(e),e.va(n.onlineState),g.wa&&e.Fa(g.wa)&&Hg(n)}async function zg(s,e){const n=en(s),o=e.query;let h=3;const g=n.queries.get(o);if(g){const x=g.Sa.indexOf(e);x>=0&&(g.Sa.splice(x,1),g.Sa.length===0?h=e.Da()?0:1:!g.ba()&&e.Da()&&(h=2))}switch(h){case 0:return n.queries.delete(o),n.onUnlisten(o,!0);case 1:return n.queries.delete(o),n.onUnlisten(o,!1);case 2:return n.onLastRemoteStoreUnlisten(o);default:return}}function m4(s,e){const n=en(s);let o=!1;for(const h of e){const g=h.query,x=n.queries.get(g);if(x){for(const T of x.Sa)T.Fa(h)&&(o=!0);x.wa=h}}o&&Hg(n)}function p4(s,e,n){const o=en(s),h=o.queries.get(e);if(h)for(const g of h.Sa)g.onError(n);o.queries.delete(e)}function Hg(s){s.Ca.forEach((e=>{e.next()}))}var Z1,Fx;(Fx=Z1||(Z1={})).Ma="default",Fx.Cache="cache";class Gg{constructor(e,n,o){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=o||{}}Fa(e){if(!this.options.includeMetadataChanges){const o=[];for(const h of e.docChanges)h.type!==3&&o.push(h);e=new mc(e.query,e.docs,e.oldDocs,o,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const o=n!=="Offline";return(!this.options.qa||!o)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=mc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Z1.Cache}}class v_{constructor(e){this.key=e}}class T_{constructor(e){this.key=e}}class y4{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Sn(),this.mutatedKeys=Sn(),this.eu=qw(e),this.tu=new lc(this.eu)}get nu(){return this.Ya}ru(e,n){const o=n?n.iu:new Vx,h=n?n.tu:this.tu;let g=n?n.mutatedKeys:this.mutatedKeys,x=h,T=!1;const b=this.query.limitType==="F"&&h.size===this.query.limit?h.last():null,w=this.query.limitType==="L"&&h.size===this.query.limit?h.first():null;if(e.inorderTraversal(((C,N)=>{const P=h.get(C),B=sf(this.query,N)?N:null,ee=!!P&&this.mutatedKeys.has(P.key),ne=!!B&&(B.hasLocalMutations||this.mutatedKeys.has(B.key)&&B.hasCommittedMutations);let ae=!1;P&&B?P.data.isEqual(B.data)?ee!==ne&&(o.track({type:3,doc:B}),ae=!0):this.su(P,B)||(o.track({type:2,doc:B}),ae=!0,(b&&this.eu(B,b)>0||w&&this.eu(B,w)<0)&&(T=!0)):!P&&B?(o.track({type:0,doc:B}),ae=!0):P&&!B&&(o.track({type:1,doc:P}),ae=!0,(b||w)&&(T=!0)),ae&&(B?(x=x.add(B),g=ne?g.add(C):g.delete(C)):(x=x.delete(C),g=g.delete(C)))})),this.query.limit!==null)for(;x.size>this.query.limit;){const C=this.query.limitType==="F"?x.last():x.first();x=x.delete(C.key),g=g.delete(C.key),o.track({type:1,doc:C})}return{tu:x,iu:o,Cs:T,mutatedKeys:g}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,o,h){const g=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const x=e.iu.ya();x.sort(((C,N)=>(function(B,ee){const ne=ae=>{switch(ae){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xt(20277,{Rt:ae})}};return ne(B)-ne(ee)})(C.type,N.type)||this.eu(C.doc,N.doc))),this.ou(o),h=h??!1;const T=n&&!h?this._u():[],b=this.Xa.size===0&&this.current&&!h?1:0,w=b!==this.Za;return this.Za=b,x.length!==0||w?{snapshot:new mc(this.query,e.tu,g,x,e.mutatedKeys,b===0,w,!1,!!o&&o.resumeToken.approximateByteSize()>0),au:T}:{au:T}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Vx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Sn(),this.tu.forEach((o=>{this.uu(o.key)&&(this.Xa=this.Xa.add(o.key))}));const n=[];return e.forEach((o=>{this.Xa.has(o)||n.push(new T_(o))})),this.Xa.forEach((o=>{e.has(o)||n.push(new v_(o))})),n}cu(e){this.Ya=e.Qs,this.Xa=Sn();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return mc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const qg="SyncEngine";class x4{constructor(e,n,o){this.query=e,this.targetId=n,this.view=o}}class E4{constructor(e){this.key=e,this.hu=!1}}class w4{constructor(e,n,o,h,g,x){this.localStore=e,this.remoteStore=n,this.eventManager=o,this.sharedClientState=h,this.currentUser=g,this.maxConcurrentLimboResolutions=x,this.Pu={},this.Tu=new _l((T=>Gw(T)),rf),this.Iu=new Map,this.Eu=new Set,this.du=new br(Lt.comparator),this.Au=new Map,this.Ru=new Og,this.Vu={},this.mu=new Map,this.fu=gc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function _4(s,e,n=!0){const o=O_(s);let h;const g=o.Tu.get(e);return g?(o.sharedClientState.addLocalQueryTarget(g.targetId),h=g.view.lu()):h=await C_(o,e,n,!0),h}async function A4(s,e){const n=O_(s);await C_(n,e,!0,!1)}async function C_(s,e,n,o){const h=await zI(s.localStore,Qs(e)),g=h.targetId,x=s.sharedClientState.addLocalQueryTarget(g,n);let T;return o&&(T=await b4(s,e,g,x==="current",h.resumeToken)),s.isPrimaryClient&&n&&x_(s.remoteStore,h),T}async function b4(s,e,n,o,h){s.pu=(N,P,B)=>(async function(ne,ae,tt,ze){let fe=ae.view.ru(tt);fe.Cs&&(fe=await Dx(ne.localStore,ae.query,!1).then((({documents:F})=>ae.view.ru(F,fe))));const Ge=ze&&ze.targetChanges.get(ae.targetId),gt=ze&&ze.targetMismatches.get(ae.targetId)!=null,Qe=ae.view.applyChanges(fe,ne.isPrimaryClient,Ge,gt);return zx(ne,ae.targetId,Qe.au),Qe.snapshot})(s,N,P,B);const g=await Dx(s.localStore,e,!0),x=new y4(e,g.Qs),T=x.ru(g.documents),b=ju.createSynthesizedTargetChangeForCurrentChange(n,o&&s.onlineState!=="Offline",h),w=x.applyChanges(T,s.isPrimaryClient,b);zx(s,n,w.au);const C=new x4(e,n,x);return s.Tu.set(e,C),s.Iu.has(n)?s.Iu.get(n).push(e):s.Iu.set(n,[e]),w.snapshot}async function v4(s,e,n){const o=en(s),h=o.Tu.get(e),g=o.Iu.get(h.targetId);if(g.length>1)return o.Iu.set(h.targetId,g.filter((x=>!rf(x,e)))),void o.Tu.delete(e);o.isPrimaryClient?(o.sharedClientState.removeLocalQueryTarget(h.targetId),o.sharedClientState.isActiveQueryTarget(h.targetId)||await K1(o.localStore,h.targetId,!1).then((()=>{o.sharedClientState.clearQueryState(h.targetId),n&&Lg(o.remoteStore,h.targetId),J1(o,h.targetId)})).catch(Ec)):(J1(o,h.targetId),await K1(o.localStore,h.targetId,!0))}async function T4(s,e){const n=en(s),o=n.Tu.get(e),h=n.Iu.get(o.targetId);n.isPrimaryClient&&h.length===1&&(n.sharedClientState.removeLocalQueryTarget(o.targetId),Lg(n.remoteStore,o.targetId))}async function C4(s,e,n){const o=M4(s);try{const h=await(function(x,T){const b=en(x),w=Vn.now(),C=T.reduce(((B,ee)=>B.add(ee.key)),Sn());let N,P;return b.persistence.runTransaction("Locally write mutations","readwrite",(B=>{let ee=Va(),ne=Sn();return b.Ns.getEntries(B,C).next((ae=>{ee=ae,ee.forEach(((tt,ze)=>{ze.isValidDocument()||(ne=ne.add(tt))}))})).next((()=>b.localDocuments.getOverlayedDocuments(B,ee))).next((ae=>{N=ae;const tt=[];for(const ze of T){const fe=jS(ze,N.get(ze.key).overlayedDocument);fe!=null&&tt.push(new Uo(ze.key,fe,Pw(fe.value.mapValue),Mi.exists(!0)))}return b.mutationQueue.addMutationBatch(B,w,tt,T)})).next((ae=>{P=ae;const tt=ae.applyToLocalDocumentSet(N,ne);return b.documentOverlayCache.saveOverlays(B,ae.batchId,tt)}))})).then((()=>({batchId:P.batchId,changes:Yw(N)})))})(o.localStore,e);o.sharedClientState.addPendingMutation(h.batchId),(function(x,T,b){let w=x.Vu[x.currentUser.toKey()];w||(w=new br(Cn)),w=w.insert(T,b),x.Vu[x.currentUser.toKey()]=w})(o,h.batchId,n),await Hu(o,h.changes),await df(o.remoteStore)}catch(h){const g=Fg(h,"Failed to persist write");n.reject(g)}}async function S_(s,e){const n=en(s);try{const o=await UI(n.localStore,e);e.targetChanges.forEach(((h,g)=>{const x=n.Au.get(g);x&&(qn(h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size<=1,22616),h.addedDocuments.size>0?x.hu=!0:h.modifiedDocuments.size>0?qn(x.hu,14607):h.removedDocuments.size>0&&(qn(x.hu,42227),x.hu=!1))})),await Hu(n,o,e)}catch(o){await Ec(o)}}function jx(s,e,n){const o=en(s);if(o.isPrimaryClient&&n===0||!o.isPrimaryClient&&n===1){const h=[];o.Tu.forEach(((g,x)=>{const T=x.view.va(e);T.snapshot&&h.push(T.snapshot)})),(function(x,T){const b=en(x);b.onlineState=T;let w=!1;b.queries.forEach(((C,N)=>{for(const P of N.Sa)P.va(T)&&(w=!0)})),w&&Hg(b)})(o.eventManager,e),h.length&&o.Pu.H_(h),o.onlineState=e,o.isPrimaryClient&&o.sharedClientState.setOnlineState(e)}}async function S4(s,e,n){const o=en(s);o.sharedClientState.updateQueryState(e,"rejected",n);const h=o.Au.get(e),g=h&&h.key;if(g){let x=new br(Lt.comparator);x=x.insert(g,Ai.newNoDocument(g,Kt.min()));const T=Sn().add(g),b=new cf(Kt.min(),new Map,new br(Cn),x,T);await S_(o,b),o.du=o.du.remove(g),o.Au.delete(e),Xg(o)}else await K1(o.localStore,e,!1).then((()=>J1(o,e,n))).catch(Ec)}async function I4(s,e){const n=en(s),o=e.batch.batchId;try{const h=await VI(n.localStore,e);R_(n,o,null),I_(n,o),n.sharedClientState.updateMutationState(o,"acknowledged"),await Hu(n,h)}catch(h){await Ec(h)}}async function R4(s,e,n){const o=en(s);try{const h=await(function(x,T){const b=en(x);return b.persistence.runTransaction("Reject batch","readwrite-primary",(w=>{let C;return b.mutationQueue.lookupMutationBatch(w,T).next((N=>(qn(N!==null,37113),C=N.keys(),b.mutationQueue.removeMutationBatch(w,N)))).next((()=>b.mutationQueue.performConsistencyCheck(w))).next((()=>b.documentOverlayCache.removeOverlaysForBatchId(w,C,T))).next((()=>b.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(w,C))).next((()=>b.localDocuments.getDocuments(w,C)))}))})(o.localStore,e);R_(o,e,n),I_(o,e),o.sharedClientState.updateMutationState(e,"rejected",n),await Hu(o,h)}catch(h){await Ec(h)}}function I_(s,e){(s.mu.get(e)||[]).forEach((n=>{n.resolve()})),s.mu.delete(e)}function R_(s,e,n){const o=en(s);let h=o.Vu[o.currentUser.toKey()];if(h){const g=h.get(e);g&&(n?g.reject(n):g.resolve(),h=h.remove(e)),o.Vu[o.currentUser.toKey()]=h}}function J1(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const o of s.Iu.get(e))s.Tu.delete(o),n&&s.Pu.yu(o,n);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((o=>{s.Ru.containsKey(o)||N_(s,o)}))}function N_(s,e){s.Eu.delete(e.path.canonicalString());const n=s.du.get(e);n!==null&&(Lg(s.remoteStore,n),s.du=s.du.remove(e),s.Au.delete(n),Xg(s))}function zx(s,e,n){for(const o of n)o instanceof v_?(s.Ru.addReference(o.key,e),N4(s,o)):o instanceof T_?(wt(qg,"Document no longer in limbo: "+o.key),s.Ru.removeReference(o.key,e),s.Ru.containsKey(o.key)||N_(s,o.key)):Xt(19791,{wu:o})}function N4(s,e){const n=e.key,o=n.path.canonicalString();s.du.get(n)||s.Eu.has(o)||(wt(qg,"New document in limbo: "+n),s.Eu.add(o),Xg(s))}function Xg(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const n=new Lt(or.fromString(e)),o=s.fu.next();s.Au.set(o,new E4(n)),s.du=s.du.insert(n,o),x_(s.remoteStore,new vo(Qs(nf(n.path)),o,"TargetPurposeLimboResolution",$d.ce))}}async function Hu(s,e,n){const o=en(s),h=[],g=[],x=[];o.Tu.isEmpty()||(o.Tu.forEach(((T,b)=>{x.push(o.pu(b,e,n).then((w=>{if((w||n)&&o.isPrimaryClient){const C=w?!w.fromCache:n?.targetChanges.get(b.targetId)?.current;o.sharedClientState.updateQueryState(b.targetId,C?"current":"not-current")}if(w){h.push(w);const C=Mg.As(b.targetId,w);g.push(C)}})))})),await Promise.all(x),o.Pu.H_(h),await(async function(b,w){const C=en(b);try{await C.persistence.runTransaction("notifyLocalViewChanges","readwrite",(N=>Ue.forEach(w,(P=>Ue.forEach(P.Es,(B=>C.persistence.referenceDelegate.addReference(N,P.targetId,B))).next((()=>Ue.forEach(P.ds,(B=>C.persistence.referenceDelegate.removeReference(N,P.targetId,B)))))))))}catch(N){if(!wc(N))throw N;wt(kg,"Failed to update sequence numbers: "+N)}for(const N of w){const P=N.targetId;if(!N.fromCache){const B=C.Ms.get(P),ee=B.snapshotVersion,ne=B.withLastLimboFreeSnapshotVersion(ee);C.Ms=C.Ms.insert(P,ne)}}})(o.localStore,g))}async function O4(s,e){const n=en(s);if(!n.currentUser.isEqual(e)){wt(qg,"User change. New user:",e.toKey());const o=await g_(n.localStore,e);n.currentUser=e,(function(g,x){g.mu.forEach((T=>{T.forEach((b=>{b.reject(new ct(De.CANCELLED,x))}))})),g.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,o.removedBatchIds,o.addedBatchIds),await Hu(n,o.Ls)}}function D4(s,e){const n=en(s),o=n.Au.get(e);if(o&&o.hu)return Sn().add(o.key);{let h=Sn();const g=n.Iu.get(e);if(!g)return h;for(const x of g){const T=n.Tu.get(x);h=h.unionWith(T.view.nu)}return h}}function O_(s){const e=en(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=S_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=D4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=S4.bind(null,e),e.Pu.H_=m4.bind(null,e.eventManager),e.Pu.yu=p4.bind(null,e.eventManager),e}function M4(s){const e=en(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=I4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=R4.bind(null,e),e}class Pd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=uf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return BI(this.persistence,new kI,e.initialUser,this.serializer)}Cu(e){return new f_(Dg.mi,this.serializer)}Du(e){return new GI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Pd.provider={build:()=>new Pd};class k4 extends Pd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){qn(this.persistence.referenceDelegate instanceof kd,46915);const o=this.persistence.referenceDelegate.garbageCollector;return new EI(o,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Yi.withCacheSize(this.cacheSizeBytes):Yi.DEFAULT;return new f_((o=>kd.mi(o,n)),this.serializer)}}class $1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=o=>jx(this.syncEngine,o,1),this.remoteStore.remoteSyncer.handleCredentialChange=O4.bind(null,this.syncEngine),await d4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new g4})()}createDatastore(e){const n=uf(e.databaseInfo.databaseId),o=(function(g){return new KI(g)})(e.databaseInfo);return(function(g,x,T,b){return new $I(g,x,T,b)})(e.authCredentials,e.appCheckCredentials,o,n)}createRemoteStore(e){return(function(o,h,g,x,T){return new t4(o,h,g,x,T)})(this.localStore,this.datastore,e.asyncQueue,(n=>jx(this.syncEngine,n,0)),(function(){return Lx.v()?new Lx:new qI})())}createSyncEngine(e,n){return(function(h,g,x,T,b,w,C){const N=new w4(h,g,x,T,b,w);return C&&(N.gu=!0),N})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const o=en(n);wt(pl,"RemoteStore shutting down."),o.Ea.add(5),await zu(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}$1.provider={build:()=>new $1};class Yg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ba("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Po="FirestoreClient";class L4{constructor(e,n,o,h,g){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=o,this.databaseInfo=h,this.user=_i.UNAUTHENTICATED,this.clientId=_g.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=g,this.authCredentials.start(o,(async x=>{wt(Po,"Received user=",x.uid),await this.authCredentialListener(x),this.user=x})),this.appCheckCredentials.start(o,(x=>(wt(Po,"Received new app check token=",x),this.appCheckCredentialListener(x,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ka;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const o=Fg(n,"Failed to shutdown persistence");e.reject(o)}})),e.promise}}async function A1(s,e){s.asyncQueue.verifyOperationInProgress(),wt(Po,"Initializing OfflineComponentProvider");const n=s.configuration;await e.initialize(n);let o=n.initialUser;s.setCredentialChangeListener((async h=>{o.isEqual(h)||(await g_(e.localStore,h),o=h)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Hx(s,e){s.asyncQueue.verifyOperationInProgress();const n=await P4(s);wt(Po,"Initializing OnlineComponentProvider"),await e.initialize(n,s.configuration),s.setCredentialChangeListener((o=>Bx(e.remoteStore,o))),s.setAppCheckTokenChangeListener(((o,h)=>Bx(e.remoteStore,h))),s._onlineComponents=e}async function P4(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){wt(Po,"Using user provided OfflineComponentProvider");try{await A1(s,s._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(h){return h.name==="FirebaseError"?h.code===De.FAILED_PRECONDITION||h.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&h instanceof DOMException)||h.code===22||h.code===20||h.code===11})(n))throw n;uc("Error using user provided cache. Falling back to memory cache: "+n),await A1(s,new Pd)}}else wt(Po,"Using default OfflineComponentProvider"),await A1(s,new k4(void 0));return s._offlineComponents}async function D_(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(wt(Po,"Using user provided OnlineComponentProvider"),await Hx(s,s._uninitializedComponentsProvider._online)):(wt(Po,"Using default OnlineComponentProvider"),await Hx(s,new $1))),s._onlineComponents}function B4(s){return D_(s).then((e=>e.syncEngine))}async function Bd(s){const e=await D_(s),n=e.eventManager;return n.onListen=_4.bind(null,e.syncEngine),n.onUnlisten=v4.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=A4.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=T4.bind(null,e.syncEngine),n}function V4(s,e,n={}){const o=new ka;return s.asyncQueue.enqueueAndForget((async()=>(function(g,x,T,b,w){const C=new Yg({next:P=>{C.Nu(),x.enqueueAndForget((()=>zg(g,N)));const B=P.docs.has(T);!B&&P.fromCache?w.reject(new ct(De.UNAVAILABLE,"Failed to get document because the client is offline.")):B&&P.fromCache&&b&&b.source==="server"?w.reject(new ct(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):w.resolve(P)},error:P=>w.reject(P)}),N=new Gg(nf(T.path),C,{includeMetadataChanges:!0,qa:!0});return jg(g,N)})(await Bd(s),s.asyncQueue,e,n,o))),o.promise}function U4(s,e,n={}){const o=new ka;return s.asyncQueue.enqueueAndForget((async()=>(function(g,x,T,b,w){const C=new Yg({next:P=>{C.Nu(),x.enqueueAndForget((()=>zg(g,N))),P.fromCache&&b.source==="server"?w.reject(new ct(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):w.resolve(P)},error:P=>w.reject(P)}),N=new Gg(T,C,{includeMetadataChanges:!0,qa:!0});return jg(g,N)})(await Bd(s),s.asyncQueue,e,n,o))),o.promise}function M_(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const Gx=new Map;const k_="firestore.googleapis.com",qx=!0;class Xx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ct(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=k_,this.ssl=qx}else this.host=e.host,this.ssl=e.ssl??qx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=d_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yI)throw new ct(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=M_(e.experimentalLongPollingOptions??{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ct(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ct(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ct(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(o,h){return o.timeoutSeconds===h.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ff{constructor(e,n,o,h){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=o,this._app=h,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ct(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ct(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(o){if(!o)return new H3;switch(o.type){case"firstParty":return new Y3(o.sessionIndex||"0",o.iamToken||null,o.authTokenFactory||null);case"provider":return o.client;default:throw new ct(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const o=Gx.get(n);o&&(wt("ComponentProvider","Removing Datastore"),Gx.delete(n),o.terminate())})(this),Promise.resolve()}}function F4(s,e,n,o={}){s=Di(s,ff);const h=Bo(e),g=s._getSettings(),x={...g,emulatorOptions:s._getEmulatorOptions()},T=`${e}:${n}`;h&&(og(`https://${T}`),lg("Firestore",!0)),g.host!==k_&&g.host!==T&&uc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const b={...g,host:T,ssl:h,emulatorOptions:o};if(!hl(b,x)&&(s._setSettings(b),o.mockUserToken)){let w,C;if(typeof o.mockUserToken=="string")w=o.mockUserToken,C=_i.MOCK_USER;else{w=Qb(o.mockUserToken,s._app?.options.projectId);const N=o.mockUserToken.sub||o.mockUserToken.user_id;if(!N)throw new ct(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");C=new _i(N)}s._authCredentials=new G3(new vw(w,C))}}class ja{constructor(e,n,o){this.converter=n,this._query=o,this.type="query",this.firestore=e}withConverter(e){return new ja(this.firestore,e,this._query)}}class Dr{constructor(e,n,o){this.converter=n,this._key=o,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Io(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dr(this.firestore,e,this._key)}toJSON(){return{type:Dr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,o){if(Uu(n,Dr._jsonSchema))return new Dr(e,o||null,new Lt(or.fromString(n.referencePath)))}}Dr._jsonSchemaVersion="firestore/documentReference/1.0",Dr._jsonSchema={type:qr("string",Dr._jsonSchemaVersion),referencePath:qr("string")};class Io extends ja{constructor(e,n,o){super(e,n,nf(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dr(this.firestore,null,new Lt(e))}withConverter(e){return new Io(this.firestore,e,this._path)}}function Wn(s,e,...n){if(s=sr(s),Tw("collection","path",e),s instanceof ff){const o=or.fromString(e,...n);return sx(o),new Io(s,null,o)}{if(!(s instanceof Dr||s instanceof Io))throw new ct(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(or.fromString(e,...n));return sx(o),new Io(s.firestore,null,o)}}function Tn(s,e,...n){if(s=sr(s),arguments.length===1&&(e=_g.newId()),Tw("doc","path",e),s instanceof ff){const o=or.fromString(e,...n);return ix(o),new Dr(s,null,new Lt(o))}{if(!(s instanceof Dr||s instanceof Io))throw new ct(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(or.fromString(e,...n));return ix(o),new Dr(s.firestore,s instanceof Io?s.converter:null,new Lt(o))}}const Yx="AsyncQueue";class Wx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new p_(this,"async_queue_retry"),this._c=()=>{const o=_1();o&&wt(Yx,"Visibility state changed to "+o.visibilityState),this.M_.w_()},this.ac=e;const n=_1();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=_1();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new ka;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!wc(e))throw e;wt(Yx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((o=>{throw this.nc=o,this.rc=!1,Ba("INTERNAL UNHANDLED ERROR: ",Kx(o)),o})).then((o=>(this.rc=!1,o))))));return this.ac=n,n}enqueueAfterDelay(e,n,o){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const h=Ug.createAndSchedule(this,e,n,o,(g=>this.hc(g)));return this.tc.push(h),h}uc(){this.nc&&Xt(47125,{Pc:Kx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,o)=>n.targetTimeMs-o.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Kx(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}function Qx(s){return(function(n,o){if(typeof n!="object"||n===null)return!1;const h=n;for(const g of o)if(g in h&&typeof h[g]=="function")return!0;return!1})(s,["next","error","complete"])}class ta extends ff{constructor(e,n,o,h){super(e,n,o,h),this.type="firestore",this._queue=new Wx,this._persistenceKey=h?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Wx(e),this._firestoreClient=void 0,await e}}}function j4(s,e){const n=typeof s=="object"?s:Wd(),o=typeof s=="string"?s:Id,h=Yd(n,"firestore").getImmediate({identifier:o});if(!h._initialized){const g=SE("firestore");g&&F4(h,...g)}return h}function Gu(s){if(s._terminated)throw new ct(De.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||z4(s),s._firestoreClient}function z4(s){const e=s._freezeSettings(),n=(function(h,g,x,T){return new hS(h,g,x,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,M_(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new L4(s._authCredentials,s._appCheckCredentials,s._queue,n,s._componentsProvider&&(function(h){const g=h?._online.build();return{_offline:h?._offline.build(g),_online:g}})(s._componentsProvider))}class Ts{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ts(di.fromBase64String(e))}catch(n){throw new ct(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ts(di.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ts._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Uu(e,Ts._jsonSchema))return Ts.fromBase64String(e.bytes)}}Ts._jsonSchemaVersion="firestore/bytes/1.0",Ts._jsonSchema={type:qr("string",Ts._jsonSchemaVersion),bytes:qr("string")};class qu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ct(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hi(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class gf{constructor(e){this._methodName=e}}class Js{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ct(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ct(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Cn(this._lat,e._lat)||Cn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Js._jsonSchemaVersion}}static fromJSON(e){if(Uu(e,Js._jsonSchema))return new Js(e.latitude,e.longitude)}}Js._jsonSchemaVersion="firestore/geoPoint/1.0",Js._jsonSchema={type:qr("string",Js._jsonSchemaVersion),latitude:qr("number"),longitude:qr("number")};class $s{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(o,h){if(o.length!==h.length)return!1;for(let g=0;g<o.length;++g)if(o[g]!==h[g])return!1;return!0})(this._values,e._values)}toJSON(){return{type:$s._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Uu(e,$s._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new $s(e.vectorValues);throw new ct(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$s._jsonSchemaVersion="firestore/vectorValue/1.0",$s._jsonSchema={type:qr("string",$s._jsonSchemaVersion),vectorValues:qr("object")};const H4=/^__.*__$/;class G4{constructor(e,n,o){this.data=e,this.fieldMask=n,this.fieldTransforms=o}toMutation(e,n){return this.fieldMask!==null?new Uo(e,this.data,this.fieldMask,n,this.fieldTransforms):new Fu(e,this.data,n,this.fieldTransforms)}}class L_{constructor(e,n,o){this.data=e,this.fieldMask=n,this.fieldTransforms=o}toMutation(e,n){return new Uo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function P_(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xt(40011,{Ac:s})}}class Wg{constructor(e,n,o,h,g,x){this.settings=e,this.databaseId=n,this.serializer=o,this.ignoreUndefinedProperties=h,g===void 0&&this.Rc(),this.fieldTransforms=g||[],this.fieldMask=x||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Wg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),o=this.Vc({path:n,fc:!1});return o.gc(e),o}yc(e){const n=this.path?.child(e),o=this.Vc({path:n,fc:!1});return o.Rc(),o}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Vd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(P_(this.Ac)&&H4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class q4{constructor(e,n,o){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=o||uf(e)}Cc(e,n,o,h=!1){return new Wg({Ac:e,methodName:n,Dc:o,path:hi.emptyPath(),fc:!1,bc:h},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(s){const e=s._freezeSettings(),n=uf(s._databaseId);return new q4(s._databaseId,!!e.ignoreUndefinedProperties,n)}function Kg(s,e,n,o,h,g={}){const x=s.Cc(g.merge||g.mergeFields?2:0,e,n,h);Zg("Data must be an object, but it was:",x,o);const T=U_(o,x);let b,w;if(g.merge)b=new us(x.fieldMask),w=x.fieldTransforms;else if(g.mergeFields){const C=[];for(const N of g.mergeFields){const P=eg(e,N,n);if(!x.contains(P))throw new ct(De.INVALID_ARGUMENT,`Field '${P}' is specified in your field mask but missing from your input data.`);j_(C,P)||C.push(P)}b=new us(C),w=x.fieldTransforms.filter((N=>b.covers(N.field)))}else b=null,w=x.fieldTransforms;return new G4(new Wi(T),b,w)}class mf extends gf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mf}}class Qg extends gf{_toFieldTransform(e){return new BS(e.path,new Nu)}isEqual(e){return e instanceof Qg}}function B_(s,e,n,o){const h=s.Cc(1,e,n);Zg("Data must be an object, but it was:",h,o);const g=[],x=Wi.empty();Vo(o,((b,w)=>{const C=Jg(e,b,n);w=sr(w);const N=h.yc(C);if(w instanceof mf)g.push(C);else{const P=Yu(w,N);P!=null&&(g.push(C),x.set(C,P))}}));const T=new us(g);return new L_(x,T,h.fieldTransforms)}function V_(s,e,n,o,h,g){const x=s.Cc(1,e,n),T=[eg(e,o,n)],b=[h];if(g.length%2!=0)throw new ct(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let P=0;P<g.length;P+=2)T.push(eg(e,g[P])),b.push(g[P+1]);const w=[],C=Wi.empty();for(let P=T.length-1;P>=0;--P)if(!j_(w,T[P])){const B=T[P];let ee=b[P];ee=sr(ee);const ne=x.yc(B);if(ee instanceof mf)w.push(B);else{const ae=Yu(ee,ne);ae!=null&&(w.push(B),C.set(B,ae))}}const N=new us(w);return new L_(C,N,x.fieldTransforms)}function X4(s,e,n,o=!1){return Yu(n,s.Cc(o?4:3,e))}function Yu(s,e){if(F_(s=sr(s)))return Zg("Unsupported field value:",e,s),U_(s,e);if(s instanceof gf)return(function(o,h){if(!P_(h.Ac))throw h.Sc(`${o._methodName}() can only be used with update() and set()`);if(!h.path)throw h.Sc(`${o._methodName}() is not currently supported inside arrays`);const g=o._toFieldTransform(h);g&&h.fieldTransforms.push(g)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(o,h){const g=[];let x=0;for(const T of o){let b=Yu(T,h.wc(x));b==null&&(b={nullValue:"NULL_VALUE"}),g.push(b),x++}return{arrayValue:{values:g}}})(s,e)}return(function(o,h){if((o=sr(o))===null)return{nullValue:"NULL_VALUE"};if(typeof o=="number")return kS(h.serializer,o);if(typeof o=="boolean")return{booleanValue:o};if(typeof o=="string")return{stringValue:o};if(o instanceof Date){const g=Vn.fromDate(o);return{timestampValue:Md(h.serializer,g)}}if(o instanceof Vn){const g=new Vn(o.seconds,1e3*Math.floor(o.nanoseconds/1e3));return{timestampValue:Md(h.serializer,g)}}if(o instanceof Js)return{geoPointValue:{latitude:o.latitude,longitude:o.longitude}};if(o instanceof Ts)return{bytesValue:s_(h.serializer,o._byteString)};if(o instanceof Dr){const g=h.databaseId,x=o.firestore._databaseId;if(!x.isEqual(g))throw h.Sc(`Document reference is for database ${x.projectId}/${x.database} but should be for database ${g.projectId}/${g.database}`);return{referenceValue:Ng(o.firestore._databaseId||h.databaseId,o._key.path)}}if(o instanceof $s)return(function(x,T){return{mapValue:{fields:{[kw]:{stringValue:Lw},[Rd]:{arrayValue:{values:x.toArray().map((w=>{if(typeof w!="number")throw T.Sc("VectorValues must only contain numeric values.");return Sg(T.serializer,w)}))}}}}}})(o,h);throw h.Sc(`Unsupported field value: ${Jd(o)}`)})(s,e)}function U_(s,e){const n={};return Iw(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vo(s,((o,h)=>{const g=Yu(h,e.mc(o));g!=null&&(n[o]=g)})),{mapValue:{fields:n}}}function F_(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Vn||s instanceof Js||s instanceof Ts||s instanceof Dr||s instanceof gf||s instanceof $s)}function Zg(s,e,n){if(!F_(n)||!Cw(n)){const o=Jd(n);throw o==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+o)}}function eg(s,e,n){if((e=sr(e))instanceof qu)return e._internalPath;if(typeof e=="string")return Jg(s,e);throw Vd("Field path arguments must be of type string or ",s,!1,void 0,n)}const Y4=new RegExp("[~\\*/\\[\\]]");function Jg(s,e,n){if(e.search(Y4)>=0)throw Vd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new qu(...e.split("."))._internalPath}catch{throw Vd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function Vd(s,e,n,o,h){const g=o&&!o.isEmpty(),x=h!==void 0;let T=`Function ${e}() called with invalid data`;n&&(T+=" (via `toFirestore()`)"),T+=". ";let b="";return(g||x)&&(b+=" (found",g&&(b+=` in field ${o}`),x&&(b+=` in document ${h}`),b+=")"),new ct(De.INVALID_ARGUMENT,T+s+b)}function j_(s,e){return s.some((n=>n.isEqual(e)))}class z_{constructor(e,n,o,h,g){this._firestore=e,this._userDataWriter=n,this._key=o,this._document=h,this._converter=g}get id(){return this._key.path.lastSegment()}get ref(){return new Dr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new W4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(pf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class W4 extends z_{data(){return super.data()}}function pf(s,e){return typeof e=="string"?Jg(s,e):e instanceof qu?e._internalPath:e._delegate._internalPath}function H_(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new ct(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $g{}class em extends $g{}function ui(s,e,...n){let o=[];e instanceof $g&&o.push(e),o=o.concat(n),(function(g){const x=g.filter((b=>b instanceof tm)).length,T=g.filter((b=>b instanceof yf)).length;if(x>1||x>0&&T>0)throw new ct(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(o);for(const h of o)s=h._apply(s);return s}class yf extends em{constructor(e,n,o){super(),this._field=e,this._op=n,this._value=o,this.type="where"}static _create(e,n,o){return new yf(e,n,o)}_apply(e){const n=this._parse(e);return G_(e._query,n),new ja(e.firestore,e.converter,G1(e._query,n))}_parse(e){const n=Xu(e.firestore);return(function(g,x,T,b,w,C,N){let P;if(w.isKeyField()){if(C==="array-contains"||C==="array-contains-any")throw new ct(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${C}' queries on documentId().`);if(C==="in"||C==="not-in"){eE(N,C);const ee=[];for(const ne of N)ee.push($x(b,g,ne));P={arrayValue:{values:ee}}}else P=$x(b,g,N)}else C!=="in"&&C!=="not-in"&&C!=="array-contains-any"||eE(N,C),P=X4(T,x,N,C==="in"||C==="not-in");return Gr.create(w,C,P)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ar(s,e,n){const o=e,h=pf("where",s);return yf._create(h,o,n)}class tm extends $g{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new tm(e,n)}_parse(e){const n=this._queryConstraints.map((o=>o._parse(e))).filter((o=>o.getFilters().length>0));return n.length===1?n[0]:Ls.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(h,g){let x=h;const T=g.getFlattenedFilters();for(const b of T)G_(x,b),x=G1(x,b)})(e._query,n),new ja(e.firestore,e.converter,G1(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class nm extends em{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new nm(e,n)}_apply(e){const n=(function(h,g,x){if(h.startAt!==null)throw new ct(De.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(h.endAt!==null)throw new ct(De.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ru(g,x)})(e._query,this._field,this._direction);return new ja(e.firestore,e.converter,(function(h,g){const x=h.explicitOrderBy.concat([g]);return new _c(h.path,h.collectionGroup,x,h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(e._query,n))}}function Zx(s,e="asc"){const n=e,o=pf("orderBy",s);return nm._create(o,n)}class rm extends em{constructor(e,n,o){super(),this.type=e,this._limit=n,this._limitType=o}static _create(e,n,o){return new rm(e,n,o)}_apply(e){return new ja(e.firestore,e.converter,Od(e._query,this._limit,this._limitType))}}function Jx(s){return eS("limit",s),rm._create("limit",s,"F")}function $x(s,e,n){if(typeof(n=sr(n))=="string"){if(n==="")throw new ct(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hw(e)&&n.indexOf("/")!==-1)throw new ct(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const o=e.path.child(or.fromString(n));if(!Lt.isDocumentKey(o))throw new ct(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${o}' is not because it has an odd number of segments (${o.length}).`);return fx(s,new Lt(o))}if(n instanceof Dr)return fx(s,n._key);throw new ct(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jd(n)}.`)}function eE(s,e){if(!Array.isArray(s)||s.length===0)throw new ct(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function G_(s,e){const n=(function(h,g){for(const x of h)for(const T of x.getFlattenedFilters())if(g.indexOf(T.op)>=0)return T.op;return null})(s.filters,(function(h){switch(h){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new ct(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ct(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class K4{convertValue(e,n="none"){switch(ko(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Mo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Xt(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const o={};return Vo(e,((h,g)=>{o[h]=this.convertValue(g,n)})),o}convertVectorValue(e){const n=e.fields?.[Rd].arrayValue?.values?.map((o=>Vr(o.doubleValue)));return new $s(n)}convertGeoPoint(e){return new Js(Vr(e.latitude),Vr(e.longitude))}convertArray(e,n){return(e.values||[]).map((o=>this.convertValue(o,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const o=tf(e);return o==null?null:this.convertValue(o,n);case"estimate":return this.convertTimestamp(Cu(e));default:return null}}convertTimestamp(e){const n=Do(e);return new Vn(n.seconds,n.nanos)}convertDocumentKey(e,n){const o=or.fromString(e);qn(h_(o),9688,{name:e});const h=new Su(o.get(1),o.get(3)),g=new Lt(o.popFirst(5));return h.isEqual(n)||Ba(`Document ${g} contains a document reference within a different database (${h.projectId}/${h.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),g}}function im(s,e,n){let o;return o=s?n&&(n.merge||n.mergeFields)?s.toFirestore(e,n):s.toFirestore(e):e,o}class gu{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ll extends z_{constructor(e,n,o,h,g,x){super(e,n,o,h,x),this._firestore=e,this._firestoreImpl=e,this.metadata=g}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const o=this._document.data.field(pf("DocumentSnapshot.get",e));if(o!==null)return this._userDataWriter.convertValue(o,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ll._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ll._jsonSchemaVersion="firestore/documentSnapshot/1.0",ll._jsonSchema={type:qr("string",ll._jsonSchemaVersion),bundleSource:qr("string","DocumentSnapshot"),bundleName:qr("string"),bundle:qr("string")};class yd extends ll{data(e={}){return super.data(e)}}class cl{constructor(e,n,o,h){this._firestore=e,this._userDataWriter=n,this._snapshot=h,this.metadata=new gu(h.hasPendingWrites,h.fromCache),this.query=o}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((o=>{e.call(n,new yd(this._firestore,this._userDataWriter,o.key,o,new gu(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ct(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(h,g){if(h._snapshot.oldDocs.isEmpty()){let x=0;return h._snapshot.docChanges.map((T=>{const b=new yd(h._firestore,h._userDataWriter,T.doc.key,T.doc,new gu(h._snapshot.mutatedKeys.has(T.doc.key),h._snapshot.fromCache),h.query.converter);return T.doc,{type:"added",doc:b,oldIndex:-1,newIndex:x++}}))}{let x=h._snapshot.oldDocs;return h._snapshot.docChanges.filter((T=>g||T.type!==3)).map((T=>{const b=new yd(h._firestore,h._userDataWriter,T.doc.key,T.doc,new gu(h._snapshot.mutatedKeys.has(T.doc.key),h._snapshot.fromCache),h.query.converter);let w=-1,C=-1;return T.type!==0&&(w=x.indexOf(T.doc.key),x=x.delete(T.doc.key)),T.type!==1&&(x=x.add(T.doc),C=x.indexOf(T.doc.key)),{type:Q4(T.type),doc:b,oldIndex:w,newIndex:C}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=cl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_g.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],o=[],h=[];return this.docs.forEach((g=>{g._document!==null&&(n.push(g._document),o.push(this._userDataWriter.convertObjectMap(g._document.data.value.mapValue.fields,"previous")),h.push(g.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Q4(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xt(61501,{type:s})}}function Ua(s){s=Di(s,Dr);const e=Di(s.firestore,ta);return V4(Gu(e),s._key).then((n=>X_(e,s,n)))}cl._jsonSchemaVersion="firestore/querySnapshot/1.0",cl._jsonSchema={type:qr("string",cl._jsonSchemaVersion),bundleSource:qr("string","QuerySnapshot"),bundleName:qr("string"),bundle:qr("string")};class sm extends K4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ts(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Dr(this.firestore,null,n)}}function gr(s){s=Di(s,ja);const e=Di(s.firestore,ta),n=Gu(e),o=new sm(e);return H_(s._query),U4(n,s._query).then((h=>new cl(e,o,s,h)))}function ul(s,e,n){s=Di(s,Dr);const o=Di(s.firestore,ta),h=im(s.converter,e,n);return Wu(o,[Kg(Xu(o),"setDoc",s._key,h,s.converter!==null,n).toMutation(s._key,Mi.none())])}function bi(s,e,n,...o){s=Di(s,Dr);const h=Di(s.firestore,ta),g=Xu(h);let x;return x=typeof(e=sr(e))=="string"||e instanceof qu?V_(g,"updateDoc",s._key,e,n,o):B_(g,"updateDoc",s._key,e),Wu(h,[x.toMutation(s._key,Mi.exists(!0))])}function q_(s){return Wu(Di(s.firestore,ta),[new lf(s._key,Mi.none())])}function xd(s,e){const n=Di(s.firestore,ta),o=Tn(s),h=im(s.converter,e);return Wu(n,[Kg(Xu(s.firestore),"addDoc",o._key,h,s.converter!==null,{}).toMutation(o._key,Mi.exists(!1))]).then((()=>o))}function tE(s,...e){s=sr(s);let n={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Qx(e[o])||(n=e[o++]);const h={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Qx(e[o])){const b=e[o];e[o]=b.next?.bind(b),e[o+1]=b.error?.bind(b),e[o+2]=b.complete?.bind(b)}let g,x,T;if(s instanceof Dr)x=Di(s.firestore,ta),T=nf(s._key.path),g={next:b=>{e[o]&&e[o](X_(x,s,b))},error:e[o+1],complete:e[o+2]};else{const b=Di(s,ja);x=Di(b.firestore,ta),T=b._query;const w=new sm(x);g={next:C=>{e[o]&&e[o](new cl(x,w,b,C))},error:e[o+1],complete:e[o+2]},H_(s._query)}return(function(w,C,N,P){const B=new Yg(P),ee=new Gg(C,B,N);return w.asyncQueue.enqueueAndForget((async()=>jg(await Bd(w),ee))),()=>{B.Nu(),w.asyncQueue.enqueueAndForget((async()=>zg(await Bd(w),ee)))}})(Gu(x),T,h,g)}function Wu(s,e){return(function(o,h){const g=new ka;return o.asyncQueue.enqueueAndForget((async()=>C4(await B4(o),h,g))),g.promise})(Gu(s),e)}function X_(s,e,n){const o=n.docs.get(e._key),h=new sm(s);return new ll(s,h,e._key,o,new gu(n.hasPendingWrites,n.fromCache),e.converter)}class Z4{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,n,o){this._verifyNotCommitted();const h=b1(e,this._firestore),g=im(h.converter,n,o),x=Kg(this._dataReader,"WriteBatch.set",h._key,g,h.converter!==null,o);return this._mutations.push(x.toMutation(h._key,Mi.none())),this}update(e,n,o,...h){this._verifyNotCommitted();const g=b1(e,this._firestore);let x;return x=typeof(n=sr(n))=="string"||n instanceof qu?V_(this._dataReader,"WriteBatch.update",g._key,n,o,h):B_(this._dataReader,"WriteBatch.update",g._key,n),this._mutations.push(x.toMutation(g._key,Mi.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=b1(e,this._firestore);return this._mutations=this._mutations.concat(new lf(n._key,Mi.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ct(De.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function b1(s,e){if((s=sr(s)).firestore!==e)throw new ct(De.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function Ed(){return new Qg("serverTimestamp")}function au(s){return Gu(s=Di(s,ta)),new Z4(s,(e=>Wu(s,e)))}(function(e,n=!0){(function(h){xc=h})(yc),dl(new No("firestore",((o,{instanceIdentifier:h,options:g})=>{const x=o.getProvider("app").getImmediate(),T=new ta(new q3(o.getProvider("auth-internal")),new W3(x,o.getProvider("app-check-internal")),(function(w,C){if(!Object.prototype.hasOwnProperty.apply(w.options,["projectId"]))throw new ct(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Su(w.options.projectId,C)})(x,h),x);return g={useFetchStreams:n,...g},T._setSettings(g),T}),"PUBLIC").setMultipleInstances(!0)),Ys(ex,tx,e),Ys(ex,tx,"esm2020")})();const Y_={apiKey:"AIzaSyARwb6K0M4l-hWKi8FrOLEVqRqeHRf8JR4",authDomain:"oppmoteboka.firebaseapp.com",projectId:"oppmoteboka",storageBucket:"oppmoteboka.firebasestorage.app",messagingSenderId:"732911922070",appId:"1:732911922070:web:b16d9de65062395c018bb7"},W_=DE().length?Wd():hg(Y_),ol=pw(W_),Et=j4(W_),J4=DE().find(s=>s.name==="secondary")??hg(Y_,"secondary"),v1=pw(J4);function bc(){const[s,e]=he.useState(null),[n,o]=he.useState(!0);return he.useEffect(()=>{const T=NC(ol,async b=>{if(!b){e(null),o(!1);return}try{const w=Tn(Et,"users",b.uid);let C=await Ua(w);if(!C.exists()){const ee={uid:b.uid,email:b.email??"",displayName:b.displayName??b.email??"",role:"student",term:null,termLabel:null,semesterStatus:"aktiv"};await ul(w,{...ee,createdAt:Ed()}),e(ee),o(!1);return}const N=C.data();let P=N?.email??b.email??"";if(b.email&&N?.email!==b.email)try{await bi(w,{email:b.email}),P=b.email}catch(ee){console.warn("Kunne ikke synkronisere epost til Firestore:",ee)}const B={uid:b.uid,email:P,role:N?.role??"student",term:N?.term??null,termLabel:N?.termLabel??null,semesterStatus:N?.semesterStatus??null,displayName:N?.name??N?.displayName??b.displayName??b.email??""};e(B)}catch(w){console.error("Feil ved henting/oppretting av bruker:",w),e(null)}finally{o(!1)}});return()=>T()},[]),{user:s,loading:n,login:async(T,b)=>{await TC(ol,T,b)},register:async(T,b)=>{await cd(ol,T,b)},logout:async()=>{await OC(ol)}}}var _t;(function(s){s[s.QR_CODE=0]="QR_CODE",s[s.AZTEC=1]="AZTEC",s[s.CODABAR=2]="CODABAR",s[s.CODE_39=3]="CODE_39",s[s.CODE_93=4]="CODE_93",s[s.CODE_128=5]="CODE_128",s[s.DATA_MATRIX=6]="DATA_MATRIX",s[s.MAXICODE=7]="MAXICODE",s[s.ITF=8]="ITF",s[s.EAN_13=9]="EAN_13",s[s.EAN_8=10]="EAN_8",s[s.PDF_417=11]="PDF_417",s[s.RSS_14=12]="RSS_14",s[s.RSS_EXPANDED=13]="RSS_EXPANDED",s[s.UPC_A=14]="UPC_A",s[s.UPC_E=15]="UPC_E",s[s.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(_t||(_t={}));var nE=new Map([[_t.QR_CODE,"QR_CODE"],[_t.AZTEC,"AZTEC"],[_t.CODABAR,"CODABAR"],[_t.CODE_39,"CODE_39"],[_t.CODE_93,"CODE_93"],[_t.CODE_128,"CODE_128"],[_t.DATA_MATRIX,"DATA_MATRIX"],[_t.MAXICODE,"MAXICODE"],[_t.ITF,"ITF"],[_t.EAN_13,"EAN_13"],[_t.EAN_8,"EAN_8"],[_t.PDF_417,"PDF_417"],[_t.RSS_14,"RSS_14"],[_t.RSS_EXPANDED,"RSS_EXPANDED"],[_t.UPC_A,"UPC_A"],[_t.UPC_E,"UPC_E"],[_t.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),rE;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.URL=1]="URL"})(rE||(rE={}));function $4(s){return Object.values(_t).includes(s)}var Ud;(function(s){s[s.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",s[s.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Ud||(Ud={}));var e8=(function(){function s(){}return s.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",s.SCAN_DEFAULT_FPS=2,s.DEFAULT_DISABLE_FLIP=!1,s.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,s.DEFAULT_SUPPORTED_SCAN_TYPE=[Ud.SCAN_TYPE_CAMERA,Ud.SCAN_TYPE_FILE],s})(),K_=(function(){function s(e,n){this.format=e,this.formatName=n}return s.prototype.toString=function(){return this.formatName},s.create=function(e){if(!nE.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new s(e,nE.get(e))},s})(),iE=(function(){function s(){}return s.createFromText=function(e){var n={text:e};return{decodedText:e,result:n}},s.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},s})(),tg;(function(s){s[s.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",s[s.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",s[s.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(tg||(tg={}));var t8=(function(){function s(){}return s.createFrom=function(e){return{errorMessage:e,type:tg.UNKWOWN_ERROR}},s})(),n8=(function(){function s(e){this.verbose=e}return s.prototype.log=function(e){this.verbose&&console.log(e)},s.prototype.warn=function(e){this.verbose&&console.warn(e)},s.prototype.logError=function(e,n){(this.verbose||n===!0)&&console.error(e)},s.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},s})();function Na(s){return typeof s>"u"||s===null}var rc=(function(){function s(){}return s.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},s.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},s.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},s.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},s.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},s.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},s.scannerPaused=function(){return"Scanner paused"},s})(),Q_=(function(){function s(){}return s.isMediaStreamConstraintsValid=function(e,n){if(typeof e!="object"){var o=typeof e;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(o,"."),!0),!1}for(var h=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],g=new Set(h),x=Object.keys(e),T=0,b=x;T<b.length;T++){var w=b[T];if(g.has(w))return n.logError("".concat(w," is not supported videoConstaints."),!0),!1}return!0},s})(),mu={exports:{}},r8=mu.exports,sE;function i8(){return sE||(sE=1,(function(s,e){(function(n,o){o(e)})(r8,(function(n){function o(M){return M==null}var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,r){M.__proto__=r}||function(M,r){for(var a in r)r.hasOwnProperty(a)&&(M[a]=r[a])};function g(M,r){h(M,r);function a(){this.constructor=M}M.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}function x(M,r){var a=Object.setPrototypeOf;a?a(M,r):M.__proto__=r}function T(M,r){r===void 0&&(r=M.constructor);var a=Error.captureStackTrace;a&&a(M,r)}var b=(function(M){g(r,M);function r(a){var l=this.constructor,u=M.call(this,a)||this;return Object.defineProperty(u,"name",{value:l.name,enumerable:!1}),x(u,l.prototype),T(u),u}return r})(Error);class w extends b{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}w.kind="Exception";class C extends w{}C.kind="ArgumentException";class N extends w{}N.kind="IllegalArgumentException";class P{constructor(r){if(this.binarizer=r,r===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,a){return this.binarizer.getBlackRow(r,a)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,a,l,u){const d=this.binarizer.getLuminanceSource().crop(r,a,l,u);return new P(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new P(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new P(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class B extends w{static getChecksumInstance(){return new B}}B.kind="ChecksumException";class ee{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class ne{static arraycopy(r,a,l,u,d){for(;d--;)l[u++]=r[a++]}static currentTimeMillis(){return Date.now()}}class ae extends w{}ae.kind="IndexOutOfBoundsException";class tt extends ae{constructor(r=void 0,a=void 0){super(a),this.index=r,this.message=a}}tt.kind="ArrayIndexOutOfBoundsException";class ze{static fill(r,a){for(let l=0,u=r.length;l<u;l++)r[l]=a}static fillWithin(r,a,l,u){ze.rangeCheck(r.length,a,l);for(let d=a;d<l;d++)r[d]=u}static rangeCheck(r,a,l){if(a>l)throw new N("fromIndex("+a+") > toIndex("+l+")");if(a<0)throw new tt(a);if(l>r)throw new tt(l)}static asList(...r){return r}static create(r,a,l){return Array.from({length:r}).map(d=>Array.from({length:a}).fill(l))}static createInt32Array(r,a,l){return Array.from({length:r}).map(d=>Int32Array.from({length:a}).fill(l))}static equals(r,a){if(!r||!a||!r.length||!a.length||r.length!==a.length)return!1;for(let l=0,u=r.length;l<u;l++)if(r[l]!==a[l])return!1;return!0}static hashCode(r){if(r===null)return 0;let a=1;for(const l of r)a=31*a+l;return a}static fillUint8Array(r,a){for(let l=0;l!==r.length;l++)r[l]=a}static copyOf(r,a){return r.slice(0,a)}static copyOfUint8Array(r,a){if(r.length<=a){const l=new Uint8Array(a);return l.set(r),l}return r.slice(0,a)}static copyOfRange(r,a,l){const u=l-a,d=new Int32Array(u);return ne.arraycopy(r,a,d,0,u),d}static binarySearch(r,a,l){l===void 0&&(l=ze.numberComparator);let u=0,d=r.length-1;for(;u<=d;){const m=d+u>>1,y=l(a,r[m]);if(y>0)u=m+1;else if(y<0)d=m-1;else return m}return-u-1}static numberComparator(r,a){return r-a}}class fe{static numberOfTrailingZeros(r){let a;if(r===0)return 32;let l=31;return a=r<<16,a!==0&&(l-=16,r=a),a=r<<8,a!==0&&(l-=8,r=a),a=r<<4,a!==0&&(l-=4,r=a),a=r<<2,a!==0&&(l-=2,r=a),l-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let a=1;return r>>>16||(a+=16,r<<=16),r>>>24||(a+=8,r<<=8),r>>>28||(a+=4,r<<=4),r>>>30||(a+=2,r<<=2),a-=r>>>31,a}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,a){return Math.trunc(r/a)}static parseInt(r,a=void 0){return parseInt(r,a)}}fe.MIN_VALUE_32_BITS=-2147483648,fe.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ge{constructor(r,a){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,a==null?this.bits=Ge.makeArray(r):this.bits=a)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const a=Ge.makeArray(r);ne.arraycopy(this.bits,0,a,0,this.bits.length),this.bits=a}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const a=this.size;if(r>=a)return a;const l=this.bits;let u=Math.floor(r/32),d=l[u];d&=~((1<<(r&31))-1);const m=l.length;for(;d===0;){if(++u===m)return a;d=l[u]}const y=u*32+fe.numberOfTrailingZeros(d);return y>a?a:y}getNextUnset(r){const a=this.size;if(r>=a)return a;const l=this.bits;let u=Math.floor(r/32),d=~l[u];d&=~((1<<(r&31))-1);const m=l.length;for(;d===0;){if(++u===m)return a;d=~l[u]}const y=u*32+fe.numberOfTrailingZeros(d);return y>a?a:y}setBulk(r,a){this.bits[Math.floor(r/32)]=a}setRange(r,a){if(a<r||r<0||a>this.size)throw new N;if(a===r)return;a--;const l=Math.floor(r/32),u=Math.floor(a/32),d=this.bits;for(let m=l;m<=u;m++){const y=m>l?0:r&31,v=(2<<(m<u?31:a&31))-(1<<y);d[m]|=v}}clear(){const r=this.bits.length,a=this.bits;for(let l=0;l<r;l++)a[l]=0}isRange(r,a,l){if(a<r||r<0||a>this.size)throw new N;if(a===r)return!0;a--;const u=Math.floor(r/32),d=Math.floor(a/32),m=this.bits;for(let y=u;y<=d;y++){const _=y>u?0:r&31,I=(2<<(y<d?31:a&31))-(1<<_)&4294967295;if((m[y]&I)!==(l?I:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,a){if(a<0||a>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+a);for(let l=a;l>0;l--)this.appendBit((r>>l-1&1)===1)}appendBitArray(r){const a=r.size;this.ensureCapacity(this.size+a);for(let l=0;l<a;l++)this.appendBit(r.get(l))}xor(r){if(this.size!==r.size)throw new N("Sizes don't match");const a=this.bits;for(let l=0,u=a.length;l<u;l++)a[l]^=r.bits[l]}toBytes(r,a,l,u){for(let d=0;d<u;d++){let m=0;for(let y=0;y<8;y++)this.get(r)&&(m|=1<<7-y),r++;a[l+d]=m}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),a=Math.floor((this.size-1)/32),l=a+1,u=this.bits;for(let d=0;d<l;d++){let m=u[d];m=m>>1&1431655765|(m&1431655765)<<1,m=m>>2&858993459|(m&858993459)<<2,m=m>>4&252645135|(m&252645135)<<4,m=m>>8&16711935|(m&16711935)<<8,m=m>>16&65535|(m&65535)<<16,r[a-d]=m}if(this.size!==l*32){const d=l*32-this.size;let m=r[0]>>>d;for(let y=1;y<l;y++){const _=r[y];m|=_<<32-d,r[y-1]=m,m=_>>>d}r[l-1]=m}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof Ge))return!1;const a=r;return this.size===a.size&&ze.equals(this.bits,a.bits)}hashCode(){return 31*this.size+ze.hashCode(this.bits)}toString(){let r="";for(let a=0,l=this.size;a<l;a++)(a&7)===0&&(r+=" "),r+=this.get(a)?"X":".";return r}clone(){return new Ge(this.size,this.bits.slice())}}var gt;(function(M){M[M.OTHER=0]="OTHER",M[M.PURE_BARCODE=1]="PURE_BARCODE",M[M.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",M[M.TRY_HARDER=3]="TRY_HARDER",M[M.CHARACTER_SET=4]="CHARACTER_SET",M[M.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",M[M.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",M[M.ASSUME_GS1=7]="ASSUME_GS1",M[M.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",M[M.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",M[M.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(gt||(gt={}));var Qe=gt;class F extends w{static getFormatInstance(){return new F}}F.kind="FormatException";var z;(function(M){M[M.Cp437=0]="Cp437",M[M.ISO8859_1=1]="ISO8859_1",M[M.ISO8859_2=2]="ISO8859_2",M[M.ISO8859_3=3]="ISO8859_3",M[M.ISO8859_4=4]="ISO8859_4",M[M.ISO8859_5=5]="ISO8859_5",M[M.ISO8859_6=6]="ISO8859_6",M[M.ISO8859_7=7]="ISO8859_7",M[M.ISO8859_8=8]="ISO8859_8",M[M.ISO8859_9=9]="ISO8859_9",M[M.ISO8859_10=10]="ISO8859_10",M[M.ISO8859_11=11]="ISO8859_11",M[M.ISO8859_13=12]="ISO8859_13",M[M.ISO8859_14=13]="ISO8859_14",M[M.ISO8859_15=14]="ISO8859_15",M[M.ISO8859_16=15]="ISO8859_16",M[M.SJIS=16]="SJIS",M[M.Cp1250=17]="Cp1250",M[M.Cp1251=18]="Cp1251",M[M.Cp1252=19]="Cp1252",M[M.Cp1256=20]="Cp1256",M[M.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",M[M.UTF8=22]="UTF8",M[M.ASCII=23]="ASCII",M[M.Big5=24]="Big5",M[M.GB18030=25]="GB18030",M[M.EUC_KR=26]="EUC_KR"})(z||(z={}));class U{constructor(r,a,l,...u){this.valueIdentifier=r,this.name=l,typeof a=="number"?this.values=Int32Array.from([a]):this.values=a,this.otherEncodingNames=u,U.VALUE_IDENTIFIER_TO_ECI.set(r,this),U.NAME_TO_ECI.set(l,this);const d=this.values;for(let m=0,y=d.length;m!==y;m++){const _=d[m];U.VALUES_TO_ECI.set(_,this)}for(const m of u)U.NAME_TO_ECI.set(m,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new F("incorect value");const a=U.VALUES_TO_ECI.get(r);if(a===void 0)throw new F("incorect value");return a}static getCharacterSetECIByName(r){const a=U.NAME_TO_ECI.get(r);if(a===void 0)throw new F("incorect value");return a}equals(r){if(!(r instanceof U))return!1;const a=r;return this.getName()===a.getName()}}U.VALUE_IDENTIFIER_TO_ECI=new Map,U.VALUES_TO_ECI=new Map,U.NAME_TO_ECI=new Map,U.Cp437=new U(z.Cp437,Int32Array.from([0,2]),"Cp437"),U.ISO8859_1=new U(z.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),U.ISO8859_2=new U(z.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),U.ISO8859_3=new U(z.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),U.ISO8859_4=new U(z.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),U.ISO8859_5=new U(z.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),U.ISO8859_6=new U(z.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),U.ISO8859_7=new U(z.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),U.ISO8859_8=new U(z.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),U.ISO8859_9=new U(z.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),U.ISO8859_10=new U(z.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),U.ISO8859_11=new U(z.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),U.ISO8859_13=new U(z.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),U.ISO8859_14=new U(z.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),U.ISO8859_15=new U(z.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),U.ISO8859_16=new U(z.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),U.SJIS=new U(z.SJIS,20,"SJIS","Shift_JIS"),U.Cp1250=new U(z.Cp1250,21,"Cp1250","windows-1250"),U.Cp1251=new U(z.Cp1251,22,"Cp1251","windows-1251"),U.Cp1252=new U(z.Cp1252,23,"Cp1252","windows-1252"),U.Cp1256=new U(z.Cp1256,24,"Cp1256","windows-1256"),U.UnicodeBigUnmarked=new U(z.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),U.UTF8=new U(z.UTF8,26,"UTF8","UTF-8"),U.ASCII=new U(z.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),U.Big5=new U(z.Big5,28,"Big5"),U.GB18030=new U(z.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),U.EUC_KR=new U(z.EUC_KR,30,"EUC_KR","EUC-KR");class J extends w{}J.kind="UnsupportedOperationException";class X{static decode(r,a){const l=this.encodingName(a);return this.customDecoder?this.customDecoder(r,l):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(l)?this.decodeFallback(r,l):new TextDecoder(l).decode(r)}static shouldDecodeOnFallback(r){return!X.isBrowser()&&r==="ISO-8859-1"}static encode(r,a){const l=this.encodingName(a);return this.customEncoder?this.customEncoder(r,l):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof U?r:U.getCharacterSetECIByName(r)}static decodeFallback(r,a){const l=this.encodingCharacterSet(a);if(X.isDecodeFallbackSupported(l)){let u="";for(let d=0,m=r.length;d<m;d++){let y=r[d].toString(16);y.length<2&&(y="0"+y),u+="%"+y}return decodeURIComponent(u)}if(l.equals(U.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new J(`Encoding ${this.encodingName(a)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(U.UTF8)||r.equals(U.ISO8859_1)||r.equals(U.ASCII)}static encodeFallback(r){const l=btoa(unescape(encodeURIComponent(r))).split(""),u=[];for(let d=0;d<l.length;d++)u.push(l[d].charCodeAt(0));return new Uint8Array(u)}}class Y{static castAsNonUtf8Char(r,a=null){const l=a?a.getName():this.ISO88591;return X.decode(new Uint8Array([r]),l)}static guessEncoding(r,a){if(a!=null&&a.get(Qe.CHARACTER_SET)!==void 0)return a.get(Qe.CHARACTER_SET).toString();const l=r.length;let u=!0,d=!0,m=!0,y=0,_=0,v=0,I=0,k=0,L=0,q=0,Z=0,$=0,ue=0,_e=0;const Ze=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let Ye=0;Ye<l&&(u||d||m);Ye++){const He=r[Ye]&255;m&&(y>0?(He&128)===0?m=!1:y--:(He&128)!==0&&((He&64)===0?m=!1:(y++,(He&32)===0?_++:(y++,(He&16)===0?v++:(y++,(He&8)===0?I++:m=!1))))),u&&(He>127&&He<160?u=!1:He>159&&(He<192||He===215||He===247)&&_e++),d&&(k>0?He<64||He===127||He>252?d=!1:k--:He===128||He===160||He>239?d=!1:He>160&&He<224?(L++,Z=0,q++,q>$&&($=q)):He>127?(k++,q=0,Z++,Z>ue&&(ue=Z)):(q=0,Z=0))}return m&&y>0&&(m=!1),d&&k>0&&(d=!1),m&&(Ze||_+v+I>0)?Y.UTF8:d&&(Y.ASSUME_SHIFT_JIS||$>=3||ue>=3)?Y.SHIFT_JIS:u&&d?$===2&&L===2||_e*10>=l?Y.SHIFT_JIS:Y.ISO88591:u?Y.ISO88591:d?Y.SHIFT_JIS:m?Y.UTF8:Y.PLATFORM_DEFAULT_ENCODING}static format(r,...a){let l=-1;function u(m,y,_,v,I,k){if(m==="%%")return"%";if(a[++l]===void 0)return;m=v?parseInt(v.substr(1)):void 0;let L=I?parseInt(I.substr(1)):void 0,q;switch(k){case"s":q=a[l];break;case"c":q=a[l][0];break;case"f":q=parseFloat(a[l]).toFixed(m);break;case"p":q=parseFloat(a[l]).toPrecision(m);break;case"e":q=parseFloat(a[l]).toExponential(m);break;case"x":q=parseInt(a[l]).toString(L||16);break;case"d":q=parseFloat(parseInt(a[l],L||10).toPrecision(m)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(L);let Z=parseInt(_),$=_&&_[0]+""=="0"?"0":" ";for(;q.length<Z;)q=y!==void 0?q+$:$+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,u)}static getBytes(r,a){return X.encode(r,a)}static getCharCode(r,a=0){return r.charCodeAt(a)}static getCharAt(r){return String.fromCharCode(r)}}Y.SHIFT_JIS=U.SJIS.getName(),Y.GB2312="GB2312",Y.ISO88591=U.ISO8859_1.getName(),Y.EUC_JP="EUC_JP",Y.UTF8=U.UTF8.getName(),Y.PLATFORM_DEFAULT_ENCODING=Y.UTF8,Y.ASSUME_SHIFT_JIS=!1;class G{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=Y.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,a,l){for(let u=a;a<a+l;u++)this.append(r[u]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,a){this.value=this.value.substr(0,r)+a+this.value.substr(r+1)}substring(r,a){return this.value.substring(r,a)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,a){this.value=this.value.substr(0,r)+a+this.value.substr(r+a.length)}}class ot{constructor(r,a,l,u){if(this.width=r,this.height=a,this.rowSize=l,this.bits=u,a==null&&(a=r),this.height=a,r<1||a<1)throw new N("Both dimensions must be greater than 0");l==null&&(l=Math.floor((r+31)/32)),this.rowSize=l,u==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const a=r.length,l=r[0].length,u=new ot(l,a);for(let d=0;d<a;d++){const m=r[d];for(let y=0;y<l;y++)m[y]&&u.set(y,d)}return u}static parseFromString(r,a,l){if(r===null)throw new N("stringRepresentation cannot be null");const u=new Array(r.length);let d=0,m=0,y=-1,_=0,v=0;for(;v<r.length;)if(r.charAt(v)===`
`||r.charAt(v)==="\r"){if(d>m){if(y===-1)y=d-m;else if(d-m!==y)throw new N("row lengths do not match");m=d,_++}v++}else if(r.substring(v,v+a.length)===a)v+=a.length,u[d]=!0,d++;else if(r.substring(v,v+l.length)===l)v+=l.length,u[d]=!1,d++;else throw new N("illegal character encountered: "+r.substring(v));if(d>m){if(y===-1)y=d-m;else if(d-m!==y)throw new N("row lengths do not match");_++}const I=new ot(y,_);for(let k=0;k<d;k++)u[k]&&I.set(Math.floor(k%y),Math.floor(k/y));return I}get(r,a){const l=a*this.rowSize+Math.floor(r/32);return(this.bits[l]>>>(r&31)&1)!==0}set(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]|=1<<(r&31)&4294967295}unset(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]&=~(1<<(r&31)&4294967295)}flip(r,a){const l=a*this.rowSize+Math.floor(r/32);this.bits[l]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new N("input matrix dimensions do not match");const a=new Ge(Math.floor(this.width/32)+1),l=this.rowSize,u=this.bits;for(let d=0,m=this.height;d<m;d++){const y=d*l,_=r.getRow(d,a).getBitArray();for(let v=0;v<l;v++)u[y+v]^=_[v]}}clear(){const r=this.bits,a=r.length;for(let l=0;l<a;l++)r[l]=0}setRegion(r,a,l,u){if(a<0||r<0)throw new N("Left and top must be nonnegative");if(u<1||l<1)throw new N("Height and width must be at least 1");const d=r+l,m=a+u;if(m>this.height||d>this.width)throw new N("The region must fit inside the matrix");const y=this.rowSize,_=this.bits;for(let v=a;v<m;v++){const I=v*y;for(let k=r;k<d;k++)_[I+Math.floor(k/32)]|=1<<(k&31)&4294967295}}getRow(r,a){a==null||a.getSize()<this.width?a=new Ge(this.width):a.clear();const l=this.rowSize,u=this.bits,d=r*l;for(let m=0;m<l;m++)a.setBulk(m*32,u[d+m]);return a}setRow(r,a){ne.arraycopy(a.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),a=this.getHeight();let l=new Ge(r),u=new Ge(r);for(let d=0,m=Math.floor((a+1)/2);d<m;d++)l=this.getRow(d,l),u=this.getRow(a-1-d,u),l.reverse(),u.reverse(),this.setRow(d,u),this.setRow(a-1-d,l)}getEnclosingRectangle(){const r=this.width,a=this.height,l=this.rowSize,u=this.bits;let d=r,m=a,y=-1,_=-1;for(let v=0;v<a;v++)for(let I=0;I<l;I++){const k=u[v*l+I];if(k!==0){if(v<m&&(m=v),v>_&&(_=v),I*32<d){let L=0;for(;(k<<31-L&4294967295)===0;)L++;I*32+L<d&&(d=I*32+L)}if(I*32+31>y){let L=31;for(;!(k>>>L);)L--;I*32+L>y&&(y=I*32+L)}}}return y<d||_<m?null:Int32Array.from([d,m,y-d+1,_-m+1])}getTopLeftOnBit(){const r=this.rowSize,a=this.bits;let l=0;for(;l<a.length&&a[l]===0;)l++;if(l===a.length)return null;const u=l/r;let d=l%r*32;const m=a[l];let y=0;for(;(m<<31-y&4294967295)===0;)y++;return d+=y,Int32Array.from([d,u])}getBottomRightOnBit(){const r=this.rowSize,a=this.bits;let l=a.length-1;for(;l>=0&&a[l]===0;)l--;if(l<0)return null;const u=Math.floor(l/r);let d=Math.floor(l%r)*32;const m=a[l];let y=31;for(;!(m>>>y);)y--;return d+=y,Int32Array.from([d,u])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof ot))return!1;const a=r;return this.width===a.width&&this.height===a.height&&this.rowSize===a.rowSize&&ze.equals(this.bits,a.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+ze.hashCode(this.bits),r}toString(r="X ",a="  ",l=`
`){return this.buildToString(r,a,l)}buildToString(r,a,l){let u=new G;for(let d=0,m=this.height;d<m;d++){for(let y=0,_=this.width;y<_;y++)u.append(this.get(y,d)?r:a);u.append(l)}return u.toString()}clone(){return new ot(this.width,this.height,this.rowSize,this.bits.slice())}}class oe extends w{static getNotFoundInstance(){return new oe}}oe.kind="NotFoundException";class le extends ee{constructor(r){super(r),this.luminances=le.EMPTY,this.buckets=new Int32Array(le.LUMINANCE_BUCKETS)}getBlackRow(r,a){const l=this.getLuminanceSource(),u=l.getWidth();a==null||a.getSize()<u?a=new Ge(u):a.clear(),this.initArrays(u);const d=l.getRow(r,this.luminances),m=this.buckets;for(let _=0;_<u;_++)m[(d[_]&255)>>le.LUMINANCE_SHIFT]++;const y=le.estimateBlackPoint(m);if(u<3)for(let _=0;_<u;_++)(d[_]&255)<y&&a.set(_);else{let _=d[0]&255,v=d[1]&255;for(let I=1;I<u-1;I++){const k=d[I+1]&255;(v*4-_-k)/2<y&&a.set(I),_=v,v=k}}return a}getBlackMatrix(){const r=this.getLuminanceSource(),a=r.getWidth(),l=r.getHeight(),u=new ot(a,l);this.initArrays(a);const d=this.buckets;for(let _=1;_<5;_++){const v=Math.floor(l*_/5),I=r.getRow(v,this.luminances),k=Math.floor(a*4/5);for(let L=Math.floor(a/5);L<k;L++){const q=I[L]&255;d[q>>le.LUMINANCE_SHIFT]++}}const m=le.estimateBlackPoint(d),y=r.getMatrix();for(let _=0;_<l;_++){const v=_*a;for(let I=0;I<a;I++)(y[v+I]&255)<m&&u.set(I,_)}return u}createBinarizer(r){return new le(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const a=this.buckets;for(let l=0;l<le.LUMINANCE_BUCKETS;l++)a[l]=0}static estimateBlackPoint(r){const a=r.length;let l=0,u=0,d=0;for(let I=0;I<a;I++)r[I]>d&&(u=I,d=r[I]),r[I]>l&&(l=r[I]);let m=0,y=0;for(let I=0;I<a;I++){const k=I-u,L=r[I]*k*k;L>y&&(m=I,y=L)}if(u>m){const I=u;u=m,m=I}if(m-u<=a/16)throw new oe;let _=m-1,v=-1;for(let I=m-1;I>u;I--){const k=I-u,L=k*k*(m-I)*(l-r[I]);L>v&&(_=I,v=L)}return _<<le.LUMINANCE_SHIFT}}le.LUMINANCE_BITS=5,le.LUMINANCE_SHIFT=8-le.LUMINANCE_BITS,le.LUMINANCE_BUCKETS=1<<le.LUMINANCE_BITS,le.EMPTY=Uint8ClampedArray.from([0]);class xe extends le{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),a=r.getWidth(),l=r.getHeight();if(a>=xe.MINIMUM_DIMENSION&&l>=xe.MINIMUM_DIMENSION){const u=r.getMatrix();let d=a>>xe.BLOCK_SIZE_POWER;(a&xe.BLOCK_SIZE_MASK)!==0&&d++;let m=l>>xe.BLOCK_SIZE_POWER;(l&xe.BLOCK_SIZE_MASK)!==0&&m++;const y=xe.calculateBlackPoints(u,d,m,a,l),_=new ot(a,l);xe.calculateThresholdForBlock(u,d,m,a,l,y,_),this.matrix=_}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new xe(r)}static calculateThresholdForBlock(r,a,l,u,d,m,y){const _=d-xe.BLOCK_SIZE,v=u-xe.BLOCK_SIZE;for(let I=0;I<l;I++){let k=I<<xe.BLOCK_SIZE_POWER;k>_&&(k=_);const L=xe.cap(I,2,l-3);for(let q=0;q<a;q++){let Z=q<<xe.BLOCK_SIZE_POWER;Z>v&&(Z=v);const $=xe.cap(q,2,a-3);let ue=0;for(let Ze=-2;Ze<=2;Ze++){const Ye=m[L+Ze];ue+=Ye[$-2]+Ye[$-1]+Ye[$]+Ye[$+1]+Ye[$+2]}const _e=ue/25;xe.thresholdBlock(r,Z,k,_e,u,y)}}}static cap(r,a,l){return r<a?a:r>l?l:r}static thresholdBlock(r,a,l,u,d,m){for(let y=0,_=l*d+a;y<xe.BLOCK_SIZE;y++,_+=d)for(let v=0;v<xe.BLOCK_SIZE;v++)(r[_+v]&255)<=u&&m.set(a+v,l+y)}static calculateBlackPoints(r,a,l,u,d){const m=d-xe.BLOCK_SIZE,y=u-xe.BLOCK_SIZE,_=new Array(l);for(let v=0;v<l;v++){_[v]=new Int32Array(a);let I=v<<xe.BLOCK_SIZE_POWER;I>m&&(I=m);for(let k=0;k<a;k++){let L=k<<xe.BLOCK_SIZE_POWER;L>y&&(L=y);let q=0,Z=255,$=0;for(let _e=0,Ze=I*u+L;_e<xe.BLOCK_SIZE;_e++,Ze+=u){for(let Ye=0;Ye<xe.BLOCK_SIZE;Ye++){const He=r[Ze+Ye]&255;q+=He,He<Z&&(Z=He),He>$&&($=He)}if($-Z>xe.MIN_DYNAMIC_RANGE)for(_e++,Ze+=u;_e<xe.BLOCK_SIZE;_e++,Ze+=u)for(let Ye=0;Ye<xe.BLOCK_SIZE;Ye++)q+=r[Ze+Ye]&255}let ue=q>>xe.BLOCK_SIZE_POWER*2;if($-Z<=xe.MIN_DYNAMIC_RANGE&&(ue=Z/2,v>0&&k>0)){const _e=(_[v-1][k]+2*_[v][k-1]+_[v-1][k-1])/4;Z<_e&&(ue=_e)}_[v][k]=ue}}return _}}xe.BLOCK_SIZE_POWER=3,xe.BLOCK_SIZE=1<<xe.BLOCK_SIZE_POWER,xe.BLOCK_SIZE_MASK=xe.BLOCK_SIZE-1,xe.MINIMUM_DIMENSION=xe.BLOCK_SIZE*5,xe.MIN_DYNAMIC_RANGE=24;class We{constructor(r,a){this.width=r,this.height=a}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,a,l,u){throw new J("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new J("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new J("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let a=new G;for(let l=0;l<this.height;l++){const u=this.getRow(l,r);for(let d=0;d<this.width;d++){const m=u[d]&255;let y;m<64?y="#":m<128?y="+":m<192?y=".":y=" ",a.append(y)}a.append(`
`)}return a.toString()}}class qe extends We{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,a){const l=this.delegate.getRow(r,a),u=this.getWidth();for(let d=0;d<u;d++)l[d]=255-(l[d]&255);return l}getMatrix(){const r=this.delegate.getMatrix(),a=this.getWidth()*this.getHeight(),l=new Uint8ClampedArray(a);for(let u=0;u<a;u++)l[u]=255-(r[u]&255);return l}isCropSupported(){return this.delegate.isCropSupported()}crop(r,a,l,u){return new qe(this.delegate.crop(r,a,l,u))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new qe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new qe(this.delegate.rotateCounterClockwise45())}}class ut extends We{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=ut.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const a=r.getContext("2d").getImageData(0,0,r.width,r.height);return ut.toGrayscaleBuffer(a.data,r.width,r.height)}static toGrayscaleBuffer(r,a,l){const u=new Uint8ClampedArray(a*l);for(let d=0,m=0,y=r.length;d<y;d+=4,m++){let _;if(r[d+3]===0)_=255;else{const I=r[d],k=r[d+1],L=r[d+2];_=306*I+601*k+117*L+512>>10}u[m]=_}return u}getRow(r,a){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const l=this.getWidth(),u=r*l;return a===null?a=this.buffer.slice(u,u+l):(a.length<l&&(a=new Uint8ClampedArray(l)),a.set(this.buffer.slice(u,u+l))),a}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,a,l,u){return super.crop(r,a,l,u),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const a=this.getTempCanvasElement(),l=a.getContext("2d"),u=r*ut.DEGREE_TO_RADIANS,d=this.canvas.width,m=this.canvas.height,y=Math.ceil(Math.abs(Math.cos(u))*d+Math.abs(Math.sin(u))*m),_=Math.ceil(Math.abs(Math.sin(u))*d+Math.abs(Math.cos(u))*m);return a.width=y,a.height=_,l.translate(y/2,_/2),l.rotate(u),l.drawImage(this.canvas,d/-2,m/-2),this.buffer=ut.makeBufferFromCanvasImageData(a),this}invert(){return new qe(this)}}ut.DEGREE_TO_RADIANS=Math.PI/180;class K{constructor(r,a,l){this.deviceId=r,this.label=a,this.kind="videoinput",this.groupId=l||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var se=(globalThis||$h||self||window||void 0)&&(globalThis||$h||self||window||void 0).__awaiter||function(M,r,a,l){function u(d){return d instanceof a?d:new a(function(m){m(d)})}return new(a||(a=Promise))(function(d,m){function y(I){try{v(l.next(I))}catch(k){m(k)}}function _(I){try{v(l.throw(I))}catch(k){m(k)}}function v(I){I.done?d(I.value):u(I.value).then(y,_)}v((l=l.apply(M,r||[])).next())})};class ve{constructor(r,a=500,l){this.reader=r,this.timeBetweenScansMillis=a,this._hints=l,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return se(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),a=[];for(const l of r){const u=l.kind==="video"?"videoinput":l.kind;if(u!=="videoinput")continue;const d=l.deviceId||l.id,m=l.label||`Video device ${a.length+1}`,y=l.groupId,_={deviceId:d,label:m,kind:u,groupId:y};a.push(_)}return a})}getVideoInputDevices(){return se(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(a=>new K(a.deviceId,a.label))})}findDeviceById(r){return se(this,void 0,void 0,function*(){const a=yield this.listVideoInputDevices();return a?a.find(l=>l.deviceId===r):null})}decodeFromInputVideoDevice(r,a){return se(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,a)})}decodeOnceFromVideoDevice(r,a){return se(this,void 0,void 0,function*(){this.reset();let l;r?l={deviceId:{exact:r}}:l={facingMode:"environment"};const u={video:l};return yield this.decodeOnceFromConstraints(u,a)})}decodeOnceFromConstraints(r,a){return se(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(l,a)})}decodeOnceFromStream(r,a){return se(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(r,a);return yield this.decodeOnce(l)})}decodeFromInputVideoDeviceContinuously(r,a,l){return se(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,a,l)})}decodeFromVideoDevice(r,a,l){return se(this,void 0,void 0,function*(){let u;r?u={deviceId:{exact:r}}:u={facingMode:"environment"};const d={video:u};return yield this.decodeFromConstraints(d,a,l)})}decodeFromConstraints(r,a,l){return se(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(u,a,l)})}decodeFromStream(r,a,l){return se(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(r,a);return yield this.decodeContinuously(u,l)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,a){return se(this,void 0,void 0,function*(){const l=this.prepareVideoElement(a);return this.addVideoSource(l,r),this.videoElement=l,this.stream=r,yield this.playVideoOnLoadAsync(l),l})}playVideoOnLoadAsync(r){return new Promise((a,l)=>this.playVideoOnLoad(r,()=>a()))}playVideoOnLoad(r,a){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",a),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return se(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,a){const l=document.getElementById(r);if(!l)throw new C(`element with id '${r}' not found`);if(l.nodeName.toLowerCase()!==a.toLowerCase())throw new C(`element with id '${r}' must be an ${a} element`);return l}decodeFromImage(r,a){if(!r&&!a)throw new C("either imageElement with a src set or an url must be provided");return a&&!r?this.decodeFromImageUrl(a):this.decodeFromImageElement(r)}decodeFromVideo(r,a){if(!r&&!a)throw new C("Either an element with a src set or an URL must be provided");return a&&!r?this.decodeFromVideoUrl(a):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,a,l){if(r===void 0&&a===void 0)throw new C("Either an element with a src set or an URL must be provided");return a&&!r?this.decodeFromVideoUrlContinuously(a,l):this.decodeFromVideoElementContinuously(r,l)}decodeFromImageElement(r){if(!r)throw new C("An image element must be provided.");this.reset();const a=this.prepareImageElement(r);this.imageElement=a;let l;return this.isImageLoaded(a)?l=this.decodeOnce(a,!1,!0):l=this._decodeOnLoadImage(a),l}decodeFromVideoElement(r){const a=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(a)}decodeFromVideoElementContinuously(r,a){const l=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(l,a)}_decodeFromVideoElementSetup(r){if(!r)throw new C("A video element must be provided.");this.reset();const a=this.prepareVideoElement(r);return this.videoElement=a,a}decodeFromImageUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const a=this.prepareImageElement();this.imageElement=a;const l=this._decodeOnLoadImage(a);return a.src=r,l}decodeFromVideoUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),l=this.decodeFromVideoElement(a);return a.src=r,l}decodeFromVideoUrlContinuously(r,a){if(!r)throw new C("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),u=this.decodeFromVideoElementContinuously(l,a);return l.src=r,u}_decodeOnLoadImage(r){return new Promise((a,l)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(a,l),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return se(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,a){return se(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,a)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let a;return typeof r>"u"&&(a=document.createElement("img"),a.width=200,a.height=200),typeof r=="string"&&(a=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(a=r),a}prepareVideoElement(r){let a;return!r&&typeof document<"u"&&(a=document.createElement("video"),a.width=200,a.height=200),typeof r=="string"&&(a=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(a=r),a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),a.setAttribute("playsinline","true"),a}decodeOnce(r,a=!0,l=!0){this._stopAsyncDecode=!1;const u=(d,m)=>{if(this._stopAsyncDecode){m(new oe("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const y=this.decode(r);d(y)}catch(y){const _=a&&y instanceof oe,I=(y instanceof B||y instanceof F)&&l;if(_||I)return setTimeout(u,this._timeBetweenDecodingAttempts,d,m);m(y)}};return new Promise((d,m)=>u(d,m))}decodeContinuously(r,a){this._stopContinuousDecode=!1;const l=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const u=this.decode(r);a(u,null),setTimeout(l,this.timeBetweenScansMillis)}catch(u){a(null,u);const d=u instanceof B||u instanceof F,m=u instanceof oe;(d||m)&&setTimeout(l,this._timeBetweenDecodingAttempts)}};l()}decode(r){const a=this.createBinaryBitmap(r);return this.decodeBitmap(a)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,a,l){a||(a={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),l||(l=this.captureCanvasContext),l.drawImage(r,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}drawImageOnCanvas(r,a,l=this.captureCanvasContext){a||(a={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),l||(l=this.captureCanvasContext),l.drawImage(r,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const a=this.getCaptureCanvas(r),l=new ut(a),u=new xe(l);return new P(u)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const l=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=l}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const a=this.createCaptureCanvas(r);this.captureCanvas=a}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const a=document.createElement("canvas");let l,u;return typeof r<"u"&&(r instanceof HTMLVideoElement?(l=r.videoWidth,u=r.videoHeight):r instanceof HTMLImageElement&&(l=r.naturalWidth||r.width,u=r.naturalHeight||r.height)),a.style.width=l+"px",a.style.height=u+"px",a.width=l,a.height=u,a}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,a){try{r.srcObject=a}catch{r.src=URL.createObjectURL(a)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class Ce{constructor(r,a,l=a==null?0:8*a.length,u,d,m=ne.currentTimeMillis()){this.text=r,this.rawBytes=a,this.numBits=l,this.resultPoints=u,this.format=d,this.timestamp=m,this.text=r,this.rawBytes=a,l==null?this.numBits=a==null?0:8*a.length:this.numBits=l,this.resultPoints=u,this.format=d,this.resultMetadata=null,m==null?this.timestamp=ne.currentTimeMillis():this.timestamp=m}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,a){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,a)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const a=this.resultPoints;if(a===null)this.resultPoints=r;else if(r!==null&&r.length>0){const l=new Array(a.length+r.length);ne.arraycopy(a,0,l,0,a.length),ne.arraycopy(r,0,l,a.length,r.length),this.resultPoints=l}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Le;(function(M){M[M.AZTEC=0]="AZTEC",M[M.CODABAR=1]="CODABAR",M[M.CODE_39=2]="CODE_39",M[M.CODE_93=3]="CODE_93",M[M.CODE_128=4]="CODE_128",M[M.DATA_MATRIX=5]="DATA_MATRIX",M[M.EAN_8=6]="EAN_8",M[M.EAN_13=7]="EAN_13",M[M.ITF=8]="ITF",M[M.MAXICODE=9]="MAXICODE",M[M.PDF_417=10]="PDF_417",M[M.QR_CODE=11]="QR_CODE",M[M.RSS_14=12]="RSS_14",M[M.RSS_EXPANDED=13]="RSS_EXPANDED",M[M.UPC_A=14]="UPC_A",M[M.UPC_E=15]="UPC_E",M[M.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Le||(Le={}));var me=Le,rt;(function(M){M[M.OTHER=0]="OTHER",M[M.ORIENTATION=1]="ORIENTATION",M[M.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",M[M.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",M[M.ISSUE_NUMBER=4]="ISSUE_NUMBER",M[M.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",M[M.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",M[M.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",M[M.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",M[M.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",M[M.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(rt||(rt={}));var mt=rt;class Ct{constructor(r,a,l,u,d=-1,m=-1){this.rawBytes=r,this.text=a,this.byteSegments=l,this.ecLevel=u,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=m,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class sn{exp(r){return this.expTable[r]}log(r){if(r===0)throw new N;return this.logTable[r]}static addOrSubtract(r,a){return r^a}}class Qt{constructor(r,a){if(a.length===0)throw new N;this.field=r;const l=a.length;if(l>1&&a[0]===0){let u=1;for(;u<l&&a[u]===0;)u++;u===l?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(l-u),ne.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const a=this.coefficients;let l;if(r===1){l=0;for(let m=0,y=a.length;m!==y;m++){const _=a[m];l=sn.addOrSubtract(l,_)}return l}l=a[0];const u=a.length,d=this.field;for(let m=1;m<u;m++)l=sn.addOrSubtract(d.multiply(r,l),a[m]);return l}addOrSubtract(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let a=this.coefficients,l=r.coefficients;if(a.length>l.length){const m=a;a=l,l=m}let u=new Int32Array(l.length);const d=l.length-a.length;ne.arraycopy(l,0,u,0,d);for(let m=d;m<l.length;m++)u[m]=sn.addOrSubtract(a[m-d],l[m]);return new Qt(this.field,u)}multiply(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const a=this.coefficients,l=a.length,u=r.coefficients,d=u.length,m=new Int32Array(l+d-1),y=this.field;for(let _=0;_<l;_++){const v=a[_];for(let I=0;I<d;I++)m[_+I]=sn.addOrSubtract(m[_+I],y.multiply(v,u[I]))}return new Qt(y,m)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const a=this.coefficients.length,l=this.field,u=new Int32Array(a),d=this.coefficients;for(let m=0;m<a;m++)u[m]=l.multiply(d[m],r);return new Qt(l,u)}multiplyByMonomial(r,a){if(r<0)throw new N;if(a===0)return this.field.getZero();const l=this.coefficients,u=l.length,d=new Int32Array(u+r),m=this.field;for(let y=0;y<u;y++)d[y]=m.multiply(l[y],a);return new Qt(m,d)}divide(r){if(!this.field.equals(r.field))throw new N("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new N("Divide by 0");const a=this.field;let l=a.getZero(),u=this;const d=r.getCoefficient(r.getDegree()),m=a.inverse(d);for(;u.getDegree()>=r.getDegree()&&!u.isZero();){const y=u.getDegree()-r.getDegree(),_=a.multiply(u.getCoefficient(u.getDegree()),m),v=r.multiplyByMonomial(y,_),I=a.buildMonomial(y,_);l=l.addOrSubtract(I),u=u.addOrSubtract(v)}return[l,u]}toString(){let r="";for(let a=this.getDegree();a>=0;a--){let l=this.getCoefficient(a);if(l!==0){if(l<0?(r+=" - ",l=-l):r.length>0&&(r+=" + "),a===0||l!==1){const u=this.field.log(l);u===0?r+="1":u===1?r+="a":(r+="a^",r+=u)}a!==0&&(a===1?r+="x":(r+="x^",r+=a))}}return r}}class En extends w{}En.kind="ArithmeticException";class Ot extends sn{constructor(r,a,l){super(),this.primitive=r,this.size=a,this.generatorBase=l;const u=new Int32Array(a);let d=1;for(let y=0;y<a;y++)u[y]=d,d*=2,d>=a&&(d^=r,d&=a-1);this.expTable=u;const m=new Int32Array(a);for(let y=0;y<a-1;y++)m[u[y]]=y;this.logTable=m,this.zero=new Qt(this,Int32Array.from([0])),this.one=new Qt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,a){if(r<0)throw new N;if(a===0)return this.zero;const l=new Int32Array(r+1);return l[0]=a,new Qt(this,l)}inverse(r){if(r===0)throw new En;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,a){return r===0||a===0?0:this.expTable[(this.logTable[r]+this.logTable[a])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+fe.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}Ot.AZTEC_DATA_12=new Ot(4201,4096,1),Ot.AZTEC_DATA_10=new Ot(1033,1024,1),Ot.AZTEC_DATA_6=new Ot(67,64,1),Ot.AZTEC_PARAM=new Ot(19,16,1),Ot.QR_CODE_FIELD_256=new Ot(285,256,0),Ot.DATA_MATRIX_FIELD_256=new Ot(301,256,1),Ot.AZTEC_DATA_8=Ot.DATA_MATRIX_FIELD_256,Ot.MAXICODE_FIELD_64=Ot.AZTEC_DATA_6;class gn extends w{}gn.kind="ReedSolomonException";class On extends w{}On.kind="IllegalStateException";class Me{constructor(r){this.field=r}decode(r,a){const l=this.field,u=new Qt(l,r),d=new Int32Array(a);let m=!0;for(let q=0;q<a;q++){const Z=u.evaluateAt(l.exp(q+l.getGeneratorBase()));d[d.length-1-q]=Z,Z!==0&&(m=!1)}if(m)return;const y=new Qt(l,d),_=this.runEuclideanAlgorithm(l.buildMonomial(a,1),y,a),v=_[0],I=_[1],k=this.findErrorLocations(v),L=this.findErrorMagnitudes(I,k);for(let q=0;q<k.length;q++){const Z=r.length-1-l.log(k[q]);if(Z<0)throw new gn("Bad error location");r[Z]=Ot.addOrSubtract(r[Z],L[q])}}runEuclideanAlgorithm(r,a,l){if(r.getDegree()<a.getDegree()){const q=r;r=a,a=q}const u=this.field;let d=r,m=a,y=u.getZero(),_=u.getOne();for(;m.getDegree()>=(l/2|0);){let q=d,Z=y;if(d=m,y=_,d.isZero())throw new gn("r_{i-1} was zero");m=q;let $=u.getZero();const ue=d.getCoefficient(d.getDegree()),_e=u.inverse(ue);for(;m.getDegree()>=d.getDegree()&&!m.isZero();){const Ze=m.getDegree()-d.getDegree(),Ye=u.multiply(m.getCoefficient(m.getDegree()),_e);$=$.addOrSubtract(u.buildMonomial(Ze,Ye)),m=m.addOrSubtract(d.multiplyByMonomial(Ze,Ye))}if(_=$.multiply(y).addOrSubtract(Z),m.getDegree()>=d.getDegree())throw new On("Division algorithm failed to reduce polynomial?")}const v=_.getCoefficient(0);if(v===0)throw new gn("sigmaTilde(0) was zero");const I=u.inverse(v),k=_.multiplyScalar(I),L=m.multiplyScalar(I);return[k,L]}findErrorLocations(r){const a=r.getDegree();if(a===1)return Int32Array.from([r.getCoefficient(1)]);const l=new Int32Array(a);let u=0;const d=this.field;for(let m=1;m<d.getSize()&&u<a;m++)r.evaluateAt(m)===0&&(l[u]=d.inverse(m),u++);if(u!==a)throw new gn("Error locator degree does not match number of roots");return l}findErrorMagnitudes(r,a){const l=a.length,u=new Int32Array(l),d=this.field;for(let m=0;m<l;m++){const y=d.inverse(a[m]);let _=1;for(let v=0;v<l;v++)if(m!==v){const I=d.multiply(a[v],y),k=(I&1)===0?I|1:I&-2;_=d.multiply(_,k)}u[m]=d.multiply(r.evaluateAt(y),d.inverse(_)),d.getGeneratorBase()!==0&&(u[m]=d.multiply(u[m],y))}return u}}var ge;(function(M){M[M.UPPER=0]="UPPER",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.DIGIT=3]="DIGIT",M[M.PUNCT=4]="PUNCT",M[M.BINARY=5]="BINARY"})(ge||(ge={}));class Ne{decode(r){this.ddata=r;let a=r.getBits(),l=this.extractBits(a),u=this.correctBits(l),d=Ne.convertBoolArrayToByteArray(u),m=Ne.getEncodedData(u),y=new Ct(d,m,null,null);return y.setNumBits(u.length),y}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let a=r.length,l=ge.UPPER,u=ge.UPPER,d="",m=0;for(;m<a;)if(u===ge.BINARY){if(a-m<5)break;let y=Ne.readCode(r,m,5);if(m+=5,y===0){if(a-m<11)break;y=Ne.readCode(r,m,11)+31,m+=11}for(let _=0;_<y;_++){if(a-m<8){m=a;break}const v=Ne.readCode(r,m,8);d+=Y.castAsNonUtf8Char(v),m+=8}u=l}else{let y=u===ge.DIGIT?4:5;if(a-m<y)break;let _=Ne.readCode(r,m,y);m+=y;let v=Ne.getCharacter(u,_);v.startsWith("CTRL_")?(l=u,u=Ne.getTable(v.charAt(5)),v.charAt(6)==="L"&&(l=u)):(d+=v,u=l)}return d}static getTable(r){switch(r){case"L":return ge.LOWER;case"P":return ge.PUNCT;case"M":return ge.MIXED;case"D":return ge.DIGIT;case"B":return ge.BINARY;case"U":default:return ge.UPPER}}static getCharacter(r,a){switch(r){case ge.UPPER:return Ne.UPPER_TABLE[a];case ge.LOWER:return Ne.LOWER_TABLE[a];case ge.MIXED:return Ne.MIXED_TABLE[a];case ge.PUNCT:return Ne.PUNCT_TABLE[a];case ge.DIGIT:return Ne.DIGIT_TABLE[a];default:throw new On("Bad table")}}correctBits(r){let a,l;this.ddata.getNbLayers()<=2?(l=6,a=Ot.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(l=8,a=Ot.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(l=10,a=Ot.AZTEC_DATA_10):(l=12,a=Ot.AZTEC_DATA_12);let u=this.ddata.getNbDatablocks(),d=r.length/l;if(d<u)throw new F;let m=r.length%l,y=new Int32Array(d);for(let L=0;L<d;L++,m+=l)y[L]=Ne.readCode(r,m,l);try{new Me(a).decode(y,d-u)}catch(L){throw new F(L)}let _=(1<<l)-1,v=0;for(let L=0;L<u;L++){let q=y[L];if(q===0||q===_)throw new F;(q===1||q===_-1)&&v++}let I=new Array(u*l-v),k=0;for(let L=0;L<u;L++){let q=y[L];if(q===1||q===_-1)I.fill(q>1,k,k+l-1),k+=l-1;else for(let Z=l-1;Z>=0;--Z)I[k++]=(q&1<<Z)!==0}return I}extractBits(r){let a=this.ddata.isCompact(),l=this.ddata.getNbLayers(),u=(a?11:14)+l*4,d=new Int32Array(u),m=new Array(this.totalBitsInLayer(l,a));if(a)for(let y=0;y<d.length;y++)d[y]=y;else{let y=u+1+2*fe.truncDivision(fe.truncDivision(u,2)-1,15),_=u/2,v=fe.truncDivision(y,2);for(let I=0;I<_;I++){let k=I+fe.truncDivision(I,15);d[_-I-1]=v-k-1,d[_+I]=v+k+1}}for(let y=0,_=0;y<l;y++){let v=(l-y)*4+(a?9:12),I=y*2,k=u-1-I;for(let L=0;L<v;L++){let q=L*2;for(let Z=0;Z<2;Z++)m[_+q+Z]=r.get(d[I+Z],d[I+L]),m[_+2*v+q+Z]=r.get(d[I+L],d[k-Z]),m[_+4*v+q+Z]=r.get(d[k-Z],d[k-L]),m[_+6*v+q+Z]=r.get(d[k-L],d[I+Z])}_+=v*8}return m}static readCode(r,a,l){let u=0;for(let d=a;d<a+l;d++)u<<=1,r[d]&&(u|=1);return u}static readByte(r,a){let l=r.length-a;return l>=8?Ne.readCode(r,a,8):Ne.readCode(r,a,l)<<8-l}static convertBoolArrayToByteArray(r){let a=new Uint8Array((r.length+7)/8);for(let l=0;l<a.length;l++)a[l]=Ne.readByte(r,8*l);return a}totalBitsInLayer(r,a){return((a?88:112)+16*r)*r}}Ne.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Ne.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Ne.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Ne.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Ne.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Ve{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,a,l,u){const d=r-l,m=a-u;return Math.sqrt(d*d+m*m)}static sum(r){let a=0;for(let l=0,u=r.length;l!==u;l++){const d=r[l];a+=d}return a}}class it{static floatToIntBits(r){return r}}it.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ie{constructor(r,a){this.x=r,this.y=a}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof Ie){const a=r;return this.x===a.x&&this.y===a.y}return!1}hashCode(){return 31*it.floatToIntBits(this.x)+it.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const a=this.distance(r[0],r[1]),l=this.distance(r[1],r[2]),u=this.distance(r[0],r[2]);let d,m,y;if(l>=a&&l>=u?(m=r[0],d=r[1],y=r[2]):u>=l&&u>=a?(m=r[1],d=r[0],y=r[2]):(m=r[2],d=r[0],y=r[1]),this.crossProductZ(d,m,y)<0){const _=d;d=y,y=_}r[0]=d,r[1]=m,r[2]=y}static distance(r,a){return Ve.distance(r.x,r.y,a.x,a.y)}static crossProductZ(r,a,l){const u=a.x,d=a.y;return(l.x-u)*(r.y-d)-(l.y-d)*(r.x-u)}}class Pt{constructor(r,a){this.bits=r,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class et extends Pt{constructor(r,a,l,u,d){super(r,a),this.compact=l,this.nbDatablocks=u,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ht{constructor(r,a,l,u){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),a==null&&(a=ht.INIT_SIZE),l==null&&(l=r.getWidth()/2|0),u==null&&(u=r.getHeight()/2|0);const d=a/2|0;if(this.leftInit=l-d,this.rightInit=l+d,this.upInit=u-d,this.downInit=u+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new oe}detect(){let r=this.leftInit,a=this.rightInit,l=this.upInit,u=this.downInit,d=!1,m=!0,y=!1,_=!1,v=!1,I=!1,k=!1;const L=this.width,q=this.height;for(;m;){m=!1;let Z=!0;for(;(Z||!_)&&a<L;)Z=this.containsBlackPoint(l,u,a,!1),Z?(a++,m=!0,_=!0):_||a++;if(a>=L){d=!0;break}let $=!0;for(;($||!v)&&u<q;)$=this.containsBlackPoint(r,a,u,!0),$?(u++,m=!0,v=!0):v||u++;if(u>=q){d=!0;break}let ue=!0;for(;(ue||!I)&&r>=0;)ue=this.containsBlackPoint(l,u,r,!1),ue?(r--,m=!0,I=!0):I||r--;if(r<0){d=!0;break}let _e=!0;for(;(_e||!k)&&l>=0;)_e=this.containsBlackPoint(r,a,l,!0),_e?(l--,m=!0,k=!0):k||l--;if(l<0){d=!0;break}m&&(y=!0)}if(!d&&y){const Z=a-r;let $=null;for(let Ye=1;$===null&&Ye<Z;Ye++)$=this.getBlackPointOnSegment(r,u-Ye,r+Ye,u);if($==null)throw new oe;let ue=null;for(let Ye=1;ue===null&&Ye<Z;Ye++)ue=this.getBlackPointOnSegment(r,l+Ye,r+Ye,l);if(ue==null)throw new oe;let _e=null;for(let Ye=1;_e===null&&Ye<Z;Ye++)_e=this.getBlackPointOnSegment(a,l+Ye,a-Ye,l);if(_e==null)throw new oe;let Ze=null;for(let Ye=1;Ze===null&&Ye<Z;Ye++)Ze=this.getBlackPointOnSegment(a,u-Ye,a-Ye,u);if(Ze==null)throw new oe;return this.centerEdges(Ze,$,_e,ue)}else throw new oe}getBlackPointOnSegment(r,a,l,u){const d=Ve.round(Ve.distance(r,a,l,u)),m=(l-r)/d,y=(u-a)/d,_=this.image;for(let v=0;v<d;v++){const I=Ve.round(r+v*m),k=Ve.round(a+v*y);if(_.get(I,k))return new Ie(I,k)}return null}centerEdges(r,a,l,u){const d=r.getX(),m=r.getY(),y=a.getX(),_=a.getY(),v=l.getX(),I=l.getY(),k=u.getX(),L=u.getY(),q=ht.CORR;return d<this.width/2?[new Ie(k-q,L+q),new Ie(y+q,_+q),new Ie(v-q,I-q),new Ie(d+q,m-q)]:[new Ie(k+q,L+q),new Ie(y+q,_-q),new Ie(v-q,I+q),new Ie(d-q,m-q)]}containsBlackPoint(r,a,l,u){const d=this.image;if(u){for(let m=r;m<=a;m++)if(d.get(m,l))return!0}else for(let m=r;m<=a;m++)if(d.get(l,m))return!0;return!1}}ht.INIT_SIZE=10,ht.CORR=1;class Un{static checkAndNudgePoints(r,a){const l=r.getWidth(),u=r.getHeight();let d=!0;for(let m=0;m<a.length&&d;m+=2){const y=Math.floor(a[m]),_=Math.floor(a[m+1]);if(y<-1||y>l||_<-1||_>u)throw new oe;d=!1,y===-1?(a[m]=0,d=!0):y===l&&(a[m]=l-1,d=!0),_===-1?(a[m+1]=0,d=!0):_===u&&(a[m+1]=u-1,d=!0)}d=!0;for(let m=a.length-2;m>=0&&d;m-=2){const y=Math.floor(a[m]),_=Math.floor(a[m+1]);if(y<-1||y>l||_<-1||_>u)throw new oe;d=!1,y===-1?(a[m]=0,d=!0):y===l&&(a[m]=l-1,d=!0),_===-1?(a[m+1]=0,d=!0):_===u&&(a[m+1]=u-1,d=!0)}}}class Bt{constructor(r,a,l,u,d,m,y,_,v){this.a11=r,this.a21=a,this.a31=l,this.a12=u,this.a22=d,this.a32=m,this.a13=y,this.a23=_,this.a33=v}static quadrilateralToQuadrilateral(r,a,l,u,d,m,y,_,v,I,k,L,q,Z,$,ue){const _e=Bt.quadrilateralToSquare(r,a,l,u,d,m,y,_);return Bt.squareToQuadrilateral(v,I,k,L,q,Z,$,ue).times(_e)}transformPoints(r){const a=r.length,l=this.a11,u=this.a12,d=this.a13,m=this.a21,y=this.a22,_=this.a23,v=this.a31,I=this.a32,k=this.a33;for(let L=0;L<a;L+=2){const q=r[L],Z=r[L+1],$=d*q+_*Z+k;r[L]=(l*q+m*Z+v)/$,r[L+1]=(u*q+y*Z+I)/$}}transformPointsWithValues(r,a){const l=this.a11,u=this.a12,d=this.a13,m=this.a21,y=this.a22,_=this.a23,v=this.a31,I=this.a32,k=this.a33,L=r.length;for(let q=0;q<L;q++){const Z=r[q],$=a[q],ue=d*Z+_*$+k;r[q]=(l*Z+m*$+v)/ue,a[q]=(u*Z+y*$+I)/ue}}static squareToQuadrilateral(r,a,l,u,d,m,y,_){const v=r-l+d-y,I=a-u+m-_;if(v===0&&I===0)return new Bt(l-r,d-l,r,u-a,m-u,a,0,0,1);{const k=l-d,L=y-d,q=u-m,Z=_-m,$=k*Z-L*q,ue=(v*Z-L*I)/$,_e=(k*I-v*q)/$;return new Bt(l-r+ue*l,y-r+_e*y,r,u-a+ue*u,_-a+_e*_,a,ue,_e,1)}}static quadrilateralToSquare(r,a,l,u,d,m,y,_){return Bt.squareToQuadrilateral(r,a,l,u,d,m,y,_).buildAdjoint()}buildAdjoint(){return new Bt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new Bt(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class Kn extends Un{sampleGrid(r,a,l,u,d,m,y,_,v,I,k,L,q,Z,$,ue,_e,Ze,Ye){const He=Bt.quadrilateralToQuadrilateral(u,d,m,y,_,v,I,k,L,q,Z,$,ue,_e,Ze,Ye);return this.sampleGridWithTransform(r,a,l,He)}sampleGridWithTransform(r,a,l,u){if(a<=0||l<=0)throw new oe;const d=new ot(a,l),m=new Float32Array(2*a);for(let y=0;y<l;y++){const _=m.length,v=y+.5;for(let I=0;I<_;I+=2)m[I]=I/2+.5,m[I+1]=v;u.transformPoints(m),Un.checkAndNudgePoints(r,m);try{for(let I=0;I<_;I+=2)r.get(Math.floor(m[I]),Math.floor(m[I+1]))&&d.set(I/2,y)}catch{throw new oe}}return d}}class lr{static setGridSampler(r){lr.gridSampler=r}static getInstance(){return lr.gridSampler}}lr.gridSampler=new Kn;class cr{constructor(r,a){this.x=r,this.y=a}toResultPoint(){return new Ie(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Zr{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let a=this.getMatrixCenter(),l=this.getBullsEyeCorners(a);if(r){let m=l[0];l[0]=l[2],l[2]=m}this.extractParameters(l);let u=this.sampleGrid(this.image,l[this.shift%4],l[(this.shift+1)%4],l[(this.shift+2)%4],l[(this.shift+3)%4]),d=this.getMatrixCornerPoints(l);return new et(u,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new oe;let a=2*this.nbCenterLayers,l=new Int32Array([this.sampleLine(r[0],r[1],a),this.sampleLine(r[1],r[2],a),this.sampleLine(r[2],r[3],a),this.sampleLine(r[3],r[0],a)]);this.shift=this.getRotation(l,a);let u=0;for(let m=0;m<4;m++){let y=l[(this.shift+m)%4];this.compact?(u<<=7,u+=y>>1&127):(u<<=10,u+=(y>>2&992)+(y>>1&31))}let d=this.getCorrectedParameterData(u,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(r,a){let l=0;r.forEach((u,d,m)=>{let y=(u>>a-2<<1)+(u&1);l=(l<<3)+y}),l=((l&1)<<11)+(l>>1);for(let u=0;u<4;u++)if(fe.bitCount(l^this.EXPECTED_CORNER_BITS[u])<=2)return u;throw new oe}getCorrectedParameterData(r,a){let l,u;a?(l=7,u=2):(l=10,u=4);let d=l-u,m=new Int32Array(l);for(let _=l-1;_>=0;--_)m[_]=r&15,r>>=4;try{new Me(Ot.AZTEC_PARAM).decode(m,d)}catch{throw new oe}let y=0;for(let _=0;_<u;_++)y=(y<<4)+m[_];return y}getBullsEyeCorners(r){let a=r,l=r,u=r,d=r,m=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let k=this.getFirstDifferent(a,m,1,-1),L=this.getFirstDifferent(l,m,1,1),q=this.getFirstDifferent(u,m,-1,1),Z=this.getFirstDifferent(d,m,-1,-1);if(this.nbCenterLayers>2){let $=this.distancePoint(Z,k)*this.nbCenterLayers/(this.distancePoint(d,a)*(this.nbCenterLayers+2));if($<.75||$>1.25||!this.isWhiteOrBlackRectangle(k,L,q,Z))break}a=k,l=L,u=q,d=Z,m=!m}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new oe;this.compact=this.nbCenterLayers===5;let y=new Ie(a.getX()+.5,a.getY()-.5),_=new Ie(l.getX()+.5,l.getY()+.5),v=new Ie(u.getX()-.5,u.getY()+.5),I=new Ie(d.getX()-.5,d.getY()-.5);return this.expandSquare([y,_,v,I],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,a,l,u;try{let y=new ht(this.image).detect();r=y[0],a=y[1],l=y[2],u=y[3]}catch{let _=this.image.getWidth()/2,v=this.image.getHeight()/2;r=this.getFirstDifferent(new cr(_+7,v-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new cr(_+7,v+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new cr(_-7,v+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new cr(_-7,v-7),!1,-1,-1).toResultPoint()}let d=Ve.round((r.getX()+u.getX()+a.getX()+l.getX())/4),m=Ve.round((r.getY()+u.getY()+a.getY()+l.getY())/4);try{let y=new ht(this.image,15,d,m).detect();r=y[0],a=y[1],l=y[2],u=y[3]}catch{r=this.getFirstDifferent(new cr(d+7,m-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new cr(d+7,m+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new cr(d-7,m+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new cr(d-7,m-7),!1,-1,-1).toResultPoint()}return d=Ve.round((r.getX()+u.getX()+a.getX()+l.getX())/4),m=Ve.round((r.getY()+u.getY()+a.getY()+l.getY())/4),new cr(d,m)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,a,l,u,d){let m=lr.getInstance(),y=this.getDimension(),_=y/2-this.nbCenterLayers,v=y/2+this.nbCenterLayers;return m.sampleGrid(r,y,y,_,_,v,_,v,v,_,v,a.getX(),a.getY(),l.getX(),l.getY(),u.getX(),u.getY(),d.getX(),d.getY())}sampleLine(r,a,l){let u=0,d=this.distanceResultPoint(r,a),m=d/l,y=r.getX(),_=r.getY(),v=m*(a.getX()-r.getX())/d,I=m*(a.getY()-r.getY())/d;for(let k=0;k<l;k++)this.image.get(Ve.round(y+k*v),Ve.round(_+k*I))&&(u|=1<<l-k-1);return u}isWhiteOrBlackRectangle(r,a,l,u){let d=3;r=new cr(r.getX()-d,r.getY()+d),a=new cr(a.getX()-d,a.getY()-d),l=new cr(l.getX()+d,l.getY()-d),u=new cr(u.getX()+d,u.getY()+d);let m=this.getColor(u,r);if(m===0)return!1;let y=this.getColor(r,a);return y!==m||(y=this.getColor(a,l),y!==m)?!1:(y=this.getColor(l,u),y===m)}getColor(r,a){let l=this.distancePoint(r,a),u=(a.getX()-r.getX())/l,d=(a.getY()-r.getY())/l,m=0,y=r.getX(),_=r.getY(),v=this.image.get(r.getX(),r.getY()),I=Math.ceil(l);for(let L=0;L<I;L++)y+=u,_+=d,this.image.get(Ve.round(y),Ve.round(_))!==v&&m++;let k=m/l;return k>.1&&k<.9?0:k<=.1===v?1:-1}getFirstDifferent(r,a,l,u){let d=r.getX()+l,m=r.getY()+u;for(;this.isValid(d,m)&&this.image.get(d,m)===a;)d+=l,m+=u;for(d-=l,m-=u;this.isValid(d,m)&&this.image.get(d,m)===a;)d+=l;for(d-=l;this.isValid(d,m)&&this.image.get(d,m)===a;)m+=u;return m-=u,new cr(d,m)}expandSquare(r,a,l){let u=l/(2*a),d=r[0].getX()-r[2].getX(),m=r[0].getY()-r[2].getY(),y=(r[0].getX()+r[2].getX())/2,_=(r[0].getY()+r[2].getY())/2,v=new Ie(y+u*d,_+u*m),I=new Ie(y-u*d,_-u*m);d=r[1].getX()-r[3].getX(),m=r[1].getY()-r[3].getY(),y=(r[1].getX()+r[3].getX())/2,_=(r[1].getY()+r[3].getY())/2;let k=new Ie(y+u*d,_+u*m),L=new Ie(y-u*d,_-u*m);return[v,k,I,L]}isValid(r,a){return r>=0&&r<this.image.getWidth()&&a>0&&a<this.image.getHeight()}isValidPoint(r){let a=Ve.round(r.getX()),l=Ve.round(r.getY());return this.isValid(a,l)}distancePoint(r,a){return Ve.distance(r.getX(),r.getY(),a.getX(),a.getY())}distanceResultPoint(r,a){return Ve.distance(r.getX(),r.getY(),a.getX(),a.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(fe.truncDivision(this.nbLayers-4,8)+1)+15}}class Ti{decode(r,a=null){let l=null,u=new Zr(r.getBlackMatrix()),d=null,m=null;try{let I=u.detectMirror(!1);d=I.getPoints(),this.reportFoundResultPoints(a,d),m=new Ne().decode(I)}catch(I){l=I}if(m==null)try{let I=u.detectMirror(!0);d=I.getPoints(),this.reportFoundResultPoints(a,d),m=new Ne().decode(I)}catch(I){throw l??I}let y=new Ce(m.getText(),m.getRawBytes(),m.getNumBits(),d,me.AZTEC,ne.currentTimeMillis()),_=m.getByteSegments();_!=null&&y.putMetadata(mt.BYTE_SEGMENTS,_);let v=m.getECLevel();return v!=null&&y.putMetadata(mt.ERROR_CORRECTION_LEVEL,v),y}reportFoundResultPoints(r,a){if(r!=null){let l=r.get(Qe.NEED_RESULT_POINT_CALLBACK);l!=null&&a.forEach((u,d,m)=>{l.foundPossibleResultPoint(u)})}}reset(){}}class ki extends ve{constructor(r=500){super(new Ti,r)}}class tn{decode(r,a){try{return this.doDecode(r,a)}catch{if(a&&a.get(Qe.TRY_HARDER)===!0&&r.isRotateSupported()){const d=r.rotateCounterClockwise(),m=this.doDecode(d,a),y=m.getResultMetadata();let _=270;y!==null&&y.get(mt.ORIENTATION)===!0&&(_=_+y.get(mt.ORIENTATION)%360),m.putMetadata(mt.ORIENTATION,_);const v=m.getResultPoints();if(v!==null){const I=d.getHeight();for(let k=0;k<v.length;k++)v[k]=new Ie(I-v[k].getY()-1,v[k].getX())}return m}else throw new oe}}reset(){}doDecode(r,a){const l=r.getWidth(),u=r.getHeight();let d=new Ge(l);const m=a&&a.get(Qe.TRY_HARDER)===!0,y=Math.max(1,u>>(m?8:5));let _;m?_=u:_=15;const v=Math.trunc(u/2);for(let I=0;I<_;I++){const k=Math.trunc((I+1)/2),L=(I&1)===0,q=v+y*(L?k:-k);if(q<0||q>=u)break;try{d=r.getBlackRow(q,d)}catch{continue}for(let Z=0;Z<2;Z++){if(Z===1&&(d.reverse(),a&&a.get(Qe.NEED_RESULT_POINT_CALLBACK)===!0)){const $=new Map;a.forEach((ue,_e)=>$.set(_e,ue)),$.delete(Qe.NEED_RESULT_POINT_CALLBACK),a=$}try{const $=this.decodeRow(q,d,a);if(Z===1){$.putMetadata(mt.ORIENTATION,180);const ue=$.getResultPoints();ue!==null&&(ue[0]=new Ie(l-ue[0].getX()-1,ue[0].getY()),ue[1]=new Ie(l-ue[1].getX()-1,ue[1].getY()))}return $}catch{}}}throw new oe}static recordPattern(r,a,l){const u=l.length;for(let v=0;v<u;v++)l[v]=0;const d=r.getSize();if(a>=d)throw new oe;let m=!r.get(a),y=0,_=a;for(;_<d;){if(r.get(_)!==m)l[y]++;else{if(++y===u)break;l[y]=1,m=!m}_++}if(!(y===u||y===u-1&&_===d))throw new oe}static recordPatternInReverse(r,a,l){let u=l.length,d=r.get(a);for(;a>0&&u>=0;)r.get(--a)!==d&&(u--,d=!d);if(u>=0)throw new oe;tn.recordPattern(r,a+1,l)}static patternMatchVariance(r,a,l){const u=r.length;let d=0,m=0;for(let v=0;v<u;v++)d+=r[v],m+=a[v];if(d<m)return Number.POSITIVE_INFINITY;const y=d/m;l*=y;let _=0;for(let v=0;v<u;v++){const I=r[v],k=a[v]*y,L=I>k?I-k:k-I;if(L>l)return Number.POSITIVE_INFINITY;_+=L}return _/d}}class Fe extends tn{static findStartPattern(r){const a=r.getSize(),l=r.getNextSet(0);let u=0,d=Int32Array.from([0,0,0,0,0,0]),m=l,y=!1;const _=6;for(let v=l;v<a;v++)if(r.get(v)!==y)d[u]++;else{if(u===_-1){let I=Fe.MAX_AVG_VARIANCE,k=-1;for(let L=Fe.CODE_START_A;L<=Fe.CODE_START_C;L++){const q=tn.patternMatchVariance(d,Fe.CODE_PATTERNS[L],Fe.MAX_INDIVIDUAL_VARIANCE);q<I&&(I=q,k=L)}if(k>=0&&r.isRange(Math.max(0,m-(v-m)/2),m,!1))return Int32Array.from([m,v,k]);m+=d[0]+d[1],d=d.slice(2,d.length-1),d[u-1]=0,d[u]=0,u--}else u++;d[u]=1,y=!y}throw new oe}static decodeCode(r,a,l){tn.recordPattern(r,l,a);let u=Fe.MAX_AVG_VARIANCE,d=-1;for(let m=0;m<Fe.CODE_PATTERNS.length;m++){const y=Fe.CODE_PATTERNS[m],_=this.patternMatchVariance(a,y,Fe.MAX_INDIVIDUAL_VARIANCE);_<u&&(u=_,d=m)}if(d>=0)return d;throw new oe}decodeRow(r,a,l){const u=l&&l.get(Qe.ASSUME_GS1)===!0,d=Fe.findStartPattern(a),m=d[2];let y=0;const _=new Uint8Array(20);_[y++]=m;let v;switch(m){case Fe.CODE_START_A:v=Fe.CODE_CODE_A;break;case Fe.CODE_START_B:v=Fe.CODE_CODE_B;break;case Fe.CODE_START_C:v=Fe.CODE_CODE_C;break;default:throw new F}let I=!1,k=!1,L="",q=d[0],Z=d[1];const $=Int32Array.from([0,0,0,0,0,0]);let ue=0,_e=0,Ze=m,Ye=0,He=!0,cn=!1,Wt=!1;for(;!I;){const ga=k;switch(k=!1,ue=_e,_e=Fe.decodeCode(a,$,Z),_[y++]=_e,_e!==Fe.CODE_STOP&&(He=!0),_e!==Fe.CODE_STOP&&(Ye++,Ze+=Ye*_e),q=Z,Z+=$.reduce((Qu,Tc)=>Qu+Tc,0),_e){case Fe.CODE_START_A:case Fe.CODE_START_B:case Fe.CODE_START_C:throw new F}switch(v){case Fe.CODE_CODE_A:if(_e<64)Wt===cn?L+=String.fromCharCode(32+_e):L+=String.fromCharCode(32+_e+128),Wt=!1;else if(_e<96)Wt===cn?L+=String.fromCharCode(_e-64):L+=String.fromCharCode(_e+64),Wt=!1;else switch(_e!==Fe.CODE_STOP&&(He=!1),_e){case Fe.CODE_FNC_1:u&&(L.length===0?L+="]C1":L+="");break;case Fe.CODE_FNC_2:case Fe.CODE_FNC_3:break;case Fe.CODE_FNC_4_A:!cn&&Wt?(cn=!0,Wt=!1):cn&&Wt?(cn=!1,Wt=!1):Wt=!0;break;case Fe.CODE_SHIFT:k=!0,v=Fe.CODE_CODE_B;break;case Fe.CODE_CODE_B:v=Fe.CODE_CODE_B;break;case Fe.CODE_CODE_C:v=Fe.CODE_CODE_C;break;case Fe.CODE_STOP:I=!0;break}break;case Fe.CODE_CODE_B:if(_e<96)Wt===cn?L+=String.fromCharCode(32+_e):L+=String.fromCharCode(32+_e+128),Wt=!1;else switch(_e!==Fe.CODE_STOP&&(He=!1),_e){case Fe.CODE_FNC_1:u&&(L.length===0?L+="]C1":L+="");break;case Fe.CODE_FNC_2:case Fe.CODE_FNC_3:break;case Fe.CODE_FNC_4_B:!cn&&Wt?(cn=!0,Wt=!1):cn&&Wt?(cn=!1,Wt=!1):Wt=!0;break;case Fe.CODE_SHIFT:k=!0,v=Fe.CODE_CODE_A;break;case Fe.CODE_CODE_A:v=Fe.CODE_CODE_A;break;case Fe.CODE_CODE_C:v=Fe.CODE_CODE_C;break;case Fe.CODE_STOP:I=!0;break}break;case Fe.CODE_CODE_C:if(_e<100)_e<10&&(L+="0"),L+=_e;else switch(_e!==Fe.CODE_STOP&&(He=!1),_e){case Fe.CODE_FNC_1:u&&(L.length===0?L+="]C1":L+="");break;case Fe.CODE_CODE_A:v=Fe.CODE_CODE_A;break;case Fe.CODE_CODE_B:v=Fe.CODE_CODE_B;break;case Fe.CODE_STOP:I=!0;break}break}ga&&(v=v===Fe.CODE_CODE_A?Fe.CODE_CODE_B:Fe.CODE_CODE_A)}const Sr=Z-q;if(Z=a.getNextUnset(Z),!a.isRange(Z,Math.min(a.getSize(),Z+(Z-q)/2),!1))throw new oe;if(Ze-=Ye*ue,Ze%103!==ue)throw new B;const Fi=L.length;if(Fi===0)throw new oe;Fi>0&&He&&(v===Fe.CODE_CODE_C?L=L.substring(0,Fi-2):L=L.substring(0,Fi-1));const ii=(d[1]+d[0])/2,Gn=q+Sr/2,Wr=_.length,Ni=new Uint8Array(Wr);for(let ga=0;ga<Wr;ga++)Ni[ga]=_[ga];const Ka=[new Ie(ii,r),new Ie(Gn,r)];return new Ce(L,Ni,0,Ka,me.CODE_128,new Date().getTime())}}Fe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Fe.MAX_AVG_VARIANCE=.25,Fe.MAX_INDIVIDUAL_VARIANCE=.7,Fe.CODE_SHIFT=98,Fe.CODE_CODE_C=99,Fe.CODE_CODE_B=100,Fe.CODE_CODE_A=101,Fe.CODE_FNC_1=102,Fe.CODE_FNC_2=97,Fe.CODE_FNC_3=96,Fe.CODE_FNC_4_A=101,Fe.CODE_FNC_4_B=100,Fe.CODE_START_A=103,Fe.CODE_START_B=104,Fe.CODE_START_C=105,Fe.CODE_STOP=106;class Ht extends tn{constructor(r=!1,a=!1){super(),this.usingCheckDigit=r,this.extendedMode=a,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,a,l){let u=this.counters;u.fill(0),this.decodeRowResult="";let d=Ht.findAsteriskPattern(a,u),m=a.getNextSet(d[1]),y=a.getSize(),_,v;do{Ht.recordPattern(a,m,u);let $=Ht.toNarrowWidePattern(u);if($<0)throw new oe;_=Ht.patternToChar($),this.decodeRowResult+=_,v=m;for(let ue of u)m+=ue;m=a.getNextSet(m)}while(_!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let I=0;for(let $ of u)I+=$;let k=m-v-I;if(m!==y&&k*2<I)throw new oe;if(this.usingCheckDigit){let $=this.decodeRowResult.length-1,ue=0;for(let _e=0;_e<$;_e++)ue+=Ht.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(_e));if(this.decodeRowResult.charAt($)!==Ht.ALPHABET_STRING.charAt(ue%43))throw new B;this.decodeRowResult=this.decodeRowResult.substring(0,$)}if(this.decodeRowResult.length===0)throw new oe;let L;this.extendedMode?L=Ht.decodeExtended(this.decodeRowResult):L=this.decodeRowResult;let q=(d[1]+d[0])/2,Z=v+I/2;return new Ce(L,null,0,[new Ie(q,r),new Ie(Z,r)],me.CODE_39,new Date().getTime())}static findAsteriskPattern(r,a){let l=r.getSize(),u=r.getNextSet(0),d=0,m=u,y=!1,_=a.length;for(let v=u;v<l;v++)if(r.get(v)!==y)a[d]++;else{if(d===_-1){if(this.toNarrowWidePattern(a)===Ht.ASTERISK_ENCODING&&r.isRange(Math.max(0,m-Math.floor((v-m)/2)),m,!1))return[m,v];m+=a[0]+a[1],a.copyWithin(0,2,2+d-1),a[d-1]=0,a[d]=0,d--}else d++;a[d]=1,y=!y}throw new oe}static toNarrowWidePattern(r){let a=r.length,l=0,u;do{let d=2147483647;for(let _ of r)_<d&&_>l&&(d=_);l=d,u=0;let m=0,y=0;for(let _=0;_<a;_++){let v=r[_];v>l&&(y|=1<<a-1-_,u++,m+=v)}if(u===3){for(let _=0;_<a&&u>0;_++){let v=r[_];if(v>l&&(u--,v*2>=m))return-1}return y}}while(u>3);return-1}static patternToChar(r){for(let a=0;a<Ht.CHARACTER_ENCODINGS.length;a++)if(Ht.CHARACTER_ENCODINGS[a]===r)return Ht.ALPHABET_STRING.charAt(a);if(r===Ht.ASTERISK_ENCODING)return"*";throw new oe}static decodeExtended(r){let a=r.length,l="";for(let u=0;u<a;u++){let d=r.charAt(u);if(d==="+"||d==="$"||d==="%"||d==="/"){let m=r.charAt(u+1),y="\0";switch(d){case"+":if(m>="A"&&m<="Z")y=String.fromCharCode(m.charCodeAt(0)+32);else throw new F;break;case"$":if(m>="A"&&m<="Z")y=String.fromCharCode(m.charCodeAt(0)-64);else throw new F;break;case"%":if(m>="A"&&m<="E")y=String.fromCharCode(m.charCodeAt(0)-38);else if(m>="F"&&m<="J")y=String.fromCharCode(m.charCodeAt(0)-11);else if(m>="K"&&m<="O")y=String.fromCharCode(m.charCodeAt(0)+16);else if(m>="P"&&m<="T")y=String.fromCharCode(m.charCodeAt(0)+43);else if(m==="U")y="\0";else if(m==="V")y="@";else if(m==="W")y="`";else if(m==="X"||m==="Y"||m==="Z")y="";else throw new F;break;case"/":if(m>="A"&&m<="O")y=String.fromCharCode(m.charCodeAt(0)-32);else if(m==="Z")y=":";else throw new F;break}l+=y,u++}else l+=d}return l}}Ht.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Ht.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Ht.ASTERISK_ENCODING=148;class At extends tn{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,a,l){let u=this.decodeStart(a),d=this.decodeEnd(a),m=new G;At.decodeMiddle(a,u[1],d[0],m);let y=m.toString(),_=null;l!=null&&(_=l.get(Qe.ALLOWED_LENGTHS)),_==null&&(_=At.DEFAULT_ALLOWED_LENGTHS);let v=y.length,I=!1,k=0;for(let Z of _){if(v===Z){I=!0;break}Z>k&&(k=Z)}if(!I&&v>k&&(I=!0),!I)throw new F;const L=[new Ie(u[1],r),new Ie(d[0],r)];return new Ce(y,null,0,L,me.ITF,new Date().getTime())}static decodeMiddle(r,a,l,u){let d=new Int32Array(10),m=new Int32Array(5),y=new Int32Array(5);for(d.fill(0),m.fill(0),y.fill(0);a<l;){tn.recordPattern(r,a,d);for(let v=0;v<5;v++){let I=2*v;m[v]=d[I],y[v]=d[I+1]}let _=At.decodeDigit(m);u.append(_.toString()),_=this.decodeDigit(y),u.append(_.toString()),d.forEach(function(v){a+=v})}}decodeStart(r){let a=At.skipWhiteSpace(r),l=At.findGuardPattern(r,a,At.START_PATTERN);return this.narrowLineWidth=(l[1]-l[0])/4,this.validateQuietZone(r,l[0]),l}validateQuietZone(r,a){let l=this.narrowLineWidth*10;l=l<a?l:a;for(let u=a-1;l>0&&u>=0&&!r.get(u);u--)l--;if(l!==0)throw new oe}static skipWhiteSpace(r){const a=r.getSize(),l=r.getNextSet(0);if(l===a)throw new oe;return l}decodeEnd(r){r.reverse();try{let a=At.skipWhiteSpace(r),l;try{l=At.findGuardPattern(r,a,At.END_PATTERN_REVERSED[0])}catch(d){d instanceof oe&&(l=At.findGuardPattern(r,a,At.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,l[0]);let u=l[0];return l[0]=r.getSize()-l[1],l[1]=r.getSize()-u,l}finally{r.reverse()}}static findGuardPattern(r,a,l){let u=l.length,d=new Int32Array(u),m=r.getSize(),y=!1,_=0,v=a;d.fill(0);for(let I=a;I<m;I++)if(r.get(I)!==y)d[_]++;else{if(_===u-1){if(tn.patternMatchVariance(d,l,At.MAX_INDIVIDUAL_VARIANCE)<At.MAX_AVG_VARIANCE)return[v,I];v+=d[0]+d[1],ne.arraycopy(d,2,d,0,_-1),d[_-1]=0,d[_]=0,_--}else _++;d[_]=1,y=!y}throw new oe}static decodeDigit(r){let a=At.MAX_AVG_VARIANCE,l=-1,u=At.PATTERNS.length;for(let d=0;d<u;d++){let m=At.PATTERNS[d],y=tn.patternMatchVariance(r,m,At.MAX_INDIVIDUAL_VARIANCE);y<a?(a=y,l=d):y===a&&(l=-1)}if(l>=0)return l%10;throw new oe}}At.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],At.MAX_AVG_VARIANCE=.38,At.MAX_INDIVIDUAL_VARIANCE=.5,At.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],At.START_PATTERN=Int32Array.from([1,1,1,1]),At.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class wn extends tn{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let a=!1,l,u=0,d=Int32Array.from([0,0,0]);for(;!a;){d=Int32Array.from([0,0,0]),l=wn.findGuardPattern(r,u,!1,this.START_END_PATTERN,d);let m=l[0];u=l[1];let y=m-(u-m);y>=0&&(a=r.isRange(y,m,!1))}return l}static checkChecksum(r){return wn.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let a=r.length;if(a===0)return!1;let l=parseInt(r.charAt(a-1),10);return wn.getStandardUPCEANChecksum(r.substring(0,a-1))===l}static getStandardUPCEANChecksum(r){let a=r.length,l=0;for(let u=a-1;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}l*=3;for(let u=a-2;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}return(1e3-l)%10}static decodeEnd(r,a){return wn.findGuardPattern(r,a,!1,wn.START_END_PATTERN,new Int32Array(wn.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,a,l,u){return this.findGuardPattern(r,a,l,u,new Int32Array(u.length))}static findGuardPattern(r,a,l,u,d){let m=r.getSize();a=l?r.getNextUnset(a):r.getNextSet(a);let y=0,_=a,v=u.length,I=l;for(let k=a;k<m;k++)if(r.get(k)!==I)d[y]++;else{if(y===v-1){if(tn.patternMatchVariance(d,u,wn.MAX_INDIVIDUAL_VARIANCE)<wn.MAX_AVG_VARIANCE)return Int32Array.from([_,k]);_+=d[0]+d[1];let L=d.slice(2,d.length-1);for(let q=0;q<y-1;q++)d[q]=L[q];d[y-1]=0,d[y]=0,y--}else y++;d[y]=1,I=!I}throw new oe}static decodeDigit(r,a,l,u){this.recordPattern(r,l,a);let d=this.MAX_AVG_VARIANCE,m=-1,y=u.length;for(let _=0;_<y;_++){let v=u[_],I=tn.patternMatchVariance(a,v,wn.MAX_INDIVIDUAL_VARIANCE);I<d&&(d=I,m=_)}if(m>=0)return m;throw new oe}}wn.MAX_AVG_VARIANCE=.48,wn.MAX_INDIVIDUAL_VARIANCE=.7,wn.START_END_PATTERN=Int32Array.from([1,1,1]),wn.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),wn.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),wn.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class vr{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,a,l){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(a,l,u),m=u.toString(),y=vr.parseExtensionString(m),_=[new Ie((l[0]+l[1])/2,r),new Ie(d,r)],v=new Ce(m,null,0,_,me.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&v.putAllMetadata(y),v}decodeMiddle(r,a,l){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),m=a[1],y=0;for(let v=0;v<5&&m<d;v++){let I=wn.decodeDigit(r,u,m,wn.L_AND_G_PATTERNS);l+=String.fromCharCode(48+I%10);for(let k of u)m+=k;I>=10&&(y|=1<<4-v),v!==4&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(l.length!==5)throw new oe;let _=this.determineCheckDigit(y);if(vr.extensionChecksum(l.toString())!==_)throw new oe;return m}static extensionChecksum(r){let a=r.length,l=0;for(let u=a-2;u>=0;u-=2)l+=r.charAt(u).charCodeAt(0)-48;l*=3;for(let u=a-1;u>=0;u-=2)l+=r.charAt(u).charCodeAt(0)-48;return l*=3,l%10}determineCheckDigit(r){for(let a=0;a<10;a++)if(r===this.CHECK_DIGIT_ENCODINGS[a])return a;throw new oe}static parseExtensionString(r){if(r.length!==5)return null;let a=vr.parseExtension5String(r);return a==null?null:new Map([[mt.SUGGESTED_PRICE,a]])}static parseExtension5String(r){let a;switch(r.charAt(0)){case"0":a="";break;case"5":a="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}a="";break;default:a="";break}let l=parseInt(r.substring(1)),u=(l/100).toString(),d=l%100,m=d<10?"0"+d:d.toString();return a+u+"."+m}}class Xr{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,a,l){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(a,l,u),m=u.toString(),y=Xr.parseExtensionString(m),_=[new Ie((l[0]+l[1])/2,r),new Ie(d,r)],v=new Ce(m,null,0,_,me.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&v.putAllMetadata(y),v}decodeMiddle(r,a,l){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),m=a[1],y=0;for(let _=0;_<2&&m<d;_++){let v=wn.decodeDigit(r,u,m,wn.L_AND_G_PATTERNS);l+=String.fromCharCode(48+v%10);for(let I of u)m+=I;v>=10&&(y|=1<<1-_),_!==1&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(l.length!==2)throw new oe;if(parseInt(l.toString())%4!==y)throw new oe;return m}static parseExtensionString(r){return r.length!==2?null:new Map([[mt.ISSUE_NUMBER,parseInt(r)]])}}class Tr{static decodeRow(r,a,l){let u=wn.findGuardPattern(a,l,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new vr().decodeRow(r,a,u)}catch{return new Xr().decodeRow(r,a,u)}}}Tr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Vt extends wn{constructor(){super(),this.decodeRowStringBuffer="",Vt.L_AND_G_PATTERNS=Vt.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let a=Vt.L_PATTERNS[r-10],l=new Int32Array(a.length);for(let u=0;u<a.length;u++)l[u]=a[a.length-u-1];Vt.L_AND_G_PATTERNS[r]=l}}decodeRow(r,a,l){let u=Vt.findStartGuardPattern(a),d=l==null?null:l.get(Qe.NEED_RESULT_POINT_CALLBACK);if(d!=null){const He=new Ie((u[0]+u[1])/2,r);d.foundPossibleResultPoint(He)}let m=this.decodeMiddle(a,u,this.decodeRowStringBuffer),y=m.rowOffset,_=m.resultString;if(d!=null){const He=new Ie(y,r);d.foundPossibleResultPoint(He)}let v=this.decodeEnd(a,y);if(d!=null){const He=new Ie((v[0]+v[1])/2,r);d.foundPossibleResultPoint(He)}let I=v[1],k=I+(I-v[0]);if(k>=a.getSize()||!a.isRange(I,k,!1))throw new oe;let L=_.toString();if(L.length<8)throw new F;if(!Vt.checkChecksum(L))throw new B;let q=(u[1]+u[0])/2,Z=(v[1]+v[0])/2,$=this.getBarcodeFormat(),ue=[new Ie(q,r),new Ie(Z,r)],_e=new Ce(L,null,0,ue,$,new Date().getTime()),Ze=0;try{let He=Tr.decodeRow(r,a,v[1]);_e.putMetadata(mt.UPC_EAN_EXTENSION,He.getText()),_e.putAllMetadata(He.getResultMetadata()),_e.addResultPoints(He.getResultPoints()),Ze=He.getText().length}catch{}let Ye=l==null?null:l.get(Qe.ALLOWED_EAN_EXTENSIONS);if(Ye!=null){let He=!1;for(let cn in Ye)if(Ze.toString()===cn){He=!0;break}if(!He)throw new oe}return _e}decodeEnd(r,a){return Vt.findGuardPattern(r,a,!1,Vt.START_END_PATTERN,new Int32Array(Vt.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return Vt.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let a=r.length;if(a===0)return!1;let l=parseInt(r.charAt(a-1),10);return Vt.getStandardUPCEANChecksum(r.substring(0,a-1))===l}static getStandardUPCEANChecksum(r){let a=r.length,l=0;for(let u=a-1;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}l*=3;for(let u=a-2;u>=0;u-=2){let d=r.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new F;l+=d}return(1e3-l)%10}}class Zt extends Vt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,a,l){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),m=a[1],y=0;for(let v=0;v<6&&m<d;v++){let I=Vt.decodeDigit(r,u,m,Vt.L_AND_G_PATTERNS);l+=String.fromCharCode(48+I%10);for(let k of u)m+=k;I>=10&&(y|=1<<5-v)}l=Zt.determineFirstDigit(l,y),m=Vt.findGuardPattern(r,m,!0,Vt.MIDDLE_PATTERN,new Int32Array(Vt.MIDDLE_PATTERN.length).fill(0))[1];for(let v=0;v<6&&m<d;v++){let I=Vt.decodeDigit(r,u,m,Vt.L_PATTERNS);l+=String.fromCharCode(48+I);for(let k of u)m+=k}return{rowOffset:m,resultString:l}}getBarcodeFormat(){return me.EAN_13}static determineFirstDigit(r,a){for(let l=0;l<10;l++)if(a===this.FIRST_DIGIT_ENCODINGS[l])return r=String.fromCharCode(48+l)+r,r;throw new oe}}Zt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class jn extends Vt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,a,l){const u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),m=a[1];for(let _=0;_<4&&m<d;_++){let v=Vt.decodeDigit(r,u,m,Vt.L_PATTERNS);l+=String.fromCharCode(48+v);for(let I of u)m+=I}m=Vt.findGuardPattern(r,m,!0,Vt.MIDDLE_PATTERN,new Int32Array(Vt.MIDDLE_PATTERN.length).fill(0))[1];for(let _=0;_<4&&m<d;_++){let v=Vt.decodeDigit(r,u,m,Vt.L_PATTERNS);l+=String.fromCharCode(48+v);for(let I of u)m+=I}return{rowOffset:m,resultString:l}}getBarcodeFormat(){return me.EAN_8}}class Mr extends Vt{constructor(){super(...arguments),this.ean13Reader=new Zt}getBarcodeFormat(){return me.UPC_A}decode(r,a){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,a,l){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,a,l))}decodeMiddle(r,a,l){return this.ean13Reader.decodeMiddle(r,a,l)}maybeReturnResult(r){let a=r.getText();if(a.charAt(0)==="0"){let l=new Ce(a.substring(1),null,null,r.getResultPoints(),me.UPC_A);return r.getResultMetadata()!=null&&l.putAllMetadata(r.getResultMetadata()),l}else throw new oe}reset(){this.ean13Reader.reset()}}class dt extends Vt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,a,l){const u=this.decodeMiddleCounters.map(v=>v);u[0]=0,u[1]=0,u[2]=0,u[3]=0;const d=r.getSize();let m=a[1],y=0;for(let v=0;v<6&&m<d;v++){const I=dt.decodeDigit(r,u,m,dt.L_AND_G_PATTERNS);l+=String.fromCharCode(48+I%10);for(let k of u)m+=k;I>=10&&(y|=1<<5-v)}let _=dt.determineNumSysAndCheckDigit(l,y);return{rowOffset:m,resultString:_}}decodeEnd(r,a){return dt.findGuardPatternWithoutCounters(r,a,!0,dt.MIDDLE_END_PATTERN)}checkChecksum(r){return Vt.checkChecksum(dt.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,a){for(let l=0;l<=1;l++)for(let u=0;u<10;u++)if(a===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[l][u]){let d=String.fromCharCode(48+l),m=String.fromCharCode(48+u);return d+r+m}throw oe.getNotFoundInstance()}getBarcodeFormat(){return me.UPC_E}static convertUPCEtoUPCA(r){const a=r.slice(1,7).split("").map(d=>d.charCodeAt(0)),l=new G;l.append(r.charAt(0));let u=a[5];switch(u){case 0:case 1:case 2:l.appendChars(a,0,2),l.append(u),l.append("0000"),l.appendChars(a,2,3);break;case 3:l.appendChars(a,0,3),l.append("00000"),l.appendChars(a,3,2);break;case 4:l.appendChars(a,0,4),l.append("00000"),l.append(a[4]);break;default:l.appendChars(a,0,5),l.append("0000"),l.append(u);break}return r.length>=8&&l.append(r.charAt(7)),l.toString()}}dt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),dt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class nn extends tn{constructor(r){super();let a=r==null?null:r.get(Qe.POSSIBLE_FORMATS),l=[];o(a)?(l.push(new Zt),l.push(new Mr),l.push(new jn),l.push(new dt)):(a.indexOf(me.EAN_13)>-1&&l.push(new Zt),a.indexOf(me.UPC_A)>-1&&l.push(new Mr),a.indexOf(me.EAN_8)>-1&&l.push(new jn),a.indexOf(me.UPC_E)>-1&&l.push(new dt)),this.readers=l}decodeRow(r,a,l){for(let u of this.readers)try{const d=u.decodeRow(r,a,l),m=d.getBarcodeFormat()===me.EAN_13&&d.getText().charAt(0)==="0",y=l==null?null:l.get(Qe.POSSIBLE_FORMATS),_=y==null||y.includes(me.UPC_A);if(m&&_){const v=d.getRawBytes(),I=new Ce(d.getText().substring(1),v,v?v.length:null,d.getResultPoints(),me.UPC_A);return I.putAllMetadata(d.getResultMetadata()),I}return d}catch{}throw new oe}reset(){for(let r of this.readers)r.reset()}}class re extends tn{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,a){for(let l=0;l<a.length;l++)if(tn.patternMatchVariance(r,a[l],re.MAX_INDIVIDUAL_VARIANCE)<re.MAX_AVG_VARIANCE)return l;throw new oe}static count(r){return Ve.sum(new Int32Array(r))}static increment(r,a){let l=0,u=a[0];for(let d=1;d<r.length;d++)a[d]>u&&(u=a[d],l=d);r[l]++}static decrement(r,a){let l=0,u=a[0];for(let d=1;d<r.length;d++)a[d]<u&&(u=a[d],l=d);r[l]--}static isFinderPattern(r){let a=r[0]+r[1],l=a+r[2]+r[3],u=a/l;if(u>=re.MIN_FINDER_PATTERN_RATIO&&u<=re.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER;for(let y of r)y>m&&(m=y),y<d&&(d=y);return m<10*d}return!1}}re.MAX_AVG_VARIANCE=.2,re.MAX_INDIVIDUAL_VARIANCE=.45,re.MIN_FINDER_PATTERN_RATIO=9.5/12,re.MAX_FINDER_PATTERN_RATIO=12.5/14;class Se{constructor(r,a){this.value=r,this.checksumPortion=a}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof Se))return!1;const a=r;return this.value===a.value&&this.checksumPortion===a.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class je{constructor(r,a,l,u,d){this.value=r,this.startEnd=a,this.value=r,this.startEnd=a,this.resultPoints=new Array,this.resultPoints.push(new Ie(l,d)),this.resultPoints.push(new Ie(u,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof je))return!1;const a=r;return this.value===a.value}hashCode(){return this.value}}class Xe{constructor(){}static getRSSvalue(r,a,l){let u=0;for(let _ of r)u+=_;let d=0,m=0,y=r.length;for(let _=0;_<y-1;_++){let v;for(v=1,m|=1<<_;v<r[_];v++,m&=~(1<<_)){let I=Xe.combins(u-v-1,y-_-2);if(l&&m===0&&u-v-(y-_-1)>=y-_-1&&(I-=Xe.combins(u-v-(y-_),y-_-2)),y-_-1>1){let k=0;for(let L=u-v-(y-_-2);L>a;L--)k+=Xe.combins(u-v-L-1,y-_-3);I-=k*(y-1-_)}else u-v>a&&I--;d+=I}u-=v}return d}static combins(r,a){let l,u;r-a>a?(u=a,l=r-a):(u=r-a,l=a);let d=1,m=1;for(let y=r;y>l;y--)d*=y,m<=u&&(d/=m,m++);for(;m<=u;)d/=m,m++;return d}}class st{static buildBitArray(r){let a=r.length*2-1;r[r.length-1].getRightChar()==null&&(a-=1);let l=12*a,u=new Ge(l),d=0,y=r[0].getRightChar().getValue();for(let _=11;_>=0;--_)(y&1<<_)!=0&&u.set(d),d++;for(let _=1;_<r.length;++_){let v=r[_],I=v.getLeftChar().getValue();for(let k=11;k>=0;--k)(I&1<<k)!=0&&u.set(d),d++;if(v.getRightChar()!=null){let k=v.getRightChar().getValue();for(let L=11;L>=0;--L)(k&1<<L)!=0&&u.set(d),d++}}return u}}class pt{constructor(r,a){a?this.decodedInformation=null:(this.finished=r,this.decodedInformation=a)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class at{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class Gt extends at{constructor(r,a){super(r),this.value=a}getValue(){return this.value}isFNC1(){return this.value===Gt.FNC1}}Gt.FNC1="$";class Rt extends at{constructor(r,a,l){super(r),l?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=a}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Ut extends at{constructor(r,a,l){if(super(r),a<0||a>10||l<0||l>10)throw new F;this.firstDigit=a,this.secondDigit=l}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Ut.FNC1}isSecondDigitFNC1(){return this.secondDigit===Ut.FNC1}isAnyFNC1(){return this.firstDigit===Ut.FNC1||this.secondDigit===Ut.FNC1}}Ut.FNC1=10;class Oe{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new oe;let a=r.substring(0,2);for(let d of Oe.TWO_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===Oe.VARIABLE_LENGTH?Oe.processVariableAI(2,d[2],r):Oe.processFixedAI(2,d[1],r);if(r.length<3)throw new oe;let l=r.substring(0,3);for(let d of Oe.THREE_DIGIT_DATA_LENGTH)if(d[0]===l)return d[1]===Oe.VARIABLE_LENGTH?Oe.processVariableAI(3,d[2],r):Oe.processFixedAI(3,d[1],r);for(let d of Oe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===l)return d[1]===Oe.VARIABLE_LENGTH?Oe.processVariableAI(4,d[2],r):Oe.processFixedAI(4,d[1],r);if(r.length<4)throw new oe;let u=r.substring(0,4);for(let d of Oe.FOUR_DIGIT_DATA_LENGTH)if(d[0]===u)return d[1]===Oe.VARIABLE_LENGTH?Oe.processVariableAI(4,d[2],r):Oe.processFixedAI(4,d[1],r);throw new oe}static processFixedAI(r,a,l){if(l.length<r)throw new oe;let u=l.substring(0,r);if(l.length<r+a)throw new oe;let d=l.substring(r,r+a),m=l.substring(r+a),y="("+u+")"+d,_=Oe.parseFieldsInGeneralPurpose(m);return _==null?y:y+_}static processVariableAI(r,a,l){let u=l.substring(0,r),d;l.length<r+a?d=l.length:d=r+a;let m=l.substring(r,d),y=l.substring(d),_="("+u+")"+m,v=Oe.parseFieldsInGeneralPurpose(y);return v==null?_:_+v}}Oe.VARIABLE_LENGTH=[],Oe.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Oe.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Oe.VARIABLE_LENGTH,20],["22",Oe.VARIABLE_LENGTH,29],["30",Oe.VARIABLE_LENGTH,8],["37",Oe.VARIABLE_LENGTH,8],["90",Oe.VARIABLE_LENGTH,30],["91",Oe.VARIABLE_LENGTH,30],["92",Oe.VARIABLE_LENGTH,30],["93",Oe.VARIABLE_LENGTH,30],["94",Oe.VARIABLE_LENGTH,30],["95",Oe.VARIABLE_LENGTH,30],["96",Oe.VARIABLE_LENGTH,30],["97",Oe.VARIABLE_LENGTH,3],["98",Oe.VARIABLE_LENGTH,30],["99",Oe.VARIABLE_LENGTH,30]],Oe.THREE_DIGIT_DATA_LENGTH=[["240",Oe.VARIABLE_LENGTH,30],["241",Oe.VARIABLE_LENGTH,30],["242",Oe.VARIABLE_LENGTH,6],["250",Oe.VARIABLE_LENGTH,30],["251",Oe.VARIABLE_LENGTH,30],["253",Oe.VARIABLE_LENGTH,17],["254",Oe.VARIABLE_LENGTH,20],["400",Oe.VARIABLE_LENGTH,30],["401",Oe.VARIABLE_LENGTH,30],["402",17],["403",Oe.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Oe.VARIABLE_LENGTH,20],["421",Oe.VARIABLE_LENGTH,15],["422",3],["423",Oe.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Oe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Oe.VARIABLE_LENGTH,15],["391",Oe.VARIABLE_LENGTH,18],["392",Oe.VARIABLE_LENGTH,15],["393",Oe.VARIABLE_LENGTH,18],["703",Oe.VARIABLE_LENGTH,30]],Oe.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Oe.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Oe.VARIABLE_LENGTH,20],["8003",Oe.VARIABLE_LENGTH,30],["8004",Oe.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Oe.VARIABLE_LENGTH,30],["8008",Oe.VARIABLE_LENGTH,12],["8018",18],["8020",Oe.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Oe.VARIABLE_LENGTH,70],["8200",Oe.VARIABLE_LENGTH,70]];class an{constructor(r){this.buffer=new G,this.information=r}decodeAllCodes(r,a){let l=a,u=null;do{let d=this.decodeGeneralPurposeField(l,u),m=Oe.parseFieldsInGeneralPurpose(d.getNewString());if(m!=null&&r.append(m),d.isRemaining()?u=""+d.getRemainingValue():u=null,l===d.getNewPosition())break;l=d.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let a=r;a<r+3;++a)if(this.information.get(a))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(r,4);return d===0?new Ut(this.information.getSize(),Ut.FNC1,Ut.FNC1):new Ut(this.information.getSize(),d-1,Ut.FNC1)}let a=this.extractNumericValueFromBitArray(r,7),l=(a-8)/11,u=(a-8)%11;return new Ut(r+7,l,u)}extractNumericValueFromBitArray(r,a){return an.extractNumericValueFromBitArray(this.information,r,a)}static extractNumericValueFromBitArray(r,a,l){let u=0;for(let d=0;d<l;++d)r.get(a+d)&&(u|=1<<l-d-1);return u}decodeGeneralPurposeField(r,a){this.buffer.setLengthToZero(),a!=null&&this.buffer.append(a),this.current.setPosition(r);let l=this.parseBlocks();return l!=null&&l.isRemaining()?new Rt(this.current.getPosition(),this.buffer.toString(),l.getRemainingValue()):new Rt(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,a;do{let l=this.current.getPosition();if(this.current.isAlpha()?(a=this.parseAlphaBlock(),r=a.isFinished()):this.current.isIsoIec646()?(a=this.parseIsoIec646Block(),r=a.isFinished()):(a=this.parseNumericBlock(),r=a.isFinished()),!(l!==this.current.getPosition())&&!r)break}while(!r);return a.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let a;return r.isSecondDigitFNC1()?a=new Rt(this.current.getPosition(),this.buffer.toString()):a=new Rt(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new pt(!0,a)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let a=new Rt(this.current.getPosition(),this.buffer.toString());return new pt(!0,a)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new pt(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let a=new Rt(this.current.getPosition(),this.buffer.toString());return new pt(!0,a)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new pt(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let a=new Rt(this.current.getPosition(),this.buffer.toString());return new pt(!0,a)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new pt(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,5);if(a>=5&&a<16)return!0;if(r+7>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,7);if(l>=64&&l<116)return!0;if(r+8>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,8);return u>=232&&u<253}decodeIsoIec646(r){let a=this.extractNumericValueFromBitArray(r,5);if(a===15)return new Gt(r+5,Gt.FNC1);if(a>=5&&a<15)return new Gt(r+5,"0"+(a-5));let l=this.extractNumericValueFromBitArray(r,7);if(l>=64&&l<90)return new Gt(r+7,""+(l+1));if(l>=90&&l<116)return new Gt(r+7,""+(l+7));let u=this.extractNumericValueFromBitArray(r,8),d;switch(u){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new F}return new Gt(r+8,d)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(r,5);if(a>=5&&a<16)return!0;if(r+6>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(r,6);return l>=16&&l<63}decodeAlphanumeric(r){let a=this.extractNumericValueFromBitArray(r,5);if(a===15)return new Gt(r+5,Gt.FNC1);if(a>=5&&a<15)return new Gt(r+5,"0"+(a-5));let l=this.extractNumericValueFromBitArray(r,6);if(l>=32&&l<58)return new Gt(r+6,""+(l+33));let u;switch(l){case 58:u="*";break;case 59:u=",";break;case 60:u="-";break;case 61:u=".";break;case 62:u="/";break;default:throw new On("Decoding invalid alphanumeric value: "+l)}return new Gt(r+6,u)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let a=0;a<5&&a+r<this.information.getSize();++a)if(a===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+a))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let a=r;a<r+3;++a)if(this.information.get(a))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let a=0;a<4&&a+r<this.information.getSize();++a)if(this.information.get(r+a))return!1;return!0}}class yt{constructor(r){this.information=r,this.generalDecoder=new an(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Mt extends yt{constructor(r){super(r)}encodeCompressedGtin(r,a){r.append("(01)");let l=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,a,l)}encodeCompressedGtinWithoutAI(r,a,l){for(let u=0;u<4;++u){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(a+10*u,10);d/100===0&&r.append("0"),d/10===0&&r.append("0"),r.append(d)}Mt.appendCheckDigit(r,l)}static appendCheckDigit(r,a){let l=0;for(let u=0;u<13;u++){let d=r.charAt(u+a).charCodeAt(0)-48;l+=(u&1)===0?3*d:d}l=10-l%10,l===10&&(l=0),r.append(l)}}Mt.GTIN_SIZE=40;class er extends Mt{constructor(r){super(r)}parseInformation(){let r=new G;r.append("(01)");let a=r.length(),l=this.getGeneralDecoder().extractNumericValueFromBitArray(er.HEADER_SIZE,4);return r.append(l),this.encodeCompressedGtinWithoutAI(r,er.HEADER_SIZE+4,a),this.getGeneralDecoder().decodeAllCodes(r,er.HEADER_SIZE+44)}}er.HEADER_SIZE=4;class fi extends yt{constructor(r){super(r)}parseInformation(){let r=new G;return this.getGeneralDecoder().decodeAllCodes(r,fi.HEADER_SIZE)}}fi.HEADER_SIZE=5;class Ps extends Mt{constructor(r){super(r)}encodeCompressedWeight(r,a,l){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(a,l);this.addWeightCode(r,u);let d=this.checkWeight(u),m=1e5;for(let y=0;y<5;++y)d/m===0&&r.append("0"),m/=10;r.append(d)}}class ri extends Ps{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=ri.HEADER_SIZE+Ps.GTIN_SIZE+ri.WEIGHT_SIZE)throw new oe;let r=new G;return this.encodeCompressedGtin(r,ri.HEADER_SIZE),this.encodeCompressedWeight(r,ri.HEADER_SIZE+Ps.GTIN_SIZE,ri.WEIGHT_SIZE),r.toString()}}ri.HEADER_SIZE=5,ri.WEIGHT_SIZE=15;class za extends ri{constructor(r){super(r)}addWeightCode(r,a){r.append("(3103)")}checkWeight(r){return r}}class Li extends ri{constructor(r){super(r)}addWeightCode(r,a){a<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class Yr extends Mt{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Yr.HEADER_SIZE+Mt.GTIN_SIZE)throw new oe;let r=new G;this.encodeCompressedGtin(r,Yr.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Yr.HEADER_SIZE+Mt.GTIN_SIZE,Yr.LAST_DIGIT_SIZE);r.append("(392"),r.append(a),r.append(")");let l=this.getGeneralDecoder().decodeGeneralPurposeField(Yr.HEADER_SIZE+Mt.GTIN_SIZE+Yr.LAST_DIGIT_SIZE,null);return r.append(l.getNewString()),r.toString()}}Yr.HEADER_SIZE=8,Yr.LAST_DIGIT_SIZE=2;class Qn extends Mt{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Qn.HEADER_SIZE+Mt.GTIN_SIZE)throw new oe;let r=new G;this.encodeCompressedGtin(r,Qn.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Qn.HEADER_SIZE+Mt.GTIN_SIZE,Qn.LAST_DIGIT_SIZE);r.append("(393"),r.append(a),r.append(")");let l=this.getGeneralDecoder().extractNumericValueFromBitArray(Qn.HEADER_SIZE+Mt.GTIN_SIZE+Qn.LAST_DIGIT_SIZE,Qn.FIRST_THREE_DIGITS_SIZE);l/100==0&&r.append("0"),l/10==0&&r.append("0"),r.append(l);let u=this.getGeneralDecoder().decodeGeneralPurposeField(Qn.HEADER_SIZE+Mt.GTIN_SIZE+Qn.LAST_DIGIT_SIZE+Qn.FIRST_THREE_DIGITS_SIZE,null);return r.append(u.getNewString()),r.toString()}}Qn.HEADER_SIZE=8,Qn.LAST_DIGIT_SIZE=2,Qn.FIRST_THREE_DIGITS_SIZE=10;class un extends Ps{constructor(r,a,l){super(r),this.dateCode=l,this.firstAIdigits=a}parseInformation(){if(this.getInformation().getSize()!=un.HEADER_SIZE+un.GTIN_SIZE+un.WEIGHT_SIZE+un.DATE_SIZE)throw new oe;let r=new G;return this.encodeCompressedGtin(r,un.HEADER_SIZE),this.encodeCompressedWeight(r,un.HEADER_SIZE+un.GTIN_SIZE,un.WEIGHT_SIZE),this.encodeCompressedDate(r,un.HEADER_SIZE+un.GTIN_SIZE+un.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,a){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(a,un.DATE_SIZE);if(l==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let u=l%32;l/=32;let d=l%12+1;l/=12;let m=l;m/10==0&&r.append("0"),r.append(m),d/10==0&&r.append("0"),r.append(d),u/10==0&&r.append("0"),r.append(u)}addWeightCode(r,a){r.append("("),r.append(this.firstAIdigits),r.append(a/1e5),r.append(")")}checkWeight(r){return r%1e5}}un.HEADER_SIZE=8,un.WEIGHT_SIZE=20,un.DATE_SIZE=16;function Jr(M){try{if(M.get(1))return new er(M);if(!M.get(2))return new fi(M);switch(an.extractNumericValueFromBitArray(M,1,4)){case 4:return new za(M);case 5:return new Li(M)}switch(an.extractNumericValueFromBitArray(M,1,5)){case 12:return new Yr(M);case 13:return new Qn(M)}switch(an.extractNumericValueFromBitArray(M,1,7)){case 56:return new un(M,"310","11");case 57:return new un(M,"320","11");case 58:return new un(M,"310","13");case 59:return new un(M,"320","13");case 60:return new un(M,"310","15");case 61:return new un(M,"320","15");case 62:return new un(M,"310","17");case 63:return new un(M,"320","17")}}catch(r){throw console.log(r),new On("unknown decoder: "+M)}}class kr{constructor(r,a,l,u){this.leftchar=r,this.rightchar=a,this.finderpattern=l,this.maybeLast=u}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,a){return r instanceof kr?kr.equalsOrNull(r.leftchar,a.leftchar)&&kr.equalsOrNull(r.rightchar,a.rightchar)&&kr.equalsOrNull(r.finderpattern,a.finderpattern):!1}static equalsOrNull(r,a){return r===null?a===null:kr.equals(r,a)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ar{constructor(r,a,l){this.pairs=r,this.rowNumber=a,this.wasReversed=l}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,a){return r instanceof ar?this.checkEqualitity(r,a)&&r.wasReversed===a.wasReversed:!1}checkEqualitity(r,a){if(!r||!a)return;let l;return r.forEach((u,d)=>{a.forEach(m=>{u.getLeftChar().getValue()===m.getLeftChar().getValue()&&u.getRightChar().getValue()===m.getRightChar().getValue()&&u.getFinderPatter().getValue()===m.getFinderPatter().getValue()&&(l=!0)})}),l}}class Be extends re{constructor(r){super(...arguments),this.pairs=new Array(Be.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,a,l){this.pairs.length=0,this.startFromEven=!1;try{return Be.constructResult(this.decodeRow2pairs(r,a))}catch(u){this.verbose&&console.log(u)}return this.pairs.length=0,this.startFromEven=!0,Be.constructResult(this.decodeRow2pairs(r,a))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,a){let l=!1;for(;!l;)try{this.pairs.push(this.retrieveNextPair(a,this.pairs,r))}catch(d){if(d instanceof oe){if(!this.pairs.length)throw new oe;l=!0}}if(this.checkChecksum())return this.pairs;let u;if(this.rows.length?u=!0:u=!1,this.storeRow(r,!1),u){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new oe}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let a=null;try{a=this.checkRows(new Array,0)}catch(l){this.verbose&&console.log(l)}return r&&(this.rows=this.rows.reverse()),a}checkRows(r,a){for(let l=a;l<this.rows.length;l++){let u=this.rows[l];this.pairs.length=0;for(let m of r)this.pairs.push(m.getPairs());if(this.pairs.push(u.getPairs()),!Be.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(r);d.push(u);try{return this.checkRows(d,l+1)}catch(m){this.verbose&&console.log(m)}}throw new oe}static isValidSequence(r){for(let a of Be.FINDER_PATTERN_SEQUENCES){if(r.length>a.length)continue;let l=!0;for(let u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!=a[u]){l=!1;break}if(l)return!0}return!1}storeRow(r,a){let l=0,u=!1,d=!1;for(;l<this.rows.length;){let m=this.rows[l];if(m.getRowNumber()>r){d=m.isEquivalent(this.pairs);break}u=m.isEquivalent(this.pairs),l++}d||u||Be.isPartialRow(this.pairs,this.rows)||(this.rows.push(l,new ar(this.pairs,r,a)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,a){for(let l of a)if(l.getPairs().length!==r.length){for(let u of l.getPairs())for(let d of r)if(kr.equals(u,d))break}}static isPartialRow(r,a){for(let l of a){let u=!0;for(let d of r){let m=!1;for(let y of l.getPairs())if(d.equals(y)){m=!0;break}if(!m){u=!1;break}}if(u)return!0}return!1}getRows(){return this.rows}static constructResult(r){let a=st.buildBitArray(r),u=Jr(a).parseInformation(),d=r[0].getFinderPattern().getResultPoints(),m=r[r.length-1].getFinderPattern().getResultPoints(),y=[d[0],d[1],m[0],m[1]];return new Ce(u,null,null,y,me.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),a=r.getLeftChar(),l=r.getRightChar();if(l==null)return!1;let u=l.getChecksumPortion(),d=2;for(let y=1;y<this.pairs.size();++y){let _=this.pairs.get(y);u+=_.getLeftChar().getChecksumPortion(),d++;let v=_.getRightChar();v!=null&&(u+=v.getChecksumPortion(),d++)}return u%=211,211*(d-4)+u==a.getValue()}static getNextSecondBar(r,a){let l;return r.get(a)?(l=r.getNextUnset(a),l=r.getNextSet(l)):(l=r.getNextSet(a),l=r.getNextUnset(l)),l}retrieveNextPair(r,a,l){let u=a.length%2==0;this.startFromEven&&(u=!u);let d,m=!0,y=-1;do this.findNextPair(r,a,y),d=this.parseFoundFinderPattern(r,l,u),d==null?y=Be.getNextSecondBar(r,this.startEnd[0]):m=!1;while(m);let _=this.decodeDataCharacter(r,d,u,!0);if(!this.isEmptyPair(a)&&a[a.length-1].mustBeLast())throw new oe;let v;try{v=this.decodeDataCharacter(r,d,u,!1)}catch(I){v=null,this.verbose&&console.log(I)}return new kr(_,v,d,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,a,l){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),m;l>=0?m=l:this.isEmptyPair(a)?m=0:m=a[a.length-1].getFinderPattern().getStartEnd()[1];let y=a.length%2!=0;this.startFromEven&&(y=!y);let _=!1;for(;m<d&&(_=!r.get(m),!!_);)m++;let v=0,I=m;for(let k=m;k<d;k++)if(r.get(k)!=_)u[v]++;else{if(v==3){if(y&&Be.reverseCounters(u),Be.isFinderPattern(u)){this.startEnd[0]=I,this.startEnd[1]=k;return}y&&Be.reverseCounters(u),I+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,v--}else v++;u[v]=1,_=!_}throw new oe}static reverseCounters(r){let a=r.length;for(let l=0;l<a/2;++l){let u=r[l];r[l]=r[a-l-1],r[a-l-1]=u}}parseFoundFinderPattern(r,a,l){let u,d,m;if(l){let v=this.startEnd[0]-1;for(;v>=0&&!r.get(v);)v--;v++,u=this.startEnd[0]-v,d=v,m=this.startEnd[1]}else d=this.startEnd[0],m=r.getNextUnset(this.startEnd[1]+1),u=m-this.startEnd[1];let y=this.getDecodeFinderCounters();ne.arraycopy(y,0,y,1,y.length-1),y[0]=u;let _;try{_=this.parseFinderValue(y,Be.FINDER_PATTERNS)}catch{return null}return new je(_,[d,m],d,m,a)}decodeDataCharacter(r,a,l,u){let d=this.getDataCharacterCounters();for(let Gn=0;Gn<d.length;Gn++)d[Gn]=0;if(u)Be.recordPatternInReverse(r,a.getStartEnd()[0],d);else{Be.recordPattern(r,a.getStartEnd()[1],d);for(let Gn=0,Wr=d.length-1;Gn<Wr;Gn++,Wr--){let Ni=d[Gn];d[Gn]=d[Wr],d[Wr]=Ni}}let m=17,y=Ve.sum(new Int32Array(d))/m,_=(a.getStartEnd()[1]-a.getStartEnd()[0])/15;if(Math.abs(y-_)/_>.3)throw new oe;let v=this.getOddCounts(),I=this.getEvenCounts(),k=this.getOddRoundingErrors(),L=this.getEvenRoundingErrors();for(let Gn=0;Gn<d.length;Gn++){let Wr=1*d[Gn]/y,Ni=Wr+.5;if(Ni<1){if(Wr<.3)throw new oe;Ni=1}else if(Ni>8){if(Wr>8.7)throw new oe;Ni=8}let Ka=Gn/2;(Gn&1)==0?(v[Ka]=Ni,k[Ka]=Wr-Ni):(I[Ka]=Ni,L[Ka]=Wr-Ni)}this.adjustOddEvenCounts(m);let q=4*a.getValue()+(l?0:2)+(u?0:1)-1,Z=0,$=0;for(let Gn=v.length-1;Gn>=0;Gn--){if(Be.isNotA1left(a,l,u)){let Wr=Be.WEIGHTS[q][2*Gn];$+=v[Gn]*Wr}Z+=v[Gn]}let ue=0;for(let Gn=I.length-1;Gn>=0;Gn--)if(Be.isNotA1left(a,l,u)){let Wr=Be.WEIGHTS[q][2*Gn+1];ue+=I[Gn]*Wr}let _e=$+ue;if((Z&1)!=0||Z>13||Z<4)throw new oe;let Ze=(13-Z)/2,Ye=Be.SYMBOL_WIDEST[Ze],He=9-Ye,cn=Xe.getRSSvalue(v,Ye,!0),Wt=Xe.getRSSvalue(I,He,!1),Sr=Be.EVEN_TOTAL_SUBSET[Ze],Fi=Be.GSUM[Ze],ii=cn*Sr+Wt+Fi;return new Se(ii,_e)}static isNotA1left(r,a,l){return!(r.getValue()==0&&a&&l)}adjustOddEvenCounts(r){let a=Ve.sum(new Int32Array(this.getOddCounts())),l=Ve.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1;a>13?d=!0:a<4&&(u=!0);let m=!1,y=!1;l>13?y=!0:l<4&&(m=!0);let _=a+l-r,v=(a&1)==1,I=(l&1)==0;if(_==1)if(v){if(I)throw new oe;d=!0}else{if(!I)throw new oe;y=!0}else if(_==-1)if(v){if(I)throw new oe;u=!0}else{if(!I)throw new oe;m=!0}else if(_==0){if(v){if(!I)throw new oe;a<l?(u=!0,y=!0):(d=!0,m=!0)}else if(I)throw new oe}else throw new oe;if(u){if(d)throw new oe;Be.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Be.decrement(this.getOddCounts(),this.getOddRoundingErrors()),m){if(y)throw new oe;Be.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&Be.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Be.SYMBOL_WIDEST=[7,5,4,3,1],Be.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Be.GSUM=[0,348,1388,2948,3988],Be.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Be.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Be.FINDER_PAT_A=0,Be.FINDER_PAT_B=1,Be.FINDER_PAT_C=2,Be.FINDER_PAT_D=3,Be.FINDER_PAT_E=4,Be.FINDER_PAT_F=5,Be.FINDER_PATTERN_SEQUENCES=[[Be.FINDER_PAT_A,Be.FINDER_PAT_A],[Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B],[Be.FINDER_PAT_A,Be.FINDER_PAT_C,Be.FINDER_PAT_B,Be.FINDER_PAT_D],[Be.FINDER_PAT_A,Be.FINDER_PAT_E,Be.FINDER_PAT_B,Be.FINDER_PAT_D,Be.FINDER_PAT_C],[Be.FINDER_PAT_A,Be.FINDER_PAT_E,Be.FINDER_PAT_B,Be.FINDER_PAT_D,Be.FINDER_PAT_D,Be.FINDER_PAT_F],[Be.FINDER_PAT_A,Be.FINDER_PAT_E,Be.FINDER_PAT_B,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_F,Be.FINDER_PAT_F],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_D],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_E],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_F,Be.FINDER_PAT_F],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_E,Be.FINDER_PAT_F,Be.FINDER_PAT_F]],Be.MAX_PAIRS=11;class W extends Se{constructor(r,a,l){super(r,a),this.count=0,this.finderPattern=l}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Te extends re{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,a,l){const u=this.decodePair(a,!1,r,l);Te.addOrTally(this.possibleLeftPairs,u),a.reverse();let d=this.decodePair(a,!0,r,l);Te.addOrTally(this.possibleRightPairs,d),a.reverse();for(let m of this.possibleLeftPairs)if(m.getCount()>1){for(let y of this.possibleRightPairs)if(y.getCount()>1&&Te.checkChecksum(m,y))return Te.constructResult(m,y)}throw new oe}static addOrTally(r,a){if(a==null)return;let l=!1;for(let u of r)if(u.getValue()===a.getValue()){u.incrementCount(),l=!0;break}l||r.push(a)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,a){let l=4537077*r.getValue()+a.getValue(),u=new String(l).toString(),d=new G;for(let v=13-u.length;v>0;v--)d.append("0");d.append(u);let m=0;for(let v=0;v<13;v++){let I=d.charAt(v).charCodeAt(0)-48;m+=(v&1)===0?3*I:I}m=10-m%10,m===10&&(m=0),d.append(m.toString());let y=r.getFinderPattern().getResultPoints(),_=a.getFinderPattern().getResultPoints();return new Ce(d.toString(),null,0,[y[0],y[1],_[0],_[1]],me.RSS_14,new Date().getTime())}static checkChecksum(r,a){let l=(r.getChecksumPortion()+16*a.getChecksumPortion())%79,u=9*r.getFinderPattern().getValue()+a.getFinderPattern().getValue();return u>72&&u--,u>8&&u--,l===u}decodePair(r,a,l,u){try{let d=this.findFinderPattern(r,a),m=this.parseFoundFinderPattern(r,l,a,d),y=u==null?null:u.get(Qe.NEED_RESULT_POINT_CALLBACK);if(y!=null){let I=(d[0]+d[1])/2;a&&(I=r.getSize()-1-I),y.foundPossibleResultPoint(new Ie(I,l))}let _=this.decodeDataCharacter(r,m,!0),v=this.decodeDataCharacter(r,m,!1);return new W(1597*_.getValue()+v.getValue(),_.getChecksumPortion()+4*v.getChecksumPortion(),m)}catch{return null}}decodeDataCharacter(r,a,l){let u=this.getDataCharacterCounters();for(let ue=0;ue<u.length;ue++)u[ue]=0;if(l)tn.recordPatternInReverse(r,a.getStartEnd()[0],u);else{tn.recordPattern(r,a.getStartEnd()[1]+1,u);for(let ue=0,_e=u.length-1;ue<_e;ue++,_e--){let Ze=u[ue];u[ue]=u[_e],u[_e]=Ze}}let d=l?16:15,m=Ve.sum(new Int32Array(u))/d,y=this.getOddCounts(),_=this.getEvenCounts(),v=this.getOddRoundingErrors(),I=this.getEvenRoundingErrors();for(let ue=0;ue<u.length;ue++){let _e=u[ue]/m,Ze=Math.floor(_e+.5);Ze<1?Ze=1:Ze>8&&(Ze=8);let Ye=Math.floor(ue/2);(ue&1)===0?(y[Ye]=Ze,v[Ye]=_e-Ze):(_[Ye]=Ze,I[Ye]=_e-Ze)}this.adjustOddEvenCounts(l,d);let k=0,L=0;for(let ue=y.length-1;ue>=0;ue--)L*=9,L+=y[ue],k+=y[ue];let q=0,Z=0;for(let ue=_.length-1;ue>=0;ue--)q*=9,q+=_[ue],Z+=_[ue];let $=L+3*q;if(l){if((k&1)!==0||k>12||k<4)throw new oe;let ue=(12-k)/2,_e=Te.OUTSIDE_ODD_WIDEST[ue],Ze=9-_e,Ye=Xe.getRSSvalue(y,_e,!1),He=Xe.getRSSvalue(_,Ze,!0),cn=Te.OUTSIDE_EVEN_TOTAL_SUBSET[ue],Wt=Te.OUTSIDE_GSUM[ue];return new Se(Ye*cn+He+Wt,$)}else{if((Z&1)!==0||Z>10||Z<4)throw new oe;let ue=(10-Z)/2,_e=Te.INSIDE_ODD_WIDEST[ue],Ze=9-_e,Ye=Xe.getRSSvalue(y,_e,!0),He=Xe.getRSSvalue(_,Ze,!1),cn=Te.INSIDE_ODD_TOTAL_SUBSET[ue],Wt=Te.INSIDE_GSUM[ue];return new Se(He*cn+Ye+Wt,$)}}findFinderPattern(r,a){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let u=r.getSize(),d=!1,m=0;for(;m<u&&(d=!r.get(m),a!==d);)m++;let y=0,_=m;for(let v=m;v<u;v++)if(r.get(v)!==d)l[y]++;else{if(y===3){if(re.isFinderPattern(l))return[_,v];_+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,y--}else y++;l[y]=1,d=!d}throw new oe}parseFoundFinderPattern(r,a,l,u){let d=r.get(u[0]),m=u[0]-1;for(;m>=0&&d!==r.get(m);)m--;m++;const y=u[0]-m,_=this.getDecodeFinderCounters(),v=new Int32Array(_.length);ne.arraycopy(_,0,v,1,_.length-1),v[0]=y;const I=this.parseFinderValue(v,Te.FINDER_PATTERNS);let k=m,L=u[1];return l&&(k=r.getSize()-1-k,L=r.getSize()-1-L),new je(I,[m,u[1]],k,L,a)}adjustOddEvenCounts(r,a){let l=Ve.sum(new Int32Array(this.getOddCounts())),u=Ve.sum(new Int32Array(this.getEvenCounts())),d=!1,m=!1,y=!1,_=!1;r?(l>12?m=!0:l<4&&(d=!0),u>12?_=!0:u<4&&(y=!0)):(l>11?m=!0:l<5&&(d=!0),u>10?_=!0:u<4&&(y=!0));let v=l+u-a,I=(l&1)===(r?1:0),k=(u&1)===1;if(v===1)if(I){if(k)throw new oe;m=!0}else{if(!k)throw new oe;_=!0}else if(v===-1)if(I){if(k)throw new oe;d=!0}else{if(!k)throw new oe;y=!0}else if(v===0){if(I){if(!k)throw new oe;l<u?(d=!0,_=!0):(m=!0,y=!0)}else if(k)throw new oe}else throw new oe;if(d){if(m)throw new oe;re.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&re.decrement(this.getOddCounts(),this.getOddRoundingErrors()),y){if(_)throw new oe;re.increment(this.getEvenCounts(),this.getOddRoundingErrors())}_&&re.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Te.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Te.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Te.OUTSIDE_GSUM=[0,161,961,2015,2715],Te.INSIDE_GSUM=[0,336,1036,1516],Te.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Te.INSIDE_ODD_WIDEST=[2,4,6,8],Te.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Je extends tn{constructor(r,a){super(),this.readers=[],this.verbose=a===!0;const l=r?r.get(Qe.POSSIBLE_FORMATS):null,u=r&&r.get(Qe.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;l?((l.includes(me.EAN_13)||l.includes(me.UPC_A)||l.includes(me.EAN_8)||l.includes(me.UPC_E))&&this.readers.push(new nn(r)),l.includes(me.CODE_39)&&this.readers.push(new Ht(u)),l.includes(me.CODE_128)&&this.readers.push(new Fe),l.includes(me.ITF)&&this.readers.push(new At),l.includes(me.RSS_14)&&this.readers.push(new Te),l.includes(me.RSS_EXPANDED)&&this.readers.push(new Be(this.verbose))):(this.readers.push(new nn(r)),this.readers.push(new Ht),this.readers.push(new nn(r)),this.readers.push(new Fe),this.readers.push(new At),this.readers.push(new Te),this.readers.push(new Be(this.verbose)))}decodeRow(r,a,l){for(let u=0;u<this.readers.length;u++)try{return this.readers[u].decodeRow(r,a,l)}catch{}throw new oe}reset(){this.readers.forEach(r=>r.reset())}}class xt extends ve{constructor(r=500,a){super(new Je(a),r,a)}}class nt{constructor(r,a,l){this.ecCodewords=r,this.ecBlocks=[a],l&&this.ecBlocks.push(l)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class lt{constructor(r,a){this.count=r,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ft{constructor(r,a,l,u,d,m){this.versionNumber=r,this.symbolSizeRows=a,this.symbolSizeColumns=l,this.dataRegionSizeRows=u,this.dataRegionSizeColumns=d,this.ecBlocks=m;let y=0;const _=m.getECCodewords(),v=m.getECBlocks();for(let I of v)y+=I.getCount()*(I.getDataCodewords()+_);this.totalCodewords=y}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,a){if((r&1)!==0||(a&1)!==0)throw new F;for(let l of ft.VERSIONS)if(l.symbolSizeRows===r&&l.symbolSizeColumns===a)return l;throw new F}toString(){return""+this.versionNumber}static buildVersions(){return[new ft(1,10,10,8,8,new nt(5,new lt(1,3))),new ft(2,12,12,10,10,new nt(7,new lt(1,5))),new ft(3,14,14,12,12,new nt(10,new lt(1,8))),new ft(4,16,16,14,14,new nt(12,new lt(1,12))),new ft(5,18,18,16,16,new nt(14,new lt(1,18))),new ft(6,20,20,18,18,new nt(18,new lt(1,22))),new ft(7,22,22,20,20,new nt(20,new lt(1,30))),new ft(8,24,24,22,22,new nt(24,new lt(1,36))),new ft(9,26,26,24,24,new nt(28,new lt(1,44))),new ft(10,32,32,14,14,new nt(36,new lt(1,62))),new ft(11,36,36,16,16,new nt(42,new lt(1,86))),new ft(12,40,40,18,18,new nt(48,new lt(1,114))),new ft(13,44,44,20,20,new nt(56,new lt(1,144))),new ft(14,48,48,22,22,new nt(68,new lt(1,174))),new ft(15,52,52,24,24,new nt(42,new lt(2,102))),new ft(16,64,64,14,14,new nt(56,new lt(2,140))),new ft(17,72,72,16,16,new nt(36,new lt(4,92))),new ft(18,80,80,18,18,new nt(48,new lt(4,114))),new ft(19,88,88,20,20,new nt(56,new lt(4,144))),new ft(20,96,96,22,22,new nt(68,new lt(4,174))),new ft(21,104,104,24,24,new nt(56,new lt(6,136))),new ft(22,120,120,18,18,new nt(68,new lt(6,175))),new ft(23,132,132,20,20,new nt(62,new lt(8,163))),new ft(24,144,144,22,22,new nt(62,new lt(8,156),new lt(2,155))),new ft(25,8,18,6,16,new nt(7,new lt(1,5))),new ft(26,8,32,6,14,new nt(11,new lt(1,10))),new ft(27,12,26,10,24,new nt(14,new lt(1,16))),new ft(28,12,36,10,16,new nt(18,new lt(1,22))),new ft(29,16,36,14,16,new nt(24,new lt(1,32))),new ft(30,16,48,14,22,new nt(28,new lt(1,49)))]}}ft.VERSIONS=ft.buildVersions();class hn{constructor(r){const a=r.getHeight();if(a<8||a>144||(a&1)!==0)throw new F;this.version=hn.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new ot(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const a=r.getHeight(),l=r.getWidth();return ft.getVersionForDimensions(a,l)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let a=0,l=4,u=0;const d=this.mappingBitMatrix.getHeight(),m=this.mappingBitMatrix.getWidth();let y=!1,_=!1,v=!1,I=!1;do if(l===d&&u===0&&!y)r[a++]=this.readCorner1(d,m)&255,l-=2,u+=2,y=!0;else if(l===d-2&&u===0&&(m&3)!==0&&!_)r[a++]=this.readCorner2(d,m)&255,l-=2,u+=2,_=!0;else if(l===d+4&&u===2&&(m&7)===0&&!v)r[a++]=this.readCorner3(d,m)&255,l-=2,u+=2,v=!0;else if(l===d-2&&u===0&&(m&7)===4&&!I)r[a++]=this.readCorner4(d,m)&255,l-=2,u+=2,I=!0;else{do l<d&&u>=0&&!this.readMappingMatrix.get(u,l)&&(r[a++]=this.readUtah(l,u,d,m)&255),l-=2,u+=2;while(l>=0&&u<m);l+=1,u+=3;do l>=0&&u<m&&!this.readMappingMatrix.get(u,l)&&(r[a++]=this.readUtah(l,u,d,m)&255),l+=2,u-=2;while(l<d&&u>=0);l+=3,u+=1}while(l<d||u<m);if(a!==this.version.getTotalCodewords())throw new F;return r}readModule(r,a,l,u){return r<0&&(r+=l,a+=4-(l+4&7)),a<0&&(a+=u,r+=4-(u+4&7)),this.readMappingMatrix.set(a,r),this.mappingBitMatrix.get(a,r)}readUtah(r,a,l,u){let d=0;return this.readModule(r-2,a-2,l,u)&&(d|=1),d<<=1,this.readModule(r-2,a-1,l,u)&&(d|=1),d<<=1,this.readModule(r-1,a-2,l,u)&&(d|=1),d<<=1,this.readModule(r-1,a-1,l,u)&&(d|=1),d<<=1,this.readModule(r-1,a,l,u)&&(d|=1),d<<=1,this.readModule(r,a-2,l,u)&&(d|=1),d<<=1,this.readModule(r,a-1,l,u)&&(d|=1),d<<=1,this.readModule(r,a,l,u)&&(d|=1),d}readCorner1(r,a){let l=0;return this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,1,r,a)&&(l|=1),l<<=1,this.readModule(r-1,2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(2,a-1,r,a)&&(l|=1),l<<=1,this.readModule(3,a-1,r,a)&&(l|=1),l}readCorner2(r,a){let l=0;return this.readModule(r-3,0,r,a)&&(l|=1),l<<=1,this.readModule(r-2,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(0,a-4,r,a)&&(l|=1),l<<=1,this.readModule(0,a-3,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l}readCorner3(r,a){let l=0;return this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(0,a-3,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-3,r,a)&&(l|=1),l<<=1,this.readModule(1,a-2,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l}readCorner4(r,a){let l=0;return this.readModule(r-3,0,r,a)&&(l|=1),l<<=1,this.readModule(r-2,0,r,a)&&(l|=1),l<<=1,this.readModule(r-1,0,r,a)&&(l|=1),l<<=1,this.readModule(0,a-2,r,a)&&(l|=1),l<<=1,this.readModule(0,a-1,r,a)&&(l|=1),l<<=1,this.readModule(1,a-1,r,a)&&(l|=1),l<<=1,this.readModule(2,a-1,r,a)&&(l|=1),l<<=1,this.readModule(3,a-1,r,a)&&(l|=1),l}extractDataRegion(r){const a=this.version.getSymbolSizeRows(),l=this.version.getSymbolSizeColumns();if(r.getHeight()!==a)throw new N("Dimension of bitMatrix must match the version size");const u=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),m=a/u|0,y=l/d|0,_=m*u,v=y*d,I=new ot(v,_);for(let k=0;k<m;++k){const L=k*u;for(let q=0;q<y;++q){const Z=q*d;for(let $=0;$<u;++$){const ue=k*(u+2)+1+$,_e=L+$;for(let Ze=0;Ze<d;++Ze){const Ye=q*(d+2)+1+Ze;if(r.get(Ye,ue)){const He=Z+Ze;I.set(He,_e)}}}}}return I}}class dn{constructor(r,a){this.numDataCodewords=r,this.codewords=a}static getDataBlocks(r,a){const l=a.getECBlocks();let u=0;const d=l.getECBlocks();for(let $ of d)u+=$.getCount();const m=new Array(u);let y=0;for(let $ of d)for(let ue=0;ue<$.getCount();ue++){const _e=$.getDataCodewords(),Ze=l.getECCodewords()+_e;m[y++]=new dn(_e,new Uint8Array(Ze))}const v=m[0].codewords.length-l.getECCodewords(),I=v-1;let k=0;for(let $=0;$<I;$++)for(let ue=0;ue<y;ue++)m[ue].codewords[$]=r[k++];const L=a.getVersionNumber()===24,q=L?8:y;for(let $=0;$<q;$++)m[$].codewords[v-1]=r[k++];const Z=m[0].codewords.length;for(let $=v;$<Z;$++)for(let ue=0;ue<y;ue++){const _e=L?(ue+8)%y:ue,Ze=L&&_e>7?$-1:$;m[_e].codewords[Ze]=r[k++]}if(k!==r.length)throw new N;return m}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class In{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new N(""+r);let a=0,l=this.bitOffset,u=this.byteOffset;const d=this.bytes;if(l>0){const m=8-l,y=r<m?r:m,_=m-y,v=255>>8-y<<_;a=(d[u]&v)>>_,r-=y,l+=y,l===8&&(l=0,u++)}if(r>0){for(;r>=8;)a=a<<8|d[u]&255,u++,r-=8;if(r>0){const m=8-r,y=255>>m<<m;a=a<<r|(d[u]&y)>>m,l+=r}}return this.bitOffset=l,this.byteOffset=u,a}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var jt;(function(M){M[M.PAD_ENCODE=0]="PAD_ENCODE",M[M.ASCII_ENCODE=1]="ASCII_ENCODE",M[M.C40_ENCODE=2]="C40_ENCODE",M[M.TEXT_ENCODE=3]="TEXT_ENCODE",M[M.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",M[M.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",M[M.BASE256_ENCODE=6]="BASE256_ENCODE"})(jt||(jt={}));class kn{static decode(r){const a=new In(r),l=new G,u=new G,d=new Array;let m=jt.ASCII_ENCODE;do if(m===jt.ASCII_ENCODE)m=this.decodeAsciiSegment(a,l,u);else{switch(m){case jt.C40_ENCODE:this.decodeC40Segment(a,l);break;case jt.TEXT_ENCODE:this.decodeTextSegment(a,l);break;case jt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(a,l);break;case jt.EDIFACT_ENCODE:this.decodeEdifactSegment(a,l);break;case jt.BASE256_ENCODE:this.decodeBase256Segment(a,l,d);break;default:throw new F}m=jt.ASCII_ENCODE}while(m!==jt.PAD_ENCODE&&a.available()>0);return u.length()>0&&l.append(u.toString()),new Ct(r,l.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(r,a,l){let u=!1;do{let d=r.readBits(8);if(d===0)throw new F;if(d<=128)return u&&(d+=128),a.append(String.fromCharCode(d-1)),jt.ASCII_ENCODE;if(d===129)return jt.PAD_ENCODE;if(d<=229){const m=d-130;m<10&&a.append("0"),a.append(""+m)}else switch(d){case 230:return jt.C40_ENCODE;case 231:return jt.BASE256_ENCODE;case 232:a.append("");break;case 233:case 234:break;case 235:u=!0;break;case 236:a.append("[)>05"),l.insert(0,"");break;case 237:a.append("[)>06"),l.insert(0,"");break;case 238:return jt.ANSIX12_ENCODE;case 239:return jt.TEXT_ENCODE;case 240:return jt.EDIFACT_ENCODE;case 241:break;default:if(d!==254||r.available()!==0)throw new F;break}}while(r.available()>0);return jt.ASCII_ENCODE}static decodeC40Segment(r,a){let l=!1;const u=[];let d=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),u);for(let y=0;y<3;y++){const _=u[y];switch(d){case 0:if(_<3)d=_+1;else if(_<this.C40_BASIC_SET_CHARS.length){const v=this.C40_BASIC_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else throw new F;break;case 1:l?(a.append(String.fromCharCode(_+128)),l=!1):a.append(String.fromCharCode(_)),d=0;break;case 2:if(_<this.C40_SHIFT2_SET_CHARS.length){const v=this.C40_SHIFT2_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else switch(_){case 27:a.append("");break;case 30:l=!0;break;default:throw new F}d=0;break;case 3:l?(a.append(String.fromCharCode(_+224)),l=!1):a.append(String.fromCharCode(_+96)),d=0;break;default:throw new F}}}while(r.available()>0)}static decodeTextSegment(r,a){let l=!1,u=[],d=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),u);for(let y=0;y<3;y++){const _=u[y];switch(d){case 0:if(_<3)d=_+1;else if(_<this.TEXT_BASIC_SET_CHARS.length){const v=this.TEXT_BASIC_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else throw new F;break;case 1:l?(a.append(String.fromCharCode(_+128)),l=!1):a.append(String.fromCharCode(_)),d=0;break;case 2:if(_<this.TEXT_SHIFT2_SET_CHARS.length){const v=this.TEXT_SHIFT2_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v)}else switch(_){case 27:a.append("");break;case 30:l=!0;break;default:throw new F}d=0;break;case 3:if(_<this.TEXT_SHIFT3_SET_CHARS.length){const v=this.TEXT_SHIFT3_SET_CHARS[_];l?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),l=!1):a.append(v),d=0}else throw new F;break;default:throw new F}}}while(r.available()>0)}static decodeAnsiX12Segment(r,a){const l=[];do{if(r.available()===8)return;const u=r.readBits(8);if(u===254)return;this.parseTwoBytes(u,r.readBits(8),l);for(let d=0;d<3;d++){const m=l[d];switch(m){case 0:a.append("\r");break;case 1:a.append("*");break;case 2:a.append(">");break;case 3:a.append(" ");break;default:if(m<14)a.append(String.fromCharCode(m+44));else if(m<40)a.append(String.fromCharCode(m+51));else throw new F;break}}}while(r.available()>0)}static parseTwoBytes(r,a,l){let u=(r<<8)+a-1,d=Math.floor(u/1600);l[0]=d,u-=d*1600,d=Math.floor(u/40),l[1]=d,l[2]=u-d*40}static decodeEdifactSegment(r,a){do{if(r.available()<=16)return;for(let l=0;l<4;l++){let u=r.readBits(6);if(u===31){const d=8-r.getBitOffset();d!==8&&r.readBits(d);return}(u&32)===0&&(u|=64),a.append(String.fromCharCode(u))}}while(r.available()>0)}static decodeBase256Segment(r,a,l){let u=1+r.getByteOffset();const d=this.unrandomize255State(r.readBits(8),u++);let m;if(d===0?m=r.available()/8|0:d<250?m=d:m=250*(d-249)+this.unrandomize255State(r.readBits(8),u++),m<0)throw new F;const y=new Uint8Array(m);for(let _=0;_<m;_++){if(r.available()<8)throw new F;y[_]=this.unrandomize255State(r.readBits(8),u++)}l.push(y);try{a.append(X.decode(y,Y.ISO88591))}catch(_){throw new On("Platform does not support required encoding: "+_.message)}}static unrandomize255State(r,a){const l=149*a%255+1,u=r-l;return u>=0?u:u+256}}kn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],kn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],kn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],kn.TEXT_SHIFT2_SET_CHARS=kn.C40_SHIFT2_SET_CHARS,kn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Pi{constructor(){this.rsDecoder=new Me(Ot.DATA_MATRIX_FIELD_256)}decode(r){const a=new hn(r),l=a.getVersion(),u=a.readCodewords(),d=dn.getDataBlocks(u,l);let m=0;for(let v of d)m+=v.getNumDataCodewords();const y=new Uint8Array(m),_=d.length;for(let v=0;v<_;v++){const I=d[v],k=I.getCodewords(),L=I.getNumDataCodewords();this.correctErrors(k,L);for(let q=0;q<L;q++)y[q*_+v]=k[q]}return kn.decode(y)}correctErrors(r,a){const l=new Int32Array(r);try{this.rsDecoder.decode(l,r.length-a)}catch{throw new B}for(let u=0;u<a;u++)r[u]=l[u]}}class Nt{constructor(r){this.image=r,this.rectangleDetector=new ht(this.image)}detect(){const r=this.rectangleDetector.detect();let a=this.detectSolid1(r);if(a=this.detectSolid2(a),a[3]=this.correctTopRight(a),!a[3])throw new oe;a=this.shiftToModuleCenter(a);const l=a[0],u=a[1],d=a[2],m=a[3];let y=this.transitionsBetween(l,m)+1,_=this.transitionsBetween(d,m)+1;(y&1)===1&&(y+=1),(_&1)===1&&(_+=1),4*y<7*_&&4*_<7*y&&(y=_=Math.max(y,_));let v=Nt.sampleGrid(this.image,l,u,d,m,y,_);return new Pt(v,[l,u,d,m])}static shiftPoint(r,a,l){let u=(a.getX()-r.getX())/(l+1),d=(a.getY()-r.getY())/(l+1);return new Ie(r.getX()+u,r.getY()+d)}static moveAway(r,a,l){let u=r.getX(),d=r.getY();return u<a?u-=1:u+=1,d<l?d-=1:d+=1,new Ie(u,d)}detectSolid1(r){let a=r[0],l=r[1],u=r[3],d=r[2],m=this.transitionsBetween(a,l),y=this.transitionsBetween(l,u),_=this.transitionsBetween(u,d),v=this.transitionsBetween(d,a),I=m,k=[d,a,l,u];return I>y&&(I=y,k[0]=a,k[1]=l,k[2]=u,k[3]=d),I>_&&(I=_,k[0]=l,k[1]=u,k[2]=d,k[3]=a),I>v&&(k[0]=u,k[1]=d,k[2]=a,k[3]=l),k}detectSolid2(r){let a=r[0],l=r[1],u=r[2],d=r[3],m=this.transitionsBetween(a,d),y=Nt.shiftPoint(l,u,(m+1)*4),_=Nt.shiftPoint(u,l,(m+1)*4),v=this.transitionsBetween(y,a),I=this.transitionsBetween(_,d);return v<I?(r[0]=a,r[1]=l,r[2]=u,r[3]=d):(r[0]=l,r[1]=u,r[2]=d,r[3]=a),r}correctTopRight(r){let a=r[0],l=r[1],u=r[2],d=r[3],m=this.transitionsBetween(a,d),y=this.transitionsBetween(l,d),_=Nt.shiftPoint(a,l,(y+1)*4),v=Nt.shiftPoint(u,l,(m+1)*4);m=this.transitionsBetween(_,d),y=this.transitionsBetween(v,d);let I=new Ie(d.getX()+(u.getX()-l.getX())/(m+1),d.getY()+(u.getY()-l.getY())/(m+1)),k=new Ie(d.getX()+(a.getX()-l.getX())/(y+1),d.getY()+(a.getY()-l.getY())/(y+1));if(!this.isValid(I))return this.isValid(k)?k:null;if(!this.isValid(k))return I;let L=this.transitionsBetween(_,I)+this.transitionsBetween(v,I),q=this.transitionsBetween(_,k)+this.transitionsBetween(v,k);return L>q?I:k}shiftToModuleCenter(r){let a=r[0],l=r[1],u=r[2],d=r[3],m=this.transitionsBetween(a,d)+1,y=this.transitionsBetween(u,d)+1,_=Nt.shiftPoint(a,l,y*4),v=Nt.shiftPoint(u,l,m*4);m=this.transitionsBetween(_,d)+1,y=this.transitionsBetween(v,d)+1,(m&1)===1&&(m+=1),(y&1)===1&&(y+=1);let I=(a.getX()+l.getX()+u.getX()+d.getX())/4,k=(a.getY()+l.getY()+u.getY()+d.getY())/4;a=Nt.moveAway(a,I,k),l=Nt.moveAway(l,I,k),u=Nt.moveAway(u,I,k),d=Nt.moveAway(d,I,k);let L,q;return _=Nt.shiftPoint(a,l,y*4),_=Nt.shiftPoint(_,d,m*4),L=Nt.shiftPoint(l,a,y*4),L=Nt.shiftPoint(L,u,m*4),v=Nt.shiftPoint(u,d,y*4),v=Nt.shiftPoint(v,l,m*4),q=Nt.shiftPoint(d,u,y*4),q=Nt.shiftPoint(q,a,m*4),[_,L,v,q]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,a,l,u,d,m,y){return lr.getInstance().sampleGrid(r,m,y,.5,.5,m-.5,.5,m-.5,y-.5,.5,y-.5,a.getX(),a.getY(),d.getX(),d.getY(),u.getX(),u.getY(),l.getX(),l.getY())}transitionsBetween(r,a){let l=Math.trunc(r.getX()),u=Math.trunc(r.getY()),d=Math.trunc(a.getX()),m=Math.trunc(a.getY()),y=Math.abs(m-u)>Math.abs(d-l);if(y){let $=l;l=u,u=$,$=d,d=m,m=$}let _=Math.abs(d-l),v=Math.abs(m-u),I=-_/2,k=u<m?1:-1,L=l<d?1:-1,q=0,Z=this.image.get(y?u:l,y?l:u);for(let $=l,ue=u;$!==d;$+=L){let _e=this.image.get(y?ue:$,y?$:ue);if(_e!==Z&&(q++,Z=_e),I+=v,I>0){if(ue===m)break;ue+=k,I-=_}}return q}}class tr{constructor(){this.decoder=new Pi}decode(r,a=null){let l,u;if(a!=null&&a.has(Qe.PURE_BARCODE)){const v=tr.extractPureBits(r.getBlackMatrix());l=this.decoder.decode(v),u=tr.NO_POINTS}else{const v=new Nt(r.getBlackMatrix()).detect();l=this.decoder.decode(v.getBits()),u=v.getPoints()}const d=l.getRawBytes(),m=new Ce(l.getText(),d,8*d.length,u,me.DATA_MATRIX,ne.currentTimeMillis()),y=l.getByteSegments();y!=null&&m.putMetadata(mt.BYTE_SEGMENTS,y);const _=l.getECLevel();return _!=null&&m.putMetadata(mt.ERROR_CORRECTION_LEVEL,_),m}reset(){}static extractPureBits(r){const a=r.getTopLeftOnBit(),l=r.getBottomRightOnBit();if(a==null||l==null)throw new oe;const u=this.moduleSize(a,r);let d=a[1];const m=l[1];let y=a[0];const v=(l[0]-y+1)/u,I=(m-d+1)/u;if(v<=0||I<=0)throw new oe;const k=u/2;d+=k,y+=k;const L=new ot(v,I);for(let q=0;q<I;q++){const Z=d+q*u;for(let $=0;$<v;$++)r.get(y+$*u,Z)&&L.set($,q)}return L}static moduleSize(r,a){const l=a.getWidth();let u=r[0];const d=r[1];for(;u<l&&a.get(u,d);)u++;if(u===l)throw new oe;const m=u-r[0];if(m===0)throw new oe;return m}}tr.NO_POINTS=[];class Cr extends ve{constructor(r=500){super(new tr,r)}}var gi;(function(M){M[M.L=0]="L",M[M.M=1]="M",M[M.Q=2]="Q",M[M.H=3]="H"})(gi||(gi={}));class on{constructor(r,a,l){this.value=r,this.stringValue=a,this.bits=l,on.FOR_BITS.set(l,this),on.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return on.L;case"M":return on.M;case"Q":return on.Q;case"H":return on.H;default:throw new C(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof on))return!1;const a=r;return this.value===a.value}static forBits(r){if(r<0||r>=on.FOR_BITS.size)throw new N;return on.FOR_BITS.get(r)}}on.FOR_BITS=new Map,on.FOR_VALUE=new Map,on.L=new on(gi.L,"L",1),on.M=new on(gi.M,"M",0),on.Q=new on(gi.Q,"Q",3),on.H=new on(gi.H,"H",2);class Er{constructor(r){this.errorCorrectionLevel=on.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,a){return fe.bitCount(r^a)}static decodeFormatInformation(r,a){const l=Er.doDecodeFormatInformation(r,a);return l!==null?l:Er.doDecodeFormatInformation(r^Er.FORMAT_INFO_MASK_QR,a^Er.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,a){let l=Number.MAX_SAFE_INTEGER,u=0;for(const d of Er.FORMAT_INFO_DECODE_LOOKUP){const m=d[0];if(m===r||m===a)return new Er(d[1]);let y=Er.numBitsDiffering(r,m);y<l&&(u=d[1],l=y),r!==a&&(y=Er.numBitsDiffering(a,m),y<l&&(u=d[1],l=y))}return l<=3?new Er(u):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof Er))return!1;const a=r;return this.errorCorrectionLevel===a.errorCorrectionLevel&&this.dataMask===a.dataMask}}Er.FORMAT_INFO_MASK_QR=21522,Er.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class de{constructor(r,...a){this.ecCodewordsPerBlock=r,this.ecBlocks=a}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const a=this.ecBlocks;for(const l of a)r+=l.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class H{constructor(r,a){this.count=r,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class bt{constructor(r,a,...l){this.versionNumber=r,this.alignmentPatternCenters=a,this.ecBlocks=l;let u=0;const d=l[0].getECCodewordsPerBlock(),m=l[0].getECBlocks();for(const y of m)u+=y.getCount()*(y.getDataCodewords()+d);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new F;try{return this.getVersionForNumber((r-17)/4)}catch{throw new F}}static getVersionForNumber(r){if(r<1||r>40)throw new N;return bt.VERSIONS[r-1]}static decodeVersionInformation(r){let a=Number.MAX_SAFE_INTEGER,l=0;for(let u=0;u<bt.VERSION_DECODE_INFO.length;u++){const d=bt.VERSION_DECODE_INFO[u];if(d===r)return bt.getVersionForNumber(u+7);const m=Er.numBitsDiffering(r,d);m<a&&(l=u+7,a=m)}return a<=3?bt.getVersionForNumber(l):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),a=new ot(r);a.setRegion(0,0,9,9),a.setRegion(r-8,0,8,9),a.setRegion(0,r-8,9,8);const l=this.alignmentPatternCenters.length;for(let u=0;u<l;u++){const d=this.alignmentPatternCenters[u]-2;for(let m=0;m<l;m++)u===0&&(m===0||m===l-1)||u===l-1&&m===0||a.setRegion(this.alignmentPatternCenters[m]-2,d,5,5)}return a.setRegion(6,9,1,r-17),a.setRegion(9,6,r-17,1),this.versionNumber>6&&(a.setRegion(r-11,0,3,6),a.setRegion(0,r-11,6,3)),a}toString(){return""+this.versionNumber}}bt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),bt.VERSIONS=[new bt(1,new Int32Array(0),new de(7,new H(1,19)),new de(10,new H(1,16)),new de(13,new H(1,13)),new de(17,new H(1,9))),new bt(2,Int32Array.from([6,18]),new de(10,new H(1,34)),new de(16,new H(1,28)),new de(22,new H(1,22)),new de(28,new H(1,16))),new bt(3,Int32Array.from([6,22]),new de(15,new H(1,55)),new de(26,new H(1,44)),new de(18,new H(2,17)),new de(22,new H(2,13))),new bt(4,Int32Array.from([6,26]),new de(20,new H(1,80)),new de(18,new H(2,32)),new de(26,new H(2,24)),new de(16,new H(4,9))),new bt(5,Int32Array.from([6,30]),new de(26,new H(1,108)),new de(24,new H(2,43)),new de(18,new H(2,15),new H(2,16)),new de(22,new H(2,11),new H(2,12))),new bt(6,Int32Array.from([6,34]),new de(18,new H(2,68)),new de(16,new H(4,27)),new de(24,new H(4,19)),new de(28,new H(4,15))),new bt(7,Int32Array.from([6,22,38]),new de(20,new H(2,78)),new de(18,new H(4,31)),new de(18,new H(2,14),new H(4,15)),new de(26,new H(4,13),new H(1,14))),new bt(8,Int32Array.from([6,24,42]),new de(24,new H(2,97)),new de(22,new H(2,38),new H(2,39)),new de(22,new H(4,18),new H(2,19)),new de(26,new H(4,14),new H(2,15))),new bt(9,Int32Array.from([6,26,46]),new de(30,new H(2,116)),new de(22,new H(3,36),new H(2,37)),new de(20,new H(4,16),new H(4,17)),new de(24,new H(4,12),new H(4,13))),new bt(10,Int32Array.from([6,28,50]),new de(18,new H(2,68),new H(2,69)),new de(26,new H(4,43),new H(1,44)),new de(24,new H(6,19),new H(2,20)),new de(28,new H(6,15),new H(2,16))),new bt(11,Int32Array.from([6,30,54]),new de(20,new H(4,81)),new de(30,new H(1,50),new H(4,51)),new de(28,new H(4,22),new H(4,23)),new de(24,new H(3,12),new H(8,13))),new bt(12,Int32Array.from([6,32,58]),new de(24,new H(2,92),new H(2,93)),new de(22,new H(6,36),new H(2,37)),new de(26,new H(4,20),new H(6,21)),new de(28,new H(7,14),new H(4,15))),new bt(13,Int32Array.from([6,34,62]),new de(26,new H(4,107)),new de(22,new H(8,37),new H(1,38)),new de(24,new H(8,20),new H(4,21)),new de(22,new H(12,11),new H(4,12))),new bt(14,Int32Array.from([6,26,46,66]),new de(30,new H(3,115),new H(1,116)),new de(24,new H(4,40),new H(5,41)),new de(20,new H(11,16),new H(5,17)),new de(24,new H(11,12),new H(5,13))),new bt(15,Int32Array.from([6,26,48,70]),new de(22,new H(5,87),new H(1,88)),new de(24,new H(5,41),new H(5,42)),new de(30,new H(5,24),new H(7,25)),new de(24,new H(11,12),new H(7,13))),new bt(16,Int32Array.from([6,26,50,74]),new de(24,new H(5,98),new H(1,99)),new de(28,new H(7,45),new H(3,46)),new de(24,new H(15,19),new H(2,20)),new de(30,new H(3,15),new H(13,16))),new bt(17,Int32Array.from([6,30,54,78]),new de(28,new H(1,107),new H(5,108)),new de(28,new H(10,46),new H(1,47)),new de(28,new H(1,22),new H(15,23)),new de(28,new H(2,14),new H(17,15))),new bt(18,Int32Array.from([6,30,56,82]),new de(30,new H(5,120),new H(1,121)),new de(26,new H(9,43),new H(4,44)),new de(28,new H(17,22),new H(1,23)),new de(28,new H(2,14),new H(19,15))),new bt(19,Int32Array.from([6,30,58,86]),new de(28,new H(3,113),new H(4,114)),new de(26,new H(3,44),new H(11,45)),new de(26,new H(17,21),new H(4,22)),new de(26,new H(9,13),new H(16,14))),new bt(20,Int32Array.from([6,34,62,90]),new de(28,new H(3,107),new H(5,108)),new de(26,new H(3,41),new H(13,42)),new de(30,new H(15,24),new H(5,25)),new de(28,new H(15,15),new H(10,16))),new bt(21,Int32Array.from([6,28,50,72,94]),new de(28,new H(4,116),new H(4,117)),new de(26,new H(17,42)),new de(28,new H(17,22),new H(6,23)),new de(30,new H(19,16),new H(6,17))),new bt(22,Int32Array.from([6,26,50,74,98]),new de(28,new H(2,111),new H(7,112)),new de(28,new H(17,46)),new de(30,new H(7,24),new H(16,25)),new de(24,new H(34,13))),new bt(23,Int32Array.from([6,30,54,78,102]),new de(30,new H(4,121),new H(5,122)),new de(28,new H(4,47),new H(14,48)),new de(30,new H(11,24),new H(14,25)),new de(30,new H(16,15),new H(14,16))),new bt(24,Int32Array.from([6,28,54,80,106]),new de(30,new H(6,117),new H(4,118)),new de(28,new H(6,45),new H(14,46)),new de(30,new H(11,24),new H(16,25)),new de(30,new H(30,16),new H(2,17))),new bt(25,Int32Array.from([6,32,58,84,110]),new de(26,new H(8,106),new H(4,107)),new de(28,new H(8,47),new H(13,48)),new de(30,new H(7,24),new H(22,25)),new de(30,new H(22,15),new H(13,16))),new bt(26,Int32Array.from([6,30,58,86,114]),new de(28,new H(10,114),new H(2,115)),new de(28,new H(19,46),new H(4,47)),new de(28,new H(28,22),new H(6,23)),new de(30,new H(33,16),new H(4,17))),new bt(27,Int32Array.from([6,34,62,90,118]),new de(30,new H(8,122),new H(4,123)),new de(28,new H(22,45),new H(3,46)),new de(30,new H(8,23),new H(26,24)),new de(30,new H(12,15),new H(28,16))),new bt(28,Int32Array.from([6,26,50,74,98,122]),new de(30,new H(3,117),new H(10,118)),new de(28,new H(3,45),new H(23,46)),new de(30,new H(4,24),new H(31,25)),new de(30,new H(11,15),new H(31,16))),new bt(29,Int32Array.from([6,30,54,78,102,126]),new de(30,new H(7,116),new H(7,117)),new de(28,new H(21,45),new H(7,46)),new de(30,new H(1,23),new H(37,24)),new de(30,new H(19,15),new H(26,16))),new bt(30,Int32Array.from([6,26,52,78,104,130]),new de(30,new H(5,115),new H(10,116)),new de(28,new H(19,47),new H(10,48)),new de(30,new H(15,24),new H(25,25)),new de(30,new H(23,15),new H(25,16))),new bt(31,Int32Array.from([6,30,56,82,108,134]),new de(30,new H(13,115),new H(3,116)),new de(28,new H(2,46),new H(29,47)),new de(30,new H(42,24),new H(1,25)),new de(30,new H(23,15),new H(28,16))),new bt(32,Int32Array.from([6,34,60,86,112,138]),new de(30,new H(17,115)),new de(28,new H(10,46),new H(23,47)),new de(30,new H(10,24),new H(35,25)),new de(30,new H(19,15),new H(35,16))),new bt(33,Int32Array.from([6,30,58,86,114,142]),new de(30,new H(17,115),new H(1,116)),new de(28,new H(14,46),new H(21,47)),new de(30,new H(29,24),new H(19,25)),new de(30,new H(11,15),new H(46,16))),new bt(34,Int32Array.from([6,34,62,90,118,146]),new de(30,new H(13,115),new H(6,116)),new de(28,new H(14,46),new H(23,47)),new de(30,new H(44,24),new H(7,25)),new de(30,new H(59,16),new H(1,17))),new bt(35,Int32Array.from([6,30,54,78,102,126,150]),new de(30,new H(12,121),new H(7,122)),new de(28,new H(12,47),new H(26,48)),new de(30,new H(39,24),new H(14,25)),new de(30,new H(22,15),new H(41,16))),new bt(36,Int32Array.from([6,24,50,76,102,128,154]),new de(30,new H(6,121),new H(14,122)),new de(28,new H(6,47),new H(34,48)),new de(30,new H(46,24),new H(10,25)),new de(30,new H(2,15),new H(64,16))),new bt(37,Int32Array.from([6,28,54,80,106,132,158]),new de(30,new H(17,122),new H(4,123)),new de(28,new H(29,46),new H(14,47)),new de(30,new H(49,24),new H(10,25)),new de(30,new H(24,15),new H(46,16))),new bt(38,Int32Array.from([6,32,58,84,110,136,162]),new de(30,new H(4,122),new H(18,123)),new de(28,new H(13,46),new H(32,47)),new de(30,new H(48,24),new H(14,25)),new de(30,new H(42,15),new H(32,16))),new bt(39,Int32Array.from([6,26,54,82,110,138,166]),new de(30,new H(20,117),new H(4,118)),new de(28,new H(40,47),new H(7,48)),new de(30,new H(43,24),new H(22,25)),new de(30,new H(10,15),new H(67,16))),new bt(40,Int32Array.from([6,30,58,86,114,142,170]),new de(30,new H(19,118),new H(6,119)),new de(28,new H(18,47),new H(31,48)),new de(30,new H(34,24),new H(34,25)),new de(30,new H(20,15),new H(61,16)))];var wr;(function(M){M[M.DATA_MASK_000=0]="DATA_MASK_000",M[M.DATA_MASK_001=1]="DATA_MASK_001",M[M.DATA_MASK_010=2]="DATA_MASK_010",M[M.DATA_MASK_011=3]="DATA_MASK_011",M[M.DATA_MASK_100=4]="DATA_MASK_100",M[M.DATA_MASK_101=5]="DATA_MASK_101",M[M.DATA_MASK_110=6]="DATA_MASK_110",M[M.DATA_MASK_111=7]="DATA_MASK_111"})(wr||(wr={}));class Lr{constructor(r,a){this.value=r,this.isMasked=a}unmaskBitMatrix(r,a){for(let l=0;l<a;l++)for(let u=0;u<a;u++)this.isMasked(l,u)&&r.flip(u,l)}}Lr.values=new Map([[wr.DATA_MASK_000,new Lr(wr.DATA_MASK_000,(M,r)=>(M+r&1)===0)],[wr.DATA_MASK_001,new Lr(wr.DATA_MASK_001,(M,r)=>(M&1)===0)],[wr.DATA_MASK_010,new Lr(wr.DATA_MASK_010,(M,r)=>r%3===0)],[wr.DATA_MASK_011,new Lr(wr.DATA_MASK_011,(M,r)=>(M+r)%3===0)],[wr.DATA_MASK_100,new Lr(wr.DATA_MASK_100,(M,r)=>(Math.floor(M/2)+Math.floor(r/3)&1)===0)],[wr.DATA_MASK_101,new Lr(wr.DATA_MASK_101,(M,r)=>M*r%6===0)],[wr.DATA_MASK_110,new Lr(wr.DATA_MASK_110,(M,r)=>M*r%6<3)],[wr.DATA_MASK_111,new Lr(wr.DATA_MASK_111,(M,r)=>(M+r+M*r%3&1)===0)]]);class mi{constructor(r){const a=r.getHeight();if(a<21||(a&3)!==1)throw new F;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let d=0;d<6;d++)r=this.copyBit(d,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let d=5;d>=0;d--)r=this.copyBit(8,d,r);const a=this.bitMatrix.getHeight();let l=0;const u=a-7;for(let d=a-1;d>=u;d--)l=this.copyBit(8,d,l);for(let d=a-8;d<a;d++)l=this.copyBit(d,8,l);if(this.parsedFormatInfo=Er.decodeFormatInformation(r,l),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new F}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),a=Math.floor((r-17)/4);if(a<=6)return bt.getVersionForNumber(a);let l=0;const u=r-11;for(let m=5;m>=0;m--)for(let y=r-9;y>=u;y--)l=this.copyBit(y,m,l);let d=bt.decodeVersionInformation(l);if(d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;l=0;for(let m=5;m>=0;m--)for(let y=r-9;y>=u;y--)l=this.copyBit(m,y,l);if(d=bt.decodeVersionInformation(l),d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;throw new F}copyBit(r,a,l){return(this.isMirror?this.bitMatrix.get(a,r):this.bitMatrix.get(r,a))?l<<1|1:l<<1}readCodewords(){const r=this.readFormatInformation(),a=this.readVersion(),l=Lr.values.get(r.getDataMask()),u=this.bitMatrix.getHeight();l.unmaskBitMatrix(this.bitMatrix,u);const d=a.buildFunctionPattern();let m=!0;const y=new Uint8Array(a.getTotalCodewords());let _=0,v=0,I=0;for(let k=u-1;k>0;k-=2){k===6&&k--;for(let L=0;L<u;L++){const q=m?u-1-L:L;for(let Z=0;Z<2;Z++)d.get(k-Z,q)||(I++,v<<=1,this.bitMatrix.get(k-Z,q)&&(v|=1),I===8&&(y[_++]=v,I=0,v=0))}m=!m}if(_!==a.getTotalCodewords())throw new F;return y}remask(){if(this.parsedFormatInfo===null)return;const r=Lr.values[this.parsedFormatInfo.getDataMask()],a=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,a)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let a=0,l=r.getWidth();a<l;a++)for(let u=a+1,d=r.getHeight();u<d;u++)r.get(a,u)!==r.get(u,a)&&(r.flip(u,a),r.flip(a,u))}}class Ha{constructor(r,a){this.numDataCodewords=r,this.codewords=a}static getDataBlocks(r,a,l){if(r.length!==a.getTotalCodewords())throw new N;const u=a.getECBlocksForLevel(l);let d=0;const m=u.getECBlocks();for(const Z of m)d+=Z.getCount();const y=new Array(d);let _=0;for(const Z of m)for(let $=0;$<Z.getCount();$++){const ue=Z.getDataCodewords(),_e=u.getECCodewordsPerBlock()+ue;y[_++]=new Ha(ue,new Uint8Array(_e))}const v=y[0].codewords.length;let I=y.length-1;for(;I>=0&&y[I].codewords.length!==v;)I--;I++;const k=v-u.getECCodewordsPerBlock();let L=0;for(let Z=0;Z<k;Z++)for(let $=0;$<_;$++)y[$].codewords[Z]=r[L++];for(let Z=I;Z<_;Z++)y[Z].codewords[k]=r[L++];const q=y[0].codewords.length;for(let Z=k;Z<q;Z++)for(let $=0;$<_;$++){const ue=$<I?Z:Z+1;y[$].codewords[ue]=r[L++]}return y}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var $r;(function(M){M[M.TERMINATOR=0]="TERMINATOR",M[M.NUMERIC=1]="NUMERIC",M[M.ALPHANUMERIC=2]="ALPHANUMERIC",M[M.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",M[M.BYTE=4]="BYTE",M[M.ECI=5]="ECI",M[M.KANJI=6]="KANJI",M[M.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",M[M.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",M[M.HANZI=9]="HANZI"})($r||($r={}));class St{constructor(r,a,l,u){this.value=r,this.stringValue=a,this.characterCountBitsForVersions=l,this.bits=u,St.FOR_BITS.set(u,this),St.FOR_VALUE.set(r,this)}static forBits(r){const a=St.FOR_BITS.get(r);if(a===void 0)throw new N;return a}getCharacterCountBits(r){const a=r.getVersionNumber();let l;return a<=9?l=0:a<=26?l=1:l=2,this.characterCountBitsForVersions[l]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof St))return!1;const a=r;return this.value===a.value}toString(){return this.stringValue}}St.FOR_BITS=new Map,St.FOR_VALUE=new Map,St.TERMINATOR=new St($r.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),St.NUMERIC=new St($r.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),St.ALPHANUMERIC=new St($r.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),St.STRUCTURED_APPEND=new St($r.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),St.BYTE=new St($r.BYTE,"BYTE",Int32Array.from([8,16,16]),4),St.ECI=new St($r.ECI,"ECI",Int32Array.from([0,0,0]),7),St.KANJI=new St($r.KANJI,"KANJI",Int32Array.from([8,10,12]),8),St.FNC1_FIRST_POSITION=new St($r.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),St.FNC1_SECOND_POSITION=new St($r.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),St.HANZI=new St($r.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class zn{static decode(r,a,l,u){const d=new In(r);let m=new G;const y=new Array;let _=-1,v=-1;try{let I=null,k=!1,L;do{if(d.available()<4)L=St.TERMINATOR;else{const q=d.readBits(4);L=St.forBits(q)}switch(L){case St.TERMINATOR:break;case St.FNC1_FIRST_POSITION:case St.FNC1_SECOND_POSITION:k=!0;break;case St.STRUCTURED_APPEND:if(d.available()<16)throw new F;_=d.readBits(8),v=d.readBits(8);break;case St.ECI:const q=zn.parseECIValue(d);if(I=U.getCharacterSetECIByValue(q),I===null)throw new F;break;case St.HANZI:const Z=d.readBits(4),$=d.readBits(L.getCharacterCountBits(a));Z===zn.GB2312_SUBSET&&zn.decodeHanziSegment(d,m,$);break;default:const ue=d.readBits(L.getCharacterCountBits(a));switch(L){case St.NUMERIC:zn.decodeNumericSegment(d,m,ue);break;case St.ALPHANUMERIC:zn.decodeAlphanumericSegment(d,m,ue,k);break;case St.BYTE:zn.decodeByteSegment(d,m,ue,I,y,u);break;case St.KANJI:zn.decodeKanjiSegment(d,m,ue);break;default:throw new F}break}}while(L!==St.TERMINATOR)}catch{throw new F}return new Ct(r,m.toString(),y.length===0?null:y,l===null?null:l.toString(),_,v)}static decodeHanziSegment(r,a,l){if(l*13>r.available())throw new F;const u=new Uint8Array(2*l);let d=0;for(;l>0;){const m=r.readBits(13);let y=m/96<<8&4294967295|m%96;y<959?y+=41377:y+=42657,u[d]=y>>8&255,u[d+1]=y&255,d+=2,l--}try{a.append(X.decode(u,Y.GB2312))}catch(m){throw new F(m)}}static decodeKanjiSegment(r,a,l){if(l*13>r.available())throw new F;const u=new Uint8Array(2*l);let d=0;for(;l>0;){const m=r.readBits(13);let y=m/192<<8&4294967295|m%192;y<7936?y+=33088:y+=49472,u[d]=y>>8,u[d+1]=y,d+=2,l--}try{a.append(X.decode(u,Y.SHIFT_JIS))}catch(m){throw new F(m)}}static decodeByteSegment(r,a,l,u,d,m){if(8*l>r.available())throw new F;const y=new Uint8Array(l);for(let v=0;v<l;v++)y[v]=r.readBits(8);let _;u===null?_=Y.guessEncoding(y,m):_=u.getName();try{a.append(X.decode(y,_))}catch(v){throw new F(v)}d.push(y)}static toAlphaNumericChar(r){if(r>=zn.ALPHANUMERIC_CHARS.length)throw new F;return zn.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,a,l,u){const d=a.length();for(;l>1;){if(r.available()<11)throw new F;const m=r.readBits(11);a.append(zn.toAlphaNumericChar(Math.floor(m/45))),a.append(zn.toAlphaNumericChar(m%45)),l-=2}if(l===1){if(r.available()<6)throw new F;a.append(zn.toAlphaNumericChar(r.readBits(6)))}if(u)for(let m=d;m<a.length();m++)a.charAt(m)==="%"&&(m<a.length()-1&&a.charAt(m+1)==="%"?a.deleteCharAt(m+1):a.setCharAt(m,""))}static decodeNumericSegment(r,a,l){for(;l>=3;){if(r.available()<10)throw new F;const u=r.readBits(10);if(u>=1e3)throw new F;a.append(zn.toAlphaNumericChar(Math.floor(u/100))),a.append(zn.toAlphaNumericChar(Math.floor(u/10)%10)),a.append(zn.toAlphaNumericChar(u%10)),l-=3}if(l===2){if(r.available()<7)throw new F;const u=r.readBits(7);if(u>=100)throw new F;a.append(zn.toAlphaNumericChar(Math.floor(u/10))),a.append(zn.toAlphaNumericChar(u%10))}else if(l===1){if(r.available()<4)throw new F;const u=r.readBits(4);if(u>=10)throw new F;a.append(zn.toAlphaNumericChar(u))}}static parseECIValue(r){const a=r.readBits(8);if((a&128)===0)return a&127;if((a&192)===128){const l=r.readBits(8);return(a&63)<<8&4294967295|l}if((a&224)===192){const l=r.readBits(16);return(a&31)<<16&4294967295|l}throw new F}}zn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",zn.GB2312_SUBSET=1;class Fo{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const a=r[0];r[0]=r[2],r[2]=a}}class Bs{constructor(){this.rsDecoder=new Me(Ot.QR_CODE_FIELD_256)}decodeBooleanArray(r,a){return this.decodeBitMatrix(ot.parseFromBooleanArray(r),a)}decodeBitMatrix(r,a){const l=new mi(r);let u=null;try{return this.decodeBitMatrixParser(l,a)}catch(d){u=d}try{l.remask(),l.setMirror(!0),l.readVersion(),l.readFormatInformation(),l.mirror();const d=this.decodeBitMatrixParser(l,a);return d.setOther(new Fo(!0)),d}catch(d){throw u!==null?u:d}}decodeBitMatrixParser(r,a){const l=r.readVersion(),u=r.readFormatInformation().getErrorCorrectionLevel(),d=r.readCodewords(),m=Ha.getDataBlocks(d,l,u);let y=0;for(const I of m)y+=I.getNumDataCodewords();const _=new Uint8Array(y);let v=0;for(const I of m){const k=I.getCodewords(),L=I.getNumDataCodewords();this.correctErrors(k,L);for(let q=0;q<L;q++)_[v++]=k[q]}return zn.decode(_,l,u,a)}correctErrors(r,a){const l=new Int32Array(r);try{this.rsDecoder.decode(l,r.length-a)}catch{throw new B}for(let u=0;u<a;u++)r[u]=l[u]}}class Vs extends Ie{constructor(r,a,l){super(r,a),this.estimatedModuleSize=l}aboutEquals(r,a,l){if(Math.abs(a-this.getY())<=r&&Math.abs(l-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,a,l){const u=(this.getX()+a)/2,d=(this.getY()+r)/2,m=(this.estimatedModuleSize+l)/2;return new Vs(u,d,m)}}class pi{constructor(r,a,l,u,d,m,y){this.image=r,this.startX=a,this.startY=l,this.width=u,this.height=d,this.moduleSize=m,this.resultPointCallback=y,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,a=this.height,l=this.width,u=r+l,d=this.startY+a/2,m=new Int32Array(3),y=this.image;for(let _=0;_<a;_++){const v=d+((_&1)===0?Math.floor((_+1)/2):-Math.floor((_+1)/2));m[0]=0,m[1]=0,m[2]=0;let I=r;for(;I<u&&!y.get(I,v);)I++;let k=0;for(;I<u;){if(y.get(I,v))if(k===1)m[1]++;else if(k===2){if(this.foundPatternCross(m)){const L=this.handlePossibleCenter(m,v,I);if(L!==null)return L}m[0]=m[2],m[1]=1,m[2]=0,k=1}else m[++k]++;else k===1&&k++,m[k]++;I++}if(this.foundPatternCross(m)){const L=this.handlePossibleCenter(m,v,u);if(L!==null)return L}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new oe}static centerFromEnd(r,a){return a-r[2]-r[1]/2}foundPatternCross(r){const a=this.moduleSize,l=a/2;for(let u=0;u<3;u++)if(Math.abs(a-r[u])>=l)return!1;return!0}crossCheckVertical(r,a,l,u){const d=this.image,m=d.getHeight(),y=this.crossCheckStateCount;y[0]=0,y[1]=0,y[2]=0;let _=r;for(;_>=0&&d.get(a,_)&&y[1]<=l;)y[1]++,_--;if(_<0||y[1]>l)return NaN;for(;_>=0&&!d.get(a,_)&&y[0]<=l;)y[0]++,_--;if(y[0]>l)return NaN;for(_=r+1;_<m&&d.get(a,_)&&y[1]<=l;)y[1]++,_++;if(_===m||y[1]>l)return NaN;for(;_<m&&!d.get(a,_)&&y[2]<=l;)y[2]++,_++;if(y[2]>l)return NaN;const v=y[0]+y[1]+y[2];return 5*Math.abs(v-u)>=2*u?NaN:this.foundPatternCross(y)?pi.centerFromEnd(y,_):NaN}handlePossibleCenter(r,a,l){const u=r[0]+r[1]+r[2],d=pi.centerFromEnd(r,l),m=this.crossCheckVertical(a,d,2*r[1],u);if(!isNaN(m)){const y=(r[0]+r[1]+r[2])/3;for(const v of this.possibleCenters)if(v.aboutEquals(y,m,d))return v.combineEstimate(m,d,y);const _=new Vs(d,m,y);this.possibleCenters.push(_),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(_)}return null}}class ia extends Ie{constructor(r,a,l,u){super(r,a),this.estimatedModuleSize=l,this.count=u,u===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,a,l){if(Math.abs(a-this.getY())<=r&&Math.abs(l-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,a,l){const u=this.count+1,d=(this.count*this.getX()+a)/u,m=(this.count*this.getY()+r)/u,y=(this.count*this.estimatedModuleSize+l)/u;return new ia(d,m,y,u)}}class Bi{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class nr{constructor(r,a){this.image=r,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=a}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const a=r!=null&&r.get(Qe.TRY_HARDER)!==void 0,l=r!=null&&r.get(Qe.PURE_BARCODE)!==void 0,u=this.image,d=u.getHeight(),m=u.getWidth();let y=Math.floor(3*d/(4*nr.MAX_MODULES));(y<nr.MIN_SKIP||a)&&(y=nr.MIN_SKIP);let _=!1;const v=new Int32Array(5);for(let k=y-1;k<d&&!_;k+=y){v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0;let L=0;for(let q=0;q<m;q++)if(u.get(q,k))(L&1)===1&&L++,v[L]++;else if((L&1)===0)if(L===4)if(nr.foundPatternCross(v)){if(this.handlePossibleCenter(v,k,q,l)===!0)if(y=2,this.hasSkipped===!0)_=this.haveMultiplyConfirmedCenters();else{const $=this.findRowSkip();$>v[2]&&(k+=$-v[2]-y,q=m-1)}else{v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,L=3;continue}L=0,v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0}else v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,L=3;else v[++L]++;else v[L]++;nr.foundPatternCross(v)&&this.handlePossibleCenter(v,k,m,l)===!0&&(y=v[0],this.hasSkipped&&(_=this.haveMultiplyConfirmedCenters()))}const I=this.selectBestPatterns();return Ie.orderBestPatterns(I),new Bi(I)}static centerFromEnd(r,a){return a-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let a=0;for(let d=0;d<5;d++){const m=r[d];if(m===0)return!1;a+=m}if(a<7)return!1;const l=a/7,u=l/2;return Math.abs(l-r[0])<u&&Math.abs(l-r[1])<u&&Math.abs(3*l-r[2])<3*u&&Math.abs(l-r[3])<u&&Math.abs(l-r[4])<u}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,a,l,u){const d=this.getCrossCheckStateCount();let m=0;const y=this.image;for(;r>=m&&a>=m&&y.get(a-m,r-m);)d[2]++,m++;if(r<m||a<m)return!1;for(;r>=m&&a>=m&&!y.get(a-m,r-m)&&d[1]<=l;)d[1]++,m++;if(r<m||a<m||d[1]>l)return!1;for(;r>=m&&a>=m&&y.get(a-m,r-m)&&d[0]<=l;)d[0]++,m++;if(d[0]>l)return!1;const _=y.getHeight(),v=y.getWidth();for(m=1;r+m<_&&a+m<v&&y.get(a+m,r+m);)d[2]++,m++;if(r+m>=_||a+m>=v)return!1;for(;r+m<_&&a+m<v&&!y.get(a+m,r+m)&&d[3]<l;)d[3]++,m++;if(r+m>=_||a+m>=v||d[3]>=l)return!1;for(;r+m<_&&a+m<v&&y.get(a+m,r+m)&&d[4]<l;)d[4]++,m++;if(d[4]>=l)return!1;const I=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(I-u)<2*u&&nr.foundPatternCross(d)}crossCheckVertical(r,a,l,u){const d=this.image,m=d.getHeight(),y=this.getCrossCheckStateCount();let _=r;for(;_>=0&&d.get(a,_);)y[2]++,_--;if(_<0)return NaN;for(;_>=0&&!d.get(a,_)&&y[1]<=l;)y[1]++,_--;if(_<0||y[1]>l)return NaN;for(;_>=0&&d.get(a,_)&&y[0]<=l;)y[0]++,_--;if(y[0]>l)return NaN;for(_=r+1;_<m&&d.get(a,_);)y[2]++,_++;if(_===m)return NaN;for(;_<m&&!d.get(a,_)&&y[3]<l;)y[3]++,_++;if(_===m||y[3]>=l)return NaN;for(;_<m&&d.get(a,_)&&y[4]<l;)y[4]++,_++;if(y[4]>=l)return NaN;const v=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(v-u)>=2*u?NaN:nr.foundPatternCross(y)?nr.centerFromEnd(y,_):NaN}crossCheckHorizontal(r,a,l,u){const d=this.image,m=d.getWidth(),y=this.getCrossCheckStateCount();let _=r;for(;_>=0&&d.get(_,a);)y[2]++,_--;if(_<0)return NaN;for(;_>=0&&!d.get(_,a)&&y[1]<=l;)y[1]++,_--;if(_<0||y[1]>l)return NaN;for(;_>=0&&d.get(_,a)&&y[0]<=l;)y[0]++,_--;if(y[0]>l)return NaN;for(_=r+1;_<m&&d.get(_,a);)y[2]++,_++;if(_===m)return NaN;for(;_<m&&!d.get(_,a)&&y[3]<l;)y[3]++,_++;if(_===m||y[3]>=l)return NaN;for(;_<m&&d.get(_,a)&&y[4]<l;)y[4]++,_++;if(y[4]>=l)return NaN;const v=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(v-u)>=u?NaN:nr.foundPatternCross(y)?nr.centerFromEnd(y,_):NaN}handlePossibleCenter(r,a,l,u){const d=r[0]+r[1]+r[2]+r[3]+r[4];let m=nr.centerFromEnd(r,l),y=this.crossCheckVertical(a,Math.floor(m),r[2],d);if(!isNaN(y)&&(m=this.crossCheckHorizontal(Math.floor(m),Math.floor(y),r[2],d),!isNaN(m)&&(!u||this.crossCheckDiagonal(Math.floor(y),Math.floor(m),r[2],d)))){const _=d/7;let v=!1;const I=this.possibleCenters;for(let k=0,L=I.length;k<L;k++){const q=I[k];if(q.aboutEquals(_,y,m)){I[k]=q.combineEstimate(y,m,_),v=!0;break}}if(!v){const k=new ia(m,y,_);I.push(k),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(k)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let a=null;for(const l of this.possibleCenters)if(l.getCount()>=nr.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,a=0;const l=this.possibleCenters.length;for(const m of this.possibleCenters)m.getCount()>=nr.CENTER_QUORUM&&(r++,a+=m.getEstimatedModuleSize());if(r<3)return!1;const u=a/l;let d=0;for(const m of this.possibleCenters)d+=Math.abs(m.getEstimatedModuleSize()-u);return d<=.05*a}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new oe;const a=this.possibleCenters;let l;if(r>3){let u=0,d=0;for(const _ of this.possibleCenters){const v=_.getEstimatedModuleSize();u+=v,d+=v*v}l=u/r;let m=Math.sqrt(d/r-l*l);a.sort((_,v)=>{const I=Math.abs(v.getEstimatedModuleSize()-l),k=Math.abs(_.getEstimatedModuleSize()-l);return I<k?-1:I>k?1:0});const y=Math.max(.2*l,m);for(let _=0;_<a.length&&a.length>3;_++){const v=a[_];Math.abs(v.getEstimatedModuleSize()-l)>y&&(a.splice(_,1),_--)}}if(a.length>3){let u=0;for(const d of a)u+=d.getEstimatedModuleSize();l=u/a.length,a.sort((d,m)=>{if(m.getCount()===d.getCount()){const y=Math.abs(m.getEstimatedModuleSize()-l),_=Math.abs(d.getEstimatedModuleSize()-l);return y<_?1:y>_?-1:0}else return m.getCount()-d.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]}}nr.CENTER_QUORUM=2,nr.MIN_SKIP=3,nr.MAX_MODULES=57;class yi{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(Qe.NEED_RESULT_POINT_CALLBACK);const l=new nr(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(l)}processFinderPatternInfo(r){const a=r.getTopLeft(),l=r.getTopRight(),u=r.getBottomLeft(),d=this.calculateModuleSize(a,l,u);if(d<1)throw new oe("No pattern found in proccess finder.");const m=yi.computeDimension(a,l,u,d),y=bt.getProvisionalVersionForDimension(m),_=y.getDimensionForVersion()-7;let v=null;if(y.getAlignmentPatternCenters().length>0){const q=l.getX()-a.getX()+u.getX(),Z=l.getY()-a.getY()+u.getY(),$=1-3/_,ue=Math.floor(a.getX()+$*(q-a.getX())),_e=Math.floor(a.getY()+$*(Z-a.getY()));for(let Ze=4;Ze<=16;Ze<<=1)try{v=this.findAlignmentInRegion(d,ue,_e,Ze);break}catch(Ye){if(!(Ye instanceof oe))throw Ye}}const I=yi.createTransform(a,l,u,v,m),k=yi.sampleGrid(this.image,I,m);let L;return v===null?L=[u,a,l]:L=[u,a,l,v],new Pt(k,L)}static createTransform(r,a,l,u,d){const m=d-3.5;let y,_,v,I;return u!==null?(y=u.getX(),_=u.getY(),v=m-3,I=v):(y=a.getX()-r.getX()+l.getX(),_=a.getY()-r.getY()+l.getY(),v=m,I=m),Bt.quadrilateralToQuadrilateral(3.5,3.5,m,3.5,v,I,3.5,m,r.getX(),r.getY(),a.getX(),a.getY(),y,_,l.getX(),l.getY())}static sampleGrid(r,a,l){return lr.getInstance().sampleGridWithTransform(r,l,l,a)}static computeDimension(r,a,l,u){const d=Ve.round(Ie.distance(r,a)/u),m=Ve.round(Ie.distance(r,l)/u);let y=Math.floor((d+m)/2)+7;switch(y&3){case 0:y++;break;case 2:y--;break;case 3:throw new oe("Dimensions could be not found.")}return y}calculateModuleSize(r,a,l){return(this.calculateModuleSizeOneWay(r,a)+this.calculateModuleSizeOneWay(r,l))/2}calculateModuleSizeOneWay(r,a){const l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(a.getX()),Math.floor(a.getY())),u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(l)?u/7:isNaN(u)?l/7:(l+u)/14}sizeOfBlackWhiteBlackRunBothWays(r,a,l,u){let d=this.sizeOfBlackWhiteBlackRun(r,a,l,u),m=1,y=r-(l-r);y<0?(m=r/(r-y),y=0):y>=this.image.getWidth()&&(m=(this.image.getWidth()-1-r)/(y-r),y=this.image.getWidth()-1);let _=Math.floor(a-(u-a)*m);return m=1,_<0?(m=a/(a-_),_=0):_>=this.image.getHeight()&&(m=(this.image.getHeight()-1-a)/(_-a),_=this.image.getHeight()-1),y=Math.floor(r+(y-r)*m),d+=this.sizeOfBlackWhiteBlackRun(r,a,y,_),d-1}sizeOfBlackWhiteBlackRun(r,a,l,u){const d=Math.abs(u-a)>Math.abs(l-r);if(d){let q=r;r=a,a=q,q=l,l=u,u=q}const m=Math.abs(l-r),y=Math.abs(u-a);let _=-m/2;const v=r<l?1:-1,I=a<u?1:-1;let k=0;const L=l+v;for(let q=r,Z=a;q!==L;q+=v){const $=d?Z:q,ue=d?q:Z;if(k===1===this.image.get($,ue)){if(k===2)return Ve.distance(q,Z,r,a);k++}if(_+=y,_>0){if(Z===u)break;Z+=I,_-=m}}return k===2?Ve.distance(l+v,u,r,a):NaN}findAlignmentInRegion(r,a,l,u){const d=Math.floor(u*r),m=Math.max(0,a-d),y=Math.min(this.image.getWidth()-1,a+d);if(y-m<r*3)throw new oe("Alignment top exceeds estimated module size.");const _=Math.max(0,l-d),v=Math.min(this.image.getHeight()-1,l+d);if(v-_<r*3)throw new oe("Alignment bottom exceeds estimated module size.");return new pi(this.image,m,_,y-m,v-_,r,this.resultPointCallback).find()}}class xi{constructor(){this.decoder=new Bs}getDecoder(){return this.decoder}decode(r,a){let l,u;if(a!=null&&a.get(Qe.PURE_BARCODE)!==void 0){const _=xi.extractPureBits(r.getBlackMatrix());l=this.decoder.decodeBitMatrix(_,a),u=xi.NO_POINTS}else{const _=new yi(r.getBlackMatrix()).detect(a);l=this.decoder.decodeBitMatrix(_.getBits(),a),u=_.getPoints()}l.getOther()instanceof Fo&&l.getOther().applyMirroredCorrection(u);const d=new Ce(l.getText(),l.getRawBytes(),void 0,u,me.QR_CODE,void 0),m=l.getByteSegments();m!==null&&d.putMetadata(mt.BYTE_SEGMENTS,m);const y=l.getECLevel();return y!==null&&d.putMetadata(mt.ERROR_CORRECTION_LEVEL,y),l.hasStructuredAppend()&&(d.putMetadata(mt.STRUCTURED_APPEND_SEQUENCE,l.getStructuredAppendSequenceNumber()),d.putMetadata(mt.STRUCTURED_APPEND_PARITY,l.getStructuredAppendParity())),d}reset(){}static extractPureBits(r){const a=r.getTopLeftOnBit(),l=r.getBottomRightOnBit();if(a===null||l===null)throw new oe;const u=this.moduleSize(a,r);let d=a[1],m=l[1],y=a[0],_=l[0];if(y>=_||d>=m)throw new oe;if(m-d!==_-y&&(_=y+(m-d),_>=r.getWidth()))throw new oe;const v=Math.round((_-y+1)/u),I=Math.round((m-d+1)/u);if(v<=0||I<=0)throw new oe;if(I!==v)throw new oe;const k=Math.floor(u/2);d+=k,y+=k;const L=y+Math.floor((v-1)*u)-_;if(L>0){if(L>k)throw new oe;y-=L}const q=d+Math.floor((I-1)*u)-m;if(q>0){if(q>k)throw new oe;d-=q}const Z=new ot(v,I);for(let $=0;$<I;$++){const ue=d+Math.floor($*u);for(let _e=0;_e<v;_e++)r.get(y+Math.floor(_e*u),ue)&&Z.set(_e,$)}return Z}static moduleSize(r,a){const l=a.getHeight(),u=a.getWidth();let d=r[0],m=r[1],y=!0,_=0;for(;d<u&&m<l;){if(y!==a.get(d,m)){if(++_===5)break;y=!y}d++,m++}if(d===u||m===l)throw new oe;return(d-r[0])/7}}xi.NO_POINTS=new Array;class Dt{PDF417Common(){}static getBitCountSum(r){return Ve.sum(r)}static toIntArray(r){if(r==null||!r.length)return Dt.EMPTY_INT_ARRAY;const a=new Int32Array(r.length);let l=0;for(const u of r)a[l++]=u;return a}static getCodeword(r){const a=ze.binarySearch(Dt.SYMBOL_TABLE,r&262143);return a<0?-1:(Dt.CODEWORD_TABLE[a]-1)%Dt.NUMBER_OF_CODEWORDS}}Dt.NUMBER_OF_CODEWORDS=929,Dt.MAX_CODEWORDS_IN_BARCODE=Dt.NUMBER_OF_CODEWORDS-1,Dt.MIN_ROWS_IN_BARCODE=3,Dt.MAX_ROWS_IN_BARCODE=90,Dt.MODULES_IN_CODEWORD=17,Dt.MODULES_IN_STOP_PATTERN=18,Dt.BARS_IN_MODULE=8,Dt.EMPTY_INT_ARRAY=new Int32Array([]),Dt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Dt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Us{constructor(r,a){this.bits=r,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class Ft{static detectMultiple(r,a,l){let u=r.getBlackMatrix(),d=Ft.detect(l,u);return d.length||(u=u.clone(),u.rotate180(),d=Ft.detect(l,u)),new Us(u,d)}static detect(r,a){const l=new Array;let u=0,d=0,m=!1;for(;u<a.getHeight();){const y=Ft.findVertices(a,u,d);if(y[0]==null&&y[3]==null){if(!m)break;m=!1,d=0;for(const _ of l)_[1]!=null&&(u=Math.trunc(Math.max(u,_[1].getY()))),_[3]!=null&&(u=Math.max(u,Math.trunc(_[3].getY())));u+=Ft.ROW_STEP;continue}if(m=!0,l.push(y),!r)break;y[2]!=null?(d=Math.trunc(y[2].getX()),u=Math.trunc(y[2].getY())):(d=Math.trunc(y[4].getX()),u=Math.trunc(y[4].getY()))}return l}static findVertices(r,a,l){const u=r.getHeight(),d=r.getWidth(),m=new Array(8);return Ft.copyToResult(m,Ft.findRowsWithPattern(r,u,d,a,l,Ft.START_PATTERN),Ft.INDEXES_START_PATTERN),m[4]!=null&&(l=Math.trunc(m[4].getX()),a=Math.trunc(m[4].getY())),Ft.copyToResult(m,Ft.findRowsWithPattern(r,u,d,a,l,Ft.STOP_PATTERN),Ft.INDEXES_STOP_PATTERN),m}static copyToResult(r,a,l){for(let u=0;u<l.length;u++)r[l[u]]=a[u]}static findRowsWithPattern(r,a,l,u,d,m){const y=new Array(4);let _=!1;const v=new Int32Array(m.length);for(;u<a;u+=Ft.ROW_STEP){let k=Ft.findGuardPattern(r,d,u,l,!1,m,v);if(k!=null){for(;u>0;){const L=Ft.findGuardPattern(r,d,--u,l,!1,m,v);if(L!=null)k=L;else{u++;break}}y[0]=new Ie(k[0],u),y[1]=new Ie(k[1],u),_=!0;break}}let I=u+1;if(_){let k=0,L=Int32Array.from([Math.trunc(y[0].getX()),Math.trunc(y[1].getX())]);for(;I<a;I++){const q=Ft.findGuardPattern(r,L[0],I,l,!1,m,v);if(q!=null&&Math.abs(L[0]-q[0])<Ft.MAX_PATTERN_DRIFT&&Math.abs(L[1]-q[1])<Ft.MAX_PATTERN_DRIFT)L=q,k=0;else{if(k>Ft.SKIPPED_ROW_COUNT_MAX)break;k++}}I-=k+1,y[2]=new Ie(L[0],I),y[3]=new Ie(L[1],I)}return I-u<Ft.BARCODE_MIN_HEIGHT&&ze.fill(y,null),y}static findGuardPattern(r,a,l,u,d,m,y){ze.fillWithin(y,0,y.length,0);let _=a,v=0;for(;r.get(_,l)&&_>0&&v++<Ft.MAX_PIXEL_DRIFT;)_--;let I=_,k=0,L=m.length;for(let q=d;I<u;I++)if(r.get(I,l)!==q)y[k]++;else{if(k===L-1){if(Ft.patternMatchVariance(y,m,Ft.MAX_INDIVIDUAL_VARIANCE)<Ft.MAX_AVG_VARIANCE)return new Int32Array([_,I]);_+=y[0]+y[1],ne.arraycopy(y,2,y,0,k-1),y[k-1]=0,y[k]=0,k--}else k++;y[k]=1,q=!q}return k===L-1&&Ft.patternMatchVariance(y,m,Ft.MAX_INDIVIDUAL_VARIANCE)<Ft.MAX_AVG_VARIANCE?new Int32Array([_,I-1]):null}static patternMatchVariance(r,a,l){let u=r.length,d=0,m=0;for(let v=0;v<u;v++)d+=r[v],m+=a[v];if(d<m)return 1/0;let y=d/m;l*=y;let _=0;for(let v=0;v<u;v++){let I=r[v],k=a[v]*y,L=I>k?I-k:k-I;if(L>l)return 1/0;_+=L}return _/d}}Ft.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ft.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ft.MAX_AVG_VARIANCE=.42,Ft.MAX_INDIVIDUAL_VARIANCE=.8,Ft.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ft.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ft.MAX_PIXEL_DRIFT=3,Ft.MAX_PATTERN_DRIFT=5,Ft.SKIPPED_ROW_COUNT_MAX=25,Ft.ROW_STEP=5,Ft.BARCODE_MIN_HEIGHT=10;class Hn{constructor(r,a){if(a.length===0)throw new N;this.field=r;let l=a.length;if(l>1&&a[0]===0){let u=1;for(;u<l&&a[u]===0;)u++;u===l?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(l-u),ne.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let u=0;for(let d of this.coefficients)u=this.field.add(u,d);return u}let a=this.coefficients[0],l=this.coefficients.length;for(let u=1;u<l;u++)a=this.field.add(this.field.multiply(r,a),this.coefficients[u]);return a}add(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let a=this.coefficients,l=r.coefficients;if(a.length>l.length){let m=a;a=l,l=m}let u=new Int32Array(l.length),d=l.length-a.length;ne.arraycopy(l,0,u,0,d);for(let m=d;m<l.length;m++)u[m]=this.field.add(a[m-d],l[m]);return new Hn(this.field,u)}subtract(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof Hn?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new Hn(this.field,new Int32Array([0]));let a=this.coefficients,l=a.length,u=r.coefficients,d=u.length,m=new Int32Array(l+d-1);for(let y=0;y<l;y++){let _=a[y];for(let v=0;v<d;v++)m[y+v]=this.field.add(m[y+v],this.field.multiply(_,u[v]))}return new Hn(this.field,m)}negative(){let r=this.coefficients.length,a=new Int32Array(r);for(let l=0;l<r;l++)a[l]=this.field.subtract(0,this.coefficients[l]);return new Hn(this.field,a)}multiplyScalar(r){if(r===0)return new Hn(this.field,new Int32Array([0]));if(r===1)return this;let a=this.coefficients.length,l=new Int32Array(a);for(let u=0;u<a;u++)l[u]=this.field.multiply(this.coefficients[u],r);return new Hn(this.field,l)}multiplyByMonomial(r,a){if(r<0)throw new N;if(a===0)return new Hn(this.field,new Int32Array([0]));let l=this.coefficients.length,u=new Int32Array(l+r);for(let d=0;d<l;d++)u[d]=this.field.multiply(this.coefficients[d],a);return new Hn(this.field,u)}toString(){let r=new G;for(let a=this.getDegree();a>=0;a--){let l=this.getCoefficient(a);l!==0&&(l<0?(r.append(" - "),l=-l):r.length()>0&&r.append(" + "),(a===0||l!==1)&&r.append(l),a!==0&&(a===1?r.append("x"):(r.append("x^"),r.append(a))))}return r.toString()}}class sa{add(r,a){return(r+a)%this.modulus}subtract(r,a){return(this.modulus+r-a)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new N;return this.logTable[r]}inverse(r){if(r===0)throw new En;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,a){return r===0||a===0?0:this.expTable[(this.logTable[r]+this.logTable[a])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class Ln extends sa{constructor(r,a){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let l=1;for(let u=0;u<r;u++)this.expTable[u]=l,l=l*a%r;for(let u=0;u<r-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new Hn(this,new Int32Array([0])),this.one=new Hn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,a){if(r<0)throw new N;if(a===0)return this.zero;let l=new Int32Array(r+1);return l[0]=a,new Hn(this,l)}}Ln.PDF417_GF=new Ln(Dt.NUMBER_OF_CODEWORDS,3);class Qi{constructor(){this.field=Ln.PDF417_GF}decode(r,a,l){let u=new Hn(this.field,r),d=new Int32Array(a),m=!1;for(let Z=a;Z>0;Z--){let $=u.evaluateAt(this.field.exp(Z));d[a-Z]=$,$!==0&&(m=!0)}if(!m)return 0;let y=this.field.getOne();if(l!=null)for(const Z of l){let $=this.field.exp(r.length-1-Z),ue=new Hn(this.field,new Int32Array([this.field.subtract(0,$),1]));y=y.multiply(ue)}let _=new Hn(this.field,d),v=this.runEuclideanAlgorithm(this.field.buildMonomial(a,1),_,a),I=v[0],k=v[1],L=this.findErrorLocations(I),q=this.findErrorMagnitudes(k,I,L);for(let Z=0;Z<L.length;Z++){let $=r.length-1-this.field.log(L[Z]);if($<0)throw B.getChecksumInstance();r[$]=this.field.subtract(r[$],q[Z])}return L.length}runEuclideanAlgorithm(r,a,l){if(r.getDegree()<a.getDegree()){let L=r;r=a,a=L}let u=r,d=a,m=this.field.getZero(),y=this.field.getOne();for(;d.getDegree()>=Math.round(l/2);){let L=u,q=m;if(u=d,m=y,u.isZero())throw B.getChecksumInstance();d=L;let Z=this.field.getZero(),$=u.getCoefficient(u.getDegree()),ue=this.field.inverse($);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){let _e=d.getDegree()-u.getDegree(),Ze=this.field.multiply(d.getCoefficient(d.getDegree()),ue);Z=Z.add(this.field.buildMonomial(_e,Ze)),d=d.subtract(u.multiplyByMonomial(_e,Ze))}y=Z.multiply(m).subtract(q).negative()}let _=y.getCoefficient(0);if(_===0)throw B.getChecksumInstance();let v=this.field.inverse(_),I=y.multiply(v),k=d.multiply(v);return[I,k]}findErrorLocations(r){let a=r.getDegree(),l=new Int32Array(a),u=0;for(let d=1;d<this.field.getSize()&&u<a;d++)r.evaluateAt(d)===0&&(l[u]=this.field.inverse(d),u++);if(u!==a)throw B.getChecksumInstance();return l}findErrorMagnitudes(r,a,l){let u=a.getDegree(),d=new Int32Array(u);for(let v=1;v<=u;v++)d[u-v]=this.field.multiply(v,a.getCoefficient(v));let m=new Hn(this.field,d),y=l.length,_=new Int32Array(y);for(let v=0;v<y;v++){let I=this.field.inverse(l[v]),k=this.field.subtract(0,r.evaluateAt(I)),L=this.field.inverse(m.evaluateAt(I));_[v]=this.field.multiply(k,L)}return _}}class Zi{constructor(r,a,l,u,d){r instanceof Zi?this.constructor_2(r):this.constructor_1(r,a,l,u,d)}constructor_1(r,a,l,u,d){const m=a==null||l==null,y=u==null||d==null;if(m&&y)throw new oe;m?(a=new Ie(0,u.getY()),l=new Ie(0,d.getY())):y&&(u=new Ie(r.getWidth()-1,a.getY()),d=new Ie(r.getWidth()-1,l.getY())),this.image=r,this.topLeft=a,this.bottomLeft=l,this.topRight=u,this.bottomRight=d,this.minX=Math.trunc(Math.min(a.getX(),l.getX())),this.maxX=Math.trunc(Math.max(u.getX(),d.getX())),this.minY=Math.trunc(Math.min(a.getY(),u.getY())),this.maxY=Math.trunc(Math.max(l.getY(),d.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,a){return r==null?a:a==null?r:new Zi(r.image,r.topLeft,r.bottomLeft,a.topRight,a.bottomRight)}addMissingRows(r,a,l){let u=this.topLeft,d=this.bottomLeft,m=this.topRight,y=this.bottomRight;if(r>0){let _=l?this.topLeft:this.topRight,v=Math.trunc(_.getY()-r);v<0&&(v=0);let I=new Ie(_.getX(),v);l?u=I:m=I}if(a>0){let _=l?this.bottomLeft:this.bottomRight,v=Math.trunc(_.getY()+a);v>=this.image.getHeight()&&(v=this.image.getHeight()-1);let I=new Ie(_.getX(),v);l?d=I:y=I}return new Zi(this.image,u,d,m,y)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class aa{constructor(r,a,l,u){this.columnCount=r,this.errorCorrectionLevel=u,this.rowCountUpperPart=a,this.rowCountLowerPart=l,this.rowCount=a+l}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Cs{constructor(){this.buffer=""}static form(r,a){let l=-1;function u(m,y,_,v,I,k){if(m==="%%")return"%";if(a[++l]===void 0)return;m=v?parseInt(v.substr(1)):void 0;let L=I?parseInt(I.substr(1)):void 0,q;switch(k){case"s":q=a[l];break;case"c":q=a[l][0];break;case"f":q=parseFloat(a[l]).toFixed(m);break;case"p":q=parseFloat(a[l]).toPrecision(m);break;case"e":q=parseFloat(a[l]).toExponential(m);break;case"x":q=parseInt(a[l]).toString(L||16);break;case"d":q=parseFloat(parseInt(a[l],L||10).toPrecision(m)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(L);let Z=parseInt(_),$=_&&_[0]+""=="0"?"0":" ";for(;q.length<Z;)q=y!==void 0?q+$:$+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,u)}format(r,...a){this.buffer+=Cs.form(r,a)}toString(){return this.buffer}}class Ji{constructor(r){this.boundingBox=new Zi(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let a=this.getCodeword(r);if(a!=null)return a;for(let l=1;l<Ji.MAX_NEARBY_DISTANCE;l++){let u=this.imageRowToCodewordIndex(r)-l;if(u>=0&&(a=this.codewords[u],a!=null)||(u=this.imageRowToCodewordIndex(r)+l,u<this.codewords.length&&(a=this.codewords[u],a!=null)))return a}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,a){this.codewords[this.imageRowToCodewordIndex(r)]=a}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new Cs;let a=0;for(const l of this.codewords){if(l==null){r.format("%3d:    |   %n",a++);continue}r.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}return r.toString()}}Ji.MAX_NEARBY_DISTANCE=5;class Ci{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let a=this.values.get(r);a==null&&(a=0),a++,this.values.set(r,a)}getValue(){let r=-1,a=new Array;for(const[l,u]of this.values.entries()){const d={getKey:()=>l,getValue:()=>u};d.getValue()>r?(r=d.getValue(),a=[],a.push(d.getKey())):d.getValue()===r&&a.push(d.getKey())}return Dt.toIntArray(a)}getConfidence(r){return this.values.get(r)}}class Vi extends Ji{constructor(r,a){super(r),this._isLeft=a}setRowNumbers(){for(let r of this.getCodewords())r?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let a=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(a,r);let l=this.getBoundingBox(),u=this._isLeft?l.getTopLeft():l.getTopRight(),d=this._isLeft?l.getBottomLeft():l.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.imageRowToCodewordIndex(Math.trunc(d.getY())),_=-1,v=1,I=0;for(let k=m;k<y;k++){if(a[k]==null)continue;let L=a[k],q=L.getRowNumber()-_;if(q===0)I++;else if(q===1)v=Math.max(v,I),I=1,_=L.getRowNumber();else if(q<0||L.getRowNumber()>=r.getRowCount()||q>k)a[k]=null;else{let Z;v>2?Z=(v-2)*q:Z=q;let $=Z>=k;for(let ue=1;ue<=Z&&!$;ue++)$=a[k-ue]!=null;$?a[k]=null:(_=L.getRowNumber(),I=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let a=new Int32Array(r.getRowCount());for(let l of this.getCodewords())if(l!=null){let u=l.getRowNumber();if(u>=a.length)continue;a[u]++}return a}adjustIncompleteIndicatorColumnRowNumbers(r){let a=this.getBoundingBox(),l=this._isLeft?a.getTopLeft():a.getTopRight(),u=this._isLeft?a.getBottomLeft():a.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),m=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.getCodewords(),_=-1;for(let v=d;v<m;v++){if(y[v]==null)continue;let I=y[v];I.setRowNumberAsRowIndicatorColumn();let k=I.getRowNumber()-_;k===0||(k===1?_=I.getRowNumber():I.getRowNumber()>=r.getRowCount()?y[v]=null:_=I.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),a=new Ci,l=new Ci,u=new Ci,d=new Ci;for(let y of r){if(y==null)continue;y.setRowNumberAsRowIndicatorColumn();let _=y.getValue()%30,v=y.getRowNumber();switch(this._isLeft||(v+=2),v%3){case 0:l.setValue(_*3+1);break;case 1:d.setValue(_/3),u.setValue(_%3);break;case 2:a.setValue(_+1);break}}if(a.getValue().length===0||l.getValue().length===0||u.getValue().length===0||d.getValue().length===0||a.getValue()[0]<1||l.getValue()[0]+u.getValue()[0]<Dt.MIN_ROWS_IN_BARCODE||l.getValue()[0]+u.getValue()[0]>Dt.MAX_ROWS_IN_BARCODE)return null;let m=new aa(a.getValue()[0],l.getValue()[0],u.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(r,m),m}removeIncorrectCodewords(r,a){for(let l=0;l<r.length;l++){let u=r[l];if(r[l]==null)continue;let d=u.getValue()%30,m=u.getRowNumber();if(m>a.getRowCount()){r[l]=null;continue}switch(this._isLeft||(m+=2),m%3){case 0:d*3+1!==a.getRowCountUpperPart()&&(r[l]=null);break;case 1:(Math.trunc(d/3)!==a.getErrorCorrectionLevel()||d%3!==a.getRowCountLowerPart())&&(r[l]=null);break;case 2:d+1!==a.getColumnCount()&&(r[l]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class _r{constructor(r,a){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=a,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=Dt.MAX_CODEWORDS_IN_BARCODE,a;do a=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<a);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let a=1;a<this.barcodeColumnCount+1;a++){let l=this.detectionResultColumns[a].getCodewords();for(let u=0;u<l.length;u++)l[u]!=null&&(l[u].hasValidRowNumber()||this.adjustRowNumbers(a,u,l))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<r.length;l++)if(r[l]!=null&&a[l]!=null&&r[l].getRowNumber()===a[l].getRowNumber())for(let u=1;u<=this.barcodeColumnCount;u++){let d=this.detectionResultColumns[u].getCodewords()[l];d!=null&&(d.setRowNumber(r[l].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[u].getCodewords()[l]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<a.length;l++){if(a[l]==null)continue;let u=a[l].getRowNumber(),d=0;for(let m=this.barcodeColumnCount+1;m>0&&d<this.ADJUST_ROW_NUMBER_SKIP;m--){let y=this.detectionResultColumns[m].getCodewords()[l];y!=null&&(d=_r.adjustRowNumberIfValid(u,d,y),y.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,a=this.detectionResultColumns[0].getCodewords();for(let l=0;l<a.length;l++){if(a[l]==null)continue;let u=a[l].getRowNumber(),d=0;for(let m=1;m<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;m++){let y=this.detectionResultColumns[m].getCodewords()[l];y!=null&&(d=_r.adjustRowNumberIfValid(u,d,y),y.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,a,l){return l==null||l.hasValidRowNumber()||(l.isValidRowNumber(r)?(l.setRowNumber(r),a=0):++a),a}adjustRowNumbers(r,a,l){if(!this.detectionResultColumns[r-1])return;let u=l[a],d=this.detectionResultColumns[r-1].getCodewords(),m=d;this.detectionResultColumns[r+1]!=null&&(m=this.detectionResultColumns[r+1].getCodewords());let y=new Array(14);y[2]=d[a],y[3]=m[a],a>0&&(y[0]=l[a-1],y[4]=d[a-1],y[5]=m[a-1]),a>1&&(y[8]=l[a-2],y[10]=d[a-2],y[11]=m[a-2]),a<l.length-1&&(y[1]=l[a+1],y[6]=d[a+1],y[7]=m[a+1]),a<l.length-2&&(y[9]=l[a+2],y[12]=d[a+2],y[13]=m[a+2]);for(let _ of y)if(_r.adjustRowNumber(u,_))return}static adjustRowNumber(r,a){return a==null?!1:a.hasValidRowNumber()&&a.getBucket()===r.getBucket()?(r.setRowNumber(a.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,a){this.detectionResultColumns[r]=a}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let a=new Cs;for(let l=0;l<r.getCodewords().length;l++){a.format("CW %3d:",l);for(let u=0;u<this.barcodeColumnCount+2;u++){if(this.detectionResultColumns[u]==null){a.format("    |   ");continue}let d=this.detectionResultColumns[u].getCodewords()[l];if(d==null){a.format("    |   ");continue}a.format(" %3d|%3d",d.getRowNumber(),d.getValue())}a.format("%n")}return a.toString()}}class Si{constructor(r,a,l,u){this.rowNumber=Si.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(a),this.bucket=Math.trunc(l),this.value=Math.trunc(u)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==Si.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}Si.BARCODE_ROW_UNKNOWN=-1;class ur{static initialize(){for(let r=0;r<Dt.SYMBOL_TABLE.length;r++){let a=Dt.SYMBOL_TABLE[r],l=a&1;for(let u=0;u<Dt.BARS_IN_MODULE;u++){let d=0;for(;(a&1)===l;)d+=1,a>>=1;l=a&1,ur.RATIOS_TABLE[r]||(ur.RATIOS_TABLE[r]=new Array(Dt.BARS_IN_MODULE)),ur.RATIOS_TABLE[r][Dt.BARS_IN_MODULE-u-1]=Math.fround(d/Dt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let a=ur.getDecodedCodewordValue(ur.sampleBitCounts(r));return a!==-1?a:ur.getClosestDecodedValue(r)}static sampleBitCounts(r){let a=Ve.sum(r),l=new Int32Array(Dt.BARS_IN_MODULE),u=0,d=0;for(let m=0;m<Dt.MODULES_IN_CODEWORD;m++){let y=a/(2*Dt.MODULES_IN_CODEWORD)+m*a/Dt.MODULES_IN_CODEWORD;d+r[u]<=y&&(d+=r[u],u++),l[u]++}return l}static getDecodedCodewordValue(r){let a=ur.getBitValue(r);return Dt.getCodeword(a)===-1?-1:a}static getBitValue(r){let a=0;for(let l=0;l<r.length;l++)for(let u=0;u<r[l];u++)a=a<<1|(l%2===0?1:0);return Math.trunc(a)}static getClosestDecodedValue(r){let a=Ve.sum(r),l=new Array(Dt.BARS_IN_MODULE);if(a>1)for(let m=0;m<l.length;m++)l[m]=Math.fround(r[m]/a);let u=it.MAX_VALUE,d=-1;this.bSymbolTableReady||ur.initialize();for(let m=0;m<ur.RATIOS_TABLE.length;m++){let y=0,_=ur.RATIOS_TABLE[m];for(let v=0;v<Dt.BARS_IN_MODULE;v++){let I=Math.fround(_[v]-l[v]);if(y+=Math.fround(I*I),y>=u)break}y<u&&(u=y,d=Dt.SYMBOL_TABLE[m])}return d}}ur.bSymbolTableReady=!1,ur.RATIOS_TABLE=new Array(Dt.SYMBOL_TABLE.length).map(M=>new Array(Dt.BARS_IN_MODULE));class Ss{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class Ga{static parseLong(r,a=void 0){return parseInt(r,a)}}class Is extends w{}Is.kind="NullPointerException";class qa{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,a,l){if(r==null)throw new Is;if(a<0||a>r.length||l<0||a+l>r.length||a+l<0)throw new ae;if(l===0)return;for(let u=0;u<l;u++)this.write(r[a+u])}flush(){}close(){}}class hs extends w{}class Xa extends qa{constructor(r=32){if(super(),this.count=0,r<0)throw new N("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let l=this.buf.length<<1;if(l-r<0&&(l=r),l<0){if(r<0)throw new hs;l=fe.MAX_VALUE}this.buf=ze.copyOfUint8Array(this.buf,l)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,a,l){if(a<0||a>r.length||l<0||a+l-r.length>0)throw new ae;this.ensureCapacity(this.count+l),ne.arraycopy(r,a,this.buf,this.count,l),this.count+=l}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return ze.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var Dn;(function(M){M[M.ALPHA=0]="ALPHA",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.PUNCT=3]="PUNCT",M[M.ALPHA_SHIFT=4]="ALPHA_SHIFT",M[M.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Dn||(Dn={}));function Fs(){if(typeof window<"u")return window.BigInt||null;if(typeof $h<"u")return $h.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let oa;function $i(M){if(typeof oa>"u"&&(oa=Fs()),oa===null)throw new Error("BigInt is not supported!");return oa(M)}function la(){let M=[];M[0]=$i(1);let r=$i(900);M[1]=r;for(let a=2;a<16;a++)M[a]=M[a-1]*r;return M}class we{static decode(r,a){let l=new G(""),u=U.ISO8859_1;l.enableDecoding(u);let d=1,m=r[d++],y=new Ss;for(;d<r[0];){switch(m){case we.TEXT_COMPACTION_MODE_LATCH:d=we.textCompaction(r,d,l);break;case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:d=we.byteCompaction(m,r,u,d,l);break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(r[d++]);break;case we.NUMERIC_COMPACTION_MODE_LATCH:d=we.numericCompaction(r,d,l);break;case we.ECI_CHARSET:U.getCharacterSetECIByValue(r[d++]);break;case we.ECI_GENERAL_PURPOSE:d+=2;break;case we.ECI_USER_DEFINED:d++;break;case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=we.decodeMacroBlock(r,d,y);break;case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:throw new F;default:d--,d=we.textCompaction(r,d,l);break}if(d<r.length)m=r[d++];else throw F.getFormatInstance()}if(l.length()===0)throw F.getFormatInstance();let _=new Ct(null,l.toString(),null,a);return _.setOther(y),_}static decodeMacroBlock(r,a,l){if(a+we.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw F.getFormatInstance();let u=new Int32Array(we.NUMBER_OF_SEQUENCE_CODEWORDS);for(let y=0;y<we.NUMBER_OF_SEQUENCE_CODEWORDS;y++,a++)u[y]=r[a];l.setSegmentIndex(fe.parseInt(we.decodeBase900toBase10(u,we.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new G;a=we.textCompaction(r,a,d),l.setFileId(d.toString());let m=-1;for(r[a]===we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(m=a+1);a<r[0];)switch(r[a]){case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(a++,r[a]){case we.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let y=new G;a=we.textCompaction(r,a+1,y),l.setFileName(y.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let _=new G;a=we.textCompaction(r,a+1,_),l.setSender(_.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let v=new G;a=we.textCompaction(r,a+1,v),l.setAddressee(v.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let I=new G;a=we.numericCompaction(r,a+1,I),l.setSegmentCount(fe.parseInt(I.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let k=new G;a=we.numericCompaction(r,a+1,k),l.setTimestamp(Ga.parseLong(k.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let L=new G;a=we.numericCompaction(r,a+1,L),l.setChecksum(fe.parseInt(L.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let q=new G;a=we.numericCompaction(r,a+1,q),l.setFileSize(Ga.parseLong(q.toString()));break;default:throw F.getFormatInstance()}break;case we.MACRO_PDF417_TERMINATOR:a++,l.setLastSegment(!0);break;default:throw F.getFormatInstance()}if(m!==-1){let y=a-m;l.isLastSegment()&&y--,l.setOptionalData(ze.copyOfRange(r,m,m+y))}return a}static textCompaction(r,a,l){let u=new Int32Array((r[0]-a)*2),d=new Int32Array((r[0]-a)*2),m=0,y=!1;for(;a<r[0]&&!y;){let _=r[a++];if(_<we.TEXT_COMPACTION_MODE_LATCH)u[m]=_/30,u[m+1]=_%30,m+=2;else switch(_){case we.TEXT_COMPACTION_MODE_LATCH:u[m++]=we.TEXT_COMPACTION_MODE_LATCH;break;case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:a--,y=!0;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u[m]=we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,_=r[a++],d[m]=_,m++;break}}return we.decodeTextCompaction(u,d,m,l),a}static decodeTextCompaction(r,a,l,u){let d=Dn.ALPHA,m=Dn.ALPHA,y=0;for(;y<l;){let _=r[y],v="";switch(d){case Dn.ALPHA:if(_<26)v=String.fromCharCode(65+_);else switch(_){case 26:v=" ";break;case we.LL:d=Dn.LOWER;break;case we.ML:d=Dn.MIXED;break;case we.PS:m=d,d=Dn.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.LOWER:if(_<26)v=String.fromCharCode(97+_);else switch(_){case 26:v=" ";break;case we.AS:m=d,d=Dn.ALPHA_SHIFT;break;case we.ML:d=Dn.MIXED;break;case we.PS:m=d,d=Dn.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.MIXED:if(_<we.PL)v=we.MIXED_CHARS[_];else switch(_){case we.PL:d=Dn.PUNCT;break;case 26:v=" ";break;case we.LL:d=Dn.LOWER;break;case we.AL:d=Dn.ALPHA;break;case we.PS:m=d,d=Dn.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.PUNCT:if(_<we.PAL)v=we.PUNCT_CHARS[_];else switch(_){case we.PAL:d=Dn.ALPHA;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.ALPHA_SHIFT:if(d=m,_<26)v=String.fromCharCode(65+_);else switch(_){case 26:v=" ";break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break;case Dn.PUNCT_SHIFT:if(d=m,_<we.PAL)v=we.PUNCT_CHARS[_];else switch(_){case we.PAL:d=Dn.ALPHA;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case we.TEXT_COMPACTION_MODE_LATCH:d=Dn.ALPHA;break}break}v!==""&&u.append(v),y++}}static byteCompaction(r,a,l,u,d){let m=new Xa,y=0,_=0,v=!1;switch(r){case we.BYTE_COMPACTION_MODE_LATCH:let I=new Int32Array(6),k=a[u++];for(;u<a[0]&&!v;)switch(I[y++]=k,_=900*_+k,k=a[u++],k){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:u--,v=!0;break;default:if(y%5===0&&y>0){for(let L=0;L<6;++L)m.write(Number($i(_)>>$i(8*(5-L))));_=0,y=0}break}u===a[0]&&k<we.TEXT_COMPACTION_MODE_LATCH&&(I[y++]=k);for(let L=0;L<y;L++)m.write(I[L]);break;case we.BYTE_COMPACTION_MODE_LATCH_6:for(;u<a[0]&&!v;){let L=a[u++];if(L<we.TEXT_COMPACTION_MODE_LATCH)y++,_=900*_+L;else switch(L){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:u--,v=!0;break}if(y%5===0&&y>0){for(let q=0;q<6;++q)m.write(Number($i(_)>>$i(8*(5-q))));_=0,y=0}}break}return d.append(X.decode(m.toByteArray(),l)),u}static numericCompaction(r,a,l){let u=0,d=!1,m=new Int32Array(we.MAX_NUMERIC_CODEWORDS);for(;a<r[0]&&!d;){let y=r[a++];if(a===r[0]&&(d=!0),y<we.TEXT_COMPACTION_MODE_LATCH)m[u]=y,u++;else switch(y){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:a--,d=!0;break}(u%we.MAX_NUMERIC_CODEWORDS===0||y===we.NUMERIC_COMPACTION_MODE_LATCH||d)&&u>0&&(l.append(we.decodeBase900toBase10(m,u)),u=0)}return a}static decodeBase900toBase10(r,a){let l=$i(0);for(let d=0;d<a;d++)l+=we.EXP900[a-d-1]*$i(r[d]);let u=l.toString();if(u.charAt(0)!=="1")throw new F;return u.substring(1)}}we.TEXT_COMPACTION_MODE_LATCH=900,we.BYTE_COMPACTION_MODE_LATCH=901,we.NUMERIC_COMPACTION_MODE_LATCH=902,we.BYTE_COMPACTION_MODE_LATCH_6=924,we.ECI_USER_DEFINED=925,we.ECI_GENERAL_PURPOSE=926,we.ECI_CHARSET=927,we.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,we.MACRO_PDF417_TERMINATOR=922,we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,we.MAX_NUMERIC_CODEWORDS=15,we.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,we.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,we.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,we.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,we.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,we.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,we.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,we.PL=25,we.LL=27,we.AS=27,we.ML=28,we.AL=28,we.PS=29,we.PAL=29,we.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,we.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",we.EXP900=Fs()?la():[],we.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Jt{constructor(){}static decode(r,a,l,u,d,m,y){let _=new Zi(r,a,l,u,d),v=null,I=null,k;for(let Z=!0;;Z=!1){if(a!=null&&(v=Jt.getRowIndicatorColumn(r,_,a,!0,m,y)),u!=null&&(I=Jt.getRowIndicatorColumn(r,_,u,!1,m,y)),k=Jt.merge(v,I),k==null)throw oe.getNotFoundInstance();let $=k.getBoundingBox();if(Z&&$!=null&&($.getMinY()<_.getMinY()||$.getMaxY()>_.getMaxY()))_=$;else break}k.setBoundingBox(_);let L=k.getBarcodeColumnCount()+1;k.setDetectionResultColumn(0,v),k.setDetectionResultColumn(L,I);let q=v!=null;for(let Z=1;Z<=L;Z++){let $=q?Z:L-Z;if(k.getDetectionResultColumn($)!==void 0)continue;let ue;$===0||$===L?ue=new Vi(_,$===0):ue=new Ji(_),k.setDetectionResultColumn($,ue);let _e=-1,Ze=_e;for(let Ye=_.getMinY();Ye<=_.getMaxY();Ye++){if(_e=Jt.getStartColumn(k,$,Ye,q),_e<0||_e>_.getMaxX()){if(Ze===-1)continue;_e=Ze}let He=Jt.detectCodeword(r,_.getMinX(),_.getMaxX(),q,_e,Ye,m,y);He!=null&&(ue.setCodeword(Ye,He),Ze=_e,m=Math.min(m,He.getWidth()),y=Math.max(y,He.getWidth()))}}return Jt.createDecoderResult(k)}static merge(r,a){if(r==null&&a==null)return null;let l=Jt.getBarcodeMetadata(r,a);if(l==null)return null;let u=Zi.merge(Jt.adjustBoundingBox(r),Jt.adjustBoundingBox(a));return new _r(l,u)}static adjustBoundingBox(r){if(r==null)return null;let a=r.getRowHeights();if(a==null)return null;let l=Jt.getMax(a),u=0;for(let y of a)if(u+=l-y,y>0)break;let d=r.getCodewords();for(let y=0;u>0&&d[y]==null;y++)u--;let m=0;for(let y=a.length-1;y>=0&&(m+=l-a[y],!(a[y]>0));y--);for(let y=d.length-1;m>0&&d[y]==null;y--)m--;return r.getBoundingBox().addMissingRows(u,m,r.isLeft())}static getMax(r){let a=-1;for(let l of r)a=Math.max(a,l);return a}static getBarcodeMetadata(r,a){let l;if(r==null||(l=r.getBarcodeMetadata())==null)return a==null?null:a.getBarcodeMetadata();let u;return a==null||(u=a.getBarcodeMetadata())==null?l:l.getColumnCount()!==u.getColumnCount()&&l.getErrorCorrectionLevel()!==u.getErrorCorrectionLevel()&&l.getRowCount()!==u.getRowCount()?null:l}static getRowIndicatorColumn(r,a,l,u,d,m){let y=new Vi(a,u);for(let _=0;_<2;_++){let v=_===0?1:-1,I=Math.trunc(Math.trunc(l.getX()));for(let k=Math.trunc(Math.trunc(l.getY()));k<=a.getMaxY()&&k>=a.getMinY();k+=v){let L=Jt.detectCodeword(r,0,r.getWidth(),u,I,k,d,m);L!=null&&(y.setCodeword(k,L),u?I=L.getStartX():I=L.getEndX())}}return y}static adjustCodewordCount(r,a){let l=a[0][1],u=l.getValue(),d=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-Jt.getNumberOfECCodeWords(r.getBarcodeECLevel());if(u.length===0){if(d<1||d>Dt.MAX_CODEWORDS_IN_BARCODE)throw oe.getNotFoundInstance();l.setValue(d)}else u[0]!==d&&l.setValue(d)}static createDecoderResult(r){let a=Jt.createBarcodeMatrix(r);Jt.adjustCodewordCount(r,a);let l=new Array,u=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),d=[],m=new Array;for(let _=0;_<r.getBarcodeRowCount();_++)for(let v=0;v<r.getBarcodeColumnCount();v++){let I=a[_][v+1].getValue(),k=_*r.getBarcodeColumnCount()+v;I.length===0?l.push(k):I.length===1?u[k]=I[0]:(m.push(k),d.push(I))}let y=new Array(d.length);for(let _=0;_<y.length;_++)y[_]=d[_];return Jt.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),u,Dt.toIntArray(l),Dt.toIntArray(m),y)}static createDecoderResultFromAmbiguousValues(r,a,l,u,d){let m=new Int32Array(u.length),y=100;for(;y-- >0;){for(let _=0;_<m.length;_++)a[u[_]]=d[_][m[_]];try{return Jt.decodeCodewords(a,r,l)}catch(_){if(!(_ instanceof B))throw _}if(m.length===0)throw B.getChecksumInstance();for(let _=0;_<m.length;_++)if(m[_]<d[_].length-1){m[_]++;break}else if(m[_]=0,_===m.length-1)throw B.getChecksumInstance()}throw B.getChecksumInstance()}static createBarcodeMatrix(r){let a=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let u=0;u<a.length;u++)for(let d=0;d<a[u].length;d++)a[u][d]=new Ci;let l=0;for(let u of r.getDetectionResultColumns()){if(u!=null){for(let d of u.getCodewords())if(d!=null){let m=d.getRowNumber();if(m>=0){if(m>=a.length)continue;a[m][l].setValue(d.getValue())}}}l++}return a}static isValidBarcodeColumn(r,a){return a>=0&&a<=r.getBarcodeColumnCount()+1}static getStartColumn(r,a,l,u){let d=u?1:-1,m=null;if(Jt.isValidBarcodeColumn(r,a-d)&&(m=r.getDetectionResultColumn(a-d).getCodeword(l)),m!=null)return u?m.getEndX():m.getStartX();if(m=r.getDetectionResultColumn(a).getCodewordNearby(l),m!=null)return u?m.getStartX():m.getEndX();if(Jt.isValidBarcodeColumn(r,a-d)&&(m=r.getDetectionResultColumn(a-d).getCodewordNearby(l)),m!=null)return u?m.getEndX():m.getStartX();let y=0;for(;Jt.isValidBarcodeColumn(r,a-d);){a-=d;for(let _ of r.getDetectionResultColumn(a).getCodewords())if(_!=null)return(u?_.getEndX():_.getStartX())+d*y*(_.getEndX()-_.getStartX());y++}return u?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,a,l,u,d,m,y,_){d=Jt.adjustCodewordStartColumn(r,a,l,u,d,m);let v=Jt.getModuleBitCount(r,a,l,u,d,m);if(v==null)return null;let I,k=Ve.sum(v);if(u)I=d+k;else{for(let Z=0;Z<v.length/2;Z++){let $=v[Z];v[Z]=v[v.length-1-Z],v[v.length-1-Z]=$}I=d,d=I-k}if(!Jt.checkCodewordSkew(k,y,_))return null;let L=ur.getDecodedValue(v),q=Dt.getCodeword(L);return q===-1?null:new Si(d,I,Jt.getCodewordBucketNumber(L),q)}static getModuleBitCount(r,a,l,u,d,m){let y=d,_=new Int32Array(8),v=0,I=u?1:-1,k=u;for(;(u?y<l:y>=a)&&v<_.length;)r.get(y,m)===k?(_[v]++,y+=I):(v++,k=!k);return v===_.length||y===(u?l:a)&&v===_.length-1?_:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,a,l,u,d,m){let y=d,_=u?-1:1;for(let v=0;v<2;v++){for(;(u?y>=a:y<l)&&u===r.get(y,m);){if(Math.abs(d-y)>Jt.CODEWORD_SKEW_SIZE)return d;y+=_}_=-_,u=!u}return y}static checkCodewordSkew(r,a,l){return a-Jt.CODEWORD_SKEW_SIZE<=r&&r<=l+Jt.CODEWORD_SKEW_SIZE}static decodeCodewords(r,a,l){if(r.length===0)throw F.getFormatInstance();let u=1<<a+1,d=Jt.correctErrors(r,l,u);Jt.verifyCodewordCount(r,u);let m=we.decode(r,""+a);return m.setErrorsCorrected(d),m.setErasures(l.length),m}static correctErrors(r,a,l){if(a!=null&&a.length>l/2+Jt.MAX_ERRORS||l<0||l>Jt.MAX_EC_CODEWORDS)throw B.getChecksumInstance();return Jt.errorCorrection.decode(r,l,a)}static verifyCodewordCount(r,a){if(r.length<4)throw F.getFormatInstance();let l=r[0];if(l>r.length)throw F.getFormatInstance();if(l===0)if(a<r.length)r[0]=r.length-a;else throw F.getFormatInstance()}static getBitCountForCodeword(r){let a=new Int32Array(8),l=0,u=a.length-1;for(;!((r&1)!==l&&(l=r&1,u--,u<0));)a[u]++,r>>=1;return a}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return Jt.getCodewordBucketNumber(Jt.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let a=new Cs;for(let l=0;l<r.length;l++){a.format("Row %2d: ",l);for(let u=0;u<r[l].length;u++){let d=r[l][u];d.getValue().length===0?a.format("        ",null):a.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}a.format("%n")}return a.toString()}}Jt.CODEWORD_SKEW_SIZE=2,Jt.MAX_ERRORS=3,Jt.MAX_EC_CODEWORDS=512,Jt.errorCorrection=new Qi;class mr{decode(r,a=null){let l=mr.decode(r,a,!1);if(l==null||l.length===0||l[0]==null)throw oe.getNotFoundInstance();return l[0]}decodeMultiple(r,a=null){try{return mr.decode(r,a,!0)}catch(l){throw l instanceof F||l instanceof B?oe.getNotFoundInstance():l}}static decode(r,a,l){const u=new Array,d=Ft.detectMultiple(r,a,l);for(const m of d.getPoints()){const y=Jt.decode(d.getBits(),m[4],m[5],m[6],m[7],mr.getMinCodewordWidth(m),mr.getMaxCodewordWidth(m)),_=new Ce(y.getText(),y.getRawBytes(),void 0,m,me.PDF_417);_.putMetadata(mt.ERROR_CORRECTION_LEVEL,y.getECLevel());const v=y.getOther();v!=null&&_.putMetadata(mt.PDF417_EXTRA_METADATA,v),u.push(_)}return u.map(m=>m)}static getMaxWidth(r,a){return r==null||a==null?0:Math.trunc(Math.abs(r.getX()-a.getX()))}static getMinWidth(r,a){return r==null||a==null?fe.MAX_VALUE:Math.trunc(Math.abs(r.getX()-a.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(mr.getMaxWidth(r[0],r[4]),mr.getMaxWidth(r[6],r[2])*Dt.MODULES_IN_CODEWORD/Dt.MODULES_IN_STOP_PATTERN),Math.max(mr.getMaxWidth(r[1],r[5]),mr.getMaxWidth(r[7],r[3])*Dt.MODULES_IN_CODEWORD/Dt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(mr.getMinWidth(r[0],r[4]),mr.getMinWidth(r[6],r[2])*Dt.MODULES_IN_CODEWORD/Dt.MODULES_IN_STOP_PATTERN),Math.min(mr.getMinWidth(r[1],r[5]),mr.getMinWidth(r[7],r[3])*Dt.MODULES_IN_CODEWORD/Dt.MODULES_IN_STOP_PATTERN)))}reset(){}}class ca extends w{}ca.kind="ReaderException";class jo{constructor(r,a){this.verbose=r===!0,a&&this.setHints(a)}decode(r,a){return a&&this.setHints(a),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const a=!o(r)&&r.get(Qe.TRY_HARDER)===!0,l=o(r)?null:r.get(Qe.POSSIBLE_FORMATS),u=new Array;if(!o(l)){const d=l.some(m=>m===me.UPC_A||m===me.UPC_E||m===me.EAN_13||m===me.EAN_8||m===me.CODABAR||m===me.CODE_39||m===me.CODE_93||m===me.CODE_128||m===me.ITF||m===me.RSS_14||m===me.RSS_EXPANDED);d&&!a&&u.push(new Je(r,this.verbose)),l.includes(me.QR_CODE)&&u.push(new xi),l.includes(me.DATA_MATRIX)&&u.push(new tr),l.includes(me.AZTEC)&&u.push(new Ti),l.includes(me.PDF_417)&&u.push(new mr),d&&a&&u.push(new Je(r,this.verbose))}u.length===0&&(a||u.push(new Je(r,this.verbose)),u.push(new xi),u.push(new tr),u.push(new Ti),u.push(new mr),a&&u.push(new Je(r,this.verbose))),this.readers=u}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new ca("No readers where selected, nothing can be read.");for(const a of this.readers)try{return a.decode(r,this.hints)}catch(l){if(l instanceof ca)continue}throw new oe("No MultiFormat Readers were able to detect the code.")}}class ds extends ve{constructor(r=null,a=500){const l=new jo;l.setHints(r),super(l,a)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class bl extends ve{constructor(r=500){super(new mr,r)}}class vl extends ve{constructor(r=500){super(new xi,r)}}var Ya;(function(M){M[M.ERROR_CORRECTION=0]="ERROR_CORRECTION",M[M.CHARACTER_SET=1]="CHARACTER_SET",M[M.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",M[M.MIN_SIZE=3]="MIN_SIZE",M[M.MAX_SIZE=4]="MAX_SIZE",M[M.MARGIN=5]="MARGIN",M[M.PDF417_COMPACT=6]="PDF417_COMPACT",M[M.PDF417_COMPACTION=7]="PDF417_COMPACTION",M[M.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",M[M.AZTEC_LAYERS=9]="AZTEC_LAYERS",M[M.QR_VERSION=10]="QR_VERSION"})(Ya||(Ya={}));var pr=Ya;class fs{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new Qt(r,Int32Array.from([1])))}buildGenerator(r){const a=this.cachedGenerators;if(r>=a.length){let l=a[a.length-1];const u=this.field;for(let d=a.length;d<=r;d++){const m=l.multiply(new Qt(u,Int32Array.from([1,u.exp(d-1+u.getGeneratorBase())])));a.push(m),l=m}}return a[r]}encode(r,a){if(a===0)throw new N("No error correction bytes");const l=r.length-a;if(l<=0)throw new N("No data bytes provided");const u=this.buildGenerator(a),d=new Int32Array(l);ne.arraycopy(r,0,d,0,l);let m=new Qt(this.field,d);m=m.multiplyByMonomial(a,1);const _=m.divide(u)[1].getCoefficients(),v=a-_.length;for(let I=0;I<v;I++)r[l+I]=0;ne.arraycopy(_,0,r,l+v,_.length)}}class fn{constructor(){}static applyMaskPenaltyRule1(r){return fn.applyMaskPenaltyRule1Internal(r,!0)+fn.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let a=0;const l=r.getArray(),u=r.getWidth(),d=r.getHeight();for(let m=0;m<d-1;m++){const y=l[m];for(let _=0;_<u-1;_++){const v=y[_];v===y[_+1]&&v===l[m+1][_]&&v===l[m+1][_+1]&&a++}}return fn.N2*a}static applyMaskPenaltyRule3(r){let a=0;const l=r.getArray(),u=r.getWidth(),d=r.getHeight();for(let m=0;m<d;m++)for(let y=0;y<u;y++){const _=l[m];y+6<u&&_[y]===1&&_[y+1]===0&&_[y+2]===1&&_[y+3]===1&&_[y+4]===1&&_[y+5]===0&&_[y+6]===1&&(fn.isWhiteHorizontal(_,y-4,y)||fn.isWhiteHorizontal(_,y+7,y+11))&&a++,m+6<d&&l[m][y]===1&&l[m+1][y]===0&&l[m+2][y]===1&&l[m+3][y]===1&&l[m+4][y]===1&&l[m+5][y]===0&&l[m+6][y]===1&&(fn.isWhiteVertical(l,y,m-4,m)||fn.isWhiteVertical(l,y,m+7,m+11))&&a++}return a*fn.N3}static isWhiteHorizontal(r,a,l){a=Math.max(a,0),l=Math.min(l,r.length);for(let u=a;u<l;u++)if(r[u]===1)return!1;return!0}static isWhiteVertical(r,a,l,u){l=Math.max(l,0),u=Math.min(u,r.length);for(let d=l;d<u;d++)if(r[d][a]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let a=0;const l=r.getArray(),u=r.getWidth(),d=r.getHeight();for(let _=0;_<d;_++){const v=l[_];for(let I=0;I<u;I++)v[I]===1&&a++}const m=r.getHeight()*r.getWidth();return Math.floor(Math.abs(a*2-m)*10/m)*fn.N4}static getDataMaskBit(r,a,l){let u,d;switch(r){case 0:u=l+a&1;break;case 1:u=l&1;break;case 2:u=a%3;break;case 3:u=(l+a)%3;break;case 4:u=Math.floor(l/2)+Math.floor(a/3)&1;break;case 5:d=l*a,u=(d&1)+d%3;break;case 6:d=l*a,u=(d&1)+d%3&1;break;case 7:d=l*a,u=d%3+(l+a&1)&1;break;default:throw new N("Invalid mask pattern: "+r)}return u===0}static applyMaskPenaltyRule1Internal(r,a){let l=0;const u=a?r.getHeight():r.getWidth(),d=a?r.getWidth():r.getHeight(),m=r.getArray();for(let y=0;y<u;y++){let _=0,v=-1;for(let I=0;I<d;I++){const k=a?m[y][I]:m[I][y];k===v?_++:(_>=5&&(l+=fn.N1+(_-5)),_=1,v=k)}_>=5&&(l+=fn.N1+(_-5))}return l}}fn.N1=3,fn.N2=3,fn.N3=40,fn.N4=10;class ua{constructor(r,a){this.width=r,this.height=a;const l=new Array(a);for(let u=0;u!==a;u++)l[u]=new Uint8Array(r);this.bytes=l}getHeight(){return this.height}getWidth(){return this.width}get(r,a){return this.bytes[a][r]}getArray(){return this.bytes}setNumber(r,a,l){this.bytes[a][r]=l}setBoolean(r,a,l){this.bytes[a][r]=l?1:0}clear(r){for(const a of this.bytes)ze.fill(a,r)}equals(r){if(!(r instanceof ua))return!1;const a=r;if(this.width!==a.width||this.height!==a.height)return!1;for(let l=0,u=this.height;l<u;++l){const d=this.bytes[l],m=a.bytes[l];for(let y=0,_=this.width;y<_;++y)if(d[y]!==m[y])return!1}return!0}toString(){const r=new G;for(let a=0,l=this.height;a<l;++a){const u=this.bytes[a];for(let d=0,m=this.width;d<m;++d)switch(u[d]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class gs{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new G;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<gs.NUM_MASK_PATTERNS}}gs.NUM_MASK_PATTERNS=8;class mn extends w{}mn.kind="WriterException";class p{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,a,l,u,d){p.clearMatrix(d),p.embedBasicPatterns(l,d),p.embedTypeInfo(a,u,d),p.maybeEmbedVersionInfo(l,d),p.embedDataBits(r,u,d)}static embedBasicPatterns(r,a){p.embedPositionDetectionPatternsAndSeparators(a),p.embedDarkDotAtLeftBottomCorner(a),p.maybeEmbedPositionAdjustmentPatterns(r,a),p.embedTimingPatterns(a)}static embedTypeInfo(r,a,l){const u=new Ge;p.makeTypeInfoBits(r,a,u);for(let d=0,m=u.getSize();d<m;++d){const y=u.get(u.getSize()-1-d),_=p.TYPE_INFO_COORDINATES[d],v=_[0],I=_[1];if(l.setBoolean(v,I,y),d<8){const k=l.getWidth()-d-1;l.setBoolean(k,8,y)}else{const L=l.getHeight()-7+(d-8);l.setBoolean(8,L,y)}}}static maybeEmbedVersionInfo(r,a){if(r.getVersionNumber()<7)return;const l=new Ge;p.makeVersionInfoBits(r,l);let u=17;for(let d=0;d<6;++d)for(let m=0;m<3;++m){const y=l.get(u);u--,a.setBoolean(d,a.getHeight()-11+m,y),a.setBoolean(a.getHeight()-11+m,d,y)}}static embedDataBits(r,a,l){let u=0,d=-1,m=l.getWidth()-1,y=l.getHeight()-1;for(;m>0;){for(m===6&&(m-=1);y>=0&&y<l.getHeight();){for(let _=0;_<2;++_){const v=m-_;if(!p.isEmpty(l.get(v,y)))continue;let I;u<r.getSize()?(I=r.get(u),++u):I=!1,a!==255&&fn.getDataMaskBit(a,v,y)&&(I=!I),l.setBoolean(v,y,I)}y+=d}d=-d,y+=d,m-=2}if(u!==r.getSize())throw new mn("Not all bits consumed: "+u+"/"+r.getSize())}static findMSBSet(r){return 32-fe.numberOfLeadingZeros(r)}static calculateBCHCode(r,a){if(a===0)throw new N("0 polynomial");const l=p.findMSBSet(a);for(r<<=l-1;p.findMSBSet(r)>=l;)r^=a<<p.findMSBSet(r)-l;return r}static makeTypeInfoBits(r,a,l){if(!gs.isValidMaskPattern(a))throw new mn("Invalid mask pattern");const u=r.getBits()<<3|a;l.appendBits(u,5);const d=p.calculateBCHCode(u,p.TYPE_INFO_POLY);l.appendBits(d,10);const m=new Ge;if(m.appendBits(p.TYPE_INFO_MASK_PATTERN,15),l.xor(m),l.getSize()!==15)throw new mn("should not happen but we got: "+l.getSize())}static makeVersionInfoBits(r,a){a.appendBits(r.getVersionNumber(),6);const l=p.calculateBCHCode(r.getVersionNumber(),p.VERSION_INFO_POLY);if(a.appendBits(l,12),a.getSize()!==18)throw new mn("should not happen but we got: "+a.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let a=8;a<r.getWidth()-8;++a){const l=(a+1)%2;p.isEmpty(r.get(a,6))&&r.setNumber(a,6,l),p.isEmpty(r.get(6,a))&&r.setNumber(6,a,l)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new mn;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,a,l){for(let u=0;u<8;++u){if(!p.isEmpty(l.get(r+u,a)))throw new mn;l.setNumber(r+u,a,0)}}static embedVerticalSeparationPattern(r,a,l){for(let u=0;u<7;++u){if(!p.isEmpty(l.get(r,a+u)))throw new mn;l.setNumber(r,a+u,0)}}static embedPositionAdjustmentPattern(r,a,l){for(let u=0;u<5;++u){const d=p.POSITION_ADJUSTMENT_PATTERN[u];for(let m=0;m<5;++m)l.setNumber(r+m,a+u,d[m])}}static embedPositionDetectionPattern(r,a,l){for(let u=0;u<7;++u){const d=p.POSITION_DETECTION_PATTERN[u];for(let m=0;m<7;++m)l.setNumber(r+m,a+u,d[m])}}static embedPositionDetectionPatternsAndSeparators(r){const a=p.POSITION_DETECTION_PATTERN[0].length;p.embedPositionDetectionPattern(0,0,r),p.embedPositionDetectionPattern(r.getWidth()-a,0,r),p.embedPositionDetectionPattern(0,r.getWidth()-a,r);const l=8;p.embedHorizontalSeparationPattern(0,l-1,r),p.embedHorizontalSeparationPattern(r.getWidth()-l,l-1,r),p.embedHorizontalSeparationPattern(0,r.getWidth()-l,r);const u=7;p.embedVerticalSeparationPattern(u,0,r),p.embedVerticalSeparationPattern(r.getHeight()-u-1,0,r),p.embedVerticalSeparationPattern(u,r.getHeight()-u,r)}static maybeEmbedPositionAdjustmentPatterns(r,a){if(r.getVersionNumber()<2)return;const l=r.getVersionNumber()-1,u=p.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[l];for(let d=0,m=u.length;d!==m;d++){const y=u[d];if(y>=0)for(let _=0;_!==m;_++){const v=u[_];v>=0&&p.isEmpty(a.get(v,y))&&p.embedPositionAdjustmentPattern(v-2,y-2,a)}}}}p.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),p.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),p.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),p.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),p.VERSION_INFO_POLY=7973,p.TYPE_INFO_POLY=1335,p.TYPE_INFO_MASK_PATTERN=21522;class S{constructor(r,a){this.dataBytes=r,this.errorCorrectionBytes=a}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class D{constructor(){}static calculateMaskPenalty(r){return fn.applyMaskPenaltyRule1(r)+fn.applyMaskPenaltyRule2(r)+fn.applyMaskPenaltyRule3(r)+fn.applyMaskPenaltyRule4(r)}static encode(r,a,l=null){let u=D.DEFAULT_BYTE_MODE_ENCODING;const d=l!==null&&l.get(pr.CHARACTER_SET)!==void 0;d&&(u=l.get(pr.CHARACTER_SET).toString());const m=this.chooseMode(r,u),y=new Ge;if(m===St.BYTE&&(d||D.DEFAULT_BYTE_MODE_ENCODING!==u)){const Ye=U.getCharacterSetECIByName(u);Ye!==void 0&&this.appendECI(Ye,y)}this.appendModeInfo(m,y);const _=new Ge;this.appendBytes(r,m,_,u);let v;if(l!==null&&l.get(pr.QR_VERSION)!==void 0){const Ye=Number.parseInt(l.get(pr.QR_VERSION).toString(),10);v=bt.getVersionForNumber(Ye);const He=this.calculateBitsNeeded(m,y,_,v);if(!this.willFit(He,v,a))throw new mn("Data too big for requested version")}else v=this.recommendVersion(a,m,y,_);const I=new Ge;I.appendBitArray(y);const k=m===St.BYTE?_.getSizeInBytes():r.length;this.appendLengthInfo(k,v,m,I),I.appendBitArray(_);const L=v.getECBlocksForLevel(a),q=v.getTotalCodewords()-L.getTotalECCodewords();this.terminateBits(q,I);const Z=this.interleaveWithECBytes(I,v.getTotalCodewords(),q,L.getNumBlocks()),$=new gs;$.setECLevel(a),$.setMode(m),$.setVersion(v);const ue=v.getDimensionForVersion(),_e=new ua(ue,ue),Ze=this.chooseMaskPattern(Z,a,v,_e);return $.setMaskPattern(Ze),p.buildMatrix(Z,a,v,Ze,_e),$.setMatrix(_e),$}static recommendVersion(r,a,l,u){const d=this.calculateBitsNeeded(a,l,u,bt.getVersionForNumber(1)),m=this.chooseVersion(d,r),y=this.calculateBitsNeeded(a,l,u,m);return this.chooseVersion(y,r)}static calculateBitsNeeded(r,a,l,u){return a.getSize()+r.getCharacterCountBits(u)+l.getSize()}static getAlphanumericCode(r){return r<D.ALPHANUMERIC_TABLE.length?D.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,a=null){if(U.SJIS.getName()===a&&this.isOnlyDoubleByteKanji(r))return St.KANJI;let l=!1,u=!1;for(let d=0,m=r.length;d<m;++d){const y=r.charAt(d);if(D.isDigit(y))l=!0;else if(this.getAlphanumericCode(y.charCodeAt(0))!==-1)u=!0;else return St.BYTE}return u?St.ALPHANUMERIC:l?St.NUMERIC:St.BYTE}static isOnlyDoubleByteKanji(r){let a;try{a=X.encode(r,U.SJIS)}catch{return!1}const l=a.length;if(l%2!==0)return!1;for(let u=0;u<l;u+=2){const d=a[u]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(r,a,l,u){let d=Number.MAX_SAFE_INTEGER,m=-1;for(let y=0;y<gs.NUM_MASK_PATTERNS;y++){p.buildMatrix(r,a,l,y,u);let _=this.calculateMaskPenalty(u);_<d&&(d=_,m=y)}return m}static chooseVersion(r,a){for(let l=1;l<=40;l++){const u=bt.getVersionForNumber(l);if(D.willFit(r,u,a))return u}throw new mn("Data too big")}static willFit(r,a,l){const u=a.getTotalCodewords(),m=a.getECBlocksForLevel(l).getTotalECCodewords(),y=u-m,_=(r+7)/8;return y>=_}static terminateBits(r,a){const l=r*8;if(a.getSize()>l)throw new mn("data bits cannot fit in the QR Code"+a.getSize()+" > "+l);for(let m=0;m<4&&a.getSize()<l;++m)a.appendBit(!1);const u=a.getSize()&7;if(u>0)for(let m=u;m<8;m++)a.appendBit(!1);const d=r-a.getSizeInBytes();for(let m=0;m<d;++m)a.appendBits((m&1)===0?236:17,8);if(a.getSize()!==l)throw new mn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,a,l,u,d,m){if(u>=l)throw new mn("Block ID too large");const y=r%l,_=l-y,v=Math.floor(r/l),I=v+1,k=Math.floor(a/l),L=k+1,q=v-k,Z=I-L;if(q!==Z)throw new mn("EC bytes mismatch");if(l!==_+y)throw new mn("RS blocks mismatch");if(r!==(k+q)*_+(L+Z)*y)throw new mn("Total bytes mismatch");u<_?(d[0]=k,m[0]=q):(d[0]=L,m[0]=Z)}static interleaveWithECBytes(r,a,l,u){if(r.getSizeInBytes()!==l)throw new mn("Number of bits and data bytes does not match");let d=0,m=0,y=0;const _=new Array;for(let I=0;I<u;++I){const k=new Int32Array(1),L=new Int32Array(1);D.getNumDataBytesAndNumECBytesForBlockID(a,l,u,I,k,L);const q=k[0],Z=new Uint8Array(q);r.toBytes(8*d,Z,0,q);const $=D.generateECBytes(Z,L[0]);_.push(new S(Z,$)),m=Math.max(m,q),y=Math.max(y,$.length),d+=k[0]}if(l!==d)throw new mn("Data bytes does not match offset");const v=new Ge;for(let I=0;I<m;++I)for(const k of _){const L=k.getDataBytes();I<L.length&&v.appendBits(L[I],8)}for(let I=0;I<y;++I)for(const k of _){const L=k.getErrorCorrectionBytes();I<L.length&&v.appendBits(L[I],8)}if(a!==v.getSizeInBytes())throw new mn("Interleaving error: "+a+" and "+v.getSizeInBytes()+" differ.");return v}static generateECBytes(r,a){const l=r.length,u=new Int32Array(l+a);for(let m=0;m<l;m++)u[m]=r[m]&255;new fs(Ot.QR_CODE_FIELD_256).encode(u,a);const d=new Uint8Array(a);for(let m=0;m<a;m++)d[m]=u[l+m];return d}static appendModeInfo(r,a){a.appendBits(r.getBits(),4)}static appendLengthInfo(r,a,l,u){const d=l.getCharacterCountBits(a);if(r>=1<<d)throw new mn(r+" is bigger than "+((1<<d)-1));u.appendBits(r,d)}static appendBytes(r,a,l,u){switch(a){case St.NUMERIC:D.appendNumericBytes(r,l);break;case St.ALPHANUMERIC:D.appendAlphanumericBytes(r,l);break;case St.BYTE:D.append8BitBytes(r,l,u);break;case St.KANJI:D.appendKanjiBytes(r,l);break;default:throw new mn("Invalid mode: "+a)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const a=D.getDigit(r);return a>=0&&a<=9}static appendNumericBytes(r,a){const l=r.length;let u=0;for(;u<l;){const d=D.getDigit(r.charAt(u));if(u+2<l){const m=D.getDigit(r.charAt(u+1)),y=D.getDigit(r.charAt(u+2));a.appendBits(d*100+m*10+y,10),u+=3}else if(u+1<l){const m=D.getDigit(r.charAt(u+1));a.appendBits(d*10+m,7),u+=2}else a.appendBits(d,4),u++}}static appendAlphanumericBytes(r,a){const l=r.length;let u=0;for(;u<l;){const d=D.getAlphanumericCode(r.charCodeAt(u));if(d===-1)throw new mn;if(u+1<l){const m=D.getAlphanumericCode(r.charCodeAt(u+1));if(m===-1)throw new mn;a.appendBits(d*45+m,11),u+=2}else a.appendBits(d,6),u++}}static append8BitBytes(r,a,l){let u;try{u=X.encode(r,l)}catch(d){throw new mn(d)}for(let d=0,m=u.length;d!==m;d++){const y=u[d];a.appendBits(y,8)}}static appendKanjiBytes(r,a){let l;try{l=X.encode(r,U.SJIS)}catch(d){throw new mn(d)}const u=l.length;for(let d=0;d<u;d+=2){const m=l[d]&255,y=l[d+1]&255,_=m<<8&4294967295|y;let v=-1;if(_>=33088&&_<=40956?v=_-33088:_>=57408&&_<=60351&&(v=_-49472),v===-1)throw new mn("Invalid byte sequence");const I=(v>>8)*192+(v&255);a.appendBits(I,13)}}static appendECI(r,a){a.appendBits(St.ECI.getBits(),4),a.appendBits(r.getValue(),8)}}D.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),D.DEFAULT_BYTE_MODE_ENCODING=U.UTF8.getName();class j{write(r,a,l,u=null){if(r.length===0)throw new N("Found empty contents");if(a<0||l<0)throw new N("Requested dimensions are too small: "+a+"x"+l);let d=on.L,m=j.QUIET_ZONE_SIZE;u!==null&&(u.get(pr.ERROR_CORRECTION)!==void 0&&(d=on.fromString(u.get(pr.ERROR_CORRECTION).toString())),u.get(pr.MARGIN)!==void 0&&(m=Number.parseInt(u.get(pr.MARGIN).toString(),10)));const y=D.encode(r,d,u);return this.renderResult(y,a,l,m)}writeToDom(r,a,l,u,d=null){typeof r=="string"&&(r=document.querySelector(r));const m=this.write(a,l,u,d);r&&r.appendChild(m)}renderResult(r,a,l,u){const d=r.getMatrix();if(d===null)throw new On;const m=d.getWidth(),y=d.getHeight(),_=m+u*2,v=y+u*2,I=Math.max(a,_),k=Math.max(l,v),L=Math.min(Math.floor(I/_),Math.floor(k/v)),q=Math.floor((I-m*L)/2),Z=Math.floor((k-y*L)/2),$=this.createSVGElement(I,k);for(let ue=0,_e=Z;ue<y;ue++,_e+=L)for(let Ze=0,Ye=q;Ze<m;Ze++,Ye+=L)if(d.get(Ze,ue)===1){const He=this.createSvgRectElement(Ye,_e,L,L);$.appendChild(He)}return $}createSVGElement(r,a){const l=document.createElementNS(j.SVG_NS,"svg");return l.setAttributeNS(null,"height",r.toString()),l.setAttributeNS(null,"width",a.toString()),l}createSvgRectElement(r,a,l,u){const d=document.createElementNS(j.SVG_NS,"rect");return d.setAttributeNS(null,"x",r.toString()),d.setAttributeNS(null,"y",a.toString()),d.setAttributeNS(null,"height",l.toString()),d.setAttributeNS(null,"width",u.toString()),d.setAttributeNS(null,"fill","#000000"),d}}j.QUIET_ZONE_SIZE=4,j.SVG_NS="http://www.w3.org/2000/svg";class ce{encode(r,a,l,u,d){if(r.length===0)throw new N("Found empty contents");if(a!==me.QR_CODE)throw new N("Can only encode QR_CODE, but got "+a);if(l<0||u<0)throw new N(`Requested dimensions are too small: ${l}x${u}`);let m=on.L,y=ce.QUIET_ZONE_SIZE;d!==null&&(d.get(pr.ERROR_CORRECTION)!==void 0&&(m=on.fromString(d.get(pr.ERROR_CORRECTION).toString())),d.get(pr.MARGIN)!==void 0&&(y=Number.parseInt(d.get(pr.MARGIN).toString(),10)));const _=D.encode(r,m,d);return ce.renderResult(_,l,u,y)}static renderResult(r,a,l,u){const d=r.getMatrix();if(d===null)throw new On;const m=d.getWidth(),y=d.getHeight(),_=m+u*2,v=y+u*2,I=Math.max(a,_),k=Math.max(l,v),L=Math.min(Math.floor(I/_),Math.floor(k/v)),q=Math.floor((I-m*L)/2),Z=Math.floor((k-y*L)/2),$=new ot(I,k);for(let ue=0,_e=Z;ue<y;ue++,_e+=L)for(let Ze=0,Ye=q;Ze<m;Ze++,Ye+=L)d.get(Ze,ue)===1&&$.setRegion(Ye,_e,L,L);return $}}ce.QUIET_ZONE_SIZE=4;class Ae{encode(r,a,l,u,d){let m;switch(a){case me.QR_CODE:m=new ce;break;default:throw new N("No encoder available for format "+a)}return m.encode(r,a,l,u,d)}}class $e extends We{constructor(r,a,l,u,d,m,y,_){if(super(m,y),this.yuvData=r,this.dataWidth=a,this.dataHeight=l,this.left=u,this.top=d,u+m>a||d+y>l)throw new N("Crop rectangle does not fit within image data.");_&&this.reverseHorizontal(m,y)}getRow(r,a){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const l=this.getWidth();(a==null||a.length<l)&&(a=new Uint8ClampedArray(l));const u=(r+this.top)*this.dataWidth+this.left;return ne.arraycopy(this.yuvData,u,a,0,l),a}getMatrix(){const r=this.getWidth(),a=this.getHeight();if(r===this.dataWidth&&a===this.dataHeight)return this.yuvData;const l=r*a,u=new Uint8ClampedArray(l);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ne.arraycopy(this.yuvData,d,u,0,l),u;for(let m=0;m<a;m++){const y=m*r;ne.arraycopy(this.yuvData,d,u,y,r),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,a,l,u){return new $e(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+a,l,u,!1)}renderThumbnail(){const r=this.getWidth()/$e.THUMBNAIL_SCALE_FACTOR,a=this.getHeight()/$e.THUMBNAIL_SCALE_FACTOR,l=new Int32Array(r*a),u=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let m=0;m<a;m++){const y=m*r;for(let _=0;_<r;_++){const v=u[d+_*$e.THUMBNAIL_SCALE_FACTOR]&255;l[y+_]=4278190080|v*65793}d+=this.dataWidth*$e.THUMBNAIL_SCALE_FACTOR}return l}getThumbnailWidth(){return this.getWidth()/$e.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/$e.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,a){const l=this.yuvData;for(let u=0,d=this.top*this.dataWidth+this.left;u<a;u++,d+=this.dataWidth){const m=d+r/2;for(let y=d,_=d+r-1;y<m;y++,_--){const v=l[y];l[y]=l[_],l[_]=v}}}invert(){return new qe(this)}}$e.THUMBNAIL_SCALE_FACTOR=2;class Yt extends We{constructor(r,a,l,u,d,m,y){if(super(a,l),this.dataWidth=u,this.dataHeight=d,this.left=m,this.top=y,r.BYTES_PER_ELEMENT===4){const _=a*l,v=new Uint8ClampedArray(_);for(let I=0;I<_;I++){const k=r[I],L=k>>16&255,q=k>>7&510,Z=k&255;v[I]=(L+q+Z)/4&255}this.luminances=v}else this.luminances=r;if(u===void 0&&(this.dataWidth=a),d===void 0&&(this.dataHeight=l),m===void 0&&(this.left=0),y===void 0&&(this.top=0),this.left+a>this.dataWidth||this.top+l>this.dataHeight)throw new N("Crop rectangle does not fit within image data.")}getRow(r,a){if(r<0||r>=this.getHeight())throw new N("Requested row is outside the image: "+r);const l=this.getWidth();(a==null||a.length<l)&&(a=new Uint8ClampedArray(l));const u=(r+this.top)*this.dataWidth+this.left;return ne.arraycopy(this.luminances,u,a,0,l),a}getMatrix(){const r=this.getWidth(),a=this.getHeight();if(r===this.dataWidth&&a===this.dataHeight)return this.luminances;const l=r*a,u=new Uint8ClampedArray(l);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ne.arraycopy(this.luminances,d,u,0,l),u;for(let m=0;m<a;m++){const y=m*r;ne.arraycopy(this.luminances,d,u,y,r),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,a,l,u){return new Yt(this.luminances,l,u,this.dataWidth,this.dataHeight,this.left+r,this.top+a)}invert(){return new qe(this)}}class yr extends U{static forName(r){return this.getCharacterSetECIByName(r)}}class Rn{}Rn.ISO_8859_1=U.ISO8859_1;class rr{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class Ii{static singletonList(r){return[r]}static min(r,a){return r.sort(a)[0]}}class ms{constructor(r){this.previous=r}getPrevious(){return this.previous}}class ei extends ms{constructor(r,a,l){super(r),this.value=a,this.bitCount=l}appendTo(r,a){r.appendBits(this.value,this.bitCount)}add(r,a){return new ei(this,r,a)}addBinaryShift(r,a){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new ei(this,r,a)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+fe.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class Ri extends ei{constructor(r,a,l){super(r,0,0),this.binaryShiftStart=a,this.binaryShiftByteCount=l}appendTo(r,a){for(let l=0;l<this.binaryShiftByteCount;l++)(l===0||l===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):l===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(a[this.binaryShiftStart+l],8)}addBinaryShift(r,a){return new Ri(this,r,a)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ha(M,r,a){return new Ri(M,r,a)}function ps(M,r,a){return new ei(M,r,a)}const Wa=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],js=0,Tl=1,Ui=2,vc=3,es=4,zo=new ei(null,0,0),da=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function xf(M){for(let r of M)ze.fill(r,-1);return M[js][es]=0,M[Tl][es]=0,M[Tl][js]=28,M[vc][es]=0,M[Ui][es]=0,M[Ui][js]=15,M}const Ho=xf(ze.createInt32Array(6,6));class ts{constructor(r,a,l,u){this.token=r,this.mode=a,this.binaryShiftByteCount=l,this.bitCount=u}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,a){let l=this.bitCount,u=this.token;if(r!==this.mode){let m=da[this.mode][r];u=ps(u,m&65535,m>>16),l+=m>>16}let d=r===Ui?4:5;return u=ps(u,a,d),new ts(u,r,0,l+d)}shiftAndAppend(r,a){let l=this.token,u=this.mode===Ui?4:5;return l=ps(l,Ho[this.mode][r],u),l=ps(l,a,5),new ts(l,this.mode,0,this.bitCount+u+5)}addBinaryShiftChar(r){let a=this.token,l=this.mode,u=this.bitCount;if(this.mode===es||this.mode===Ui){let y=da[l][js];a=ps(a,y&65535,y>>16),u+=y>>16,l=js}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,m=new ts(a,l,this.binaryShiftByteCount+1,u+d);return m.binaryShiftByteCount===2078&&(m=m.endBinaryShift(r+1)),m}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let a=this.token;return a=ha(a,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new ts(a,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let a=this.bitCount+(da[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?a+=ts.calculateBinaryShiftCost(r)-ts.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(a+=10),a<=r.bitCount}toBitArray(r){let a=[];for(let u=this.endBinaryShift(r.length).token;u!==null;u=u.getPrevious())a.unshift(u);let l=new Ge;for(const u of a)u.appendTo(l,r);return l}toString(){return Y.format("%s bits=%d bytes=%d",Wa[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}ts.INITIAL_STATE=new ts(zo,js,0,0);function Ku(M){const r=Y.getCharCode(" "),a=Y.getCharCode("."),l=Y.getCharCode(",");M[js][r]=1;const u=Y.getCharCode("Z"),d=Y.getCharCode("A");for(let L=d;L<=u;L++)M[js][L]=L-d+2;M[Tl][r]=1;const m=Y.getCharCode("z"),y=Y.getCharCode("a");for(let L=y;L<=m;L++)M[Tl][L]=L-y+2;M[Ui][r]=1;const _=Y.getCharCode("9"),v=Y.getCharCode("0");for(let L=v;L<=_;L++)M[Ui][L]=L-v+2;M[Ui][l]=12,M[Ui][a]=13;const I=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let L=0;L<I.length;L++)M[vc][Y.getCharCode(I[L])]=L;const k=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let L=0;L<k.length;L++)Y.getCharCode(k[L])>0&&(M[es][Y.getCharCode(k[L])]=L);return M}const Go=Ku(ze.createInt32Array(5,256));class fa{constructor(r){this.text=r}encode(){const r=Y.getCharCode(" "),a=Y.getCharCode(`
`);let l=Ii.singletonList(ts.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let m,y=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case Y.getCharCode("\r"):m=y===a?2:0;break;case Y.getCharCode("."):m=y===r?3:0;break;case Y.getCharCode(","):m=y===r?4:0;break;case Y.getCharCode(":"):m=y===r?5:0;break;default:m=0}m>0?(l=fa.updateStateListForPair(l,d,m),d++):l=this.updateStateListForChar(l,d)}return Ii.min(l,(d,m)=>d.getBitCount()-m.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,a){const l=[];for(let u of r)this.updateStateForChar(u,a,l);return fa.simplifyStates(l)}updateStateForChar(r,a,l){let u=this.text[a]&255,d=Go[r.getMode()][u]>0,m=null;for(let y=0;y<=es;y++){let _=Go[y][u];if(_>0){if(m==null&&(m=r.endBinaryShift(a)),!d||y===r.getMode()||y===Ui){const v=m.latchAndAppend(y,_);l.push(v)}if(!d&&Ho[r.getMode()][y]>=0){const v=m.shiftAndAppend(y,_);l.push(v)}}}if(r.getBinaryShiftByteCount()>0||Go[r.getMode()][u]===0){let y=r.addBinaryShiftChar(a);l.push(y)}}static updateStateListForPair(r,a,l){const u=[];for(let d of r)this.updateStateForPair(d,a,l,u);return this.simplifyStates(u)}static updateStateForPair(r,a,l,u){let d=r.endBinaryShift(a);if(u.push(d.latchAndAppend(es,l)),r.getMode()!==es&&u.push(d.shiftAndAppend(es,l)),l===3||l===4){let m=d.latchAndAppend(Ui,16-l).latchAndAppend(Ui,1);u.push(m)}if(r.getBinaryShiftByteCount()>0){let m=r.addBinaryShiftChar(a).addBinaryShiftChar(a+1);u.push(m)}}static simplifyStates(r){let a=[];for(const l of r){let u=!0;for(const d of a){if(d.isBetterThanOrEqualTo(l)){u=!1;break}l.isBetterThanOrEqualTo(d)&&(a=a.filter(m=>m!==d))}u&&a.push(l)}return a}}class _n{constructor(){}static encodeBytes(r){return _n.encode(r,_n.DEFAULT_EC_PERCENT,_n.DEFAULT_AZTEC_LAYERS)}static encode(r,a,l){let u=new fa(r).encode(),d=fe.truncDivision(u.getSize()*a,100)+11,m=u.getSize()+d,y,_,v,I,k;if(l!==_n.DEFAULT_AZTEC_LAYERS){if(y=l<0,_=Math.abs(l),_>(y?_n.MAX_NB_BITS_COMPACT:_n.MAX_NB_BITS))throw new N(Y.format("Illegal value %s for layers",l));v=_n.totalBitsInLayer(_,y),I=_n.WORD_SIZE[_];let He=v-v%I;if(k=_n.stuffBits(u,I),k.getSize()+d>He)throw new N("Data to large for user specified layer");if(y&&k.getSize()>I*64)throw new N("Data to large for user specified layer")}else{I=0,k=null;for(let He=0;;He++){if(He>_n.MAX_NB_BITS)throw new N("Data too large for an Aztec code");if(y=He<=3,_=y?He+1:He,v=_n.totalBitsInLayer(_,y),m>v)continue;(k==null||I!==_n.WORD_SIZE[_])&&(I=_n.WORD_SIZE[_],k=_n.stuffBits(u,I));let cn=v-v%I;if(!(y&&k.getSize()>I*64)&&k.getSize()+d<=cn)break}}let L=_n.generateCheckWords(k,v,I),q=k.getSize()/I,Z=_n.generateModeMessage(y,_,q),$=(y?11:14)+_*4,ue=new Int32Array($),_e;if(y){_e=$;for(let He=0;He<ue.length;He++)ue[He]=He}else{_e=$+1+2*fe.truncDivision(fe.truncDivision($,2)-1,15);let He=fe.truncDivision($,2),cn=fe.truncDivision(_e,2);for(let Wt=0;Wt<He;Wt++){let Sr=Wt+fe.truncDivision(Wt,15);ue[He-Wt-1]=cn-Sr-1,ue[He+Wt]=cn+Sr+1}}let Ze=new ot(_e);for(let He=0,cn=0;He<_;He++){let Wt=(_-He)*4+(y?9:12);for(let Sr=0;Sr<Wt;Sr++){let Fi=Sr*2;for(let ii=0;ii<2;ii++)L.get(cn+Fi+ii)&&Ze.set(ue[He*2+ii],ue[He*2+Sr]),L.get(cn+Wt*2+Fi+ii)&&Ze.set(ue[He*2+Sr],ue[$-1-He*2-ii]),L.get(cn+Wt*4+Fi+ii)&&Ze.set(ue[$-1-He*2-ii],ue[$-1-He*2-Sr]),L.get(cn+Wt*6+Fi+ii)&&Ze.set(ue[$-1-He*2-Sr],ue[He*2+ii])}cn+=Wt*8}if(_n.drawModeMessage(Ze,y,_e,Z),y)_n.drawBullsEye(Ze,fe.truncDivision(_e,2),5);else{_n.drawBullsEye(Ze,fe.truncDivision(_e,2),7);for(let He=0,cn=0;He<fe.truncDivision($,2)-1;He+=15,cn+=16)for(let Wt=fe.truncDivision(_e,2)&1;Wt<_e;Wt+=2)Ze.set(fe.truncDivision(_e,2)-cn,Wt),Ze.set(fe.truncDivision(_e,2)+cn,Wt),Ze.set(Wt,fe.truncDivision(_e,2)-cn),Ze.set(Wt,fe.truncDivision(_e,2)+cn)}let Ye=new rr;return Ye.setCompact(y),Ye.setSize(_e),Ye.setLayers(_),Ye.setCodeWords(q),Ye.setMatrix(Ze),Ye}static drawBullsEye(r,a,l){for(let u=0;u<l;u+=2)for(let d=a-u;d<=a+u;d++)r.set(d,a-u),r.set(d,a+u),r.set(a-u,d),r.set(a+u,d);r.set(a-l,a-l),r.set(a-l+1,a-l),r.set(a-l,a-l+1),r.set(a+l,a-l),r.set(a+l,a-l+1),r.set(a+l,a+l-1)}static generateModeMessage(r,a,l){let u=new Ge;return r?(u.appendBits(a-1,2),u.appendBits(l-1,6),u=_n.generateCheckWords(u,28,4)):(u.appendBits(a-1,5),u.appendBits(l-1,11),u=_n.generateCheckWords(u,40,4)),u}static drawModeMessage(r,a,l,u){let d=fe.truncDivision(l,2);if(a)for(let m=0;m<7;m++){let y=d-3+m;u.get(m)&&r.set(y,d-5),u.get(m+7)&&r.set(d+5,y),u.get(20-m)&&r.set(y,d+5),u.get(27-m)&&r.set(d-5,y)}else for(let m=0;m<10;m++){let y=d-5+m+fe.truncDivision(m,5);u.get(m)&&r.set(y,d-7),u.get(m+10)&&r.set(d+7,y),u.get(29-m)&&r.set(y,d+7),u.get(39-m)&&r.set(d-7,y)}}static generateCheckWords(r,a,l){let u=r.getSize()/l,d=new fs(_n.getGF(l)),m=fe.truncDivision(a,l),y=_n.bitsToWords(r,l,m);d.encode(y,m-u);let _=a%l,v=new Ge;v.appendBits(0,_);for(const I of Array.from(y))v.appendBits(I,l);return v}static bitsToWords(r,a,l){let u=new Int32Array(l),d,m;for(d=0,m=r.getSize()/a;d<m;d++){let y=0;for(let _=0;_<a;_++)y|=r.get(d*a+_)?1<<a-_-1:0;u[d]=y}return u}static getGF(r){switch(r){case 4:return Ot.AZTEC_PARAM;case 6:return Ot.AZTEC_DATA_6;case 8:return Ot.AZTEC_DATA_8;case 10:return Ot.AZTEC_DATA_10;case 12:return Ot.AZTEC_DATA_12;default:throw new N("Unsupported word size "+r)}}static stuffBits(r,a){let l=new Ge,u=r.getSize(),d=(1<<a)-2;for(let m=0;m<u;m+=a){let y=0;for(let _=0;_<a;_++)(m+_>=u||r.get(m+_))&&(y|=1<<a-1-_);(y&d)===d?(l.appendBits(y&d,a),m--):(y&d)===0?(l.appendBits(y|1,a),m--):l.appendBits(y,a)}return l}static totalBitsInLayer(r,a){return((a?88:112)+16*r)*r}}_n.DEFAULT_EC_PERCENT=33,_n.DEFAULT_AZTEC_LAYERS=0,_n.MAX_NB_BITS=32,_n.MAX_NB_BITS_COMPACT=4,_n.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class qo{encode(r,a,l,u){return this.encodeWithHints(r,a,l,u,null)}encodeWithHints(r,a,l,u,d){let m=Rn.ISO_8859_1,y=_n.DEFAULT_EC_PERCENT,_=_n.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(pr.CHARACTER_SET)&&(m=yr.forName(d.get(pr.CHARACTER_SET).toString())),d.has(pr.ERROR_CORRECTION)&&(y=fe.parseInt(d.get(pr.ERROR_CORRECTION).toString())),d.has(pr.AZTEC_LAYERS)&&(_=fe.parseInt(d.get(pr.AZTEC_LAYERS).toString()))),qo.encodeLayers(r,a,l,u,m,y,_)}static encodeLayers(r,a,l,u,d,m,y){if(a!==me.AZTEC)throw new N("Can only encode AZTEC, but got "+a);let _=_n.encode(Y.getBytes(r,d),m,y);return qo.renderResult(_,l,u)}static renderResult(r,a,l){let u=r.getMatrix();if(u==null)throw new On;let d=u.getWidth(),m=u.getHeight(),y=Math.max(a,d),_=Math.max(l,m),v=Math.min(y/d,_/m),I=(y-d*v)/2,k=(_-m*v)/2,L=new ot(y,_);for(let q=0,Z=k;q<m;q++,Z+=v)for(let $=0,ue=I;$<d;$++,ue+=v)u.get($,q)&&L.setRegion(ue,Z,v,v);return L}}n.AbstractExpandedDecoder=yt,n.ArgumentException=C,n.ArithmeticException=En,n.AztecCode=rr,n.AztecCodeReader=Ti,n.AztecCodeWriter=qo,n.AztecDecoder=Ne,n.AztecDetector=Zr,n.AztecDetectorResult=et,n.AztecEncoder=_n,n.AztecHighLevelEncoder=fa,n.AztecPoint=cr,n.BarcodeFormat=me,n.Binarizer=ee,n.BinaryBitmap=P,n.BitArray=Ge,n.BitMatrix=ot,n.BitSource=In,n.BrowserAztecCodeReader=ki,n.BrowserBarcodeReader=xt,n.BrowserCodeReader=ve,n.BrowserDatamatrixCodeReader=Cr,n.BrowserMultiFormatReader=ds,n.BrowserPDF417Reader=bl,n.BrowserQRCodeReader=vl,n.BrowserQRCodeSvgWriter=j,n.CharacterSetECI=U,n.ChecksumException=B,n.Code128Reader=Fe,n.Code39Reader=Ht,n.DataMatrixDecodedBitStreamParser=kn,n.DataMatrixReader=tr,n.DecodeHintType=Qe,n.DecoderResult=Ct,n.DefaultGridSampler=Kn,n.DetectorResult=Pt,n.EAN13Reader=Zt,n.EncodeHintType=pr,n.Exception=w,n.FormatException=F,n.GenericGF=Ot,n.GenericGFPoly=Qt,n.GlobalHistogramBinarizer=le,n.GridSampler=Un,n.GridSamplerInstance=lr,n.HTMLCanvasElementLuminanceSource=ut,n.HybridBinarizer=xe,n.ITFReader=At,n.IllegalArgumentException=N,n.IllegalStateException=On,n.InvertedLuminanceSource=qe,n.LuminanceSource=We,n.MathUtils=Ve,n.MultiFormatOneDReader=Je,n.MultiFormatReader=jo,n.MultiFormatWriter=Ae,n.NotFoundException=oe,n.OneDReader=tn,n.PDF417DecodedBitStreamParser=we,n.PDF417DecoderErrorCorrection=Qi,n.PDF417Reader=mr,n.PDF417ResultMetadata=Ss,n.PerspectiveTransform=Bt,n.PlanarYUVLuminanceSource=$e,n.QRCodeByteMatrix=ua,n.QRCodeDataMask=Lr,n.QRCodeDecodedBitStreamParser=zn,n.QRCodeDecoderErrorCorrectionLevel=on,n.QRCodeDecoderFormatInformation=Er,n.QRCodeEncoder=D,n.QRCodeEncoderQRCode=gs,n.QRCodeMaskUtil=fn,n.QRCodeMatrixUtil=p,n.QRCodeMode=St,n.QRCodeReader=xi,n.QRCodeVersion=bt,n.QRCodeWriter=ce,n.RGBLuminanceSource=Yt,n.RSS14Reader=Te,n.RSSExpandedReader=Be,n.ReaderException=ca,n.ReedSolomonDecoder=Me,n.ReedSolomonEncoder=fs,n.ReedSolomonException=gn,n.Result=Ce,n.ResultMetadataType=mt,n.ResultPoint=Ie,n.StringUtils=Y,n.UnsupportedOperationException=J,n.VideoInputDevice=K,n.WhiteRectangleDetector=ht,n.WriterException=mn,n.ZXingArrays=ze,n.ZXingCharset=yr,n.ZXingInteger=fe,n.ZXingStandardCharsets=Rn,n.ZXingStringBuilder=G,n.ZXingStringEncoding=X,n.ZXingSystem=ne,n.createAbstractExpandedDecoder=Jr,Object.defineProperty(n,"__esModule",{value:!0})}))})(mu,mu.exports)),mu.exports}var fr=i8();const s8=qd(fr),a8=Nb({__proto__:null,default:s8},[fr]);var aE=(function(){function s(e,n,o){if(this.formatMap=new Map([[_t.QR_CODE,fr.BarcodeFormat.QR_CODE],[_t.AZTEC,fr.BarcodeFormat.AZTEC],[_t.CODABAR,fr.BarcodeFormat.CODABAR],[_t.CODE_39,fr.BarcodeFormat.CODE_39],[_t.CODE_93,fr.BarcodeFormat.CODE_93],[_t.CODE_128,fr.BarcodeFormat.CODE_128],[_t.DATA_MATRIX,fr.BarcodeFormat.DATA_MATRIX],[_t.MAXICODE,fr.BarcodeFormat.MAXICODE],[_t.ITF,fr.BarcodeFormat.ITF],[_t.EAN_13,fr.BarcodeFormat.EAN_13],[_t.EAN_8,fr.BarcodeFormat.EAN_8],[_t.PDF_417,fr.BarcodeFormat.PDF_417],[_t.RSS_14,fr.BarcodeFormat.RSS_14],[_t.RSS_EXPANDED,fr.BarcodeFormat.RSS_EXPANDED],[_t.UPC_A,fr.BarcodeFormat.UPC_A],[_t.UPC_E,fr.BarcodeFormat.UPC_E],[_t.UPC_EAN_EXTENSION,fr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!a8)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=o;var h=this.createZXingFormats(e),g=new Map;g.set(fr.DecodeHintType.POSSIBLE_FORMATS,h),g.set(fr.DecodeHintType.TRY_HARDER,!1),this.hints=g}return s.prototype.decodeAsync=function(e){var n=this;return new Promise(function(o,h){try{o(n.decode(e))}catch(g){h(g)}})},s.prototype.decode=function(e){var n=new fr.MultiFormatReader(this.verbose,this.hints),o=new fr.HTMLCanvasElementLuminanceSource(e),h=new fr.BinaryBitmap(new fr.HybridBinarizer(o)),g=n.decode(h);return{text:g.text,format:K_.create(this.toHtml5QrcodeSupportedFormats(g.format)),debugData:this.createDebugData()}},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,o,h){e.set(n,o)}),e},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createZXingFormats=function(e){for(var n=[],o=0,h=e;o<h.length;o++){var g=h[o];this.formatMap.has(g)?n.push(this.formatMap.get(g)):this.logger.logError("".concat(g," is not supported by")+"ZXingHtml5QrcodeShim")}return n},s.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},s})(),o8=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(x){x(g)})}return new(n||(n=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(N){x(N)}}function b(C){try{w(o.throw(C))}catch(N){x(N)}}function w(C){C.done?g(C.value):h(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},l8=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(n=0)),n;)try{if(o=1,h&&(g=w[0]&2?h.return:w[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,w[1])).done)return g;switch(h=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,h=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){n.label=w[1];break}if(w[0]===6&&n.label<g[1]){n.label=g[1],g=w;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(w);break}g[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(s,n)}catch(C){w=[6,C],h=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},oE=(function(){function s(e,n,o){if(this.formatMap=new Map([[_t.QR_CODE,"qr_code"],[_t.AZTEC,"aztec"],[_t.CODABAR,"codabar"],[_t.CODE_39,"code_39"],[_t.CODE_93,"code_93"],[_t.CODE_128,"code_128"],[_t.DATA_MATRIX,"data_matrix"],[_t.ITF,"itf"],[_t.EAN_13,"ean_13"],[_t.EAN_8,"ean_8"],[_t.PDF_417,"pdf417"],[_t.UPC_A,"upc_a"],[_t.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!s.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=o;var h=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(h),!this.detector)throw"BarcodeDetector detector not supported"}return s.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},s.prototype.decodeAsync=function(e){return o8(this,void 0,void 0,function(){var n,o;return l8(this,function(h){switch(h.label){case 0:return[4,this.detector.detect(e)];case 1:if(n=h.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return o=this.selectLargestBarcode(n),[2,{text:o.rawValue,format:K_.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}]}})})},s.prototype.selectLargestBarcode=function(e){for(var n=null,o=0,h=0,g=e;h<g.length;h++){var x=g[h],T=x.boundingBox.width*x.boundingBox.height;T>o&&(o=T,n=x)}if(!n)throw"No largest barcode found";return n},s.prototype.createBarcodeDetectorFormats=function(e){for(var n=[],o=0,h=e;o<h.length;o++){var g=h[o];this.formatMap.has(g)?n.push(this.formatMap.get(g)):this.logger.warn("".concat(g," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,o,h){e.set(n,o)}),e},s.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},s})(),lE=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(x){x(g)})}return new(n||(n=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(N){x(N)}}function b(C){try{w(o.throw(C))}catch(N){x(N)}}function w(C){C.done?g(C.value):h(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},cE=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(n=0)),n;)try{if(o=1,h&&(g=w[0]&2?h.return:w[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,w[1])).done)return g;switch(h=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,h=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){n.label=w[1];break}if(w[0]===6&&n.label<g[1]){n.label=g[1],g=w;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(w);break}g[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(s,n)}catch(C){w=[6,C],h=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},c8=(function(){function s(e,n,o,h){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=o,n&&oE.isSupported()?(this.primaryDecoder=new oE(e,o,h),this.secondaryDecoder=new aE(e,o,h)):this.primaryDecoder=new aE(e,o,h)}return s.prototype.decodeAsync=function(e){return lE(this,void 0,void 0,function(){var n;return cE(this,function(o){switch(o.label){case 0:n=performance.now(),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,o.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},s.prototype.decodeRobustlyAsync=function(e){return lE(this,void 0,void 0,function(){var n,o;return cE(this,function(h){switch(h.label){case 0:n=performance.now(),h.label=1;case 1:return h.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,h.sent()];case 3:if(o=h.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw o;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},s.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},s.prototype.possiblyLogPerformance=function(e){if(this.verbose){var n=performance.now()-e;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},s.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,n=0,o=this.executionResults;n<o.length;n++){var h=o[n];e+=h}var g=e/this.executionResults.length;console.log("".concat(g," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},s})(),am=(function(){var s=function(e,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(o[g]=h[g])},s(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");s(e,n);function o(){this.constructor=e}e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}})(),Fd=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(x){x(g)})}return new(n||(n=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(N){x(N)}}function b(C){try{w(o.throw(C))}catch(N){x(N)}}function w(C){C.done?g(C.value):h(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},jd=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(n=0)),n;)try{if(o=1,h&&(g=w[0]&2?h.return:w[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,w[1])).done)return g;switch(h=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,h=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){n.label=w[1];break}if(w[0]===6&&n.label<g[1]){n.label=g[1],g=w;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(w);break}g[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(s,n)}catch(C){w=[6,C],h=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Z_=(function(){function s(e,n){this.name=e,this.track=n}return s.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},s.prototype.apply=function(e){var n={};n[this.name]=e;var o={advanced:[n]};return this.track.applyConstraints(o)},s.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var n=e[this.name];return n}return null},s})(),u8=(function(s){am(e,s);function e(n,o){return s.call(this,n,o)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(n){var o={};o[this.name]=n;var h={advanced:[o]};return this.track.applyConstraints(h)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),o=n[this.name];return{min:o.min,max:o.max,step:o.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e})(Z_),h8=(function(s){am(e,s);function e(n){return s.call(this,"zoom",n)||this}return e})(u8),d8=(function(s){am(e,s);function e(n){return s.call(this,"torch",n)||this}return e})(Z_),f8=(function(){function s(e){this.track=e}return s.prototype.zoomFeature=function(){return new h8(this.track)},s.prototype.torchFeature=function(){return new d8(this.track)},s})(),g8=(function(){function s(e,n,o){this.isClosed=!1,this.parentElement=e,this.mediaStream=n,this.callbacks=o,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return s.prototype.createVideoElement=function(e){var n=document.createElement("video");return n.style.width="".concat(e,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},s.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var o=e.surface.clientWidth,h=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(o,h),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},s.create=function(e,n,o,h){return Fd(this,void 0,void 0,function(){var g,x;return jd(this,function(T){switch(T.label){case 0:return g=new s(e,n,h),o.aspectRatio?(x={aspectRatio:o.aspectRatio},[4,g.getFirstTrackOrFail().applyConstraints(x)]):[3,2];case 1:T.sent(),T.label=2;case 2:return g.setupSurface(),[2,g]}})})},s.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},s.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},s.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},s.prototype.resume=function(e){this.failIfClosed();var n=this,o=function(){setTimeout(e,200),n.surface.removeEventListener("playing",o)};this.surface.addEventListener("playing",o),this.surface.play()},s.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},s.prototype.getSurface=function(){return this.failIfClosed(),this.surface},s.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},s.prototype.applyVideoConstraints=function(e){return Fd(this,void 0,void 0,function(){return jd(this,function(n){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},s.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(n,o){var h=e.mediaStream.getVideoTracks(),g=h.length,x=0;e.mediaStream.getVideoTracks().forEach(function(T){e.mediaStream.removeTrack(T),T.stop(),++x,x>=g&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),n())})})},s.prototype.getCapabilities=function(){return new f8(this.getFirstTrackOrFail())},s})(),m8=(function(){function s(e){this.mediaStream=e}return s.prototype.render=function(e,n,o){return Fd(this,void 0,void 0,function(){return jd(this,function(h){return[2,g8.create(e,this.mediaStream,n,o)]})})},s.create=function(e){return Fd(this,void 0,void 0,function(){var n,o;return jd(this,function(h){switch(h.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return o=h.sent(),[2,new s(o)]}})})},s})(),uE=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(x){x(g)})}return new(n||(n=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(N){x(N)}}function b(C){try{w(o.throw(C))}catch(N){x(N)}}function w(C){C.done?g(C.value):h(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},hE=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(n=0)),n;)try{if(o=1,h&&(g=w[0]&2?h.return:w[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,w[1])).done)return g;switch(h=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,h=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){n.label=w[1];break}if(w[0]===6&&n.label<g[1]){n.label=g[1],g=w;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(w);break}g[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(s,n)}catch(C){w=[6,C],h=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},p8=(function(){function s(){}return s.failIfNotSupported=function(){return uE(this,void 0,void 0,function(){return hE(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new s]})})},s.prototype.create=function(e){return uE(this,void 0,void 0,function(){return hE(this,function(n){return[2,m8.create(e)]})})},s})(),y8=function(s,e,n,o){function h(g){return g instanceof n?g:new n(function(x){x(g)})}return new(n||(n=Promise))(function(g,x){function T(C){try{w(o.next(C))}catch(N){x(N)}}function b(C){try{w(o.throw(C))}catch(N){x(N)}}function w(C){C.done?g(C.value):h(C.value).then(T,b)}w((o=o.apply(s,e||[])).next())})},x8=function(s,e){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},o,h,g,x;return x={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function T(w){return function(C){return b([w,C])}}function b(w){if(o)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(n=0)),n;)try{if(o=1,h&&(g=w[0]&2?h.return:w[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,w[1])).done)return g;switch(h=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,h=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){n.label=w[1];break}if(w[0]===6&&n.label<g[1]){n.label=g[1],g=w;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(w);break}g[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(s,n)}catch(C){w=[6,C],h=0}finally{o=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},E8=(function(){function s(){}return s.retrieve=function(){if(navigator.mediaDevices)return s.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?s.getCamerasFromMediaStreamTrack():s.rejectWithError()},s.rejectWithError=function(){var e=rc.unableToQuerySupportedDevices();return s.isHttpsOrLocalhost()||(e=rc.insecureContextCameraQueryError()),Promise.reject(e)},s.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},s.getCamerasFromMediaDevices=function(){return y8(this,void 0,void 0,function(){var e,n,o,h,g,x,T;return x8(this,function(b){switch(b.label){case 0:return e=function(w){for(var C=w.getVideoTracks(),N=0,P=C;N<P.length;N++){var B=P[N];B.enabled=!1,B.stop(),w.removeTrack(B)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=b.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(o=b.sent(),h=[],g=0,x=o;g<x.length;g++)T=x[g],T.kind==="videoinput"&&h.push({id:T.deviceId,label:T.label});return e(n),[2,h]}})})},s.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,n){var o=function(g){for(var x=[],T=0,b=g;T<b.length;T++){var w=b[T];w.kind==="video"&&x.push({id:w.id,label:w.label})}e(x)},h=MediaStreamTrack;h.getSources(o)})},s})(),Or;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.NOT_STARTED=1]="NOT_STARTED",s[s.SCANNING=2]="SCANNING",s[s.PAUSED=3]="PAUSED"})(Or||(Or={}));var w8=(function(){function s(){this.state=Or.NOT_STARTED,this.onGoingTransactionNewState=Or.UNKNOWN}return s.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},s.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},s.prototype.execute=function(){if(this.onGoingTransactionNewState===Or.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Or.UNKNOWN,this.directTransition(e)},s.prototype.cancel=function(){if(this.onGoingTransactionNewState===Or.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Or.UNKNOWN},s.prototype.getState=function(){return this.state},s.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Or.UNKNOWN)throw"Cannot transition to a new state, already under transition"},s.prototype.validateTransition=function(e){switch(this.state){case Or.UNKNOWN:throw"Transition from unknown is not allowed";case Or.NOT_STARTED:this.failIfNewStateIs(e,[Or.PAUSED]);break;case Or.SCANNING:break;case Or.PAUSED:break}},s.prototype.failIfNewStateIs=function(e,n){for(var o=0,h=n;o<h.length;o++){var g=h[o];if(e===g)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},s})(),_8=(function(){function s(e){this.stateManager=e}return s.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},s.prototype.directTransition=function(e){this.stateManager.directTransition(e)},s.prototype.getState=function(){return this.stateManager.getState()},s.prototype.canScanFile=function(){return this.stateManager.getState()===Or.NOT_STARTED},s.prototype.isScanning=function(){return this.stateManager.getState()!==Or.NOT_STARTED},s.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Or.SCANNING},s.prototype.isPaused=function(){return this.stateManager.getState()===Or.PAUSED},s})(),A8=(function(){function s(){}return s.create=function(){return new _8(new w8)},s})(),b8=(function(){var s=function(e,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(o[g]=h[g])},s(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");s(e,n);function o(){this.constructor=e}e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}})(),ls=(function(s){b8(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e})(e8),v8=(function(){function s(e,n){this.logger=n,this.fps=ls.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=ls.DEFAULT_DISABLE_FLIP}return s.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Q_.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},s.prototype.isShadedBoxEnabled=function(){return!Na(this.qrbox)},s.create=function(e,n){return new s(e,n)},s})(),T8=(function(){function s(e,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var o;typeof n=="boolean"?this.verbose=n===!0:n&&(o=n,this.verbose=o.verbose===!0,o.experimentalFeatures),this.logger=new n8(this.verbose),this.qrcode=new c8(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(o),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=A8.create()}return s.prototype.start=function(e,n,o,h){var g=this;if(!e)throw"cameraIdOrConfig is required";if(!o||typeof o!="function")throw"qrCodeSuccessCallback is required and should be a function.";var x;h?x=h:x=this.verbose?this.logger.log:function(){};var T=v8.create(n,this.logger);this.clearElement();var b=!1;T.videoConstraints&&(T.isMediaStreamConstraintsValid()?b=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var w=b,C=document.getElementById(this.elementId);C.clientWidth?C.clientWidth:ls.DEFAULT_WIDTH,C.style.position="relative",this.shouldScan=!0,this.element=C;var N=this,P=this.stateManagerProxy.startTransition(Or.SCANNING);return new Promise(function(B,ee){var ne=w?T.videoConstraints:N.createVideoConstraints(e);if(!ne){P.cancel(),ee("videoConstraints should be defined");return}var ae={};(!w||T.aspectRatio)&&(ae.aspectRatio=T.aspectRatio);var tt={onRenderSurfaceReady:function(ze,fe){N.setupUi(ze,fe,T),N.isScanning=!0,N.foreverScan(T,o,x)}};p8.failIfNotSupported().then(function(ze){ze.create(ne).then(function(fe){return fe.render(g.element,ae,tt).then(function(Ge){N.renderedCamera=Ge,P.execute(),B(null)}).catch(function(Ge){P.cancel(),ee(Ge)})}).catch(function(fe){P.cancel(),ee(rc.errorGettingUserMedia(fe))})}).catch(function(ze){P.cancel(),ee(rc.cameraStreamingNotSupported())})})},s.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Or.PAUSED),this.showPausedState(),(Na(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},s.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,n=function(){e.stateManagerProxy.directTransition(Or.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},s.prototype.getState=function(){return this.stateManagerProxy.getState()},s.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(Or.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var o=function(){if(e.element){var g=document.getElementById(ls.SHADED_REGION_ELEMENT_ID);g&&e.element.removeChild(g)}},h=this;return this.renderedCamera.close().then(function(){return h.renderedCamera=null,h.element&&(h.element.removeChild(h.canvasElement),h.canvasElement=null),o(),h.qrRegion&&(h.qrRegion=null),h.context&&(h.context=null),n.execute(),h.hidePausedState(),h.isScanning=!1,Promise.resolve()})},s.prototype.scanFile=function(e,n){return this.scanFileV2(e,n).then(function(o){return o.decodedText})},s.prototype.scanFileV2=function(e,n){var o=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Na(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(h,g){o.possiblyCloseLastScanImageFile(),o.clearElement(),o.lastScanImageFile=URL.createObjectURL(e);var x=new Image;x.onload=function(){var T=x.width,b=x.height,w=document.getElementById(o.elementId),C=w.clientWidth?w.clientWidth:ls.DEFAULT_WIDTH,N=Math.max(w.clientHeight?w.clientHeight:b,ls.FILE_SCAN_MIN_HEIGHT),P=o.computeCanvasDrawConfig(T,b,C,N);if(n){var B=o.createCanvasElement(C,N,"qr-canvas-visible");B.style.display="inline-block",w.appendChild(B);var ee=B.getContext("2d");if(!ee)throw"Unable to get 2d context from canvas";ee.canvas.width=C,ee.canvas.height=N,ee.drawImage(x,0,0,T,b,P.x,P.y,P.width,P.height)}var ne=ls.FILE_SCAN_HIDDEN_CANVAS_PADDING,ae=Math.max(x.width,P.width),tt=Math.max(x.height,P.height),ze=ae+2*ne,fe=tt+2*ne,Ge=o.createCanvasElement(ze,fe);w.appendChild(Ge);var gt=Ge.getContext("2d");if(!gt)throw"Unable to get 2d context from canvas";gt.canvas.width=ze,gt.canvas.height=fe,gt.drawImage(x,0,0,T,b,ne,ne,ae,tt);try{o.qrcode.decodeRobustlyAsync(Ge).then(function(Qe){h(iE.createFromQrcodeResult(Qe))}).catch(g)}catch(Qe){g("QR code parse error, error = ".concat(Qe))}},x.onerror=g,x.onabort=g,x.onstalled=g,x.onsuspend=g,x.src=URL.createObjectURL(e)})},s.prototype.clear=function(){this.clearElement()},s.getCameras=function(){return E8.retrieve()},s.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},s.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},s.prototype.applyVideoConstraints=function(e){if(e){if(!Q_.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},s.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},s.prototype.getSupportedFormats=function(e){var n=[_t.QR_CODE,_t.AZTEC,_t.CODABAR,_t.CODE_39,_t.CODE_93,_t.CODE_128,_t.DATA_MATRIX,_t.MAXICODE,_t.ITF,_t.EAN_13,_t.EAN_8,_t.PDF_417,_t.RSS_14,_t.RSS_EXPANDED,_t.UPC_A,_t.UPC_E,_t.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return n;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var o=[],h=0,g=e.formatsToSupport;h<g.length;h++){var x=g[h];$4(x)?o.push(x):this.logger.warn("Invalid format: ".concat(x," passed in config, ignoring."))}if(o.length===0)throw"None of formatsToSupport match supported values.";return o},s.prototype.getUseBarCodeDetectorIfSupported=function(e){if(Na(e))return!0;if(!Na(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(Na(e.experimentalFeatures))return!0;var n=e.experimentalFeatures;return Na(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},s.prototype.validateQrboxSize=function(e,n,o){var h=this,g=o.qrbox;this.validateQrboxConfig(g);var x=this.toQrdimensions(e,n,g),T=function(w){if(w<ls.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(ls.MIN_QR_BOX_SIZE,"px.")},b=function(w){return w>e&&(h.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),w=e),w};T(x.width),T(x.height),x.width=b(x.width)},s.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},s.prototype.toQrdimensions=function(e,n,o){if(typeof o=="number")return{width:o,height:o};if(typeof o=="function")try{return o(e,n)}catch(h){throw new Error("qrbox config was passed as a function but it failed with unknown error"+h)}return o},s.prototype.setupUi=function(e,n,o){o.isShadedBoxEnabled()&&this.validateQrboxSize(e,n,o);var h=Na(o.qrbox)?{width:e,height:n}:o.qrbox;this.validateQrboxConfig(h);var g=this.toQrdimensions(e,n,h);g.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var x=o.isShadedBoxEnabled()&&g.height<=n,T={x:0,y:0,width:e,height:n},b=x?this.getShadedRegionBounds(e,n,g):T,w=this.createCanvasElement(b.width,b.height),C={willReadFrequently:!0},N=w.getContext("2d",C);N.canvas.width=b.width,N.canvas.height=b.height,this.element.append(w),x&&this.possiblyInsertShadingElement(this.element,e,n,g),this.createScannerPausedUiElement(this.element),this.qrRegion=b,this.context=N,this.canvasElement=w},s.prototype.createScannerPausedUiElement=function(e){var n=document.createElement("div");n.innerText=rc.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",e.appendChild(n),this.scannerPausedUiElement=n},s.prototype.scanContext=function(e,n){var o=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(h){return e(h.text,iE.createFromQrcodeResult(h)),o.possiblyUpdateShaders(!0),!0}).catch(function(h){o.possiblyUpdateShaders(!1);var g=rc.codeParseError(h);return n(g,t8.createFrom(g)),!1})},s.prototype.foreverScan=function(e,n,o){var h=this;if(this.shouldScan&&this.renderedCamera){var g=this.renderedCamera.getSurface(),x=g.videoWidth/g.clientWidth,T=g.videoHeight/g.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var b=this.qrRegion.width*x,w=this.qrRegion.height*T,C=this.qrRegion.x*x,N=this.qrRegion.y*T;this.context.drawImage(g,C,N,b,w,0,0,this.qrRegion.width,this.qrRegion.height);var P=function(){h.foreverScanTimeout=setTimeout(function(){h.foreverScan(e,n,o)},h.getTimeoutFps(e.fps))};this.scanContext(n,o).then(function(B){!B&&e.disableFlip!==!0?(h.context.translate(h.context.canvas.width,0),h.context.scale(-1,1),h.scanContext(n,o).finally(function(){P()})):P()}).catch(function(B){h.logger.logError("Error happend while scanning context",B),P()})}},s.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var n="facingMode",o="deviceId",h={user:!0,environment:!0},g="exact",x=function(ee){if(ee in h)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(ee,"'")},T=Object.keys(e);if(T.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(T.length," keys");var b=Object.keys(e)[0];if(b!==n&&b!==o)throw"Only '".concat(n,"' and '").concat(o,"' ")+" are supported for 'cameraIdOrConfig'";if(b===n){var w=e.facingMode;if(typeof w=="string"){if(x(w))return{facingMode:w}}else if(typeof w=="object")if(g in w){if(x(w["".concat(g)]))return{facingMode:{exact:w["".concat(g)]}}}else throw"'facingMode' should be string or object with"+" ".concat(g," as key.");else{var C=typeof w;throw"Invalid type of 'facingMode' = ".concat(C)}}else{var N=e.deviceId;if(typeof N=="string")return{deviceId:N};if(typeof N=="object"){if(g in N)return{deviceId:{exact:N["".concat(g)]}};throw"'deviceId' should be string or object with"+" ".concat(g," as key.")}else{var P=typeof N;throw"Invalid type of 'deviceId' = ".concat(P)}}}var B=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(B)},s.prototype.computeCanvasDrawConfig=function(e,n,o,h){if(e<=o&&n<=h){var g=(o-e)/2,x=(h-n)/2;return{x:g,y:x,width:e,height:n}}else{var T=e,b=n;return e>o&&(n=o/e*n,e=o),n>h&&(e=h/n*e,n=h),this.logger.log("Image downsampled from "+"".concat(T,"X").concat(b)+" to ".concat(e,"X").concat(n,".")),this.computeCanvasDrawConfig(e,n,o,h)}},s.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},s.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=e?ls.BORDER_SHADER_MATCH_COLOR:ls.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},s.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},s.prototype.createCanvasElement=function(e,n,o){var h=e,g=n,x=document.createElement("canvas");return x.style.width="".concat(h,"px"),x.style.height="".concat(g,"px"),x.style.display="none",x.id=Na(o)?"qr-canvas":o,x},s.prototype.getShadedRegionBounds=function(e,n,o){if(o.width>e||o.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-o.width)/2,y:(n-o.height)/2,width:o.width,height:o.height}},s.prototype.possiblyInsertShadingElement=function(e,n,o,h){if(!(n-h.width<1||o-h.height<1)){var g=document.createElement("div");g.style.position="absolute";var x=(n-h.width)/2,T=(o-h.height)/2;if(g.style.borderLeft="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderRight="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderTop="".concat(T,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderBottom="".concat(T,"px solid rgba(0, 0, 0, 0.48)"),g.style.boxSizing="border-box",g.style.top="0px",g.style.bottom="0px",g.style.left="0px",g.style.right="0px",g.id="".concat(ls.SHADED_REGION_ELEMENT_ID),n-h.width<11||o-h.height<11)this.hasBorderShaders=!1;else{var b=5,w=40;this.insertShaderBorders(g,w,b,-b,null,0,!0),this.insertShaderBorders(g,w,b,-b,null,0,!1),this.insertShaderBorders(g,w,b,null,-b,0,!0),this.insertShaderBorders(g,w,b,null,-b,0,!1),this.insertShaderBorders(g,b,w+b,-b,null,-b,!0),this.insertShaderBorders(g,b,w+b,null,-b,-b,!0),this.insertShaderBorders(g,b,w+b,-b,null,-b,!1),this.insertShaderBorders(g,b,w+b,null,-b,-b,!1),this.hasBorderShaders=!0}e.append(g)}},s.prototype.insertShaderBorders=function(e,n,o,h,g,x,T){var b=document.createElement("div");b.style.position="absolute",b.style.backgroundColor=ls.BORDER_SHADER_DEFAULT_COLOR,b.style.width="".concat(n,"px"),b.style.height="".concat(o,"px"),h!==null&&(b.style.top="".concat(h,"px")),g!==null&&(b.style.bottom="".concat(g,"px")),T?b.style.left="".concat(x,"px"):b.style.right="".concat(x,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(b),e.appendChild(b)},s.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},s.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},s.prototype.getTimeoutFps=function(e){return 1e3/e},s})(),dE;(function(s){s[s.STATUS_DEFAULT=0]="STATUS_DEFAULT",s[s.STATUS_SUCCESS=1]="STATUS_SUCCESS",s[s.STATUS_WARNING=2]="STATUS_WARNING",s[s.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(dE||(dE={}));const C8=({onCode:s})=>(he.useEffect(()=>{const e="qr-reader",n=new T8(e);return n.start({facingMode:"environment"},{fps:10,qrbox:250},o=>{s(o)},()=>{}).catch(o=>{console.error("Kunne ikke starte QR-leser:",o)}),()=>{n.stop().then(()=>n.clear()).catch(()=>{})}},[s]),R.jsx("div",{id:"qr-reader",style:{width:"100%"}}));async function S8(){const e=(await gr(Wn(Et,"terms"))).docs.map(n=>{const o=n.data(),h=typeof o?.value=="number"?o.value:void 0;if(typeof h!="number")return null;const g=typeof o?.label=="string"?o.label:"",x=typeof o?.order=="number"?o.order:void 0;return{value:h,label:g,order:x}}).filter(Boolean);return e.sort((n,o)=>(n.order??n.value)-(o.order??o.value)),e}function om(){const[s,e]=he.useState([]),[n,o]=he.useState(!0),[h,g]=he.useState(null);he.useEffect(()=>{let T=!0;return(async()=>{try{o(!0);const b=await S8();T&&e(b)}catch(b){T&&g(b)}finally{T&&o(!1)}})(),()=>{T=!1}},[]);const x=he.useMemo(()=>{const T=new Map;for(const b of s)T.set(b.value,b);return T},[s]);return{options:s,byValue:x,loading:n,error:h}}function yl(s,e){if(e==null)return"Ukjent termin";let n;return Array.isArray(s)?n=s.find(o=>o.value===e):s instanceof Map&&(n=s.get(e)),n&&n.label?n.label:`Termin ${e}`}function I8(s){if(s==="Testmodul 1 - Testtermin 1")return s;const e=/(Modul)\s+(\d+)\s*-\s*(Blokk|Termin)\s+(\d+)/i,n=s.match(e);if(n){const g=n[2],x=n[4];return`M${g} - T${x}`}const o=/(Modul|Termin)\s+(\d+)/i,h=s.match(o);return h?`M${h[2]}`:s}function fE(s,e){if(e==null)return"";const n=yl(s,e);return I8(n)}var R8=AE();const N8=qd(R8);var O8=s=>{switch(s){case"success":return k8;case"info":return P8;case"warning":return L8;case"error":return B8;default:return null}},D8=Array(12).fill(0),M8=({visible:s,className:e})=>Ke.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":s},Ke.createElement("div",{className:"sonner-spinner"},D8.map((n,o)=>Ke.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${o}`})))),k8=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),L8=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),P8=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),B8=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),V8=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ke.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ke.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),U8=()=>{let[s,e]=Ke.useState(document.hidden);return Ke.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),s},ng=1,F8=class{constructor(){this.subscribe=s=>(this.subscribers.push(s),()=>{let e=this.subscribers.indexOf(s);this.subscribers.splice(e,1)}),this.publish=s=>{this.subscribers.forEach(e=>e(s))},this.addToast=s=>{this.publish(s),this.toasts=[...this.toasts,s]},this.create=s=>{var e;let{message:n,...o}=s,h=typeof s?.id=="number"||((e=s.id)==null?void 0:e.length)>0?s.id:ng++,g=this.toasts.find(T=>T.id===h),x=s.dismissible===void 0?!0:s.dismissible;return this.dismissedToasts.has(h)&&this.dismissedToasts.delete(h),g?this.toasts=this.toasts.map(T=>T.id===h?(this.publish({...T,...s,id:h,title:n}),{...T,...s,id:h,dismissible:x,title:n}):T):this.addToast({title:n,...o,dismissible:x,id:h}),h},this.dismiss=s=>(this.dismissedToasts.add(s),s||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:s,dismiss:!0})),s),this.message=(s,e)=>this.create({...e,message:s}),this.error=(s,e)=>this.create({...e,message:s,type:"error"}),this.success=(s,e)=>this.create({...e,type:"success",message:s}),this.info=(s,e)=>this.create({...e,type:"info",message:s}),this.warning=(s,e)=>this.create({...e,type:"warning",message:s}),this.loading=(s,e)=>this.create({...e,type:"loading",message:s}),this.promise=(s,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:s,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let o=s instanceof Promise?s:s(),h=n!==void 0,g,x=o.then(async b=>{if(g=["resolve",b],Ke.isValidElement(b))h=!1,this.create({id:n,type:"default",message:b});else if(z8(b)&&!b.ok){h=!1;let w=typeof e.error=="function"?await e.error(`HTTP error! status: ${b.status}`):e.error,C=typeof e.description=="function"?await e.description(`HTTP error! status: ${b.status}`):e.description;this.create({id:n,type:"error",message:w,description:C})}else if(e.success!==void 0){h=!1;let w=typeof e.success=="function"?await e.success(b):e.success,C=typeof e.description=="function"?await e.description(b):e.description;this.create({id:n,type:"success",message:w,description:C})}}).catch(async b=>{if(g=["reject",b],e.error!==void 0){h=!1;let w=typeof e.error=="function"?await e.error(b):e.error,C=typeof e.description=="function"?await e.description(b):e.description;this.create({id:n,type:"error",message:w,description:C})}}).finally(()=>{var b;h&&(this.dismiss(n),n=void 0),(b=e.finally)==null||b.call(e)}),T=()=>new Promise((b,w)=>x.then(()=>g[0]==="reject"?w(g[1]):b(g[1])).catch(w));return typeof n!="string"&&typeof n!="number"?{unwrap:T}:Object.assign(n,{unwrap:T})},this.custom=(s,e)=>{let n=e?.id||ng++;return this.create({jsx:s(n),id:n,...e}),n},this.getActiveToasts=()=>this.toasts.filter(s=>!this.dismissedToasts.has(s.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Xi=new F8,j8=(s,e)=>{let n=e?.id||ng++;return Xi.addToast({title:s,...e,id:n}),n},z8=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",H8=j8,G8=()=>Xi.toasts,q8=()=>Xi.getActiveToasts(),It=Object.assign(H8,{success:Xi.success,info:Xi.info,warning:Xi.warning,error:Xi.error,custom:Xi.custom,message:Xi.message,promise:Xi.promise,dismiss:Xi.dismiss,loading:Xi.loading},{getHistory:G8,getToasts:q8});function X8(s,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",e==="top"&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=s:o.appendChild(document.createTextNode(s))}X8(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ad(s){return s.label!==void 0}var Y8=3,W8="32px",K8="16px",gE=4e3,Q8=356,Z8=14,J8=20,$8=200;function Ds(...s){return s.filter(Boolean).join(" ")}function eR(s){let[e,n]=s.split("-"),o=[];return e&&o.push(e),n&&o.push(n),o}var tR=s=>{var e,n,o,h,g,x,T,b,w,C,N;let{invert:P,toast:B,unstyled:ee,interacting:ne,setHeights:ae,visibleToasts:tt,heights:ze,index:fe,toasts:Ge,expanded:gt,removeToast:Qe,defaultRichColors:F,closeButton:z,style:U,cancelButtonStyle:J,actionButtonStyle:X,className:Y="",descriptionClassName:G="",duration:ot,position:oe,gap:le,loadingIcon:xe,expandByDefault:We,classNames:qe,icons:ut,closeButtonAriaLabel:K="Close toast",pauseWhenPageIsHidden:se}=s,[ve,Ce]=Ke.useState(null),[Le,me]=Ke.useState(null),[rt,mt]=Ke.useState(!1),[Ct,sn]=Ke.useState(!1),[Qt,En]=Ke.useState(!1),[Ot,gn]=Ke.useState(!1),[On,Me]=Ke.useState(!1),[ge,Ne]=Ke.useState(0),[Ve,it]=Ke.useState(0),Ie=Ke.useRef(B.duration||ot||gE),Pt=Ke.useRef(null),et=Ke.useRef(null),ht=fe===0,Un=fe+1<=tt,Bt=B.type,Kn=B.dismissible!==!1,lr=B.className||"",cr=B.descriptionClassName||"",Zr=Ke.useMemo(()=>ze.findIndex(dt=>dt.toastId===B.id)||0,[ze,B.id]),Ti=Ke.useMemo(()=>{var dt;return(dt=B.closeButton)!=null?dt:z},[B.closeButton,z]),ki=Ke.useMemo(()=>B.duration||ot||gE,[B.duration,ot]),tn=Ke.useRef(0),Fe=Ke.useRef(0),Ht=Ke.useRef(0),At=Ke.useRef(null),[wn,vr]=oe.split("-"),Xr=Ke.useMemo(()=>ze.reduce((dt,nn,re)=>re>=Zr?dt:dt+nn.height,0),[ze,Zr]),Tr=U8(),Vt=B.invert||P,Zt=Bt==="loading";Fe.current=Ke.useMemo(()=>Zr*le+Xr,[Zr,Xr]),Ke.useEffect(()=>{Ie.current=ki},[ki]),Ke.useEffect(()=>{mt(!0)},[]),Ke.useEffect(()=>{let dt=et.current;if(dt){let nn=dt.getBoundingClientRect().height;return it(nn),ae(re=>[{toastId:B.id,height:nn,position:B.position},...re]),()=>ae(re=>re.filter(Se=>Se.toastId!==B.id))}},[ae,B.id]),Ke.useLayoutEffect(()=>{if(!rt)return;let dt=et.current,nn=dt.style.height;dt.style.height="auto";let re=dt.getBoundingClientRect().height;dt.style.height=nn,it(re),ae(Se=>Se.find(je=>je.toastId===B.id)?Se.map(je=>je.toastId===B.id?{...je,height:re}:je):[{toastId:B.id,height:re,position:B.position},...Se])},[rt,B.title,B.description,ae,B.id]);let jn=Ke.useCallback(()=>{sn(!0),Ne(Fe.current),ae(dt=>dt.filter(nn=>nn.toastId!==B.id)),setTimeout(()=>{Qe(B)},$8)},[B,Qe,ae,Fe]);Ke.useEffect(()=>{if(B.promise&&Bt==="loading"||B.duration===1/0||B.type==="loading")return;let dt;return gt||ne||se&&Tr?(()=>{if(Ht.current<tn.current){let nn=new Date().getTime()-tn.current;Ie.current=Ie.current-nn}Ht.current=new Date().getTime()})():Ie.current!==1/0&&(tn.current=new Date().getTime(),dt=setTimeout(()=>{var nn;(nn=B.onAutoClose)==null||nn.call(B,B),jn()},Ie.current)),()=>clearTimeout(dt)},[gt,ne,B,Bt,se,Tr,jn]),Ke.useEffect(()=>{B.delete&&jn()},[jn,B.delete]);function Mr(){var dt,nn,re;return ut!=null&&ut.loading?Ke.createElement("div",{className:Ds(qe?.loader,(dt=B?.classNames)==null?void 0:dt.loader,"sonner-loader"),"data-visible":Bt==="loading"},ut.loading):xe?Ke.createElement("div",{className:Ds(qe?.loader,(nn=B?.classNames)==null?void 0:nn.loader,"sonner-loader"),"data-visible":Bt==="loading"},xe):Ke.createElement(M8,{className:Ds(qe?.loader,(re=B?.classNames)==null?void 0:re.loader),visible:Bt==="loading"})}return Ke.createElement("li",{tabIndex:0,ref:et,className:Ds(Y,lr,qe?.toast,(e=B?.classNames)==null?void 0:e.toast,qe?.default,qe?.[Bt],(n=B?.classNames)==null?void 0:n[Bt]),"data-sonner-toast":"","data-rich-colors":(o=B.richColors)!=null?o:F,"data-styled":!(B.jsx||B.unstyled||ee),"data-mounted":rt,"data-promise":!!B.promise,"data-swiped":On,"data-removed":Ct,"data-visible":Un,"data-y-position":wn,"data-x-position":vr,"data-index":fe,"data-front":ht,"data-swiping":Qt,"data-dismissible":Kn,"data-type":Bt,"data-invert":Vt,"data-swipe-out":Ot,"data-swipe-direction":Le,"data-expanded":!!(gt||We&&rt),style:{"--index":fe,"--toasts-before":fe,"--z-index":Ge.length-fe,"--offset":`${Ct?ge:Fe.current}px`,"--initial-height":We?"auto":`${Ve}px`,...U,...B.style},onDragEnd:()=>{En(!1),Ce(null),At.current=null},onPointerDown:dt=>{Zt||!Kn||(Pt.current=new Date,Ne(Fe.current),dt.target.setPointerCapture(dt.pointerId),dt.target.tagName!=="BUTTON"&&(En(!0),At.current={x:dt.clientX,y:dt.clientY}))},onPointerUp:()=>{var dt,nn,re,Se;if(Ot||!Kn)return;At.current=null;let je=Number(((dt=et.current)==null?void 0:dt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Xe=Number(((nn=et.current)==null?void 0:nn.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),st=new Date().getTime()-((re=Pt.current)==null?void 0:re.getTime()),pt=ve==="x"?je:Xe,at=Math.abs(pt)/st;if(Math.abs(pt)>=J8||at>.11){Ne(Fe.current),(Se=B.onDismiss)==null||Se.call(B,B),me(ve==="x"?je>0?"right":"left":Xe>0?"down":"up"),jn(),gn(!0),Me(!1);return}En(!1),Ce(null)},onPointerMove:dt=>{var nn,re,Se,je;if(!At.current||!Kn||((nn=window.getSelection())==null?void 0:nn.toString().length)>0)return;let Xe=dt.clientY-At.current.y,st=dt.clientX-At.current.x,pt=(re=s.swipeDirections)!=null?re:eR(oe);!ve&&(Math.abs(st)>1||Math.abs(Xe)>1)&&Ce(Math.abs(st)>Math.abs(Xe)?"x":"y");let at={x:0,y:0};ve==="y"?(pt.includes("top")||pt.includes("bottom"))&&(pt.includes("top")&&Xe<0||pt.includes("bottom")&&Xe>0)&&(at.y=Xe):ve==="x"&&(pt.includes("left")||pt.includes("right"))&&(pt.includes("left")&&st<0||pt.includes("right")&&st>0)&&(at.x=st),(Math.abs(at.x)>0||Math.abs(at.y)>0)&&Me(!0),(Se=et.current)==null||Se.style.setProperty("--swipe-amount-x",`${at.x}px`),(je=et.current)==null||je.style.setProperty("--swipe-amount-y",`${at.y}px`)}},Ti&&!B.jsx?Ke.createElement("button",{"aria-label":K,"data-disabled":Zt,"data-close-button":!0,onClick:Zt||!Kn?()=>{}:()=>{var dt;jn(),(dt=B.onDismiss)==null||dt.call(B,B)},className:Ds(qe?.closeButton,(h=B?.classNames)==null?void 0:h.closeButton)},(g=ut?.close)!=null?g:V8):null,B.jsx||he.isValidElement(B.title)?B.jsx?B.jsx:typeof B.title=="function"?B.title():B.title:Ke.createElement(Ke.Fragment,null,Bt||B.icon||B.promise?Ke.createElement("div",{"data-icon":"",className:Ds(qe?.icon,(x=B?.classNames)==null?void 0:x.icon)},B.promise||B.type==="loading"&&!B.icon?B.icon||Mr():null,B.type!=="loading"?B.icon||ut?.[Bt]||O8(Bt):null):null,Ke.createElement("div",{"data-content":"",className:Ds(qe?.content,(T=B?.classNames)==null?void 0:T.content)},Ke.createElement("div",{"data-title":"",className:Ds(qe?.title,(b=B?.classNames)==null?void 0:b.title)},typeof B.title=="function"?B.title():B.title),B.description?Ke.createElement("div",{"data-description":"",className:Ds(G,cr,qe?.description,(w=B?.classNames)==null?void 0:w.description)},typeof B.description=="function"?B.description():B.description):null),he.isValidElement(B.cancel)?B.cancel:B.cancel&&ad(B.cancel)?Ke.createElement("button",{"data-button":!0,"data-cancel":!0,style:B.cancelButtonStyle||J,onClick:dt=>{var nn,re;ad(B.cancel)&&Kn&&((re=(nn=B.cancel).onClick)==null||re.call(nn,dt),jn())},className:Ds(qe?.cancelButton,(C=B?.classNames)==null?void 0:C.cancelButton)},B.cancel.label):null,he.isValidElement(B.action)?B.action:B.action&&ad(B.action)?Ke.createElement("button",{"data-button":!0,"data-action":!0,style:B.actionButtonStyle||X,onClick:dt=>{var nn,re;ad(B.action)&&((re=(nn=B.action).onClick)==null||re.call(nn,dt),!dt.defaultPrevented&&jn())},className:Ds(qe?.actionButton,(N=B?.classNames)==null?void 0:N.actionButton)},B.action.label):null))};function mE(){if(typeof window>"u"||typeof document>"u")return"ltr";let s=document.documentElement.getAttribute("dir");return s==="auto"||!s?window.getComputedStyle(document.documentElement).direction:s}function nR(s,e){let n={};return[s,e].forEach((o,h)=>{let g=h===1,x=g?"--mobile-offset":"--offset",T=g?K8:W8;function b(w){["top","right","bottom","left"].forEach(C=>{n[`${x}-${C}`]=typeof w=="number"?`${w}px`:w})}typeof o=="number"||typeof o=="string"?b(o):typeof o=="object"?["top","right","bottom","left"].forEach(w=>{o[w]===void 0?n[`${x}-${w}`]=T:n[`${x}-${w}`]=typeof o[w]=="number"?`${o[w]}px`:o[w]}):b(T)}),n}var rR=he.forwardRef(function(s,e){let{invert:n,position:o="bottom-right",hotkey:h=["altKey","KeyT"],expand:g,closeButton:x,className:T,offset:b,mobileOffset:w,theme:C="light",richColors:N,duration:P,style:B,visibleToasts:ee=Y8,toastOptions:ne,dir:ae=mE(),gap:tt=Z8,loadingIcon:ze,icons:fe,containerAriaLabel:Ge="Notifications",pauseWhenPageIsHidden:gt}=s,[Qe,F]=Ke.useState([]),z=Ke.useMemo(()=>Array.from(new Set([o].concat(Qe.filter(se=>se.position).map(se=>se.position)))),[Qe,o]),[U,J]=Ke.useState([]),[X,Y]=Ke.useState(!1),[G,ot]=Ke.useState(!1),[oe,le]=Ke.useState(C!=="system"?C:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),xe=Ke.useRef(null),We=h.join("+").replace(/Key/g,"").replace(/Digit/g,""),qe=Ke.useRef(null),ut=Ke.useRef(!1),K=Ke.useCallback(se=>{F(ve=>{var Ce;return(Ce=ve.find(Le=>Le.id===se.id))!=null&&Ce.delete||Xi.dismiss(se.id),ve.filter(({id:Le})=>Le!==se.id)})},[]);return Ke.useEffect(()=>Xi.subscribe(se=>{if(se.dismiss){F(ve=>ve.map(Ce=>Ce.id===se.id?{...Ce,delete:!0}:Ce));return}setTimeout(()=>{N8.flushSync(()=>{F(ve=>{let Ce=ve.findIndex(Le=>Le.id===se.id);return Ce!==-1?[...ve.slice(0,Ce),{...ve[Ce],...se},...ve.slice(Ce+1)]:[se,...ve]})})})}),[]),Ke.useEffect(()=>{if(C!=="system"){le(C);return}if(C==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?le("dark"):le("light")),typeof window>"u")return;let se=window.matchMedia("(prefers-color-scheme: dark)");try{se.addEventListener("change",({matches:ve})=>{le(ve?"dark":"light")})}catch{se.addListener(({matches:Ce})=>{try{le(Ce?"dark":"light")}catch(Le){console.error(Le)}})}},[C]),Ke.useEffect(()=>{Qe.length<=1&&Y(!1)},[Qe]),Ke.useEffect(()=>{let se=ve=>{var Ce,Le;h.every(me=>ve[me]||ve.code===me)&&(Y(!0),(Ce=xe.current)==null||Ce.focus()),ve.code==="Escape"&&(document.activeElement===xe.current||(Le=xe.current)!=null&&Le.contains(document.activeElement))&&Y(!1)};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[h]),Ke.useEffect(()=>{if(xe.current)return()=>{qe.current&&(qe.current.focus({preventScroll:!0}),qe.current=null,ut.current=!1)}},[xe.current]),Ke.createElement("section",{ref:e,"aria-label":`${Ge} ${We}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},z.map((se,ve)=>{var Ce;let[Le,me]=se.split("-");return Qe.length?Ke.createElement("ol",{key:se,dir:ae==="auto"?mE():ae,tabIndex:-1,ref:xe,className:T,"data-sonner-toaster":!0,"data-theme":oe,"data-y-position":Le,"data-lifted":X&&Qe.length>1&&!g,"data-x-position":me,style:{"--front-toast-height":`${((Ce=U[0])==null?void 0:Ce.height)||0}px`,"--width":`${Q8}px`,"--gap":`${tt}px`,...B,...nR(b,w)},onBlur:rt=>{ut.current&&!rt.currentTarget.contains(rt.relatedTarget)&&(ut.current=!1,qe.current&&(qe.current.focus({preventScroll:!0}),qe.current=null))},onFocus:rt=>{rt.target instanceof HTMLElement&&rt.target.dataset.dismissible==="false"||ut.current||(ut.current=!0,qe.current=rt.relatedTarget)},onMouseEnter:()=>Y(!0),onMouseMove:()=>Y(!0),onMouseLeave:()=>{G||Y(!1)},onDragEnd:()=>Y(!1),onPointerDown:rt=>{rt.target instanceof HTMLElement&&rt.target.dataset.dismissible==="false"||ot(!0)},onPointerUp:()=>ot(!1)},Qe.filter(rt=>!rt.position&&ve===0||rt.position===se).map((rt,mt)=>{var Ct,sn;return Ke.createElement(tR,{key:rt.id,icons:fe,index:mt,toast:rt,defaultRichColors:N,duration:(Ct=ne?.duration)!=null?Ct:P,className:ne?.className,descriptionClassName:ne?.descriptionClassName,invert:n,visibleToasts:ee,closeButton:(sn=ne?.closeButton)!=null?sn:x,interacting:G,position:se,style:ne?.style,unstyled:ne?.unstyled,classNames:ne?.classNames,cancelButtonStyle:ne?.cancelButtonStyle,actionButtonStyle:ne?.actionButtonStyle,removeToast:K,toasts:Qe.filter(Qt=>Qt.position==rt.position),heights:U.filter(Qt=>Qt.position==rt.position),setHeights:J,expandByDefault:g,gap:tt,loadingIcon:ze,expanded:X,pauseWhenPageIsHidden:gt,swipeDirections:s.swipeDirections})})):null}))});const iR={width:"100%",maxWidth:460,backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},ou={fontSize:"0.8rem",display:"block"},lu={width:"100%",padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.9rem",marginTop:"0.15rem",boxSizing:"border-box"},pE={padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",color:"#111827",cursor:"pointer",fontSize:"0.9rem"};function lm({uid:s,role:e,onClose:n,displayName:o,email:h}){const{options:g}=om(),[x,T]=he.useState(!0),[b,w]=he.useState(!1),[C,N]=he.useState(null),[P,B]=he.useState(""),[ee,ne]=he.useState(""),[ae,tt]=he.useState(h),[ze,fe]=he.useState(null),[Ge,gt]=he.useState([]),[Qe,F]=he.useState(!1),[z,U]=he.useState(""),J=e==="teacher"||e==="student",[X,Y]=he.useState(""),[G,ot]=he.useState(""),[oe,le]=he.useState(h),[xe,We]=he.useState({}),[qe,ut]=he.useState(!1),[K,se]=he.useState(""),[ve,Ce]=he.useState(!1),[Le,me]=he.useState(null),[rt,mt]=he.useState(null);he.useEffect(()=>{let ge=!0;return(async()=>{try{T(!0);const Ne=Tn(Et,"users",s),Ve=await Ua(Ne),it=Ve.exists()?Ve.data():{};if(!ge)return;const Ie=String(it.phone??""),Pt=String(it.secondaryEmail??""),et=String(it?.email??h);B(Ie),ne(Pt),tt(et),Y(Ie),ot(Pt),le(et),fe(typeof it.term=="number"?it.term:null);const ht=Array.isArray(it.allowedTerms)?it.allowedTerms.filter(Un=>typeof Un=="number"):[];gt(ht);try{const Un=Ve.exists()?Ve.data():{};F(!!Un?.isSuperAdmin)}catch{F(!1)}}catch{ge&&N("Kunne ikke laste profildata.")}finally{ge&&T(!1)}})(),()=>{ge=!1}},[s]);const Ct=he.useMemo(()=>Ge.map(ge=>yl(g,ge)),[Ge,g]),sn=async()=>{N(null),w(!0);try{await bi(Tn(Et,"users",s),{phone:P.trim()||null}),Y(P),It.success("Mobilnummer er oppdatert.")}catch(ge){console.error(ge),N("Kunne ikke lagre mobilnummer."),It.error("Kunne ikke lagre mobilnummer.")}finally{w(!1)}},Qt=async()=>{N(null),w(!0);try{await bi(Tn(Et,"users",s),{secondaryEmail:ee.trim()||null}),ot(ee),It.success("Sekundr epost er oppdatert.")}catch(ge){console.error(ge),N("Kunne ikke lagre sekundr epost."),It.error("Kunne ikke lagre sekundr epost.")}finally{w(!1)}},En=async()=>{N(null);const ge=ae.trim();if(!ge){N("Epost kan ikke vre tom."),It.error("Epost kan ikke vre tom.");return}if(ge===oe){It.info?.("Eposten er uendret.")||It("Eposten er uendret.");return}try{const Ne=ol.currentUser;if(!Ne){N("Ingen innlogget bruker."),It.error("Ingen innlogget bruker.");return}await H2(Ne,ge),le(ge),It.success(`Vi har sendt en bekreftelseslenke til ${ge}. Flg lenken for  fullfre endringen av epost.`)}catch(Ne){console.warn("updateEmail failed",Ne),Ne?.code==="auth/operation-not-allowed"?(N("Kan ikke oppdatere epost direkte. Du m bekrefte ny epost via lenken vi sender. Prv igjen."),It.error("Kan ikke oppdatere epost direkte. Bruk knappen igjen for  f tilsendt bekreftelseslenke.")):Ne?.code==="auth/requires-recent-login"?(mt(ge),se(""),me(null),ut(!0),It.info?.("Av sikkerhetshensyn m du bekrefte med passord fr du kan endre epost.")||It("Av sikkerhetshensyn m du bekrefte med passord fr du kan endre epost.")):Ne?.code==="auth/email-already-in-use"?(N("Epostadressen er allerede i bruk av en annen bruker."),It.error("Epostadressen er allerede i bruk av en annen bruker.")):Ne?.code==="auth/invalid-email"?(N("Ugyldig epost."),It.error("Ugyldig epost.")):(N("Kunne ikke oppdatere epost. Prv igjen senere."),It.error("Kunne ikke oppdatere epost. Prv igjen senere."))}},Ot=()=>{ut(!1),se(""),me(null)},gn=async()=>{me(null);const ge=(rt||ae||"").trim();if(!ge){me("Ugyldig ny epost.");return}const Ne=ol.currentUser;if(!Ne){me("Ingen innlogget bruker.");return}if(!K){me("Skriv inn passordet ditt.");return}try{Ce(!0);const Ve=wl.credential(Ne.email||h,K);await vC(Ne,Ve),await H2(Ne,ge),ut(!1),se(""),mt(null),It.success(`Vi har sendt en bekreftelseslenke til ${ge}. Flg lenken for  fullfre endringen av epost.`)}catch(Ve){console.error("Reauth/update email failed",Ve),Ve?.code==="auth/wrong-password"?me("Feil passord."):Ve?.code==="auth/too-many-requests"?me("For mange forsk. Prv igjen senere."):Ve?.code==="auth/invalid-email"?me("Ugyldig epost."):Ve?.code==="auth/email-already-in-use"?me("Epostadressen er allerede i bruk av en annen bruker."):me("Kunne ikke bekrefte innlogging eller oppdatere epost.")}finally{Ce(!1)}},On=async()=>{if(N(null),!z||z.length<6){N("Passord m vre minst 6 tegn."),It.error("Passord m vre minst 6 tegn.");return}try{const ge=ol.currentUser;if(!ge){N("Ingen innlogget bruker."),It.error("Ingen innlogget bruker.");return}await CC(ge,z),It.success("Passordet er oppdatert."),U("")}catch(ge){console.warn("updatePassword failed",ge),ge?.code==="auth/requires-recent-login"?(N("Du m logge inn p nytt fr du kan endre passord."),It.error("Du m logge inn p nytt fr du kan endre passord.")):(N("Kunne ikke endre passord."),It.error("Kunne ikke endre passord."))}},Me=(ge,Ne)=>({padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:ge&&Ne?"#29B076":"#2EC483",color:"#111827",cursor:ge?"pointer":"not-allowed",fontSize:"0.9rem",transition:"background-color 120ms ease-out",width:"120px",flex:"0 0 120px",whiteSpace:"nowrap",textAlign:"center",boxSizing:"border-box"});return R.jsxs(R.Fragment,{children:[R.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},"aria-modal":!0,role:"dialog",children:R.jsxs("div",{style:iR,children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[R.jsx("h3",{style:{margin:0},children:o||h}),R.jsx("button",{type:"button",onClick:n,style:pE,children:"Lukk"})]}),x?R.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"1rem 0"},children:"Laster..."}):R.jsxs(R.Fragment,{children:[e==="student"&&R.jsxs("div",{style:{fontSize:"0.9rem",color:"#374151"},children:[R.jsx("div",{style:{fontWeight:600},children:"Din termin"}),R.jsx("div",{children:yl(g,ze)})]}),e==="teacher"&&R.jsxs("div",{style:{fontSize:"0.9rem",color:"#374151"},children:[R.jsx("div",{style:{fontWeight:600},children:"Terminer du kan registrere oppmte p:"}),Ge.length===0?R.jsx("div",{children:"Ingen"}):R.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginTop:"0.25rem"},children:Ct.map((ge,Ne)=>R.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",border:"1px solid #e5e7eb",borderRadius:"999px",background:"#f9fafb",fontSize:"0.8rem"},children:ge},Ne))})]}),e==="admin"&&R.jsx("div",{style:{fontSize:"0.9rem",color:"#374151"},children:Qe?R.jsx("div",{style:{fontWeight:600},children:"Super administrator"}):R.jsxs(R.Fragment,{children:[R.jsx("div",{style:{fontWeight:600},children:"Moduler du administrerer:"}),Ge.length===0?R.jsx("div",{children:"Ingen"}):R.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginTop:"0.25rem"},children:Ct.map((ge,Ne)=>R.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",border:"1px solid #e5e7eb",borderRadius:"999px",background:"#f9fafb",fontSize:"0.8rem"},children:ge},Ne))})]})}),R.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginTop:"1rem"},children:[R.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[R.jsx("div",{style:{flex:1,minWidth:0},children:R.jsxs("label",{style:ou,children:["Mobilnummer",R.jsx("input",{type:"tel",value:P,onChange:ge=>B(ge.target.value),placeholder:"Eks: 99999999",style:lu})]})}),R.jsx("button",{type:"button",disabled:b||P===X,onMouseEnter:()=>We(ge=>({...ge,phone:!0})),onMouseLeave:()=>We(ge=>({...ge,phone:!1})),onClick:sn,style:Me(!(b||P===X),!!xe.phone),children:"Lagre"})]}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[R.jsx("div",{style:{flex:1,minWidth:0},children:R.jsxs("label",{style:ou,children:["Epost",R.jsx("input",{type:"email",value:ae,onChange:ge=>tt(ge.target.value),placeholder:"din@epost.no",style:lu})]})}),R.jsx("button",{type:"button",disabled:b||ae.trim()===oe.trim(),onMouseEnter:()=>We(ge=>({...ge,primaryEmail:!0})),onMouseLeave:()=>We(ge=>({...ge,primaryEmail:!1})),onClick:En,style:Me(!(b||ae.trim()===oe.trim()),!!xe.primaryEmail),children:"Lagre"})]}),J&&R.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[R.jsx("div",{style:{flex:1,minWidth:0},children:R.jsxs("label",{style:ou,children:["Sekundr epost",R.jsx("input",{type:"email",value:ee,onChange:ge=>ne(ge.target.value),placeholder:"eksempel@uio.no",style:lu})]})}),R.jsx("button",{type:"button",disabled:b||ee===G,onMouseEnter:()=>We(ge=>({...ge,secondaryEmail:!0})),onMouseLeave:()=>We(ge=>({...ge,secondaryEmail:!1})),onClick:Qt,style:Me(!(b||ee===G),!!xe.secondaryEmail),children:"Lagre"})]}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[R.jsx("div",{style:{flex:1,minWidth:0},children:R.jsxs("label",{style:ou,children:["Nytt passord",R.jsx("input",{type:"password",value:z,onChange:ge=>U(ge.target.value),placeholder:"Minst 6 tegn",style:lu})]})}),R.jsx("button",{type:"button",disabled:b||z.length===0,onMouseEnter:()=>We(ge=>({...ge,password:!0})),onMouseLeave:()=>We(ge=>({...ge,password:!1})),onClick:On,style:Me(!(b||z.length===0),!!xe.password),children:"Lagre"})]})]})]})]})}),qe&&R.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:70},children:R.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff"},children:[R.jsx("h3",{style:{marginTop:0},children:"Logg inn p nytt"}),R.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:["Av sikkerhetshensyn m du bekrefte kontoen fr du kan endre epost.",`
`,"Skriv inn passordet for ",h,"."]}),R.jsxs("label",{style:ou,children:["Passord",R.jsx("input",{type:"password",value:K,onChange:ge=>se(ge.target.value),placeholder:"Passord",style:lu,autoFocus:!0})]}),Le&&R.jsx("p",{style:{color:"#b91c1c",fontSize:"0.85rem",marginTop:"0.5rem"},children:Le}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"0.75rem"},children:[R.jsx("button",{type:"button",onClick:Ot,style:pE,children:"Avbryt"}),R.jsx("button",{type:"button",onClick:gn,style:{background:"#6CE1AB",color:"black",cursor:"pointer"},disabled:ve,children:ve?"Bekrefter...":"Bekreft og send lenke"})]})]})})]})}function sR({user:s}){const{logout:e}=bc(),[n,o]=he.useState(""),[h,g]=he.useState(!1),[x,T]=he.useState(!1),b=s.term??11,[w,C]=he.useState([]),[N,P]=he.useState(!1),[B,ee]=he.useState(0),[ne,ae]=he.useState(!1),{options:tt}=om(),[ze,fe]=he.useState(!1),[Ge,gt]=he.useState(null),[Qe,F]=he.useState([]),[z,U]=he.useState({}),[J,X]=he.useState("idle"),[Y,G]=he.useState(null),[ot,oe]=he.useState(null),le=s.semesterStatus&&s.semesterStatus!=="aktiv",xe=()=>{X("idle"),G(null),oe(null),o(""),ae(!1)},We=async Le=>{if(!(!Le||Le.length<6)){g(!0),X("idle"),G(null);try{const me=Wn(Et,"sessions"),rt=ui(me,Ar("code","==",Le)),mt=await gr(rt);if(mt.empty){X("error"),G("Fant ingen kt med denne koden."),o(""),ae(!1),g(!1);return}const Ct=mt.docs[0],sn=Ct.data(),Qt=Tn(Et,"sessions",Ct.id,"attendance",s.uid);if((await Ua(Qt)).exists()){X("error"),G("Du er allerede registrert p denne kten."),o(""),ae(!1),g(!1);return}await ul(Qt,{userId:s.uid,studentName:s.displayName,studentEmail:s.email,createdAt:Vn.now(),status:"present"});const Ot=sn.name||"kten";oe(Ot),X("success"),G(null),ae(!1),o(""),ee(gn=>gn+1)}catch(me){console.error(me),X("error"),G("Noe gikk galt ved registrering av oppmte."),o(""),ae(!1)}finally{g(!1)}}},qe=Le=>{if(!Le||h)return;const me=Le.replace(/\D/g,"").slice(0,6);me.length===6&&(o(me),We(me))};he.useEffect(()=>{(async()=>{P(!0);try{const me=Wn(Et,"requirements"),rt=ui(me,Ar("term","==",b)),Ct=(await gr(rt)).docs.map(et=>{const ht=et.data();return{category:ht.category,requiredCount:ht.requiredCount}}),sn=Wn(Et,"sessions"),Qt=ui(sn,Ar("term","==",b)),Ot=(await gr(Qt)).docs.map(et=>{const ht=et.data();return{id:et.id,timeId:typeof ht?.timeId=="string"?ht.timeId:void 0,name:typeof ht?.name=="string"?ht.name:void 0,category:typeof ht?.category=="string"?ht.category:void 0}}),gn=Wn(Et,"times"),On=ui(gn,Ar("term","==",b)),ge=(await gr(On)).docs.map(et=>{const ht=et.data();return{id:et.id,name:ht.name,category:ht.category,term:ht.term,order:typeof ht?.order=="number"?ht.order:void 0}}),Ne=new Map;for(const et of ge)et.category&&Ne.set(et.category,(Ne.get(et.category)??0)+1);const Ve=new Map,it={};for(const et of Ot){if(!et.category)continue;const ht=Tn(Et,"sessions",et.id,"attendance",s.uid);if((await Ua(ht)).exists()){if(Ve.set(et.category,(Ve.get(et.category)??0)+1),et.timeId)it[et.timeId]=!0;else if(et.name&&et.category){const Bt=ge.find(Kn=>Kn.category===et.category&&Kn.name===et.name);Bt&&(it[Bt.id]=!0)}}}const Ie=new Set;for(const et of Ct)Ie.add(et.category);for(const et of Ot)et.category&&Ie.add(et.category);for(const et of ge)et.category&&Ie.add(et.category);const Pt=[];Ie.forEach(et=>{const ht=Ct.find(lr=>lr.category===et),Un=ht?ht.requiredCount:null,Bt=Ne.get(et)??0,Kn=Ve.get(et)??0;Pt.push({category:et,attendedCount:Kn,totalSessions:Bt,requiredCount:Un})}),Pt.sort((et,ht)=>et.category.localeCompare(ht.category,"nb-NO",{sensitivity:"base"})),C(Pt),F(ge),U(it)}catch(me){console.error(me),C([]),F([]),U({})}finally{P(!1)}})()},[b,s.uid,B]);const ut=Le=>{const me=Le.match(/^\s*(\d+)/);return me?parseInt(me[1],10):Number.POSITIVE_INFINITY},K=he.useMemo(()=>{if(!ze||!Ge)return[];const Le=Qe.filter(me=>me.category===Ge).map(me=>({...me,attended:!!z[me.id]}));return Le.sort((me,rt)=>{const mt=(me.order??Number.MAX_SAFE_INTEGER)-(rt.order??Number.MAX_SAFE_INTEGER);if(mt!==0)return mt;const Ct=ut(me.name),sn=ut(rt.name);return Ct!==sn?Ct-sn:me.name.localeCompare(rt.name,"nb-NO",{sensitivity:"base"})}),Le},[ze,Ge,Qe,z]),se=Le=>{gt(Le),fe(!0)},ve=()=>{fe(!1),gt(null)},Ce=Le=>{const rt=Le.target.value.replace(/\D/g,"").slice(0,6);o(rt),rt.length===6&&!h&&We(rt)};return he.useEffect(()=>{if(J==="idle")return;const me=setTimeout(()=>{xe()},5e3);return()=>clearTimeout(me)},[J]),R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"page-card page-card--student",children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[R.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:()=>T(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),R.jsx("button",{onClick:e,type:"button",style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),R.jsx("h2",{style:{textAlign:"center",marginBottom:"1rem"},children:"Registrer oppmte"}),le&&R.jsxs("p",{style:{color:"red",textAlign:"center"},children:['Du er markert som "',s.semesterStatus,'" dette semesteret. Ingen oppmtekrav, men du kan fortsatt registrere oppmte.']}),R.jsx("div",{style:{marginTop:"1rem",textAlign:"center"},children:J==="success"?R.jsxs(R.Fragment,{children:[R.jsx("div",{style:{fontSize:"4rem",color:"#16a34a",marginBottom:"0.5rem"},children:""}),R.jsx("h3",{style:{margin:0,marginBottom:"0.3rem"},children:"Oppmte registrert"}),ot&&R.jsx("p",{style:{margin:0,marginBottom:"1rem",fontSize:"1rem",color:"#374151"},children:ot}),R.jsx("button",{type:"button",onClick:xe,style:{marginTop:"0.5rem",padding:"0.5rem 1.2rem",borderRadius:"999px",border:"none",background:"#2563eb",color:"white",fontWeight:500,cursor:"pointer",fontSize:"0.95rem"},children:"Registrer en kode til"})]}):J==="error"?R.jsxs(R.Fragment,{children:[R.jsx("div",{style:{fontSize:"4rem",color:"#dc2626",marginBottom:"0.5rem"},children:""}),R.jsx("h3",{style:{margin:0,marginBottom:"0.3rem"},children:"Kunne ikke registrere oppmte"}),Y&&R.jsx("p",{style:{margin:0,marginBottom:"1rem",fontSize:"0.95rem",color:"#374151"},children:Y}),R.jsx("button",{type:"button",onClick:xe,style:{marginTop:"0.5rem",padding:"0.5rem 1.2rem",borderRadius:"999px",border:"none",background:"#6b7280",color:"white",fontWeight:500,cursor:"pointer",fontSize:"0.95rem"},children:"Prv en kode til"})]}):R.jsxs(R.Fragment,{children:[R.jsx("label",{style:{display:"block",marginBottom:"0.3rem"},children:"6-sifret kode fra lrer"}),R.jsx("input",{value:n,onChange:Ce,maxLength:6,placeholder:"482931",style:{padding:"0.5rem 0.8rem",fontSize:"1.2rem",letterSpacing:"0.3em",textAlign:"center",borderRadius:"0.5rem",border:"1px solid #d1d5db",minWidth:"10rem"}}),h&&R.jsx(Ro,{}),R.jsx("br",{}),R.jsx("button",{type:"button",onClick:()=>ae(Le=>!Le),style:{marginTop:"1rem",padding:"0.4rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:ne?"#e5e7eb":"#f9fafb",cursor:"pointer",fontSize:"0.9rem"},children:ne?"Stopp skanning":"Skann QR-kode"}),ne&&R.jsx("div",{style:{marginTop:"0.8rem",display:"flex",justifyContent:"center"},children:R.jsx("div",{style:{width:"260px",maxWidth:"100%",borderRadius:"0.75rem",overflow:"hidden",border:"1px solid #d1d5db"},children:R.jsx(C8,{onCode:qe})})})]})}),R.jsx("hr",{style:{marginTop:"2rem",marginBottom:"1rem"}}),R.jsxs("section",{children:[R.jsx("h3",{style:{textAlign:"center"},children:yl(tt,b)}),N?R.jsx(Ro,{}):w.length===0?R.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen registrerte timer for denne terminen enn."}):R.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[R.jsx("thead",{children:R.jsxs("tr",{children:[R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Gruppe"}),R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Registrerte oppmter"}),R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Krav"})]})}),R.jsx("tbody",{children:w.map(Le=>{const rt={padding:"0.5rem",borderBottom:"1px solid #f3f4f6",background:Le.requiredCount!=null&&Le.attendedCount>=Le.requiredCount?"#dcfce7":"transparent"};return R.jsxs("tr",{onClick:()=>se(Le.category),title:"Klikk for  se detaljer",style:{cursor:"pointer"},children:[R.jsx("td",{style:rt,children:Le.category}),R.jsx("td",{style:rt,children:Le.totalSessions>0?`${Le.attendedCount}/${Le.totalSessions}`:Le.attendedCount}),R.jsx("td",{style:rt,children:Le.requiredCount??"-"})]},Le.category)})})]})]}),ze&&R.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},onClick:ve,children:R.jsxs("div",{onClick:Le=>Le.stopPropagation(),style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[R.jsx("h3",{style:{margin:0},children:Ge?`Oppmte i ${Ge}`:"Oppmte"}),R.jsx("button",{type:"button",onClick:ve,style:{border:"none",background:"transparent",fontSize:"1.2rem",cursor:"pointer"},"aria-label":"Lukk",title:"Lukk",children:""})]}),K.length===0?R.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen timer er definert i denne gruppen enda."}):R.jsx("ul",{style:{listStyle:"none",padding:0,marginTop:"0.75rem"},children:K.map(Le=>R.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.35rem 0",borderBottom:"1px solid #f3f4f6"},children:[R.jsx("span",{children:Le.name}),R.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",borderRadius:"999px",backgroundColor:Le.attended?"#dcfce7":"#fee2e2",color:Le.attended?"#166534":"#991b1b",fontSize:"0.8rem"},children:Le.attended?"Registrert":"Mangler"})]},Le.id))}),R.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"0.75rem"},children:R.jsx("button",{type:"button",onClick:ve,style:{padding:"0.35rem 0.8rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff",cursor:"pointer"},children:"Lukk"})})]})})]}),x&&R.jsx(lm,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>T(!1)})]})}var aR=Object.defineProperty,zd=Object.getOwnPropertySymbols,J_=Object.prototype.hasOwnProperty,$_=Object.prototype.propertyIsEnumerable,yE=(s,e,n)=>e in s?aR(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,rg=(s,e)=>{for(var n in e||(e={}))J_.call(e,n)&&yE(s,n,e[n]);if(zd)for(var n of zd(e))$_.call(e,n)&&yE(s,n,e[n]);return s},ig=(s,e)=>{var n={};for(var o in s)J_.call(s,o)&&e.indexOf(o)<0&&(n[o]=s[o]);if(s!=null&&zd)for(var o of zd(s))e.indexOf(o)<0&&$_.call(s,o)&&(n[o]=s[o]);return n};var xl;(s=>{const e=class xn{constructor(b,w,C,N){if(this.version=b,this.errorCorrectionLevel=w,this.modules=[],this.isFunction=[],b<xn.MIN_VERSION||b>xn.MAX_VERSION)throw new RangeError("Version value out of range");if(N<-1||N>7)throw new RangeError("Mask value out of range");this.size=b*4+17;let P=[];for(let ee=0;ee<this.size;ee++)P.push(!1);for(let ee=0;ee<this.size;ee++)this.modules.push(P.slice()),this.isFunction.push(P.slice());this.drawFunctionPatterns();const B=this.addEccAndInterleave(C);if(this.drawCodewords(B),N==-1){let ee=1e9;for(let ne=0;ne<8;ne++){this.applyMask(ne),this.drawFormatBits(ne);const ae=this.getPenaltyScore();ae<ee&&(N=ne,ee=ae),this.applyMask(ne)}}h(0<=N&&N<=7),this.mask=N,this.applyMask(N),this.drawFormatBits(N),this.isFunction=[]}static encodeText(b,w){const C=s.QrSegment.makeSegments(b);return xn.encodeSegments(C,w)}static encodeBinary(b,w){const C=s.QrSegment.makeBytes(b);return xn.encodeSegments([C],w)}static encodeSegments(b,w,C=1,N=40,P=-1,B=!0){if(!(xn.MIN_VERSION<=C&&C<=N&&N<=xn.MAX_VERSION)||P<-1||P>7)throw new RangeError("Invalid value");let ee,ne;for(ee=C;;ee++){const fe=xn.getNumDataCodewords(ee,w)*8,Ge=x.getTotalBits(b,ee);if(Ge<=fe){ne=Ge;break}if(ee>=N)throw new RangeError("Data too long")}for(const fe of[xn.Ecc.MEDIUM,xn.Ecc.QUARTILE,xn.Ecc.HIGH])B&&ne<=xn.getNumDataCodewords(ee,fe)*8&&(w=fe);let ae=[];for(const fe of b){n(fe.mode.modeBits,4,ae),n(fe.numChars,fe.mode.numCharCountBits(ee),ae);for(const Ge of fe.getData())ae.push(Ge)}h(ae.length==ne);const tt=xn.getNumDataCodewords(ee,w)*8;h(ae.length<=tt),n(0,Math.min(4,tt-ae.length),ae),n(0,(8-ae.length%8)%8,ae),h(ae.length%8==0);for(let fe=236;ae.length<tt;fe^=253)n(fe,8,ae);let ze=[];for(;ze.length*8<ae.length;)ze.push(0);return ae.forEach((fe,Ge)=>ze[Ge>>>3]|=fe<<7-(Ge&7)),new xn(ee,w,ze,P)}getModule(b,w){return 0<=b&&b<this.size&&0<=w&&w<this.size&&this.modules[w][b]}getModules(){return this.modules}drawFunctionPatterns(){for(let C=0;C<this.size;C++)this.setFunctionModule(6,C,C%2==0),this.setFunctionModule(C,6,C%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const b=this.getAlignmentPatternPositions(),w=b.length;for(let C=0;C<w;C++)for(let N=0;N<w;N++)C==0&&N==0||C==0&&N==w-1||C==w-1&&N==0||this.drawAlignmentPattern(b[C],b[N]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(b){const w=this.errorCorrectionLevel.formatBits<<3|b;let C=w;for(let P=0;P<10;P++)C=C<<1^(C>>>9)*1335;const N=(w<<10|C)^21522;h(N>>>15==0);for(let P=0;P<=5;P++)this.setFunctionModule(8,P,o(N,P));this.setFunctionModule(8,7,o(N,6)),this.setFunctionModule(8,8,o(N,7)),this.setFunctionModule(7,8,o(N,8));for(let P=9;P<15;P++)this.setFunctionModule(14-P,8,o(N,P));for(let P=0;P<8;P++)this.setFunctionModule(this.size-1-P,8,o(N,P));for(let P=8;P<15;P++)this.setFunctionModule(8,this.size-15+P,o(N,P));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let b=this.version;for(let C=0;C<12;C++)b=b<<1^(b>>>11)*7973;const w=this.version<<12|b;h(w>>>18==0);for(let C=0;C<18;C++){const N=o(w,C),P=this.size-11+C%3,B=Math.floor(C/3);this.setFunctionModule(P,B,N),this.setFunctionModule(B,P,N)}}drawFinderPattern(b,w){for(let C=-4;C<=4;C++)for(let N=-4;N<=4;N++){const P=Math.max(Math.abs(N),Math.abs(C)),B=b+N,ee=w+C;0<=B&&B<this.size&&0<=ee&&ee<this.size&&this.setFunctionModule(B,ee,P!=2&&P!=4)}}drawAlignmentPattern(b,w){for(let C=-2;C<=2;C++)for(let N=-2;N<=2;N++)this.setFunctionModule(b+N,w+C,Math.max(Math.abs(N),Math.abs(C))!=1)}setFunctionModule(b,w,C){this.modules[w][b]=C,this.isFunction[w][b]=!0}addEccAndInterleave(b){const w=this.version,C=this.errorCorrectionLevel;if(b.length!=xn.getNumDataCodewords(w,C))throw new RangeError("Invalid argument");const N=xn.NUM_ERROR_CORRECTION_BLOCKS[C.ordinal][w],P=xn.ECC_CODEWORDS_PER_BLOCK[C.ordinal][w],B=Math.floor(xn.getNumRawDataModules(w)/8),ee=N-B%N,ne=Math.floor(B/N);let ae=[];const tt=xn.reedSolomonComputeDivisor(P);for(let fe=0,Ge=0;fe<N;fe++){let gt=b.slice(Ge,Ge+ne-P+(fe<ee?0:1));Ge+=gt.length;const Qe=xn.reedSolomonComputeRemainder(gt,tt);fe<ee&&gt.push(0),ae.push(gt.concat(Qe))}let ze=[];for(let fe=0;fe<ae[0].length;fe++)ae.forEach((Ge,gt)=>{(fe!=ne-P||gt>=ee)&&ze.push(Ge[fe])});return h(ze.length==B),ze}drawCodewords(b){if(b.length!=Math.floor(xn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let w=0;for(let C=this.size-1;C>=1;C-=2){C==6&&(C=5);for(let N=0;N<this.size;N++)for(let P=0;P<2;P++){const B=C-P,ne=(C+1&2)==0?this.size-1-N:N;!this.isFunction[ne][B]&&w<b.length*8&&(this.modules[ne][B]=o(b[w>>>3],7-(w&7)),w++)}}h(w==b.length*8)}applyMask(b){if(b<0||b>7)throw new RangeError("Mask value out of range");for(let w=0;w<this.size;w++)for(let C=0;C<this.size;C++){let N;switch(b){case 0:N=(C+w)%2==0;break;case 1:N=w%2==0;break;case 2:N=C%3==0;break;case 3:N=(C+w)%3==0;break;case 4:N=(Math.floor(C/3)+Math.floor(w/2))%2==0;break;case 5:N=C*w%2+C*w%3==0;break;case 6:N=(C*w%2+C*w%3)%2==0;break;case 7:N=((C+w)%2+C*w%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[w][C]&&N&&(this.modules[w][C]=!this.modules[w][C])}}getPenaltyScore(){let b=0;for(let P=0;P<this.size;P++){let B=!1,ee=0,ne=[0,0,0,0,0,0,0];for(let ae=0;ae<this.size;ae++)this.modules[P][ae]==B?(ee++,ee==5?b+=xn.PENALTY_N1:ee>5&&b++):(this.finderPenaltyAddHistory(ee,ne),B||(b+=this.finderPenaltyCountPatterns(ne)*xn.PENALTY_N3),B=this.modules[P][ae],ee=1);b+=this.finderPenaltyTerminateAndCount(B,ee,ne)*xn.PENALTY_N3}for(let P=0;P<this.size;P++){let B=!1,ee=0,ne=[0,0,0,0,0,0,0];for(let ae=0;ae<this.size;ae++)this.modules[ae][P]==B?(ee++,ee==5?b+=xn.PENALTY_N1:ee>5&&b++):(this.finderPenaltyAddHistory(ee,ne),B||(b+=this.finderPenaltyCountPatterns(ne)*xn.PENALTY_N3),B=this.modules[ae][P],ee=1);b+=this.finderPenaltyTerminateAndCount(B,ee,ne)*xn.PENALTY_N3}for(let P=0;P<this.size-1;P++)for(let B=0;B<this.size-1;B++){const ee=this.modules[P][B];ee==this.modules[P][B+1]&&ee==this.modules[P+1][B]&&ee==this.modules[P+1][B+1]&&(b+=xn.PENALTY_N2)}let w=0;for(const P of this.modules)w=P.reduce((B,ee)=>B+(ee?1:0),w);const C=this.size*this.size,N=Math.ceil(Math.abs(w*20-C*10)/C)-1;return h(0<=N&&N<=9),b+=N*xn.PENALTY_N4,h(0<=b&&b<=2568888),b}getAlignmentPatternPositions(){if(this.version==1)return[];{const b=Math.floor(this.version/7)+2,w=this.version==32?26:Math.ceil((this.version*4+4)/(b*2-2))*2;let C=[6];for(let N=this.size-7;C.length<b;N-=w)C.splice(1,0,N);return C}}static getNumRawDataModules(b){if(b<xn.MIN_VERSION||b>xn.MAX_VERSION)throw new RangeError("Version number out of range");let w=(16*b+128)*b+64;if(b>=2){const C=Math.floor(b/7)+2;w-=(25*C-10)*C-55,b>=7&&(w-=36)}return h(208<=w&&w<=29648),w}static getNumDataCodewords(b,w){return Math.floor(xn.getNumRawDataModules(b)/8)-xn.ECC_CODEWORDS_PER_BLOCK[w.ordinal][b]*xn.NUM_ERROR_CORRECTION_BLOCKS[w.ordinal][b]}static reedSolomonComputeDivisor(b){if(b<1||b>255)throw new RangeError("Degree out of range");let w=[];for(let N=0;N<b-1;N++)w.push(0);w.push(1);let C=1;for(let N=0;N<b;N++){for(let P=0;P<w.length;P++)w[P]=xn.reedSolomonMultiply(w[P],C),P+1<w.length&&(w[P]^=w[P+1]);C=xn.reedSolomonMultiply(C,2)}return w}static reedSolomonComputeRemainder(b,w){let C=w.map(N=>0);for(const N of b){const P=N^C.shift();C.push(0),w.forEach((B,ee)=>C[ee]^=xn.reedSolomonMultiply(B,P))}return C}static reedSolomonMultiply(b,w){if(b>>>8||w>>>8)throw new RangeError("Byte out of range");let C=0;for(let N=7;N>=0;N--)C=C<<1^(C>>>7)*285,C^=(w>>>N&1)*b;return h(C>>>8==0),C}finderPenaltyCountPatterns(b){const w=b[1];h(w<=this.size*3);const C=w>0&&b[2]==w&&b[3]==w*3&&b[4]==w&&b[5]==w;return(C&&b[0]>=w*4&&b[6]>=w?1:0)+(C&&b[6]>=w*4&&b[0]>=w?1:0)}finderPenaltyTerminateAndCount(b,w,C){return b&&(this.finderPenaltyAddHistory(w,C),w=0),w+=this.size,this.finderPenaltyAddHistory(w,C),this.finderPenaltyCountPatterns(C)}finderPenaltyAddHistory(b,w){w[0]==0&&(b+=this.size),w.pop(),w.unshift(b)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],s.QrCode=e;function n(T,b,w){if(b<0||b>31||T>>>b)throw new RangeError("Value out of range");for(let C=b-1;C>=0;C--)w.push(T>>>C&1)}function o(T,b){return(T>>>b&1)!=0}function h(T){if(!T)throw new Error("Assertion error")}const g=class Nr{constructor(b,w,C){if(this.mode=b,this.numChars=w,this.bitData=C,w<0)throw new RangeError("Invalid argument");this.bitData=C.slice()}static makeBytes(b){let w=[];for(const C of b)n(C,8,w);return new Nr(Nr.Mode.BYTE,b.length,w)}static makeNumeric(b){if(!Nr.isNumeric(b))throw new RangeError("String contains non-numeric characters");let w=[];for(let C=0;C<b.length;){const N=Math.min(b.length-C,3);n(parseInt(b.substring(C,C+N),10),N*3+1,w),C+=N}return new Nr(Nr.Mode.NUMERIC,b.length,w)}static makeAlphanumeric(b){if(!Nr.isAlphanumeric(b))throw new RangeError("String contains unencodable characters in alphanumeric mode");let w=[],C;for(C=0;C+2<=b.length;C+=2){let N=Nr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(C))*45;N+=Nr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(C+1)),n(N,11,w)}return C<b.length&&n(Nr.ALPHANUMERIC_CHARSET.indexOf(b.charAt(C)),6,w),new Nr(Nr.Mode.ALPHANUMERIC,b.length,w)}static makeSegments(b){return b==""?[]:Nr.isNumeric(b)?[Nr.makeNumeric(b)]:Nr.isAlphanumeric(b)?[Nr.makeAlphanumeric(b)]:[Nr.makeBytes(Nr.toUtf8ByteArray(b))]}static makeEci(b){let w=[];if(b<0)throw new RangeError("ECI assignment value out of range");if(b<128)n(b,8,w);else if(b<16384)n(2,2,w),n(b,14,w);else if(b<1e6)n(6,3,w),n(b,21,w);else throw new RangeError("ECI assignment value out of range");return new Nr(Nr.Mode.ECI,0,w)}static isNumeric(b){return Nr.NUMERIC_REGEX.test(b)}static isAlphanumeric(b){return Nr.ALPHANUMERIC_REGEX.test(b)}getData(){return this.bitData.slice()}static getTotalBits(b,w){let C=0;for(const N of b){const P=N.mode.numCharCountBits(w);if(N.numChars>=1<<P)return 1/0;C+=4+P+N.bitData.length}return C}static toUtf8ByteArray(b){b=encodeURI(b);let w=[];for(let C=0;C<b.length;C++)b.charAt(C)!="%"?w.push(b.charCodeAt(C)):(w.push(parseInt(b.substring(C+1,C+3),16)),C+=2);return w}};g.NUMERIC_REGEX=/^[0-9]*$/,g.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,g.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let x=g;s.QrSegment=g})(xl||(xl={}));(s=>{(e=>{const n=class{constructor(h,g){this.ordinal=h,this.formatBits=g}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),e.Ecc=n})(s.QrCode||(s.QrCode={}))})(xl||(xl={}));(s=>{(e=>{const n=class{constructor(h,g){this.modeBits=h,this.numBitsCharCount=g}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),e.Mode=n})(s.QrSegment||(s.QrSegment={}))})(xl||(xl={}));var ic=xl;var oR={L:ic.QrCode.Ecc.LOW,M:ic.QrCode.Ecc.MEDIUM,Q:ic.QrCode.Ecc.QUARTILE,H:ic.QrCode.Ecc.HIGH},eA=128,tA="L",nA="#FFFFFF",rA="#000000",iA=!1,sA=1,lR=4,cR=0,uR=.1;function aA(s,e=0){const n=[];return s.forEach(function(o,h){let g=null;o.forEach(function(x,T){if(!x&&g!==null){n.push(`M${g+e} ${h+e}h${T-g}v1H${g+e}z`),g=null;return}if(T===o.length-1){if(!x)return;g===null?n.push(`M${T+e},${h+e} h1v1H${T+e}z`):n.push(`M${g+e},${h+e} h${T+1-g}v1H${g+e}z`);return}x&&g===null&&(g=T)})}),n.join("")}function oA(s,e){return s.slice().map((n,o)=>o<e.y||o>=e.y+e.h?n:n.map((h,g)=>g<e.x||g>=e.x+e.w?h:!1))}function hR(s,e,n,o){if(o==null)return null;const h=s.length+n*2,g=Math.floor(e*uR),x=h/e,T=(o.width||g)*x,b=(o.height||g)*x,w=o.x==null?s.length/2-T/2:o.x*x,C=o.y==null?s.length/2-b/2:o.y*x,N=o.opacity==null?1:o.opacity;let P=null;if(o.excavate){let ee=Math.floor(w),ne=Math.floor(C),ae=Math.ceil(T+w-ee),tt=Math.ceil(b+C-ne);P={x:ee,y:ne,w:ae,h:tt}}const B=o.crossOrigin;return{x:w,y:C,h:b,w:T,excavation:P,opacity:N,crossOrigin:B}}function dR(s,e){return e!=null?Math.max(Math.floor(e),0):s?lR:cR}function lA({value:s,level:e,minVersion:n,includeMargin:o,marginSize:h,imageSettings:g,size:x,boostLevel:T}){let b=Ke.useMemo(()=>{const ee=(Array.isArray(s)?s:[s]).reduce((ne,ae)=>(ne.push(...ic.QrSegment.makeSegments(ae)),ne),[]);return ic.QrCode.encodeSegments(ee,oR[e],n,void 0,void 0,T)},[s,e,n,T]);const{cells:w,margin:C,numCells:N,calculatedImageSettings:P}=Ke.useMemo(()=>{let B=b.getModules();const ee=dR(o,h),ne=B.length+ee*2,ae=hR(B,x,ee,g);return{cells:B,margin:ee,numCells:ne,calculatedImageSettings:ae}},[b,x,g,o,h]);return{qrcode:b,margin:C,cells:w,numCells:N,calculatedImageSettings:P}}var fR=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),cA=Ke.forwardRef(function(e,n){const o=e,{value:h,size:g=eA,level:x=tA,bgColor:T=nA,fgColor:b=rA,includeMargin:w=iA,minVersion:C=sA,boostLevel:N,marginSize:P,imageSettings:B}=o,ne=ig(o,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:ae}=ne,tt=ig(ne,["style"]),ze=B?.src,fe=Ke.useRef(null),Ge=Ke.useRef(null),gt=Ke.useCallback(ot=>{fe.current=ot,typeof n=="function"?n(ot):n&&(n.current=ot)},[n]),[Qe,F]=Ke.useState(!1),{margin:z,cells:U,numCells:J,calculatedImageSettings:X}=lA({value:h,level:x,minVersion:C,boostLevel:N,includeMargin:w,marginSize:P,imageSettings:B,size:g});Ke.useEffect(()=>{if(fe.current!=null){const ot=fe.current,oe=ot.getContext("2d");if(!oe)return;let le=U;const xe=Ge.current,We=X!=null&&xe!==null&&xe.complete&&xe.naturalHeight!==0&&xe.naturalWidth!==0;We&&X.excavation!=null&&(le=oA(U,X.excavation));const qe=window.devicePixelRatio||1;ot.height=ot.width=g*qe;const ut=g/J*qe;oe.scale(ut,ut),oe.fillStyle=T,oe.fillRect(0,0,J,J),oe.fillStyle=b,fR?oe.fill(new Path2D(aA(le,z))):U.forEach(function(K,se){K.forEach(function(ve,Ce){ve&&oe.fillRect(Ce+z,se+z,1,1)})}),X&&(oe.globalAlpha=X.opacity),We&&oe.drawImage(xe,X.x+z,X.y+z,X.w,X.h)}}),Ke.useEffect(()=>{F(!1)},[ze]);const Y=rg({height:g,width:g},ae);let G=null;return ze!=null&&(G=Ke.createElement("img",{src:ze,key:ze,style:{display:"none"},onLoad:()=>{F(!0)},ref:Ge,crossOrigin:X?.crossOrigin})),Ke.createElement(Ke.Fragment,null,Ke.createElement("canvas",rg({style:Y,height:g,width:g,ref:gt,role:"img"},tt)),G)});cA.displayName="QRCodeCanvas";var gR=Ke.forwardRef(function(e,n){const o=e,{value:h,size:g=eA,level:x=tA,bgColor:T=nA,fgColor:b=rA,includeMargin:w=iA,minVersion:C=sA,boostLevel:N,title:P,marginSize:B,imageSettings:ee}=o,ne=ig(o,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:ae,cells:tt,numCells:ze,calculatedImageSettings:fe}=lA({value:h,level:x,minVersion:C,boostLevel:N,includeMargin:w,marginSize:B,imageSettings:ee,size:g});let Ge=tt,gt=null;ee!=null&&fe!=null&&(fe.excavation!=null&&(Ge=oA(tt,fe.excavation)),gt=Ke.createElement("image",{href:ee.src,height:fe.h,width:fe.w,x:fe.x+ae,y:fe.y+ae,preserveAspectRatio:"none",opacity:fe.opacity,crossOrigin:fe.crossOrigin}));const Qe=aA(Ge,ae);return Ke.createElement("svg",rg({height:g,width:g,viewBox:`0 0 ${ze} ${ze}`,ref:n,role:"img"},ne),!!P&&Ke.createElement("title",null,P),Ke.createElement("path",{fill:T,d:`M0,0 h${ze}v${ze}H0z`,shapeRendering:"crispEdges"}),Ke.createElement("path",{fill:b,d:Qe,shapeRendering:"crispEdges"}),gt)});gR.displayName="QRCodeSVG";function mR({user:s}){const[e,n]=he.useState([]),[o,h]=he.useState(null),[g,x]=he.useState(null),[T,b]=he.useState(""),[w,C]=he.useState(null),[N,P]=he.useState([]),[B,ee]=he.useState(!0),[ne,ae]=he.useState(!1),[tt,ze]=he.useState([]),[fe,Ge]=he.useState(!0),[gt,Qe]=he.useState(""),[F,z]=he.useState(!1),[U,J]=he.useState({open:!1,attendee:null}),[X,Y]=he.useState(120),[G,ot]=he.useState([]),[oe,le]=he.useState(!1),xe=he.useRef(null),We=he.useRef(null),{options:qe}=om(),{logout:ut}=bc(),[K,se]=he.useState(!1);he.useEffect(()=>{(async()=>{ee(!0);const Ne=(await gr(Wn(Et,"times"))).docs.map(Ve=>{const it=Ve.data();return{id:Ve.id,name:it.name,category:it.category,term:it.term}});n(Ne),ee(!1)})()},[]),he.useEffect(()=>{(async()=>{try{const ge=Tn(Et,"users",s.uid),Ne=await Ua(ge),Ve=Ne.exists()?Ne.data():null,it=Array.isArray(Ve?.allowedTerms)?Ve.allowedTerms.map(Ie=>typeof Ie=="number"?Ie:parseInt(Ie,10)).filter(Ie=>!Number.isNaN(Ie)):[];x(it)}catch(ge){console.warn("Kunne ikke hente allowedTerms for lrer:",ge),x([])}})()},[s.uid]),he.useMemo(()=>{if(g===null)return qe;const Me=new Set(g??[]);return qe.filter(ge=>Me.has(ge.value))},[g,qe]),he.useEffect(()=>{(async()=>{if(!(g===null||!o)){Ge(!0);try{const ge=Wn(Et,"users"),Ne=ui(ge,Ar("role","==","student"),Ar("term","==",o)),it=(await gr(Ne)).docs.map(Ie=>{const Pt=Ie.data(),et=Pt?.name&&String(Pt.name)||Pt?.displayName&&String(Pt.displayName)||null;return{id:Ie.id,name:et,email:String(Pt?.email??""),phone:Pt?.phone?String(Pt.phone):null,term:typeof Pt?.term=="number"?Pt.term:null}});it.sort((Ie,Pt)=>{const et=(Ie.name??"").toLocaleLowerCase(),ht=(Pt.name??"").toLocaleLowerCase();return et!==ht?et.localeCompare(ht,"nb-NO"):Ie.email.localeCompare(Pt.email,"nb-NO")}),ze(it)}catch(ge){console.error("Feil ved lasting av studenter:",ge),ze([])}finally{Ge(!1)}}})()},[g,o]),he.useEffect(()=>{ve()},[s.uid]);const ve=async()=>{try{le(!0);const Me=Date.now()-14400*1e3,ge=Vn.fromMillis(Me),Ne=Wn(Et,"sessions");let Ve=[];try{const Pt=ui(Ne,Ar("teacherId","==",s.uid),Ar("createdAt",">=",ge),Zx("createdAt","desc"),Jx(50));Ve=(await gr(Pt)).docs}catch{const et=ui(Ne,Ar("teacherId","==",s.uid));Ve=(await gr(et)).docs.filter(Un=>{const Bt=Un.data()?.createdAt;return Bt&&Bt.toMillis()>=Me}).sort((Un,Bt)=>{const Kn=Un.data()?.createdAt?.toMillis?.()??0;return(Bt.data()?.createdAt?.toMillis?.()??0)-Kn}).slice(0,50)}const it=new Set,Ie=[];for(const Pt of Ve){const et=Pt.data(),ht=String(et?.timeId??"");if(!(!ht||it.has(ht))&&(it.add(ht),Ie.push({timeId:ht,name:String(et?.name??"Ukjent time"),category:String(et?.category??""),term:typeof et?.term=="number"?et.term:Number(et?.term)||0,lastAt:et?.createdAt}),Ie.length>=10))break}ot(Ie)}catch(Me){console.warn("Kunne ikke hente nylige timer:",Me),ot([])}finally{le(!1)}};he.useEffect(()=>{if(!w){P([]);return}const Me=Wn(Et,"sessions",w.id,"attendance"),ge=tE(Me,Ne=>{const Ve=Ne.docs.map(it=>{const Ie=it.data();return{id:it.id,studentName:Ie.studentName??null,studentEmail:Ie.studentEmail??null,createdAt:Ie.createdAt}}).sort((it,Ie)=>{const Pt=it.createdAt?.toMillis?.()??0,et=Ie.createdAt?.toMillis?.()??0;return Pt-et});P(Ve)});return()=>ge()},[w?.id]);const Ce=he.useMemo(()=>e.filter(Me=>Me.term===o),[e,o]),Le=he.useMemo(()=>{const Me=T.trim().toLowerCase();return Me?Ce.filter(ge=>ge.name.toLowerCase().includes(Me)).sort((ge,Ne)=>ge.name.localeCompare(Ne.name,"nb-NO",{sensitivity:"base"})):[]},[Ce,T]),me=he.useMemo(()=>{const Me=gt.trim().toLowerCase();if(!Me||!w)return[];const ge=Me.includes("@");return tt.filter(Ne=>{if(Ne.term!==w.term)return!1;const Ve=String(Ne.name??"").toLowerCase(),it=String(Ne.email??"").toLowerCase(),Ie=ge?it:it.split("@")[0]??it,Pt=String(Ne.phone??"").toLowerCase();return Ve.includes(Me)||Ie.includes(Me)||Pt.includes(Me)}).slice(0,10)},[tt,gt,w]),rt=async Me=>{const ge=e.find(ht=>ht.id===Me);if(!ge)return;if(w){const ht=Tn(Et,"sessions",w.id);await bi(ht,{isOpen:!1}),C(null)}const Ne=Math.floor(1e5+Math.random()*9e5),Ve=String(Ne),it=Wn(Et,"sessions"),Ie=Vn.now(),et={id:(await xd(it,{timeId:ge.id,name:ge.name,category:ge.category,term:ge.term,code:Ve,teacherId:s.uid,teacherName:s.displayName,teacherEmail:s.email,createdAt:Ie,isOpen:!0,openedAt:Ie})).id,timeId:ge.id,name:ge.name,category:ge.category,term:ge.term,code:Ve,teacherId:s.uid,createdAt:Ie,isOpen:!0,openedAt:Ie};C(et),ve()},mt=async Me=>{b(Me.name),ae(!1),await rt(Me.id),We.current&&We.current.blur()},Ct=async Me=>{h(Me.term),b(Me.name),ae(!1);let ge;try{const Ne=ui(Wn(Et,"sessions"),Ar("teacherId","==",s.uid),Ar("timeId","==",Me.timeId),Zx("createdAt","desc"),Jx(1));ge=(await gr(Ne)).docs[0]}catch{try{const Ve=ui(Wn(Et,"sessions"),Ar("teacherId","==",s.uid));ge=(await gr(Ve)).docs.filter(Pt=>String(Pt.data()?.timeId??"")===String(Me.timeId)).sort((Pt,et)=>{const ht=Pt.data()?.createdAt?.toMillis?.()??0;return(et.data()?.createdAt?.toMillis?.()??0)-ht})[0]}catch{}}if(ge){const Ne=ge.data();if(w&&w.id!==ge.id){try{await bi(Tn(Et,"sessions",w.id),{isOpen:!1})}catch{}C(null)}const Ve=Vn.now();try{await bi(Tn(Et,"sessions",ge.id),{isOpen:!0,openedAt:Ve})}catch{}const it={id:ge.id,timeId:String(Ne.timeId??Me.timeId),name:String(Ne.name??Me.name),category:String(Ne.category??""),term:typeof Ne.term=="number"?Ne.term:Number(Ne.term)||Me.term,code:String(Ne.code??""),teacherId:String(Ne.teacherId??s.uid),createdAt:Ne.createdAt??Vn.now(),isOpen:!0,openedAt:Ve};C(it),Y(120);return}await rt(Me.timeId)},sn=async()=>{if(!w)return;const Me=Tn(Et,"sessions",w.id);if(!w.isOpen){const Ne=Vn.now();await bi(Me,{isOpen:!0,openedAt:Ne}),C({...w,isOpen:!0,openedAt:Ne}),Y(120)}else await bi(Me,{isOpen:!1}),C({...w,isOpen:!1})};he.useEffect(()=>{if(!w)return;const Me=Tn(Et,"sessions",w.id),ge=tE(Me,Ne=>{if(!Ne.exists())return;const Ve=Ne.data();C(it=>it&&it.id===Ne.id?{...it,isOpen:Ve?.isOpen??it.isOpen,openedAt:Ve?.openedAt??it.openedAt}:it)});return()=>ge()},[w?.id]),he.useEffect(()=>{if(!w||!w.isOpen||!w.openedAt){Y(0);return}const Me=w.openedAt.toMillis(),ge=async()=>{const Ve=Date.now(),it=Math.floor((Ve-Me)/1e3),Ie=Math.max(0,60-it);if(Y(Ie),Ie===0&&w.isOpen)try{await bi(Tn(Et,"sessions",w.id),{isOpen:!1}),C({...w,isOpen:!1})}catch{}};ge();const Ne=setInterval(ge,1e3);return()=>clearInterval(Ne)},[w?.id,w?.isOpen,w?.openedAt]);const Qt=Me=>{const ge=Math.floor(Me/60).toString().padStart(2,"0"),Ne=Math.floor(Me%60).toString().padStart(2,"0");return`${ge}:${Ne}`},En=async Me=>{if(w)try{const ge=Tn(Et,"sessions",w.id,"attendance",Me.id);if((await Ua(ge)).exists()){It.error("Studenten er allerede registrert p denne kten.");return}await ul(ge,{userId:Me.id,studentName:Me.name??null,studentEmail:Me.email,createdAt:Vn.now(),status:"present",addedManually:!0,addedBy:s.uid}),Qe(""),z(!1)}catch(ge){console.error(ge),It.error("Kunne ikke legge til student manuelt.")}},Ot=Me=>{J({open:!0,attendee:Me})},gn=()=>{J({open:!1,attendee:null})},On=async()=>{if(!w||!U.attendee)return;const Me=U.attendee;try{await q_(Tn(Et,"sessions",w.id,"attendance",Me.id)),It.success("Student fjernet fra kten.")}catch(ge){console.error(ge),It.error("Kunne ikke fjerne studenten.")}finally{gn()}};return B?R.jsx("div",{className:"page-card page-card--teacher",children:R.jsx(Ro,{})}):R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"page-card page-card--teacher",children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[R.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[R.jsx("button",{className:"btn-hover-lg",type:"button",onClick:()=>se(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),R.jsx("button",{className:"btn-hover-lg",onClick:ut,type:"button",style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),R.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem"},children:"Registrer oppmte"}),R.jsxs("section",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",alignItems:"center"},children:[R.jsx("div",{style:{marginBottom:"1rem",width:"100%",maxWidth:520},children:(()=>{const Me=g!==null?new Set(g??[]):null,ge=Me?qe.filter(Ne=>Me.has(Ne.value)):qe;return ge.length===0?R.jsx("div",{style:{width:"100%",padding:"0.6rem 0",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"0.5rem",background:"#f9fafb",color:"#6b7280",textAlign:"center"},children:"Ingen terminer tilgjengelig"}):R.jsxs("select",{value:o??"",onChange:Ne=>{const Ve=Ne.target.value,it=Ve===""?null:parseInt(Ve,10);h(it),b(""),ae(!1),C(null),P([]),it!=null&&setTimeout(()=>{We.current?.focus()},0)},style:{width:"100%",padding:"0.6rem 0.75rem",fontSize:"16px",textAlign:"center",borderRadius:"0.5rem",border:"solid 1px"},children:[R.jsx("option",{value:"",disabled:!0,children:"Velg modul"}),ge.map(Ne=>R.jsx("option",{value:Ne.value,children:Ne.label},Ne.value))]})})()}),R.jsxs("div",{style:{position:"relative",marginBottom:"0.75rem",width:"100%",maxWidth:520},children:[R.jsx("input",{ref:We,value:T,onChange:Me=>{b(Me.target.value),ae(!0)},onFocus:()=>{o&&T.trim().length>0&&ae(!0)},placeholder:o?"Start  skrive navnet p timen...":"Velg modul frst",disabled:!o,style:{width:"100%",padding:"0.6rem 0rem",fontSize:"16px",textAlign:"center",borderRadius:"0.5rem",border:"solid 1px",opacity:o?1:.6}}),ne&&Le.length>0&&R.jsx("ul",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",marginTop:"0.2rem",listStyle:"none",padding:0,maxHeight:"220px",overflowY:"auto",boxShadow:"0 10px 20px rgba(0,0,0,0.08)"},children:Le.map(Me=>R.jsxs("li",{onClick:()=>mt(Me),style:{padding:"0.4rem 0.6rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseDown:ge=>ge.preventDefault(),children:[R.jsx("div",{children:Me.name}),R.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:Me.category})]},Me.id))})]})]}),!w&&G.length>0&&R.jsx("section",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",alignItems:"center"},children:R.jsxs("div",{style:{width:"100%",maxWidth:520},children:[R.jsx("h4",{style:{textAlign:"center",marginTop:0},children:"Nylig registrerte timer"}),R.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:G.map(Me=>R.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid #f3f4f6"},children:[R.jsxs("div",{children:[R.jsx("div",{style:{fontWeight:600},children:Me.name}),R.jsxs("div",{style:{fontSize:"0.8rem",color:"#6b7280"},children:[Me.category,"  ",yl(qe,Me.term)]})]}),R.jsx("button",{type:"button",onClick:()=>void Ct(Me),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"none",background:"#6CE1AB",color:"black",cursor:"pointer"},children:"pne"})]},Me.timeId))})]})})]}),R.jsx("br",{}),R.jsx("div",{className:"page-card page-card--session",style:{display:w?void 0:"none"},children:w&&R.jsxs("section",{ref:xe,style:{marginTop:"2rem",padding:"1rem",background:"#f9fafb"},children:[R.jsxs("div",{style:{textAlign:"center"},children:[R.jsx("h3",{style:{marginTop:0,marginBottom:"0.25rem"},children:yl(qe,w.term)}),R.jsxs("p",{style:{margin:0},children:[R.jsx("strong",{children:"Time:"})," ",w.name]}),R.jsxs("p",{style:{marginTop:"0.2rem"},children:[R.jsx("strong",{children:"Gruppe:"})," ",w.category]})]}),R.jsxs("div",{style:{marginTop:"1rem",position:"relative"},children:[R.jsxs("div",{style:{filter:w.isOpen===!1?"blur(6px)":"none",pointerEvents:"none",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[R.jsx(cA,{value:w.code,size:160,bgColor:"#f9fafb",includeMargin:!0}),R.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",letterSpacing:"0.3em"},children:w.code})]}),w.isOpen===!1&&R.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center"},children:R.jsx("div",{style:{background:"rgba(255,255,255,0.85)",padding:"0.5rem 0.75rem",borderRadius:"0.5rem",border:"1px solid #e5e7eb",fontWeight:600,color:"#6b7280"},children:"kten er lukket"})})]}),R.jsxs("div",{style:{marginTop:"1.5rem"},children:[R.jsx("h4",{style:{textAlign:"center",marginBottom:"0.3rem"},children:"Legg til student manuelt"}),R.jsx("p",{style:{fontSize:"0.8rem",color:"#6b7280",textAlign:"center",marginTop:0,marginBottom:"0.5rem"},children:"Brukes dersom en student ikke kan skanne eller skrive inn kode."}),fe&&R.jsx("div",{style:{display:"flex",justifyContent:"center"},children:R.jsx(Ro,{})}),R.jsxs("div",{style:{position:"relative",maxWidth:"360px",margin:"0 auto"},children:[R.jsx("input",{value:gt,onChange:Me=>{Qe(Me.target.value),z(!0)},onFocus:()=>{gt.trim().length>0&&z(!0)},placeholder:fe?"Laster studenter...":"Sk p navn, e-post eller telefon",disabled:fe,style:{width:"100%",padding:"0.6rem 0.75rem",fontSize:"16px",borderRadius:"0.5rem",border:"1px solid #d1d5db",textAlign:"center"}}),F&&me.length>0&&R.jsx("ul",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:20,background:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",marginTop:"0.2rem",listStyle:"none",padding:0,maxHeight:"220px",overflowY:"auto",boxShadow:"0 10px 20px rgba(0,0,0,0.08)"},children:me.map(Me=>R.jsxs("li",{onClick:()=>En(Me),style:{padding:"0.4rem 0.6rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseDown:ge=>ge.preventDefault(),children:[R.jsx("div",{children:Me.name||"(Uten navn)"}),R.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[Me.email,Me.phone?`  ${Me.phone}`:""]})]},Me.id))})]})]}),R.jsxs("div",{style:{marginTop:"1.2rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[R.jsx("div",{style:{fontWeight:600,color:"#111827"},children:Qt(X)}),R.jsx("button",{onClick:sn,style:{padding:"0.5rem 1.2rem",borderRadius:"999px",border:"none",background:(w.isOpen===!1,"#6CE1AB"),color:"black",fontWeight:500,cursor:"pointer"},children:w.isOpen===!1?"pne kta":"Lukk kt"})]}),R.jsx("hr",{style:{margin:"1rem 0"}}),R.jsx("h4",{children:"Registrerte studenter"}),N.length===0?R.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Ingen har registrert seg enn."}):R.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[R.jsx("thead",{children:R.jsxs("tr",{children:[R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Navn"}),R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"E-post"}),R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.3rem"},children:"Tidspunkt"}),R.jsx("th",{style:{textAlign:"right",borderBottom:"1px solid #e5e7eb",padding:"0.3rem",width:40}})]})}),R.jsx("tbody",{children:N.map(Me=>R.jsxs("tr",{children:[R.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6"},children:Me.studentName||"-"}),R.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6"},children:Me.studentEmail||"-"}),R.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6",fontSize:"0.8rem",color:"#6b7280"},children:Me.createdAt?new Date(Me.createdAt.toMillis()).toLocaleTimeString("no-NO",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}),R.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:R.jsx("button",{type:"button",onClick:()=>Ot(Me),"aria-label":"Fjern student fra kten",title:"Fjern student",style:{background:"transparent",border:"none",cursor:"pointer",color:"#b91c1c",padding:"0.15rem"},children:R.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[R.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),R.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})})]},Me.id))})]})]})}),U.open&&U.attendee&&R.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:R.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff",textAlign:"center"},children:[R.jsx("h3",{style:{marginTop:0},children:"Fjerne student?"}),R.jsx("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:(()=>{const Me=U.attendee;return`Du er i ferd med  fjerne ${Me.studentName||Me.studentEmail||"denne studenten"} fra denne kten.`})()}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",marginTop:"0.75rem"},children:[R.jsx("button",{className:"button",type:"button",onClick:gn,style:{background:"#ef4444",color:"#ffffff"},children:"Avbryt"}),R.jsx("button",{type:"button",onClick:()=>void On(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Fjern student"})]})]})}),K&&R.jsx(lm,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>se(!1)})]})}const pR="type.googleapis.com/google.protobuf.Int64Value",yR="type.googleapis.com/google.protobuf.UInt64Value";function uA(s,e){const n={};for(const o in s)s.hasOwnProperty(o)&&(n[o]=e(s[o]));return n}function Hd(s){if(s==null)return null;if(s instanceof Number&&(s=s.valueOf()),typeof s=="number"&&isFinite(s)||s===!0||s===!1||Object.prototype.toString.call(s)==="[object String]")return s;if(s instanceof Date)return s.toISOString();if(Array.isArray(s))return s.map(e=>Hd(e));if(typeof s=="function"||typeof s=="object")return uA(s,e=>Hd(e));throw new Error("Data cannot be encoded in JSON: "+s)}function pc(s){if(s==null)return s;if(s["@type"])switch(s["@type"]){case pR:case yR:{const e=Number(s.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+s);return e}default:throw new Error("Data cannot be decoded from JSON: "+s)}return Array.isArray(s)?s.map(e=>pc(e)):typeof s=="function"||typeof s=="object"?uA(s,e=>pc(e)):s}const cm="functions";const xE={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ki extends na{constructor(e,n,o){super(`${cm}/${e}`,n||""),this.details=o,Object.setPrototypeOf(this,Ki.prototype)}}function xR(s){if(s>=200&&s<300)return"ok";switch(s){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Gd(s,e){let n=xR(s),o=n,h;try{const g=e&&e.error;if(g){const x=g.status;if(typeof x=="string"){if(!xE[x])return new Ki("internal","internal");n=xE[x],o=x}const T=g.message;typeof T=="string"&&(o=T),h=g.details,h!==void 0&&(h=pc(h))}}catch{}return n==="ok"?null:new Ki(n,o,h)}class ER{constructor(e,n,o,h){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,cs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=o.getImmediate({optional:!0}),this.auth||n.get().then(g=>this.auth=g,()=>{}),this.messaging||o.get().then(g=>this.messaging=g,()=>{}),this.appCheck||h?.get().then(g=>this.appCheck=g,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),o=await this.getMessagingToken(),h=await this.getAppCheckToken(e);return{authToken:n,messagingToken:o,appCheckToken:h}}}const sg="us-central1",wR=/^data: (.*?)(?:\n|$)/;function _R(s){let e=null;return{promise:new Promise((n,o)=>{e=setTimeout(()=>{o(new Ki("deadline-exceeded","deadline-exceeded"))},s)}),cancel:()=>{e&&clearTimeout(e)}}}class AR{constructor(e,n,o,h,g=sg,x=(...T)=>fetch(...T)){this.app=e,this.fetchImpl=x,this.emulatorOrigin=null,this.contextProvider=new ER(e,n,o,h),this.cancelAllRequests=new Promise(T=>{this.deleteService=()=>Promise.resolve(T())});try{const T=new URL(g);this.customDomain=T.origin+(T.pathname==="/"?"":T.pathname),this.region=sg}catch{this.customDomain=null,this.region=g}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function bR(s,e,n){const o=Bo(e);s.emulatorOrigin=`http${o?"s":""}://${e}:${n}`,o&&(og(s.emulatorOrigin+"/backends"),lg("Functions",!0))}function vR(s,e,n){const o=h=>CR(s,e,h,{});return o.stream=(h,g)=>IR(s,e,h,g),o}function hA(s){return s.emulatorOrigin&&Bo(s.emulatorOrigin)?"include":void 0}async function TR(s,e,n,o,h){n["Content-Type"]="application/json";let g;try{g=await o(s,{method:"POST",body:JSON.stringify(e),headers:n,credentials:hA(h)})}catch{return{status:0,json:null}}let x=null;try{x=await g.json()}catch{}return{status:g.status,json:x}}async function dA(s,e){const n={},o=await s.contextProvider.getContext(e.limitedUseAppCheckTokens);return o.authToken&&(n.Authorization="Bearer "+o.authToken),o.messagingToken&&(n["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=o.appCheckToken),n}function CR(s,e,n,o){const h=s._url(e);return SR(s,h,n,o)}async function SR(s,e,n,o){n=Hd(n);const h={data:n},g=await dA(s,o),x=o.timeout||7e4,T=_R(x),b=await Promise.race([TR(e,h,g,s.fetchImpl,s),T.promise,s.cancelAllRequests]);if(T.cancel(),!b)throw new Ki("cancelled","Firebase Functions instance was deleted.");const w=Gd(b.status,b.json);if(w)throw w;if(!b.json)throw new Ki("internal","Response is not valid JSON object.");let C=b.json.data;if(typeof C>"u"&&(C=b.json.result),typeof C>"u")throw new Ki("internal","Response is missing data field.");return{data:pc(C)}}function IR(s,e,n,o){const h=s._url(e);return RR(s,h,n,o||{})}async function RR(s,e,n,o){n=Hd(n);const h={data:n},g=await dA(s,o);g["Content-Type"]="application/json",g.Accept="text/event-stream";let x;try{x=await s.fetchImpl(e,{method:"POST",body:JSON.stringify(h),headers:g,signal:o?.signal,credentials:hA(s)})}catch(P){if(P instanceof Error&&P.name==="AbortError"){const ee=new Ki("cancelled","Request was cancelled.");return{data:Promise.reject(ee),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(ee)}}}}}}const B=Gd(0,null);return{data:Promise.reject(B),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(B)}}}}}}let T,b;const w=new Promise((P,B)=>{T=P,b=B});o?.signal?.addEventListener("abort",()=>{const P=new Ki("cancelled","Request was cancelled.");b(P)});const C=x.body.getReader(),N=NR(C,T,b,o?.signal);return{stream:{[Symbol.asyncIterator](){const P=N.getReader();return{async next(){const{value:B,done:ee}=await P.read();return{value:B,done:ee}},async return(){return await P.cancel(),{done:!0,value:void 0}}}}},data:w}}function NR(s,e,n,o){const h=(x,T)=>{const b=x.match(wR);if(!b)return;const w=b[1];try{const C=JSON.parse(w);if("result"in C){e(pc(C.result));return}if("message"in C){T.enqueue(pc(C.message));return}if("error"in C){const N=Gd(0,C);T.error(N),n(N);return}}catch(C){if(C instanceof Ki){T.error(C),n(C);return}}},g=new TextDecoder;return new ReadableStream({start(x){let T="";return b();async function b(){if(o?.aborted){const w=new Ki("cancelled","Request was cancelled");return x.error(w),n(w),Promise.resolve()}try{const{value:w,done:C}=await s.read();if(C){T.trim()&&h(T.trim(),x),x.close();return}if(o?.aborted){const P=new Ki("cancelled","Request was cancelled");x.error(P),n(P),await s.cancel();return}T+=g.decode(w,{stream:!0});const N=T.split(`
`);T=N.pop()||"";for(const P of N)P.trim()&&h(P.trim(),x);return b()}catch(w){const C=w instanceof Ki?w:Gd(0,null);x.error(C),n(C)}}},cancel(){return s.cancel()}})}const EE="@firebase/functions",wE="0.13.1";const OR="auth-internal",DR="app-check-internal",MR="messaging-internal";function kR(s){const e=(n,{instanceIdentifier:o})=>{const h=n.getProvider("app").getImmediate(),g=n.getProvider(OR),x=n.getProvider(MR),T=n.getProvider(DR);return new AR(h,g,x,T,o)};dl(new No(cm,e,"PUBLIC").setMultipleInstances(!0)),Ys(EE,wE,s),Ys(EE,wE,"esm2020")}function T1(s=Wd(),e=sg){const o=Yd(sr(s),cm).getImmediate({identifier:e}),h=SE("functions");return h&&LR(o,...h),o}function LR(s,e,n){bR(sr(s),e,n)}function C1(s,e,n){return vR(sr(s),e)}kR();function _E(s){const e=s.match(/^\s*(\d+)/);return e?parseInt(e[1],10):Number.POSITIVE_INFINITY}function S1(){const s="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$";let e="";for(let n=0;n<12;n++)e+=s[Math.floor(Math.random()*s.length)];return e}const PR=()=>{const{user:s}=bc(),[e,n]=he.useState([]),[o,h]=he.useState(!0),[g,x]=he.useState(""),[T,b]=he.useState("students"),[w,C]=he.useState("all"),[N,P]=he.useState("name"),[B,ee]=he.useState("asc"),[ne,ae]=he.useState("all"),[tt,ze]=he.useState("name"),[fe,Ge]=he.useState("asc"),[gt,Qe]=he.useState("all"),[F,z]=he.useState("name"),[U,J]=he.useState("asc"),[X,Y]=he.useState([]),G=he.useMemo(()=>X.slice().sort((W,Te)=>(W.order??W.value)-(Te.order??Te.value)).map(W=>({value:W.value,label:W.label||`Termin ${W.value}`})),[X]),[ot,oe]=he.useState(null),[le,xe]=he.useState(null);he.useEffect(()=>{(async()=>{try{if(!s?.uid)return;const Te=Tn(Et,"users",s.uid),Je=await Ua(Te),xt=Je.exists()?Je.data():null,lt=(Array.isArray(xt?.allowedTerms)?xt.allowedTerms:[]).map(ft=>typeof ft=="number"?ft:parseInt(String(ft),10)).filter(ft=>!Number.isNaN(ft));oe(lt),xe(!!xt?.isSuperAdmin)}catch(Te){console.warn("Kunne ikke hente allowedTerms for innlogget admin:",Te),oe([]),xe(!1)}})()},[s?.uid]);const We=he.useMemo(()=>{if(le===!0||ot===null)return G;const W=new Set(ot);return G.filter(Te=>W.has(Te.value))},[G,ot,le]),qe=he.useMemo(()=>{if(le)return null;const W=ot;return Array.isArray(W)&&W.length===1?Number(W[0]):null},[le,ot]);he.useEffect(()=>{qe!=null&&(w==="all"&&C(qe),ne==="all"&&ae(qe))},[qe]),he.useEffect(()=>{(async()=>{try{const Je=(await gr(Wn(Et,"terms"))).docs.map(xt=>{const nt=xt.data(),lt=typeof nt?.value=="number"?nt.value:void 0;if(typeof lt!="number")return null;const ft=typeof nt?.label=="string"?nt.label:"",hn=typeof nt?.order=="number"?nt.order:void 0;return{value:lt,label:ft,order:hn}}).filter(Boolean);Je.sort((xt,nt)=>(xt.order??xt.value)-(nt.order??nt.value)),Y(Je)}catch(Te){console.warn("Kunne ikke laste terminer fra Firestore for admin-brukerpanel:",Te)}})()},[]);const[ut,K]=he.useState(null),[se,ve]=he.useState(null),[Ce,Le]=he.useState(""),[me,rt]=he.useState(""),[mt,Ct]=he.useState(""),[sn,Qt]=he.useState("teacher"),[En,Ot]=he.useState([]),[gn,On]=he.useState(null),[Me,ge]=he.useState(null),[Ne,Ve]=he.useState(""),[it,Ie]=he.useState(""),[Pt,et]=he.useState(""),[ht,Un]=he.useState("student"),[Bt,Kn]=he.useState(null),[lr,cr]=he.useState(null),[Zr,Ti]=he.useState({}),ki=(W,Te)=>{if(W&&Te!=null)return Zr[W]?.[Te]},tn=async(W,Te)=>{if(!(!W||Te==null)&&Zr[W]?.[Te]===void 0)try{const Je=Tn(Et,"users",W,"books",String(Te)),xt=await Ua(Je),nt=xt.exists()?{approved:!!xt.data().approved,approvedAt:xt.data().approvedAt??null}:{approved:!1,approvedAt:null};Ti(lt=>({...lt,[W]:{...lt[W]??{},[Te]:nt}}))}catch(Je){console.error("Kunne ikke laste godkjenning for bok:",Je)}},Fe=({uid:W,term:Te})=>{const Je=ki(W,Te);if(he.useEffect(()=>{Je===void 0&&tn(W,Te)},[W,Te,Je]),!Je)return R.jsx("span",{style:{color:"#9ca3af"},children:""});if(Je.approved){const xt=Je.approvedAt,nt=xt?new Date(xt.toDate()).toLocaleString("nb-NO"):void 0;return R.jsx("span",{title:nt,style:{color:"#16a34a",fontSize:"1rem"},children:""})}return R.jsx("span",{style:{color:"#9ca3af"},children:""})},[Ht,At]=he.useState(null),[wn,vr]=he.useState(null),[Xr,Tr]=he.useState(""),[Vt,Zt]=he.useState(""),[jn,Mr]=he.useState(""),[dt,nn]=he.useState("admin"),[re,Se]=he.useState([]);he.useEffect(()=>{(async()=>{try{h(!0);const Je=(await gr(Wn(Et,"users"))).docs.map(xt=>{const nt=xt.data();return{docId:xt.id,email:nt.email??"",displayName:nt.name??nt.displayName??nt.email??"(uten navn)",role:nt.role??"student",term:nt.term??null,phone:nt.phone??null,allowedTerms:nt.allowedTerms??[]}});Je.sort((xt,nt)=>xt.displayName.localeCompare(nt.displayName,"nb-NO",{sensitivity:"base"})),n(Je)}catch(Te){console.error("Feil ved lasting av brukere:",Te),n([])}finally{h(!1)}})()},[]);const je=he.useMemo(()=>{const W=g.trim().toLowerCase();if(!W)return e;const Te=W.includes("@");return e.filter(Je=>{const xt=String(Je.displayName??"").toLowerCase(),nt=String(Je.email??"").toLowerCase(),lt=Te?nt:nt.split("@")[0]??nt,ft=String(Je.phone??"").toLowerCase();return`${xt} ${lt} ${ft}`.includes(W)})},[e,g]);let Xe=je.filter(W=>W.role==="teacher"),st=je.filter(W=>W.role==="student"),pt=je.filter(W=>W.role==="admin");const at=(()=>{if(le)return{teachers:Xe,students:st,admins:pt};const W=ot;if(!(Array.isArray(W)&&W.length>0))return{teachers:Xe,students:st,admins:pt};const Je=new Set(W),xt=Xe.filter(ft=>(ft.allowedTerms??[]).some(hn=>Je.has(Number(hn)))),nt=st.filter(ft=>ft.term!=null&&Je.has(Number(ft.term)));return{teachers:xt,students:nt,admins:pt}})();if(Xe=at.teachers,st=at.students,pt=at.admins,w!=="all"){const W=w;Xe=Xe.filter(Te=>(Te.allowedTerms??[]).includes(W))}if(ne!=="all"){const W=ne;st=st.filter(Te=>Te.term===W)}if(gt!=="all"){const W=gt;pt=pt.filter(Te=>(Te.allowedTerms??[]).includes(W))}Xe.sort((W,Te)=>{const Je=lt=>N==="name"?lt.displayName??"":N==="email"?lt.email??"":lt.phone??"",xt=String(Je(W)??"").toLowerCase(),nt=String(Je(Te)??"").toLowerCase();return xt<nt?B==="asc"?-1:1:xt>nt?B==="asc"?1:-1:0}),st.sort((W,Te)=>{const Je=lt=>tt==="name"?lt.displayName??"":tt==="email"?lt.email??"":lt.phone??"",xt=String(Je(W)??"").toLowerCase(),nt=String(Je(Te)??"").toLowerCase();return xt<nt?fe==="asc"?-1:1:xt>nt?fe==="asc"?1:-1:0}),pt.sort((W,Te)=>{const Je=lt=>F==="name"?lt.displayName??"":F==="email"?lt.email??"":lt.phone??"",xt=String(Je(W)??"").toLowerCase(),nt=String(Je(Te)??"").toLowerCase();return xt<nt?U==="asc"?-1:1:xt>nt?U==="asc"?1:-1:0}),Xe=Xe.slice(0,50),st=st.slice(0,50),pt=pt.slice(0,50);const Gt=W=>{P(Te=>Te===W?(ee(Je=>Je==="asc"?"desc":"asc"),Te):(ee("asc"),W))},Rt=W=>{ze(Te=>Te===W?(Ge(Je=>Je==="asc"?"desc":"asc"),Te):(Ge("asc"),W))},Ut=W=>{z(Te=>Te===W?(J(Je=>Je==="asc"?"desc":"asc"),Te):(J("asc"),W))},Oe=()=>{K("create"),ve(null),Le(""),rt(""),Ct(""),Qt("teacher"),Ot(qe!=null?[qe]:[])},an=async()=>{const W=me.trim(),Te=Ce.trim(),Je=mt.trim();if(!W){It.error("E-post m fylles ut for  opprette lrer.");return}if(!En||En.length===0){It.error("Velg minst n termin lreren kan registrere for.");return}try{const xt=S1(),lt=(await cd(v1,W,xt)).user.uid,ft={uid:lt,email:W,displayName:Te||W,name:Te||W,role:"teacher",term:null,phone:Je||null,allowedTerms:En};await ul(Tn(Et,"users",lt),ft,{merge:!0}),n(hn=>{const dn=[{docId:lt,email:W,displayName:ft.displayName,role:"teacher",term:null,phone:Je||null,allowedTerms:[...En]},...hn];return dn.sort((In,jt)=>In.displayName.localeCompare(jt.displayName,"nb-NO",{sensitivity:"base"})),dn}),K(null),ve(null),It.success("Ny lrer opprettet",{description:`Epost: ${W}
Midlertidig passord: ${xt}
Gi passordet videre og be om passordbytte etter frste innlogging.`,duration:15e3})}catch(xt){if(console.error("Feil ved oppretting av lrer:",xt),xt?.code==="auth/email-already-in-use")try{const nt=ui(Wn(Et,"users"),Ar("email","==",W)),lt=await gr(nt);if(lt.empty){It.error("Eposten finnes allerede i Auth, men fant ingen bruker i Firestore. Kontakt administrator.");return}const ft=lt.docs[0],hn=ft.data(),dn=Array.isArray(hn?.allowedTerms)?hn.allowedTerms.map(kn=>typeof kn=="number"?kn:parseInt(String(kn),10)).filter(kn=>!Number.isNaN(kn)):[],In=new Set([...dn,...En]),jt=Array.from(In);await bi(Tn(Et,"users",ft.id),{role:"teacher",allowedTerms:jt,displayName:Te||hn?.displayName||hn?.name||W,name:Te||hn?.name||hn?.displayName||W,phone:Je||hn?.phone||null}),n(kn=>{const Pi=kn.findIndex(Cr=>Cr.docId===ft.id),Nt={docId:ft.id,email:W,displayName:Te||(hn?.displayName??hn?.name??W),role:"teacher",term:null,phone:Je||hn?.phone||null,allowedTerms:jt};if(Pi>=0){const Cr=kn.slice();return Cr[Pi]={...Cr[Pi],...Nt},Cr}const tr=[Nt,...kn];return tr.sort((Cr,gi)=>(Cr.displayName??"").localeCompare(gi.displayName??"","nb-NO",{sensitivity:"base"})),tr}),K(null),ve(null),It.success("Eksisterende bruker oppdatert som lrer og tildelt valgte terminer.")}catch(nt){console.error("Kunne ikke oppdatere eksisterende lrer:",nt),It.error("Kunne ikke oppdatere eksisterende bruker med nye terminer.")}else It.error("Kunne ikke opprette lrer. Se console for mer info.")}},yt=W=>{K("edit"),ve(W),Le(W.displayName),rt(W.email),Ct(W.phone??""),Qt(W.role),Ot(W.allowedTerms??[])},Mt=async()=>{if(!se)return;const W=se.docId;try{if(me.trim()&&me.trim()!==(se.email||""))try{const Je=T1(void 0,"europe-west1");await C1(Je,"adminUpdateUserEmail")({uid:W,newEmail:me.trim()})}catch(Je){console.error("adminUpdateUserEmail failed",Je),It.error("Kunne ikke oppdatere lrerens epost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const Te=Tn(Et,"users",W);await bi(Te,{displayName:Ce,email:me,phone:mt||null,role:sn,allowedTerms:En}),n(Je=>Je.map(xt=>xt.docId===W?{...xt,displayName:Ce,email:me,phone:mt||null,role:sn,allowedTerms:[...En]}:xt)),K(null),ve(null)}catch(Te){console.error("Feil ved lagring av lrer:",Te),It.error("Kunne ikke lagre endringer for lrer.")}},er=()=>{K(null),ve(null)},fi=W=>{Ot(Te=>Te.includes(W)?Te.filter(Je=>Je!==W):[...Te,W])},Ps=()=>{On("create"),ge(null),Ve(""),Ie(""),et(""),Un("student"),Kn(qe??null)},ri=async()=>{const W=it.trim(),Te=Ne.trim(),Je=Pt.trim();if(!Te){It.error("Navn m fylles ut for  opprette student.");return}if(!W){It.error("E-post m fylles ut for  opprette student.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(W)){It.error("Ugyldig epost.");return}if(Bt==null){It.error("Velg termin studenten tilhrer.");return}try{const nt=S1(),ft=(await cd(v1,W,nt)).user.uid,hn={uid:ft,email:W,displayName:Te||W,name:Te||W,role:"student",term:Bt,phone:Je||null,allowedTerms:[]};await ul(Tn(Et,"users",ft),hn,{merge:!0}),n(dn=>{const In=[{docId:ft,email:W,displayName:hn.displayName,role:"student",term:Bt,phone:Je||null,allowedTerms:[]},...dn];return In.sort((jt,kn)=>jt.displayName.localeCompare(kn.displayName,"nb-NO",{sensitivity:"base"})),In}),On(null),ge(null),It.success(`Ny student med epost ${W} er opprettet.`,{description:"Be studenten trykke Glemt passord p innloggingssiden for  lage sitt eget passord.",duration:12e3})}catch(nt){if(console.error("Feil ved oppretting av student:",nt),nt?.code==="auth/invalid-email")It.error("Ugyldig epost.");else if(nt?.code==="auth/email-already-in-use")try{const lt=ui(Wn(Et,"users"),Ar("email","==",W)),ft=await gr(lt);if(ft.empty){It.error("Eposten finnes allerede i Auth, men fant ingen bruker i Firestore. Kontakt administrator.");return}const hn=ft.docs[0],dn=hn.data();await bi(Tn(Et,"users",hn.id),{role:"student",term:Bt,displayName:Te||dn?.displayName||dn?.name||W,name:Te||dn?.name||dn?.displayName||W,phone:Je||dn?.phone||null}),n(jt=>{const kn=jt.findIndex(tr=>tr.docId===hn.id),Pi={docId:hn.id,email:W,displayName:Te||(dn?.displayName??dn?.name??W),role:"student",term:Bt,phone:Je||dn?.phone||null,allowedTerms:Array.isArray(dn?.allowedTerms)?dn.allowedTerms:[]};if(kn>=0){const tr=jt.slice();return tr[kn]={...tr[kn],...Pi},tr}const Nt=[Pi,...jt];return Nt.sort((tr,Cr)=>(tr.displayName??"").localeCompare(Cr.displayName??"","nb-NO",{sensitivity:"base"})),Nt}),On(null),ge(null);const In=fE(G,Bt);It.success(`Eksisterende bruker oppdatert til termin ${In}.`)}catch(lt){console.error("Kunne ikke oppdatere eksisterende student:",lt),It.error("Kunne ikke oppdatere eksisterende bruker med valgt termin.")}else nt?.code==="auth/missing-email"?It.error("Epost mangler."):It.error("Kunne ikke opprette student. Prv igjen senere.")}},za=W=>{On("edit"),ge(W),Ve(W.displayName),Ie(W.email),et(W.phone??""),Un(W.role),Kn(W.term??null)},Li=async()=>{if(!Me)return;const W=Me.docId;try{if(it.trim()&&it.trim()!==(Me.email||""))try{const Je=T1(void 0,"europe-west1");await C1(Je,"adminUpdateUserEmail")({uid:W,newEmail:it.trim()})}catch(Je){console.error("adminUpdateUserEmail failed",Je),It.error("Kunne ikke oppdatere studentens epost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const Te=Tn(Et,"users",W);await bi(Te,{displayName:Ne,email:it,phone:Pt||null,role:ht,term:Bt??null}),n(Je=>Je.map(xt=>xt.docId===W?{...xt,displayName:Ne,email:it,phone:Pt||null,role:ht,term:Bt??null}:xt)),On(null),ge(null)}catch(Te){console.error("Feil ved lagring av student:",Te),It.error("Kunne ikke lagre endringer for student.")}},Yr=()=>{On(null),ge(null)},Qn=()=>{At("create"),vr(null),Tr(""),Zt(""),Mr(""),nn("admin"),Se([])},un=async()=>{const W=Vt.trim(),Te=Xr.trim(),Je=jn.trim();if(!W){It.error("E-post m fylles ut for  opprette admin.");return}if(!Je){It.error("Mobilnummer m fylles ut for  opprette admin.");return}if(!re||re.length===0){It.error("Velg minst n termin administratoren skal ha tilgang til.");return}try{const xt=S1(),lt=(await cd(v1,W,xt)).user.uid,ft={uid:lt,email:W,displayName:Te||W,name:Te||W,role:"admin",term:null,phone:Je,allowedTerms:re};await ul(Tn(Et,"users",lt),ft,{merge:!0}),n(hn=>{const dn=[{docId:lt,email:W,displayName:ft.displayName,role:"admin",term:null,phone:Je,allowedTerms:[...re]},...hn];return dn.sort((In,jt)=>In.displayName.localeCompare(jt.displayName,"nb-NO",{sensitivity:"base"})),dn}),At(null),vr(null),It.success("Ny admin opprettet",{description:`Epost: ${W}
Midlertidig passord: ${xt}
Gi passordet videre og be om passordbytte etter frste innlogging.`,duration:15e3})}catch(xt){console.error("Feil ved oppretting av admin:",xt),xt?.code==="auth/email-already-in-use"?It.error("E-posten er allerede i bruk i Auth. Bruk en annen eller koble eksisterende bruker."):It.error("Kunne ikke opprette admin. Se console for mer info.")}},Jr=W=>{At("edit"),vr(W),Tr(W.displayName),Zt(W.email),Mr(W.phone??""),nn(W.role),Se(W.allowedTerms??[])},kr=async()=>{if(!wn)return;const W=wn.docId;try{if(Vt.trim()&&Vt.trim()!==(wn.email||""))try{const Je=T1(void 0,"europe-west1");await C1(Je,"adminUpdateUserEmail")({uid:W,newEmail:Vt.trim()})}catch(Je){console.error("adminUpdateUserEmail failed",Je),It.error("Kunne ikke oppdatere adminepost i Auth. Endringen er avbrutt. Kontroller at Cloud Function 'adminUpdateUserEmail' er deployet og at du har tilgang.");return}const Te=Tn(Et,"users",W);await bi(Te,{displayName:Xr,email:Vt,phone:jn||null,role:dt,allowedTerms:re}),n(Je=>Je.map(xt=>xt.docId===W?{...xt,displayName:Xr,email:Vt,phone:jn||null,role:dt,allowedTerms:[...re]}:xt)),At(null),vr(null)}catch(Te){console.error("Feil ved lagring av admin:",Te),It.error("Kunne ikke lagre endringer for admin.")}},ar=()=>{At(null),vr(null)},Be=W=>{Se(Te=>Te.includes(W)?Te.filter(Je=>Je!==W):[...Te,W])};return R.jsxs("div",{style:{marginBottom:"2rem"},children:[R.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem"},children:[R.jsx("button",{type:"button",onClick:()=>b("students"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:T==="students"?"1px solid #6CE1AB":"1px solid #d1d5db",background:T==="students"?"#6CE1AB":"#ffffff",color:T==="students"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Studenter"}),R.jsx("button",{type:"button",onClick:()=>b("teachers"),style:{flex:1,padding:"0.35rem 0.5rem",border:T==="teachers"?"1px solid #6CE1AB":"1px solid #d1d5db",background:T==="teachers"?"#6CE1AB":"#ffffff",color:T==="teachers"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Lrere"}),R.jsx("button",{type:"button",onClick:()=>b("admins"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:T==="admins"?"1px solid #6CE1AB":"1px solid #d1d5db",background:T==="admins"?"#6CE1AB":"#ffffff",color:T==="admins"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Admin"})]}),R.jsx("input",{type:"text",placeholder:"Sk p navn, e-post eller mobil...",value:g,onChange:W=>x(W.target.value),style:{width:"100%",padding:"0.4rem 0.6rem",marginBottom:"0.75rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.9rem"}}),o?R.jsx(Ro,{}):R.jsxs(R.Fragment,{children:[T==="teachers"&&R.jsxs("div",{style:{marginBottom:"1.2rem"},children:[R.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[R.jsx("div",{style:{fontSize:"0.8rem"},children:R.jsx("label",{children:R.jsxs("select",{value:w==="all"?"":w,onChange:W=>{const Te=W.target.value;C(Te===""?"all":parseInt(Te,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[R.jsx("option",{value:"",children:"Alle terminer"}),We.map(W=>R.jsx("option",{value:W.value,children:W.label},W.value))]})})}),R.jsx("button",{type:"button",onClick:Oe,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),R.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[R.jsx("thead",{children:R.jsxs("tr",{children:[R.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Gt("name"),children:["Navn"," ",N==="name"&&(B==="asc"?"":"")]}),R.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Gt("email"),children:["E-post"," ",N==="email"&&(B==="asc"?"":"")]}),R.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Gt("phone"),children:["Mobil"," ",N==="phone"&&(B==="asc"?"":"")]})]})}),R.jsx("tbody",{children:Xe.length===0?R.jsx("tr",{children:R.jsx("td",{colSpan:3,style:{padding:"0.4rem",fontSize:"0.85rem",color:"#6b7280"},children:"Ingen lrere funnet."})}):Xe.map(W=>R.jsxs("tr",{onClick:()=>yt(W),style:{cursor:"pointer"},children:[R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.displayName}),R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.email}),R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.phone??""})]},W.docId))})]})]}),T==="students"&&R.jsxs("div",{style:{marginBottom:"1.2rem"},children:[R.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[R.jsx("div",{style:{fontSize:"0.8rem"},children:R.jsx("label",{children:R.jsxs("select",{value:ne==="all"?"":ne,onChange:W=>{const Te=W.target.value;ae(Te===""?"all":parseInt(Te,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[R.jsx("option",{value:"",children:"Alle terminer"}),We.map(W=>R.jsx("option",{value:W.value,children:W.label},W.value))]})})}),R.jsx("button",{type:"button",onClick:Ps,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),st.length===0?R.jsx("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:"Ingen studenter funnet."}):R.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[R.jsx("thead",{children:R.jsxs("tr",{children:[R.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Rt("name"),children:["Navn"," ",tt==="name"&&(fe==="asc"?"":"")]}),R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem"},children:"Termin"}),R.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem"},children:"Godkjent?"})]})}),R.jsx("tbody",{children:st.map(W=>R.jsxs("tr",{onClick:()=>za(W),style:{cursor:"pointer"},children:[R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.displayName}),R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.term!=null&&W.term!==void 0?fE(G,W.term):"Ingen"}),R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},onMouseEnter:Te=>{tn(W.docId,W.term??null)},children:W.term==null?"":R.jsx(Fe,{uid:W.docId,term:W.term})})]},W.docId))})]})]}),T==="admins"&&R.jsxs("div",{style:{marginBottom:"1.2rem"},children:[R.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.4rem"},children:[R.jsx("div",{style:{fontSize:"0.8rem"},children:R.jsx("label",{children:R.jsxs("select",{value:gt==="all"?"":gt,onChange:W=>{const Te=W.target.value;Qe(Te===""?"all":parseInt(Te,10))},style:{padding:"0.2rem 0.4rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.8rem"},children:[R.jsx("option",{value:"",children:"Alle terminer"}),G.map(W=>R.jsx("option",{value:W.value,children:W.label},W.value))]})})}),R.jsx("button",{type:"button",onClick:Qn,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til"})]}),pt.length===0?R.jsx("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:"Ingen administratorer funnet."}):R.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[R.jsx("thead",{children:R.jsxs("tr",{children:[R.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Ut("name"),children:["Navn"," ",F==="name"&&(U==="asc"?"":"")]}),R.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Ut("email"),children:["E-post"," ",F==="email"&&(U==="asc"?"":"")]}),R.jsxs("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:"0.25rem",cursor:"pointer"},onClick:()=>Ut("phone"),children:["Mobil"," ",F==="phone"&&(U==="asc"?"":"")]})]})}),R.jsx("tbody",{children:pt.map(W=>R.jsxs("tr",{onClick:()=>Jr(W),style:{cursor:"pointer"},children:[R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.displayName}),R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.email}),R.jsx("td",{style:{padding:"0.25rem",borderBottom:"1px solid #f3f4f6"},children:W.phone??""})]},W.docId))})]})]})]}),ut&&R.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:R.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[R.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:ut==="create"?"Ny lrer":"Rediger lrer"}),R.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:ut==="create"?"Opprett ny lrer, velg hvilke terminer de kan registrere for og lagre.":"Endre navn, e-post, mobil, rolle og hvilke terminer lreren kan undervise p."}),R.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",R.jsx("input",{type:"text",value:Ce,onChange:W=>Le(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),R.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",R.jsx("input",{type:"email",value:me,onChange:W=>rt(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",R.jsx("input",{type:"tel",value:mt,onChange:W=>Ct(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),ut==="edit"&&R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",R.jsxs("select",{value:sn,onChange:W=>Qt(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[R.jsx("option",{value:"teacher",children:"Lrer"}),R.jsx("option",{value:"student",children:"Student"}),R.jsx("option",{value:"admin",children:"Admin"})]})]}),R.jsxs("div",{style:{fontSize:"0.8rem"},children:[R.jsx("div",{style:{marginBottom:"0.25rem"},children:"Termin(er) lreren kan registrere for:"}),R.jsx("div",{style:{maxHeight:"150px",overflowY:"auto",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"0.35rem 0.45rem"},children:(We.length===0?[]:We).map(W=>R.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.35rem",fontSize:"0.8rem",padding:"0.15rem 0"},children:[R.jsx("input",{type:"checkbox",checked:En.includes(W.value),onChange:()=>fi(W.value)}),R.jsx("span",{children:W.label})]},W.value))})]})]}),R.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:er,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),R.jsx("button",{className:"button button-green",type:"button",onClick:ut==="create"?an:Mt,children:ut==="create"?"Opprett lrer":"Lagre"})]})]})}),gn&&R.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:R.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[R.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:gn==="create"?"Ny student":"Rediger student"}),R.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:gn==="create"?"Opprett ny student og velg termin.":"Endre navn, e-post, mobil, rolle og termin."}),R.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",R.jsx("input",{type:"text",value:Ne,onChange:W=>Ve(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),R.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",R.jsx("input",{type:"email",value:it,onChange:W=>Ie(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",R.jsx("input",{type:"tel",value:Pt,onChange:W=>et(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),gn==="edit"&&R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",R.jsxs("select",{value:ht,onChange:W=>Un(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[R.jsx("option",{value:"student",children:"Student"}),R.jsx("option",{value:"teacher",children:"Lrer"}),R.jsx("option",{value:"admin",children:"Admin"})]})]}),R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Termin",R.jsxs("select",{value:Bt??"",onChange:W=>{const Te=W.target.value;Kn(Te===""?null:parseInt(Te,10))},style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[R.jsx("option",{value:"",children:"Ingen"}),(We.length===0?[]:We).map(W=>R.jsx("option",{value:W.value,children:W.label},W.value))]})]})]}),R.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:Yr,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),R.jsx("button",{type:"button",onClick:gn==="create"?ri:Li,style:{padding:"0.3rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:gn==="create"?"Opprett student":"Lagre"})]})]})}),Ht&&R.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:R.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[R.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem"},children:Ht==="create"?"Ny admin":"Rediger admin"}),R.jsx("p",{style:{marginTop:0,marginBottom:"0.9rem",fontSize:"0.8rem",color:"#6b7280"},children:Ht==="create"?"Opprett ny admin.":"Endre navn, e-post, mobil og rolle."}),R.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Navn",R.jsx("input",{type:"text",value:Xr,onChange:W=>Tr(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),R.jsxs("label",{style:{fontSize:"0.8rem"},children:["E-post",R.jsx("input",{type:"email",value:Vt,onChange:W=>Zt(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Mobil",R.jsx("input",{type:"tel",value:jn,onChange:W=>Mr(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"}})]}),Ht==="edit"&&R.jsxs("label",{style:{fontSize:"0.8rem"},children:["Rolle",R.jsxs("select",{value:dt,onChange:W=>nn(W.target.value),style:{width:"100%",padding:"0.3rem 0.45rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem",marginTop:"0.15rem"},children:[R.jsx("option",{value:"admin",children:"Admin"}),R.jsx("option",{value:"teacher",children:"Lrer"}),R.jsx("option",{value:"student",children:"Student"})]})]}),R.jsxs("div",{style:{fontSize:"0.8rem"},children:[R.jsx("div",{style:{marginBottom:"0.25rem"},children:"Termin(er) admin kan administrere:"}),R.jsx("div",{style:{maxHeight:"150px",overflowY:"auto",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"0.35rem 0.45rem"},children:We.length===0?R.jsx("div",{style:{color:"#6b7280"},children:"Ingen terminer tilgjengelig"}):We.map(W=>R.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.35rem",fontSize:"0.8rem",padding:"0.15rem 0"},children:[R.jsx("input",{type:"checkbox",checked:re.includes(W.value),onChange:()=>Be(W.value)}),R.jsx("span",{children:W.label})]},W.value))})]})]}),R.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:ar,style:{padding:"0.3rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",backgroundColor:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:"Avbryt"}),R.jsx("button",{type:"button",onClick:Ht==="create"?un:kr,style:{padding:"0.3rem 0.9rem",borderRadius:"999px",border:"none",backgroundColor:"#16a34a",color:"#ffffff",fontSize:"0.85rem",cursor:"pointer"},children:Ht==="create"?"Opprett admin":"Lagre"})]})]})})]})},BR=()=>{const[s,e]=he.useState([]),[n,o]=he.useState(""),[h,g]=he.useState([]),[x,T]=he.useState(!0),[b,w]=he.useState(""),[C,N]=he.useState({}),[P,B]=he.useState(null),[ee,ne]=he.useState(""),[ae,tt]=he.useState(""),[ze,fe]=he.useState(null),[Ge,gt]=he.useState(0),[Qe,F]=he.useState({}),[z,U]=he.useState([]),[J,X]=he.useState(!1),[Y,G]=he.useState(""),ot=he.useRef(null),[oe,le]=he.useState(!1),[xe,We]=he.useState([]),[qe,ut]=he.useState(!1),[K,se]=he.useState([]),{user:ve}=bc(),[Ce,Le]=he.useState(null),[me,rt]=he.useState(null);he.useEffect(()=>{(async()=>{try{if(!ve?.uid)return;const Se=Tn(Et,"users",ve.uid),je=await Ua(Se),Xe=je.exists()?je.data():null,pt=(Array.isArray(Xe?.allowedTerms)?Xe.allowedTerms:[]).map(at=>typeof at=="number"?at:parseInt(String(at),10)).filter(at=>!Number.isNaN(at));Le(pt),rt(!!Xe?.isSuperAdmin)}catch(Se){console.warn("Kunne ikke hente allowedTerms for innlogget admin (TermSetup):",Se),Le([]),rt(!1)}})()},[ve?.uid]);const mt=he.useMemo(()=>me?!1:Array.isArray(Ce)&&Ce.length>0,[me,Ce]),Ct=he.useMemo(()=>mt?new Set(Ce):null,[mt,Ce]);he.useEffect(()=>{me||mt&&(!Ce||Ce.length!==1||n===""&&o(Ce[0]))},[me,mt,Ce,n]),he.useEffect(()=>{mt&&n!==""&&Ct&&!Ct.has(n)&&o("")},[mt,Ct,n]),he.useEffect(()=>{(async()=>{try{T(!0);const[Se,je,Xe,st]=await Promise.all([gr(Wn(Et,"requirements")),gr(Wn(Et,"times")),gr(Wn(Et,"termLabels")).catch(()=>null),gr(Wn(Et,"terms")).catch(()=>null)]),pt=Se.docs.map(Gt=>{const Rt=Gt.data();return{id:Gt.id,term:Rt.term,category:Rt.category,requiredCount:Rt.requiredCount??0,order:typeof Rt?.order=="number"?Rt.order:void 0}}),at=je.docs.map(Gt=>{const Rt=Gt.data();return{id:Gt.id,name:Rt.name,category:Rt.category,term:Rt.term}});if(e(pt),g(at),st){const Gt=st.docs.map(Rt=>{const Ut=Rt.data(),Oe=typeof Ut?.value=="number"?Ut.value:void 0,an=typeof Ut?.label=="string"?Ut.label:"",yt=typeof Ut?.order=="number"?Ut.order:void 0;return typeof Oe!="number"?null:{docId:Rt.id,value:Oe,label:an,order:yt}}).filter(Boolean);Gt.sort((Rt,Ut)=>{const Oe=Rt.order??Rt.value,an=Ut.order??Ut.value;return Oe-an}),U(Gt)}if(Xe){const Gt={};Xe.docs.forEach(Rt=>{const Ut=Rt.data(),Oe=parseInt(Rt.id,10);!Number.isNaN(Oe)&&typeof Ut?.label=="string"&&Ut.label.trim()&&(Gt[Oe]=Ut.label.trim())}),F(Gt)}}catch(Se){console.error("Feil ved lasting av termin-oppsett:",Se)}finally{T(!1)}})()},[]);const sn=s.filter(re=>re.term===n).sort((re,Se)=>{const je=re.order??Number.MAX_SAFE_INTEGER,Xe=Se.order??Number.MAX_SAFE_INTEGER;return je!==Xe?je-Xe:re.category.localeCompare(Se.category,"nb-NO",{sensitivity:"base"})}),Qt=he.useMemo(()=>{const re=z.slice().sort((Se,je)=>(Se.order??Se.value)-(je.order??je.value)).map(Se=>({value:Se.value,label:Se.label||`Termin ${Se.value}`}));return Object.keys(Qe).length>0?re.map(Se=>({...Se,label:Qe[Se.value]??Se.label})):re},[z,Qe]),En=re=>yl(Qt,re??null),Ot=()=>{if(n==="")return;const re=En(n);G(re),X(!0),setTimeout(()=>ot.current?.focus(),0)},gn=()=>{X(!1),G("")},On=async()=>{if(n==="")return;const re=En(n),Se=Y.trim();if(!Se||Se===re){X(!1);return}try{const je=z.find(Xe=>Xe.value===Number(n));if(je)await bi(Tn(Et,"terms",je.docId),{label:Se,updatedAt:Ed()}),U(Xe=>Xe.map(st=>st.docId===je.docId?{...st,label:Se}:st));else{const Xe=String(n);await ul(Tn(Et,"termLabels",Xe),{label:Se,updatedAt:Ed(),value:Number(n)},{merge:!0}),F(st=>({...st,[Number(n)]:Se}))}X(!1)}catch(je){console.error("Feil ved endring av modulnavn:",je),alert("Kunne ikke endre navn p modulen.")}},Me=async()=>{try{const re=z.map(Rt=>Rt.value),Se=z.map(Rt=>Rt.order??Rt.value),je=re.length>0?Math.max(...re):0,Xe=Se.length>0?Math.max(...Se):0,st=je+1,pt=Xe+1,Gt={docId:(await xd(Wn(Et,"terms"),{value:st,label:"",order:pt,createdAt:Ed()})).id,value:st,label:"",order:pt};U(Rt=>[...Rt,Gt]),o(st),G(""),X(!0),setTimeout(()=>ot.current?.focus(),0)}catch(re){console.error("Kunne ikke opprette ny oppmtebok:",re),alert("Kunne ikke opprette ny oppmtebok.")}},ge=()=>{if(z.length===0)return;const re=z.slice().sort((Se,je)=>(Se.order??Se.value)-(je.order??je.value));We(re),le(!0)},Ne=(re,Se)=>{We(je=>{const Xe=je.slice(),st=re+Se;if(st<0||st>=Xe.length)return je;const[pt]=Xe.splice(re,1);return Xe.splice(st,0,pt),Xe})},Ve=async()=>{try{const re=au(Et);xe.forEach((Se,je)=>{re.update(Tn(Et,"terms",Se.docId),{order:je+1})}),await re.commit(),U(xe.map((Se,je)=>({...Se,order:je+1}))),le(!1)}catch(re){console.error("Kunne ikke lagre sortering av terminer:",re),alert("Kunne ikke lagre sortering av terminer.")}},it=()=>{if(n==="")return;const re=s.filter(Se=>Se.term===n).slice().sort((Se,je)=>{const Xe=Se.order??Number.MAX_SAFE_INTEGER,st=je.order??Number.MAX_SAFE_INTEGER;return Xe!==st?Xe-st:Se.category.localeCompare(je.category,"nb-NO",{sensitivity:"base"})});se(re),ut(!0)},Ie=(re,Se)=>{se(je=>{const Xe=je.slice(),st=re+Se;if(st<0||st>=Xe.length)return je;const[pt]=Xe.splice(re,1);return Xe.splice(st,0,pt),Xe})},Pt=async()=>{try{const re=au(Et);K.forEach((Se,je)=>{re.update(Tn(Et,"requirements",Se.id),{order:je+1})}),await re.commit(),e(Se=>{const je={};return K.forEach((Xe,st)=>je[Xe.id]=st+1),Se.map(Xe=>je[Xe.id]?{...Xe,order:je[Xe.id]}:Xe)}),ut(!1)}catch(re){console.error("Kunne ikke lagre sortering av grupper:",re),alert("Kunne ikke lagre sortering av grupper.")}},[et,ht]=he.useState({open:!1,termValue:null,termLabel:"",reqCount:0,timeCount:0}),Un=()=>{if(n==="")return;const re=n,Se=En(re),je=s.filter(st=>st.term===re).length,Xe=h.filter(st=>st.term===re).length;ht({open:!0,termValue:re,termLabel:Se,reqCount:je,timeCount:Xe})},Bt=()=>{ht({open:!1,termValue:null,termLabel:"",reqCount:0,timeCount:0})},Kn=async(re,Se)=>{try{const je=z.find(Oe=>Oe.value===re);let Xe=je?Tn(Et,"terms",je.docId):null;const st=ui(Wn(Et,"requirements"),Ar("term","==",re)),pt=ui(Wn(Et,"times"),Ar("term","==",re)),[at,Gt]=await Promise.all([gr(st),gr(pt)]);if(!Xe)try{const Oe=ui(Wn(Et,"terms"),Ar("value","==",re));Xe=(await gr(Oe)).docs[0]?.ref??null}catch{}const Rt=[...at.docs.map(Oe=>Oe.ref),...Gt.docs.map(Oe=>Oe.ref)];Xe&&Rt.push(Xe);const Ut=450;for(let Oe=0;Oe<Rt.length;Oe+=Ut){const an=au(Et);Rt.slice(Oe,Oe+Ut).forEach(yt=>an.delete(yt)),await an.commit()}e(Oe=>Oe.filter(an=>an.term!==re)),g(Oe=>Oe.filter(an=>an.term!==re)),U(Oe=>Oe.filter(an=>an.value!==re)),o(""),X(!1),w(""),fe(null),B(null),ne(""),It.success("Termin slettet",{description:`${Se} er fjernet med alle grupper og timer.`})}catch(je){console.error("Kunne ikke slette termin med relaterte data:",je),It.error("Kunne ikke slette termin. Prv igjen senere.")}finally{Bt()}},lr=async()=>{!et.open||et.termValue==null||await Kn(et.termValue,et.termLabel)},cr=async re=>{const Se=ee.trim();if(!Se||Se===re.name){B(null),ne("");return}try{await bi(Tn(Et,"times",re.id),{name:Se}),g(je=>je.map(Xe=>Xe.id===re.id?{...Xe,name:Se}:Xe)),B(null),ne("")}catch(je){console.error("Feil ved endring av timenavn:",je),alert("Kunne ikke oppdatere navn p timen.")}},Zr=h.filter(re=>re.term===n),Ti=re=>{fe(re.id),tt(re.category),gt(re.requiredCount??0)},ki=()=>{fe(null)},tn=async re=>{if(!ze)return;const Se=re.category,je=(ae||"").trim()||Se,Xe=h.filter(at=>at.term===re.term&&at.category===Se).length;let st=Ge;if((Number.isNaN(st)||st<0)&&(st=0),Xe>0&&st>Xe&&(st=Xe),sn.find(at=>at.id!==re.id&&at.category.toLowerCase()===je.toLowerCase())){alert("Det finnes allerede en gruppe med dette navnet i valgt termin.");return}try{const at=au(Et),Gt=Tn(Et,"requirements",re.id);at.update(Gt,{category:je,requiredCount:st});const Rt=ui(Wn(Et,"times"),Ar("term","==",re.term),Ar("category","==",Se));(await gr(Rt)).forEach(yt=>{at.update(yt.ref,{category:je})});const Oe=ui(Wn(Et,"sessions"),Ar("term","==",re.term),Ar("category","==",Se));(await gr(Oe)).forEach(yt=>{at.update(yt.ref,{category:je})}),await at.commit(),e(yt=>yt.map(Mt=>Mt.id===re.id?{...Mt,category:je,requiredCount:st}:Mt)),g(yt=>yt.map(Mt=>Mt.term===re.term&&Mt.category===Se?{...Mt,category:je}:Mt)),fe(null)}catch(at){console.error("Feil ved lagring av gruppe:",at),alert("Kunne ikke lagre endringene for gruppen.")}},Fe=async()=>{const re=b.trim();if(!re)return;if(sn.some(je=>je.category.toLowerCase()===re.toLowerCase())){alert("Denne gruppen finnes allerede for valgt termin.");return}try{const je=s.filter(at=>at.term===n),st=(je.length?Math.max(...je.map(at=>typeof at.order=="number"?at.order:0)):0)+1,pt=await xd(Wn(Et,"requirements"),{term:n,category:re,requiredCount:0,order:st});e(at=>[...at,{id:pt.id,term:n,category:re,requiredCount:0,order:st}]),w("")}catch(je){console.error("Feil ved oppretting av kategori:",je),alert("Kunne ikke opprette kategori.")}},[Ht,At]=he.useState({open:!1,req:null,timeCount:0}),wn=async(re,Se)=>{const{id:je,term:Xe,category:st}=re;try{const pt=ui(Wn(Et,"times"),Ar("term","==",Xe),Ar("category","==",st)),at=await gr(pt),Gt=[Tn(Et,"requirements",je),...at.docs.map(Ut=>Ut.ref)],Rt=450;for(let Ut=0;Ut<Gt.length;Ut+=Rt){const Oe=au(Et);Gt.slice(Ut,Ut+Rt).forEach(an=>Oe.delete(an)),await Oe.commit()}e(Ut=>Ut.filter(Oe=>Oe.id!==je)),g(Ut=>Ut.filter(Oe=>!(Oe.term===Xe&&Oe.category===st)))}catch(pt){console.error("Feil ved sletting av gruppe og tilhrende timer:",pt),It.error("Kunne ikke slette gruppen. Prv igjen senere.")}finally{Xr()}},vr=re=>{const Se=h.filter(je=>je.term===re.term&&je.category===re.category).length;if(Se===0){wn(re);return}At({open:!0,req:re,timeCount:Se})},Xr=()=>{At({open:!1,req:null,timeCount:0})},Tr=async()=>{Ht.req&&await wn(Ht.req,Ht.timeCount)},Vt=async re=>{const Se=re.id,je=(C[Se]??"").trim();if(je)try{const Xe=await xd(Wn(Et,"times"),{term:n,category:re.category,name:je});g(st=>[...st,{id:Xe.id,term:n,category:re.category,name:je}]),N(st=>({...st,[Se]:""}))}catch(Xe){console.error("Feil ved oppretting av time:",Xe),alert("Kunne ikke opprette time.")}},[Zt,jn]=he.useState({open:!1,time:null}),Mr=re=>{jn({open:!0,time:re})},dt=()=>{jn({open:!1,time:null})},nn=async()=>{if(!Zt.time)return;const re=Zt.time;try{await q_(Tn(Et,"times",re.id)),g(Se=>Se.filter(je=>je.id!==re.id))}catch(Se){console.error("Feil ved sletting av time:",Se),It.error("Kunne ikke slette time. Prv igjen senere.")}finally{dt()}};return x?R.jsx(Ro,{}):R.jsxs(R.Fragment,{children:[R.jsxs("section",{style:{marginBottom:"2rem"},children:[R.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"0.75rem"},children:[R.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[J&&me?R.jsx("input",{ref:ot,type:"text",value:Y,onChange:re=>G(re.target.value),onKeyDown:re=>{re.key==="Enter"?(re.preventDefault(),On()):re.key==="Escape"&&(re.preventDefault(),gn())},placeholder:"Navn p modul",style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}}):R.jsxs("select",{value:n,onChange:re=>{const Se=re.target.value;if(Se==="__new__"){if(mt)return;Me();return}o(Se===""?"":parseInt(Se,10))},style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",width:me?void 0:"100%"},children:[R.jsx("option",{value:"",disabled:!0,children:"Velg termin"}),(mt?Qt.filter(re=>Ct?.has(re.value)):Qt).map(re=>R.jsx("option",{value:re.value,children:re.label},re.value)),!mt&&R.jsx("option",{value:"__new__",children:"+ Ny oppmtebok"})]}),me&&R.jsx("button",{className:"button-green",type:"button",disabled:n===""&&!J,onClick:()=>{J?On():Ot()},style:{width:"160px",padding:"0.45rem 0.9rem",cursor:n===""&&!J?"not-allowed":"pointer",whiteSpace:"nowrap"},children:J?"Lagre":"Endre navn"}),me&&R.jsx("button",{type:"button",title:"Sorter oppmtebker",disabled:z.length===0,onClick:ge,style:{padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",background:"#ffffff",fontSize:"0.9rem",cursor:z.length===0?"not-allowed":"pointer"},children:""})]}),R.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",alignItems:"center"},children:(()=>{const re=n===""?null:Number(n),Se=re!=null?z.find(at=>at.value===re):void 0,je=!!Se?.label&&Se.label.trim().length>0,Xe=re!=null?Qe[re]:void 0,st=!!Xe&&Xe.trim().length>0,pt=re!=null&&(je||st);return R.jsxs(R.Fragment,{children:[R.jsx("input",{type:"text",placeholder:"Ny gruppe...",value:b,onChange:at=>w(at.target.value),onKeyDown:at=>{at.key==="Enter"&&pt&&(at.preventDefault(),Fe())},disabled:!pt,style:{flex:1,minWidth:0,padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",opacity:pt?1:.6,cursor:pt?"text":"not-allowed"}}),R.jsx("button",{className:"button-green",type:"button",onClick:Fe,disabled:!pt,style:{width:"160px",padding:"0.45rem 0.9rem",cursor:pt?"pointer":"not-allowed",whiteSpace:"nowrap",opacity:pt?1:.7},children:"Legg til gruppe"}),R.jsx("button",{type:"button",title:"Sorter grupper",disabled:!pt||sn.length===0,onClick:it,style:{padding:"0.35rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",background:"#ffffff",fontSize:"0.9rem",cursor:!pt||sn.length===0?"not-allowed":"pointer",opacity:!pt||sn.length===0?.7:1},children:""})]})})()})]}),(()=>{const re=n===""?null:Number(n),Se=re!=null?z.find(at=>at.value===re):void 0,je=!!Se?.label&&Se.label.trim().length>0,Xe=re!=null?Qe[re]:void 0,st=!!Xe&&Xe.trim().length>0;return re!=null&&(je||st)?sn.length===0?R.jsxs("p",{style:{fontSize:"0.85rem",color:"#6b7280"},children:["Ingen grupper definert enn for ",En(n),"."]}):R.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:sn.map(at=>{const Gt=at.id,Rt=Zr.filter(yt=>yt.category===at.category).sort((yt,Mt)=>{const er=_E(yt.name),fi=_E(Mt.name);return er!==fi?er-fi:yt.name.localeCompare(Mt.name,"nb-NO",{sensitivity:"base"})}),Ut=C[Gt]??"",Oe=Zr.filter(yt=>yt.category===at.category).length,an=ze===at.id;return R.jsxs("div",{style:{borderRadius:"0.75rem",border:"1px solid #e5e7eb",padding:"0.75rem 0.75rem",backgroundColor:"#f9fafb"},children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem",gap:"0.5rem",flexWrap:"wrap"},children:[R.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:an?R.jsxs(R.Fragment,{children:[R.jsx("input",{type:"text",value:ae,onChange:yt=>tt(yt.target.value),onKeyDown:yt=>{yt.key==="Enter"?tn(at):yt.key==="Escape"&&ki()},autoFocus:!0,style:{minWidth:"12rem",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.9rem"}}),R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[R.jsx("input",{type:"number",min:0,max:Oe,value:Ge,onChange:yt=>{const Mt=parseInt(yt.target.value,10);gt(Number.isNaN(Mt)?0:Mt)},onKeyDown:yt=>{yt.key==="Enter"?tn(at):yt.key==="Escape"&&ki()},style:{width:"4rem",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.9rem",textAlign:"center"}}),R.jsxs("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:["/ ",Oe]})]})]}):R.jsxs("div",{style:{fontWeight:600,fontSize:"0.95rem"},children:[at.category," (",at.requiredCount,"/",Oe,")"]})}),R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:()=>an?void tn(at):Ti(at),style:{padding:"0.25rem 0.6rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:an?"Lagre":"Endre gruppe"}),R.jsx("button",{type:"button",onClick:()=>vr({id:at.id,term:at.term,category:at.category}),style:{padding:"0.25rem 0.6rem",borderRadius:"999px",border:"none",backgroundColor:"#fee2e2",color:"#991b1b",fontSize:"0.75rem",cursor:"pointer"},children:"Slett gruppe"})]})]}),Rt.length>0?R.jsx("ul",{style:{listStyle:"none",paddingLeft:0,margin:"0 0 0.5rem 0",fontSize:"0.85rem"},children:Rt.map(yt=>{const Mt=P===yt.id;return R.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.15rem 0",borderBottom:"1px dashed #e5e7eb",gap:"0.5rem"},children:[R.jsx("div",{style:{flex:1},children:Mt?R.jsx("input",{type:"text",value:ee,onChange:er=>ne(er.target.value),onKeyDown:er=>{er.key==="Enter"?cr(yt):er.key==="Escape"&&(B(null),ne(""))},autoFocus:!0,style:{width:"100%",padding:"0.2rem 0.35rem",borderRadius:"0.4rem",border:"1px solid #d1d5db",fontSize:"0.85rem"}}):R.jsx("span",{children:yt.name})}),R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[Mt?R.jsx("button",{type:"button",onClick:()=>void cr(yt),style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:"Lagre"}):R.jsx("button",{type:"button",onClick:()=>{B(yt.id),ne(yt.name)},style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#e5e7eb",color:"#111827",fontSize:"0.75rem",cursor:"pointer"},children:"Endre"}),R.jsx("button",{type:"button",onClick:()=>Mr(yt),style:{padding:"0.15rem 0.45rem",borderRadius:"999px",border:"none",backgroundColor:"#fee2e2",color:"#b91c1c",fontSize:"0.75rem",cursor:"pointer"},children:"Slett"})]})]},yt.id)})}):R.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.8rem",color:"#9ca3af"},children:"Ingen timer lagt til i denne gruppen."}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"},children:[R.jsx("input",{type:"text",placeholder:"Ny time...",value:Ut,onChange:yt=>N(Mt=>({...Mt,[Gt]:yt.target.value})),onKeyDown:yt=>{yt.key==="Enter"&&(yt.preventDefault(),Vt(at))},style:{flex:1,padding:"0.3rem 0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.85rem"}}),R.jsx("button",{type:"button",onClick:()=>Vt(at),style:{padding:"0.35rem 0.8rem",borderRadius:"999px",border:"none",backgroundColor:"#4b5563",color:"#ffffff",fontSize:"0.8rem",cursor:"pointer"},children:"Legg til time"})]})]},at.id)})}):null})(),n!==""&&me&&R.jsx("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center"},children:R.jsx("button",{className:"btn-hover-danger",type:"button",onClick:Un,style:{backgroundColor:"#ef4444",borderColor:"#ef4444",color:"black",fontSize:"0.9rem"},children:"Slett termin"})}),et.open&&et.termValue!=null&&R.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:R.jsxs("div",{className:"page-card",style:{textAlign:"center",maxWidth:520,width:"100%",background:"#ffffff"},children:[R.jsx("h3",{style:{marginTop:0},children:"Slett termin?"}),R.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:[`Du er i ferd med  slette oppmteboka for ${et.termLabel}.

`,`Dette vil slette selve terminen, alle grupper (${et.reqCount} stk) og alle timer (${et.timeCount} stk) som tilhrer denne terminen.
`]}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",marginTop:"0.75rem"},children:[R.jsx("button",{className:"btn-hover-danger",type:"button",onClick:Bt,style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",background:"#ef4444",color:"black",cursor:"pointer"},children:"Avbryt"}),R.jsx("button",{className:"btn-hover-lg",type:"button",onClick:()=>void lr(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Slett termin"})]})]})}),Ht.open&&Ht.req&&R.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:R.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff"},children:[R.jsx("h3",{style:{marginTop:0},children:"Slett gruppe?"}),R.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:[`Du er i ferd med  slette gruppen ${Ht.req.category}.

`,`Dette vil ogs slette alle tilhrende timer i denne gruppen for valgt termin (${Ht.timeCount}).
`,"Handlingen kan ikke angres."]}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"0.75rem"},children:[R.jsx("button",{type:"button",onClick:Xr,style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Avbryt"}),R.jsx("button",{type:"button",onClick:()=>void Tr(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",background:"#ef4444",color:"#ffffff",cursor:"pointer"},children:"Slett gruppe"})]})]})}),Zt.open&&Zt.time&&R.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:R.jsxs("div",{className:"page-card",style:{maxWidth:520,width:"100%",background:"#ffffff"},children:[R.jsx("h3",{style:{marginTop:0},children:"Slett time?"}),R.jsxs("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.4},children:[`Du er i ferd med  slette timen ${Zt.time.name} i gruppen ${Zt.time.category} for ${En(Zt.time.term)}.

`,`Historiske sesjoner beholdes, men timen forsvinner fra admin-oppsettet.
`,"Handlingen kan ikke angres."]}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",marginTop:"0.75rem"},children:[R.jsx("button",{type:"button",onClick:dt,style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer"},children:"Avbryt"}),R.jsx("button",{type:"button",onClick:()=>void nn(),style:{padding:"0.45rem 0.9rem",borderRadius:"999px",border:"none",background:"#ef4444",color:"#ffffff",cursor:"pointer"},children:"Slett time"})]})]})})]}),oe&&R.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:R.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[R.jsx("h3",{style:{marginTop:0},children:"Sorter oppmtebker"}),R.jsx("ul",{style:{listStyle:"none",padding:0,margin:"0 0 0.75rem"},children:xe.map((re,Se)=>R.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.4rem 0.6rem",marginBottom:"0.4rem"},children:[R.jsx("span",{style:{fontSize:"0.9rem"},children:re.label||`Termin ${re.value}`}),R.jsxs("span",{style:{display:"flex",gap:"0.25rem"},children:[R.jsx("button",{type:"button",onClick:()=>Ne(Se,-1),disabled:Se===0,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""}),R.jsx("button",{type:"button",onClick:()=>Ne(Se,1),disabled:Se===xe.length-1,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""})]})]},re.docId))}),R.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:()=>le(!1),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff"},children:"Avbryt"}),R.jsx("button",{type:"button",onClick:()=>void Ve(),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"none",background:"#16a34a",color:"#fff"},children:"Lagre rekkeflge"})]})]})}),qe&&R.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(15,23,42,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:R.jsxs("div",{style:{width:"100%",maxWidth:"420px",backgroundColor:"#ffffff",borderRadius:"1rem",padding:"1rem 1.25rem",boxShadow:"0 20px 40px rgba(15,23,42,0.25)"},children:[R.jsx("h3",{style:{marginTop:0},children:"Sorter grupper"}),R.jsx("ul",{style:{listStyle:"none",padding:0,margin:"0 0 0.75rem"},children:K.map((re,Se)=>R.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.4rem 0.6rem",marginBottom:"0.4rem"},children:[R.jsx("span",{style:{fontSize:"0.9rem"},children:re.category}),R.jsxs("span",{style:{display:"flex",gap:"0.25rem"},children:[R.jsx("button",{type:"button",onClick:()=>Ie(Se,-1),disabled:Se===0,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""}),R.jsx("button",{type:"button",onClick:()=>Ie(Se,1),disabled:Se===K.length-1,style:{padding:"0.2rem 0.4rem",borderRadius:"0.35rem",border:"1px solid #d1d5db",background:"#fff"},children:""})]})]},re.id))}),R.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:()=>ut(!1),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#fff"},children:"Avbryt"}),R.jsx("button",{type:"button",onClick:()=>void Pt(),style:{padding:"0.35rem 0.7rem",borderRadius:"999px",border:"none",background:"#16a34a",color:"#fff"},children:"Lagre rekkeflge"})]})]})})]})},VR=()=>{const{user:s,loading:e,logout:n}=bc(),[o,h]=he.useState("setup"),[g,x]=he.useState(!1);return e?R.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:R.jsx(Ro,{})}):!s||s.role!=="admin"?R.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"1.5rem"},children:R.jsxs("div",{className:"page-card page-card--admin",children:[R.jsx("h2",{children:"Ingen tilgang"}),R.jsx("p",{children:"Du m vre logget inn som administrator for  se denne siden."})]})}):R.jsxs(R.Fragment,{children:[R.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"flex-start",justifyContent:"center",padding:"1.5rem 1rem"},children:R.jsxs("div",{className:"page-card page-card--admin",children:[R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[R.jsx("div",{style:{fontWeight:600},children:s.displayName||s.email}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:()=>x(!0),style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Min profil"}),R.jsx("button",{type:"button",onClick:n,style:{padding:"0.35rem 0.9rem",borderRadius:"999px",border:"1px solid #d1d5db",background:"#ffffff",cursor:"pointer",fontSize:"0.85rem"},children:"Logg ut"})]})]}),R.jsxs("header",{style:{marginBottom:"1rem",borderBottom:"1px solid #e5e7eb",paddingBottom:"0.75rem"},children:[R.jsx("h2",{style:{margin:0},children:"Adminpanel"}),R.jsx("p",{style:{margin:"0.25rem 0 0.75rem",fontSize:"0.85rem",color:"#6b7280"},children:"Oppsett av oppmtebker og administrasjon av brukere."}),R.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[R.jsx("button",{type:"button",onClick:()=>h("setup"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #e5e7eb",background:o==="setup"?"#6CE1AB":"#ffffff",color:o==="setup"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Oppmtebker"}),R.jsx("button",{type:"button",onClick:()=>h("users"),style:{flex:1,padding:"0.35rem 0.5rem",borderRadius:"999px",border:"1px solid #e5e7eb",background:o==="users"?"#6CE1AB":"#ffffff",color:o==="users"?"black":"#111827",fontSize:"0.85rem",cursor:"pointer"},children:"Brukere"})]})]}),o==="setup"&&R.jsx(BR,{}),o==="users"&&R.jsx(PR,{})]})}),g&&R.jsx(lm,{uid:s.uid,role:s.role,email:s.email,displayName:s.displayName,onClose:()=>x(!1)})]})};function UR(s){try{return s.toLocaleDateString("no-NO")}catch{const e=String(s.getDate()).padStart(2,"0"),n=String(s.getMonth()+1).padStart(2,"0"),o=s.getFullYear();return`${e}.${n}.${o}`}}function I1(){const s=UR(new Date);return R.jsx("footer",{role:"contentinfo",children:R.jsxs("div",{className:"footer-row",children:[R.jsxs("div",{className:"footer-left",children:[R.jsxs("p",{className:"thinFont opaqeFont",children:["Sist teknisk oppdatert: ",s,"."]}),R.jsx("h2",{className:"boldFont",children:"Laget med kjrlighet for en effektiv hverdag"}),R.jsxs("p",{className:"smallFont thinFont",children:["Traskende rundt i gangene p sykehus med en en oppmtebok du alltid er redd for  miste eller helle kaffekoppen over s mtte man jo plundre p tanken  gjre det bedre.... ",R.jsx("br",{}),R.jsx("br",{}),"S hvorfor ikke lag en digital oppmtebok du aldri glemmer hjemme, er super raskt for lrerene og sparer fakultet for 2400(!) oppmtebker i ret. Miljvennlig, effektiv og bedre for studentene. Velkommen til oppmteboka! Skapt i de sene nattestimer p vakt eller sovnende p sofaen."]})]}),R.jsxs("div",{className:"text-right footer-credits",children:[R.jsxs("div",{style:{display:"flex",justifyContent:"end",marginTop:"2rem"},children:[R.jsx("img",{className:"footer-logo",src:"public/favicon.svg",alt:"Oppmteboka logo",style:{width:"3rem",height:"3rem",margin:"0",paddingTop:"0.2rem",paddingRight:"0.5rem"}}),R.jsx("h3",{className:"boldFont",style:{textAlign:"left"},children:"Oppmteboka"})]}),R.jsxs("div",{className:"footer-link",children:[R.jsx("a",{href:"mailto:hei@oppmoteboka.no?subject=Tilbakelding",className:"boldFont",children:"Gi tilbakemelding"}),R.jsx("p",{className:"thinFont thinFont smallFont",children:"hei@oppmoteboka.no"})]}),R.jsxs("p",{className:"smallFont",children:["Nettisden er utviklet av ",R.jsx("br",{})," Vetle Mrland og ge Frivoll"]})]})]})})}function FR(){const{user:s,loading:e,login:n}=bc(),[o,h]=he.useState(""),[g,x]=he.useState(""),[T,b]=he.useState(null),[w,C]=he.useState(!1),N=async P=>{if(P.preventDefault(),b(null),!o||!g){b("Fyll inn bde e-post og passord.");return}C(!0);try{await n(o.trim(),g)}catch(B){console.error(B);let ee="Kunne ikke logge inn.";B?.code==="auth/user-not-found"?ee="Bruker finnes ikke.":B?.code==="auth/wrong-password"?ee="Feil passord.":B?.code==="auth/email-already-in-use"?ee="E-postadressen er allerede registrert.":B?.code==="auth/weak-password"&&(ee="Passordet er for svakt (min. 6 tegn)."),b(ee)}finally{C(!1)}};return e?R.jsxs(R.Fragment,{children:[R.jsx("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",padding:"1rem 0.75rem 0",width:"100%"},children:R.jsx("div",{className:"page-card",children:R.jsx(Ro,{})})}),R.jsx(I1,{})]}):s?R.jsxs(R.Fragment,{children:[R.jsx("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",width:"100%",padding:"1rem 0.75rem 0"},children:s.role==="admin"?R.jsx(VR,{user:s}):s.role==="teacher"?R.jsx(mR,{user:s}):R.jsx(sR,{user:s})}),R.jsx(I1,{})]}):R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"front-page",style:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",background:"#CEFFDF",width:"100%",padding:"1rem 0.75rem 0"},children:R.jsxs("div",{className:"page-card",children:[R.jsx("h1",{style:{marginBottom:"2rem",textAlign:"center"},children:"Oppmteregistrering"}),R.jsxs("form",{onSubmit:N,children:[R.jsxs("div",{style:{marginBottom:"0.75rem"},children:[R.jsx("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:"0.2rem"},children:"Mobil / Epost"}),R.jsx("input",{type:"email",value:o,onChange:P=>h(P.target.value),placeholder:"uiobrukernavn@uio.no",style:{width:"100%",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}})]}),R.jsxs("div",{style:{marginBottom:"0.75rem"},children:[R.jsx("label",{style:{display:"block",fontSize:"0.85rem",marginBottom:"0.2rem"},children:"Passord"}),R.jsx("input",{type:"password",value:g,onChange:P=>x(P.target.value),placeholder:"Minst 6 tegn",style:{width:"100%",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid #d1d5db"}})]}),T&&R.jsx("p",{style:{color:"red",fontSize:"0.85rem",marginBottom:"0.75rem"},children:T}),R.jsx("button",{type:"submit",disabled:w,style:{width:"100%",padding:"0.6rem 1rem",borderRadius:"999px",border:"none",background:"#6CE1AB",color:"black",fontWeight:500,cursor:"pointer",marginTop:"1.5rem",marginBottom:"1rem"},children:w?"Logger inn...":"Logg inn"})]})]})}),R.jsx(I1,{})]})}Fb.createRoot(document.getElementById("root")).render(R.jsxs(Ke.StrictMode,{children:[R.jsx(FR,{}),R.jsx(rR,{richColors:!0,position:"top-center"})]}));
